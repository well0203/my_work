
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_24_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.8754409
	speed: 0.0778s/iter; left time: 696.8565s
	iters: 200, epoch: 1 | loss: 0.7260861
	speed: 0.0452s/iter; left time: 400.6435s
	iters: 300, epoch: 1 | loss: 0.5881239
	speed: 0.0424s/iter; left time: 371.4244s
	iters: 400, epoch: 1 | loss: 0.5317206
	speed: 0.0456s/iter; left time: 394.6381s
	iters: 500, epoch: 1 | loss: 0.4490079
	speed: 0.0467s/iter; left time: 399.9881s
	iters: 600, epoch: 1 | loss: 0.4366098
	speed: 0.0423s/iter; left time: 357.7978s
	iters: 700, epoch: 1 | loss: 0.5984434
	speed: 0.0358s/iter; left time: 299.2334s
	iters: 800, epoch: 1 | loss: 0.4468952
	speed: 0.0375s/iter; left time: 309.6802s
	iters: 900, epoch: 1 | loss: 0.3504356
	speed: 0.0438s/iter; left time: 357.2036s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:39.64s
Steps: 906 | Train Loss: 0.5984609 Vali Loss: 0.5636209 Test Loss: 0.6419901
Validation loss decreased (inf --> 0.563621).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2546865
	speed: 0.1047s/iter; left time: 843.0712s
	iters: 200, epoch: 2 | loss: 0.4297647
	speed: 0.0487s/iter; left time: 387.4217s
	iters: 300, epoch: 2 | loss: 0.2928289
	speed: 0.0470s/iter; left time: 368.9475s
	iters: 400, epoch: 2 | loss: 0.3814909
	speed: 0.0492s/iter; left time: 381.4445s
	iters: 500, epoch: 2 | loss: 0.2418542
	speed: 0.0326s/iter; left time: 249.5587s
	iters: 600, epoch: 2 | loss: 0.2771155
	speed: 0.0279s/iter; left time: 210.8315s
	iters: 700, epoch: 2 | loss: 0.2600983
	speed: 0.0347s/iter; left time: 258.9305s
	iters: 800, epoch: 2 | loss: 0.3986025
	speed: 0.0480s/iter; left time: 353.0235s
	iters: 900, epoch: 2 | loss: 0.2961993
	speed: 0.0484s/iter; left time: 351.4884s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.73s
Steps: 906 | Train Loss: 0.3344372 Vali Loss: 0.4406978 Test Loss: 0.5047123
Validation loss decreased (0.563621 --> 0.440698).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3222269
	speed: 0.1112s/iter; left time: 795.1280s
	iters: 200, epoch: 3 | loss: 0.2550934
	speed: 0.0480s/iter; left time: 338.1748s
	iters: 300, epoch: 3 | loss: 0.2760914
	speed: 0.0470s/iter; left time: 326.6396s
	iters: 400, epoch: 3 | loss: 0.2655979
	speed: 0.0461s/iter; left time: 315.6396s
	iters: 500, epoch: 3 | loss: 0.3568298
	speed: 0.0478s/iter; left time: 322.5830s
	iters: 600, epoch: 3 | loss: 0.3077882
	speed: 0.0469s/iter; left time: 311.7862s
	iters: 700, epoch: 3 | loss: 0.2796648
	speed: 0.0377s/iter; left time: 247.1040s
	iters: 800, epoch: 3 | loss: 0.2527131
	speed: 0.0339s/iter; left time: 218.3229s
	iters: 900, epoch: 3 | loss: 0.2725163
	speed: 0.0438s/iter; left time: 277.8193s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:40.50s
Steps: 906 | Train Loss: 0.2789132 Vali Loss: 0.4363867 Test Loss: 0.4842115
Validation loss decreased (0.440698 --> 0.436387).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2329618
	speed: 0.1049s/iter; left time: 654.6495s
	iters: 200, epoch: 4 | loss: 0.2417155
	speed: 0.0404s/iter; left time: 248.0477s
	iters: 300, epoch: 4 | loss: 0.2286840
	speed: 0.0448s/iter; left time: 270.6984s
	iters: 400, epoch: 4 | loss: 0.2005890
	speed: 0.0444s/iter; left time: 263.9388s
	iters: 500, epoch: 4 | loss: 0.3193380
	speed: 0.0407s/iter; left time: 237.9689s
	iters: 600, epoch: 4 | loss: 0.2470205
	speed: 0.0476s/iter; left time: 273.3899s
	iters: 700, epoch: 4 | loss: 0.2137513
	speed: 0.0352s/iter; left time: 198.5729s
	iters: 800, epoch: 4 | loss: 0.2644546
	speed: 0.0427s/iter; left time: 236.9054s
	iters: 900, epoch: 4 | loss: 0.2470621
	speed: 0.0432s/iter; left time: 235.1178s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.77s
Steps: 906 | Train Loss: 0.2380960 Vali Loss: 0.4675660 Test Loss: 0.5229828
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2264290
	speed: 0.0933s/iter; left time: 497.7238s
	iters: 200, epoch: 5 | loss: 0.2064114
	speed: 0.0412s/iter; left time: 215.7277s
	iters: 300, epoch: 5 | loss: 0.1771473
	speed: 0.0426s/iter; left time: 218.9850s
	iters: 400, epoch: 5 | loss: 0.2180729
	speed: 0.0423s/iter; left time: 213.3164s
	iters: 500, epoch: 5 | loss: 0.1669089
	speed: 0.0453s/iter; left time: 223.4675s
	iters: 600, epoch: 5 | loss: 0.1975233
	speed: 0.0442s/iter; left time: 213.8881s
	iters: 700, epoch: 5 | loss: 0.1766317
	speed: 0.0468s/iter; left time: 221.8981s
	iters: 800, epoch: 5 | loss: 0.1944941
	speed: 0.0340s/iter; left time: 157.7132s
	iters: 900, epoch: 5 | loss: 0.2040730
	speed: 0.0364s/iter; left time: 165.3435s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.26s
Steps: 906 | Train Loss: 0.1967699 Vali Loss: 0.4598494 Test Loss: 0.5197368
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1980289
	speed: 0.1038s/iter; left time: 460.0989s
	iters: 200, epoch: 6 | loss: 0.1421976
	speed: 0.0345s/iter; left time: 149.2401s
	iters: 300, epoch: 6 | loss: 0.1634986
	speed: 0.0453s/iter; left time: 191.6598s
	iters: 400, epoch: 6 | loss: 0.1626134
	speed: 0.0476s/iter; left time: 196.8071s
	iters: 500, epoch: 6 | loss: 0.1830469
	speed: 0.0394s/iter; left time: 159.0024s
	iters: 600, epoch: 6 | loss: 0.1461178
	speed: 0.0373s/iter; left time: 146.7247s
	iters: 700, epoch: 6 | loss: 0.1799205
	speed: 0.0397s/iter; left time: 152.2671s
	iters: 800, epoch: 6 | loss: 0.1406301
	speed: 0.0466s/iter; left time: 173.7980s
	iters: 900, epoch: 6 | loss: 0.1443603
	speed: 0.0461s/iter; left time: 167.2541s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.96s
Steps: 906 | Train Loss: 0.1648386 Vali Loss: 0.5146403 Test Loss: 0.5780380
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
mse:0.4845530688762665, rmse:0.6960984468460083, mae:0.4747908413410187, rse:0.5509179830551147
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.7940848
	speed: 0.0506s/iter; left time: 453.7479s
	iters: 200, epoch: 1 | loss: 0.6955079
	speed: 0.0475s/iter; left time: 420.6656s
	iters: 300, epoch: 1 | loss: 0.5134652
	speed: 0.0445s/iter; left time: 390.2384s
	iters: 400, epoch: 1 | loss: 0.5164902
	speed: 0.0409s/iter; left time: 354.0445s
	iters: 500, epoch: 1 | loss: 0.5536527
	speed: 0.0477s/iter; left time: 408.2700s
	iters: 600, epoch: 1 | loss: 0.5545563
	speed: 0.0352s/iter; left time: 298.1310s
	iters: 700, epoch: 1 | loss: 0.4522658
	speed: 0.0459s/iter; left time: 384.0210s
	iters: 800, epoch: 1 | loss: 0.4030414
	speed: 0.0423s/iter; left time: 349.2533s
	iters: 900, epoch: 1 | loss: 0.4324321
	speed: 0.0431s/iter; left time: 351.3455s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:40.16s
Steps: 906 | Train Loss: 0.5985398 Vali Loss: 0.5592329 Test Loss: 0.6520282
Validation loss decreased (inf --> 0.559233).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4809588
	speed: 0.1058s/iter; left time: 852.4460s
	iters: 200, epoch: 2 | loss: 0.3434350
	speed: 0.0399s/iter; left time: 317.5238s
	iters: 300, epoch: 2 | loss: 0.2876355
	speed: 0.0433s/iter; left time: 339.9899s
	iters: 400, epoch: 2 | loss: 0.3155873
	speed: 0.0466s/iter; left time: 361.6544s
	iters: 500, epoch: 2 | loss: 0.3069152
	speed: 0.0447s/iter; left time: 342.5052s
	iters: 600, epoch: 2 | loss: 0.2878850
	speed: 0.0460s/iter; left time: 347.4171s
	iters: 700, epoch: 2 | loss: 0.3604871
	speed: 0.0413s/iter; left time: 307.6469s
	iters: 800, epoch: 2 | loss: 0.3090978
	speed: 0.0469s/iter; left time: 345.0912s
	iters: 900, epoch: 2 | loss: 0.2337791
	speed: 0.0503s/iter; left time: 364.8238s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:40.94s
Steps: 906 | Train Loss: 0.3341385 Vali Loss: 0.4505811 Test Loss: 0.4896597
Validation loss decreased (0.559233 --> 0.450581).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2500563
	speed: 0.1103s/iter; left time: 788.3263s
	iters: 200, epoch: 3 | loss: 0.2749220
	speed: 0.0433s/iter; left time: 305.4884s
	iters: 300, epoch: 3 | loss: 0.4003462
	speed: 0.0353s/iter; left time: 245.3431s
	iters: 400, epoch: 3 | loss: 0.2279331
	speed: 0.0459s/iter; left time: 314.3691s
	iters: 500, epoch: 3 | loss: 0.3449506
	speed: 0.0461s/iter; left time: 311.1603s
	iters: 600, epoch: 3 | loss: 0.3044321
	speed: 0.0457s/iter; left time: 303.7476s
	iters: 700, epoch: 3 | loss: 0.2671725
	speed: 0.0453s/iter; left time: 296.4362s
	iters: 800, epoch: 3 | loss: 0.1682917
	speed: 0.0416s/iter; left time: 268.4880s
	iters: 900, epoch: 3 | loss: 0.1908576
	speed: 0.0456s/iter; left time: 289.5695s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:40.41s
Steps: 906 | Train Loss: 0.2793407 Vali Loss: 0.4617786 Test Loss: 0.4950074
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3186104
	speed: 0.1065s/iter; left time: 664.7993s
	iters: 200, epoch: 4 | loss: 0.2130065
	speed: 0.0437s/iter; left time: 268.7288s
	iters: 300, epoch: 4 | loss: 0.2003538
	speed: 0.0415s/iter; left time: 251.0598s
	iters: 400, epoch: 4 | loss: 0.2623422
	speed: 0.0414s/iter; left time: 246.2597s
	iters: 500, epoch: 4 | loss: 0.2018044
	speed: 0.0388s/iter; left time: 226.9231s
	iters: 600, epoch: 4 | loss: 0.2563125
	speed: 0.0424s/iter; left time: 243.6071s
	iters: 700, epoch: 4 | loss: 0.2433040
	speed: 0.0319s/iter; left time: 180.1321s
	iters: 800, epoch: 4 | loss: 0.2440763
	speed: 0.0362s/iter; left time: 200.7529s
	iters: 900, epoch: 4 | loss: 0.2041423
	speed: 0.0438s/iter; left time: 238.3006s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.38s
Steps: 906 | Train Loss: 0.2388206 Vali Loss: 0.4481942 Test Loss: 0.4855444
Validation loss decreased (0.450581 --> 0.448194).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1715127
	speed: 0.1071s/iter; left time: 571.5746s
	iters: 200, epoch: 5 | loss: 0.2226924
	speed: 0.0460s/iter; left time: 241.1263s
	iters: 300, epoch: 5 | loss: 0.2717839
	speed: 0.0442s/iter; left time: 227.2244s
	iters: 400, epoch: 5 | loss: 0.2395192
	speed: 0.0456s/iter; left time: 229.6526s
	iters: 500, epoch: 5 | loss: 0.1965641
	speed: 0.0446s/iter; left time: 220.0817s
	iters: 600, epoch: 5 | loss: 0.1854599
	speed: 0.0433s/iter; left time: 209.2563s
	iters: 700, epoch: 5 | loss: 0.1827174
	speed: 0.0402s/iter; left time: 190.2235s
	iters: 800, epoch: 5 | loss: 0.1854400
	speed: 0.0413s/iter; left time: 191.6723s
	iters: 900, epoch: 5 | loss: 0.1974044
	speed: 0.0350s/iter; left time: 158.5727s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.98s
Steps: 906 | Train Loss: 0.1954678 Vali Loss: 0.4819650 Test Loss: 0.5250737
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1990901
	speed: 0.1067s/iter; left time: 472.7643s
	iters: 200, epoch: 6 | loss: 0.1494676
	speed: 0.0369s/iter; left time: 159.9909s
	iters: 300, epoch: 6 | loss: 0.1395076
	speed: 0.0496s/iter; left time: 209.9134s
	iters: 400, epoch: 6 | loss: 0.1950423
	speed: 0.0456s/iter; left time: 188.4768s
	iters: 500, epoch: 6 | loss: 0.1667301
	speed: 0.0468s/iter; left time: 188.5987s
	iters: 600, epoch: 6 | loss: 0.1673328
	speed: 0.0423s/iter; left time: 166.3496s
	iters: 700, epoch: 6 | loss: 0.1498653
	speed: 0.0397s/iter; left time: 151.9794s
	iters: 800, epoch: 6 | loss: 0.1240760
	speed: 0.0489s/iter; left time: 182.2889s
	iters: 900, epoch: 6 | loss: 0.1456304
	speed: 0.0486s/iter; left time: 176.5825s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:41.48s
Steps: 906 | Train Loss: 0.1586516 Vali Loss: 0.4916697 Test Loss: 0.5453984
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1205320
	speed: 0.1042s/iter; left time: 367.4559s
	iters: 200, epoch: 7 | loss: 0.1105122
	speed: 0.0391s/iter; left time: 133.9393s
	iters: 300, epoch: 7 | loss: 0.1347716
	speed: 0.0485s/iter; left time: 161.2269s
	iters: 400, epoch: 7 | loss: 0.1331866
	speed: 0.0456s/iter; left time: 147.1258s
	iters: 500, epoch: 7 | loss: 0.1755069
	speed: 0.0467s/iter; left time: 145.9249s
	iters: 600, epoch: 7 | loss: 0.1452723
	speed: 0.0474s/iter; left time: 143.2657s
	iters: 700, epoch: 7 | loss: 0.1658157
	speed: 0.0432s/iter; left time: 126.2940s
	iters: 800, epoch: 7 | loss: 0.1823024
	speed: 0.0414s/iter; left time: 116.9523s
	iters: 900, epoch: 7 | loss: 0.1335696
	speed: 0.0481s/iter; left time: 130.9557s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:41.00s
Steps: 906 | Train Loss: 0.1325223 Vali Loss: 0.4990247 Test Loss: 0.5457581
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
mse:0.48707887530326843, rmse:0.6979103684425354, mae:0.4671614170074463, rse:0.5523520112037659

Extracted Metrics for DE, pred_len=24, iteration=1:
MSE: 0.4845530688762665, RMSE: 0.6960984468460083, MAE: 0.4747908413410187, RSE: 0.5509179830551147

Extracted Metrics for DE, pred_len=24, iteration=2:
MSE: 0.48707887530326843, RMSE: 0.6979103684425354, MAE: 0.4671614170074463, RSE: 0.5523520112037659

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_96_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 1.0553409
	speed: 0.0825s/iter; left time: 737.7451s
	iters: 200, epoch: 1 | loss: 0.9618088
	speed: 0.0443s/iter; left time: 391.6192s
	iters: 300, epoch: 1 | loss: 0.9252958
	speed: 0.0464s/iter; left time: 405.7008s
	iters: 400, epoch: 1 | loss: 0.7812807
	speed: 0.0377s/iter; left time: 325.7346s
	iters: 500, epoch: 1 | loss: 0.7889023
	speed: 0.0497s/iter; left time: 424.6929s
	iters: 600, epoch: 1 | loss: 0.6611272
	speed: 0.0460s/iter; left time: 388.2220s
	iters: 700, epoch: 1 | loss: 0.6259105
	speed: 0.0357s/iter; left time: 297.9437s
	iters: 800, epoch: 1 | loss: 0.6513122
	speed: 0.0449s/iter; left time: 369.7824s
	iters: 900, epoch: 1 | loss: 0.6578389
	speed: 0.0471s/iter; left time: 383.2298s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:41.03s
Steps: 904 | Train Loss: 0.8172180 Vali Loss: 0.8336484 Test Loss: 1.0374128
Validation loss decreased (inf --> 0.833648).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5250234
	speed: 0.1087s/iter; left time: 873.4304s
	iters: 200, epoch: 2 | loss: 0.5788298
	speed: 0.0457s/iter; left time: 362.8730s
	iters: 300, epoch: 2 | loss: 0.5285784
	speed: 0.0472s/iter; left time: 369.7265s
	iters: 400, epoch: 2 | loss: 0.4928753
	speed: 0.0468s/iter; left time: 362.3718s
	iters: 500, epoch: 2 | loss: 0.4880221
	speed: 0.0455s/iter; left time: 347.1073s
	iters: 600, epoch: 2 | loss: 0.5831410
	speed: 0.0490s/iter; left time: 369.2193s
	iters: 700, epoch: 2 | loss: 0.4683133
	speed: 0.0457s/iter; left time: 339.5314s
	iters: 800, epoch: 2 | loss: 0.5395126
	speed: 0.0481s/iter; left time: 352.6610s
	iters: 900, epoch: 2 | loss: 0.4574910
	speed: 0.0471s/iter; left time: 340.9618s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.61s
Steps: 904 | Train Loss: 0.5348569 Vali Loss: 0.6813359 Test Loss: 0.8255704
Validation loss decreased (0.833648 --> 0.681336).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5549014
	speed: 0.1104s/iter; left time: 787.1515s
	iters: 200, epoch: 3 | loss: 0.4220436
	speed: 0.0471s/iter; left time: 331.2751s
	iters: 300, epoch: 3 | loss: 0.3837465
	speed: 0.0432s/iter; left time: 299.7599s
	iters: 400, epoch: 3 | loss: 0.3859476
	speed: 0.0404s/iter; left time: 276.1103s
	iters: 500, epoch: 3 | loss: 0.4555952
	speed: 0.0384s/iter; left time: 258.2731s
	iters: 600, epoch: 3 | loss: 0.3960175
	speed: 0.0469s/iter; left time: 311.1699s
	iters: 700, epoch: 3 | loss: 0.3825842
	speed: 0.0479s/iter; left time: 312.6801s
	iters: 800, epoch: 3 | loss: 0.4188156
	speed: 0.0470s/iter; left time: 302.6478s
	iters: 900, epoch: 3 | loss: 0.4259931
	speed: 0.0487s/iter; left time: 308.2249s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:41.25s
Steps: 904 | Train Loss: 0.4311757 Vali Loss: 0.6887811 Test Loss: 0.8447679
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3707462
	speed: 0.1024s/iter; left time: 638.0022s
	iters: 200, epoch: 4 | loss: 0.3540020
	speed: 0.0483s/iter; left time: 295.8267s
	iters: 300, epoch: 4 | loss: 0.3549272
	speed: 0.0479s/iter; left time: 289.0715s
	iters: 400, epoch: 4 | loss: 0.2774632
	speed: 0.0477s/iter; left time: 282.5976s
	iters: 500, epoch: 4 | loss: 0.3796825
	speed: 0.0451s/iter; left time: 262.9672s
	iters: 600, epoch: 4 | loss: 0.3225014
	speed: 0.0468s/iter; left time: 267.8884s
	iters: 700, epoch: 4 | loss: 0.3709828
	speed: 0.0420s/iter; left time: 236.1600s
	iters: 800, epoch: 4 | loss: 0.3402101
	speed: 0.0416s/iter; left time: 230.1532s
	iters: 900, epoch: 4 | loss: 0.3628283
	speed: 0.0391s/iter; left time: 212.1682s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:40.68s
Steps: 904 | Train Loss: 0.3601861 Vali Loss: 0.7525234 Test Loss: 0.9388931
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2761967
	speed: 0.1010s/iter; left time: 537.8523s
	iters: 200, epoch: 5 | loss: 0.3742134
	speed: 0.0353s/iter; left time: 184.6572s
	iters: 300, epoch: 5 | loss: 0.2969899
	speed: 0.0480s/iter; left time: 245.7618s
	iters: 400, epoch: 5 | loss: 0.3104628
	speed: 0.0469s/iter; left time: 235.4532s
	iters: 500, epoch: 5 | loss: 0.2954840
	speed: 0.0479s/iter; left time: 235.7295s
	iters: 600, epoch: 5 | loss: 0.2894021
	speed: 0.0437s/iter; left time: 210.6768s
	iters: 700, epoch: 5 | loss: 0.2815764
	speed: 0.0318s/iter; left time: 150.2007s
	iters: 800, epoch: 5 | loss: 0.2494880
	speed: 0.0468s/iter; left time: 216.4946s
	iters: 900, epoch: 5 | loss: 0.2636387
	speed: 0.0493s/iter; left time: 222.8792s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:39.79s
Steps: 904 | Train Loss: 0.2992973 Vali Loss: 0.7255701 Test Loss: 0.9204978
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
mse:0.825575590133667, rmse:0.9086118936538696, mae:0.6690298318862915, rse:0.7206411957740784
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.9072584
	speed: 0.0414s/iter; left time: 370.3475s
	iters: 200, epoch: 1 | loss: 0.8246167
	speed: 0.0476s/iter; left time: 420.4649s
	iters: 300, epoch: 1 | loss: 0.8606612
	speed: 0.0439s/iter; left time: 383.5549s
	iters: 400, epoch: 1 | loss: 0.8278546
	speed: 0.0469s/iter; left time: 404.9379s
	iters: 500, epoch: 1 | loss: 0.8659052
	speed: 0.0383s/iter; left time: 326.9555s
	iters: 600, epoch: 1 | loss: 0.6688741
	speed: 0.0462s/iter; left time: 390.2551s
	iters: 700, epoch: 1 | loss: 0.9305874
	speed: 0.0452s/iter; left time: 376.6472s
	iters: 800, epoch: 1 | loss: 0.6930461
	speed: 0.0382s/iter; left time: 314.5850s
	iters: 900, epoch: 1 | loss: 0.7392390
	speed: 0.0428s/iter; left time: 348.2868s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:39.23s
Steps: 904 | Train Loss: 0.8262640 Vali Loss: 0.8313039 Test Loss: 1.0475183
Validation loss decreased (inf --> 0.831304).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6534256
	speed: 0.1083s/iter; left time: 870.3419s
	iters: 200, epoch: 2 | loss: 0.6242445
	speed: 0.0523s/iter; left time: 414.8537s
	iters: 300, epoch: 2 | loss: 0.5559287
	speed: 0.0486s/iter; left time: 381.1464s
	iters: 400, epoch: 2 | loss: 0.4323021
	speed: 0.0485s/iter; left time: 375.1369s
	iters: 500, epoch: 2 | loss: 0.4811127
	speed: 0.0339s/iter; left time: 258.9540s
	iters: 600, epoch: 2 | loss: 0.6024867
	speed: 0.0473s/iter; left time: 356.7255s
	iters: 700, epoch: 2 | loss: 0.5007147
	speed: 0.0391s/iter; left time: 290.7631s
	iters: 800, epoch: 2 | loss: 0.5252903
	speed: 0.0370s/iter; left time: 271.2524s
	iters: 900, epoch: 2 | loss: 0.4161828
	speed: 0.0443s/iter; left time: 320.9604s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:40.22s
Steps: 904 | Train Loss: 0.5329223 Vali Loss: 0.6859319 Test Loss: 0.8439868
Validation loss decreased (0.831304 --> 0.685932).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4529830
	speed: 0.1102s/iter; left time: 786.3889s
	iters: 200, epoch: 3 | loss: 0.4495713
	speed: 0.0401s/iter; left time: 281.9221s
	iters: 300, epoch: 3 | loss: 0.3820248
	speed: 0.0403s/iter; left time: 279.5123s
	iters: 400, epoch: 3 | loss: 0.3778513
	speed: 0.0450s/iter; left time: 307.5329s
	iters: 500, epoch: 3 | loss: 0.3880405
	speed: 0.0432s/iter; left time: 290.6809s
	iters: 600, epoch: 3 | loss: 0.4034651
	speed: 0.0404s/iter; left time: 268.1672s
	iters: 700, epoch: 3 | loss: 0.4091071
	speed: 0.0464s/iter; left time: 303.0628s
	iters: 800, epoch: 3 | loss: 0.4530527
	speed: 0.0410s/iter; left time: 263.8092s
	iters: 900, epoch: 3 | loss: 0.4016001
	speed: 0.0475s/iter; left time: 300.7579s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:39.36s
Steps: 904 | Train Loss: 0.4237194 Vali Loss: 0.7496722 Test Loss: 0.9063830
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3607888
	speed: 0.1091s/iter; left time: 679.7466s
	iters: 200, epoch: 4 | loss: 0.3745221
	speed: 0.0455s/iter; left time: 278.6431s
	iters: 300, epoch: 4 | loss: 0.3643158
	speed: 0.0477s/iter; left time: 287.5050s
	iters: 400, epoch: 4 | loss: 0.3181264
	speed: 0.0474s/iter; left time: 281.0763s
	iters: 500, epoch: 4 | loss: 0.3359987
	speed: 0.0422s/iter; left time: 245.7988s
	iters: 600, epoch: 4 | loss: 0.3656865
	speed: 0.0462s/iter; left time: 264.7626s
	iters: 700, epoch: 4 | loss: 0.3352043
	speed: 0.0480s/iter; left time: 270.0593s
	iters: 800, epoch: 4 | loss: 0.3765287
	speed: 0.0473s/iter; left time: 261.7970s
	iters: 900, epoch: 4 | loss: 0.2844599
	speed: 0.0409s/iter; left time: 222.1069s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:41.82s
Steps: 904 | Train Loss: 0.3620985 Vali Loss: 0.7326247 Test Loss: 0.9396789
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2786411
	speed: 0.1063s/iter; left time: 566.1962s
	iters: 200, epoch: 5 | loss: 0.3380631
	speed: 0.0485s/iter; left time: 253.3826s
	iters: 300, epoch: 5 | loss: 0.3191465
	speed: 0.0467s/iter; left time: 239.4464s
	iters: 400, epoch: 5 | loss: 0.2925112
	speed: 0.0485s/iter; left time: 243.5183s
	iters: 500, epoch: 5 | loss: 0.3090059
	speed: 0.0398s/iter; left time: 196.1319s
	iters: 600, epoch: 5 | loss: 0.2894770
	speed: 0.0432s/iter; left time: 208.6541s
	iters: 700, epoch: 5 | loss: 0.3082345
	speed: 0.0436s/iter; left time: 205.9031s
	iters: 800, epoch: 5 | loss: 0.3322985
	speed: 0.0441s/iter; left time: 203.9892s
	iters: 900, epoch: 5 | loss: 0.2782825
	speed: 0.0467s/iter; left time: 211.1214s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.00s
Steps: 904 | Train Loss: 0.3037740 Vali Loss: 0.7241696 Test Loss: 0.9566291
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
mse:0.8441876769065857, rmse:0.9187968373298645, mae:0.6719043254852295, rse:0.728719174861908

Extracted Metrics for DE, pred_len=96, iteration=1:
MSE: 0.825575590133667, RMSE: 0.9086118936538696, MAE: 0.6690298318862915, RSE: 0.7206411957740784

Extracted Metrics for DE, pred_len=96, iteration=2:
MSE: 0.8441876769065857, RMSE: 0.9187968373298645, MAE: 0.6719043254852295, RSE: 0.728719174861908

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_168_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.9002920
	speed: 0.0826s/iter; left time: 737.1773s
	iters: 200, epoch: 1 | loss: 0.9796243
	speed: 0.0466s/iter; left time: 410.9277s
	iters: 300, epoch: 1 | loss: 0.8703567
	speed: 0.0366s/iter; left time: 319.4518s
	iters: 400, epoch: 1 | loss: 0.8750377
	speed: 0.0435s/iter; left time: 374.9156s
	iters: 500, epoch: 1 | loss: 0.8427003
	speed: 0.0503s/iter; left time: 428.5262s
	iters: 600, epoch: 1 | loss: 0.8892862
	speed: 0.0466s/iter; left time: 392.1361s
	iters: 700, epoch: 1 | loss: 0.8373239
	speed: 0.0451s/iter; left time: 375.4546s
	iters: 800, epoch: 1 | loss: 0.7697777
	speed: 0.0422s/iter; left time: 346.7610s
	iters: 900, epoch: 1 | loss: 0.8343865
	speed: 0.0506s/iter; left time: 410.6272s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:42.23s
Steps: 902 | Train Loss: 0.8779987 Vali Loss: 0.9820610 Test Loss: 1.2618014
Validation loss decreased (inf --> 0.982061).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8210352
	speed: 0.1193s/iter; left time: 957.0468s
	iters: 200, epoch: 2 | loss: 0.7023198
	speed: 0.0436s/iter; left time: 345.3177s
	iters: 300, epoch: 2 | loss: 0.7391762
	speed: 0.0471s/iter; left time: 368.4579s
	iters: 400, epoch: 2 | loss: 0.6218180
	speed: 0.0478s/iter; left time: 368.7111s
	iters: 500, epoch: 2 | loss: 0.6234000
	speed: 0.0425s/iter; left time: 323.4990s
	iters: 600, epoch: 2 | loss: 0.5244492
	speed: 0.0440s/iter; left time: 331.1241s
	iters: 700, epoch: 2 | loss: 0.5347773
	speed: 0.0495s/iter; left time: 367.4920s
	iters: 800, epoch: 2 | loss: 0.6071605
	speed: 0.0462s/iter; left time: 338.0066s
	iters: 900, epoch: 2 | loss: 0.4984582
	speed: 0.0421s/iter; left time: 303.9605s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:41.75s
Steps: 902 | Train Loss: 0.6055719 Vali Loss: 0.7250192 Test Loss: 0.8691709
Validation loss decreased (0.982061 --> 0.725019).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4981438
	speed: 0.1169s/iter; left time: 831.8804s
	iters: 200, epoch: 3 | loss: 0.4806912
	speed: 0.0492s/iter; left time: 345.0297s
	iters: 300, epoch: 3 | loss: 0.4771298
	speed: 0.0421s/iter; left time: 291.1495s
	iters: 400, epoch: 3 | loss: 0.5351637
	speed: 0.0484s/iter; left time: 330.0315s
	iters: 500, epoch: 3 | loss: 0.4567018
	speed: 0.0500s/iter; left time: 335.5747s
	iters: 600, epoch: 3 | loss: 0.4690168
	speed: 0.0443s/iter; left time: 293.1614s
	iters: 700, epoch: 3 | loss: 0.5097059
	speed: 0.0472s/iter; left time: 307.8238s
	iters: 800, epoch: 3 | loss: 0.4482544
	speed: 0.0481s/iter; left time: 308.5456s
	iters: 900, epoch: 3 | loss: 0.4206373
	speed: 0.0460s/iter; left time: 290.7206s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:42.56s
Steps: 902 | Train Loss: 0.4569905 Vali Loss: 0.7368394 Test Loss: 0.9019122
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3673571
	speed: 0.1138s/iter; left time: 707.2451s
	iters: 200, epoch: 4 | loss: 0.3366677
	speed: 0.0441s/iter; left time: 269.6832s
	iters: 300, epoch: 4 | loss: 0.4368373
	speed: 0.0462s/iter; left time: 277.7793s
	iters: 400, epoch: 4 | loss: 0.4143197
	speed: 0.0474s/iter; left time: 280.2939s
	iters: 500, epoch: 4 | loss: 0.4315954
	speed: 0.0452s/iter; left time: 262.5614s
	iters: 600, epoch: 4 | loss: 0.3634006
	speed: 0.0445s/iter; left time: 254.1167s
	iters: 700, epoch: 4 | loss: 0.3813722
	speed: 0.0431s/iter; left time: 241.9370s
	iters: 800, epoch: 4 | loss: 0.3931862
	speed: 0.0325s/iter; left time: 179.1061s
	iters: 900, epoch: 4 | loss: 0.3680252
	speed: 0.0471s/iter; left time: 255.0909s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:40.09s
Steps: 902 | Train Loss: 0.3843258 Vali Loss: 0.7553437 Test Loss: 0.9959126
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3882638
	speed: 0.1177s/iter; left time: 625.2141s
	iters: 200, epoch: 5 | loss: 0.3447854
	speed: 0.0365s/iter; left time: 190.0267s
	iters: 300, epoch: 5 | loss: 0.3297175
	speed: 0.0511s/iter; left time: 261.3647s
	iters: 400, epoch: 5 | loss: 0.3546920
	speed: 0.0445s/iter; left time: 223.0862s
	iters: 500, epoch: 5 | loss: 0.2664817
	speed: 0.0477s/iter; left time: 234.5420s
	iters: 600, epoch: 5 | loss: 0.3219320
	speed: 0.0511s/iter; left time: 246.1578s
	iters: 700, epoch: 5 | loss: 0.3419119
	speed: 0.0491s/iter; left time: 231.2912s
	iters: 800, epoch: 5 | loss: 0.2921619
	speed: 0.0474s/iter; left time: 218.5608s
	iters: 900, epoch: 5 | loss: 0.2600665
	speed: 0.0495s/iter; left time: 223.3565s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.15s
Steps: 902 | Train Loss: 0.3190285 Vali Loss: 0.8093616 Test Loss: 1.0327603
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
mse:0.8688871264457703, rmse:0.932141125202179, mae:0.6895283460617065, rse:0.738420844078064
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 1.1393566
	speed: 0.0476s/iter; left time: 424.9194s
	iters: 200, epoch: 1 | loss: 0.9143065
	speed: 0.0430s/iter; left time: 379.5376s
	iters: 300, epoch: 1 | loss: 0.7530119
	speed: 0.0373s/iter; left time: 325.3811s
	iters: 400, epoch: 1 | loss: 0.8853310
	speed: 0.0519s/iter; left time: 447.6585s
	iters: 500, epoch: 1 | loss: 0.8174672
	speed: 0.0429s/iter; left time: 365.3990s
	iters: 600, epoch: 1 | loss: 0.8674576
	speed: 0.0463s/iter; left time: 389.4913s
	iters: 700, epoch: 1 | loss: 0.8745298
	speed: 0.0404s/iter; left time: 336.0357s
	iters: 800, epoch: 1 | loss: 0.7719849
	speed: 0.0415s/iter; left time: 340.8900s
	iters: 900, epoch: 1 | loss: 0.7784532
	speed: 0.0495s/iter; left time: 402.3670s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:40.23s
Steps: 902 | Train Loss: 0.8739690 Vali Loss: 0.9911066 Test Loss: 1.2682191
Validation loss decreased (inf --> 0.991107).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8160771
	speed: 0.1201s/iter; left time: 963.0008s
	iters: 200, epoch: 2 | loss: 0.6649356
	speed: 0.0379s/iter; left time: 300.4086s
	iters: 300, epoch: 2 | loss: 0.7001882
	speed: 0.0465s/iter; left time: 363.3010s
	iters: 400, epoch: 2 | loss: 0.4958862
	speed: 0.0449s/iter; left time: 346.9608s
	iters: 500, epoch: 2 | loss: 0.6312916
	speed: 0.0474s/iter; left time: 361.4229s
	iters: 600, epoch: 2 | loss: 0.5352398
	speed: 0.0486s/iter; left time: 365.3652s
	iters: 700, epoch: 2 | loss: 0.5689325
	speed: 0.0482s/iter; left time: 357.7574s
	iters: 800, epoch: 2 | loss: 0.5168986
	speed: 0.0437s/iter; left time: 319.9723s
	iters: 900, epoch: 2 | loss: 0.4881203
	speed: 0.0473s/iter; left time: 341.6533s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:41.87s
Steps: 902 | Train Loss: 0.6218363 Vali Loss: 0.7711947 Test Loss: 0.8897678
Validation loss decreased (0.991107 --> 0.771195).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4910145
	speed: 0.1172s/iter; left time: 834.1210s
	iters: 200, epoch: 3 | loss: 0.4448029
	speed: 0.0460s/iter; left time: 322.4591s
	iters: 300, epoch: 3 | loss: 0.4320655
	speed: 0.0497s/iter; left time: 344.0262s
	iters: 400, epoch: 3 | loss: 0.3874965
	speed: 0.0489s/iter; left time: 333.3263s
	iters: 500, epoch: 3 | loss: 0.4855063
	speed: 0.0429s/iter; left time: 288.1246s
	iters: 600, epoch: 3 | loss: 0.4454901
	speed: 0.0461s/iter; left time: 305.2392s
	iters: 700, epoch: 3 | loss: 0.4698119
	speed: 0.0471s/iter; left time: 306.7477s
	iters: 800, epoch: 3 | loss: 0.3589253
	speed: 0.0479s/iter; left time: 307.4533s
	iters: 900, epoch: 3 | loss: 0.4190975
	speed: 0.0480s/iter; left time: 303.4201s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:42.96s
Steps: 902 | Train Loss: 0.4638550 Vali Loss: 0.7277861 Test Loss: 0.9262581
Validation loss decreased (0.771195 --> 0.727786).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3920750
	speed: 0.1172s/iter; left time: 728.5566s
	iters: 200, epoch: 4 | loss: 0.4400256
	speed: 0.0436s/iter; left time: 266.3261s
	iters: 300, epoch: 4 | loss: 0.4587332
	speed: 0.0477s/iter; left time: 287.1800s
	iters: 400, epoch: 4 | loss: 0.4224612
	speed: 0.0436s/iter; left time: 257.7865s
	iters: 500, epoch: 4 | loss: 0.4056634
	speed: 0.0338s/iter; left time: 196.5805s
	iters: 600, epoch: 4 | loss: 0.3859549
	speed: 0.0357s/iter; left time: 203.8124s
	iters: 700, epoch: 4 | loss: 0.3446541
	speed: 0.0498s/iter; left time: 279.8716s
	iters: 800, epoch: 4 | loss: 0.3232461
	speed: 0.0485s/iter; left time: 267.6031s
	iters: 900, epoch: 4 | loss: 0.3906113
	speed: 0.0484s/iter; left time: 262.1973s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:40.33s
Steps: 902 | Train Loss: 0.3897519 Vali Loss: 0.7961924 Test Loss: 0.9809527
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3371960
	speed: 0.1162s/iter; left time: 617.5159s
	iters: 200, epoch: 5 | loss: 0.3259346
	speed: 0.0398s/iter; left time: 207.6394s
	iters: 300, epoch: 5 | loss: 0.3361426
	speed: 0.0430s/iter; left time: 219.8740s
	iters: 400, epoch: 5 | loss: 0.3220299
	speed: 0.0473s/iter; left time: 236.9785s
	iters: 500, epoch: 5 | loss: 0.3229633
	speed: 0.0484s/iter; left time: 237.6353s
	iters: 600, epoch: 5 | loss: 0.3446602
	speed: 0.0437s/iter; left time: 210.1247s
	iters: 700, epoch: 5 | loss: 0.2994532
	speed: 0.0453s/iter; left time: 213.5172s
	iters: 800, epoch: 5 | loss: 0.3389182
	speed: 0.0469s/iter; left time: 216.3645s
	iters: 900, epoch: 5 | loss: 0.3102732
	speed: 0.0458s/iter; left time: 206.4917s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.54s
Steps: 902 | Train Loss: 0.3286309 Vali Loss: 0.8320279 Test Loss: 1.0124506
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2721474
	speed: 0.1133s/iter; left time: 499.6856s
	iters: 200, epoch: 6 | loss: 0.2796655
	speed: 0.0492s/iter; left time: 212.0922s
	iters: 300, epoch: 6 | loss: 0.2728179
	speed: 0.0477s/iter; left time: 200.6867s
	iters: 400, epoch: 6 | loss: 0.2818705
	speed: 0.0485s/iter; left time: 199.2769s
	iters: 500, epoch: 6 | loss: 0.3008921
	speed: 0.0451s/iter; left time: 180.9723s
	iters: 600, epoch: 6 | loss: 0.2391719
	speed: 0.0483s/iter; left time: 188.7859s
	iters: 700, epoch: 6 | loss: 0.2640676
	speed: 0.0461s/iter; left time: 175.7160s
	iters: 800, epoch: 6 | loss: 0.2629663
	speed: 0.0476s/iter; left time: 176.4960s
	iters: 900, epoch: 6 | loss: 0.2862093
	speed: 0.0474s/iter; left time: 171.2444s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:43.09s
Steps: 902 | Train Loss: 0.2777607 Vali Loss: 0.8101708 Test Loss: 1.0729544
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
mse:0.9266458749771118, rmse:0.9626244902610779, mae:0.7018088698387146, rse:0.762569010257721

Extracted Metrics for DE, pred_len=168, iteration=1:
MSE: 0.8688871264457703, RMSE: 0.932141125202179, MAE: 0.6895283460617065, RSE: 0.738420844078064

Extracted Metrics for DE, pred_len=168, iteration=2:
MSE: 0.9266458749771118, RMSE: 0.9626244902610779, MAE: 0.7018088698387146, RSE: 0.762569010257721

=== Starting experiments for loss function: RMSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_24_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=24, inverse=False, loss_fnc='RMSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.9330069
	speed: 0.0757s/iter; left time: 678.4545s
	iters: 200, epoch: 1 | loss: 0.8453555
	speed: 0.0411s/iter; left time: 364.5196s
	iters: 300, epoch: 1 | loss: 0.7602814
	speed: 0.0434s/iter; left time: 380.6528s
	iters: 400, epoch: 1 | loss: 0.7186459
	speed: 0.0469s/iter; left time: 406.2299s
	iters: 500, epoch: 1 | loss: 0.6569836
	speed: 0.0463s/iter; left time: 396.5698s
	iters: 600, epoch: 1 | loss: 0.6428289
	speed: 0.0491s/iter; left time: 415.6338s
	iters: 700, epoch: 1 | loss: 0.7695857
	speed: 0.0453s/iter; left time: 378.5774s
	iters: 800, epoch: 1 | loss: 0.6622694
	speed: 0.0471s/iter; left time: 389.1302s
	iters: 900, epoch: 1 | loss: 0.5839673
	speed: 0.0450s/iter; left time: 367.0312s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:41.58s
Steps: 906 | Train Loss: 0.7568683 Vali Loss: 0.5546314 Test Loss: 0.6297955
Validation loss decreased (inf --> 0.554631).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4925327
	speed: 0.1021s/iter; left time: 822.4155s
	iters: 200, epoch: 2 | loss: 0.6552089
	speed: 0.0460s/iter; left time: 365.7620s
	iters: 300, epoch: 2 | loss: 0.5369264
	speed: 0.0481s/iter; left time: 378.1335s
	iters: 400, epoch: 2 | loss: 0.6216661
	speed: 0.0464s/iter; left time: 359.9221s
	iters: 500, epoch: 2 | loss: 0.4922632
	speed: 0.0385s/iter; left time: 294.8366s
	iters: 600, epoch: 2 | loss: 0.5242267
	speed: 0.0474s/iter; left time: 358.2048s
	iters: 700, epoch: 2 | loss: 0.5080407
	speed: 0.0447s/iter; left time: 332.9718s
	iters: 800, epoch: 2 | loss: 0.6309784
	speed: 0.0441s/iter; left time: 324.4123s
	iters: 900, epoch: 2 | loss: 0.5376483
	speed: 0.0462s/iter; left time: 335.3829s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:40.90s
Steps: 906 | Train Loss: 0.5750265 Vali Loss: 0.4414624 Test Loss: 0.5053346
Validation loss decreased (0.554631 --> 0.441462).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5605602
	speed: 0.1117s/iter; left time: 798.6254s
	iters: 200, epoch: 3 | loss: 0.4999320
	speed: 0.0484s/iter; left time: 341.0114s
	iters: 300, epoch: 3 | loss: 0.5261015
	speed: 0.0481s/iter; left time: 334.2855s
	iters: 400, epoch: 3 | loss: 0.5118964
	speed: 0.0463s/iter; left time: 317.3303s
	iters: 500, epoch: 3 | loss: 0.6048349
	speed: 0.0475s/iter; left time: 320.5629s
	iters: 600, epoch: 3 | loss: 0.5581745
	speed: 0.0482s/iter; left time: 320.7651s
	iters: 700, epoch: 3 | loss: 0.5284329
	speed: 0.0454s/iter; left time: 297.4727s
	iters: 800, epoch: 3 | loss: 0.5078094
	speed: 0.0431s/iter; left time: 277.6537s
	iters: 900, epoch: 3 | loss: 0.5344877
	speed: 0.0445s/iter; left time: 282.5761s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:42.24s
Steps: 906 | Train Loss: 0.5267524 Vali Loss: 0.4544460 Test Loss: 0.4899718
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4936729
	speed: 0.1149s/iter; left time: 717.3971s
	iters: 200, epoch: 4 | loss: 0.4679694
	speed: 0.0480s/iter; left time: 294.7833s
	iters: 300, epoch: 4 | loss: 0.4733409
	speed: 0.0475s/iter; left time: 286.8630s
	iters: 400, epoch: 4 | loss: 0.4508262
	speed: 0.0439s/iter; left time: 261.1532s
	iters: 500, epoch: 4 | loss: 0.5471892
	speed: 0.0484s/iter; left time: 282.9299s
	iters: 600, epoch: 4 | loss: 0.5013523
	speed: 0.0389s/iter; left time: 223.3281s
	iters: 700, epoch: 4 | loss: 0.4698382
	speed: 0.0436s/iter; left time: 246.2966s
	iters: 800, epoch: 4 | loss: 0.5174342
	speed: 0.0498s/iter; left time: 276.0929s
	iters: 900, epoch: 4 | loss: 0.4840794
	speed: 0.0442s/iter; left time: 240.4014s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:42.26s
Steps: 906 | Train Loss: 0.4860738 Vali Loss: 0.4616316 Test Loss: 0.4971804
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4414572
	speed: 0.1078s/iter; left time: 575.0675s
	iters: 200, epoch: 5 | loss: 0.4247738
	speed: 0.0466s/iter; left time: 243.8683s
	iters: 300, epoch: 5 | loss: 0.4171564
	speed: 0.0467s/iter; left time: 239.9151s
	iters: 400, epoch: 5 | loss: 0.4687782
	speed: 0.0400s/iter; left time: 201.3142s
	iters: 500, epoch: 5 | loss: 0.4089259
	speed: 0.0466s/iter; left time: 229.9950s
	iters: 600, epoch: 5 | loss: 0.4598964
	speed: 0.0434s/iter; left time: 210.1435s
	iters: 700, epoch: 5 | loss: 0.4366154
	speed: 0.0466s/iter; left time: 220.8223s
	iters: 800, epoch: 5 | loss: 0.4666919
	speed: 0.0438s/iter; left time: 203.0281s
	iters: 900, epoch: 5 | loss: 0.4258851
	speed: 0.0391s/iter; left time: 177.1745s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:40.66s
Steps: 906 | Train Loss: 0.4412755 Vali Loss: 0.4771856 Test Loss: 0.5294752
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
mse:0.5057210326194763, rmse:0.7111406326293945, mae:0.4946559965610504, rse:0.5628229379653931
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.8535094
	speed: 0.0503s/iter; left time: 450.3869s
	iters: 200, epoch: 1 | loss: 0.7946691
	speed: 0.0478s/iter; left time: 423.7283s
	iters: 300, epoch: 1 | loss: 0.8239724
	speed: 0.0411s/iter; left time: 360.2720s
	iters: 400, epoch: 1 | loss: 0.7694098
	speed: 0.0464s/iter; left time: 401.5208s
	iters: 500, epoch: 1 | loss: 0.7350209
	speed: 0.0447s/iter; left time: 382.3435s
	iters: 600, epoch: 1 | loss: 0.6871554
	speed: 0.0484s/iter; left time: 409.2717s
	iters: 700, epoch: 1 | loss: 0.6397360
	speed: 0.0470s/iter; left time: 392.9268s
	iters: 800, epoch: 1 | loss: 0.6996447
	speed: 0.0416s/iter; left time: 343.4839s
	iters: 900, epoch: 1 | loss: 0.6448403
	speed: 0.0423s/iter; left time: 344.8698s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:41.29s
Steps: 906 | Train Loss: 0.7621180 Vali Loss: 0.5469301 Test Loss: 0.6322393
Validation loss decreased (inf --> 0.546930).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5901652
	speed: 0.1033s/iter; left time: 832.4697s
	iters: 200, epoch: 2 | loss: 0.5678676
	speed: 0.0445s/iter; left time: 354.1259s
	iters: 300, epoch: 2 | loss: 0.5308166
	speed: 0.0455s/iter; left time: 357.6625s
	iters: 400, epoch: 2 | loss: 0.5040628
	speed: 0.0445s/iter; left time: 344.9546s
	iters: 500, epoch: 2 | loss: 0.5594317
	speed: 0.0416s/iter; left time: 318.1548s
	iters: 600, epoch: 2 | loss: 0.5838062
	speed: 0.0451s/iter; left time: 341.0750s
	iters: 700, epoch: 2 | loss: 0.5541881
	speed: 0.0279s/iter; left time: 208.2252s
	iters: 800, epoch: 2 | loss: 0.4941785
	speed: 0.0393s/iter; left time: 289.3656s
	iters: 900, epoch: 2 | loss: 0.5622355
	speed: 0.0440s/iter; left time: 319.5572s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.04s
Steps: 906 | Train Loss: 0.5777639 Vali Loss: 0.4899707 Test Loss: 0.5332431
Validation loss decreased (0.546930 --> 0.489971).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6155403
	speed: 0.1131s/iter; left time: 808.2134s
	iters: 200, epoch: 3 | loss: 0.5076671
	speed: 0.0474s/iter; left time: 334.2322s
	iters: 300, epoch: 3 | loss: 0.4814539
	speed: 0.0477s/iter; left time: 331.6706s
	iters: 400, epoch: 3 | loss: 0.5277675
	speed: 0.0349s/iter; left time: 239.0048s
	iters: 500, epoch: 3 | loss: 0.5166872
	speed: 0.0440s/iter; left time: 297.2397s
	iters: 600, epoch: 3 | loss: 0.4973823
	speed: 0.0386s/iter; left time: 256.7637s
	iters: 700, epoch: 3 | loss: 0.5548823
	speed: 0.0448s/iter; left time: 293.6382s
	iters: 800, epoch: 3 | loss: 0.5437278
	speed: 0.0464s/iter; left time: 299.2056s
	iters: 900, epoch: 3 | loss: 0.4600593
	speed: 0.0430s/iter; left time: 272.7963s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:40.10s
Steps: 906 | Train Loss: 0.5295003 Vali Loss: 0.4463684 Test Loss: 0.4901480
Validation loss decreased (0.489971 --> 0.446368).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4812785
	speed: 0.1083s/iter; left time: 675.8931s
	iters: 200, epoch: 4 | loss: 0.4892790
	speed: 0.0496s/iter; left time: 304.9519s
	iters: 300, epoch: 4 | loss: 0.6160949
	speed: 0.0494s/iter; left time: 298.7421s
	iters: 400, epoch: 4 | loss: 0.4594419
	speed: 0.0470s/iter; left time: 279.6086s
	iters: 500, epoch: 4 | loss: 0.5361103
	speed: 0.0432s/iter; left time: 252.4201s
	iters: 600, epoch: 4 | loss: 0.5496232
	speed: 0.0459s/iter; left time: 263.8301s
	iters: 700, epoch: 4 | loss: 0.5037587
	speed: 0.0458s/iter; left time: 258.6352s
	iters: 800, epoch: 4 | loss: 0.4001136
	speed: 0.0461s/iter; left time: 255.2893s
	iters: 900, epoch: 4 | loss: 0.3969443
	speed: 0.0466s/iter; left time: 253.5491s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:42.36s
Steps: 906 | Train Loss: 0.4886948 Vali Loss: 0.4524543 Test Loss: 0.5091438
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.5059643
	speed: 0.1103s/iter; left time: 588.4948s
	iters: 200, epoch: 5 | loss: 0.4228405
	speed: 0.0444s/iter; left time: 232.7318s
	iters: 300, epoch: 5 | loss: 0.4532999
	speed: 0.0477s/iter; left time: 244.9761s
	iters: 400, epoch: 5 | loss: 0.4513590
	speed: 0.0462s/iter; left time: 232.9449s
	iters: 500, epoch: 5 | loss: 0.3767618
	speed: 0.0473s/iter; left time: 233.4467s
	iters: 600, epoch: 5 | loss: 0.4681946
	speed: 0.0504s/iter; left time: 243.7942s
	iters: 700, epoch: 5 | loss: 0.4070669
	speed: 0.0478s/iter; left time: 226.4354s
	iters: 800, epoch: 5 | loss: 0.4433880
	speed: 0.0469s/iter; left time: 217.4913s
	iters: 900, epoch: 5 | loss: 0.4146545
	speed: 0.0467s/iter; left time: 211.9953s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.20s
Steps: 906 | Train Loss: 0.4431850 Vali Loss: 0.4535797 Test Loss: 0.4955657
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.4227463
	speed: 0.1035s/iter; left time: 458.7956s
	iters: 200, epoch: 6 | loss: 0.4208098
	speed: 0.0474s/iter; left time: 205.1766s
	iters: 300, epoch: 6 | loss: 0.4598391
	speed: 0.0461s/iter; left time: 195.1145s
	iters: 400, epoch: 6 | loss: 0.4062849
	speed: 0.0481s/iter; left time: 198.9043s
	iters: 500, epoch: 6 | loss: 0.3981254
	speed: 0.0462s/iter; left time: 186.2537s
	iters: 600, epoch: 6 | loss: 0.3871465
	speed: 0.0453s/iter; left time: 178.2389s
	iters: 700, epoch: 6 | loss: 0.3854539
	speed: 0.0477s/iter; left time: 182.7942s
	iters: 800, epoch: 6 | loss: 0.3696713
	speed: 0.0488s/iter; left time: 181.9935s
	iters: 900, epoch: 6 | loss: 0.3746774
	speed: 0.0431s/iter; left time: 156.6726s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:42.07s
Steps: 906 | Train Loss: 0.4019445 Vali Loss: 0.4811350 Test Loss: 0.5307937
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
mse:0.48906710743904114, rmse:0.6993333101272583, mae:0.47708749771118164, rse:0.5534781813621521

Extracted Metrics for DE, pred_len=24, iteration=1:
MSE: 0.5057210326194763, RMSE: 0.7111406326293945, MAE: 0.4946559965610504, RSE: 0.5628229379653931

Extracted Metrics for DE, pred_len=24, iteration=2:
MSE: 0.48906710743904114, RMSE: 0.6993333101272583, MAE: 0.47708749771118164, RSE: 0.5534781813621521

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_96_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=96, inverse=False, loss_fnc='RMSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 1.0264677
	speed: 0.0818s/iter; left time: 731.1856s
	iters: 200, epoch: 1 | loss: 0.9801179
	speed: 0.0337s/iter; left time: 298.0465s
	iters: 300, epoch: 1 | loss: 0.9595107
	speed: 0.0469s/iter; left time: 409.6896s
	iters: 400, epoch: 1 | loss: 0.8818166
	speed: 0.0454s/iter; left time: 392.4995s
	iters: 500, epoch: 1 | loss: 0.8849459
	speed: 0.0464s/iter; left time: 396.4358s
	iters: 600, epoch: 1 | loss: 0.8034068
	speed: 0.0441s/iter; left time: 372.5535s
	iters: 700, epoch: 1 | loss: 0.7850668
	speed: 0.0459s/iter; left time: 382.7622s
	iters: 800, epoch: 1 | loss: 0.8018121
	speed: 0.0442s/iter; left time: 364.5291s
	iters: 900, epoch: 1 | loss: 0.8086565
	speed: 0.0447s/iter; left time: 363.9261s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:41.22s
Steps: 904 | Train Loss: 0.8982253 Vali Loss: 0.8284824 Test Loss: 1.0305047
Validation loss decreased (inf --> 0.828482).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7219115
	speed: 0.1064s/iter; left time: 854.7557s
	iters: 200, epoch: 2 | loss: 0.7575591
	speed: 0.0488s/iter; left time: 387.1885s
	iters: 300, epoch: 2 | loss: 0.7236546
	speed: 0.0485s/iter; left time: 380.4791s
	iters: 400, epoch: 2 | loss: 0.6981441
	speed: 0.0512s/iter; left time: 396.4393s
	iters: 500, epoch: 2 | loss: 0.6987032
	speed: 0.0469s/iter; left time: 358.3607s
	iters: 600, epoch: 2 | loss: 0.7710373
	speed: 0.0450s/iter; left time: 339.4294s
	iters: 700, epoch: 2 | loss: 0.6912770
	speed: 0.0475s/iter; left time: 353.1112s
	iters: 800, epoch: 2 | loss: 0.7383023
	speed: 0.0360s/iter; left time: 264.3670s
	iters: 900, epoch: 2 | loss: 0.6886944
	speed: 0.0403s/iter; left time: 291.2985s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:41.41s
Steps: 904 | Train Loss: 0.7270669 Vali Loss: 0.6901102 Test Loss: 0.8281889
Validation loss decreased (0.828482 --> 0.690110).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.7503220
	speed: 0.1059s/iter; left time: 755.0869s
	iters: 200, epoch: 3 | loss: 0.6363679
	speed: 0.0373s/iter; left time: 262.2750s
	iters: 300, epoch: 3 | loss: 0.6213876
	speed: 0.0480s/iter; left time: 332.5645s
	iters: 400, epoch: 3 | loss: 0.6248445
	speed: 0.0496s/iter; left time: 339.0722s
	iters: 500, epoch: 3 | loss: 0.6535972
	speed: 0.0430s/iter; left time: 289.3550s
	iters: 600, epoch: 3 | loss: 0.6578666
	speed: 0.0408s/iter; left time: 270.6746s
	iters: 700, epoch: 3 | loss: 0.6138929
	speed: 0.0435s/iter; left time: 283.8799s
	iters: 800, epoch: 3 | loss: 0.6245969
	speed: 0.0453s/iter; left time: 291.6374s
	iters: 900, epoch: 3 | loss: 0.6433622
	speed: 0.0462s/iter; left time: 292.5791s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:40.13s
Steps: 904 | Train Loss: 0.6530545 Vali Loss: 0.6907275 Test Loss: 0.8539100
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5800280
	speed: 0.1072s/iter; left time: 667.6298s
	iters: 200, epoch: 4 | loss: 0.6194643
	speed: 0.0472s/iter; left time: 289.1371s
	iters: 300, epoch: 4 | loss: 0.5794554
	speed: 0.0477s/iter; left time: 287.4611s
	iters: 400, epoch: 4 | loss: 0.5340925
	speed: 0.0465s/iter; left time: 275.9308s
	iters: 500, epoch: 4 | loss: 0.6164418
	speed: 0.0484s/iter; left time: 282.2499s
	iters: 600, epoch: 4 | loss: 0.5517719
	speed: 0.0474s/iter; left time: 271.2856s
	iters: 700, epoch: 4 | loss: 0.6099968
	speed: 0.0479s/iter; left time: 269.4988s
	iters: 800, epoch: 4 | loss: 0.5545557
	speed: 0.0353s/iter; left time: 194.9819s
	iters: 900, epoch: 4 | loss: 0.6094258
	speed: 0.0318s/iter; left time: 172.4671s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:40.53s
Steps: 904 | Train Loss: 0.5975364 Vali Loss: 0.7084284 Test Loss: 0.9339083
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.5656684
	speed: 0.0889s/iter; left time: 473.6508s
	iters: 200, epoch: 5 | loss: 0.6042323
	speed: 0.0435s/iter; left time: 227.1767s
	iters: 300, epoch: 5 | loss: 0.5565632
	speed: 0.0480s/iter; left time: 245.8606s
	iters: 400, epoch: 5 | loss: 0.5871056
	speed: 0.0449s/iter; left time: 225.6866s
	iters: 500, epoch: 5 | loss: 0.5080324
	speed: 0.0460s/iter; left time: 226.5098s
	iters: 600, epoch: 5 | loss: 0.5494707
	speed: 0.0471s/iter; left time: 227.4873s
	iters: 700, epoch: 5 | loss: 0.5326818
	speed: 0.0493s/iter; left time: 233.1622s
	iters: 800, epoch: 5 | loss: 0.4755292
	speed: 0.0456s/iter; left time: 211.1026s
	iters: 900, epoch: 5 | loss: 0.5099325
	speed: 0.0460s/iter; left time: 208.2061s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:40.59s
Steps: 904 | Train Loss: 0.5448991 Vali Loss: 0.7290903 Test Loss: 0.9332197
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
mse:0.8274734616279602, rmse:0.9096556901931763, mae:0.6720293760299683, rse:0.7214690446853638
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.9505200
	speed: 0.0483s/iter; left time: 431.6384s
	iters: 200, epoch: 1 | loss: 0.9048980
	speed: 0.0457s/iter; left time: 404.2320s
	iters: 300, epoch: 1 | loss: 0.9254318
	speed: 0.0450s/iter; left time: 392.9740s
	iters: 400, epoch: 1 | loss: 0.9067376
	speed: 0.0436s/iter; left time: 376.4874s
	iters: 500, epoch: 1 | loss: 0.9278110
	speed: 0.0468s/iter; left time: 399.7317s
	iters: 600, epoch: 1 | loss: 0.8114620
	speed: 0.0464s/iter; left time: 391.7953s
	iters: 700, epoch: 1 | loss: 0.9604274
	speed: 0.0466s/iter; left time: 388.6727s
	iters: 800, epoch: 1 | loss: 0.8274011
	speed: 0.0459s/iter; left time: 378.4566s
	iters: 900, epoch: 1 | loss: 0.8536888
	speed: 0.0449s/iter; left time: 365.2601s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:41.58s
Steps: 904 | Train Loss: 0.9021629 Vali Loss: 0.8219671 Test Loss: 1.0340171
Validation loss decreased (inf --> 0.821967).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8083791
	speed: 0.1068s/iter; left time: 858.1971s
	iters: 200, epoch: 2 | loss: 0.7864435
	speed: 0.0476s/iter; left time: 377.4207s
	iters: 300, epoch: 2 | loss: 0.7446700
	speed: 0.0484s/iter; left time: 379.0859s
	iters: 400, epoch: 2 | loss: 0.6564226
	speed: 0.0477s/iter; left time: 368.9011s
	iters: 500, epoch: 2 | loss: 0.6981217
	speed: 0.0439s/iter; left time: 335.6301s
	iters: 600, epoch: 2 | loss: 0.7814509
	speed: 0.0315s/iter; left time: 237.1978s
	iters: 700, epoch: 2 | loss: 0.7051031
	speed: 0.0393s/iter; left time: 291.9354s
	iters: 800, epoch: 2 | loss: 0.7401963
	speed: 0.0453s/iter; left time: 332.2627s
	iters: 900, epoch: 2 | loss: 0.6389695
	speed: 0.0417s/iter; left time: 301.8124s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:39.64s
Steps: 904 | Train Loss: 0.7266495 Vali Loss: 0.6755250 Test Loss: 0.8264167
Validation loss decreased (0.821967 --> 0.675525).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6733680
	speed: 0.1069s/iter; left time: 762.7999s
	iters: 200, epoch: 3 | loss: 0.6566669
	speed: 0.0471s/iter; left time: 331.2583s
	iters: 300, epoch: 3 | loss: 0.6292443
	speed: 0.0444s/iter; left time: 307.5608s
	iters: 400, epoch: 3 | loss: 0.6274866
	speed: 0.0472s/iter; left time: 322.6036s
	iters: 500, epoch: 3 | loss: 0.6195701
	speed: 0.0434s/iter; left time: 291.9572s
	iters: 600, epoch: 3 | loss: 0.6395187
	speed: 0.0482s/iter; left time: 319.8340s
	iters: 700, epoch: 3 | loss: 0.6765928
	speed: 0.0434s/iter; left time: 283.2637s
	iters: 800, epoch: 3 | loss: 0.6868142
	speed: 0.0458s/iter; left time: 294.4147s
	iters: 900, epoch: 3 | loss: 0.6339136
	speed: 0.0482s/iter; left time: 305.4835s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:41.70s
Steps: 904 | Train Loss: 0.6473826 Vali Loss: 0.7033238 Test Loss: 0.8842263
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5862736
	speed: 0.1056s/iter; left time: 658.0080s
	iters: 200, epoch: 4 | loss: 0.5791789
	speed: 0.0442s/iter; left time: 271.0017s
	iters: 300, epoch: 4 | loss: 0.5872557
	speed: 0.0481s/iter; left time: 289.7939s
	iters: 400, epoch: 4 | loss: 0.5707231
	speed: 0.0469s/iter; left time: 277.9367s
	iters: 500, epoch: 4 | loss: 0.5918388
	speed: 0.0437s/iter; left time: 254.9425s
	iters: 600, epoch: 4 | loss: 0.5781083
	speed: 0.0452s/iter; left time: 258.7665s
	iters: 700, epoch: 4 | loss: 0.5535720
	speed: 0.0394s/iter; left time: 221.9433s
	iters: 800, epoch: 4 | loss: 0.5847025
	speed: 0.0475s/iter; left time: 262.6802s
	iters: 900, epoch: 4 | loss: 0.5420276
	speed: 0.0502s/iter; left time: 272.6560s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:41.57s
Steps: 904 | Train Loss: 0.5948404 Vali Loss: 0.7119789 Test Loss: 0.9509454
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.5292706
	speed: 0.1079s/iter; left time: 574.5897s
	iters: 200, epoch: 5 | loss: 0.5874758
	speed: 0.0474s/iter; left time: 247.5933s
	iters: 300, epoch: 5 | loss: 0.5466622
	speed: 0.0486s/iter; left time: 249.2745s
	iters: 400, epoch: 5 | loss: 0.4963609
	speed: 0.0463s/iter; left time: 232.8750s
	iters: 500, epoch: 5 | loss: 0.5946056
	speed: 0.0414s/iter; left time: 203.7038s
	iters: 600, epoch: 5 | loss: 0.5386021
	speed: 0.0420s/iter; left time: 202.6301s
	iters: 700, epoch: 5 | loss: 0.5422313
	speed: 0.0419s/iter; left time: 197.9839s
	iters: 800, epoch: 5 | loss: 0.5409650
	speed: 0.0387s/iter; left time: 178.9359s
	iters: 900, epoch: 5 | loss: 0.5217851
	speed: 0.0487s/iter; left time: 220.2706s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:40.88s
Steps: 904 | Train Loss: 0.5457621 Vali Loss: 0.6975093 Test Loss: 0.9718154
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
mse:0.8260217308998108, rmse:0.9088574051856995, mae:0.6637703776359558, rse:0.7208359241485596

Extracted Metrics for DE, pred_len=96, iteration=1:
MSE: 0.8274734616279602, RMSE: 0.9096556901931763, MAE: 0.6720293760299683, RSE: 0.7214690446853638

Extracted Metrics for DE, pred_len=96, iteration=2:
MSE: 0.8260217308998108, RMSE: 0.9088574051856995, MAE: 0.6637703776359558, RSE: 0.7208359241485596

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_168_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=168, inverse=False, loss_fnc='RMSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.9474945
	speed: 0.0842s/iter; left time: 751.0800s
	iters: 200, epoch: 1 | loss: 0.9880003
	speed: 0.0464s/iter; left time: 409.4297s
	iters: 300, epoch: 1 | loss: 0.9314516
	speed: 0.0505s/iter; left time: 440.4310s
	iters: 400, epoch: 1 | loss: 0.9342875
	speed: 0.0488s/iter; left time: 420.3275s
	iters: 500, epoch: 1 | loss: 0.9170157
	speed: 0.0441s/iter; left time: 376.1227s
	iters: 600, epoch: 1 | loss: 0.9418470
	speed: 0.0485s/iter; left time: 408.7062s
	iters: 700, epoch: 1 | loss: 0.9130619
	speed: 0.0483s/iter; left time: 401.9092s
	iters: 800, epoch: 1 | loss: 0.8756982
	speed: 0.0427s/iter; left time: 351.4144s
	iters: 900, epoch: 1 | loss: 0.9110941
	speed: 0.0483s/iter; left time: 391.9247s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:43.77s
Steps: 902 | Train Loss: 0.9340611 Vali Loss: 0.9775705 Test Loss: 1.2568259
Validation loss decreased (inf --> 0.977571).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9062395
	speed: 0.1190s/iter; left time: 953.9984s
	iters: 200, epoch: 2 | loss: 0.8344246
	speed: 0.0504s/iter; left time: 399.1297s
	iters: 300, epoch: 2 | loss: 0.8586082
	speed: 0.0455s/iter; left time: 355.9932s
	iters: 400, epoch: 2 | loss: 0.7839647
	speed: 0.0422s/iter; left time: 325.7750s
	iters: 500, epoch: 2 | loss: 0.7777457
	speed: 0.0403s/iter; left time: 306.8636s
	iters: 600, epoch: 2 | loss: 0.7107472
	speed: 0.0330s/iter; left time: 248.2740s
	iters: 700, epoch: 2 | loss: 0.7191603
	speed: 0.0448s/iter; left time: 332.7316s
	iters: 800, epoch: 2 | loss: 0.7799003
	speed: 0.0452s/iter; left time: 330.6656s
	iters: 900, epoch: 2 | loss: 0.6977441
	speed: 0.0394s/iter; left time: 284.5371s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:39.31s
Steps: 902 | Train Loss: 0.7721754 Vali Loss: 0.7377347 Test Loss: 0.8857483
Validation loss decreased (0.977571 --> 0.737735).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.7026943
	speed: 0.1114s/iter; left time: 792.5189s
	iters: 200, epoch: 3 | loss: 0.6979058
	speed: 0.0459s/iter; left time: 322.1674s
	iters: 300, epoch: 3 | loss: 0.7006507
	speed: 0.0436s/iter; left time: 301.4883s
	iters: 400, epoch: 3 | loss: 0.6993150
	speed: 0.0454s/iter; left time: 309.5378s
	iters: 500, epoch: 3 | loss: 0.6774469
	speed: 0.0483s/iter; left time: 324.5061s
	iters: 600, epoch: 3 | loss: 0.6877993
	speed: 0.0456s/iter; left time: 301.6082s
	iters: 700, epoch: 3 | loss: 0.6872499
	speed: 0.0486s/iter; left time: 317.0035s
	iters: 800, epoch: 3 | loss: 0.6633852
	speed: 0.0471s/iter; left time: 302.3795s
	iters: 900, epoch: 3 | loss: 0.6497076
	speed: 0.0447s/iter; left time: 282.4843s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:41.64s
Steps: 902 | Train Loss: 0.6727804 Vali Loss: 0.7758864 Test Loss: 0.9433555
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6027426
	speed: 0.1043s/iter; left time: 648.3207s
	iters: 200, epoch: 4 | loss: 0.5640168
	speed: 0.0481s/iter; left time: 293.8482s
	iters: 300, epoch: 4 | loss: 0.6507311
	speed: 0.0470s/iter; left time: 282.4644s
	iters: 400, epoch: 4 | loss: 0.6264582
	speed: 0.0474s/iter; left time: 280.1881s
	iters: 500, epoch: 4 | loss: 0.6524476
	speed: 0.0395s/iter; left time: 229.7198s
	iters: 600, epoch: 4 | loss: 0.5816422
	speed: 0.0500s/iter; left time: 285.9913s
	iters: 700, epoch: 4 | loss: 0.6202571
	speed: 0.0473s/iter; left time: 265.5145s
	iters: 800, epoch: 4 | loss: 0.6127720
	speed: 0.0478s/iter; left time: 263.4674s
	iters: 900, epoch: 4 | loss: 0.5799875
	speed: 0.0467s/iter; left time: 252.7783s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:41.66s
Steps: 902 | Train Loss: 0.6133093 Vali Loss: 0.8142605 Test Loss: 0.9736470
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.6158162
	speed: 0.1087s/iter; left time: 577.3763s
	iters: 200, epoch: 5 | loss: 0.5823934
	speed: 0.0456s/iter; left time: 237.7623s
	iters: 300, epoch: 5 | loss: 0.5776101
	speed: 0.0397s/iter; left time: 202.9117s
	iters: 400, epoch: 5 | loss: 0.5875373
	speed: 0.0435s/iter; left time: 217.9909s
	iters: 500, epoch: 5 | loss: 0.5067228
	speed: 0.0489s/iter; left time: 240.0825s
	iters: 600, epoch: 5 | loss: 0.5445983
	speed: 0.0459s/iter; left time: 220.8986s
	iters: 700, epoch: 5 | loss: 0.5707757
	speed: 0.0424s/iter; left time: 199.7329s
	iters: 800, epoch: 5 | loss: 0.5409237
	speed: 0.0434s/iter; left time: 200.1174s
	iters: 900, epoch: 5 | loss: 0.5059790
	speed: 0.0491s/iter; left time: 221.4147s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:40.53s
Steps: 902 | Train Loss: 0.5592844 Vali Loss: 0.8281794 Test Loss: 1.0037689
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
mse:0.8860350251197815, rmse:0.9412943124771118, mae:0.698183000087738, rse:0.745671808719635
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 1.0668987
	speed: 0.0441s/iter; left time: 393.2643s
	iters: 200, epoch: 1 | loss: 0.9551254
	speed: 0.0436s/iter; left time: 384.2397s
	iters: 300, epoch: 1 | loss: 0.8664408
	speed: 0.0483s/iter; left time: 421.6565s
	iters: 400, epoch: 1 | loss: 0.9394103
	speed: 0.0476s/iter; left time: 410.6138s
	iters: 500, epoch: 1 | loss: 0.9028875
	speed: 0.0479s/iter; left time: 408.2730s
	iters: 600, epoch: 1 | loss: 0.9296364
	speed: 0.0467s/iter; left time: 393.0940s
	iters: 700, epoch: 1 | loss: 0.9338796
	speed: 0.0395s/iter; left time: 328.3337s
	iters: 800, epoch: 1 | loss: 0.8771542
	speed: 0.0461s/iter; left time: 378.9000s
	iters: 900, epoch: 1 | loss: 0.8804492
	speed: 0.0488s/iter; left time: 396.4345s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:41.42s
Steps: 902 | Train Loss: 0.9323722 Vali Loss: 0.9888522 Test Loss: 1.2656890
Validation loss decreased (inf --> 0.988852).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9009312
	speed: 0.1178s/iter; left time: 944.5419s
	iters: 200, epoch: 2 | loss: 0.8135657
	speed: 0.0479s/iter; left time: 378.9337s
	iters: 300, epoch: 2 | loss: 0.8319606
	speed: 0.0462s/iter; left time: 361.3329s
	iters: 400, epoch: 2 | loss: 0.7027991
	speed: 0.0386s/iter; left time: 298.1869s
	iters: 500, epoch: 2 | loss: 0.7844998
	speed: 0.0489s/iter; left time: 372.2256s
	iters: 600, epoch: 2 | loss: 0.7350895
	speed: 0.0414s/iter; left time: 310.9113s
	iters: 700, epoch: 2 | loss: 0.7573729
	speed: 0.0465s/iter; left time: 345.2184s
	iters: 800, epoch: 2 | loss: 0.7036802
	speed: 0.0468s/iter; left time: 342.7650s
	iters: 900, epoch: 2 | loss: 0.6937279
	speed: 0.0469s/iter; left time: 338.6603s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:41.58s
Steps: 902 | Train Loss: 0.7838762 Vali Loss: 0.7578838 Test Loss: 0.8892961
Validation loss decreased (0.988852 --> 0.757884).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6972606
	speed: 0.1183s/iter; left time: 842.0171s
	iters: 200, epoch: 3 | loss: 0.6568254
	speed: 0.0435s/iter; left time: 305.3319s
	iters: 300, epoch: 3 | loss: 0.6503654
	speed: 0.0500s/iter; left time: 346.0632s
	iters: 400, epoch: 3 | loss: 0.6296730
	speed: 0.0457s/iter; left time: 311.3428s
	iters: 500, epoch: 3 | loss: 0.6704645
	speed: 0.0458s/iter; left time: 307.9493s
	iters: 600, epoch: 3 | loss: 0.6691087
	speed: 0.0460s/iter; left time: 304.0803s
	iters: 700, epoch: 3 | loss: 0.6822655
	speed: 0.0500s/iter; left time: 325.9312s
	iters: 800, epoch: 3 | loss: 0.5971730
	speed: 0.0419s/iter; left time: 268.7210s
	iters: 900, epoch: 3 | loss: 0.6552797
	speed: 0.0424s/iter; left time: 267.9930s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:41.83s
Steps: 902 | Train Loss: 0.6800711 Vali Loss: 0.7312239 Test Loss: 0.9080275
Validation loss decreased (0.757884 --> 0.731224).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6022609
	speed: 0.1184s/iter; left time: 735.7443s
	iters: 200, epoch: 4 | loss: 0.6469847
	speed: 0.0484s/iter; left time: 296.0590s
	iters: 300, epoch: 4 | loss: 0.6710585
	speed: 0.0439s/iter; left time: 264.1506s
	iters: 400, epoch: 4 | loss: 0.6569029
	speed: 0.0472s/iter; left time: 279.0485s
	iters: 500, epoch: 4 | loss: 0.6609409
	speed: 0.0395s/iter; left time: 229.8602s
	iters: 600, epoch: 4 | loss: 0.6275567
	speed: 0.0367s/iter; left time: 209.9763s
	iters: 700, epoch: 4 | loss: 0.5990750
	speed: 0.0482s/iter; left time: 270.6426s
	iters: 800, epoch: 4 | loss: 0.5690438
	speed: 0.0451s/iter; left time: 248.9726s
	iters: 900, epoch: 4 | loss: 0.6207455
	speed: 0.0452s/iter; left time: 244.5792s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:40.69s
Steps: 902 | Train Loss: 0.6193849 Vali Loss: 0.7912178 Test Loss: 0.9645185
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.5901183
	speed: 0.1121s/iter; left time: 595.5942s
	iters: 200, epoch: 5 | loss: 0.5357261
	speed: 0.0465s/iter; left time: 242.1696s
	iters: 300, epoch: 5 | loss: 0.5676790
	speed: 0.0488s/iter; left time: 249.3625s
	iters: 400, epoch: 5 | loss: 0.5470582
	speed: 0.0463s/iter; left time: 232.0109s
	iters: 500, epoch: 5 | loss: 0.5785877
	speed: 0.0458s/iter; left time: 225.0886s
	iters: 600, epoch: 5 | loss: 0.5758328
	speed: 0.0471s/iter; left time: 226.5465s
	iters: 700, epoch: 5 | loss: 0.5455018
	speed: 0.0505s/iter; left time: 237.7742s
	iters: 800, epoch: 5 | loss: 0.5653980
	speed: 0.0390s/iter; left time: 180.0585s
	iters: 900, epoch: 5 | loss: 0.5421784
	speed: 0.0471s/iter; left time: 212.7865s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:42.07s
Steps: 902 | Train Loss: 0.5636586 Vali Loss: 0.8288397 Test Loss: 0.9748059
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.5102292
	speed: 0.1028s/iter; left time: 453.5305s
	iters: 200, epoch: 6 | loss: 0.5145868
	speed: 0.0451s/iter; left time: 194.5062s
	iters: 300, epoch: 6 | loss: 0.5022091
	speed: 0.0433s/iter; left time: 182.5153s
	iters: 400, epoch: 6 | loss: 0.5260614
	speed: 0.0432s/iter; left time: 177.4205s
	iters: 500, epoch: 6 | loss: 0.5395907
	speed: 0.0437s/iter; left time: 175.0813s
	iters: 600, epoch: 6 | loss: 0.4853570
	speed: 0.0458s/iter; left time: 179.1295s
	iters: 700, epoch: 6 | loss: 0.5272974
	speed: 0.0468s/iter; left time: 178.4430s
	iters: 800, epoch: 6 | loss: 0.4901076
	speed: 0.0498s/iter; left time: 184.7655s
	iters: 900, epoch: 6 | loss: 0.5051708
	speed: 0.0496s/iter; left time: 179.1110s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:40.92s
Steps: 902 | Train Loss: 0.5145088 Vali Loss: 0.8555480 Test Loss: 1.0754648
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
mse:0.9077568054199219, rmse:0.9527627229690552, mae:0.6933366656303406, rse:0.7547568082809448

Extracted Metrics for DE, pred_len=168, iteration=1:
MSE: 0.8860350251197815, RMSE: 0.9412943124771118, MAE: 0.698183000087738, RSE: 0.745671808719635

Extracted Metrics for DE, pred_len=168, iteration=2:
MSE: 0.9077568054199219, RMSE: 0.9527627229690552, MAE: 0.6933366656303406, RSE: 0.7547568082809448

=== Starting experiments for loss function: MAE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_24_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.7291694
	speed: 0.0714s/iter; left time: 639.7119s
	iters: 200, epoch: 1 | loss: 0.6625319
	speed: 0.0420s/iter; left time: 372.4430s
	iters: 300, epoch: 1 | loss: 0.6019017
	speed: 0.0470s/iter; left time: 411.5196s
	iters: 400, epoch: 1 | loss: 0.5508921
	speed: 0.0462s/iter; left time: 399.9227s
	iters: 500, epoch: 1 | loss: 0.5146177
	speed: 0.0450s/iter; left time: 385.2477s
	iters: 600, epoch: 1 | loss: 0.5150010
	speed: 0.0465s/iter; left time: 393.8133s
	iters: 700, epoch: 1 | loss: 0.6034381
	speed: 0.0450s/iter; left time: 376.0126s
	iters: 800, epoch: 1 | loss: 0.5074895
	speed: 0.0448s/iter; left time: 369.8282s
	iters: 900, epoch: 1 | loss: 0.4430981
	speed: 0.0454s/iter; left time: 370.6810s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:41.13s
Steps: 906 | Train Loss: 0.5920067 Vali Loss: 0.5611692 Test Loss: 0.5965769
Validation loss decreased (inf --> 0.561169).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3720299
	speed: 0.1095s/iter; left time: 882.3953s
	iters: 200, epoch: 2 | loss: 0.4639956
	speed: 0.0476s/iter; left time: 378.5216s
	iters: 300, epoch: 2 | loss: 0.3745648
	speed: 0.0471s/iter; left time: 370.3589s
	iters: 400, epoch: 2 | loss: 0.4133372
	speed: 0.0473s/iter; left time: 366.4460s
	iters: 500, epoch: 2 | loss: 0.3466574
	speed: 0.0449s/iter; left time: 343.4915s
	iters: 600, epoch: 2 | loss: 0.3551471
	speed: 0.0485s/iter; left time: 366.5772s
	iters: 700, epoch: 2 | loss: 0.3540934
	speed: 0.0476s/iter; left time: 354.7835s
	iters: 800, epoch: 2 | loss: 0.4193859
	speed: 0.0466s/iter; left time: 342.4704s
	iters: 900, epoch: 2 | loss: 0.3925616
	speed: 0.0418s/iter; left time: 303.5482s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.41s
Steps: 906 | Train Loss: 0.4024890 Vali Loss: 0.4482407 Test Loss: 0.4752986
Validation loss decreased (0.561169 --> 0.448241).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3761962
	speed: 0.1062s/iter; left time: 759.5561s
	iters: 200, epoch: 3 | loss: 0.3349366
	speed: 0.0371s/iter; left time: 261.7124s
	iters: 300, epoch: 3 | loss: 0.3515136
	speed: 0.0457s/iter; left time: 317.3230s
	iters: 400, epoch: 3 | loss: 0.3453909
	speed: 0.0480s/iter; left time: 328.4386s
	iters: 500, epoch: 3 | loss: 0.4114959
	speed: 0.0324s/iter; left time: 218.3501s
	iters: 600, epoch: 3 | loss: 0.3672501
	speed: 0.0476s/iter; left time: 316.3833s
	iters: 700, epoch: 3 | loss: 0.3614201
	speed: 0.0456s/iter; left time: 298.9448s
	iters: 800, epoch: 3 | loss: 0.3395962
	speed: 0.0437s/iter; left time: 282.1270s
	iters: 900, epoch: 3 | loss: 0.3495890
	speed: 0.0455s/iter; left time: 288.7292s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.31s
Steps: 906 | Train Loss: 0.3549216 Vali Loss: 0.4410602 Test Loss: 0.4640522
Validation loss decreased (0.448241 --> 0.441060).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3248505
	speed: 0.1003s/iter; left time: 625.8939s
	iters: 200, epoch: 4 | loss: 0.3409783
	speed: 0.0347s/iter; left time: 213.3199s
	iters: 300, epoch: 4 | loss: 0.3119107
	speed: 0.0325s/iter; left time: 196.6699s
	iters: 400, epoch: 4 | loss: 0.2825992
	speed: 0.0471s/iter; left time: 280.1340s
	iters: 500, epoch: 4 | loss: 0.3735337
	speed: 0.0420s/iter; left time: 245.4236s
	iters: 600, epoch: 4 | loss: 0.3239299
	speed: 0.0424s/iter; left time: 243.2485s
	iters: 700, epoch: 4 | loss: 0.3046439
	speed: 0.0473s/iter; left time: 267.1870s
	iters: 800, epoch: 4 | loss: 0.3458192
	speed: 0.0440s/iter; left time: 243.7060s
	iters: 900, epoch: 4 | loss: 0.3197863
	speed: 0.0481s/iter; left time: 261.6592s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.46s
Steps: 906 | Train Loss: 0.3301053 Vali Loss: 0.4434324 Test Loss: 0.4585804
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3173523
	speed: 0.1063s/iter; left time: 567.5174s
	iters: 200, epoch: 5 | loss: 0.2918978
	speed: 0.0446s/iter; left time: 233.7640s
	iters: 300, epoch: 5 | loss: 0.2791134
	speed: 0.0450s/iter; left time: 231.4130s
	iters: 400, epoch: 5 | loss: 0.3412134
	speed: 0.0417s/iter; left time: 210.1884s
	iters: 500, epoch: 5 | loss: 0.2887617
	speed: 0.0441s/iter; left time: 217.9036s
	iters: 600, epoch: 5 | loss: 0.3212793
	speed: 0.0462s/iter; left time: 223.6551s
	iters: 700, epoch: 5 | loss: 0.2760491
	speed: 0.0466s/iter; left time: 220.8770s
	iters: 800, epoch: 5 | loss: 0.3113039
	speed: 0.0431s/iter; left time: 199.7606s
	iters: 900, epoch: 5 | loss: 0.3274809
	speed: 0.0469s/iter; left time: 212.9822s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.17s
Steps: 906 | Train Loss: 0.3028348 Vali Loss: 0.4478417 Test Loss: 0.4733604
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3078453
	speed: 0.1063s/iter; left time: 470.9263s
	iters: 200, epoch: 6 | loss: 0.2830877
	speed: 0.0460s/iter; left time: 199.4183s
	iters: 300, epoch: 6 | loss: 0.2912150
	speed: 0.0452s/iter; left time: 191.3419s
	iters: 400, epoch: 6 | loss: 0.2746114
	speed: 0.0373s/iter; left time: 153.8925s
	iters: 500, epoch: 6 | loss: 0.2967163
	speed: 0.0449s/iter; left time: 180.8511s
	iters: 600, epoch: 6 | loss: 0.2600384
	speed: 0.0419s/iter; left time: 164.7979s
	iters: 700, epoch: 6 | loss: 0.2873008
	speed: 0.0460s/iter; left time: 176.1733s
	iters: 800, epoch: 6 | loss: 0.2397701
	speed: 0.0388s/iter; left time: 144.6253s
	iters: 900, epoch: 6 | loss: 0.2614063
	speed: 0.0358s/iter; left time: 129.8499s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.57s
Steps: 906 | Train Loss: 0.2783248 Vali Loss: 0.4407871 Test Loss: 0.4576899
Validation loss decreased (0.441060 --> 0.440787).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2589685
	speed: 0.1033s/iter; left time: 364.0404s
	iters: 200, epoch: 7 | loss: 0.2718148
	speed: 0.0382s/iter; left time: 130.9269s
	iters: 300, epoch: 7 | loss: 0.2943646
	speed: 0.0394s/iter; left time: 131.0179s
	iters: 400, epoch: 7 | loss: 0.2814744
	speed: 0.0417s/iter; left time: 134.4425s
	iters: 500, epoch: 7 | loss: 0.2526398
	speed: 0.0466s/iter; left time: 145.7595s
	iters: 600, epoch: 7 | loss: 0.2305333
	speed: 0.0436s/iter; left time: 131.8062s
	iters: 700, epoch: 7 | loss: 0.2285726
	speed: 0.0372s/iter; left time: 108.8920s
	iters: 800, epoch: 7 | loss: 0.2442082
	speed: 0.0459s/iter; left time: 129.6812s
	iters: 900, epoch: 7 | loss: 0.2665747
	speed: 0.0329s/iter; left time: 89.6784s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.29s
Steps: 906 | Train Loss: 0.2552269 Vali Loss: 0.4491005 Test Loss: 0.4817139
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2641042
	speed: 0.1015s/iter; left time: 265.9365s
	iters: 200, epoch: 8 | loss: 0.2304286
	speed: 0.0439s/iter; left time: 110.4893s
	iters: 300, epoch: 8 | loss: 0.2364748
	speed: 0.0465s/iter; left time: 112.5713s
	iters: 400, epoch: 8 | loss: 0.2366613
	speed: 0.0450s/iter; left time: 104.3791s
	iters: 500, epoch: 8 | loss: 0.2366679
	speed: 0.0467s/iter; left time: 103.6715s
	iters: 600, epoch: 8 | loss: 0.2136285
	speed: 0.0443s/iter; left time: 93.7882s
	iters: 700, epoch: 8 | loss: 0.2616574
	speed: 0.0414s/iter; left time: 83.6217s
	iters: 800, epoch: 8 | loss: 0.2531595
	speed: 0.0436s/iter; left time: 83.5961s
	iters: 900, epoch: 8 | loss: 0.2318582
	speed: 0.0462s/iter; left time: 84.0861s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:40.79s
Steps: 906 | Train Loss: 0.2383089 Vali Loss: 0.4535426 Test Loss: 0.4727233
EarlyStopping counter: 2 out of 3
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.2337920
	speed: 0.1020s/iter; left time: 174.7699s
	iters: 200, epoch: 9 | loss: 0.2150753
	speed: 0.0402s/iter; left time: 64.9126s
	iters: 300, epoch: 9 | loss: 0.1994082
	speed: 0.0433s/iter; left time: 65.5384s
	iters: 400, epoch: 9 | loss: 0.1872013
	speed: 0.0394s/iter; left time: 55.7024s
	iters: 500, epoch: 9 | loss: 0.2625577
	speed: 0.0424s/iter; left time: 55.7075s
	iters: 600, epoch: 9 | loss: 0.2212823
	speed: 0.0459s/iter; left time: 55.7359s
	iters: 700, epoch: 9 | loss: 0.2057136
	speed: 0.0484s/iter; left time: 53.8649s
	iters: 800, epoch: 9 | loss: 0.2123671
	speed: 0.0410s/iter; left time: 41.5381s
	iters: 900, epoch: 9 | loss: 0.2399411
	speed: 0.0361s/iter; left time: 32.9773s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:38.57s
Steps: 906 | Train Loss: 0.2207743 Vali Loss: 0.4465204 Test Loss: 0.4781870
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
mse:0.5188416242599487, rmse:0.7203066349029541, mae:0.45719295740127563, rse:0.5700771808624268
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.7663413
	speed: 0.0387s/iter; left time: 346.4035s
	iters: 200, epoch: 1 | loss: 0.6485021
	speed: 0.0462s/iter; left time: 409.2441s
	iters: 300, epoch: 1 | loss: 0.5757578
	speed: 0.0438s/iter; left time: 383.4591s
	iters: 400, epoch: 1 | loss: 0.6212713
	speed: 0.0466s/iter; left time: 403.6473s
	iters: 500, epoch: 1 | loss: 0.5127186
	speed: 0.0438s/iter; left time: 374.6563s
	iters: 600, epoch: 1 | loss: 0.5530728
	speed: 0.0450s/iter; left time: 380.5488s
	iters: 700, epoch: 1 | loss: 0.5311509
	speed: 0.0473s/iter; left time: 395.5852s
	iters: 800, epoch: 1 | loss: 0.5241462
	speed: 0.0476s/iter; left time: 393.0399s
	iters: 900, epoch: 1 | loss: 0.4979602
	speed: 0.0450s/iter; left time: 367.0440s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:40.63s
Steps: 906 | Train Loss: 0.5916661 Vali Loss: 0.5558083 Test Loss: 0.5964805
Validation loss decreased (inf --> 0.555808).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4336141
	speed: 0.1052s/iter; left time: 847.6697s
	iters: 200, epoch: 2 | loss: 0.5146539
	speed: 0.0465s/iter; left time: 369.7881s
	iters: 300, epoch: 2 | loss: 0.4029806
	speed: 0.0465s/iter; left time: 365.2358s
	iters: 400, epoch: 2 | loss: 0.4548421
	speed: 0.0425s/iter; left time: 329.3296s
	iters: 500, epoch: 2 | loss: 0.4255509
	speed: 0.0430s/iter; left time: 328.9554s
	iters: 600, epoch: 2 | loss: 0.3443504
	speed: 0.0326s/iter; left time: 246.4440s
	iters: 700, epoch: 2 | loss: 0.3624960
	speed: 0.0442s/iter; left time: 329.7258s
	iters: 800, epoch: 2 | loss: 0.3500257
	speed: 0.0452s/iter; left time: 332.6718s
	iters: 900, epoch: 2 | loss: 0.3510049
	speed: 0.0455s/iter; left time: 329.7678s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:39.95s
Steps: 906 | Train Loss: 0.4025312 Vali Loss: 0.4525728 Test Loss: 0.4585328
Validation loss decreased (0.555808 --> 0.452573).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3646318
	speed: 0.1071s/iter; left time: 765.9629s
	iters: 200, epoch: 3 | loss: 0.3351053
	speed: 0.0453s/iter; left time: 319.0055s
	iters: 300, epoch: 3 | loss: 0.3731779
	speed: 0.0426s/iter; left time: 295.7350s
	iters: 400, epoch: 3 | loss: 0.3862885
	speed: 0.0375s/iter; left time: 257.1324s
	iters: 500, epoch: 3 | loss: 0.4007759
	speed: 0.0459s/iter; left time: 309.6851s
	iters: 600, epoch: 3 | loss: 0.3929105
	speed: 0.0460s/iter; left time: 305.7504s
	iters: 700, epoch: 3 | loss: 0.3533075
	speed: 0.0415s/iter; left time: 271.9870s
	iters: 800, epoch: 3 | loss: 0.3429417
	speed: 0.0368s/iter; left time: 237.1391s
	iters: 900, epoch: 3 | loss: 0.3384899
	speed: 0.0421s/iter; left time: 267.0770s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.87s
Steps: 906 | Train Loss: 0.3550890 Vali Loss: 0.4418871 Test Loss: 0.4460518
Validation loss decreased (0.452573 --> 0.441887).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3175507
	speed: 0.1042s/iter; left time: 650.4543s
	iters: 200, epoch: 4 | loss: 0.3441693
	speed: 0.0417s/iter; left time: 256.2691s
	iters: 300, epoch: 4 | loss: 0.3254147
	speed: 0.0432s/iter; left time: 260.7656s
	iters: 400, epoch: 4 | loss: 0.3307195
	speed: 0.0424s/iter; left time: 252.2096s
	iters: 500, epoch: 4 | loss: 0.3794867
	speed: 0.0461s/iter; left time: 269.6351s
	iters: 600, epoch: 4 | loss: 0.3249062
	speed: 0.0356s/iter; left time: 204.6808s
	iters: 700, epoch: 4 | loss: 0.3429216
	speed: 0.0348s/iter; left time: 196.5237s
	iters: 800, epoch: 4 | loss: 0.3966985
	speed: 0.0324s/iter; left time: 179.3998s
	iters: 900, epoch: 4 | loss: 0.3426206
	speed: 0.0419s/iter; left time: 228.0963s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:36.77s
Steps: 906 | Train Loss: 0.3285498 Vali Loss: 0.4358843 Test Loss: 0.4459069
Validation loss decreased (0.441887 --> 0.435884).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2845316
	speed: 0.1076s/iter; left time: 574.3523s
	iters: 200, epoch: 5 | loss: 0.3353932
	speed: 0.0427s/iter; left time: 223.5565s
	iters: 300, epoch: 5 | loss: 0.3241500
	speed: 0.0477s/iter; left time: 245.2350s
	iters: 400, epoch: 5 | loss: 0.3284504
	speed: 0.0371s/iter; left time: 186.8177s
	iters: 500, epoch: 5 | loss: 0.3038191
	speed: 0.0434s/iter; left time: 214.2425s
	iters: 600, epoch: 5 | loss: 0.2700494
	speed: 0.0478s/iter; left time: 231.3698s
	iters: 700, epoch: 5 | loss: 0.2971236
	speed: 0.0482s/iter; left time: 228.3911s
	iters: 800, epoch: 5 | loss: 0.3002537
	speed: 0.0443s/iter; left time: 205.4548s
	iters: 900, epoch: 5 | loss: 0.2977143
	speed: 0.0475s/iter; left time: 215.3953s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.20s
Steps: 906 | Train Loss: 0.3019121 Vali Loss: 0.4237208 Test Loss: 0.4594835
Validation loss decreased (0.435884 --> 0.423721).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3062578
	speed: 0.1094s/iter; left time: 484.9593s
	iters: 200, epoch: 6 | loss: 0.2654166
	speed: 0.0488s/iter; left time: 211.1693s
	iters: 300, epoch: 6 | loss: 0.2942485
	speed: 0.0419s/iter; left time: 177.1388s
	iters: 400, epoch: 6 | loss: 0.3022459
	speed: 0.0442s/iter; left time: 182.7024s
	iters: 500, epoch: 6 | loss: 0.2812643
	speed: 0.0484s/iter; left time: 194.9745s
	iters: 600, epoch: 6 | loss: 0.2917507
	speed: 0.0480s/iter; left time: 188.5206s
	iters: 700, epoch: 6 | loss: 0.2915955
	speed: 0.0458s/iter; left time: 175.3792s
	iters: 800, epoch: 6 | loss: 0.2462863
	speed: 0.0487s/iter; left time: 181.7507s
	iters: 900, epoch: 6 | loss: 0.2766623
	speed: 0.0468s/iter; left time: 169.9807s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:42.66s
Steps: 906 | Train Loss: 0.2773862 Vali Loss: 0.4452073 Test Loss: 0.4664961
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2722317
	speed: 0.1041s/iter; left time: 366.8277s
	iters: 200, epoch: 7 | loss: 0.2920038
	speed: 0.0436s/iter; left time: 149.4853s
	iters: 300, epoch: 7 | loss: 0.2533202
	speed: 0.0410s/iter; left time: 136.1747s
	iters: 400, epoch: 7 | loss: 0.2270028
	speed: 0.0458s/iter; left time: 147.6808s
	iters: 500, epoch: 7 | loss: 0.2566482
	speed: 0.0459s/iter; left time: 143.3255s
	iters: 600, epoch: 7 | loss: 0.2476297
	speed: 0.0485s/iter; left time: 146.5693s
	iters: 700, epoch: 7 | loss: 0.2665338
	speed: 0.0438s/iter; left time: 128.1700s
	iters: 800, epoch: 7 | loss: 0.2844218
	speed: 0.0471s/iter; left time: 133.1314s
	iters: 900, epoch: 7 | loss: 0.2454531
	speed: 0.0429s/iter; left time: 116.8082s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:41.11s
Steps: 906 | Train Loss: 0.2564889 Vali Loss: 0.4482238 Test Loss: 0.4680468
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2528011
	speed: 0.1013s/iter; left time: 265.3165s
	iters: 200, epoch: 8 | loss: 0.2499335
	speed: 0.0422s/iter; left time: 106.3937s
	iters: 300, epoch: 8 | loss: 0.2507049
	speed: 0.0477s/iter; left time: 115.3215s
	iters: 400, epoch: 8 | loss: 0.2264348
	speed: 0.0489s/iter; left time: 113.3848s
	iters: 500, epoch: 8 | loss: 0.2077545
	speed: 0.0336s/iter; left time: 74.4785s
	iters: 600, epoch: 8 | loss: 0.2186678
	speed: 0.0444s/iter; left time: 93.9908s
	iters: 700, epoch: 8 | loss: 0.2397504
	speed: 0.0498s/iter; left time: 100.5781s
	iters: 800, epoch: 8 | loss: 0.2378334
	speed: 0.0478s/iter; left time: 91.7329s
	iters: 900, epoch: 8 | loss: 0.2434639
	speed: 0.0425s/iter; left time: 77.3655s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:40.58s
Steps: 906 | Train Loss: 0.2388158 Vali Loss: 0.4419125 Test Loss: 0.4689014
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
mse:0.4891737401485443, rmse:0.699409544467926, mae:0.4595417380332947, rse:0.5535385012626648

Extracted Metrics for DE, pred_len=24, iteration=1:
MSE: 0.5188416242599487, RMSE: 0.7203066349029541, MAE: 0.45719295740127563, RSE: 0.5700771808624268

Extracted Metrics for DE, pred_len=24, iteration=2:
MSE: 0.4891737401485443, RMSE: 0.699409544467926, MAE: 0.4595417380332947, RSE: 0.5535385012626648

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_96_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.8067917
	speed: 0.0840s/iter; left time: 751.4469s
	iters: 200, epoch: 1 | loss: 0.7688307
	speed: 0.0394s/iter; left time: 348.2751s
	iters: 300, epoch: 1 | loss: 0.7508007
	speed: 0.0465s/iter; left time: 406.7211s
	iters: 400, epoch: 1 | loss: 0.7012591
	speed: 0.0491s/iter; left time: 424.3091s
	iters: 500, epoch: 1 | loss: 0.6997176
	speed: 0.0479s/iter; left time: 409.1456s
	iters: 600, epoch: 1 | loss: 0.6242710
	speed: 0.0460s/iter; left time: 387.9298s
	iters: 700, epoch: 1 | loss: 0.6133171
	speed: 0.0472s/iter; left time: 393.5347s
	iters: 800, epoch: 1 | loss: 0.6298627
	speed: 0.0479s/iter; left time: 394.3600s
	iters: 900, epoch: 1 | loss: 0.6329895
	speed: 0.0472s/iter; left time: 384.5678s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:43.26s
Steps: 904 | Train Loss: 0.7062791 Vali Loss: 0.7041736 Test Loss: 0.7890770
Validation loss decreased (inf --> 0.704174).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5741602
	speed: 0.1124s/iter; left time: 903.5141s
	iters: 200, epoch: 2 | loss: 0.5573565
	speed: 0.0462s/iter; left time: 367.0080s
	iters: 300, epoch: 2 | loss: 0.5360226
	speed: 0.0471s/iter; left time: 369.0028s
	iters: 400, epoch: 2 | loss: 0.5210469
	speed: 0.0450s/iter; left time: 348.1139s
	iters: 500, epoch: 2 | loss: 0.4852026
	speed: 0.0451s/iter; left time: 344.7610s
	iters: 600, epoch: 2 | loss: 0.5197762
	speed: 0.0425s/iter; left time: 320.4571s
	iters: 700, epoch: 2 | loss: 0.4818439
	speed: 0.0484s/iter; left time: 359.6217s
	iters: 800, epoch: 2 | loss: 0.5260186
	speed: 0.0476s/iter; left time: 349.0707s
	iters: 900, epoch: 2 | loss: 0.4836222
	speed: 0.0439s/iter; left time: 317.5081s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.06s
Steps: 904 | Train Loss: 0.5302526 Vali Loss: 0.5876943 Test Loss: 0.6581249
Validation loss decreased (0.704174 --> 0.587694).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5143448
	speed: 0.1112s/iter; left time: 792.9913s
	iters: 200, epoch: 3 | loss: 0.4555106
	speed: 0.0429s/iter; left time: 301.9961s
	iters: 300, epoch: 3 | loss: 0.4323205
	speed: 0.0520s/iter; left time: 360.1868s
	iters: 400, epoch: 3 | loss: 0.4212284
	speed: 0.0483s/iter; left time: 329.7653s
	iters: 500, epoch: 3 | loss: 0.4699768
	speed: 0.0460s/iter; left time: 309.6412s
	iters: 600, epoch: 3 | loss: 0.4816353
	speed: 0.0453s/iter; left time: 300.7830s
	iters: 700, epoch: 3 | loss: 0.4266669
	speed: 0.0446s/iter; left time: 291.3849s
	iters: 800, epoch: 3 | loss: 0.4492370
	speed: 0.0470s/iter; left time: 302.5023s
	iters: 900, epoch: 3 | loss: 0.4507588
	speed: 0.0424s/iter; left time: 268.8250s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:41.95s
Steps: 904 | Train Loss: 0.4610911 Vali Loss: 0.5697786 Test Loss: 0.6448624
Validation loss decreased (0.587694 --> 0.569779).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4120070
	speed: 0.1038s/iter; left time: 646.6130s
	iters: 200, epoch: 4 | loss: 0.4231596
	speed: 0.0375s/iter; left time: 230.1011s
	iters: 300, epoch: 4 | loss: 0.4169765
	speed: 0.0467s/iter; left time: 281.5541s
	iters: 400, epoch: 4 | loss: 0.3556132
	speed: 0.0408s/iter; left time: 242.1545s
	iters: 500, epoch: 4 | loss: 0.4291881
	speed: 0.0470s/iter; left time: 273.7635s
	iters: 600, epoch: 4 | loss: 0.3928163
	speed: 0.0444s/iter; left time: 254.2628s
	iters: 700, epoch: 4 | loss: 0.4445765
	speed: 0.0449s/iter; left time: 252.7680s
	iters: 800, epoch: 4 | loss: 0.4147629
	speed: 0.0480s/iter; left time: 265.1543s
	iters: 900, epoch: 4 | loss: 0.4494169
	speed: 0.0390s/iter; left time: 211.5720s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:39.36s
Steps: 904 | Train Loss: 0.4237256 Vali Loss: 0.5744144 Test Loss: 0.6609067
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3808894
	speed: 0.1092s/iter; left time: 581.7101s
	iters: 200, epoch: 5 | loss: 0.4379567
	speed: 0.0455s/iter; left time: 237.4947s
	iters: 300, epoch: 5 | loss: 0.4309290
	speed: 0.0334s/iter; left time: 171.3153s
	iters: 400, epoch: 5 | loss: 0.3985155
	speed: 0.0452s/iter; left time: 227.1895s
	iters: 500, epoch: 5 | loss: 0.3633554
	speed: 0.0486s/iter; left time: 239.3908s
	iters: 600, epoch: 5 | loss: 0.3638545
	speed: 0.0458s/iter; left time: 220.9650s
	iters: 700, epoch: 5 | loss: 0.3683217
	speed: 0.0474s/iter; left time: 223.7781s
	iters: 800, epoch: 5 | loss: 0.3484431
	speed: 0.0443s/iter; left time: 205.0952s
	iters: 900, epoch: 5 | loss: 0.3746142
	speed: 0.0449s/iter; left time: 203.2041s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:40.80s
Steps: 904 | Train Loss: 0.3867548 Vali Loss: 0.5776727 Test Loss: 0.6671416
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3486542
	speed: 0.1004s/iter; left time: 443.9235s
	iters: 200, epoch: 6 | loss: 0.3392638
	speed: 0.0477s/iter; left time: 205.9746s
	iters: 300, epoch: 6 | loss: 0.3697442
	speed: 0.0429s/iter; left time: 180.9403s
	iters: 400, epoch: 6 | loss: 0.3674991
	speed: 0.0473s/iter; left time: 194.9381s
	iters: 500, epoch: 6 | loss: 0.3660162
	speed: 0.0461s/iter; left time: 185.5115s
	iters: 600, epoch: 6 | loss: 0.3611535
	speed: 0.0463s/iter; left time: 181.6486s
	iters: 700, epoch: 6 | loss: 0.3432849
	speed: 0.0465s/iter; left time: 177.8420s
	iters: 800, epoch: 6 | loss: 0.3864821
	speed: 0.0438s/iter; left time: 162.8306s
	iters: 900, epoch: 6 | loss: 0.3490607
	speed: 0.0472s/iter; left time: 171.0809s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:41.54s
Steps: 904 | Train Loss: 0.3563989 Vali Loss: 0.5858901 Test Loss: 0.6636922
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
mse:0.8605884313583374, rmse:0.9276790618896484, mae:0.6448208689689636, rse:0.7357637882232666
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.7958822
	speed: 0.0440s/iter; left time: 392.9672s
	iters: 200, epoch: 1 | loss: 0.7839687
	speed: 0.0474s/iter; left time: 419.3232s
	iters: 300, epoch: 1 | loss: 0.7392733
	speed: 0.0444s/iter; left time: 388.4331s
	iters: 400, epoch: 1 | loss: 0.6705455
	speed: 0.0394s/iter; left time: 340.8571s
	iters: 500, epoch: 1 | loss: 0.7188321
	speed: 0.0473s/iter; left time: 404.0221s
	iters: 600, epoch: 1 | loss: 0.7047096
	speed: 0.0388s/iter; left time: 327.2205s
	iters: 700, epoch: 1 | loss: 0.6298293
	speed: 0.0370s/iter; left time: 308.9929s
	iters: 800, epoch: 1 | loss: 0.6690677
	speed: 0.0454s/iter; left time: 373.7955s
	iters: 900, epoch: 1 | loss: 0.5942121
	speed: 0.0473s/iter; left time: 384.7191s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:39.40s
Steps: 904 | Train Loss: 0.7041365 Vali Loss: 0.7075946 Test Loss: 0.7944186
Validation loss decreased (inf --> 0.707595).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5957434
	speed: 0.1104s/iter; left time: 887.3121s
	iters: 200, epoch: 2 | loss: 0.5940323
	speed: 0.0467s/iter; left time: 370.2614s
	iters: 300, epoch: 2 | loss: 0.5177482
	speed: 0.0484s/iter; left time: 379.5623s
	iters: 400, epoch: 2 | loss: 0.5124515
	speed: 0.0483s/iter; left time: 373.9555s
	iters: 500, epoch: 2 | loss: 0.5041392
	speed: 0.0473s/iter; left time: 361.4489s
	iters: 600, epoch: 2 | loss: 0.5169987
	speed: 0.0456s/iter; left time: 343.8892s
	iters: 700, epoch: 2 | loss: 0.5079450
	speed: 0.0462s/iter; left time: 343.3849s
	iters: 800, epoch: 2 | loss: 0.5539059
	speed: 0.0494s/iter; left time: 362.4364s
	iters: 900, epoch: 2 | loss: 0.4816802
	speed: 0.0437s/iter; left time: 316.4184s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.64s
Steps: 904 | Train Loss: 0.5333013 Vali Loss: 0.6118372 Test Loss: 0.6438490
Validation loss decreased (0.707595 --> 0.611837).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4765821
	speed: 0.1101s/iter; left time: 785.3193s
	iters: 200, epoch: 3 | loss: 0.4696513
	speed: 0.0496s/iter; left time: 348.8956s
	iters: 300, epoch: 3 | loss: 0.4342611
	speed: 0.0444s/iter; left time: 307.6478s
	iters: 400, epoch: 3 | loss: 0.4118306
	speed: 0.0452s/iter; left time: 308.7545s
	iters: 500, epoch: 3 | loss: 0.4146205
	speed: 0.0486s/iter; left time: 327.0580s
	iters: 600, epoch: 3 | loss: 0.4872401
	speed: 0.0448s/iter; left time: 297.3007s
	iters: 700, epoch: 3 | loss: 0.4506579
	speed: 0.0502s/iter; left time: 327.9693s
	iters: 800, epoch: 3 | loss: 0.4589255
	speed: 0.0421s/iter; left time: 270.5509s
	iters: 900, epoch: 3 | loss: 0.4285489
	speed: 0.0465s/iter; left time: 294.2709s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:42.12s
Steps: 904 | Train Loss: 0.4630802 Vali Loss: 0.5959297 Test Loss: 0.6734436
Validation loss decreased (0.611837 --> 0.595930).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3916527
	speed: 0.1092s/iter; left time: 679.9300s
	iters: 200, epoch: 4 | loss: 0.4424612
	speed: 0.0424s/iter; left time: 260.0619s
	iters: 300, epoch: 4 | loss: 0.4169645
	speed: 0.0423s/iter; left time: 254.7540s
	iters: 400, epoch: 4 | loss: 0.4057310
	speed: 0.0349s/iter; left time: 206.9678s
	iters: 500, epoch: 4 | loss: 0.4517982
	speed: 0.0413s/iter; left time: 240.6672s
	iters: 600, epoch: 4 | loss: 0.4000244
	speed: 0.0485s/iter; left time: 278.1114s
	iters: 700, epoch: 4 | loss: 0.4279825
	speed: 0.0444s/iter; left time: 249.7216s
	iters: 800, epoch: 4 | loss: 0.4368097
	speed: 0.0439s/iter; left time: 242.4667s
	iters: 900, epoch: 4 | loss: 0.3883900
	speed: 0.0468s/iter; left time: 253.8821s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:39.67s
Steps: 904 | Train Loss: 0.4223682 Vali Loss: 0.5835855 Test Loss: 0.6440173
Validation loss decreased (0.595930 --> 0.583586).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3722683
	speed: 0.0939s/iter; left time: 500.2594s
	iters: 200, epoch: 5 | loss: 0.4122548
	speed: 0.0457s/iter; left time: 239.0075s
	iters: 300, epoch: 5 | loss: 0.3921342
	speed: 0.0466s/iter; left time: 238.6816s
	iters: 400, epoch: 5 | loss: 0.3807038
	speed: 0.0468s/iter; left time: 235.3918s
	iters: 500, epoch: 5 | loss: 0.3871912
	speed: 0.0373s/iter; left time: 183.5810s
	iters: 600, epoch: 5 | loss: 0.4224902
	speed: 0.0431s/iter; left time: 207.9042s
	iters: 700, epoch: 5 | loss: 0.3636874
	speed: 0.0473s/iter; left time: 223.3519s
	iters: 800, epoch: 5 | loss: 0.3763137
	speed: 0.0395s/iter; left time: 182.5043s
	iters: 900, epoch: 5 | loss: 0.3757822
	speed: 0.0449s/iter; left time: 203.1007s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.89s
Steps: 904 | Train Loss: 0.3853117 Vali Loss: 0.5932398 Test Loss: 0.6455393
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3310162
	speed: 0.1025s/iter; left time: 452.9974s
	iters: 200, epoch: 6 | loss: 0.3540734
	speed: 0.0458s/iter; left time: 197.9555s
	iters: 300, epoch: 6 | loss: 0.3805029
	speed: 0.0468s/iter; left time: 197.3601s
	iters: 400, epoch: 6 | loss: 0.3458270
	speed: 0.0448s/iter; left time: 184.6888s
	iters: 500, epoch: 6 | loss: 0.3366010
	speed: 0.0356s/iter; left time: 143.1543s
	iters: 600, epoch: 6 | loss: 0.3225587
	speed: 0.0445s/iter; left time: 174.5343s
	iters: 700, epoch: 6 | loss: 0.3334104
	speed: 0.0455s/iter; left time: 173.8534s
	iters: 800, epoch: 6 | loss: 0.3155001
	speed: 0.0336s/iter; left time: 125.1019s
	iters: 900, epoch: 6 | loss: 0.3178173
	speed: 0.0465s/iter; left time: 168.4752s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:39.35s
Steps: 904 | Train Loss: 0.3539380 Vali Loss: 0.5974894 Test Loss: 0.6660232
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3371837
	speed: 0.1005s/iter; left time: 353.5739s
	iters: 200, epoch: 7 | loss: 0.3259185
	speed: 0.0471s/iter; left time: 160.9637s
	iters: 300, epoch: 7 | loss: 0.3114211
	speed: 0.0487s/iter; left time: 161.4826s
	iters: 400, epoch: 7 | loss: 0.3071353
	speed: 0.0459s/iter; left time: 147.7451s
	iters: 500, epoch: 7 | loss: 0.3179525
	speed: 0.0473s/iter; left time: 147.3717s
	iters: 600, epoch: 7 | loss: 0.3134637
	speed: 0.0466s/iter; left time: 140.4863s
	iters: 700, epoch: 7 | loss: 0.3499774
	speed: 0.0492s/iter; left time: 143.5175s
	iters: 800, epoch: 7 | loss: 0.3171128
	speed: 0.0476s/iter; left time: 133.9584s
	iters: 900, epoch: 7 | loss: 0.3237043
	speed: 0.0485s/iter; left time: 131.8639s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:42.90s
Steps: 904 | Train Loss: 0.3271561 Vali Loss: 0.5955210 Test Loss: 0.6735355
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
mse:0.9031488299369812, rmse:0.9503414034843445, mae:0.6443209052085876, rse:0.7537378668785095

Extracted Metrics for DE, pred_len=96, iteration=1:
MSE: 0.8605884313583374, RMSE: 0.9276790618896484, MAE: 0.6448208689689636, RSE: 0.7357637882232666

Extracted Metrics for DE, pred_len=96, iteration=2:
MSE: 0.9031488299369812, RMSE: 0.9503414034843445, MAE: 0.6443209052085876, RSE: 0.7537378668785095

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_168_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.7432773
	speed: 0.0833s/iter; left time: 743.5652s
	iters: 200, epoch: 1 | loss: 0.7939355
	speed: 0.0512s/iter; left time: 451.3642s
	iters: 300, epoch: 1 | loss: 0.7317653
	speed: 0.0490s/iter; left time: 427.5547s
	iters: 400, epoch: 1 | loss: 0.7309682
	speed: 0.0399s/iter; left time: 343.7290s
	iters: 500, epoch: 1 | loss: 0.7174807
	speed: 0.0408s/iter; left time: 347.6815s
	iters: 600, epoch: 1 | loss: 0.7427214
	speed: 0.0440s/iter; left time: 370.9285s
	iters: 700, epoch: 1 | loss: 0.7085695
	speed: 0.0431s/iter; left time: 358.4131s
	iters: 800, epoch: 1 | loss: 0.6773993
	speed: 0.0500s/iter; left time: 411.3716s
	iters: 900, epoch: 1 | loss: 0.7027309
	speed: 0.0478s/iter; left time: 388.4428s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:42.44s
Steps: 902 | Train Loss: 0.7345921 Vali Loss: 0.7742499 Test Loss: 0.8810522
Validation loss decreased (inf --> 0.774250).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6915616
	speed: 0.1172s/iter; left time: 939.8777s
	iters: 200, epoch: 2 | loss: 0.6296236
	speed: 0.0490s/iter; left time: 387.7840s
	iters: 300, epoch: 2 | loss: 0.6338568
	speed: 0.0409s/iter; left time: 319.6037s
	iters: 400, epoch: 2 | loss: 0.5708992
	speed: 0.0496s/iter; left time: 383.0056s
	iters: 500, epoch: 2 | loss: 0.5656452
	speed: 0.0507s/iter; left time: 385.9538s
	iters: 600, epoch: 2 | loss: 0.5171528
	speed: 0.0489s/iter; left time: 367.6375s
	iters: 700, epoch: 2 | loss: 0.5277460
	speed: 0.0509s/iter; left time: 377.5986s
	iters: 800, epoch: 2 | loss: 0.5613817
	speed: 0.0502s/iter; left time: 367.7378s
	iters: 900, epoch: 2 | loss: 0.5136336
	speed: 0.0506s/iter; left time: 365.1110s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:44.10s
Steps: 902 | Train Loss: 0.5769524 Vali Loss: 0.6167185 Test Loss: 0.6815776
Validation loss decreased (0.774250 --> 0.616719).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5195920
	speed: 0.1214s/iter; left time: 864.2220s
	iters: 200, epoch: 3 | loss: 0.4820179
	speed: 0.0513s/iter; left time: 360.2389s
	iters: 300, epoch: 3 | loss: 0.4975570
	speed: 0.0450s/iter; left time: 311.3766s
	iters: 400, epoch: 3 | loss: 0.4995791
	speed: 0.0427s/iter; left time: 291.1482s
	iters: 500, epoch: 3 | loss: 0.4637761
	speed: 0.0443s/iter; left time: 297.8450s
	iters: 600, epoch: 3 | loss: 0.4987577
	speed: 0.0376s/iter; left time: 248.9684s
	iters: 700, epoch: 3 | loss: 0.4995336
	speed: 0.0477s/iter; left time: 310.6498s
	iters: 800, epoch: 3 | loss: 0.4750866
	speed: 0.0476s/iter; left time: 305.5828s
	iters: 900, epoch: 3 | loss: 0.4593079
	speed: 0.0382s/iter; left time: 241.6135s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:40.78s
Steps: 902 | Train Loss: 0.4844140 Vali Loss: 0.6013861 Test Loss: 0.6744983
Validation loss decreased (0.616719 --> 0.601386).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4199736
	speed: 0.1153s/iter; left time: 716.3061s
	iters: 200, epoch: 4 | loss: 0.4067586
	speed: 0.0415s/iter; left time: 253.8962s
	iters: 300, epoch: 4 | loss: 0.4709497
	speed: 0.0456s/iter; left time: 274.5633s
	iters: 400, epoch: 4 | loss: 0.4624965
	speed: 0.0467s/iter; left time: 276.0444s
	iters: 500, epoch: 4 | loss: 0.4708977
	speed: 0.0405s/iter; left time: 235.6641s
	iters: 600, epoch: 4 | loss: 0.4219711
	speed: 0.0423s/iter; left time: 241.9992s
	iters: 700, epoch: 4 | loss: 0.4578864
	speed: 0.0434s/iter; left time: 243.7187s
	iters: 800, epoch: 4 | loss: 0.4533421
	speed: 0.0433s/iter; left time: 238.5710s
	iters: 900, epoch: 4 | loss: 0.4198165
	speed: 0.0434s/iter; left time: 235.0752s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:39.95s
Steps: 902 | Train Loss: 0.4426506 Vali Loss: 0.6053154 Test Loss: 0.6779942
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4462722
	speed: 0.1153s/iter; left time: 612.4162s
	iters: 200, epoch: 5 | loss: 0.4145476
	speed: 0.0486s/iter; left time: 253.2895s
	iters: 300, epoch: 5 | loss: 0.4069575
	speed: 0.0484s/iter; left time: 247.3172s
	iters: 400, epoch: 5 | loss: 0.4398940
	speed: 0.0473s/iter; left time: 237.3475s
	iters: 500, epoch: 5 | loss: 0.3539902
	speed: 0.0491s/iter; left time: 241.3685s
	iters: 600, epoch: 5 | loss: 0.3999235
	speed: 0.0479s/iter; left time: 230.5647s
	iters: 700, epoch: 5 | loss: 0.4306205
	speed: 0.0479s/iter; left time: 225.6778s
	iters: 800, epoch: 5 | loss: 0.3808160
	speed: 0.0460s/iter; left time: 212.1231s
	iters: 900, epoch: 5 | loss: 0.3558828
	speed: 0.0490s/iter; left time: 220.9672s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.46s
Steps: 902 | Train Loss: 0.4057229 Vali Loss: 0.6094700 Test Loss: 0.6841301
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3801375
	speed: 0.1138s/iter; left time: 501.9657s
	iters: 200, epoch: 6 | loss: 0.3963151
	speed: 0.0478s/iter; left time: 206.0785s
	iters: 300, epoch: 6 | loss: 0.3608236
	speed: 0.0462s/iter; left time: 194.6091s
	iters: 400, epoch: 6 | loss: 0.3986512
	speed: 0.0466s/iter; left time: 191.5625s
	iters: 500, epoch: 6 | loss: 0.3677309
	speed: 0.0480s/iter; left time: 192.5430s
	iters: 600, epoch: 6 | loss: 0.3556405
	speed: 0.0459s/iter; left time: 179.5492s
	iters: 700, epoch: 6 | loss: 0.3937513
	speed: 0.0502s/iter; left time: 191.4566s
	iters: 800, epoch: 6 | loss: 0.3524588
	speed: 0.0435s/iter; left time: 161.5104s
	iters: 900, epoch: 6 | loss: 0.4020260
	speed: 0.0430s/iter; left time: 155.1365s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:42.36s
Steps: 902 | Train Loss: 0.3728632 Vali Loss: 0.6032423 Test Loss: 0.6830379
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
mse:0.9181895852088928, rmse:0.9582220911979675, mae:0.6743886470794678, rse:0.7590816020965576
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.8299315
	speed: 0.0544s/iter; left time: 485.0039s
	iters: 200, epoch: 1 | loss: 0.7454510
	speed: 0.0456s/iter; left time: 402.5963s
	iters: 300, epoch: 1 | loss: 0.7466465
	speed: 0.0480s/iter; left time: 418.5842s
	iters: 400, epoch: 1 | loss: 0.6557025
	speed: 0.0498s/iter; left time: 429.1631s
	iters: 500, epoch: 1 | loss: 0.7619171
	speed: 0.0486s/iter; left time: 414.3322s
	iters: 600, epoch: 1 | loss: 0.6939421
	speed: 0.0501s/iter; left time: 421.5456s
	iters: 700, epoch: 1 | loss: 0.6871172
	speed: 0.0515s/iter; left time: 428.2527s
	iters: 800, epoch: 1 | loss: 0.6730585
	speed: 0.0495s/iter; left time: 407.2343s
	iters: 900, epoch: 1 | loss: 0.6839611
	speed: 0.0471s/iter; left time: 382.2429s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:44.61s
Steps: 902 | Train Loss: 0.7359966 Vali Loss: 0.7750741 Test Loss: 0.8830065
Validation loss decreased (inf --> 0.775074).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6534581
	speed: 0.1104s/iter; left time: 885.1009s
	iters: 200, epoch: 2 | loss: 0.6015845
	speed: 0.0473s/iter; left time: 374.8443s
	iters: 300, epoch: 2 | loss: 0.5685660
	speed: 0.0467s/iter; left time: 365.3289s
	iters: 400, epoch: 2 | loss: 0.5155253
	speed: 0.0462s/iter; left time: 356.4591s
	iters: 500, epoch: 2 | loss: 0.5459198
	speed: 0.0395s/iter; left time: 301.2098s
	iters: 600, epoch: 2 | loss: 0.5458264
	speed: 0.0513s/iter; left time: 386.0754s
	iters: 700, epoch: 2 | loss: 0.5243857
	speed: 0.0474s/iter; left time: 351.9616s
	iters: 800, epoch: 2 | loss: 0.4769245
	speed: 0.0465s/iter; left time: 340.4534s
	iters: 900, epoch: 2 | loss: 0.5050618
	speed: 0.0470s/iter; left time: 339.3225s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:41.40s
Steps: 902 | Train Loss: 0.5828387 Vali Loss: 0.6318169 Test Loss: 0.6922542
Validation loss decreased (0.775074 --> 0.631817).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4728614
	speed: 0.1218s/iter; left time: 866.5262s
	iters: 200, epoch: 3 | loss: 0.5261030
	speed: 0.0504s/iter; left time: 353.5869s
	iters: 300, epoch: 3 | loss: 0.5349222
	speed: 0.0484s/iter; left time: 335.0392s
	iters: 400, epoch: 3 | loss: 0.4912176
	speed: 0.0450s/iter; left time: 306.4674s
	iters: 500, epoch: 3 | loss: 0.4878269
	speed: 0.0477s/iter; left time: 320.6275s
	iters: 600, epoch: 3 | loss: 0.4733405
	speed: 0.0477s/iter; left time: 315.7988s
	iters: 700, epoch: 3 | loss: 0.4788861
	speed: 0.0466s/iter; left time: 303.4377s
	iters: 800, epoch: 3 | loss: 0.4421423
	speed: 0.0489s/iter; left time: 313.8948s
	iters: 900, epoch: 3 | loss: 0.4829474
	speed: 0.0469s/iter; left time: 296.4990s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.50s
Steps: 902 | Train Loss: 0.4822041 Vali Loss: 0.6058274 Test Loss: 0.6784457
Validation loss decreased (0.631817 --> 0.605827).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4432037
	speed: 0.1160s/iter; left time: 720.7727s
	iters: 200, epoch: 4 | loss: 0.4207739
	speed: 0.0451s/iter; left time: 275.8593s
	iters: 300, epoch: 4 | loss: 0.4485465
	speed: 0.0457s/iter; left time: 274.8385s
	iters: 400, epoch: 4 | loss: 0.4216956
	speed: 0.0476s/iter; left time: 281.7872s
	iters: 500, epoch: 4 | loss: 0.4323597
	speed: 0.0425s/iter; left time: 247.3266s
	iters: 600, epoch: 4 | loss: 0.4566031
	speed: 0.0455s/iter; left time: 259.8650s
	iters: 700, epoch: 4 | loss: 0.4132438
	speed: 0.0439s/iter; left time: 246.3665s
	iters: 800, epoch: 4 | loss: 0.4526260
	speed: 0.0400s/iter; left time: 220.6084s
	iters: 900, epoch: 4 | loss: 0.4229877
	speed: 0.0394s/iter; left time: 213.3931s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:40.02s
Steps: 902 | Train Loss: 0.4381912 Vali Loss: 0.6134671 Test Loss: 0.6851713
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3913986
	speed: 0.1141s/iter; left time: 605.9583s
	iters: 200, epoch: 5 | loss: 0.4092474
	speed: 0.0353s/iter; left time: 184.0592s
	iters: 300, epoch: 5 | loss: 0.4011174
	speed: 0.0318s/iter; left time: 162.7182s
	iters: 400, epoch: 5 | loss: 0.4198884
	speed: 0.0480s/iter; left time: 240.5887s
	iters: 500, epoch: 5 | loss: 0.4173927
	speed: 0.0450s/iter; left time: 221.1302s
	iters: 600, epoch: 5 | loss: 0.3680047
	speed: 0.0456s/iter; left time: 219.6033s
	iters: 700, epoch: 5 | loss: 0.3919460
	speed: 0.0409s/iter; left time: 192.5841s
	iters: 800, epoch: 5 | loss: 0.3730892
	speed: 0.0413s/iter; left time: 190.6214s
	iters: 900, epoch: 5 | loss: 0.3954324
	speed: 0.0479s/iter; left time: 215.9963s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.78s
Steps: 902 | Train Loss: 0.3990515 Vali Loss: 0.6189988 Test Loss: 0.7172663
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3820037
	speed: 0.1137s/iter; left time: 501.7216s
	iters: 200, epoch: 6 | loss: 0.3538638
	speed: 0.0422s/iter; left time: 181.9069s
	iters: 300, epoch: 6 | loss: 0.3834887
	speed: 0.0498s/iter; left time: 209.5323s
	iters: 400, epoch: 6 | loss: 0.3656156
	speed: 0.0468s/iter; left time: 192.4982s
	iters: 500, epoch: 6 | loss: 0.3440894
	speed: 0.0456s/iter; left time: 182.7710s
	iters: 600, epoch: 6 | loss: 0.3865888
	speed: 0.0477s/iter; left time: 186.5412s
	iters: 700, epoch: 6 | loss: 0.3846876
	speed: 0.0441s/iter; left time: 167.9876s
	iters: 800, epoch: 6 | loss: 0.3305223
	speed: 0.0505s/iter; left time: 187.5696s
	iters: 900, epoch: 6 | loss: 0.3503212
	speed: 0.0390s/iter; left time: 140.9003s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:41.85s
Steps: 902 | Train Loss: 0.3667933 Vali Loss: 0.6223052 Test Loss: 0.6999300
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
mse:0.918017566204071, rmse:0.9581323266029358, mae:0.6783621907234192, rse:0.7590104937553406

Extracted Metrics for DE, pred_len=168, iteration=1:
MSE: 0.9181895852088928, RMSE: 0.9582220911979675, MAE: 0.6743886470794678, RSE: 0.7590816020965576

Extracted Metrics for DE, pred_len=168, iteration=2:
MSE: 0.918017566204071, RMSE: 0.9581323266029358, MAE: 0.6783621907234192, RSE: 0.7590104937553406
