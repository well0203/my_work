
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
train 143005
val 31085
test 31085
[2024-11-03 01:12:05,716] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-03 01:12:06,757] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-03 01:12:06,757] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-03 01:12:06,757] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-03 01:12:06,848] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-03 01:12:06,848] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-03 01:12:07,583] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-03 01:12:07,584] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-03 01:12:07,584] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-03 01:12:07,586] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-03 01:12:07,586] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-03 01:12:07,586] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-03 01:12:07,586] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-03 01:12:07,586] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-03 01:12:07,586] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-03 01:12:07,586] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-03 01:12:07,942] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-03 01:12:07,944] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-03 01:12:07,944] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 75.49 GB, percent = 10.0%
[2024-11-03 01:12:08,122] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-03 01:12:08,123] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 01:12:08,123] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 75.53 GB, percent = 10.0%
[2024-11-03 01:12:08,123] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-03 01:12:08,286] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-03 01:12:08,287] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 01:12:08,287] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 75.42 GB, percent = 10.0%
[2024-11-03 01:12:08,288] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-03 01:12:08,288] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-03 01:12:08,288] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-03 01:12:08,288] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-03 01:12:08,289] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-03 01:12:08,289] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-03 01:12:08,289] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f1cacb059d0>
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-03 01:12:08,290] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-03 01:12:08,291] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-03 01:12:08,292] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-03 01:12:08,292] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-03 01:12:08,292] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-03 01:12:08,292] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-03 01:12:08,292] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-03 01:12:08,292] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-03 01:12:08,292] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-03 01:12:08,292] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-03 01:12:08,292] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1688982
	speed: 0.1674s/iter; left time: 14941.3446s
	iters: 200, epoch: 1 | loss: 0.1398762
	speed: 0.1227s/iter; left time: 10938.8876s
	iters: 300, epoch: 1 | loss: 0.1594033
	speed: 0.1246s/iter; left time: 11095.0762s
	iters: 400, epoch: 1 | loss: 0.1548022
	speed: 0.1240s/iter; left time: 11033.2634s
	iters: 500, epoch: 1 | loss: 0.1380969
	speed: 0.1244s/iter; left time: 11056.1716s
	iters: 600, epoch: 1 | loss: 0.1172558
	speed: 0.1254s/iter; left time: 11131.3914s
	iters: 700, epoch: 1 | loss: 0.1290968
	speed: 0.1249s/iter; left time: 11072.9375s
	iters: 800, epoch: 1 | loss: 0.1323915
	speed: 0.1237s/iter; left time: 10953.4734s
	iters: 900, epoch: 1 | loss: 0.0968730
	speed: 0.1241s/iter; left time: 10982.1952s
	iters: 1000, epoch: 1 | loss: 0.1262417
	speed: 0.1247s/iter; left time: 11018.8563s
	iters: 1100, epoch: 1 | loss: 0.1081160
	speed: 0.1254s/iter; left time: 11067.6072s
	iters: 1200, epoch: 1 | loss: 0.1055638
	speed: 0.1233s/iter; left time: 10866.4606s
	iters: 1300, epoch: 1 | loss: 0.0805435
	speed: 0.1236s/iter; left time: 10880.7501s
	iters: 1400, epoch: 1 | loss: 0.1116071
	speed: 0.1239s/iter; left time: 10895.0457s
	iters: 1500, epoch: 1 | loss: 0.0692826
	speed: 0.1238s/iter; left time: 10879.3045s
	iters: 1600, epoch: 1 | loss: 0.0953681
	speed: 0.1243s/iter; left time: 10905.0177s
	iters: 1700, epoch: 1 | loss: 0.1187560
	speed: 0.1228s/iter; left time: 10768.5576s
	iters: 1800, epoch: 1 | loss: 0.0991687
	speed: 0.1231s/iter; left time: 10777.3760s
	iters: 1900, epoch: 1 | loss: 0.1227836
	speed: 0.1242s/iter; left time: 10861.5365s
	iters: 2000, epoch: 1 | loss: 0.0913499
	speed: 0.1222s/iter; left time: 10676.2045s
	iters: 2100, epoch: 1 | loss: 0.0831885
	speed: 0.1243s/iter; left time: 10845.1859s
	iters: 2200, epoch: 1 | loss: 0.1006144
	speed: 0.1223s/iter; left time: 10662.3231s
	iters: 2300, epoch: 1 | loss: 0.1002881
	speed: 0.1232s/iter; left time: 10727.6874s
	iters: 2400, epoch: 1 | loss: 0.0858188
	speed: 0.1241s/iter; left time: 10787.8205s
	iters: 2500, epoch: 1 | loss: 0.0878481
	speed: 0.1233s/iter; left time: 10707.2554s
	iters: 2600, epoch: 1 | loss: 0.0938092
	speed: 0.1251s/iter; left time: 10856.3638s
	iters: 2700, epoch: 1 | loss: 0.1014624
	speed: 0.1246s/iter; left time: 10801.6068s
	iters: 2800, epoch: 1 | loss: 0.0828544
	speed: 0.1242s/iter; left time: 10747.8099s
	iters: 2900, epoch: 1 | loss: 0.0846184
	speed: 0.1240s/iter; left time: 10719.4482s
	iters: 3000, epoch: 1 | loss: 0.0732674
	speed: 0.1233s/iter; left time: 10648.1436s
	iters: 3100, epoch: 1 | loss: 0.0863261
	speed: 0.1233s/iter; left time: 10635.2736s
	iters: 3200, epoch: 1 | loss: 0.1145399
	speed: 0.1231s/iter; left time: 10606.0279s
	iters: 3300, epoch: 1 | loss: 0.0950736
	speed: 0.1244s/iter; left time: 10705.7121s
	iters: 3400, epoch: 1 | loss: 0.1013337
	speed: 0.1254s/iter; left time: 10783.4548s
	iters: 3500, epoch: 1 | loss: 0.0962714
	speed: 0.1234s/iter; left time: 10599.2676s
	iters: 3600, epoch: 1 | loss: 0.1045466
	speed: 0.1249s/iter; left time: 10713.2908s
	iters: 3700, epoch: 1 | loss: 0.0921188
	speed: 0.1228s/iter; left time: 10516.2821s
	iters: 3800, epoch: 1 | loss: 0.0915671
	speed: 0.1235s/iter; left time: 10562.9555s
	iters: 3900, epoch: 1 | loss: 0.1059835
	speed: 0.1255s/iter; left time: 10726.9688s
	iters: 4000, epoch: 1 | loss: 0.0626834
	speed: 0.1229s/iter; left time: 10488.5240s
	iters: 4100, epoch: 1 | loss: 0.0807726
	speed: 0.1229s/iter; left time: 10482.4050s
	iters: 4200, epoch: 1 | loss: 0.1075011
	speed: 0.1222s/iter; left time: 10402.4167s
	iters: 4300, epoch: 1 | loss: 0.0953812
	speed: 0.1234s/iter; left time: 10499.2678s
	iters: 4400, epoch: 1 | loss: 0.0955328
	speed: 0.1237s/iter; left time: 10509.4145s
Epoch: 1 cost time: 00h:09m:14.48s
Epoch: 1 | Train Loss: 0.1053388 Vali Loss: 0.0971123 Test Loss: 0.0994308
Validation loss decreased (inf --> 0.097112).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0704475
	speed: 1.7948s/iter; left time: 152182.9881s
	iters: 200, epoch: 2 | loss: 0.0855533
	speed: 0.1141s/iter; left time: 9659.3097s
	iters: 300, epoch: 2 | loss: 0.0774946
	speed: 0.1140s/iter; left time: 9640.4392s
	iters: 400, epoch: 2 | loss: 0.0883429
	speed: 0.1123s/iter; left time: 9491.7135s
	iters: 500, epoch: 2 | loss: 0.0867326
	speed: 0.1123s/iter; left time: 9475.7204s
	iters: 600, epoch: 2 | loss: 0.0939545
	speed: 0.1139s/iter; left time: 9597.7267s
	iters: 700, epoch: 2 | loss: 0.0739971
	speed: 0.1128s/iter; left time: 9497.3048s
	iters: 800, epoch: 2 | loss: 0.0977335
	speed: 0.1149s/iter; left time: 9664.4324s
	iters: 900, epoch: 2 | loss: 0.0857365
	speed: 0.1138s/iter; left time: 9555.0482s
	iters: 1000, epoch: 2 | loss: 0.0865258
	speed: 0.1149s/iter; left time: 9639.7231s
	iters: 1100, epoch: 2 | loss: 0.0972862
	speed: 0.1140s/iter; left time: 9554.6080s
	iters: 1200, epoch: 2 | loss: 0.0832878
	speed: 0.1144s/iter; left time: 9574.7462s
	iters: 1300, epoch: 2 | loss: 0.0947991
	speed: 0.1156s/iter; left time: 9662.8164s
	iters: 1400, epoch: 2 | loss: 0.0940965
	speed: 0.1154s/iter; left time: 9639.0286s
	iters: 1500, epoch: 2 | loss: 0.0825809
	speed: 0.1155s/iter; left time: 9628.6063s
	iters: 1600, epoch: 2 | loss: 0.0861147
	speed: 0.1136s/iter; left time: 9465.3499s
	iters: 1700, epoch: 2 | loss: 0.1065482
	speed: 0.1139s/iter; left time: 9479.3903s
	iters: 1800, epoch: 2 | loss: 0.0846911
	speed: 0.1132s/iter; left time: 9403.8697s
	iters: 1900, epoch: 2 | loss: 0.1024258
	speed: 0.1142s/iter; left time: 9480.0655s
	iters: 2000, epoch: 2 | loss: 0.0896808
	speed: 0.1129s/iter; left time: 9358.1236s
	iters: 2100, epoch: 2 | loss: 0.1056611
	speed: 0.1135s/iter; left time: 9397.8205s
	iters: 2200, epoch: 2 | loss: 0.0911830
	speed: 0.1128s/iter; left time: 9331.4414s
	iters: 2300, epoch: 2 | loss: 0.0980409
	speed: 0.1141s/iter; left time: 9421.8908s
	iters: 2400, epoch: 2 | loss: 0.0799288
	speed: 0.1155s/iter; left time: 9529.0887s
	iters: 2500, epoch: 2 | loss: 0.0872002
	speed: 0.1140s/iter; left time: 9391.3248s
	iters: 2600, epoch: 2 | loss: 0.0915525
	speed: 0.1120s/iter; left time: 9218.2102s
	iters: 2700, epoch: 2 | loss: 0.1013657
	speed: 0.1136s/iter; left time: 9339.5619s
	iters: 2800, epoch: 2 | loss: 0.0794303
	speed: 0.1132s/iter; left time: 9294.8333s
	iters: 2900, epoch: 2 | loss: 0.0900755
	speed: 0.1148s/iter; left time: 9411.2400s
	iters: 3000, epoch: 2 | loss: 0.0776787
	speed: 0.1129s/iter; left time: 9244.6546s
	iters: 3100, epoch: 2 | loss: 0.1028968
	speed: 0.1133s/iter; left time: 9268.9056s
	iters: 3200, epoch: 2 | loss: 0.0771540
	speed: 0.1152s/iter; left time: 9411.0392s
	iters: 3300, epoch: 2 | loss: 0.0871339
	speed: 0.1157s/iter; left time: 9437.3403s
	iters: 3400, epoch: 2 | loss: 0.1009780
	speed: 0.1145s/iter; left time: 9332.5256s
	iters: 3500, epoch: 2 | loss: 0.0891745
	speed: 0.1149s/iter; left time: 9348.6727s
	iters: 3600, epoch: 2 | loss: 0.0985909
	speed: 0.1155s/iter; left time: 9389.6240s
	iters: 3700, epoch: 2 | loss: 0.1067271
	speed: 0.1178s/iter; left time: 9560.6694s
	iters: 3800, epoch: 2 | loss: 0.0852604
	speed: 0.1159s/iter; left time: 9395.5152s
	iters: 3900, epoch: 2 | loss: 0.0817025
	speed: 0.1128s/iter; left time: 9132.8653s
	iters: 4000, epoch: 2 | loss: 0.0846763
	speed: 0.1128s/iter; left time: 9121.4540s
	iters: 4100, epoch: 2 | loss: 0.0871173
	speed: 0.1136s/iter; left time: 9175.4806s
	iters: 4200, epoch: 2 | loss: 0.0959664
	speed: 0.1137s/iter; left time: 9174.5179s
	iters: 4300, epoch: 2 | loss: 0.0784686
	speed: 0.1134s/iter; left time: 9141.7126s
	iters: 4400, epoch: 2 | loss: 0.0950680
	speed: 0.1138s/iter; left time: 9156.8940s
Epoch: 2 cost time: 00h:08m:30.16s
Epoch: 2 | Train Loss: 0.0889246 Vali Loss: 0.0918921 Test Loss: 0.0945349
Validation loss decreased (0.097112 --> 0.091892).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.1014844
	speed: 1.6040s/iter; left time: 128842.4170s
	iters: 200, epoch: 3 | loss: 0.0968780
	speed: 0.1137s/iter; left time: 9122.6059s
	iters: 300, epoch: 3 | loss: 0.0694327
	speed: 0.1162s/iter; left time: 9306.7944s
	iters: 400, epoch: 3 | loss: 0.0818534
	speed: 0.1131s/iter; left time: 9049.8084s
	iters: 500, epoch: 3 | loss: 0.1179019
	speed: 0.1105s/iter; left time: 8835.4020s
	iters: 600, epoch: 3 | loss: 0.0902409
	speed: 0.1127s/iter; left time: 8993.7143s
	iters: 700, epoch: 3 | loss: 0.0945199
	speed: 0.1126s/iter; left time: 8973.5594s
	iters: 800, epoch: 3 | loss: 0.0943223
	speed: 0.1126s/iter; left time: 8965.1199s
	iters: 900, epoch: 3 | loss: 0.0608129
	speed: 0.1143s/iter; left time: 9089.2406s
	iters: 1000, epoch: 3 | loss: 0.0815312
	speed: 0.1142s/iter; left time: 9067.5614s
	iters: 1100, epoch: 3 | loss: 0.0903181
	speed: 0.1137s/iter; left time: 9020.1890s
	iters: 1200, epoch: 3 | loss: 0.0806858
	speed: 0.1142s/iter; left time: 9044.4942s
	iters: 1300, epoch: 3 | loss: 0.0762755
	speed: 0.1140s/iter; left time: 9017.3213s
	iters: 1400, epoch: 3 | loss: 0.0923751
	speed: 0.1116s/iter; left time: 8821.8508s
	iters: 1500, epoch: 3 | loss: 0.0904863
	speed: 0.1127s/iter; left time: 8895.6489s
	iters: 1600, epoch: 3 | loss: 0.0592667
	speed: 0.1135s/iter; left time: 8942.9849s
	iters: 1700, epoch: 3 | loss: 0.0708085
	speed: 0.1157s/iter; left time: 9110.4364s
	iters: 1800, epoch: 3 | loss: 0.0865551
	speed: 0.1119s/iter; left time: 8795.0520s
	iters: 1900, epoch: 3 | loss: 0.0666124
	speed: 0.1124s/iter; left time: 8822.9030s
	iters: 2000, epoch: 3 | loss: 0.0717531
	speed: 0.1142s/iter; left time: 8953.9096s
	iters: 2100, epoch: 3 | loss: 0.1037164
	speed: 0.1134s/iter; left time: 8884.8049s
	iters: 2200, epoch: 3 | loss: 0.0819335
	speed: 0.1118s/iter; left time: 8748.3673s
	iters: 2300, epoch: 3 | loss: 0.0837101
	speed: 0.1114s/iter; left time: 8701.8710s
	iters: 2400, epoch: 3 | loss: 0.0792184
	speed: 0.1116s/iter; left time: 8710.8425s
	iters: 2500, epoch: 3 | loss: 0.0968816
	speed: 0.1135s/iter; left time: 8845.6248s
	iters: 2600, epoch: 3 | loss: 0.0933213
	speed: 0.1132s/iter; left time: 8806.5863s
	iters: 2700, epoch: 3 | loss: 0.0743180
	speed: 0.1126s/iter; left time: 8748.4160s
	iters: 2800, epoch: 3 | loss: 0.0937308
	speed: 0.1126s/iter; left time: 8740.1547s
	iters: 2900, epoch: 3 | loss: 0.0838305
	speed: 0.1137s/iter; left time: 8813.0296s
	iters: 3000, epoch: 3 | loss: 0.0647273
	speed: 0.1146s/iter; left time: 8875.4268s
	iters: 3100, epoch: 3 | loss: 0.0913395
	speed: 0.1137s/iter; left time: 8793.1195s
	iters: 3200, epoch: 3 | loss: 0.0819122
	speed: 0.1131s/iter; left time: 8732.8662s
	iters: 3300, epoch: 3 | loss: 0.0788185
	speed: 0.1123s/iter; left time: 8659.5411s
	iters: 3400, epoch: 3 | loss: 0.0784381
	speed: 0.1121s/iter; left time: 8636.4983s
	iters: 3500, epoch: 3 | loss: 0.0678186
	speed: 0.1117s/iter; left time: 8588.7881s
	iters: 3600, epoch: 3 | loss: 0.0698414
	speed: 0.1137s/iter; left time: 8736.1703s
	iters: 3700, epoch: 3 | loss: 0.0900844
	speed: 0.1122s/iter; left time: 8606.1957s
	iters: 3800, epoch: 3 | loss: 0.0756922
	speed: 0.1149s/iter; left time: 8805.2898s
	iters: 3900, epoch: 3 | loss: 0.0685307
	speed: 0.1125s/iter; left time: 8610.4216s
	iters: 4000, epoch: 3 | loss: 0.0735308
	speed: 0.1119s/iter; left time: 8552.9052s
	iters: 4100, epoch: 3 | loss: 0.0800254
	speed: 0.1119s/iter; left time: 8542.2113s
	iters: 4200, epoch: 3 | loss: 0.0855180
	speed: 0.1154s/iter; left time: 8796.0084s
	iters: 4300, epoch: 3 | loss: 0.0667157
	speed: 0.1144s/iter; left time: 8708.6890s
	iters: 4400, epoch: 3 | loss: 0.0843554
	speed: 0.1124s/iter; left time: 8544.1850s
Epoch: 3 cost time: 00h:08m:26.09s
Epoch: 3 | Train Loss: 0.0853331 Vali Loss: 0.0911640 Test Loss: 0.0942841
Validation loss decreased (0.091892 --> 0.091164).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0739329
	speed: 1.5815s/iter; left time: 119968.3080s
	iters: 200, epoch: 4 | loss: 0.1006263
	speed: 0.1141s/iter; left time: 8647.2176s
	iters: 300, epoch: 4 | loss: 0.0738416
	speed: 0.1155s/iter; left time: 8739.9632s
	iters: 400, epoch: 4 | loss: 0.0781351
	speed: 0.1131s/iter; left time: 8548.7698s
	iters: 500, epoch: 4 | loss: 0.0675929
	speed: 0.1151s/iter; left time: 8687.4375s
	iters: 600, epoch: 4 | loss: 0.0722866
	speed: 0.1138s/iter; left time: 8578.3459s
	iters: 700, epoch: 4 | loss: 0.0852794
	speed: 0.1146s/iter; left time: 8627.3161s
	iters: 800, epoch: 4 | loss: 0.0830615
	speed: 0.1136s/iter; left time: 8539.2426s
	iters: 900, epoch: 4 | loss: 0.0746369
	speed: 0.1127s/iter; left time: 8458.1302s
	iters: 1000, epoch: 4 | loss: 0.0714534
	speed: 0.1134s/iter; left time: 8499.4897s
	iters: 1100, epoch: 4 | loss: 0.0721987
	speed: 0.1133s/iter; left time: 8483.5015s
	iters: 1200, epoch: 4 | loss: 0.0848372
	speed: 0.1142s/iter; left time: 8540.1918s
	iters: 1300, epoch: 4 | loss: 0.0901184
	speed: 0.1126s/iter; left time: 8406.3739s
	iters: 1400, epoch: 4 | loss: 0.0873635
	speed: 0.1127s/iter; left time: 8402.5782s
	iters: 1500, epoch: 4 | loss: 0.0672005
	speed: 0.1121s/iter; left time: 8348.9412s
	iters: 1600, epoch: 4 | loss: 0.0815371
	speed: 0.1119s/iter; left time: 8321.4581s
	iters: 1700, epoch: 4 | loss: 0.0967667
	speed: 0.1143s/iter; left time: 8487.8214s
	iters: 1800, epoch: 4 | loss: 0.1003437
	speed: 0.1123s/iter; left time: 8328.0192s
	iters: 1900, epoch: 4 | loss: 0.0772678
	speed: 0.1121s/iter; left time: 8303.8600s
	iters: 2000, epoch: 4 | loss: 0.1023371
	speed: 0.1112s/iter; left time: 8226.3107s
	iters: 2100, epoch: 4 | loss: 0.0959407
	speed: 0.1126s/iter; left time: 8313.9698s
	iters: 2200, epoch: 4 | loss: 0.0707141
	speed: 0.1121s/iter; left time: 8266.0775s
	iters: 2300, epoch: 4 | loss: 0.1181110
	speed: 0.1130s/iter; left time: 8323.1719s
	iters: 2400, epoch: 4 | loss: 0.0988108
	speed: 0.1115s/iter; left time: 8201.0479s
	iters: 2500, epoch: 4 | loss: 0.1022194
	speed: 0.1111s/iter; left time: 8160.0609s
	iters: 2600, epoch: 4 | loss: 0.0755848
	speed: 0.1114s/iter; left time: 8168.9965s
	iters: 2700, epoch: 4 | loss: 0.0852136
	speed: 0.1122s/iter; left time: 8220.4746s
	iters: 2800, epoch: 4 | loss: 0.1073938
	speed: 0.1111s/iter; left time: 8125.4232s
	iters: 2900, epoch: 4 | loss: 0.0776819
	speed: 0.1122s/iter; left time: 8200.1518s
	iters: 3000, epoch: 4 | loss: 0.0915424
	speed: 0.1117s/iter; left time: 8146.3091s
	iters: 3100, epoch: 4 | loss: 0.0914509
	speed: 0.1155s/iter; left time: 8412.5511s
	iters: 3200, epoch: 4 | loss: 0.0769955
	speed: 0.1168s/iter; left time: 8498.2199s
	iters: 3300, epoch: 4 | loss: 0.0912195
	speed: 0.1177s/iter; left time: 8550.1338s
	iters: 3400, epoch: 4 | loss: 0.0864609
	speed: 0.1169s/iter; left time: 8485.3160s
	iters: 3500, epoch: 4 | loss: 0.0855569
	speed: 0.1181s/iter; left time: 8557.3971s
	iters: 3600, epoch: 4 | loss: 0.0880700
	speed: 0.1181s/iter; left time: 8544.6155s
	iters: 3700, epoch: 4 | loss: 0.0775939
	speed: 0.1193s/iter; left time: 8618.5048s
	iters: 3800, epoch: 4 | loss: 0.0855137
	speed: 0.1171s/iter; left time: 8451.2831s
	iters: 3900, epoch: 4 | loss: 0.0877626
	speed: 0.1153s/iter; left time: 8308.4451s
	iters: 4000, epoch: 4 | loss: 0.0802846
	speed: 0.1172s/iter; left time: 8436.5780s
	iters: 4100, epoch: 4 | loss: 0.0870235
	speed: 0.1202s/iter; left time: 8634.0718s
	iters: 4200, epoch: 4 | loss: 0.0716099
	speed: 0.1207s/iter; left time: 8660.1850s
	iters: 4300, epoch: 4 | loss: 0.0780072
	speed: 0.1156s/iter; left time: 8281.9815s
	iters: 4400, epoch: 4 | loss: 0.0948033
	speed: 0.1183s/iter; left time: 8463.4481s
Epoch: 4 cost time: 00h:08m:31.84s
Epoch: 4 | Train Loss: 0.0836256 Vali Loss: 0.0897763 Test Loss: 0.0933365
Validation loss decreased (0.091164 --> 0.089776).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0797964
	speed: 1.6464s/iter; left time: 117532.0136s
	iters: 200, epoch: 5 | loss: 0.0838478
	speed: 0.1194s/iter; left time: 8512.3885s
	iters: 300, epoch: 5 | loss: 0.0742453
	speed: 0.1179s/iter; left time: 8390.0387s
	iters: 400, epoch: 5 | loss: 0.0888728
	speed: 0.1203s/iter; left time: 8551.0436s
	iters: 500, epoch: 5 | loss: 0.0898506
	speed: 0.1186s/iter; left time: 8422.4576s
	iters: 600, epoch: 5 | loss: 0.0773116
	speed: 0.1140s/iter; left time: 8081.0151s
	iters: 700, epoch: 5 | loss: 0.0626944
	speed: 0.1191s/iter; left time: 8430.4481s
	iters: 800, epoch: 5 | loss: 0.0781008
	speed: 0.1205s/iter; left time: 8519.7659s
	iters: 900, epoch: 5 | loss: 0.0825634
	speed: 0.1205s/iter; left time: 8509.4591s
	iters: 1000, epoch: 5 | loss: 0.0848518
	speed: 0.1189s/iter; left time: 8377.6728s
	iters: 1100, epoch: 5 | loss: 0.0829829
	speed: 0.1204s/iter; left time: 8472.5536s
	iters: 1200, epoch: 5 | loss: 0.0997171
	speed: 0.1201s/iter; left time: 8443.6639s
	iters: 1300, epoch: 5 | loss: 0.0798143
	speed: 0.1197s/iter; left time: 8402.1515s
	iters: 1400, epoch: 5 | loss: 0.0764720
	speed: 0.1176s/iter; left time: 8243.6340s
	iters: 1500, epoch: 5 | loss: 0.0732888
	speed: 0.1193s/iter; left time: 8351.0889s
	iters: 1600, epoch: 5 | loss: 0.0836849
	speed: 0.1157s/iter; left time: 8085.6975s
	iters: 1700, epoch: 5 | loss: 0.0724503
	speed: 0.1156s/iter; left time: 8069.1478s
	iters: 1800, epoch: 5 | loss: 0.0894237
	speed: 0.1198s/iter; left time: 8348.4672s
	iters: 1900, epoch: 5 | loss: 0.0685364
	speed: 0.1178s/iter; left time: 8200.5653s
	iters: 2000, epoch: 5 | loss: 0.0697801
	speed: 0.1175s/iter; left time: 8164.8331s
	iters: 2100, epoch: 5 | loss: 0.0814900
	speed: 0.1169s/iter; left time: 8113.5792s
	iters: 2200, epoch: 5 | loss: 0.0934933
	speed: 0.1142s/iter; left time: 7911.7020s
	iters: 2300, epoch: 5 | loss: 0.0861936
	speed: 0.1145s/iter; left time: 7919.7570s
	iters: 2400, epoch: 5 | loss: 0.0938417
	speed: 0.1149s/iter; left time: 7940.1099s
	iters: 2500, epoch: 5 | loss: 0.0799977
	speed: 0.1189s/iter; left time: 8205.5438s
	iters: 2600, epoch: 5 | loss: 0.0855416
	speed: 0.1195s/iter; left time: 8229.9662s
	iters: 2700, epoch: 5 | loss: 0.0920220
	speed: 0.1158s/iter; left time: 7968.0307s
	iters: 2800, epoch: 5 | loss: 0.0856894
	speed: 0.1187s/iter; left time: 8154.6670s
	iters: 2900, epoch: 5 | loss: 0.0774287
	speed: 0.1181s/iter; left time: 8098.6651s
	iters: 3000, epoch: 5 | loss: 0.0683412
	speed: 0.1165s/iter; left time: 7976.2434s
	iters: 3100, epoch: 5 | loss: 0.0973268
	speed: 0.1172s/iter; left time: 8015.3452s
	iters: 3200, epoch: 5 | loss: 0.0831058
	speed: 0.1146s/iter; left time: 7827.2519s
	iters: 3300, epoch: 5 | loss: 0.0682414
	speed: 0.1170s/iter; left time: 7980.1976s
	iters: 3400, epoch: 5 | loss: 0.0845700
	speed: 0.1196s/iter; left time: 8140.1191s
	iters: 3500, epoch: 5 | loss: 0.0771565
	speed: 0.1187s/iter; left time: 8072.2449s
	iters: 3600, epoch: 5 | loss: 0.0795133
	speed: 0.1174s/iter; left time: 7969.1133s
	iters: 3700, epoch: 5 | loss: 0.0733312
	speed: 0.1185s/iter; left time: 8031.3167s
	iters: 3800, epoch: 5 | loss: 0.0908493
	speed: 0.1188s/iter; left time: 8044.7092s
	iters: 3900, epoch: 5 | loss: 0.0670330
	speed: 0.1188s/iter; left time: 8032.0109s
	iters: 4000, epoch: 5 | loss: 0.0631396
	speed: 0.1181s/iter; left time: 7969.3271s
	iters: 4100, epoch: 5 | loss: 0.0828409
	speed: 0.1209s/iter; left time: 8148.0262s
	iters: 4200, epoch: 5 | loss: 0.0800139
	speed: 0.1177s/iter; left time: 7917.2847s
	iters: 4300, epoch: 5 | loss: 0.0884054
	speed: 0.1186s/iter; left time: 7967.7376s
	iters: 4400, epoch: 5 | loss: 0.0831661
	speed: 0.1184s/iter; left time: 7943.2696s
Epoch: 5 cost time: 00h:08m:48.26s
Epoch: 5 | Train Loss: 0.0823728 Vali Loss: 0.0899557 Test Loss: 0.0942943
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.1001324
	speed: 1.6218s/iter; left time: 108534.5492s
	iters: 200, epoch: 6 | loss: 0.0886922
	speed: 0.1213s/iter; left time: 8105.9663s
	iters: 300, epoch: 6 | loss: 0.0843214
	speed: 0.1200s/iter; left time: 8005.3656s
	iters: 400, epoch: 6 | loss: 0.0734667
	speed: 0.1185s/iter; left time: 7896.9387s
	iters: 500, epoch: 6 | loss: 0.0924280
	speed: 0.1199s/iter; left time: 7979.1377s
	iters: 600, epoch: 6 | loss: 0.0591974
	speed: 0.1180s/iter; left time: 7835.7974s
	iters: 700, epoch: 6 | loss: 0.0633274
	speed: 0.1191s/iter; left time: 7899.5425s
	iters: 800, epoch: 6 | loss: 0.0738303
	speed: 0.1198s/iter; left time: 7930.7576s
	iters: 900, epoch: 6 | loss: 0.1071520
	speed: 0.1218s/iter; left time: 8053.4950s
	iters: 1000, epoch: 6 | loss: 0.0735545
	speed: 0.1204s/iter; left time: 7946.3154s
	iters: 1100, epoch: 6 | loss: 0.0729964
	speed: 0.1196s/iter; left time: 7881.9557s
	iters: 1200, epoch: 6 | loss: 0.0962333
	speed: 0.1199s/iter; left time: 7892.1226s
	iters: 1300, epoch: 6 | loss: 0.0923874
	speed: 0.1202s/iter; left time: 7901.9868s
	iters: 1400, epoch: 6 | loss: 0.0971264
	speed: 0.1218s/iter; left time: 7992.7890s
	iters: 1500, epoch: 6 | loss: 0.0751228
	speed: 0.1189s/iter; left time: 7790.8841s
	iters: 1600, epoch: 6 | loss: 0.0779485
	speed: 0.1172s/iter; left time: 7668.9793s
	iters: 1700, epoch: 6 | loss: 0.0823796
	speed: 0.1168s/iter; left time: 7627.4802s
	iters: 1800, epoch: 6 | loss: 0.0782527
	speed: 0.1174s/iter; left time: 7659.5757s
	iters: 1900, epoch: 6 | loss: 0.0854593
	speed: 0.1211s/iter; left time: 7887.2417s
	iters: 2000, epoch: 6 | loss: 0.0940582
	speed: 0.1216s/iter; left time: 7906.6408s
	iters: 2100, epoch: 6 | loss: 0.0806722
	speed: 0.1156s/iter; left time: 7503.7319s
	iters: 2200, epoch: 6 | loss: 0.0820966
	speed: 0.1188s/iter; left time: 7698.6315s
	iters: 2300, epoch: 6 | loss: 0.0738427
	speed: 0.1190s/iter; left time: 7704.3061s
	iters: 2400, epoch: 6 | loss: 0.0772219
	speed: 0.1199s/iter; left time: 7749.0500s
	iters: 2500, epoch: 6 | loss: 0.0898360
	speed: 0.1188s/iter; left time: 7662.1246s
	iters: 2600, epoch: 6 | loss: 0.0820411
	speed: 0.1181s/iter; left time: 7605.2153s
	iters: 2700, epoch: 6 | loss: 0.0796860
	speed: 0.1185s/iter; left time: 7624.4024s
	iters: 2800, epoch: 6 | loss: 0.0989802
	speed: 0.1191s/iter; left time: 7649.2150s
	iters: 2900, epoch: 6 | loss: 0.0941869
	speed: 0.1154s/iter; left time: 7401.6936s
	iters: 3000, epoch: 6 | loss: 0.0823741
	speed: 0.1177s/iter; left time: 7534.3386s
	iters: 3100, epoch: 6 | loss: 0.0726927
	speed: 0.1189s/iter; left time: 7598.8294s
	iters: 3200, epoch: 6 | loss: 0.0867132
	speed: 0.1197s/iter; left time: 7638.2616s
	iters: 3300, epoch: 6 | loss: 0.0877910
	speed: 0.1177s/iter; left time: 7499.8711s
	iters: 3400, epoch: 6 | loss: 0.1008532
	speed: 0.1194s/iter; left time: 7595.2404s
	iters: 3500, epoch: 6 | loss: 0.0882527
	speed: 0.1193s/iter; left time: 7575.1135s
	iters: 3600, epoch: 6 | loss: 0.0798398
	speed: 0.1182s/iter; left time: 7498.4859s
	iters: 3700, epoch: 6 | loss: 0.0708239
	speed: 0.1203s/iter; left time: 7614.6941s
	iters: 3800, epoch: 6 | loss: 0.0720952
	speed: 0.1156s/iter; left time: 7310.8871s
	iters: 3900, epoch: 6 | loss: 0.0832081
	speed: 0.1173s/iter; left time: 7402.6487s
	iters: 4000, epoch: 6 | loss: 0.0772891
	speed: 0.1173s/iter; left time: 7395.4665s
	iters: 4100, epoch: 6 | loss: 0.0615834
	speed: 0.1181s/iter; left time: 7433.2315s
	iters: 4200, epoch: 6 | loss: 0.0647544
	speed: 0.1197s/iter; left time: 7521.8139s
	iters: 4300, epoch: 6 | loss: 0.0650132
	speed: 0.1182s/iter; left time: 7414.9879s
	iters: 4400, epoch: 6 | loss: 0.0766972
	speed: 0.1205s/iter; left time: 7544.8569s
Epoch: 6 cost time: 00h:08m:52.30s
Epoch: 6 | Train Loss: 0.0813646 Vali Loss: 0.0895673 Test Loss: 0.0940461
Validation loss decreased (0.089776 --> 0.089567).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0841343
	speed: 1.6530s/iter; left time: 103235.3819s
	iters: 200, epoch: 7 | loss: 0.0774401
	speed: 0.1200s/iter; left time: 7484.1355s
	iters: 300, epoch: 7 | loss: 0.0646475
	speed: 0.1200s/iter; left time: 7471.3773s
	iters: 400, epoch: 7 | loss: 0.0766103
	speed: 0.1180s/iter; left time: 7334.7613s
	iters: 500, epoch: 7 | loss: 0.0919630
	speed: 0.1200s/iter; left time: 7444.7187s
	iters: 600, epoch: 7 | loss: 0.0806891
	speed: 0.1211s/iter; left time: 7504.7698s
	iters: 700, epoch: 7 | loss: 0.0947759
	speed: 0.1203s/iter; left time: 7441.6268s
	iters: 800, epoch: 7 | loss: 0.0886568
	speed: 0.1175s/iter; left time: 7256.5548s
	iters: 900, epoch: 7 | loss: 0.0786587
	speed: 0.1190s/iter; left time: 7336.4875s
	iters: 1000, epoch: 7 | loss: 0.0800228
	speed: 0.1187s/iter; left time: 7306.3839s
	iters: 1100, epoch: 7 | loss: 0.0899325
	speed: 0.1206s/iter; left time: 7411.1211s
	iters: 1200, epoch: 7 | loss: 0.0851249
	speed: 0.1214s/iter; left time: 7446.7356s
	iters: 1300, epoch: 7 | loss: 0.0694570
	speed: 0.1176s/iter; left time: 7206.4126s
	iters: 1400, epoch: 7 | loss: 0.0889620
	speed: 0.1177s/iter; left time: 7198.9649s
	iters: 1500, epoch: 7 | loss: 0.0885222
	speed: 0.1168s/iter; left time: 7131.5664s
	iters: 1600, epoch: 7 | loss: 0.0703967
	speed: 0.1198s/iter; left time: 7302.7558s
	iters: 1700, epoch: 7 | loss: 0.0967138
	speed: 0.1184s/iter; left time: 7206.5879s
	iters: 1800, epoch: 7 | loss: 0.0742753
	speed: 0.1198s/iter; left time: 7275.4256s
	iters: 1900, epoch: 7 | loss: 0.0714891
	speed: 0.1200s/iter; left time: 7276.5838s
	iters: 2000, epoch: 7 | loss: 0.0690335
	speed: 0.1203s/iter; left time: 7285.5115s
	iters: 2100, epoch: 7 | loss: 0.0778978
	speed: 0.1159s/iter; left time: 7006.8084s
	iters: 2200, epoch: 7 | loss: 0.0716214
	speed: 0.1175s/iter; left time: 7091.8659s
	iters: 2300, epoch: 7 | loss: 0.0747692
	speed: 0.1168s/iter; left time: 7040.1868s
	iters: 2400, epoch: 7 | loss: 0.0834282
	speed: 0.1175s/iter; left time: 7065.8316s
	iters: 2500, epoch: 7 | loss: 0.0855097
	speed: 0.1192s/iter; left time: 7161.0485s
	iters: 2600, epoch: 7 | loss: 0.0906422
	speed: 0.1192s/iter; left time: 7149.1376s
	iters: 2700, epoch: 7 | loss: 0.0708709
	speed: 0.1180s/iter; left time: 7059.7972s
	iters: 2800, epoch: 7 | loss: 0.0859929
	speed: 0.1210s/iter; left time: 7230.0027s
	iters: 2900, epoch: 7 | loss: 0.0687493
	speed: 0.1198s/iter; left time: 7147.2599s
	iters: 3000, epoch: 7 | loss: 0.0796787
	speed: 0.1212s/iter; left time: 7216.8474s
	iters: 3100, epoch: 7 | loss: 0.0671332
	speed: 0.1196s/iter; left time: 7109.6244s
	iters: 3200, epoch: 7 | loss: 0.0683739
	speed: 0.1167s/iter; left time: 6927.9818s
	iters: 3300, epoch: 7 | loss: 0.0691068
	speed: 0.1165s/iter; left time: 6902.6622s
	iters: 3400, epoch: 7 | loss: 0.0798232
	speed: 0.1187s/iter; left time: 7021.1931s
	iters: 3500, epoch: 7 | loss: 0.0687565
	speed: 0.1172s/iter; left time: 6919.3256s
	iters: 3600, epoch: 7 | loss: 0.0730739
	speed: 0.1182s/iter; left time: 6967.3658s
	iters: 3700, epoch: 7 | loss: 0.0768365
	speed: 0.1170s/iter; left time: 6888.0754s
	iters: 3800, epoch: 7 | loss: 0.0917242
	speed: 0.1202s/iter; left time: 7063.0170s
	iters: 3900, epoch: 7 | loss: 0.0721889
	speed: 0.1199s/iter; left time: 7035.1511s
	iters: 4000, epoch: 7 | loss: 0.1057147
	speed: 0.1143s/iter; left time: 6692.7616s
	iters: 4100, epoch: 7 | loss: 0.0877508
	speed: 0.1129s/iter; left time: 6600.3418s
	iters: 4200, epoch: 7 | loss: 0.0842020
	speed: 0.1130s/iter; left time: 6595.8754s
	iters: 4300, epoch: 7 | loss: 0.0788388
	speed: 0.1125s/iter; left time: 6555.2348s
	iters: 4400, epoch: 7 | loss: 0.0780672
	speed: 0.1129s/iter; left time: 6565.9990s
Epoch: 7 cost time: 00h:08m:48.62s
Epoch: 7 | Train Loss: 0.0802900 Vali Loss: 0.0892569 Test Loss: 0.0938624
Validation loss decreased (0.089567 --> 0.089257).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0878868
	speed: 1.5867s/iter; left time: 92005.2740s
	iters: 200, epoch: 8 | loss: 0.0819466
	speed: 0.1146s/iter; left time: 6632.6594s
	iters: 300, epoch: 8 | loss: 0.0872314
	speed: 0.1134s/iter; left time: 6552.0696s
	iters: 400, epoch: 8 | loss: 0.0871727
	speed: 0.1149s/iter; left time: 6629.7226s
	iters: 500, epoch: 8 | loss: 0.0690386
	speed: 0.1146s/iter; left time: 6600.8306s
	iters: 600, epoch: 8 | loss: 0.0786107
	speed: 0.1151s/iter; left time: 6617.8909s
	iters: 700, epoch: 8 | loss: 0.0654001
	speed: 0.1152s/iter; left time: 6608.6635s
	iters: 800, epoch: 8 | loss: 0.0706811
	speed: 0.1148s/iter; left time: 6578.6997s
	iters: 900, epoch: 8 | loss: 0.0823400
	speed: 0.1177s/iter; left time: 6731.2845s
	iters: 1000, epoch: 8 | loss: 0.0656414
	speed: 0.1133s/iter; left time: 6466.9469s
	iters: 1100, epoch: 8 | loss: 0.0717802
	speed: 0.1147s/iter; left time: 6537.9668s
	iters: 1200, epoch: 8 | loss: 0.0914649
	speed: 0.1137s/iter; left time: 6465.6763s
	iters: 1300, epoch: 8 | loss: 0.0788195
	speed: 0.1150s/iter; left time: 6529.7991s
	iters: 1400, epoch: 8 | loss: 0.0938862
	speed: 0.1143s/iter; left time: 6480.2686s
	iters: 1500, epoch: 8 | loss: 0.0883940
	speed: 0.1134s/iter; left time: 6417.5553s
	iters: 1600, epoch: 8 | loss: 0.0923529
	speed: 0.1169s/iter; left time: 6605.7957s
	iters: 1700, epoch: 8 | loss: 0.1006962
	speed: 0.1165s/iter; left time: 6570.9238s
	iters: 1800, epoch: 8 | loss: 0.0933289
	speed: 0.1140s/iter; left time: 6417.5089s
	iters: 1900, epoch: 8 | loss: 0.0580641
	speed: 0.1138s/iter; left time: 6393.3432s
	iters: 2000, epoch: 8 | loss: 0.0778803
	speed: 0.1146s/iter; left time: 6429.3977s
	iters: 2100, epoch: 8 | loss: 0.0813645
	speed: 0.1118s/iter; left time: 6261.6275s
	iters: 2200, epoch: 8 | loss: 0.0837200
	speed: 0.1152s/iter; left time: 6438.9706s
	iters: 2300, epoch: 8 | loss: 0.0852636
	speed: 0.1148s/iter; left time: 6404.3086s
	iters: 2400, epoch: 8 | loss: 0.0721436
	speed: 0.1121s/iter; left time: 6240.5479s
	iters: 2500, epoch: 8 | loss: 0.0740744
	speed: 0.1138s/iter; left time: 6324.6577s
	iters: 2600, epoch: 8 | loss: 0.0824070
	speed: 0.1133s/iter; left time: 6285.7820s
	iters: 2700, epoch: 8 | loss: 0.0793054
	speed: 0.1134s/iter; left time: 6278.7559s
	iters: 2800, epoch: 8 | loss: 0.0864588
	speed: 0.1141s/iter; left time: 6305.7187s
	iters: 2900, epoch: 8 | loss: 0.0741376
	speed: 0.1149s/iter; left time: 6342.0597s
	iters: 3000, epoch: 8 | loss: 0.0899623
	speed: 0.1143s/iter; left time: 6298.8285s
	iters: 3100, epoch: 8 | loss: 0.0805951
	speed: 0.1152s/iter; left time: 6334.0774s
	iters: 3200, epoch: 8 | loss: 0.0612919
	speed: 0.1161s/iter; left time: 6371.3833s
	iters: 3300, epoch: 8 | loss: 0.0753164
	speed: 0.1166s/iter; left time: 6387.3990s
	iters: 3400, epoch: 8 | loss: 0.0797729
	speed: 0.1152s/iter; left time: 6298.6305s
	iters: 3500, epoch: 8 | loss: 0.0591326
	speed: 0.1120s/iter; left time: 6112.7558s
	iters: 3600, epoch: 8 | loss: 0.0769536
	speed: 0.1158s/iter; left time: 6309.2520s
	iters: 3700, epoch: 8 | loss: 0.0768749
	speed: 0.1139s/iter; left time: 6192.3924s
	iters: 3800, epoch: 8 | loss: 0.0756438
	speed: 0.1140s/iter; left time: 6185.8640s
	iters: 3900, epoch: 8 | loss: 0.0782435
	speed: 0.1146s/iter; left time: 6211.7814s
	iters: 4000, epoch: 8 | loss: 0.0735168
	speed: 0.1134s/iter; left time: 6135.4879s
	iters: 4100, epoch: 8 | loss: 0.0852071
	speed: 0.1144s/iter; left time: 6174.2145s
	iters: 4200, epoch: 8 | loss: 0.0820105
	speed: 0.1162s/iter; left time: 6259.5710s
	iters: 4300, epoch: 8 | loss: 0.0806806
	speed: 0.1163s/iter; left time: 6256.4244s
	iters: 4400, epoch: 8 | loss: 0.0883520
	speed: 0.1131s/iter; left time: 6069.3030s
Epoch: 8 cost time: 00h:08m:32.31s
Epoch: 8 | Train Loss: 0.0793348 Vali Loss: 0.0892188 Test Loss: 0.0953779
Validation loss decreased (0.089257 --> 0.089219).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.0749750
	speed: 1.5935s/iter; left time: 85278.7636s
	iters: 200, epoch: 9 | loss: 0.0862554
	speed: 0.1149s/iter; left time: 6139.0793s
	iters: 300, epoch: 9 | loss: 0.0647535
	speed: 0.1153s/iter; left time: 6147.8544s
	iters: 400, epoch: 9 | loss: 0.0730983
	speed: 0.1161s/iter; left time: 6177.1792s
	iters: 500, epoch: 9 | loss: 0.0695380
	speed: 0.1143s/iter; left time: 6073.9151s
	iters: 600, epoch: 9 | loss: 0.0691377
	speed: 0.1138s/iter; left time: 6031.9767s
	iters: 700, epoch: 9 | loss: 0.0765528
	speed: 0.1150s/iter; left time: 6086.4702s
	iters: 800, epoch: 9 | loss: 0.0613169
	speed: 0.1157s/iter; left time: 6112.7932s
	iters: 900, epoch: 9 | loss: 0.0732772
	speed: 0.1128s/iter; left time: 5946.8314s
	iters: 1000, epoch: 9 | loss: 0.0607491
	speed: 0.1141s/iter; left time: 6005.3762s
	iters: 1100, epoch: 9 | loss: 0.0597287
	speed: 0.1145s/iter; left time: 6014.2623s
	iters: 1200, epoch: 9 | loss: 0.0944503
	speed: 0.1158s/iter; left time: 6068.9104s
	iters: 1300, epoch: 9 | loss: 0.0612135
	speed: 0.1167s/iter; left time: 6104.9545s
	iters: 1400, epoch: 9 | loss: 0.0633327
	speed: 0.1161s/iter; left time: 6061.6466s
	iters: 1500, epoch: 9 | loss: 0.0837415
	speed: 0.1161s/iter; left time: 6052.5368s
	iters: 1600, epoch: 9 | loss: 0.0839318
	speed: 0.1145s/iter; left time: 5957.2857s
	iters: 1700, epoch: 9 | loss: 0.0879491
	speed: 0.1153s/iter; left time: 5987.8238s
	iters: 1800, epoch: 9 | loss: 0.0665905
	speed: 0.1159s/iter; left time: 6007.1897s
	iters: 1900, epoch: 9 | loss: 0.0713467
	speed: 0.1132s/iter; left time: 5856.2024s
	iters: 2000, epoch: 9 | loss: 0.0669027
	speed: 0.1109s/iter; left time: 5722.6558s
	iters: 2100, epoch: 9 | loss: 0.0749533
	speed: 0.1125s/iter; left time: 5795.3411s
	iters: 2200, epoch: 9 | loss: 0.0823501
	speed: 0.1112s/iter; left time: 5718.2462s
	iters: 2300, epoch: 9 | loss: 0.0919251
	speed: 0.1139s/iter; left time: 5844.6386s
	iters: 2400, epoch: 9 | loss: 0.0902282
	speed: 0.1126s/iter; left time: 5768.5829s
	iters: 2500, epoch: 9 | loss: 0.0695416
	speed: 0.1117s/iter; left time: 5711.8656s
	iters: 2600, epoch: 9 | loss: 0.0872029
	speed: 0.1133s/iter; left time: 5778.4650s
	iters: 2700, epoch: 9 | loss: 0.0668999
	speed: 0.1119s/iter; left time: 5698.7334s
	iters: 2800, epoch: 9 | loss: 0.0708064
	speed: 0.1127s/iter; left time: 5725.9843s
	iters: 2900, epoch: 9 | loss: 0.0776473
	speed: 0.1123s/iter; left time: 5694.7808s
	iters: 3000, epoch: 9 | loss: 0.0897343
	speed: 0.1122s/iter; left time: 5681.0087s
	iters: 3100, epoch: 9 | loss: 0.0689395
	speed: 0.1124s/iter; left time: 5679.9443s
	iters: 3200, epoch: 9 | loss: 0.0872946
	speed: 0.1139s/iter; left time: 5744.6518s
	iters: 3300, epoch: 9 | loss: 0.0869129
	speed: 0.1114s/iter; left time: 5604.8787s
	iters: 3400, epoch: 9 | loss: 0.0875106
	speed: 0.1127s/iter; left time: 5660.6692s
	iters: 3500, epoch: 9 | loss: 0.0698793
	speed: 0.1125s/iter; left time: 5636.6617s
	iters: 3600, epoch: 9 | loss: 0.0638036
	speed: 0.1135s/iter; left time: 5676.5612s
	iters: 3700, epoch: 9 | loss: 0.0692865
	speed: 0.1122s/iter; left time: 5601.1650s
	iters: 3800, epoch: 9 | loss: 0.0771837
	speed: 0.1136s/iter; left time: 5659.3342s
	iters: 3900, epoch: 9 | loss: 0.0842480
	speed: 0.1127s/iter; left time: 5605.2598s
	iters: 4000, epoch: 9 | loss: 0.0725595
	speed: 0.1126s/iter; left time: 5588.1288s
	iters: 4100, epoch: 9 | loss: 0.0908936
	speed: 0.1121s/iter; left time: 5549.9859s
	iters: 4200, epoch: 9 | loss: 0.0893085
	speed: 0.1131s/iter; left time: 5589.3018s
	iters: 4300, epoch: 9 | loss: 0.0930462
	speed: 0.1122s/iter; left time: 5534.2020s
	iters: 4400, epoch: 9 | loss: 0.0681519
	speed: 0.1128s/iter; left time: 5549.7471s
Epoch: 9 cost time: 00h:08m:28.34s
Epoch: 9 | Train Loss: 0.0783692 Vali Loss: 0.0899408 Test Loss: 0.0950079
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 10 | loss: 0.0844053
	speed: 1.5703s/iter; left time: 77023.2284s
	iters: 200, epoch: 10 | loss: 0.1195817
	speed: 0.1156s/iter; left time: 5658.7668s
	iters: 300, epoch: 10 | loss: 0.0776654
	speed: 0.1157s/iter; left time: 5653.6352s
	iters: 400, epoch: 10 | loss: 0.0721945
	speed: 0.1144s/iter; left time: 5577.8280s
	iters: 500, epoch: 10 | loss: 0.0767422
	speed: 0.1146s/iter; left time: 5576.6377s
	iters: 600, epoch: 10 | loss: 0.0819118
	speed: 0.1156s/iter; left time: 5610.0326s
	iters: 700, epoch: 10 | loss: 0.0688704
	speed: 0.1144s/iter; left time: 5540.6791s
	iters: 800, epoch: 10 | loss: 0.1010805
	speed: 0.1162s/iter; left time: 5619.3736s
	iters: 900, epoch: 10 | loss: 0.0890266
	speed: 0.1134s/iter; left time: 5473.4191s
	iters: 1000, epoch: 10 | loss: 0.0743395
	speed: 0.1156s/iter; left time: 5567.6560s
	iters: 1100, epoch: 10 | loss: 0.0623439
	speed: 0.1154s/iter; left time: 5542.6937s
	iters: 1200, epoch: 10 | loss: 0.0886193
	speed: 0.1170s/iter; left time: 5610.6100s
	iters: 1300, epoch: 10 | loss: 0.0903579
	speed: 0.1158s/iter; left time: 5541.5628s
	iters: 1400, epoch: 10 | loss: 0.0970001
	speed: 0.1163s/iter; left time: 5550.9740s
	iters: 1500, epoch: 10 | loss: 0.0763897
	speed: 0.1151s/iter; left time: 5483.7668s
	iters: 1600, epoch: 10 | loss: 0.0659897
	speed: 0.1148s/iter; left time: 5460.3132s
	iters: 1700, epoch: 10 | loss: 0.0725043
	speed: 0.1165s/iter; left time: 5526.4024s
	iters: 1800, epoch: 10 | loss: 0.0614413
	speed: 0.1146s/iter; left time: 5425.1157s
	iters: 1900, epoch: 10 | loss: 0.0763310
	speed: 0.1134s/iter; left time: 5356.3255s
	iters: 2000, epoch: 10 | loss: 0.0819842
	speed: 0.1137s/iter; left time: 5362.4754s
	iters: 2100, epoch: 10 | loss: 0.0654081
	speed: 0.1132s/iter; left time: 5325.6774s
	iters: 2200, epoch: 10 | loss: 0.0653410
	speed: 0.1146s/iter; left time: 5380.6889s
	iters: 2300, epoch: 10 | loss: 0.0690481
	speed: 0.1151s/iter; left time: 5390.4317s
	iters: 2400, epoch: 10 | loss: 0.0936227
	speed: 0.1119s/iter; left time: 5232.1446s
	iters: 2500, epoch: 10 | loss: 0.0709767
	speed: 0.1150s/iter; left time: 5366.5604s
	iters: 2600, epoch: 10 | loss: 0.0593837
	speed: 0.1114s/iter; left time: 5186.2645s
	iters: 2700, epoch: 10 | loss: 0.1029781
	speed: 0.1120s/iter; left time: 5201.3187s
	iters: 2800, epoch: 10 | loss: 0.0660925
	speed: 0.1124s/iter; left time: 5209.6535s
	iters: 2900, epoch: 10 | loss: 0.0810724
	speed: 0.1154s/iter; left time: 5335.9264s
	iters: 3000, epoch: 10 | loss: 0.0861325
	speed: 0.1147s/iter; left time: 5292.0603s
	iters: 3100, epoch: 10 | loss: 0.0749175
	speed: 0.1137s/iter; left time: 5237.6337s
	iters: 3200, epoch: 10 | loss: 0.0772474
	speed: 0.1164s/iter; left time: 5349.7385s
	iters: 3300, epoch: 10 | loss: 0.0663424
	speed: 0.1137s/iter; left time: 5214.7671s
	iters: 3400, epoch: 10 | loss: 0.0681792
	speed: 0.1141s/iter; left time: 5221.7219s
	iters: 3500, epoch: 10 | loss: 0.0826567
	speed: 0.1140s/iter; left time: 5203.0824s
	iters: 3600, epoch: 10 | loss: 0.0750645
	speed: 0.1131s/iter; left time: 5151.3906s
	iters: 3700, epoch: 10 | loss: 0.0935027
	speed: 0.1151s/iter; left time: 5229.2264s
	iters: 3800, epoch: 10 | loss: 0.0815245
	speed: 0.1150s/iter; left time: 5214.8541s
	iters: 3900, epoch: 10 | loss: 0.0724220
	speed: 0.1144s/iter; left time: 5177.2966s
	iters: 4000, epoch: 10 | loss: 0.0900971
	speed: 0.1154s/iter; left time: 5208.8186s
	iters: 4100, epoch: 10 | loss: 0.0711545
	speed: 0.1136s/iter; left time: 5116.8096s
	iters: 4200, epoch: 10 | loss: 0.0712163
	speed: 0.1162s/iter; left time: 5225.1819s
	iters: 4300, epoch: 10 | loss: 0.0879692
	speed: 0.1138s/iter; left time: 5103.8100s
	iters: 4400, epoch: 10 | loss: 0.0614536
	speed: 0.1149s/iter; left time: 5140.8918s
Epoch: 10 cost time: 00h:08m:32.57s
Epoch: 10 | Train Loss: 0.0775587 Vali Loss: 0.0896562 Test Loss: 0.0955003
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 11 | loss: 0.0843296
	speed: 1.5739s/iter; left time: 70164.0240s
	iters: 200, epoch: 11 | loss: 0.0733311
	speed: 0.1145s/iter; left time: 5093.0879s
	iters: 300, epoch: 11 | loss: 0.0601665
	speed: 0.1165s/iter; left time: 5171.7973s
	iters: 400, epoch: 11 | loss: 0.0716488
	speed: 0.1158s/iter; left time: 5126.9430s
	iters: 500, epoch: 11 | loss: 0.0750899
	speed: 0.1165s/iter; left time: 5148.0669s
	iters: 600, epoch: 11 | loss: 0.0896189
	speed: 0.1153s/iter; left time: 5083.1043s
	iters: 700, epoch: 11 | loss: 0.0716856
	speed: 0.1139s/iter; left time: 5009.0067s
	iters: 800, epoch: 11 | loss: 0.0796735
	speed: 0.1153s/iter; left time: 5057.4234s
	iters: 900, epoch: 11 | loss: 0.0532320
	speed: 0.1148s/iter; left time: 5027.0354s
	iters: 1000, epoch: 11 | loss: 0.0739114
	speed: 0.1165s/iter; left time: 5090.5324s
	iters: 1100, epoch: 11 | loss: 0.0947660
	speed: 0.1156s/iter; left time: 5038.4828s
	iters: 1200, epoch: 11 | loss: 0.0835808
	speed: 0.1145s/iter; left time: 4977.6359s
	iters: 1300, epoch: 11 | loss: 0.0754700
	speed: 0.1149s/iter; left time: 4984.0475s
	iters: 1400, epoch: 11 | loss: 0.0658226
	speed: 0.1150s/iter; left time: 4975.6781s
	iters: 1500, epoch: 11 | loss: 0.0543421
	speed: 0.1149s/iter; left time: 4960.4601s
	iters: 1600, epoch: 11 | loss: 0.0710039
	speed: 0.1151s/iter; left time: 4957.1768s
	iters: 1700, epoch: 11 | loss: 0.0833827
	speed: 0.1159s/iter; left time: 4982.1454s
	iters: 1800, epoch: 11 | loss: 0.0674744
	speed: 0.1155s/iter; left time: 4951.2929s
	iters: 1900, epoch: 11 | loss: 0.0692966
	speed: 0.1154s/iter; left time: 4936.1148s
	iters: 2000, epoch: 11 | loss: 0.0941740
	speed: 0.1148s/iter; left time: 4899.7874s
	iters: 2100, epoch: 11 | loss: 0.0860964
	speed: 0.1159s/iter; left time: 4934.5398s
	iters: 2200, epoch: 11 | loss: 0.0810799
	speed: 0.1154s/iter; left time: 4901.1828s
	iters: 2300, epoch: 11 | loss: 0.0745259
	speed: 0.1157s/iter; left time: 4902.2137s
	iters: 2400, epoch: 11 | loss: 0.0968850
	speed: 0.1147s/iter; left time: 4850.8245s
	iters: 2500, epoch: 11 | loss: 0.0774877
	speed: 0.1128s/iter; left time: 4759.7731s
	iters: 2600, epoch: 11 | loss: 0.0719790
	speed: 0.1129s/iter; left time: 4750.8537s
	iters: 2700, epoch: 11 | loss: 0.0613416
	speed: 0.1133s/iter; left time: 4755.9070s
	iters: 2800, epoch: 11 | loss: 0.0705149
	speed: 0.1153s/iter; left time: 4828.2350s
	iters: 2900, epoch: 11 | loss: 0.0600997
	speed: 0.1193s/iter; left time: 4982.8862s
	iters: 3000, epoch: 11 | loss: 0.0838152
	speed: 0.1120s/iter; left time: 4666.8976s
	iters: 3100, epoch: 11 | loss: 0.0801776
	speed: 0.1128s/iter; left time: 4691.7418s
	iters: 3200, epoch: 11 | loss: 0.0818057
	speed: 0.1120s/iter; left time: 4647.3603s
	iters: 3300, epoch: 11 | loss: 0.0967920
	speed: 0.1119s/iter; left time: 4631.3189s
	iters: 3400, epoch: 11 | loss: 0.0851540
	speed: 0.1118s/iter; left time: 4617.2067s
	iters: 3500, epoch: 11 | loss: 0.0771672
	speed: 0.1114s/iter; left time: 4589.0794s
	iters: 3600, epoch: 11 | loss: 0.0722381
	speed: 0.1124s/iter; left time: 4615.8247s
	iters: 3700, epoch: 11 | loss: 0.0777316
	speed: 0.1131s/iter; left time: 4634.9475s
	iters: 3800, epoch: 11 | loss: 0.0811023
	speed: 0.1122s/iter; left time: 4587.1586s
	iters: 3900, epoch: 11 | loss: 0.0592589
	speed: 0.1135s/iter; left time: 4629.6078s
	iters: 4000, epoch: 11 | loss: 0.0921532
	speed: 0.1125s/iter; left time: 4574.9062s
	iters: 4100, epoch: 11 | loss: 0.0703947
	speed: 0.1131s/iter; left time: 4591.6095s
	iters: 4200, epoch: 11 | loss: 0.0643912
	speed: 0.1144s/iter; left time: 4629.1487s
	iters: 4300, epoch: 11 | loss: 0.0791592
	speed: 0.1142s/iter; left time: 4612.0469s
	iters: 4400, epoch: 11 | loss: 0.0683983
	speed: 0.1123s/iter; left time: 4524.4935s
Epoch: 11 cost time: 00h:08m:31.37s
Epoch: 11 | Train Loss: 0.0766384 Vali Loss: 0.0910036 Test Loss: 0.0970744
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 12 | loss: 0.0710792
	speed: 1.5636s/iter; left time: 62721.0444s
	iters: 200, epoch: 12 | loss: 0.0842273
	speed: 0.1133s/iter; left time: 4533.8282s
	iters: 300, epoch: 12 | loss: 0.0629760
	speed: 0.1142s/iter; left time: 4557.5035s
	iters: 400, epoch: 12 | loss: 0.0810391
	speed: 0.1137s/iter; left time: 4525.0781s
	iters: 500, epoch: 12 | loss: 0.1013014
	speed: 0.1144s/iter; left time: 4542.3369s
	iters: 600, epoch: 12 | loss: 0.0584819
	speed: 0.1137s/iter; left time: 4503.4232s
	iters: 700, epoch: 12 | loss: 0.0732251
	speed: 0.1132s/iter; left time: 4471.8834s
	iters: 800, epoch: 12 | loss: 0.0754556
	speed: 0.1120s/iter; left time: 4413.5894s
	iters: 900, epoch: 12 | loss: 0.0640929
	speed: 0.1135s/iter; left time: 4461.7356s
	iters: 1000, epoch: 12 | loss: 0.0760040
	speed: 0.1133s/iter; left time: 4442.3115s
	iters: 1100, epoch: 12 | loss: 0.0927217
	speed: 0.1133s/iter; left time: 4433.2293s
	iters: 1200, epoch: 12 | loss: 0.0876345
	speed: 0.1150s/iter; left time: 4487.2739s
	iters: 1300, epoch: 12 | loss: 0.0746380
	speed: 0.1136s/iter; left time: 4422.2023s
	iters: 1400, epoch: 12 | loss: 0.0757993
	speed: 0.1150s/iter; left time: 4463.8057s
	iters: 1500, epoch: 12 | loss: 0.0810570
	speed: 0.1153s/iter; left time: 4464.1727s
	iters: 1600, epoch: 12 | loss: 0.0619826
	speed: 0.1155s/iter; left time: 4460.3334s
	iters: 1700, epoch: 12 | loss: 0.0746262
	speed: 0.1122s/iter; left time: 4321.5653s
	iters: 1800, epoch: 12 | loss: 0.0823452
	speed: 0.1131s/iter; left time: 4343.0094s
	iters: 1900, epoch: 12 | loss: 0.0711706
	speed: 0.1119s/iter; left time: 4286.5702s
	iters: 2000, epoch: 12 | loss: 0.0654976
	speed: 0.1114s/iter; left time: 4257.2980s
	iters: 2100, epoch: 12 | loss: 0.0801418
	speed: 0.1130s/iter; left time: 4308.3075s
	iters: 2200, epoch: 12 | loss: 0.0796125
	speed: 0.1143s/iter; left time: 4345.9646s
	iters: 2300, epoch: 12 | loss: 0.0880586
	speed: 0.1140s/iter; left time: 4322.5583s
	iters: 2400, epoch: 12 | loss: 0.0664747
	speed: 0.1128s/iter; left time: 4266.0571s
	iters: 2500, epoch: 12 | loss: 0.0685178
	speed: 0.1133s/iter; left time: 4272.3721s
	iters: 2600, epoch: 12 | loss: 0.0550742
	speed: 0.1131s/iter; left time: 4252.6892s
	iters: 2700, epoch: 12 | loss: 0.0827314
	speed: 0.1116s/iter; left time: 4186.3833s
	iters: 2800, epoch: 12 | loss: 0.0665130
	speed: 0.1129s/iter; left time: 4225.7916s
	iters: 2900, epoch: 12 | loss: 0.0725770
	speed: 0.1153s/iter; left time: 4301.2409s
	iters: 3000, epoch: 12 | loss: 0.0761487
	speed: 0.1131s/iter; left time: 4207.9793s
	iters: 3100, epoch: 12 | loss: 0.0791091
	speed: 0.1113s/iter; left time: 4129.1158s
	iters: 3200, epoch: 12 | loss: 0.0671570
	speed: 0.1132s/iter; left time: 4188.6470s
	iters: 3300, epoch: 12 | loss: 0.0749104
	speed: 0.1108s/iter; left time: 4090.0929s
	iters: 3400, epoch: 12 | loss: 0.0909807
	speed: 0.1113s/iter; left time: 4097.7149s
	iters: 3500, epoch: 12 | loss: 0.0923854
	speed: 0.1126s/iter; left time: 4132.9393s
	iters: 3600, epoch: 12 | loss: 0.0831650
	speed: 0.1131s/iter; left time: 4139.3141s
	iters: 3700, epoch: 12 | loss: 0.0813926
	speed: 0.1130s/iter; left time: 4127.1017s
	iters: 3800, epoch: 12 | loss: 0.0719712
	speed: 0.1118s/iter; left time: 4070.7835s
	iters: 3900, epoch: 12 | loss: 0.0697064
	speed: 0.1118s/iter; left time: 4060.5863s
	iters: 4000, epoch: 12 | loss: 0.0884542
	speed: 0.1128s/iter; left time: 4084.2641s
	iters: 4100, epoch: 12 | loss: 0.0673367
	speed: 0.1129s/iter; left time: 4075.9061s
	iters: 4200, epoch: 12 | loss: 0.0795303
	speed: 0.1130s/iter; left time: 4069.6429s
	iters: 4300, epoch: 12 | loss: 0.0724135
	speed: 0.1119s/iter; left time: 4018.1664s
	iters: 4400, epoch: 12 | loss: 0.0837259
	speed: 0.1092s/iter; left time: 3912.5087s
Epoch: 12 cost time: 00h:08m:26.23s
Epoch: 12 | Train Loss: 0.0758073 Vali Loss: 0.0911360 Test Loss: 0.0977819
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 13 | loss: 0.0696547
	speed: 1.5893s/iter; left time: 56649.7380s
	iters: 200, epoch: 13 | loss: 0.0783792
	speed: 0.1172s/iter; left time: 4164.4258s
	iters: 300, epoch: 13 | loss: 0.0612777
	speed: 0.1179s/iter; left time: 4178.9516s
	iters: 400, epoch: 13 | loss: 0.0669738
	speed: 0.1177s/iter; left time: 4158.8186s
	iters: 500, epoch: 13 | loss: 0.0753981
	speed: 0.1177s/iter; left time: 4147.4482s
	iters: 600, epoch: 13 | loss: 0.0703675
	speed: 0.1153s/iter; left time: 4053.7467s
	iters: 700, epoch: 13 | loss: 0.0807081
	speed: 0.1164s/iter; left time: 4077.7579s
	iters: 800, epoch: 13 | loss: 0.0631655
	speed: 0.1182s/iter; left time: 4130.4168s
	iters: 900, epoch: 13 | loss: 0.0665464
	speed: 0.1170s/iter; left time: 4075.9742s
	iters: 1000, epoch: 13 | loss: 0.0889466
	speed: 0.1150s/iter; left time: 3996.6718s
	iters: 1100, epoch: 13 | loss: 0.0937114
	speed: 0.1159s/iter; left time: 4013.9217s
	iters: 1200, epoch: 13 | loss: 0.0855564
	speed: 0.1143s/iter; left time: 3949.4810s
	iters: 1300, epoch: 13 | loss: 0.0802188
	speed: 0.1161s/iter; left time: 3999.4400s
	iters: 1400, epoch: 13 | loss: 0.0752418
	speed: 0.1170s/iter; left time: 4019.6635s
	iters: 1500, epoch: 13 | loss: 0.0920139
	speed: 0.1172s/iter; left time: 4013.8930s
	iters: 1600, epoch: 13 | loss: 0.0802863
	speed: 0.1177s/iter; left time: 4019.6514s
	iters: 1700, epoch: 13 | loss: 0.0784608
	speed: 0.1200s/iter; left time: 4086.0264s
	iters: 1800, epoch: 13 | loss: 0.0880799
	speed: 0.1172s/iter; left time: 3979.4404s
	iters: 1900, epoch: 13 | loss: 0.0902761
	speed: 0.1177s/iter; left time: 3984.6787s
	iters: 2000, epoch: 13 | loss: 0.0855317
	speed: 0.1162s/iter; left time: 3920.8780s
	iters: 2100, epoch: 13 | loss: 0.0778534
	speed: 0.1169s/iter; left time: 3934.1143s
	iters: 2200, epoch: 13 | loss: 0.0732491
	speed: 0.1166s/iter; left time: 3910.2686s
	iters: 2300, epoch: 13 | loss: 0.0718696
	speed: 0.1174s/iter; left time: 3927.0261s
	iters: 2400, epoch: 13 | loss: 0.0643891
	speed: 0.1167s/iter; left time: 3891.0356s
	iters: 2500, epoch: 13 | loss: 0.0634482
	speed: 0.1176s/iter; left time: 3909.0249s
	iters: 2600, epoch: 13 | loss: 0.0696910
	speed: 0.1181s/iter; left time: 3915.0711s
	iters: 2700, epoch: 13 | loss: 0.0817821
	speed: 0.1158s/iter; left time: 3825.6326s
	iters: 2800, epoch: 13 | loss: 0.0640855
	speed: 0.1157s/iter; left time: 3811.4909s
	iters: 2900, epoch: 13 | loss: 0.0694307
	speed: 0.1160s/iter; left time: 3810.3136s
	iters: 3000, epoch: 13 | loss: 0.0864336
	speed: 0.1171s/iter; left time: 3835.8686s
	iters: 3100, epoch: 13 | loss: 0.0733568
	speed: 0.1175s/iter; left time: 3835.4461s
	iters: 3200, epoch: 13 | loss: 0.0625381
	speed: 0.1159s/iter; left time: 3770.5600s
	iters: 3300, epoch: 13 | loss: 0.0875661
	speed: 0.1187s/iter; left time: 3852.2250s
	iters: 3400, epoch: 13 | loss: 0.0675188
	speed: 0.1180s/iter; left time: 3818.2630s
	iters: 3500, epoch: 13 | loss: 0.0647626
	speed: 0.1167s/iter; left time: 3763.5709s
	iters: 3600, epoch: 13 | loss: 0.0939891
	speed: 0.1169s/iter; left time: 3756.8278s
	iters: 3700, epoch: 13 | loss: 0.0905394
	speed: 0.1158s/iter; left time: 3709.2596s
	iters: 3800, epoch: 13 | loss: 0.0685588
	speed: 0.1173s/iter; left time: 3748.1331s
	iters: 3900, epoch: 13 | loss: 0.0648391
	speed: 0.1175s/iter; left time: 3740.8344s
	iters: 4000, epoch: 13 | loss: 0.0833651
	speed: 0.1160s/iter; left time: 3682.8446s
	iters: 4100, epoch: 13 | loss: 0.0707878
	speed: 0.1176s/iter; left time: 3722.4901s
	iters: 4200, epoch: 13 | loss: 0.0837740
	speed: 0.1175s/iter; left time: 3707.5046s
	iters: 4300, epoch: 13 | loss: 0.0526903
	speed: 0.1160s/iter; left time: 3649.0515s
	iters: 4400, epoch: 13 | loss: 0.0681901
	speed: 0.1168s/iter; left time: 3661.2333s
Epoch: 13 cost time: 00h:08m:43.12s
Epoch: 13 | Train Loss: 0.0749393 Vali Loss: 0.0928503 Test Loss: 0.1000453
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.02273400127887726, rmse:0.15077798068523407, mae:0.09537788480520248, rse:0.5325193405151367
success delete checkpoints
Intermediate time for DE and pred_len 24: 02h:24m:39.95s

=== Starting experiments for pred_len: 96 ===

--- Running model for DE, pred_len=96 ---
train 142645
val 30725
test 30725
[2024-11-03 03:36:47,323] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-03 03:36:48,374] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-03 03:36:48,374] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-03 03:36:48,374] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-03 03:36:48,464] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-03 03:36:48,464] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-03 03:36:49,208] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-03 03:36:49,210] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-03 03:36:49,210] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-03 03:36:49,211] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-03 03:36:49,211] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-03 03:36:49,212] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-03 03:36:49,212] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-03 03:36:49,212] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-03 03:36:49,212] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-03 03:36:49,212] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-03 03:36:49,660] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-03 03:36:49,661] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-03 03:36:49,661] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 76.86 GB, percent = 10.2%
[2024-11-03 03:36:49,845] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-03 03:36:49,846] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 03:36:49,846] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 76.8 GB, percent = 10.2%
[2024-11-03 03:36:49,846] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-03 03:36:49,986] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-03 03:36:49,987] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 03:36:49,987] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 76.83 GB, percent = 10.2%
[2024-11-03 03:36:49,988] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-03 03:36:49,988] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-03 03:36:49,988] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-03 03:36:49,988] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-03 03:36:49,989] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-03 03:36:49,989] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-03 03:36:49,989] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-03 03:36:49,989] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-03 03:36:49,989] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f5e609dadd0>
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-03 03:36:49,990] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-03 03:36:49,991] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-03 03:36:49,992] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-03 03:36:49,992] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-03 03:36:49,992] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-03 03:36:49,992] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-03 03:36:49,992] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1857200
	speed: 0.1749s/iter; left time: 15577.3743s
	iters: 200, epoch: 1 | loss: 0.1687170
	speed: 0.1288s/iter; left time: 11457.6404s
	iters: 300, epoch: 1 | loss: 0.1724844
	speed: 0.1281s/iter; left time: 11376.5133s
	iters: 400, epoch: 1 | loss: 0.1656757
	speed: 0.1285s/iter; left time: 11406.8328s
	iters: 500, epoch: 1 | loss: 0.1675965
	speed: 0.1308s/iter; left time: 11595.5959s
	iters: 600, epoch: 1 | loss: 0.1443687
	speed: 0.1283s/iter; left time: 11360.4195s
	iters: 700, epoch: 1 | loss: 0.1422241
	speed: 0.1294s/iter; left time: 11444.9010s
	iters: 800, epoch: 1 | loss: 0.1226619
	speed: 0.1311s/iter; left time: 11583.9627s
	iters: 900, epoch: 1 | loss: 0.1330729
	speed: 0.1320s/iter; left time: 11645.3274s
	iters: 1000, epoch: 1 | loss: 0.1138731
	speed: 0.1279s/iter; left time: 11277.5582s
	iters: 1100, epoch: 1 | loss: 0.1071478
	speed: 0.1286s/iter; left time: 11321.9161s
	iters: 1200, epoch: 1 | loss: 0.1303404
	speed: 0.1277s/iter; left time: 11226.3168s
	iters: 1300, epoch: 1 | loss: 0.1238685
	speed: 0.1295s/iter; left time: 11371.7322s
	iters: 1400, epoch: 1 | loss: 0.1032463
	speed: 0.1281s/iter; left time: 11238.4410s
	iters: 1500, epoch: 1 | loss: 0.1194469
	speed: 0.1278s/iter; left time: 11204.7918s
	iters: 1600, epoch: 1 | loss: 0.1207578
	speed: 0.1295s/iter; left time: 11336.0300s
	iters: 1700, epoch: 1 | loss: 0.1394709
	speed: 0.1296s/iter; left time: 11329.0578s
	iters: 1800, epoch: 1 | loss: 0.1160002
	speed: 0.1284s/iter; left time: 11216.9853s
	iters: 1900, epoch: 1 | loss: 0.1103131
	speed: 0.1283s/iter; left time: 11196.2989s
	iters: 2000, epoch: 1 | loss: 0.1130958
	speed: 0.1258s/iter; left time: 10963.6410s
	iters: 2100, epoch: 1 | loss: 0.1089309
	speed: 0.1278s/iter; left time: 11119.7526s
	iters: 2200, epoch: 1 | loss: 0.1244033
	speed: 0.1307s/iter; left time: 11360.0311s
	iters: 2300, epoch: 1 | loss: 0.1284142
	speed: 0.1305s/iter; left time: 11330.0133s
	iters: 2400, epoch: 1 | loss: 0.1186614
	speed: 0.1310s/iter; left time: 11359.6028s
	iters: 2500, epoch: 1 | loss: 0.1169964
	speed: 0.1281s/iter; left time: 11094.6381s
	iters: 2600, epoch: 1 | loss: 0.1132365
	speed: 0.1305s/iter; left time: 11294.7278s
	iters: 2700, epoch: 1 | loss: 0.1326390
	speed: 0.1299s/iter; left time: 11227.3974s
	iters: 2800, epoch: 1 | loss: 0.1291778
	speed: 0.1271s/iter; left time: 10971.6094s
	iters: 2900, epoch: 1 | loss: 0.1308049
	speed: 0.1309s/iter; left time: 11287.2538s
	iters: 3000, epoch: 1 | loss: 0.1142576
	speed: 0.1295s/iter; left time: 11153.1138s
	iters: 3100, epoch: 1 | loss: 0.0980470
	speed: 0.1265s/iter; left time: 10886.4749s
	iters: 3200, epoch: 1 | loss: 0.1026124
	speed: 0.1282s/iter; left time: 11013.8344s
	iters: 3300, epoch: 1 | loss: 0.1019026
	speed: 0.1289s/iter; left time: 11065.1453s
	iters: 3400, epoch: 1 | loss: 0.1156720
	speed: 0.1297s/iter; left time: 11123.8672s
	iters: 3500, epoch: 1 | loss: 0.1253485
	speed: 0.1298s/iter; left time: 11116.5148s
	iters: 3600, epoch: 1 | loss: 0.1046039
	speed: 0.1302s/iter; left time: 11137.7349s
	iters: 3700, epoch: 1 | loss: 0.1413063
	speed: 0.1318s/iter; left time: 11263.1589s
	iters: 3800, epoch: 1 | loss: 0.1070143
	speed: 0.1292s/iter; left time: 11023.9143s
	iters: 3900, epoch: 1 | loss: 0.1359391
	speed: 0.1286s/iter; left time: 10961.5411s
	iters: 4000, epoch: 1 | loss: 0.1120188
	speed: 0.1300s/iter; left time: 11066.3841s
	iters: 4100, epoch: 1 | loss: 0.1373022
	speed: 0.1296s/iter; left time: 11017.7127s
	iters: 4200, epoch: 1 | loss: 0.1048007
	speed: 0.1290s/iter; left time: 10959.8018s
	iters: 4300, epoch: 1 | loss: 0.1046956
	speed: 0.1312s/iter; left time: 11129.0249s
	iters: 4400, epoch: 1 | loss: 0.1285643
	speed: 0.1288s/iter; left time: 10912.1558s
Epoch: 1 cost time: 00h:09m:37.13s
Epoch: 1 | Train Loss: 0.1245267 Vali Loss: 0.1197564 Test Loss: 0.1277876
Validation loss decreased (inf --> 0.119756).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.1362824
	speed: 1.8577s/iter; left time: 157131.2041s
	iters: 200, epoch: 2 | loss: 0.1034659
	speed: 0.1181s/iter; left time: 9979.1355s
	iters: 300, epoch: 2 | loss: 0.1078680
	speed: 0.1176s/iter; left time: 9924.3209s
	iters: 400, epoch: 2 | loss: 0.1090891
	speed: 0.1186s/iter; left time: 9997.2466s
	iters: 500, epoch: 2 | loss: 0.0995298
	speed: 0.1178s/iter; left time: 9912.9384s
	iters: 600, epoch: 2 | loss: 0.1253273
	speed: 0.1185s/iter; left time: 9967.8242s
	iters: 700, epoch: 2 | loss: 0.1308996
	speed: 0.1184s/iter; left time: 9945.0339s
	iters: 800, epoch: 2 | loss: 0.1199580
	speed: 0.1172s/iter; left time: 9827.3807s
	iters: 900, epoch: 2 | loss: 0.1126412
	speed: 0.1192s/iter; left time: 9990.0129s
	iters: 1000, epoch: 2 | loss: 0.1188750
	speed: 0.1181s/iter; left time: 9884.5111s
	iters: 1100, epoch: 2 | loss: 0.1189725
	speed: 0.1185s/iter; left time: 9905.0032s
	iters: 1200, epoch: 2 | loss: 0.1217855
	speed: 0.1181s/iter; left time: 9861.4114s
	iters: 1300, epoch: 2 | loss: 0.1159035
	speed: 0.1170s/iter; left time: 9752.8977s
	iters: 1400, epoch: 2 | loss: 0.0984060
	speed: 0.1196s/iter; left time: 9960.2194s
	iters: 1500, epoch: 2 | loss: 0.0966178
	speed: 0.1195s/iter; left time: 9938.6067s
	iters: 1600, epoch: 2 | loss: 0.1044325
	speed: 0.1182s/iter; left time: 9816.7587s
	iters: 1700, epoch: 2 | loss: 0.1260282
	speed: 0.1179s/iter; left time: 9784.6770s
	iters: 1800, epoch: 2 | loss: 0.1024257
	speed: 0.1167s/iter; left time: 9671.8226s
	iters: 1900, epoch: 2 | loss: 0.0874435
	speed: 0.1193s/iter; left time: 9873.2542s
	iters: 2000, epoch: 2 | loss: 0.1199540
	speed: 0.1158s/iter; left time: 9576.7465s
	iters: 2100, epoch: 2 | loss: 0.1297425
	speed: 0.1176s/iter; left time: 9711.1511s
	iters: 2200, epoch: 2 | loss: 0.1000140
	speed: 0.1163s/iter; left time: 9589.7147s
	iters: 2300, epoch: 2 | loss: 0.1035635
	speed: 0.1180s/iter; left time: 9723.6046s
	iters: 2400, epoch: 2 | loss: 0.1033574
	speed: 0.1183s/iter; left time: 9735.6153s
	iters: 2500, epoch: 2 | loss: 0.1072888
	speed: 0.1175s/iter; left time: 9658.7560s
	iters: 2600, epoch: 2 | loss: 0.1190963
	speed: 0.1174s/iter; left time: 9636.4540s
	iters: 2700, epoch: 2 | loss: 0.1066877
	speed: 0.1181s/iter; left time: 9686.3330s
	iters: 2800, epoch: 2 | loss: 0.1129730
	speed: 0.1128s/iter; left time: 9237.4035s
	iters: 2900, epoch: 2 | loss: 0.1384397
	speed: 0.1173s/iter; left time: 9596.9501s
	iters: 3000, epoch: 2 | loss: 0.1114533
	speed: 0.1192s/iter; left time: 9732.7134s
	iters: 3100, epoch: 2 | loss: 0.1163946
	speed: 0.1176s/iter; left time: 9597.6541s
	iters: 3200, epoch: 2 | loss: 0.1102893
	speed: 0.1175s/iter; left time: 9575.9749s
	iters: 3300, epoch: 2 | loss: 0.0999768
	speed: 0.1159s/iter; left time: 9432.5478s
	iters: 3400, epoch: 2 | loss: 0.0817148
	speed: 0.1176s/iter; left time: 9559.8251s
	iters: 3500, epoch: 2 | loss: 0.1148444
	speed: 0.1182s/iter; left time: 9593.3125s
	iters: 3600, epoch: 2 | loss: 0.1212692
	speed: 0.1160s/iter; left time: 9403.9745s
	iters: 3700, epoch: 2 | loss: 0.1155532
	speed: 0.1158s/iter; left time: 9379.7291s
	iters: 3800, epoch: 2 | loss: 0.1284737
	speed: 0.1156s/iter; left time: 9351.2049s
	iters: 3900, epoch: 2 | loss: 0.1278360
	speed: 0.1177s/iter; left time: 9505.1319s
	iters: 4000, epoch: 2 | loss: 0.1092012
	speed: 0.1165s/iter; left time: 9396.7610s
	iters: 4100, epoch: 2 | loss: 0.0933397
	speed: 0.1175s/iter; left time: 9467.4941s
	iters: 4200, epoch: 2 | loss: 0.1042761
	speed: 0.1169s/iter; left time: 9407.1105s
	iters: 4300, epoch: 2 | loss: 0.1036103
	speed: 0.1155s/iter; left time: 9285.9710s
	iters: 4400, epoch: 2 | loss: 0.0886638
	speed: 0.1162s/iter; left time: 9326.1864s
Epoch: 2 cost time: 00h:08m:44.44s
Epoch: 2 | Train Loss: 0.1098625 Vali Loss: 0.1185164 Test Loss: 0.1282422
Validation loss decreased (0.119756 --> 0.118516).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.1121855
	speed: 1.6093s/iter; left time: 128949.3745s
	iters: 200, epoch: 3 | loss: 0.0993601
	speed: 0.1182s/iter; left time: 9455.5526s
	iters: 300, epoch: 3 | loss: 0.0954742
	speed: 0.1185s/iter; left time: 9471.8841s
	iters: 400, epoch: 3 | loss: 0.1022189
	speed: 0.1167s/iter; left time: 9318.9562s
	iters: 500, epoch: 3 | loss: 0.1028623
	speed: 0.1179s/iter; left time: 9400.1779s
	iters: 600, epoch: 3 | loss: 0.1073780
	speed: 0.1188s/iter; left time: 9455.7653s
	iters: 700, epoch: 3 | loss: 0.1252172
	speed: 0.1184s/iter; left time: 9415.0870s
	iters: 800, epoch: 3 | loss: 0.0985473
	speed: 0.1175s/iter; left time: 9332.2909s
	iters: 900, epoch: 3 | loss: 0.1068274
	speed: 0.1197s/iter; left time: 9496.0076s
	iters: 1000, epoch: 3 | loss: 0.1010967
	speed: 0.1183s/iter; left time: 9374.0746s
	iters: 1100, epoch: 3 | loss: 0.1209155
	speed: 0.1169s/iter; left time: 9252.1070s
	iters: 1200, epoch: 3 | loss: 0.1471111
	speed: 0.1176s/iter; left time: 9295.8203s
	iters: 1300, epoch: 3 | loss: 0.0935464
	speed: 0.1189s/iter; left time: 9381.0565s
	iters: 1400, epoch: 3 | loss: 0.1135274
	speed: 0.1186s/iter; left time: 9352.5755s
	iters: 1500, epoch: 3 | loss: 0.0995740
	speed: 0.1168s/iter; left time: 9194.3072s
	iters: 1600, epoch: 3 | loss: 0.0949781
	speed: 0.1172s/iter; left time: 9212.4557s
	iters: 1700, epoch: 3 | loss: 0.1161713
	speed: 0.1180s/iter; left time: 9264.1771s
	iters: 1800, epoch: 3 | loss: 0.1313455
	speed: 0.1162s/iter; left time: 9111.7358s
	iters: 1900, epoch: 3 | loss: 0.1055434
	speed: 0.1190s/iter; left time: 9317.3203s
	iters: 2000, epoch: 3 | loss: 0.1189179
	speed: 0.1176s/iter; left time: 9198.3426s
	iters: 2100, epoch: 3 | loss: 0.0911239
	speed: 0.1181s/iter; left time: 9227.0430s
	iters: 2200, epoch: 3 | loss: 0.1390544
	speed: 0.1160s/iter; left time: 9050.4505s
	iters: 2300, epoch: 3 | loss: 0.0976654
	speed: 0.1182s/iter; left time: 9211.7403s
	iters: 2400, epoch: 3 | loss: 0.1079981
	speed: 0.1198s/iter; left time: 9321.4916s
	iters: 2500, epoch: 3 | loss: 0.1111981
	speed: 0.1177s/iter; left time: 9145.8877s
	iters: 2600, epoch: 3 | loss: 0.1110975
	speed: 0.1151s/iter; left time: 8936.2508s
	iters: 2700, epoch: 3 | loss: 0.1392076
	speed: 0.1162s/iter; left time: 9005.2980s
	iters: 2800, epoch: 3 | loss: 0.1271442
	speed: 0.1160s/iter; left time: 8980.1116s
	iters: 2900, epoch: 3 | loss: 0.1141754
	speed: 0.1152s/iter; left time: 8905.0857s
	iters: 3000, epoch: 3 | loss: 0.1144832
	speed: 0.1152s/iter; left time: 8899.4490s
	iters: 3100, epoch: 3 | loss: 0.0868490
	speed: 0.1183s/iter; left time: 9124.7607s
	iters: 3200, epoch: 3 | loss: 0.1013458
	speed: 0.1181s/iter; left time: 9098.0172s
	iters: 3300, epoch: 3 | loss: 0.0867222
	speed: 0.1157s/iter; left time: 8899.0869s
	iters: 3400, epoch: 3 | loss: 0.0821788
	speed: 0.1162s/iter; left time: 8927.4794s
	iters: 3500, epoch: 3 | loss: 0.1050519
	speed: 0.1156s/iter; left time: 8873.3044s
	iters: 3600, epoch: 3 | loss: 0.1225686
	speed: 0.1185s/iter; left time: 9080.4483s
	iters: 3700, epoch: 3 | loss: 0.1083653
	speed: 0.1174s/iter; left time: 8983.1473s
	iters: 3800, epoch: 3 | loss: 0.0852168
	speed: 0.1169s/iter; left time: 8936.1334s
	iters: 3900, epoch: 3 | loss: 0.1460541
	speed: 0.1177s/iter; left time: 8986.7995s
	iters: 4000, epoch: 3 | loss: 0.0892489
	speed: 0.1159s/iter; left time: 8836.6297s
	iters: 4100, epoch: 3 | loss: 0.1043740
	speed: 0.1151s/iter; left time: 8763.5466s
	iters: 4200, epoch: 3 | loss: 0.1233985
	speed: 0.1171s/iter; left time: 8903.0900s
	iters: 4300, epoch: 3 | loss: 0.1201573
	speed: 0.1143s/iter; left time: 8682.1961s
	iters: 4400, epoch: 3 | loss: 0.0884113
	speed: 0.1163s/iter; left time: 8815.0683s
Epoch: 3 cost time: 00h:08m:43.20s
Epoch: 3 | Train Loss: 0.1059200 Vali Loss: 0.1199043 Test Loss: 0.1320190
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.1017862
	speed: 1.5936s/iter; left time: 120585.6451s
	iters: 200, epoch: 4 | loss: 0.1054816
	speed: 0.1159s/iter; left time: 8755.5299s
	iters: 300, epoch: 4 | loss: 0.1008089
	speed: 0.1170s/iter; left time: 8831.5805s
	iters: 400, epoch: 4 | loss: 0.1103006
	speed: 0.1153s/iter; left time: 8688.9430s
	iters: 500, epoch: 4 | loss: 0.1008416
	speed: 0.1145s/iter; left time: 8619.2124s
	iters: 600, epoch: 4 | loss: 0.0872107
	speed: 0.1160s/iter; left time: 8722.1032s
	iters: 700, epoch: 4 | loss: 0.1059361
	speed: 0.1195s/iter; left time: 8968.0293s
	iters: 800, epoch: 4 | loss: 0.1094390
	speed: 0.1181s/iter; left time: 8851.8553s
	iters: 900, epoch: 4 | loss: 0.1180137
	speed: 0.1181s/iter; left time: 8844.5917s
	iters: 1000, epoch: 4 | loss: 0.1055246
	speed: 0.1197s/iter; left time: 8947.2815s
	iters: 1100, epoch: 4 | loss: 0.1000077
	speed: 0.1173s/iter; left time: 8759.0721s
	iters: 1200, epoch: 4 | loss: 0.0994589
	speed: 0.1172s/iter; left time: 8735.9921s
	iters: 1300, epoch: 4 | loss: 0.1067580
	speed: 0.1171s/iter; left time: 8721.4622s
	iters: 1400, epoch: 4 | loss: 0.0998731
	speed: 0.1158s/iter; left time: 8613.1813s
	iters: 1500, epoch: 4 | loss: 0.1033912
	speed: 0.1119s/iter; left time: 8308.1780s
	iters: 1600, epoch: 4 | loss: 0.0937374
	speed: 0.1107s/iter; left time: 8208.9945s
	iters: 1700, epoch: 4 | loss: 0.0970818
	speed: 0.1124s/iter; left time: 8327.5368s
	iters: 1800, epoch: 4 | loss: 0.1050920
	speed: 0.1120s/iter; left time: 8285.6897s
	iters: 1900, epoch: 4 | loss: 0.1291669
	speed: 0.1121s/iter; left time: 8279.0598s
	iters: 2000, epoch: 4 | loss: 0.0771152
	speed: 0.1133s/iter; left time: 8356.6795s
	iters: 2100, epoch: 4 | loss: 0.0940207
	speed: 0.1136s/iter; left time: 8366.1464s
	iters: 2200, epoch: 4 | loss: 0.0884763
	speed: 0.1108s/iter; left time: 8149.7752s
	iters: 2300, epoch: 4 | loss: 0.0902145
	speed: 0.1114s/iter; left time: 8187.5958s
	iters: 2400, epoch: 4 | loss: 0.1145035
	speed: 0.1129s/iter; left time: 8281.5547s
	iters: 2500, epoch: 4 | loss: 0.1050488
	speed: 0.1144s/iter; left time: 8378.4388s
	iters: 2600, epoch: 4 | loss: 0.0954266
	speed: 0.1140s/iter; left time: 8343.4925s
	iters: 2700, epoch: 4 | loss: 0.0995934
	speed: 0.1122s/iter; left time: 8201.3794s
	iters: 2800, epoch: 4 | loss: 0.1045068
	speed: 0.1108s/iter; left time: 8082.1594s
	iters: 2900, epoch: 4 | loss: 0.0896091
	speed: 0.1110s/iter; left time: 8087.5701s
	iters: 3000, epoch: 4 | loss: 0.1133813
	speed: 0.1100s/iter; left time: 8006.8918s
	iters: 3100, epoch: 4 | loss: 0.1004615
	speed: 0.1144s/iter; left time: 8311.1747s
	iters: 3200, epoch: 4 | loss: 0.1033023
	speed: 0.1111s/iter; left time: 8059.7486s
	iters: 3300, epoch: 4 | loss: 0.1076910
	speed: 0.1126s/iter; left time: 8158.9434s
	iters: 3400, epoch: 4 | loss: 0.0782520
	speed: 0.1114s/iter; left time: 8063.5273s
	iters: 3500, epoch: 4 | loss: 0.0946225
	speed: 0.1116s/iter; left time: 8068.2659s
	iters: 3600, epoch: 4 | loss: 0.1047806
	speed: 0.1135s/iter; left time: 8194.1758s
	iters: 3700, epoch: 4 | loss: 0.0901383
	speed: 0.1132s/iter; left time: 8157.3959s
	iters: 3800, epoch: 4 | loss: 0.0860445
	speed: 0.1126s/iter; left time: 8101.8086s
	iters: 3900, epoch: 4 | loss: 0.0885248
	speed: 0.1116s/iter; left time: 8023.3105s
	iters: 4000, epoch: 4 | loss: 0.1189710
	speed: 0.1109s/iter; left time: 7958.3027s
	iters: 4100, epoch: 4 | loss: 0.0907215
	speed: 0.1112s/iter; left time: 7967.6398s
	iters: 4200, epoch: 4 | loss: 0.1236514
	speed: 0.1111s/iter; left time: 7950.3721s
	iters: 4300, epoch: 4 | loss: 0.1064944
	speed: 0.1120s/iter; left time: 8004.7838s
	iters: 4400, epoch: 4 | loss: 0.0968458
	speed: 0.1119s/iter; left time: 7984.6857s
Epoch: 4 cost time: 00h:08m:27.07s
Epoch: 4 | Train Loss: 0.1021763 Vali Loss: 0.1203913 Test Loss: 0.1309304
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0960487
	speed: 1.5315s/iter; left time: 109064.0538s
	iters: 200, epoch: 5 | loss: 0.0997009
	speed: 0.1119s/iter; left time: 7958.2026s
	iters: 300, epoch: 5 | loss: 0.1327493
	speed: 0.1136s/iter; left time: 8067.9951s
	iters: 400, epoch: 5 | loss: 0.1110552
	speed: 0.1112s/iter; left time: 7884.0786s
	iters: 500, epoch: 5 | loss: 0.0997856
	speed: 0.1119s/iter; left time: 7927.2165s
	iters: 600, epoch: 5 | loss: 0.1085910
	speed: 0.1141s/iter; left time: 8068.7005s
	iters: 700, epoch: 5 | loss: 0.0906752
	speed: 0.1124s/iter; left time: 7937.0686s
	iters: 800, epoch: 5 | loss: 0.0881957
	speed: 0.1132s/iter; left time: 7983.2926s
	iters: 900, epoch: 5 | loss: 0.1219619
	speed: 0.1158s/iter; left time: 8154.0782s
	iters: 1000, epoch: 5 | loss: 0.1071277
	speed: 0.1137s/iter; left time: 7997.3908s
	iters: 1100, epoch: 5 | loss: 0.1084025
	speed: 0.1156s/iter; left time: 8117.4470s
	iters: 1200, epoch: 5 | loss: 0.0964981
	speed: 0.1152s/iter; left time: 8076.2562s
	iters: 1300, epoch: 5 | loss: 0.0842596
	speed: 0.1136s/iter; left time: 7952.2301s
	iters: 1400, epoch: 5 | loss: 0.0926249
	speed: 0.1134s/iter; left time: 7929.3991s
	iters: 1500, epoch: 5 | loss: 0.0907346
	speed: 0.1130s/iter; left time: 7888.9182s
	iters: 1600, epoch: 5 | loss: 0.1106110
	speed: 0.1145s/iter; left time: 7981.8965s
	iters: 1700, epoch: 5 | loss: 0.0988417
	speed: 0.1146s/iter; left time: 7978.9288s
	iters: 1800, epoch: 5 | loss: 0.0920804
	speed: 0.1143s/iter; left time: 7944.8159s
	iters: 1900, epoch: 5 | loss: 0.0919630
	speed: 0.1155s/iter; left time: 8015.5406s
	iters: 2000, epoch: 5 | loss: 0.1004907
	speed: 0.1155s/iter; left time: 8005.2387s
	iters: 2100, epoch: 5 | loss: 0.1181042
	speed: 0.1144s/iter; left time: 7914.6309s
	iters: 2200, epoch: 5 | loss: 0.0876759
	speed: 0.1135s/iter; left time: 7840.9967s
	iters: 2300, epoch: 5 | loss: 0.1073024
	speed: 0.1145s/iter; left time: 7900.6209s
	iters: 2400, epoch: 5 | loss: 0.0821408
	speed: 0.1135s/iter; left time: 7818.9375s
	iters: 2500, epoch: 5 | loss: 0.0953626
	speed: 0.1153s/iter; left time: 7932.7214s
	iters: 2600, epoch: 5 | loss: 0.1104295
	speed: 0.1141s/iter; left time: 7843.2803s
	iters: 2700, epoch: 5 | loss: 0.1122409
	speed: 0.1150s/iter; left time: 7888.2967s
	iters: 2800, epoch: 5 | loss: 0.0743636
	speed: 0.1139s/iter; left time: 7800.6765s
	iters: 2900, epoch: 5 | loss: 0.0947080
	speed: 0.1125s/iter; left time: 7699.2210s
	iters: 3000, epoch: 5 | loss: 0.1082617
	speed: 0.1138s/iter; left time: 7774.5218s
	iters: 3100, epoch: 5 | loss: 0.0972924
	speed: 0.1158s/iter; left time: 7897.4971s
	iters: 3200, epoch: 5 | loss: 0.1161426
	speed: 0.1147s/iter; left time: 7810.0341s
	iters: 3300, epoch: 5 | loss: 0.0934898
	speed: 0.1141s/iter; left time: 7761.1548s
	iters: 3400, epoch: 5 | loss: 0.0890894
	speed: 0.1152s/iter; left time: 7820.6728s
	iters: 3500, epoch: 5 | loss: 0.0774576
	speed: 0.1154s/iter; left time: 7827.0229s
	iters: 3600, epoch: 5 | loss: 0.1041150
	speed: 0.1168s/iter; left time: 7905.8663s
	iters: 3700, epoch: 5 | loss: 0.0764355
	speed: 0.1134s/iter; left time: 7667.8056s
	iters: 3800, epoch: 5 | loss: 0.0967276
	speed: 0.1140s/iter; left time: 7694.3834s
	iters: 3900, epoch: 5 | loss: 0.1057422
	speed: 0.1142s/iter; left time: 7697.6299s
	iters: 4000, epoch: 5 | loss: 0.1008978
	speed: 0.1144s/iter; left time: 7701.1571s
	iters: 4100, epoch: 5 | loss: 0.1179423
	speed: 0.1149s/iter; left time: 7720.0400s
	iters: 4200, epoch: 5 | loss: 0.1178501
	speed: 0.1099s/iter; left time: 7376.8081s
	iters: 4300, epoch: 5 | loss: 0.0911569
	speed: 0.1127s/iter; left time: 7551.5480s
	iters: 4400, epoch: 5 | loss: 0.0975429
	speed: 0.1136s/iter; left time: 7599.4730s
Epoch: 5 cost time: 00h:08m:29.17s
Epoch: 5 | Train Loss: 0.0987026 Vali Loss: 0.1216048 Test Loss: 0.1345417
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.1011339
	speed: 1.5360s/iter; left time: 102536.0272s
	iters: 200, epoch: 6 | loss: 0.0883259
	speed: 0.1171s/iter; left time: 7804.2875s
	iters: 300, epoch: 6 | loss: 0.1075289
	speed: 0.1141s/iter; left time: 7594.8624s
	iters: 400, epoch: 6 | loss: 0.0989359
	speed: 0.1163s/iter; left time: 7728.1429s
	iters: 500, epoch: 6 | loss: 0.0862649
	speed: 0.1143s/iter; left time: 7586.5485s
	iters: 600, epoch: 6 | loss: 0.1002253
	speed: 0.1150s/iter; left time: 7621.8291s
	iters: 700, epoch: 6 | loss: 0.1083656
	speed: 0.1156s/iter; left time: 7648.8588s
	iters: 800, epoch: 6 | loss: 0.0928279
	speed: 0.1160s/iter; left time: 7662.9690s
	iters: 900, epoch: 6 | loss: 0.0807987
	speed: 0.1151s/iter; left time: 7593.2415s
	iters: 1000, epoch: 6 | loss: 0.0948872
	speed: 0.1148s/iter; left time: 7563.3529s
	iters: 1100, epoch: 6 | loss: 0.0827360
	speed: 0.1164s/iter; left time: 7655.3289s
	iters: 1200, epoch: 6 | loss: 0.1174165
	speed: 0.1145s/iter; left time: 7518.5707s
	iters: 1300, epoch: 6 | loss: 0.0992087
	speed: 0.1147s/iter; left time: 7520.0064s
	iters: 1400, epoch: 6 | loss: 0.0848289
	speed: 0.1166s/iter; left time: 7629.1240s
	iters: 1500, epoch: 6 | loss: 0.0922957
	speed: 0.1152s/iter; left time: 7528.3518s
	iters: 1600, epoch: 6 | loss: 0.1061229
	speed: 0.1166s/iter; left time: 7606.1201s
	iters: 1700, epoch: 6 | loss: 0.0937682
	speed: 0.1160s/iter; left time: 7561.1492s
	iters: 1800, epoch: 6 | loss: 0.1026462
	speed: 0.1133s/iter; left time: 7371.2713s
	iters: 1900, epoch: 6 | loss: 0.0818370
	speed: 0.1157s/iter; left time: 7513.2731s
	iters: 2000, epoch: 6 | loss: 0.1049387
	speed: 0.1159s/iter; left time: 7519.7116s
	iters: 2100, epoch: 6 | loss: 0.0856962
	speed: 0.1147s/iter; left time: 7428.7141s
	iters: 2200, epoch: 6 | loss: 0.1132535
	speed: 0.1156s/iter; left time: 7473.8852s
	iters: 2300, epoch: 6 | loss: 0.0780297
	speed: 0.1136s/iter; left time: 7334.1105s
	iters: 2400, epoch: 6 | loss: 0.0942708
	speed: 0.1139s/iter; left time: 7340.2087s
	iters: 2500, epoch: 6 | loss: 0.0917941
	speed: 0.1145s/iter; left time: 7366.6319s
	iters: 2600, epoch: 6 | loss: 0.0872721
	speed: 0.1154s/iter; left time: 7417.8992s
	iters: 2700, epoch: 6 | loss: 0.0825186
	speed: 0.1150s/iter; left time: 7377.3480s
	iters: 2800, epoch: 6 | loss: 0.0905587
	speed: 0.1162s/iter; left time: 7444.0894s
	iters: 2900, epoch: 6 | loss: 0.0887696
	speed: 0.1138s/iter; left time: 7277.6593s
	iters: 3000, epoch: 6 | loss: 0.1022261
	speed: 0.1136s/iter; left time: 7256.6604s
	iters: 3100, epoch: 6 | loss: 0.1016905
	speed: 0.1158s/iter; left time: 7382.1130s
	iters: 3200, epoch: 6 | loss: 0.0889834
	speed: 0.1147s/iter; left time: 7304.1106s
	iters: 3300, epoch: 6 | loss: 0.0868730
	speed: 0.1146s/iter; left time: 7285.4443s
	iters: 3400, epoch: 6 | loss: 0.0905508
	speed: 0.1136s/iter; left time: 7207.7473s
	iters: 3500, epoch: 6 | loss: 0.0885148
	speed: 0.1152s/iter; left time: 7298.9761s
	iters: 3600, epoch: 6 | loss: 0.0922447
	speed: 0.1151s/iter; left time: 7280.8357s
	iters: 3700, epoch: 6 | loss: 0.0886584
	speed: 0.1145s/iter; left time: 7228.4714s
	iters: 3800, epoch: 6 | loss: 0.0922629
	speed: 0.1146s/iter; left time: 7225.4081s
	iters: 3900, epoch: 6 | loss: 0.0939470
	speed: 0.1130s/iter; left time: 7113.7216s
	iters: 4000, epoch: 6 | loss: 0.0905015
	speed: 0.1145s/iter; left time: 7194.3585s
	iters: 4100, epoch: 6 | loss: 0.0758674
	speed: 0.1167s/iter; left time: 7321.7619s
	iters: 4200, epoch: 6 | loss: 0.0957208
	speed: 0.1136s/iter; left time: 7117.3013s
	iters: 4300, epoch: 6 | loss: 0.1053216
	speed: 0.1134s/iter; left time: 7095.8461s
	iters: 4400, epoch: 6 | loss: 0.0906008
	speed: 0.1147s/iter; left time: 7163.6950s
Epoch: 6 cost time: 00h:08m:32.77s
Epoch: 6 | Train Loss: 0.0954798 Vali Loss: 0.1227273 Test Loss: 0.1344287
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.1033562
	speed: 1.5449s/iter; left time: 96242.8774s
	iters: 200, epoch: 7 | loss: 0.0896851
	speed: 0.1128s/iter; left time: 7014.1229s
	iters: 300, epoch: 7 | loss: 0.0913225
	speed: 0.1154s/iter; left time: 7166.6403s
	iters: 400, epoch: 7 | loss: 0.0853823
	speed: 0.1144s/iter; left time: 7095.4587s
	iters: 500, epoch: 7 | loss: 0.0857644
	speed: 0.1135s/iter; left time: 7026.9296s
	iters: 600, epoch: 7 | loss: 0.0806916
	speed: 0.1141s/iter; left time: 7053.9584s
	iters: 700, epoch: 7 | loss: 0.1021493
	speed: 0.1169s/iter; left time: 7212.0236s
	iters: 800, epoch: 7 | loss: 0.0732420
	speed: 0.1147s/iter; left time: 7066.7822s
	iters: 900, epoch: 7 | loss: 0.0850529
	speed: 0.1133s/iter; left time: 6969.6772s
	iters: 1000, epoch: 7 | loss: 0.0993610
	speed: 0.1148s/iter; left time: 7050.6510s
	iters: 1100, epoch: 7 | loss: 0.1097831
	speed: 0.1150s/iter; left time: 7049.1661s
	iters: 1200, epoch: 7 | loss: 0.1054772
	speed: 0.1153s/iter; left time: 7054.5038s
	iters: 1300, epoch: 7 | loss: 0.0870716
	speed: 0.1149s/iter; left time: 7022.7027s
	iters: 1400, epoch: 7 | loss: 0.0907186
	speed: 0.1148s/iter; left time: 7003.8567s
	iters: 1500, epoch: 7 | loss: 0.0836305
	speed: 0.1153s/iter; left time: 7019.3724s
	iters: 1600, epoch: 7 | loss: 0.0796124
	speed: 0.1154s/iter; left time: 7013.8048s
	iters: 1700, epoch: 7 | loss: 0.0783959
	speed: 0.1152s/iter; left time: 6994.2668s
	iters: 1800, epoch: 7 | loss: 0.1006658
	speed: 0.1179s/iter; left time: 7146.0686s
	iters: 1900, epoch: 7 | loss: 0.0884392
	speed: 0.1131s/iter; left time: 6844.4431s
	iters: 2000, epoch: 7 | loss: 0.0906714
	speed: 0.1152s/iter; left time: 6955.5823s
	iters: 2100, epoch: 7 | loss: 0.0930545
	speed: 0.1124s/iter; left time: 6774.6318s
	iters: 2200, epoch: 7 | loss: 0.0999339
	speed: 0.1150s/iter; left time: 6923.0216s
	iters: 2300, epoch: 7 | loss: 0.0763448
	speed: 0.1141s/iter; left time: 6858.2620s
	iters: 2400, epoch: 7 | loss: 0.0873501
	speed: 0.1148s/iter; left time: 6890.8708s
	iters: 2500, epoch: 7 | loss: 0.0835626
	speed: 0.1134s/iter; left time: 6789.8264s
	iters: 2600, epoch: 7 | loss: 0.0899396
	speed: 0.1144s/iter; left time: 6843.9955s
	iters: 2700, epoch: 7 | loss: 0.0973071
	speed: 0.1155s/iter; left time: 6893.7186s
	iters: 2800, epoch: 7 | loss: 0.0889941
	speed: 0.1119s/iter; left time: 6669.7559s
	iters: 2900, epoch: 7 | loss: 0.0885513
	speed: 0.1140s/iter; left time: 6784.7081s
	iters: 3000, epoch: 7 | loss: 0.0899405
	speed: 0.1142s/iter; left time: 6782.1823s
	iters: 3100, epoch: 7 | loss: 0.0913069
	speed: 0.1141s/iter; left time: 6766.5576s
	iters: 3200, epoch: 7 | loss: 0.0929181
	speed: 0.1131s/iter; left time: 6693.3679s
	iters: 3300, epoch: 7 | loss: 0.0748527
	speed: 0.1134s/iter; left time: 6702.6012s
	iters: 3400, epoch: 7 | loss: 0.0883430
	speed: 0.1127s/iter; left time: 6649.7692s
	iters: 3500, epoch: 7 | loss: 0.0995779
	speed: 0.1146s/iter; left time: 6752.0857s
	iters: 3600, epoch: 7 | loss: 0.0879578
	speed: 0.1146s/iter; left time: 6737.0533s
	iters: 3700, epoch: 7 | loss: 0.0936343
	speed: 0.1164s/iter; left time: 6831.2676s
	iters: 3800, epoch: 7 | loss: 0.0912004
	speed: 0.1137s/iter; left time: 6662.9285s
	iters: 3900, epoch: 7 | loss: 0.0808091
	speed: 0.1143s/iter; left time: 6686.6893s
	iters: 4000, epoch: 7 | loss: 0.1068037
	speed: 0.1160s/iter; left time: 6773.0787s
	iters: 4100, epoch: 7 | loss: 0.0853559
	speed: 0.1127s/iter; left time: 6573.1499s
	iters: 4200, epoch: 7 | loss: 0.1038158
	speed: 0.1145s/iter; left time: 6666.0709s
	iters: 4300, epoch: 7 | loss: 0.1103765
	speed: 0.1153s/iter; left time: 6698.0690s
	iters: 4400, epoch: 7 | loss: 0.0968011
	speed: 0.1133s/iter; left time: 6573.2121s
Epoch: 7 cost time: 00h:08m:30.89s
Epoch: 7 | Train Loss: 0.0925967 Vali Loss: 0.1245577 Test Loss: 0.1345884
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.03578183427453041, rmse:0.18916086852550507, mae:0.12824216485023499, rse:0.6698496341705322
success delete checkpoints
Intermediate time for DE and pred_len 96: 01h:19m:09.94s

=== Starting experiments for pred_len: 168 ===

--- Running model for DE, pred_len=168 ---
train 142285
val 30365
test 30365
[2024-11-03 04:55:56,825] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-03 04:55:57,946] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-03 04:55:57,946] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-03 04:55:57,946] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-03 04:55:58,038] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-03 04:55:58,038] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-03 04:55:58,773] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-03 04:55:58,774] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-03 04:55:58,774] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-03 04:55:58,775] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-03 04:55:58,775] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-03 04:55:58,775] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-03 04:55:58,775] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-03 04:55:58,775] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-03 04:55:58,775] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-03 04:55:58,775] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-03 04:55:59,162] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-03 04:55:59,163] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-03 04:55:59,194] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 88.96 GB, percent = 11.8%
[2024-11-03 04:55:59,359] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-03 04:55:59,360] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.74 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-03 04:55:59,360] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 88.97 GB, percent = 11.8%
[2024-11-03 04:55:59,360] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-03 04:55:59,504] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-03 04:55:59,505] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-03 04:55:59,505] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 89.03 GB, percent = 11.8%
[2024-11-03 04:55:59,506] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-03 04:55:59,506] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-03 04:55:59,506] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-03 04:55:59,506] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-03 04:55:59,507] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-03 04:55:59,507] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-03 04:55:59,507] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-03 04:55:59,507] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-03 04:55:59,507] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-03 04:55:59,507] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-03 04:55:59,507] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f01f9fd6f50>
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-03 04:55:59,508] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-03 04:55:59,509] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-03 04:55:59,510] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-03 04:55:59,510] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-03 04:55:59,510] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-03 04:55:59,510] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1492427
	speed: 0.1689s/iter; left time: 14998.9946s
	iters: 200, epoch: 1 | loss: 0.1605359
	speed: 0.1261s/iter; left time: 11190.3225s
	iters: 300, epoch: 1 | loss: 0.1671229
	speed: 0.1253s/iter; left time: 11106.0189s
	iters: 400, epoch: 1 | loss: 0.1654047
	speed: 0.1255s/iter; left time: 11113.6227s
	iters: 500, epoch: 1 | loss: 0.1528231
	speed: 0.1259s/iter; left time: 11130.4096s
	iters: 600, epoch: 1 | loss: 0.1641308
	speed: 0.1259s/iter; left time: 11120.4534s
	iters: 700, epoch: 1 | loss: 0.1460070
	speed: 0.1265s/iter; left time: 11163.3958s
	iters: 800, epoch: 1 | loss: 0.1177307
	speed: 0.1276s/iter; left time: 11242.2914s
	iters: 900, epoch: 1 | loss: 0.1349947
	speed: 0.1269s/iter; left time: 11173.5874s
	iters: 1000, epoch: 1 | loss: 0.1090521
	speed: 0.1261s/iter; left time: 11086.5921s
	iters: 1100, epoch: 1 | loss: 0.1334336
	speed: 0.1265s/iter; left time: 11109.3633s
	iters: 1200, epoch: 1 | loss: 0.1300411
	speed: 0.1276s/iter; left time: 11197.1827s
	iters: 1300, epoch: 1 | loss: 0.1205211
	speed: 0.1266s/iter; left time: 11093.1295s
	iters: 1400, epoch: 1 | loss: 0.1304281
	speed: 0.1244s/iter; left time: 10886.0260s
	iters: 1500, epoch: 1 | loss: 0.1271410
	speed: 0.1264s/iter; left time: 11049.2675s
	iters: 1600, epoch: 1 | loss: 0.1058479
	speed: 0.1275s/iter; left time: 11129.7255s
	iters: 1700, epoch: 1 | loss: 0.1209870
	speed: 0.1265s/iter; left time: 11029.6078s
	iters: 1800, epoch: 1 | loss: 0.1023959
	speed: 0.1272s/iter; left time: 11078.7808s
	iters: 1900, epoch: 1 | loss: 0.1413429
	speed: 0.1274s/iter; left time: 11089.8278s
	iters: 2000, epoch: 1 | loss: 0.1427599
	speed: 0.1268s/iter; left time: 11019.0196s
	iters: 2100, epoch: 1 | loss: 0.1329999
	speed: 0.1256s/iter; left time: 10905.1808s
	iters: 2200, epoch: 1 | loss: 0.1120558
	speed: 0.1267s/iter; left time: 10986.1723s
	iters: 2300, epoch: 1 | loss: 0.0989436
	speed: 0.1277s/iter; left time: 11060.9135s
	iters: 2400, epoch: 1 | loss: 0.1160462
	speed: 0.1281s/iter; left time: 11079.1538s
	iters: 2500, epoch: 1 | loss: 0.1234167
	speed: 0.1267s/iter; left time: 10953.3932s
	iters: 2600, epoch: 1 | loss: 0.1299602
	speed: 0.1275s/iter; left time: 11009.6709s
	iters: 2700, epoch: 1 | loss: 0.1306166
	speed: 0.1254s/iter; left time: 10812.0762s
	iters: 2800, epoch: 1 | loss: 0.1211876
	speed: 0.1246s/iter; left time: 10732.5673s
	iters: 2900, epoch: 1 | loss: 0.1157711
	speed: 0.1257s/iter; left time: 10811.2061s
	iters: 3000, epoch: 1 | loss: 0.0999164
	speed: 0.1260s/iter; left time: 10828.2032s
	iters: 3100, epoch: 1 | loss: 0.1516199
	speed: 0.1257s/iter; left time: 10790.8558s
	iters: 3200, epoch: 1 | loss: 0.1097987
	speed: 0.1227s/iter; left time: 10516.8003s
	iters: 3300, epoch: 1 | loss: 0.1195762
	speed: 0.1243s/iter; left time: 10638.8691s
	iters: 3400, epoch: 1 | loss: 0.1289778
	speed: 0.1240s/iter; left time: 10602.2915s
	iters: 3500, epoch: 1 | loss: 0.1021916
	speed: 0.1258s/iter; left time: 10744.1492s
	iters: 3600, epoch: 1 | loss: 0.1183287
	speed: 0.1243s/iter; left time: 10606.4077s
	iters: 3700, epoch: 1 | loss: 0.1355938
	speed: 0.1235s/iter; left time: 10522.3467s
	iters: 3800, epoch: 1 | loss: 0.1252127
	speed: 0.1223s/iter; left time: 10407.7603s
	iters: 3900, epoch: 1 | loss: 0.1068365
	speed: 0.1246s/iter; left time: 10597.5062s
	iters: 4000, epoch: 1 | loss: 0.1084060
	speed: 0.1245s/iter; left time: 10571.2230s
	iters: 4100, epoch: 1 | loss: 0.1262050
	speed: 0.1235s/iter; left time: 10477.3395s
	iters: 4200, epoch: 1 | loss: 0.1099667
	speed: 0.1241s/iter; left time: 10516.0039s
	iters: 4300, epoch: 1 | loss: 0.1208501
	speed: 0.1237s/iter; left time: 10468.0181s
	iters: 4400, epoch: 1 | loss: 0.1325888
	speed: 0.1255s/iter; left time: 10609.7889s
Epoch: 1 cost time: 00h:09m:20.32s
Epoch: 1 | Train Loss: 0.1270849 Vali Loss: 0.1233267 Test Loss: 0.1336193
Validation loss decreased (inf --> 0.123327).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.1183373
	speed: 1.8223s/iter; left time: 153754.1186s
	iters: 200, epoch: 2 | loss: 0.1098894
	speed: 0.1182s/iter; left time: 9964.4478s
	iters: 300, epoch: 2 | loss: 0.1131674
	speed: 0.1166s/iter; left time: 9818.2258s
	iters: 400, epoch: 2 | loss: 0.1160400
	speed: 0.1172s/iter; left time: 9850.7146s
	iters: 500, epoch: 2 | loss: 0.0886714
	speed: 0.1199s/iter; left time: 10065.0167s
	iters: 600, epoch: 2 | loss: 0.1193221
	speed: 0.1171s/iter; left time: 9825.4766s
	iters: 700, epoch: 2 | loss: 0.1303138
	speed: 0.1174s/iter; left time: 9832.2253s
	iters: 800, epoch: 2 | loss: 0.1092902
	speed: 0.1191s/iter; left time: 9966.0618s
	iters: 900, epoch: 2 | loss: 0.0996466
	speed: 0.1227s/iter; left time: 10250.5498s
	iters: 1000, epoch: 2 | loss: 0.1157148
	speed: 0.1179s/iter; left time: 9845.2584s
	iters: 1100, epoch: 2 | loss: 0.1112141
	speed: 0.1194s/iter; left time: 9953.4943s
	iters: 1200, epoch: 2 | loss: 0.1180607
	speed: 0.1182s/iter; left time: 9846.0720s
	iters: 1300, epoch: 2 | loss: 0.0878751
	speed: 0.1193s/iter; left time: 9920.3713s
	iters: 1400, epoch: 2 | loss: 0.1204318
	speed: 0.1198s/iter; left time: 9951.3580s
	iters: 1500, epoch: 2 | loss: 0.1055659
	speed: 0.1207s/iter; left time: 10015.5060s
	iters: 1600, epoch: 2 | loss: 0.1180415
	speed: 0.1220s/iter; left time: 10108.0111s
	iters: 1700, epoch: 2 | loss: 0.1256569
	speed: 0.1165s/iter; left time: 9646.1022s
	iters: 1800, epoch: 2 | loss: 0.1117147
	speed: 0.1159s/iter; left time: 9583.7666s
	iters: 1900, epoch: 2 | loss: 0.1046314
	speed: 0.1190s/iter; left time: 9824.2144s
	iters: 2000, epoch: 2 | loss: 0.1071824
	speed: 0.1218s/iter; left time: 10045.4236s
	iters: 2100, epoch: 2 | loss: 0.1128184
	speed: 0.1198s/iter; left time: 9872.1925s
	iters: 2200, epoch: 2 | loss: 0.1227209
	speed: 0.1191s/iter; left time: 9795.1126s
	iters: 2300, epoch: 2 | loss: 0.1197821
	speed: 0.1197s/iter; left time: 9834.7361s
	iters: 2400, epoch: 2 | loss: 0.1249823
	speed: 0.1185s/iter; left time: 9729.3528s
	iters: 2500, epoch: 2 | loss: 0.1261758
	speed: 0.1177s/iter; left time: 9645.1390s
	iters: 2600, epoch: 2 | loss: 0.1112454
	speed: 0.1169s/iter; left time: 9568.3370s
	iters: 2700, epoch: 2 | loss: 0.1138095
	speed: 0.1158s/iter; left time: 9466.3586s
	iters: 2800, epoch: 2 | loss: 0.0994604
	speed: 0.1175s/iter; left time: 9597.1147s
	iters: 2900, epoch: 2 | loss: 0.1096554
	speed: 0.1142s/iter; left time: 9316.7782s
	iters: 3000, epoch: 2 | loss: 0.1068463
	speed: 0.1170s/iter; left time: 9529.2329s
	iters: 3100, epoch: 2 | loss: 0.1206979
	speed: 0.1152s/iter; left time: 9372.1133s
	iters: 3200, epoch: 2 | loss: 0.1085434
	speed: 0.1208s/iter; left time: 9814.7812s
	iters: 3300, epoch: 2 | loss: 0.1045549
	speed: 0.1196s/iter; left time: 9709.0210s
	iters: 3400, epoch: 2 | loss: 0.1207838
	speed: 0.1189s/iter; left time: 9640.1564s
	iters: 3500, epoch: 2 | loss: 0.1154747
	speed: 0.1164s/iter; left time: 9424.9487s
	iters: 3600, epoch: 2 | loss: 0.1074588
	speed: 0.1167s/iter; left time: 9435.2399s
	iters: 3700, epoch: 2 | loss: 0.1014723
	speed: 0.1171s/iter; left time: 9457.4684s
	iters: 3800, epoch: 2 | loss: 0.0964471
	speed: 0.1169s/iter; left time: 9432.4725s
	iters: 3900, epoch: 2 | loss: 0.1228269
	speed: 0.1173s/iter; left time: 9447.5816s
	iters: 4000, epoch: 2 | loss: 0.1099236
	speed: 0.1169s/iter; left time: 9405.8898s
	iters: 4100, epoch: 2 | loss: 0.1171050
	speed: 0.1216s/iter; left time: 9775.9550s
	iters: 4200, epoch: 2 | loss: 0.1104717
	speed: 0.1183s/iter; left time: 9499.1964s
	iters: 4300, epoch: 2 | loss: 0.1126500
	speed: 0.1213s/iter; left time: 9726.5423s
	iters: 4400, epoch: 2 | loss: 0.1323302
	speed: 0.1198s/iter; left time: 9595.5465s
Epoch: 2 cost time: 00h:08m:47.56s
Epoch: 2 | Train Loss: 0.1139773 Vali Loss: 0.1234052 Test Loss: 0.1342462
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.1082153
	speed: 1.5796s/iter; left time: 126255.4090s
	iters: 200, epoch: 3 | loss: 0.1202841
	speed: 0.1189s/iter; left time: 9493.6879s
	iters: 300, epoch: 3 | loss: 0.0996917
	speed: 0.1184s/iter; left time: 9435.9582s
	iters: 400, epoch: 3 | loss: 0.1064174
	speed: 0.1157s/iter; left time: 9214.8919s
	iters: 500, epoch: 3 | loss: 0.1139071
	speed: 0.1180s/iter; left time: 9386.0109s
	iters: 600, epoch: 3 | loss: 0.1215968
	speed: 0.1142s/iter; left time: 9071.2138s
	iters: 700, epoch: 3 | loss: 0.1096018
	speed: 0.1197s/iter; left time: 9495.2993s
	iters: 800, epoch: 3 | loss: 0.1310975
	speed: 0.1203s/iter; left time: 9530.2566s
	iters: 900, epoch: 3 | loss: 0.1056969
	speed: 0.1183s/iter; left time: 9362.9065s
	iters: 1000, epoch: 3 | loss: 0.1081555
	speed: 0.1158s/iter; left time: 9150.0619s
	iters: 1100, epoch: 3 | loss: 0.0982659
	speed: 0.1183s/iter; left time: 9336.1627s
	iters: 1200, epoch: 3 | loss: 0.1056586
	speed: 0.1197s/iter; left time: 9436.5511s
	iters: 1300, epoch: 3 | loss: 0.1162706
	speed: 0.1196s/iter; left time: 9419.4681s
	iters: 1400, epoch: 3 | loss: 0.1264145
	speed: 0.1210s/iter; left time: 9512.3302s
	iters: 1500, epoch: 3 | loss: 0.1110645
	speed: 0.1198s/iter; left time: 9411.0207s
	iters: 1600, epoch: 3 | loss: 0.1157964
	speed: 0.1202s/iter; left time: 9428.6409s
	iters: 1700, epoch: 3 | loss: 0.1245955
	speed: 0.1179s/iter; left time: 9236.0999s
	iters: 1800, epoch: 3 | loss: 0.1219978
	speed: 0.1211s/iter; left time: 9474.4907s
	iters: 1900, epoch: 3 | loss: 0.1215639
	speed: 0.1194s/iter; left time: 9329.4055s
	iters: 2000, epoch: 3 | loss: 0.1222039
	speed: 0.1194s/iter; left time: 9318.2211s
	iters: 2100, epoch: 3 | loss: 0.0978573
	speed: 0.1180s/iter; left time: 9193.5410s
	iters: 2200, epoch: 3 | loss: 0.1149430
	speed: 0.1199s/iter; left time: 9330.3611s
	iters: 2300, epoch: 3 | loss: 0.1145440
	speed: 0.1201s/iter; left time: 9334.5904s
	iters: 2400, epoch: 3 | loss: 0.0993142
	speed: 0.1208s/iter; left time: 9376.5978s
	iters: 2500, epoch: 3 | loss: 0.0932033
	speed: 0.1171s/iter; left time: 9076.9066s
	iters: 2600, epoch: 3 | loss: 0.1083821
	speed: 0.1178s/iter; left time: 9120.5453s
	iters: 2700, epoch: 3 | loss: 0.1158013
	speed: 0.1144s/iter; left time: 8849.0927s
	iters: 2800, epoch: 3 | loss: 0.1378757
	speed: 0.1162s/iter; left time: 8974.1123s
	iters: 2900, epoch: 3 | loss: 0.0924771
	speed: 0.1162s/iter; left time: 8961.4239s
	iters: 3000, epoch: 3 | loss: 0.1077057
	speed: 0.1180s/iter; left time: 9090.4405s
	iters: 3100, epoch: 3 | loss: 0.1156989
	speed: 0.1167s/iter; left time: 8979.6128s
	iters: 3200, epoch: 3 | loss: 0.1000350
	speed: 0.1160s/iter; left time: 8909.7129s
	iters: 3300, epoch: 3 | loss: 0.1146565
	speed: 0.1172s/iter; left time: 8990.0227s
	iters: 3400, epoch: 3 | loss: 0.1231436
	speed: 0.1170s/iter; left time: 8968.6194s
	iters: 3500, epoch: 3 | loss: 0.1224817
	speed: 0.1151s/iter; left time: 8805.5514s
	iters: 3600, epoch: 3 | loss: 0.1114092
	speed: 0.1154s/iter; left time: 8821.8669s
	iters: 3700, epoch: 3 | loss: 0.1154894
	speed: 0.1148s/iter; left time: 8760.2005s
	iters: 3800, epoch: 3 | loss: 0.0983998
	speed: 0.1184s/iter; left time: 9027.7861s
	iters: 3900, epoch: 3 | loss: 0.1058075
	speed: 0.1176s/iter; left time: 8949.7973s
	iters: 4000, epoch: 3 | loss: 0.1094842
	speed: 0.1186s/iter; left time: 9016.7895s
	iters: 4100, epoch: 3 | loss: 0.1029801
	speed: 0.1215s/iter; left time: 9222.0609s
	iters: 4200, epoch: 3 | loss: 0.1099910
	speed: 0.1177s/iter; left time: 8921.4090s
	iters: 4300, epoch: 3 | loss: 0.1054428
	speed: 0.1200s/iter; left time: 9088.1881s
	iters: 4400, epoch: 3 | loss: 0.0913317
	speed: 0.1180s/iter; left time: 8925.4389s
Epoch: 3 cost time: 00h:08m:45.78s
Epoch: 3 | Train Loss: 0.1093807 Vali Loss: 0.1236754 Test Loss: 0.1367024
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0959466
	speed: 1.5738s/iter; left time: 118798.5643s
	iters: 200, epoch: 4 | loss: 0.0858854
	speed: 0.1189s/iter; left time: 8961.9629s
	iters: 300, epoch: 4 | loss: 0.0893636
	speed: 0.1198s/iter; left time: 9019.7581s
	iters: 400, epoch: 4 | loss: 0.1088450
	speed: 0.1180s/iter; left time: 8870.8322s
	iters: 500, epoch: 4 | loss: 0.1087373
	speed: 0.1165s/iter; left time: 8747.7988s
	iters: 600, epoch: 4 | loss: 0.1005550
	speed: 0.1151s/iter; left time: 8630.8889s
	iters: 700, epoch: 4 | loss: 0.0969683
	speed: 0.1181s/iter; left time: 8846.1387s
	iters: 800, epoch: 4 | loss: 0.1045174
	speed: 0.1171s/iter; left time: 8754.9369s
	iters: 900, epoch: 4 | loss: 0.1086594
	speed: 0.1166s/iter; left time: 8704.5463s
	iters: 1000, epoch: 4 | loss: 0.1303164
	speed: 0.1176s/iter; left time: 8774.3390s
	iters: 1100, epoch: 4 | loss: 0.1121879
	speed: 0.1182s/iter; left time: 8802.4399s
	iters: 1200, epoch: 4 | loss: 0.1189122
	speed: 0.1178s/iter; left time: 8761.6614s
	iters: 1300, epoch: 4 | loss: 0.1055549
	speed: 0.1178s/iter; left time: 8754.0308s
	iters: 1400, epoch: 4 | loss: 0.1178071
	speed: 0.1213s/iter; left time: 8998.8108s
	iters: 1500, epoch: 4 | loss: 0.1012621
	speed: 0.1200s/iter; left time: 8890.9761s
	iters: 1600, epoch: 4 | loss: 0.1049342
	speed: 0.1199s/iter; left time: 8871.7970s
	iters: 1700, epoch: 4 | loss: 0.1118138
	speed: 0.1209s/iter; left time: 8934.2080s
	iters: 1800, epoch: 4 | loss: 0.1249317
	speed: 0.1209s/iter; left time: 8916.8846s
	iters: 1900, epoch: 4 | loss: 0.1314284
	speed: 0.1186s/iter; left time: 8740.8187s
	iters: 2000, epoch: 4 | loss: 0.1265800
	speed: 0.1188s/iter; left time: 8738.2363s
	iters: 2100, epoch: 4 | loss: 0.1018833
	speed: 0.1207s/iter; left time: 8866.4914s
	iters: 2200, epoch: 4 | loss: 0.1211214
	speed: 0.1200s/iter; left time: 8803.3129s
	iters: 2300, epoch: 4 | loss: 0.0848068
	speed: 0.1199s/iter; left time: 8789.0981s
	iters: 2400, epoch: 4 | loss: 0.1038890
	speed: 0.1198s/iter; left time: 8769.5086s
	iters: 2500, epoch: 4 | loss: 0.1123954
	speed: 0.1190s/iter; left time: 8694.3077s
	iters: 2600, epoch: 4 | loss: 0.0989040
	speed: 0.1209s/iter; left time: 8822.2843s
	iters: 2700, epoch: 4 | loss: 0.1005402
	speed: 0.1177s/iter; left time: 8575.7761s
	iters: 2800, epoch: 4 | loss: 0.1054526
	speed: 0.1200s/iter; left time: 8734.2448s
	iters: 2900, epoch: 4 | loss: 0.1114677
	speed: 0.1160s/iter; left time: 8431.7920s
	iters: 3000, epoch: 4 | loss: 0.1075196
	speed: 0.1189s/iter; left time: 8628.7340s
	iters: 3100, epoch: 4 | loss: 0.0856683
	speed: 0.1195s/iter; left time: 8658.9518s
	iters: 3200, epoch: 4 | loss: 0.1058800
	speed: 0.1180s/iter; left time: 8543.6849s
	iters: 3300, epoch: 4 | loss: 0.1083319
	speed: 0.1208s/iter; left time: 8732.2973s
	iters: 3400, epoch: 4 | loss: 0.0981609
	speed: 0.1202s/iter; left time: 8678.0036s
	iters: 3500, epoch: 4 | loss: 0.0921983
	speed: 0.1207s/iter; left time: 8697.5703s
	iters: 3600, epoch: 4 | loss: 0.1049358
	speed: 0.1205s/iter; left time: 8675.4825s
	iters: 3700, epoch: 4 | loss: 0.0929390
	speed: 0.1195s/iter; left time: 8590.2117s
	iters: 3800, epoch: 4 | loss: 0.0982588
	speed: 0.1194s/iter; left time: 8569.5723s
	iters: 3900, epoch: 4 | loss: 0.0918985
	speed: 0.1207s/iter; left time: 8649.6845s
	iters: 4000, epoch: 4 | loss: 0.1195650
	speed: 0.1191s/iter; left time: 8526.0042s
	iters: 4100, epoch: 4 | loss: 0.1090801
	speed: 0.1204s/iter; left time: 8606.8944s
	iters: 4200, epoch: 4 | loss: 0.1110307
	speed: 0.1192s/iter; left time: 8505.5317s
	iters: 4300, epoch: 4 | loss: 0.1110436
	speed: 0.1168s/iter; left time: 8327.9308s
	iters: 4400, epoch: 4 | loss: 0.1014118
	speed: 0.1167s/iter; left time: 8308.2562s
Epoch: 4 cost time: 00h:08m:50.08s
Epoch: 4 | Train Loss: 0.1046495 Vali Loss: 0.1247817 Test Loss: 0.1472365
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.1008341
	speed: 1.5943s/iter; left time: 113251.2470s
	iters: 200, epoch: 5 | loss: 0.1144764
	speed: 0.1212s/iter; left time: 8596.8570s
	iters: 300, epoch: 5 | loss: 0.1179324
	speed: 0.1224s/iter; left time: 8667.5363s
	iters: 400, epoch: 5 | loss: 0.1061344
	speed: 0.1203s/iter; left time: 8507.9813s
	iters: 500, epoch: 5 | loss: 0.0869319
	speed: 0.1168s/iter; left time: 8251.2865s
	iters: 600, epoch: 5 | loss: 0.0929676
	speed: 0.1206s/iter; left time: 8505.0312s
	iters: 700, epoch: 5 | loss: 0.1068786
	speed: 0.1206s/iter; left time: 8494.8491s
	iters: 800, epoch: 5 | loss: 0.0935982
	speed: 0.1185s/iter; left time: 8337.9691s
	iters: 900, epoch: 5 | loss: 0.1054375
	speed: 0.1175s/iter; left time: 8254.9225s
	iters: 1000, epoch: 5 | loss: 0.1086309
	speed: 0.1202s/iter; left time: 8432.1821s
	iters: 1100, epoch: 5 | loss: 0.1122420
	speed: 0.1192s/iter; left time: 8346.6720s
	iters: 1200, epoch: 5 | loss: 0.1004656
	speed: 0.1199s/iter; left time: 8382.4266s
	iters: 1300, epoch: 5 | loss: 0.0959615
	speed: 0.1190s/iter; left time: 8312.2799s
	iters: 1400, epoch: 5 | loss: 0.1126448
	speed: 0.1158s/iter; left time: 8076.4031s
	iters: 1500, epoch: 5 | loss: 0.0902287
	speed: 0.1192s/iter; left time: 8298.4404s
	iters: 1600, epoch: 5 | loss: 0.0997650
	speed: 0.1182s/iter; left time: 8220.6378s
	iters: 1700, epoch: 5 | loss: 0.1175994
	speed: 0.1196s/iter; left time: 8304.8478s
	iters: 1800, epoch: 5 | loss: 0.1059145
	speed: 0.1186s/iter; left time: 8226.3011s
	iters: 1900, epoch: 5 | loss: 0.0982435
	speed: 0.1187s/iter; left time: 8218.5163s
	iters: 2000, epoch: 5 | loss: 0.1148793
	speed: 0.1204s/iter; left time: 8326.4242s
	iters: 2100, epoch: 5 | loss: 0.1237828
	speed: 0.1166s/iter; left time: 8049.6795s
	iters: 2200, epoch: 5 | loss: 0.0931523
	speed: 0.1141s/iter; left time: 7862.8554s
	iters: 2300, epoch: 5 | loss: 0.0861305
	speed: 0.1160s/iter; left time: 7987.8383s
	iters: 2400, epoch: 5 | loss: 0.0990851
	speed: 0.1203s/iter; left time: 8266.9898s
	iters: 2500, epoch: 5 | loss: 0.0847341
	speed: 0.1185s/iter; left time: 8131.6616s
	iters: 2600, epoch: 5 | loss: 0.1076903
	speed: 0.1178s/iter; left time: 8076.7580s
	iters: 2700, epoch: 5 | loss: 0.1186636
	speed: 0.1187s/iter; left time: 8124.0679s
	iters: 2800, epoch: 5 | loss: 0.0813073
	speed: 0.1194s/iter; left time: 8161.1644s
	iters: 2900, epoch: 5 | loss: 0.0954584
	speed: 0.1186s/iter; left time: 8091.0418s
	iters: 3000, epoch: 5 | loss: 0.0905743
	speed: 0.1183s/iter; left time: 8063.9963s
	iters: 3100, epoch: 5 | loss: 0.1002901
	speed: 0.1187s/iter; left time: 8075.8405s
	iters: 3200, epoch: 5 | loss: 0.0847461
	speed: 0.1158s/iter; left time: 7868.1699s
	iters: 3300, epoch: 5 | loss: 0.1024117
	speed: 0.1141s/iter; left time: 7742.7515s
	iters: 3400, epoch: 5 | loss: 0.0998646
	speed: 0.1148s/iter; left time: 7772.8822s
	iters: 3500, epoch: 5 | loss: 0.0978041
	speed: 0.1169s/iter; left time: 7909.1294s
	iters: 3600, epoch: 5 | loss: 0.1110223
	speed: 0.1153s/iter; left time: 7785.4547s
	iters: 3700, epoch: 5 | loss: 0.0857197
	speed: 0.1136s/iter; left time: 7663.1865s
	iters: 3800, epoch: 5 | loss: 0.0900995
	speed: 0.1147s/iter; left time: 7720.9080s
	iters: 3900, epoch: 5 | loss: 0.0950421
	speed: 0.1149s/iter; left time: 7724.4726s
	iters: 4000, epoch: 5 | loss: 0.1002941
	speed: 0.1176s/iter; left time: 7894.1738s
	iters: 4100, epoch: 5 | loss: 0.1072492
	speed: 0.1189s/iter; left time: 7973.0274s
	iters: 4200, epoch: 5 | loss: 0.0923533
	speed: 0.1184s/iter; left time: 7922.1517s
	iters: 4300, epoch: 5 | loss: 0.0978186
	speed: 0.1173s/iter; left time: 7837.3911s
	iters: 4400, epoch: 5 | loss: 0.0912306
	speed: 0.1186s/iter; left time: 7914.4866s
Epoch: 5 cost time: 00h:08m:46.01s
Epoch: 5 | Train Loss: 0.1001263 Vali Loss: 0.1304869 Test Loss: 0.1511040
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.1040925
	speed: 1.5616s/iter; left time: 103988.1173s
	iters: 200, epoch: 6 | loss: 0.1047199
	speed: 0.1154s/iter; left time: 7674.7197s
	iters: 300, epoch: 6 | loss: 0.0804931
	speed: 0.1161s/iter; left time: 7705.3513s
	iters: 400, epoch: 6 | loss: 0.0875467
	speed: 0.1160s/iter; left time: 7688.9225s
	iters: 500, epoch: 6 | loss: 0.0984672
	speed: 0.1171s/iter; left time: 7747.7005s
	iters: 600, epoch: 6 | loss: 0.1009006
	speed: 0.1151s/iter; left time: 7604.0128s
	iters: 700, epoch: 6 | loss: 0.0918718
	speed: 0.1153s/iter; left time: 7606.5829s
	iters: 800, epoch: 6 | loss: 0.1056673
	speed: 0.1163s/iter; left time: 7662.1389s
	iters: 900, epoch: 6 | loss: 0.0862563
	speed: 0.1173s/iter; left time: 7717.6531s
	iters: 1000, epoch: 6 | loss: 0.0999702
	speed: 0.1183s/iter; left time: 7772.3439s
	iters: 1100, epoch: 6 | loss: 0.0961189
	speed: 0.1175s/iter; left time: 7709.2899s
	iters: 1200, epoch: 6 | loss: 0.1147054
	speed: 0.1196s/iter; left time: 7832.8036s
	iters: 1300, epoch: 6 | loss: 0.0912160
	speed: 0.1159s/iter; left time: 7580.3703s
	iters: 1400, epoch: 6 | loss: 0.0981800
	speed: 0.1178s/iter; left time: 7691.0740s
	iters: 1500, epoch: 6 | loss: 0.0838766
	speed: 0.1163s/iter; left time: 7580.5629s
	iters: 1600, epoch: 6 | loss: 0.0883116
	speed: 0.1173s/iter; left time: 7636.6964s
	iters: 1700, epoch: 6 | loss: 0.0896513
	speed: 0.1184s/iter; left time: 7691.9413s
	iters: 1800, epoch: 6 | loss: 0.0974333
	speed: 0.1184s/iter; left time: 7682.3544s
	iters: 1900, epoch: 6 | loss: 0.0899982
	speed: 0.1191s/iter; left time: 7717.4354s
	iters: 2000, epoch: 6 | loss: 0.0925732
	speed: 0.1177s/iter; left time: 7611.6916s
	iters: 2100, epoch: 6 | loss: 0.0867949
	speed: 0.1157s/iter; left time: 7475.8082s
	iters: 2200, epoch: 6 | loss: 0.1011756
	speed: 0.1154s/iter; left time: 7445.3419s
	iters: 2300, epoch: 6 | loss: 0.0931246
	speed: 0.1148s/iter; left time: 7393.9080s
	iters: 2400, epoch: 6 | loss: 0.0912003
	speed: 0.1158s/iter; left time: 7443.0243s
	iters: 2500, epoch: 6 | loss: 0.0813842
	speed: 0.1183s/iter; left time: 7595.5862s
	iters: 2600, epoch: 6 | loss: 0.0974265
	speed: 0.1168s/iter; left time: 7488.7034s
	iters: 2700, epoch: 6 | loss: 0.1037935
	speed: 0.1178s/iter; left time: 7539.9889s
	iters: 2800, epoch: 6 | loss: 0.0945832
	speed: 0.1156s/iter; left time: 7388.0370s
	iters: 2900, epoch: 6 | loss: 0.0993364
	speed: 0.1164s/iter; left time: 7422.9639s
	iters: 3000, epoch: 6 | loss: 0.0983878
	speed: 0.1167s/iter; left time: 7434.3003s
	iters: 3100, epoch: 6 | loss: 0.0967573
	speed: 0.1179s/iter; left time: 7497.4195s
	iters: 3200, epoch: 6 | loss: 0.0809352
	speed: 0.1174s/iter; left time: 7454.3270s
	iters: 3300, epoch: 6 | loss: 0.0907727
	speed: 0.1185s/iter; left time: 7510.3753s
	iters: 3400, epoch: 6 | loss: 0.1019389
	speed: 0.1167s/iter; left time: 7387.1968s
	iters: 3500, epoch: 6 | loss: 0.1059106
	speed: 0.1177s/iter; left time: 7434.7280s
	iters: 3600, epoch: 6 | loss: 0.0917989
	speed: 0.1153s/iter; left time: 7276.6796s
	iters: 3700, epoch: 6 | loss: 0.0842525
	speed: 0.1166s/iter; left time: 7343.0432s
	iters: 3800, epoch: 6 | loss: 0.0876396
	speed: 0.1160s/iter; left time: 7297.2793s
	iters: 3900, epoch: 6 | loss: 0.1118588
	speed: 0.1165s/iter; left time: 7313.6204s
	iters: 4000, epoch: 6 | loss: 0.0991682
	speed: 0.1169s/iter; left time: 7331.3833s
	iters: 4100, epoch: 6 | loss: 0.0930842
	speed: 0.1147s/iter; left time: 7177.1510s
	iters: 4200, epoch: 6 | loss: 0.0981919
	speed: 0.1146s/iter; left time: 7161.5941s
	iters: 4300, epoch: 6 | loss: 0.0870969
	speed: 0.1152s/iter; left time: 7187.5492s
	iters: 4400, epoch: 6 | loss: 0.0964762
	speed: 0.1156s/iter; left time: 7198.3402s
Epoch: 6 cost time: 00h:08m:39.51s
Epoch: 6 | Train Loss: 0.0960726 Vali Loss: 0.1291619 Test Loss: 0.1511165
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.03767301142215729, rmse:0.19409537315368652, mae:0.1336192935705185, rse:0.6876434087753296
success delete checkpoints
Intermediate time for DE and pred_len 168: 01h:09m:06.59s
Intermediate time for DE: 04h:52m:56.47s

=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
train 143005
val 31085
test 31085
[2024-11-03 06:05:07,960] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-03 06:05:09,402] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-03 06:05:09,402] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-03 06:05:09,402] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-03 06:05:09,558] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-03 06:05:09,558] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-03 06:05:10,275] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-03 06:05:10,277] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-03 06:05:10,277] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-03 06:05:10,278] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-03 06:05:10,279] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-03 06:05:10,279] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-03 06:05:10,279] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-03 06:05:10,279] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-03 06:05:10,279] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-03 06:05:10,279] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-03 06:05:10,610] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-03 06:05:10,611] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-03 06:05:10,611] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 99.89 GB, percent = 13.2%
[2024-11-03 06:05:10,736] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-03 06:05:10,737] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 06:05:10,737] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 99.89 GB, percent = 13.2%
[2024-11-03 06:05:10,737] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-03 06:05:10,860] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-03 06:05:10,861] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 06:05:10,861] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 99.87 GB, percent = 13.2%
[2024-11-03 06:05:10,862] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-03 06:05:10,862] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-03 06:05:10,862] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-03 06:05:10,862] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-03 06:05:10,863] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-03 06:05:10,863] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-03 06:05:10,863] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-03 06:05:10,863] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-03 06:05:10,863] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-03 06:05:10,863] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-03 06:05:10,863] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-03 06:05:10,863] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-03 06:05:10,863] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-03 06:05:10,863] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-03 06:05:10,863] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-03 06:05:10,863] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f31c2cc07d0>
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-03 06:05:10,864] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-03 06:05:10,865] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-03 06:05:10,866] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1466742
	speed: 0.1748s/iter; left time: 15598.4857s
	iters: 200, epoch: 1 | loss: 0.1377795
	speed: 0.1298s/iter; left time: 11573.9787s
	iters: 300, epoch: 1 | loss: 0.1637115
	speed: 0.1289s/iter; left time: 11478.2904s
	iters: 400, epoch: 1 | loss: 0.1077301
	speed: 0.1275s/iter; left time: 11342.6149s
	iters: 500, epoch: 1 | loss: 0.1226833
	speed: 0.1276s/iter; left time: 11334.4573s
	iters: 600, epoch: 1 | loss: 0.1199201
	speed: 0.1312s/iter; left time: 11642.2717s
	iters: 700, epoch: 1 | loss: 0.1068131
	speed: 0.1287s/iter; left time: 11414.0931s
	iters: 800, epoch: 1 | loss: 0.1092960
	speed: 0.1320s/iter; left time: 11692.7568s
	iters: 900, epoch: 1 | loss: 0.0919815
	speed: 0.1286s/iter; left time: 11373.6150s
	iters: 1000, epoch: 1 | loss: 0.1038064
	speed: 0.1298s/iter; left time: 11468.7619s
	iters: 1100, epoch: 1 | loss: 0.0846845
	speed: 0.1312s/iter; left time: 11578.5412s
	iters: 1200, epoch: 1 | loss: 0.0949691
	speed: 0.1288s/iter; left time: 11353.3324s
	iters: 1300, epoch: 1 | loss: 0.0737247
	speed: 0.1311s/iter; left time: 11545.0504s
	iters: 1400, epoch: 1 | loss: 0.1031198
	speed: 0.1302s/iter; left time: 11452.3215s
	iters: 1500, epoch: 1 | loss: 0.0780963
	speed: 0.1307s/iter; left time: 11482.6928s
	iters: 1600, epoch: 1 | loss: 0.0978673
	speed: 0.1296s/iter; left time: 11371.6500s
	iters: 1700, epoch: 1 | loss: 0.1247796
	speed: 0.1308s/iter; left time: 11464.9652s
	iters: 1800, epoch: 1 | loss: 0.1062685
	speed: 0.1303s/iter; left time: 11404.8978s
	iters: 1900, epoch: 1 | loss: 0.1049088
	speed: 0.1276s/iter; left time: 11160.2830s
	iters: 2000, epoch: 1 | loss: 0.0870789
	speed: 0.1304s/iter; left time: 11394.5054s
	iters: 2100, epoch: 1 | loss: 0.0814199
	speed: 0.1311s/iter; left time: 11437.0125s
	iters: 2200, epoch: 1 | loss: 0.0885388
	speed: 0.1297s/iter; left time: 11307.0506s
	iters: 2300, epoch: 1 | loss: 0.0876981
	speed: 0.1284s/iter; left time: 11179.8422s
	iters: 2400, epoch: 1 | loss: 0.0750865
	speed: 0.1304s/iter; left time: 11339.8303s
	iters: 2500, epoch: 1 | loss: 0.0770076
	speed: 0.1299s/iter; left time: 11285.7984s
	iters: 2600, epoch: 1 | loss: 0.0930856
	speed: 0.1271s/iter; left time: 11031.3798s
	iters: 2700, epoch: 1 | loss: 0.0914229
	speed: 0.1238s/iter; left time: 10727.8290s
	iters: 2800, epoch: 1 | loss: 0.0742800
	speed: 0.1251s/iter; left time: 10831.5647s
	iters: 2900, epoch: 1 | loss: 0.0699159
	speed: 0.1299s/iter; left time: 11227.7913s
	iters: 3000, epoch: 1 | loss: 0.0888919
	speed: 0.1286s/iter; left time: 11104.4819s
	iters: 3100, epoch: 1 | loss: 0.0732918
	speed: 0.1276s/iter; left time: 11008.2922s
	iters: 3200, epoch: 1 | loss: 0.0881244
	speed: 0.1289s/iter; left time: 11106.4858s
	iters: 3300, epoch: 1 | loss: 0.0822907
	speed: 0.1264s/iter; left time: 10876.1296s
	iters: 3400, epoch: 1 | loss: 0.0753193
	speed: 0.1298s/iter; left time: 11160.7985s
	iters: 3500, epoch: 1 | loss: 0.0816539
	speed: 0.1282s/iter; left time: 11005.9994s
	iters: 3600, epoch: 1 | loss: 0.0759263
	speed: 0.1307s/iter; left time: 11205.8377s
	iters: 3700, epoch: 1 | loss: 0.0969475
	speed: 0.1297s/iter; left time: 11113.0399s
	iters: 3800, epoch: 1 | loss: 0.0810152
	speed: 0.1271s/iter; left time: 10871.4882s
	iters: 3900, epoch: 1 | loss: 0.0943139
	speed: 0.1299s/iter; left time: 11097.8455s
	iters: 4000, epoch: 1 | loss: 0.0698772
	speed: 0.1268s/iter; left time: 10825.6037s
	iters: 4100, epoch: 1 | loss: 0.0704658
	speed: 0.1269s/iter; left time: 10819.6445s
	iters: 4200, epoch: 1 | loss: 0.1035011
	speed: 0.1271s/iter; left time: 10823.0052s
	iters: 4300, epoch: 1 | loss: 0.0949263
	speed: 0.1275s/iter; left time: 10844.8182s
	iters: 4400, epoch: 1 | loss: 0.0885897
	speed: 0.1288s/iter; left time: 10939.3516s
Epoch: 1 cost time: 00h:09m:37.08s
Epoch: 1 | Train Loss: 0.0973537 Vali Loss: 0.0928246 Test Loss: 0.1050737
Validation loss decreased (inf --> 0.092825).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0701588
	speed: 1.8726s/iter; left time: 158786.1147s
	iters: 200, epoch: 2 | loss: 0.1044648
	speed: 0.1163s/iter; left time: 9848.0479s
	iters: 300, epoch: 2 | loss: 0.0884274
	speed: 0.1176s/iter; left time: 9950.3132s
	iters: 400, epoch: 2 | loss: 0.1147017
	speed: 0.1188s/iter; left time: 10040.6889s
	iters: 500, epoch: 2 | loss: 0.0937675
	speed: 0.1192s/iter; left time: 10056.2784s
	iters: 600, epoch: 2 | loss: 0.0921706
	speed: 0.1180s/iter; left time: 9950.1293s
	iters: 700, epoch: 2 | loss: 0.0930738
	speed: 0.1198s/iter; left time: 10087.4863s
	iters: 800, epoch: 2 | loss: 0.1000150
	speed: 0.1200s/iter; left time: 10094.0531s
	iters: 900, epoch: 2 | loss: 0.0975661
	speed: 0.1182s/iter; left time: 9925.3564s
	iters: 1000, epoch: 2 | loss: 0.0700671
	speed: 0.1170s/iter; left time: 9816.9412s
	iters: 1100, epoch: 2 | loss: 0.0929756
	speed: 0.1192s/iter; left time: 9988.0118s
	iters: 1200, epoch: 2 | loss: 0.0745666
	speed: 0.1180s/iter; left time: 9879.2296s
	iters: 1300, epoch: 2 | loss: 0.0924439
	speed: 0.1171s/iter; left time: 9789.0249s
	iters: 1400, epoch: 2 | loss: 0.1111560
	speed: 0.1153s/iter; left time: 9628.5784s
	iters: 1500, epoch: 2 | loss: 0.0793124
	speed: 0.1199s/iter; left time: 10001.1410s
	iters: 1600, epoch: 2 | loss: 0.0794686
	speed: 0.1185s/iter; left time: 9867.7083s
	iters: 1700, epoch: 2 | loss: 0.0875069
	speed: 0.1171s/iter; left time: 9738.6008s
	iters: 1800, epoch: 2 | loss: 0.0863800
	speed: 0.1146s/iter; left time: 9522.1638s
	iters: 1900, epoch: 2 | loss: 0.0864655
	speed: 0.1185s/iter; left time: 9833.4448s
	iters: 2000, epoch: 2 | loss: 0.0874661
	speed: 0.1182s/iter; left time: 9800.8815s
	iters: 2100, epoch: 2 | loss: 0.0986785
	speed: 0.1171s/iter; left time: 9692.0347s
	iters: 2200, epoch: 2 | loss: 0.0935980
	speed: 0.1163s/iter; left time: 9617.8344s
	iters: 2300, epoch: 2 | loss: 0.0926060
	speed: 0.1199s/iter; left time: 9902.1111s
	iters: 2400, epoch: 2 | loss: 0.0731041
	speed: 0.1162s/iter; left time: 9588.0168s
	iters: 2500, epoch: 2 | loss: 0.0878800
	speed: 0.1154s/iter; left time: 9504.3980s
	iters: 2600, epoch: 2 | loss: 0.1000494
	speed: 0.1144s/iter; left time: 9412.6264s
	iters: 2700, epoch: 2 | loss: 0.0909730
	speed: 0.1134s/iter; left time: 9324.6489s
	iters: 2800, epoch: 2 | loss: 0.1120826
	speed: 0.1131s/iter; left time: 9284.1912s
	iters: 2900, epoch: 2 | loss: 0.0753991
	speed: 0.1170s/iter; left time: 9593.3664s
	iters: 3000, epoch: 2 | loss: 0.0918223
	speed: 0.1166s/iter; left time: 9550.6203s
	iters: 3100, epoch: 2 | loss: 0.1169008
	speed: 0.1160s/iter; left time: 9491.9086s
	iters: 3200, epoch: 2 | loss: 0.0799625
	speed: 0.1160s/iter; left time: 9477.0554s
	iters: 3300, epoch: 2 | loss: 0.0924724
	speed: 0.1156s/iter; left time: 9434.9133s
	iters: 3400, epoch: 2 | loss: 0.0893005
	speed: 0.1156s/iter; left time: 9423.6612s
	iters: 3500, epoch: 2 | loss: 0.0870048
	speed: 0.1142s/iter; left time: 9291.7373s
	iters: 3600, epoch: 2 | loss: 0.0749805
	speed: 0.1153s/iter; left time: 9374.1188s
	iters: 3700, epoch: 2 | loss: 0.0773853
	speed: 0.1178s/iter; left time: 9567.4743s
	iters: 3800, epoch: 2 | loss: 0.0819646
	speed: 0.1175s/iter; left time: 9526.6254s
	iters: 3900, epoch: 2 | loss: 0.0823601
	speed: 0.1144s/iter; left time: 9265.6871s
	iters: 4000, epoch: 2 | loss: 0.0686158
	speed: 0.1143s/iter; left time: 9248.0084s
	iters: 4100, epoch: 2 | loss: 0.0982631
	speed: 0.1139s/iter; left time: 9199.3269s
	iters: 4200, epoch: 2 | loss: 0.0787107
	speed: 0.1149s/iter; left time: 9272.7571s
	iters: 4300, epoch: 2 | loss: 0.0879422
	speed: 0.1146s/iter; left time: 9238.3802s
	iters: 4400, epoch: 2 | loss: 0.0896147
	speed: 0.1152s/iter; left time: 9276.6456s
Epoch: 2 cost time: 00h:08m:41.97s
Epoch: 2 | Train Loss: 0.0860910 Vali Loss: 0.0922121 Test Loss: 0.1065872
Validation loss decreased (0.092825 --> 0.092212).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0907432
	speed: 1.6204s/iter; left time: 130160.2971s
	iters: 200, epoch: 3 | loss: 0.0779589
	speed: 0.1152s/iter; left time: 9241.5971s
	iters: 300, epoch: 3 | loss: 0.0885364
	speed: 0.1163s/iter; left time: 9316.8426s
	iters: 400, epoch: 3 | loss: 0.0848934
	speed: 0.1171s/iter; left time: 9367.1094s
	iters: 500, epoch: 3 | loss: 0.0842507
	speed: 0.1172s/iter; left time: 9364.6484s
	iters: 600, epoch: 3 | loss: 0.0788545
	speed: 0.1169s/iter; left time: 9328.3574s
	iters: 700, epoch: 3 | loss: 0.0803074
	speed: 0.1174s/iter; left time: 9359.3329s
	iters: 800, epoch: 3 | loss: 0.0902780
	speed: 0.1153s/iter; left time: 9179.2263s
	iters: 900, epoch: 3 | loss: 0.0700542
	speed: 0.1165s/iter; left time: 9260.9572s
	iters: 1000, epoch: 3 | loss: 0.0909660
	speed: 0.1148s/iter; left time: 9119.6276s
	iters: 1100, epoch: 3 | loss: 0.0937846
	speed: 0.1147s/iter; left time: 9097.6639s
	iters: 1200, epoch: 3 | loss: 0.0607558
	speed: 0.1154s/iter; left time: 9145.7810s
	iters: 1300, epoch: 3 | loss: 0.0803862
	speed: 0.1159s/iter; left time: 9167.5892s
	iters: 1400, epoch: 3 | loss: 0.0932646
	speed: 0.1168s/iter; left time: 9233.6737s
	iters: 1500, epoch: 3 | loss: 0.0733327
	speed: 0.1160s/iter; left time: 9157.2614s
	iters: 1600, epoch: 3 | loss: 0.0595024
	speed: 0.1156s/iter; left time: 9109.5161s
	iters: 1700, epoch: 3 | loss: 0.0652814
	speed: 0.1152s/iter; left time: 9072.5026s
	iters: 1800, epoch: 3 | loss: 0.0982525
	speed: 0.1133s/iter; left time: 8909.1675s
	iters: 1900, epoch: 3 | loss: 0.0716447
	speed: 0.1150s/iter; left time: 9034.0922s
	iters: 2000, epoch: 3 | loss: 0.0835190
	speed: 0.1154s/iter; left time: 9052.4635s
	iters: 2100, epoch: 3 | loss: 0.0834547
	speed: 0.1173s/iter; left time: 9187.7496s
	iters: 2200, epoch: 3 | loss: 0.0948817
	speed: 0.1146s/iter; left time: 8965.3189s
	iters: 2300, epoch: 3 | loss: 0.0844729
	speed: 0.1131s/iter; left time: 8832.9053s
	iters: 2400, epoch: 3 | loss: 0.0765860
	speed: 0.1153s/iter; left time: 8993.3148s
	iters: 2500, epoch: 3 | loss: 0.0919627
	speed: 0.1158s/iter; left time: 9022.1140s
	iters: 2600, epoch: 3 | loss: 0.0797675
	speed: 0.1170s/iter; left time: 9102.4720s
	iters: 2700, epoch: 3 | loss: 0.0741416
	speed: 0.1155s/iter; left time: 8973.8882s
	iters: 2800, epoch: 3 | loss: 0.0829531
	speed: 0.1155s/iter; left time: 8968.6057s
	iters: 2900, epoch: 3 | loss: 0.0889192
	speed: 0.1147s/iter; left time: 8889.3441s
	iters: 3000, epoch: 3 | loss: 0.0789738
	speed: 0.1158s/iter; left time: 8968.2427s
	iters: 3100, epoch: 3 | loss: 0.0949245
	speed: 0.1167s/iter; left time: 9026.3304s
	iters: 3200, epoch: 3 | loss: 0.0981605
	speed: 0.1178s/iter; left time: 9098.8648s
	iters: 3300, epoch: 3 | loss: 0.0789458
	speed: 0.1169s/iter; left time: 9016.7586s
	iters: 3400, epoch: 3 | loss: 0.0741549
	speed: 0.1187s/iter; left time: 9139.5161s
	iters: 3500, epoch: 3 | loss: 0.0773597
	speed: 0.1182s/iter; left time: 9091.3377s
	iters: 3600, epoch: 3 | loss: 0.0935745
	speed: 0.1173s/iter; left time: 9012.3308s
	iters: 3700, epoch: 3 | loss: 0.0769829
	speed: 0.1185s/iter; left time: 9089.8660s
	iters: 3800, epoch: 3 | loss: 0.0949859
	speed: 0.1183s/iter; left time: 9068.1966s
	iters: 3900, epoch: 3 | loss: 0.0808080
	speed: 0.1185s/iter; left time: 9066.9092s
	iters: 4000, epoch: 3 | loss: 0.0665414
	speed: 0.1160s/iter; left time: 8861.8437s
	iters: 4100, epoch: 3 | loss: 0.0754559
	speed: 0.1176s/iter; left time: 8973.6887s
	iters: 4200, epoch: 3 | loss: 0.0699142
	speed: 0.1166s/iter; left time: 8885.9167s
	iters: 4300, epoch: 3 | loss: 0.0632910
	speed: 0.1188s/iter; left time: 9041.2206s
	iters: 4400, epoch: 3 | loss: 0.0808305
	speed: 0.1158s/iter; left time: 8802.9235s
Epoch: 3 cost time: 00h:08m:40.38s
Epoch: 3 | Train Loss: 0.0838997 Vali Loss: 0.0905142 Test Loss: 0.1035439
Validation loss decreased (0.092212 --> 0.090514).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0914321
	speed: 1.6342s/iter; left time: 123966.1902s
	iters: 200, epoch: 4 | loss: 0.0923484
	speed: 0.1178s/iter; left time: 8923.0128s
	iters: 300, epoch: 4 | loss: 0.0886503
	speed: 0.1152s/iter; left time: 8712.2391s
	iters: 400, epoch: 4 | loss: 0.0890385
	speed: 0.1155s/iter; left time: 8726.3773s
	iters: 500, epoch: 4 | loss: 0.0889764
	speed: 0.1156s/iter; left time: 8719.1197s
	iters: 600, epoch: 4 | loss: 0.0682504
	speed: 0.1178s/iter; left time: 8874.6318s
	iters: 700, epoch: 4 | loss: 0.0858520
	speed: 0.1163s/iter; left time: 8755.5159s
	iters: 800, epoch: 4 | loss: 0.0807579
	speed: 0.1139s/iter; left time: 8558.9584s
	iters: 900, epoch: 4 | loss: 0.0771627
	speed: 0.1157s/iter; left time: 8685.2748s
	iters: 1000, epoch: 4 | loss: 0.0891313
	speed: 0.1158s/iter; left time: 8678.3248s
	iters: 1100, epoch: 4 | loss: 0.0808600
	speed: 0.1133s/iter; left time: 8481.0700s
	iters: 1200, epoch: 4 | loss: 0.1001335
	speed: 0.1148s/iter; left time: 8579.0647s
	iters: 1300, epoch: 4 | loss: 0.1131133
	speed: 0.1136s/iter; left time: 8482.4180s
	iters: 1400, epoch: 4 | loss: 0.0778967
	speed: 0.1156s/iter; left time: 8617.9859s
	iters: 1500, epoch: 4 | loss: 0.0659208
	speed: 0.1143s/iter; left time: 8512.1282s
	iters: 1600, epoch: 4 | loss: 0.0821595
	speed: 0.1144s/iter; left time: 8504.2124s
	iters: 1700, epoch: 4 | loss: 0.0919877
	speed: 0.1148s/iter; left time: 8525.1535s
	iters: 1800, epoch: 4 | loss: 0.0923949
	speed: 0.1144s/iter; left time: 8486.7110s
	iters: 1900, epoch: 4 | loss: 0.0738678
	speed: 0.1155s/iter; left time: 8557.1487s
	iters: 2000, epoch: 4 | loss: 0.0819451
	speed: 0.1135s/iter; left time: 8393.9204s
	iters: 2100, epoch: 4 | loss: 0.0814312
	speed: 0.1126s/iter; left time: 8317.2582s
	iters: 2200, epoch: 4 | loss: 0.0888639
	speed: 0.1129s/iter; left time: 8323.5396s
	iters: 2300, epoch: 4 | loss: 0.1003453
	speed: 0.1129s/iter; left time: 8318.3946s
	iters: 2400, epoch: 4 | loss: 0.0999414
	speed: 0.1145s/iter; left time: 8425.5708s
	iters: 2500, epoch: 4 | loss: 0.0742211
	speed: 0.1128s/iter; left time: 8283.9718s
	iters: 2600, epoch: 4 | loss: 0.0718067
	speed: 0.1142s/iter; left time: 8377.3046s
	iters: 2700, epoch: 4 | loss: 0.0911036
	speed: 0.1134s/iter; left time: 8308.4250s
	iters: 2800, epoch: 4 | loss: 0.0877281
	speed: 0.1117s/iter; left time: 8169.8015s
	iters: 2900, epoch: 4 | loss: 0.0797919
	speed: 0.1138s/iter; left time: 8314.7661s
	iters: 3000, epoch: 4 | loss: 0.0775673
	speed: 0.1138s/iter; left time: 8305.5354s
	iters: 3100, epoch: 4 | loss: 0.0879129
	speed: 0.1121s/iter; left time: 8167.1228s
	iters: 3200, epoch: 4 | loss: 0.0780287
	speed: 0.1125s/iter; left time: 8183.4866s
	iters: 3300, epoch: 4 | loss: 0.0876071
	speed: 0.1155s/iter; left time: 8394.3315s
	iters: 3400, epoch: 4 | loss: 0.0757971
	speed: 0.1134s/iter; left time: 8226.7189s
	iters: 3500, epoch: 4 | loss: 0.0894305
	speed: 0.1156s/iter; left time: 8377.4186s
	iters: 3600, epoch: 4 | loss: 0.0851934
	speed: 0.1136s/iter; left time: 8218.1792s
	iters: 3700, epoch: 4 | loss: 0.0877569
	speed: 0.1131s/iter; left time: 8175.3755s
	iters: 3800, epoch: 4 | loss: 0.0781913
	speed: 0.1133s/iter; left time: 8172.6620s
	iters: 3900, epoch: 4 | loss: 0.0874085
	speed: 0.1160s/iter; left time: 8359.8425s
	iters: 4000, epoch: 4 | loss: 0.0781264
	speed: 0.1144s/iter; left time: 8235.0631s
	iters: 4100, epoch: 4 | loss: 0.0745134
	speed: 0.1133s/iter; left time: 8138.9936s
	iters: 4200, epoch: 4 | loss: 0.0732169
	speed: 0.1151s/iter; left time: 8258.0444s
	iters: 4300, epoch: 4 | loss: 0.0699919
	speed: 0.1143s/iter; left time: 8192.2432s
	iters: 4400, epoch: 4 | loss: 0.0951408
	speed: 0.1139s/iter; left time: 8151.1855s
Epoch: 4 cost time: 00h:08m:31.76s
Epoch: 4 | Train Loss: 0.0825824 Vali Loss: 0.0908698 Test Loss: 0.1047861
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0933834
	speed: 1.5999s/iter; left time: 114213.8981s
	iters: 200, epoch: 5 | loss: 0.0743399
	speed: 0.1159s/iter; left time: 8264.3638s
	iters: 300, epoch: 5 | loss: 0.0725531
	speed: 0.1166s/iter; left time: 8303.3212s
	iters: 400, epoch: 5 | loss: 0.0881155
	speed: 0.1159s/iter; left time: 8242.0165s
	iters: 500, epoch: 5 | loss: 0.0945252
	speed: 0.1146s/iter; left time: 8136.5189s
	iters: 600, epoch: 5 | loss: 0.0865966
	speed: 0.1161s/iter; left time: 8226.7902s
	iters: 700, epoch: 5 | loss: 0.0829508
	speed: 0.1164s/iter; left time: 8240.0986s
	iters: 800, epoch: 5 | loss: 0.0887444
	speed: 0.1174s/iter; left time: 8298.8268s
	iters: 900, epoch: 5 | loss: 0.1051521
	speed: 0.1152s/iter; left time: 8132.9371s
	iters: 1000, epoch: 5 | loss: 0.0809733
	speed: 0.1146s/iter; left time: 8075.1920s
	iters: 1100, epoch: 5 | loss: 0.0754441
	speed: 0.1171s/iter; left time: 8239.9571s
	iters: 1200, epoch: 5 | loss: 0.0971770
	speed: 0.1164s/iter; left time: 8179.7599s
	iters: 1300, epoch: 5 | loss: 0.0774984
	speed: 0.1165s/iter; left time: 8179.5923s
	iters: 1400, epoch: 5 | loss: 0.0693193
	speed: 0.1139s/iter; left time: 7981.7273s
	iters: 1500, epoch: 5 | loss: 0.0622493
	speed: 0.1144s/iter; left time: 8004.3232s
	iters: 1600, epoch: 5 | loss: 0.0728563
	speed: 0.1140s/iter; left time: 7964.1308s
	iters: 1700, epoch: 5 | loss: 0.0667490
	speed: 0.1165s/iter; left time: 8131.8763s
	iters: 1800, epoch: 5 | loss: 0.0948240
	speed: 0.1157s/iter; left time: 8066.1557s
	iters: 1900, epoch: 5 | loss: 0.0625855
	speed: 0.1140s/iter; left time: 7935.2409s
	iters: 2000, epoch: 5 | loss: 0.0731169
	speed: 0.1153s/iter; left time: 8012.9702s
	iters: 2100, epoch: 5 | loss: 0.0691220
	speed: 0.1131s/iter; left time: 7850.1405s
	iters: 2200, epoch: 5 | loss: 0.0799258
	speed: 0.1139s/iter; left time: 7891.7664s
	iters: 2300, epoch: 5 | loss: 0.0892581
	speed: 0.1147s/iter; left time: 7938.9441s
	iters: 2400, epoch: 5 | loss: 0.0849659
	speed: 0.1138s/iter; left time: 7859.0180s
	iters: 2500, epoch: 5 | loss: 0.0802421
	speed: 0.1131s/iter; left time: 7804.0505s
	iters: 2600, epoch: 5 | loss: 0.0774631
	speed: 0.1140s/iter; left time: 7852.8952s
	iters: 2700, epoch: 5 | loss: 0.0812496
	speed: 0.1143s/iter; left time: 7862.3026s
	iters: 2800, epoch: 5 | loss: 0.0752958
	speed: 0.1138s/iter; left time: 7819.8376s
	iters: 2900, epoch: 5 | loss: 0.0816401
	speed: 0.1172s/iter; left time: 8041.8530s
	iters: 3000, epoch: 5 | loss: 0.0708815
	speed: 0.1164s/iter; left time: 7969.1932s
	iters: 3100, epoch: 5 | loss: 0.1038611
	speed: 0.1152s/iter; left time: 7878.3293s
	iters: 3200, epoch: 5 | loss: 0.0952071
	speed: 0.1161s/iter; left time: 7926.1036s
	iters: 3300, epoch: 5 | loss: 0.0748858
	speed: 0.1175s/iter; left time: 8012.6982s
	iters: 3400, epoch: 5 | loss: 0.0783696
	speed: 0.1139s/iter; left time: 7758.4646s
	iters: 3500, epoch: 5 | loss: 0.0848109
	speed: 0.1161s/iter; left time: 7894.9146s
	iters: 3600, epoch: 5 | loss: 0.0840811
	speed: 0.1160s/iter; left time: 7871.9308s
	iters: 3700, epoch: 5 | loss: 0.0691066
	speed: 0.1172s/iter; left time: 7944.3060s
	iters: 3800, epoch: 5 | loss: 0.0793731
	speed: 0.1158s/iter; left time: 7835.1559s
	iters: 3900, epoch: 5 | loss: 0.0673810
	speed: 0.1163s/iter; left time: 7860.3347s
	iters: 4000, epoch: 5 | loss: 0.0856006
	speed: 0.1140s/iter; left time: 7696.4913s
	iters: 4100, epoch: 5 | loss: 0.0628996
	speed: 0.1153s/iter; left time: 7768.3951s
	iters: 4200, epoch: 5 | loss: 0.0903348
	speed: 0.1154s/iter; left time: 7765.9766s
	iters: 4300, epoch: 5 | loss: 0.0866672
	speed: 0.1165s/iter; left time: 7825.4286s
	iters: 4400, epoch: 5 | loss: 0.0803752
	speed: 0.1151s/iter; left time: 7723.7072s
Epoch: 5 cost time: 00h:08m:36.25s
Epoch: 5 | Train Loss: 0.0813836 Vali Loss: 0.0900973 Test Loss: 0.1040331
Validation loss decreased (0.090514 --> 0.090097).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0863184
	speed: 1.6079s/iter; left time: 107602.2371s
	iters: 200, epoch: 6 | loss: 0.0890369
	speed: 0.1166s/iter; left time: 7792.9815s
	iters: 300, epoch: 6 | loss: 0.0835939
	speed: 0.1167s/iter; left time: 7788.6726s
	iters: 400, epoch: 6 | loss: 0.0703793
	speed: 0.1153s/iter; left time: 7681.3484s
	iters: 500, epoch: 6 | loss: 0.0827197
	speed: 0.1163s/iter; left time: 7737.2977s
	iters: 600, epoch: 6 | loss: 0.0714470
	speed: 0.1183s/iter; left time: 7858.6330s
	iters: 700, epoch: 6 | loss: 0.0747727
	speed: 0.1166s/iter; left time: 7734.6799s
	iters: 800, epoch: 6 | loss: 0.0732784
	speed: 0.1169s/iter; left time: 7739.5273s
	iters: 900, epoch: 6 | loss: 0.0771534
	speed: 0.1158s/iter; left time: 7658.9947s
	iters: 1000, epoch: 6 | loss: 0.0741465
	speed: 0.1157s/iter; left time: 7640.8549s
	iters: 1100, epoch: 6 | loss: 0.0746656
	speed: 0.1148s/iter; left time: 7567.3418s
	iters: 1200, epoch: 6 | loss: 0.0931855
	speed: 0.1191s/iter; left time: 7837.7050s
	iters: 1300, epoch: 6 | loss: 0.0977927
	speed: 0.1163s/iter; left time: 7644.3140s
	iters: 1400, epoch: 6 | loss: 0.0876032
	speed: 0.1166s/iter; left time: 7651.1682s
	iters: 1500, epoch: 6 | loss: 0.0801408
	speed: 0.1177s/iter; left time: 7712.7444s
	iters: 1600, epoch: 6 | loss: 0.0721369
	speed: 0.1177s/iter; left time: 7696.8397s
	iters: 1700, epoch: 6 | loss: 0.0922342
	speed: 0.1171s/iter; left time: 7648.3469s
	iters: 1800, epoch: 6 | loss: 0.0814926
	speed: 0.1143s/iter; left time: 7452.2997s
	iters: 1900, epoch: 6 | loss: 0.0799462
	speed: 0.1161s/iter; left time: 7563.4943s
	iters: 2000, epoch: 6 | loss: 0.0895512
	speed: 0.1159s/iter; left time: 7538.6946s
	iters: 2100, epoch: 6 | loss: 0.0853165
	speed: 0.1170s/iter; left time: 7596.2929s
	iters: 2200, epoch: 6 | loss: 0.1018588
	speed: 0.1164s/iter; left time: 7545.7194s
	iters: 2300, epoch: 6 | loss: 0.0753619
	speed: 0.1164s/iter; left time: 7536.7268s
	iters: 2400, epoch: 6 | loss: 0.0675035
	speed: 0.1160s/iter; left time: 7493.0730s
	iters: 2500, epoch: 6 | loss: 0.0995846
	speed: 0.1147s/iter; left time: 7398.4242s
	iters: 2600, epoch: 6 | loss: 0.0759167
	speed: 0.1147s/iter; left time: 7387.5417s
	iters: 2700, epoch: 6 | loss: 0.0709326
	speed: 0.1167s/iter; left time: 7503.3345s
	iters: 2800, epoch: 6 | loss: 0.1127540
	speed: 0.1168s/iter; left time: 7503.3535s
	iters: 2900, epoch: 6 | loss: 0.0813409
	speed: 0.1158s/iter; left time: 7424.7262s
	iters: 3000, epoch: 6 | loss: 0.0786561
	speed: 0.1145s/iter; left time: 7330.6350s
	iters: 3100, epoch: 6 | loss: 0.0826245
	speed: 0.1170s/iter; left time: 7480.9854s
	iters: 3200, epoch: 6 | loss: 0.0986693
	speed: 0.1163s/iter; left time: 7423.9302s
	iters: 3300, epoch: 6 | loss: 0.0849674
	speed: 0.1173s/iter; left time: 7471.3527s
	iters: 3400, epoch: 6 | loss: 0.0744465
	speed: 0.1141s/iter; left time: 7260.0666s
	iters: 3500, epoch: 6 | loss: 0.0913548
	speed: 0.1164s/iter; left time: 7393.4716s
	iters: 3600, epoch: 6 | loss: 0.0656657
	speed: 0.1173s/iter; left time: 7438.1420s
	iters: 3700, epoch: 6 | loss: 0.0794955
	speed: 0.1132s/iter; left time: 7168.1313s
	iters: 3800, epoch: 6 | loss: 0.0760554
	speed: 0.1145s/iter; left time: 7239.6268s
	iters: 3900, epoch: 6 | loss: 0.0779494
	speed: 0.1147s/iter; left time: 7242.1353s
	iters: 4000, epoch: 6 | loss: 0.0917149
	speed: 0.1142s/iter; left time: 7199.8447s
	iters: 4100, epoch: 6 | loss: 0.0724742
	speed: 0.1148s/iter; left time: 7224.6386s
	iters: 4200, epoch: 6 | loss: 0.0769409
	speed: 0.1161s/iter; left time: 7291.8852s
	iters: 4300, epoch: 6 | loss: 0.0667945
	speed: 0.1167s/iter; left time: 7317.3923s
	iters: 4400, epoch: 6 | loss: 0.0704586
	speed: 0.1129s/iter; left time: 7072.5778s
Epoch: 6 cost time: 00h:08m:38.83s
Epoch: 6 | Train Loss: 0.0803718 Vali Loss: 0.0905898 Test Loss: 0.1044702
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0694771
	speed: 1.5992s/iter; left time: 99877.1591s
	iters: 200, epoch: 7 | loss: 0.0701124
	speed: 0.1165s/iter; left time: 7262.2913s
	iters: 300, epoch: 7 | loss: 0.0611065
	speed: 0.1148s/iter; left time: 7147.6222s
	iters: 400, epoch: 7 | loss: 0.0853083
	speed: 0.1183s/iter; left time: 7353.4378s
	iters: 500, epoch: 7 | loss: 0.0865817
	speed: 0.1156s/iter; left time: 7176.3244s
	iters: 600, epoch: 7 | loss: 0.0731895
	speed: 0.1170s/iter; left time: 7250.7958s
	iters: 700, epoch: 7 | loss: 0.1010686
	speed: 0.1172s/iter; left time: 7250.9657s
	iters: 800, epoch: 7 | loss: 0.0807473
	speed: 0.1166s/iter; left time: 7200.2405s
	iters: 900, epoch: 7 | loss: 0.0729549
	speed: 0.1158s/iter; left time: 7137.6264s
	iters: 1000, epoch: 7 | loss: 0.0784136
	speed: 0.1160s/iter; left time: 7142.9028s
	iters: 1100, epoch: 7 | loss: 0.0915089
	speed: 0.1162s/iter; left time: 7138.6109s
	iters: 1200, epoch: 7 | loss: 0.0813137
	speed: 0.1176s/iter; left time: 7214.8011s
	iters: 1300, epoch: 7 | loss: 0.0710811
	speed: 0.1147s/iter; left time: 7023.3959s
	iters: 1400, epoch: 7 | loss: 0.0674738
	speed: 0.1169s/iter; left time: 7146.4507s
	iters: 1500, epoch: 7 | loss: 0.0731219
	speed: 0.1159s/iter; left time: 7076.6751s
	iters: 1600, epoch: 7 | loss: 0.0795863
	speed: 0.1175s/iter; left time: 7159.0093s
	iters: 1700, epoch: 7 | loss: 0.0768837
	speed: 0.1178s/iter; left time: 7169.3604s
	iters: 1800, epoch: 7 | loss: 0.0973881
	speed: 0.1162s/iter; left time: 7058.1413s
	iters: 1900, epoch: 7 | loss: 0.0784142
	speed: 0.1173s/iter; left time: 7111.9250s
	iters: 2000, epoch: 7 | loss: 0.0736109
	speed: 0.1175s/iter; left time: 7113.4931s
	iters: 2100, epoch: 7 | loss: 0.0847631
	speed: 0.1163s/iter; left time: 7030.1128s
	iters: 2200, epoch: 7 | loss: 0.0700621
	speed: 0.1185s/iter; left time: 7152.6374s
	iters: 2300, epoch: 7 | loss: 0.0826743
	speed: 0.1178s/iter; left time: 7096.9864s
	iters: 2400, epoch: 7 | loss: 0.0855349
	speed: 0.1179s/iter; left time: 7089.6478s
	iters: 2500, epoch: 7 | loss: 0.0894471
	speed: 0.1159s/iter; left time: 6961.7498s
	iters: 2600, epoch: 7 | loss: 0.0709336
	speed: 0.1170s/iter; left time: 7014.0372s
	iters: 2700, epoch: 7 | loss: 0.0635979
	speed: 0.1142s/iter; left time: 6838.1543s
	iters: 2800, epoch: 7 | loss: 0.0727365
	speed: 0.1165s/iter; left time: 6960.3037s
	iters: 2900, epoch: 7 | loss: 0.0891747
	speed: 0.1137s/iter; left time: 6781.6957s
	iters: 3000, epoch: 7 | loss: 0.0914883
	speed: 0.1150s/iter; left time: 6848.7837s
	iters: 3100, epoch: 7 | loss: 0.0926042
	speed: 0.1167s/iter; left time: 6940.1020s
	iters: 3200, epoch: 7 | loss: 0.0622337
	speed: 0.1151s/iter; left time: 6832.7122s
	iters: 3300, epoch: 7 | loss: 0.0735094
	speed: 0.1146s/iter; left time: 6793.1364s
	iters: 3400, epoch: 7 | loss: 0.0951522
	speed: 0.1152s/iter; left time: 6813.5322s
	iters: 3500, epoch: 7 | loss: 0.0720976
	speed: 0.1153s/iter; left time: 6807.6841s
	iters: 3600, epoch: 7 | loss: 0.0690883
	speed: 0.1146s/iter; left time: 6753.2053s
	iters: 3700, epoch: 7 | loss: 0.0841284
	speed: 0.1187s/iter; left time: 6985.1423s
	iters: 3800, epoch: 7 | loss: 0.0866462
	speed: 0.1156s/iter; left time: 6790.0288s
	iters: 3900, epoch: 7 | loss: 0.0677450
	speed: 0.1156s/iter; left time: 6780.3658s
	iters: 4000, epoch: 7 | loss: 0.0808895
	speed: 0.1148s/iter; left time: 6723.6332s
	iters: 4100, epoch: 7 | loss: 0.0839261
	speed: 0.1135s/iter; left time: 6633.9557s
	iters: 4200, epoch: 7 | loss: 0.0723493
	speed: 0.1171s/iter; left time: 6835.8888s
	iters: 4300, epoch: 7 | loss: 0.0775747
	speed: 0.1183s/iter; left time: 6893.1300s
	iters: 4400, epoch: 7 | loss: 0.0767770
	speed: 0.1166s/iter; left time: 6778.6296s
Epoch: 7 cost time: 00h:08m:40.24s
Epoch: 7 | Train Loss: 0.0794193 Vali Loss: 0.0901961 Test Loss: 0.1045509
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0895511
	speed: 1.6001s/iter; left time: 92783.0760s
	iters: 200, epoch: 8 | loss: 0.0866904
	speed: 0.1176s/iter; left time: 6804.9920s
	iters: 300, epoch: 8 | loss: 0.0797954
	speed: 0.1173s/iter; left time: 6778.7685s
	iters: 400, epoch: 8 | loss: 0.0820298
	speed: 0.1157s/iter; left time: 6671.7858s
	iters: 500, epoch: 8 | loss: 0.0783670
	speed: 0.1153s/iter; left time: 6637.8132s
	iters: 600, epoch: 8 | loss: 0.0902877
	speed: 0.1160s/iter; left time: 6667.4776s
	iters: 700, epoch: 8 | loss: 0.0648628
	speed: 0.1193s/iter; left time: 6846.3671s
	iters: 800, epoch: 8 | loss: 0.0814682
	speed: 0.1170s/iter; left time: 6705.1745s
	iters: 900, epoch: 8 | loss: 0.0808761
	speed: 0.1179s/iter; left time: 6740.2376s
	iters: 1000, epoch: 8 | loss: 0.0752130
	speed: 0.1156s/iter; left time: 6597.0368s
	iters: 1100, epoch: 8 | loss: 0.0748815
	speed: 0.1141s/iter; left time: 6500.1897s
	iters: 1200, epoch: 8 | loss: 0.0795547
	speed: 0.1146s/iter; left time: 6521.2980s
	iters: 1300, epoch: 8 | loss: 0.0994396
	speed: 0.1153s/iter; left time: 6548.6293s
	iters: 1400, epoch: 8 | loss: 0.0792517
	speed: 0.1165s/iter; left time: 6602.8411s
	iters: 1500, epoch: 8 | loss: 0.0784374
	speed: 0.1173s/iter; left time: 6636.2352s
	iters: 1600, epoch: 8 | loss: 0.0859944
	speed: 0.1158s/iter; left time: 6538.8571s
	iters: 1700, epoch: 8 | loss: 0.0819602
	speed: 0.1172s/iter; left time: 6609.0135s
	iters: 1800, epoch: 8 | loss: 0.0977695
	speed: 0.1156s/iter; left time: 6505.3635s
	iters: 1900, epoch: 8 | loss: 0.0645730
	speed: 0.1171s/iter; left time: 6578.6172s
	iters: 2000, epoch: 8 | loss: 0.0558155
	speed: 0.1168s/iter; left time: 6549.4902s
	iters: 2100, epoch: 8 | loss: 0.0748824
	speed: 0.1157s/iter; left time: 6478.2495s
	iters: 2200, epoch: 8 | loss: 0.0751968
	speed: 0.1162s/iter; left time: 6494.5979s
	iters: 2300, epoch: 8 | loss: 0.0775747
	speed: 0.1148s/iter; left time: 6404.6842s
	iters: 2400, epoch: 8 | loss: 0.0743494
	speed: 0.1139s/iter; left time: 6342.7048s
	iters: 2500, epoch: 8 | loss: 0.0847968
	speed: 0.1157s/iter; left time: 6433.2662s
	iters: 2600, epoch: 8 | loss: 0.0757934
	speed: 0.1164s/iter; left time: 6456.4094s
	iters: 2700, epoch: 8 | loss: 0.0962444
	speed: 0.1137s/iter; left time: 6297.2839s
	iters: 2800, epoch: 8 | loss: 0.0798034
	speed: 0.1155s/iter; left time: 6386.9256s
	iters: 2900, epoch: 8 | loss: 0.0616579
	speed: 0.1153s/iter; left time: 6360.0942s
	iters: 3000, epoch: 8 | loss: 0.0749053
	speed: 0.1160s/iter; left time: 6388.2991s
	iters: 3100, epoch: 8 | loss: 0.0779971
	speed: 0.1161s/iter; left time: 6384.3218s
	iters: 3200, epoch: 8 | loss: 0.0703546
	speed: 0.1156s/iter; left time: 6344.9051s
	iters: 3300, epoch: 8 | loss: 0.0924814
	speed: 0.1184s/iter; left time: 6485.7043s
	iters: 3400, epoch: 8 | loss: 0.0760914
	speed: 0.1151s/iter; left time: 6293.5055s
	iters: 3500, epoch: 8 | loss: 0.0540513
	speed: 0.1156s/iter; left time: 6309.0888s
	iters: 3600, epoch: 8 | loss: 0.0791183
	speed: 0.1166s/iter; left time: 6350.9989s
	iters: 3700, epoch: 8 | loss: 0.0715009
	speed: 0.1170s/iter; left time: 6365.5592s
	iters: 3800, epoch: 8 | loss: 0.0779355
	speed: 0.1161s/iter; left time: 6304.4201s
	iters: 3900, epoch: 8 | loss: 0.0706417
	speed: 0.1178s/iter; left time: 6382.4899s
	iters: 4000, epoch: 8 | loss: 0.0706924
	speed: 0.1169s/iter; left time: 6324.4682s
	iters: 4100, epoch: 8 | loss: 0.0704471
	speed: 0.1175s/iter; left time: 6342.1722s
	iters: 4200, epoch: 8 | loss: 0.0729290
	speed: 0.1144s/iter; left time: 6166.8255s
	iters: 4300, epoch: 8 | loss: 0.0735274
	speed: 0.1167s/iter; left time: 6279.3577s
	iters: 4400, epoch: 8 | loss: 0.0819775
	speed: 0.1163s/iter; left time: 6245.3451s
Epoch: 8 cost time: 00h:08m:39.75s
Epoch: 8 | Train Loss: 0.0784829 Vali Loss: 0.0906655 Test Loss: 0.1073768
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.0807247
	speed: 1.5920s/iter; left time: 85200.9096s
	iters: 200, epoch: 9 | loss: 0.0876306
	speed: 0.1159s/iter; left time: 6188.4256s
	iters: 300, epoch: 9 | loss: 0.0690702
	speed: 0.1141s/iter; left time: 6083.2244s
	iters: 400, epoch: 9 | loss: 0.0685977
	speed: 0.1155s/iter; left time: 6144.9507s
	iters: 500, epoch: 9 | loss: 0.1049898
	speed: 0.1168s/iter; left time: 6202.2266s
	iters: 600, epoch: 9 | loss: 0.0862811
	speed: 0.1132s/iter; left time: 5999.1441s
	iters: 700, epoch: 9 | loss: 0.0700331
	speed: 0.1152s/iter; left time: 6093.7406s
	iters: 800, epoch: 9 | loss: 0.0694490
	speed: 0.1144s/iter; left time: 6041.9345s
	iters: 900, epoch: 9 | loss: 0.0769776
	speed: 0.1146s/iter; left time: 6043.7254s
	iters: 1000, epoch: 9 | loss: 0.0690558
	speed: 0.1141s/iter; left time: 6005.1500s
	iters: 1100, epoch: 9 | loss: 0.0718805
	speed: 0.1166s/iter; left time: 6125.6806s
	iters: 1200, epoch: 9 | loss: 0.0790950
	speed: 0.1166s/iter; left time: 6113.3885s
	iters: 1300, epoch: 9 | loss: 0.0878323
	speed: 0.1139s/iter; left time: 5957.3476s
	iters: 1400, epoch: 9 | loss: 0.0601362
	speed: 0.1162s/iter; left time: 6066.5406s
	iters: 1500, epoch: 9 | loss: 0.0813463
	speed: 0.1156s/iter; left time: 6026.6967s
	iters: 1600, epoch: 9 | loss: 0.0808004
	speed: 0.1173s/iter; left time: 6101.3994s
	iters: 1700, epoch: 9 | loss: 0.0846742
	speed: 0.1160s/iter; left time: 6021.5311s
	iters: 1800, epoch: 9 | loss: 0.0694577
	speed: 0.1165s/iter; left time: 6037.4243s
	iters: 1900, epoch: 9 | loss: 0.0717922
	speed: 0.1162s/iter; left time: 6010.5074s
	iters: 2000, epoch: 9 | loss: 0.0688320
	speed: 0.1155s/iter; left time: 5960.9380s
	iters: 2100, epoch: 9 | loss: 0.0924541
	speed: 0.1158s/iter; left time: 5965.4880s
	iters: 2200, epoch: 9 | loss: 0.0821416
	speed: 0.1134s/iter; left time: 5831.2938s
	iters: 2300, epoch: 9 | loss: 0.0760271
	speed: 0.1136s/iter; left time: 5831.3681s
	iters: 2400, epoch: 9 | loss: 0.0767931
	speed: 0.1146s/iter; left time: 5867.6329s
	iters: 2500, epoch: 9 | loss: 0.0697705
	speed: 0.1166s/iter; left time: 5959.7000s
	iters: 2600, epoch: 9 | loss: 0.0924100
	speed: 0.1174s/iter; left time: 5988.3751s
	iters: 2700, epoch: 9 | loss: 0.0637605
	speed: 0.1151s/iter; left time: 5862.7900s
	iters: 2800, epoch: 9 | loss: 0.0797227
	speed: 0.1144s/iter; left time: 5814.0759s
	iters: 2900, epoch: 9 | loss: 0.0813500
	speed: 0.1136s/iter; left time: 5762.7865s
	iters: 3000, epoch: 9 | loss: 0.0780612
	speed: 0.1135s/iter; left time: 5746.4798s
	iters: 3100, epoch: 9 | loss: 0.0720700
	speed: 0.1135s/iter; left time: 5735.5167s
	iters: 3200, epoch: 9 | loss: 0.0765664
	speed: 0.1161s/iter; left time: 5855.5431s
	iters: 3300, epoch: 9 | loss: 0.0852109
	speed: 0.1160s/iter; left time: 5839.0464s
	iters: 3400, epoch: 9 | loss: 0.0872862
	speed: 0.1130s/iter; left time: 5674.4628s
	iters: 3500, epoch: 9 | loss: 0.0673751
	speed: 0.1135s/iter; left time: 5689.5537s
	iters: 3600, epoch: 9 | loss: 0.0731839
	speed: 0.1136s/iter; left time: 5680.6715s
	iters: 3700, epoch: 9 | loss: 0.0864574
	speed: 0.1145s/iter; left time: 5713.9607s
	iters: 3800, epoch: 9 | loss: 0.0817628
	speed: 0.1132s/iter; left time: 5638.7590s
	iters: 3900, epoch: 9 | loss: 0.0986147
	speed: 0.1148s/iter; left time: 5706.3174s
	iters: 4000, epoch: 9 | loss: 0.0703890
	speed: 0.1135s/iter; left time: 5632.6065s
	iters: 4100, epoch: 9 | loss: 0.0744173
	speed: 0.1171s/iter; left time: 5796.8049s
	iters: 4200, epoch: 9 | loss: 0.0785395
	speed: 0.1150s/iter; left time: 5681.7597s
	iters: 4300, epoch: 9 | loss: 0.0744364
	speed: 0.1147s/iter; left time: 5655.6415s
	iters: 4400, epoch: 9 | loss: 0.0595877
	speed: 0.1140s/iter; left time: 5610.7776s
Epoch: 9 cost time: 00h:08m:34.31s
Epoch: 9 | Train Loss: 0.0773867 Vali Loss: 0.0910278 Test Loss: 0.1069496
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 10 | loss: 0.0671151
	speed: 1.5785s/iter; left time: 77423.5353s
	iters: 200, epoch: 10 | loss: 0.0828441
	speed: 0.1145s/iter; left time: 5605.6839s
	iters: 300, epoch: 10 | loss: 0.0783897
	speed: 0.1136s/iter; left time: 5546.8106s
	iters: 400, epoch: 10 | loss: 0.0834453
	speed: 0.1153s/iter; left time: 5620.6085s
	iters: 500, epoch: 10 | loss: 0.0739451
	speed: 0.1143s/iter; left time: 5561.1659s
	iters: 600, epoch: 10 | loss: 0.0635547
	speed: 0.1166s/iter; left time: 5660.8866s
	iters: 700, epoch: 10 | loss: 0.0789368
	speed: 0.1144s/iter; left time: 5543.8684s
	iters: 800, epoch: 10 | loss: 0.0980061
	speed: 0.1155s/iter; left time: 5582.6527s
	iters: 900, epoch: 10 | loss: 0.0827744
	speed: 0.1135s/iter; left time: 5478.4677s
	iters: 1000, epoch: 10 | loss: 0.0858516
	speed: 0.1160s/iter; left time: 5586.9409s
	iters: 1100, epoch: 10 | loss: 0.0609591
	speed: 0.1159s/iter; left time: 5570.3575s
	iters: 1200, epoch: 10 | loss: 0.0810569
	speed: 0.1169s/iter; left time: 5603.0406s
	iters: 1300, epoch: 10 | loss: 0.0937729
	speed: 0.1171s/iter; left time: 5602.3511s
	iters: 1400, epoch: 10 | loss: 0.0835219
	speed: 0.1161s/iter; left time: 5545.6390s
	iters: 1500, epoch: 10 | loss: 0.0743610
	speed: 0.1172s/iter; left time: 5584.3104s
	iters: 1600, epoch: 10 | loss: 0.0712053
	speed: 0.1170s/iter; left time: 5562.3177s
	iters: 1700, epoch: 10 | loss: 0.0691880
	speed: 0.1129s/iter; left time: 5357.6994s
	iters: 1800, epoch: 10 | loss: 0.0734778
	speed: 0.1141s/iter; left time: 5404.1841s
	iters: 1900, epoch: 10 | loss: 0.0740059
	speed: 0.1151s/iter; left time: 5439.5805s
	iters: 2000, epoch: 10 | loss: 0.0803476
	speed: 0.1189s/iter; left time: 5607.9472s
	iters: 2100, epoch: 10 | loss: 0.0573778
	speed: 0.1133s/iter; left time: 5331.1378s
	iters: 2200, epoch: 10 | loss: 0.0633182
	speed: 0.1135s/iter; left time: 5330.4922s
	iters: 2300, epoch: 10 | loss: 0.0607398
	speed: 0.1139s/iter; left time: 5334.9009s
	iters: 2400, epoch: 10 | loss: 0.0995448
	speed: 0.1147s/iter; left time: 5363.4710s
	iters: 2500, epoch: 10 | loss: 0.0664814
	speed: 0.1141s/iter; left time: 5324.1224s
	iters: 2600, epoch: 10 | loss: 0.0725956
	speed: 0.1151s/iter; left time: 5357.9144s
	iters: 2700, epoch: 10 | loss: 0.0891252
	speed: 0.1147s/iter; left time: 5329.2590s
	iters: 2800, epoch: 10 | loss: 0.0708456
	speed: 0.1129s/iter; left time: 5231.2750s
	iters: 2900, epoch: 10 | loss: 0.0679720
	speed: 0.1145s/iter; left time: 5294.0154s
	iters: 3000, epoch: 10 | loss: 0.0656617
	speed: 0.1147s/iter; left time: 5293.4144s
	iters: 3100, epoch: 10 | loss: 0.0661887
	speed: 0.1137s/iter; left time: 5235.6263s
	iters: 3200, epoch: 10 | loss: 0.0758295
	speed: 0.1158s/iter; left time: 5322.2497s
	iters: 3300, epoch: 10 | loss: 0.0698776
	speed: 0.1148s/iter; left time: 5263.9330s
	iters: 3400, epoch: 10 | loss: 0.0789215
	speed: 0.1148s/iter; left time: 5251.9707s
	iters: 3500, epoch: 10 | loss: 0.0749588
	speed: 0.1140s/iter; left time: 5202.1299s
	iters: 3600, epoch: 10 | loss: 0.1019792
	speed: 0.1160s/iter; left time: 5285.0743s
	iters: 3700, epoch: 10 | loss: 0.0910538
	speed: 0.1161s/iter; left time: 5275.2146s
	iters: 3800, epoch: 10 | loss: 0.0882741
	speed: 0.1137s/iter; left time: 5154.9439s
	iters: 3900, epoch: 10 | loss: 0.0684295
	speed: 0.1169s/iter; left time: 5291.0654s
	iters: 4000, epoch: 10 | loss: 0.0834578
	speed: 0.1151s/iter; left time: 5197.8577s
	iters: 4100, epoch: 10 | loss: 0.0795520
	speed: 0.1142s/iter; left time: 5146.1165s
	iters: 4200, epoch: 10 | loss: 0.0775932
	speed: 0.1176s/iter; left time: 5286.7117s
	iters: 4300, epoch: 10 | loss: 0.0749520
	speed: 0.1152s/iter; left time: 5168.5459s
	iters: 4400, epoch: 10 | loss: 0.0773880
	speed: 0.1140s/iter; left time: 5103.3444s
Epoch: 10 cost time: 00h:08m:34.73s
Epoch: 10 | Train Loss: 0.0764753 Vali Loss: 0.0915059 Test Loss: 0.1088750
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.025583267211914062, rmse:0.1599477082490921, mae:0.10403311252593994, rse:0.5514940619468689
success delete checkpoints
Intermediate time for GB and pred_len 24: 01h:52m:46.62s

=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
train 142645
val 30725
test 30725
[2024-11-03 07:57:52,023] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-03 07:57:53,303] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-03 07:57:53,303] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-03 07:57:53,303] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-03 07:57:53,403] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-03 07:57:53,403] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-03 07:57:54,256] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-03 07:57:54,257] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-03 07:57:54,257] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-03 07:57:54,258] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-03 07:57:54,259] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-03 07:57:54,259] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-03 07:57:54,259] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-03 07:57:54,259] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-03 07:57:54,259] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-03 07:57:54,259] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-03 07:57:54,707] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-03 07:57:54,708] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-03 07:57:54,708] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 152.75 GB, percent = 20.2%
[2024-11-03 07:57:54,878] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-03 07:57:54,879] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 07:57:54,879] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 152.77 GB, percent = 20.2%
[2024-11-03 07:57:54,879] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-03 07:57:55,059] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-03 07:57:55,060] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 07:57:55,060] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 152.72 GB, percent = 20.2%
[2024-11-03 07:57:55,061] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-03 07:57:55,061] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-03 07:57:55,061] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-03 07:57:55,061] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-03 07:57:55,062] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f7a74e9add0>
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-03 07:57:55,063] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-03 07:57:55,064] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-03 07:57:55,065] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-03 07:57:55,065] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1688266
	speed: 0.1785s/iter; left time: 15893.5365s
	iters: 200, epoch: 1 | loss: 0.1466758
	speed: 0.1255s/iter; left time: 11163.3362s
	iters: 300, epoch: 1 | loss: 0.1657802
	speed: 0.1288s/iter; left time: 11443.9814s
	iters: 400, epoch: 1 | loss: 0.1365485
	speed: 0.1305s/iter; left time: 11583.9117s
	iters: 500, epoch: 1 | loss: 0.1343239
	speed: 0.1286s/iter; left time: 11396.9528s
	iters: 600, epoch: 1 | loss: 0.1273262
	speed: 0.1305s/iter; left time: 11555.1903s
	iters: 700, epoch: 1 | loss: 0.1142251
	speed: 0.1300s/iter; left time: 11495.5934s
	iters: 800, epoch: 1 | loss: 0.1129106
	speed: 0.1282s/iter; left time: 11327.4622s
	iters: 900, epoch: 1 | loss: 0.1081580
	speed: 0.1301s/iter; left time: 11483.9961s
	iters: 1000, epoch: 1 | loss: 0.1082976
	speed: 0.1288s/iter; left time: 11355.2133s
	iters: 1100, epoch: 1 | loss: 0.1104180
	speed: 0.1282s/iter; left time: 11289.5287s
	iters: 1200, epoch: 1 | loss: 0.1293156
	speed: 0.1285s/iter; left time: 11304.2771s
	iters: 1300, epoch: 1 | loss: 0.1199676
	speed: 0.1286s/iter; left time: 11298.3167s
	iters: 1400, epoch: 1 | loss: 0.0853492
	speed: 0.1277s/iter; left time: 11204.6884s
	iters: 1500, epoch: 1 | loss: 0.1185155
	speed: 0.1289s/iter; left time: 11294.9506s
	iters: 1600, epoch: 1 | loss: 0.1091379
	speed: 0.1280s/iter; left time: 11201.8787s
	iters: 1700, epoch: 1 | loss: 0.1387339
	speed: 0.1293s/iter; left time: 11306.8202s
	iters: 1800, epoch: 1 | loss: 0.1115096
	speed: 0.1266s/iter; left time: 11058.3400s
	iters: 1900, epoch: 1 | loss: 0.1182949
	speed: 0.1303s/iter; left time: 11364.1194s
	iters: 2000, epoch: 1 | loss: 0.1110286
	speed: 0.1287s/iter; left time: 11218.9095s
	iters: 2100, epoch: 1 | loss: 0.1118804
	speed: 0.1277s/iter; left time: 11113.0769s
	iters: 2200, epoch: 1 | loss: 0.1165919
	speed: 0.1274s/iter; left time: 11074.5511s
	iters: 2300, epoch: 1 | loss: 0.1117706
	speed: 0.1301s/iter; left time: 11299.2092s
	iters: 2400, epoch: 1 | loss: 0.1129438
	speed: 0.1294s/iter; left time: 11222.3812s
	iters: 2500, epoch: 1 | loss: 0.1135126
	speed: 0.1281s/iter; left time: 11096.9533s
	iters: 2600, epoch: 1 | loss: 0.1112166
	speed: 0.1286s/iter; left time: 11128.1423s
	iters: 2700, epoch: 1 | loss: 0.1203404
	speed: 0.1266s/iter; left time: 10943.4566s
	iters: 2800, epoch: 1 | loss: 0.1182374
	speed: 0.1295s/iter; left time: 11184.3534s
	iters: 2900, epoch: 1 | loss: 0.1069434
	speed: 0.1288s/iter; left time: 11103.8088s
	iters: 3000, epoch: 1 | loss: 0.1128676
	speed: 0.1270s/iter; left time: 10942.3124s
	iters: 3100, epoch: 1 | loss: 0.1112418
	speed: 0.1259s/iter; left time: 10836.4119s
	iters: 3200, epoch: 1 | loss: 0.1109535
	speed: 0.1280s/iter; left time: 11004.6363s
	iters: 3300, epoch: 1 | loss: 0.1022410
	speed: 0.1280s/iter; left time: 10991.1581s
	iters: 3400, epoch: 1 | loss: 0.1067109
	speed: 0.1288s/iter; left time: 11039.7652s
	iters: 3500, epoch: 1 | loss: 0.1093592
	speed: 0.1301s/iter; left time: 11142.3125s
	iters: 3600, epoch: 1 | loss: 0.1050644
	speed: 0.1300s/iter; left time: 11120.9045s
	iters: 3700, epoch: 1 | loss: 0.1453399
	speed: 0.1292s/iter; left time: 11037.9253s
	iters: 3800, epoch: 1 | loss: 0.1064153
	speed: 0.1306s/iter; left time: 11142.7100s
	iters: 3900, epoch: 1 | loss: 0.1275871
	speed: 0.1284s/iter; left time: 10940.9372s
	iters: 4000, epoch: 1 | loss: 0.1056856
	speed: 0.1266s/iter; left time: 10782.8795s
	iters: 4100, epoch: 1 | loss: 0.1163018
	speed: 0.1286s/iter; left time: 10939.7400s
	iters: 4200, epoch: 1 | loss: 0.1195716
	speed: 0.1284s/iter; left time: 10907.8794s
	iters: 4300, epoch: 1 | loss: 0.1011549
	speed: 0.1282s/iter; left time: 10878.4997s
	iters: 4400, epoch: 1 | loss: 0.1301714
	speed: 0.1273s/iter; left time: 10789.5248s
Epoch: 1 cost time: 00h:09m:34.14s
Epoch: 1 | Train Loss: 0.1159376 Vali Loss: 0.1171800 Test Loss: 0.1386980
Validation loss decreased (inf --> 0.117180).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.1323460
	speed: 1.8177s/iter; left time: 153750.1873s
	iters: 200, epoch: 2 | loss: 0.0998212
	speed: 0.1151s/iter; left time: 9726.5930s
	iters: 300, epoch: 2 | loss: 0.1072860
	speed: 0.1144s/iter; left time: 9650.6818s
	iters: 400, epoch: 2 | loss: 0.1047579
	speed: 0.1165s/iter; left time: 9817.5607s
	iters: 500, epoch: 2 | loss: 0.0988569
	speed: 0.1131s/iter; left time: 9518.1567s
	iters: 600, epoch: 2 | loss: 0.1400726
	speed: 0.1153s/iter; left time: 9696.2221s
	iters: 700, epoch: 2 | loss: 0.1279359
	speed: 0.1146s/iter; left time: 9621.8230s
	iters: 800, epoch: 2 | loss: 0.1120330
	speed: 0.1140s/iter; left time: 9561.5629s
	iters: 900, epoch: 2 | loss: 0.1051929
	speed: 0.1129s/iter; left time: 9458.3001s
	iters: 1000, epoch: 2 | loss: 0.1209462
	speed: 0.1157s/iter; left time: 9681.0412s
	iters: 1100, epoch: 2 | loss: 0.1275426
	speed: 0.1137s/iter; left time: 9505.8381s
	iters: 1200, epoch: 2 | loss: 0.1159983
	speed: 0.1157s/iter; left time: 9656.7284s
	iters: 1300, epoch: 2 | loss: 0.1053278
	speed: 0.1147s/iter; left time: 9564.5253s
	iters: 1400, epoch: 2 | loss: 0.0974504
	speed: 0.1146s/iter; left time: 9545.8152s
	iters: 1500, epoch: 2 | loss: 0.0961491
	speed: 0.1162s/iter; left time: 9668.4279s
	iters: 1600, epoch: 2 | loss: 0.1127011
	speed: 0.1150s/iter; left time: 9551.3628s
	iters: 1700, epoch: 2 | loss: 0.1136763
	speed: 0.1160s/iter; left time: 9629.7080s
	iters: 1800, epoch: 2 | loss: 0.1032368
	speed: 0.1138s/iter; left time: 9430.6147s
	iters: 1900, epoch: 2 | loss: 0.0907084
	speed: 0.1128s/iter; left time: 9339.1341s
	iters: 2000, epoch: 2 | loss: 0.1084257
	speed: 0.1156s/iter; left time: 9560.5969s
	iters: 2100, epoch: 2 | loss: 0.1318485
	speed: 0.1146s/iter; left time: 9465.4027s
	iters: 2200, epoch: 2 | loss: 0.1092268
	speed: 0.1150s/iter; left time: 9482.2905s
	iters: 2300, epoch: 2 | loss: 0.0971450
	speed: 0.1159s/iter; left time: 9546.3702s
	iters: 2400, epoch: 2 | loss: 0.1082254
	speed: 0.1141s/iter; left time: 9386.9575s
	iters: 2500, epoch: 2 | loss: 0.1057774
	speed: 0.1130s/iter; left time: 9288.2027s
	iters: 2600, epoch: 2 | loss: 0.1233867
	speed: 0.1132s/iter; left time: 9294.7662s
	iters: 2700, epoch: 2 | loss: 0.1121541
	speed: 0.1137s/iter; left time: 9322.9370s
	iters: 2800, epoch: 2 | loss: 0.1023491
	speed: 0.1140s/iter; left time: 9334.0303s
	iters: 2900, epoch: 2 | loss: 0.1325897
	speed: 0.1140s/iter; left time: 9320.0574s
	iters: 3000, epoch: 2 | loss: 0.0932151
	speed: 0.1154s/iter; left time: 9425.6305s
	iters: 3100, epoch: 2 | loss: 0.1183982
	speed: 0.1155s/iter; left time: 9426.6047s
	iters: 3200, epoch: 2 | loss: 0.1071068
	speed: 0.1148s/iter; left time: 9355.3898s
	iters: 3300, epoch: 2 | loss: 0.0916324
	speed: 0.1159s/iter; left time: 9432.0369s
	iters: 3400, epoch: 2 | loss: 0.0934265
	speed: 0.1107s/iter; left time: 8998.8114s
	iters: 3500, epoch: 2 | loss: 0.1121869
	speed: 0.1131s/iter; left time: 9182.5247s
	iters: 3600, epoch: 2 | loss: 0.1178536
	speed: 0.1135s/iter; left time: 9204.1838s
	iters: 3700, epoch: 2 | loss: 0.1048463
	speed: 0.1135s/iter; left time: 9189.4847s
	iters: 3800, epoch: 2 | loss: 0.1119690
	speed: 0.1135s/iter; left time: 9180.8183s
	iters: 3900, epoch: 2 | loss: 0.1302823
	speed: 0.1146s/iter; left time: 9255.9061s
	iters: 4000, epoch: 2 | loss: 0.1027673
	speed: 0.1133s/iter; left time: 9141.1086s
	iters: 4100, epoch: 2 | loss: 0.1058483
	speed: 0.1124s/iter; left time: 9057.8689s
	iters: 4200, epoch: 2 | loss: 0.1003960
	speed: 0.1139s/iter; left time: 9169.8420s
	iters: 4300, epoch: 2 | loss: 0.0997679
	speed: 0.1143s/iter; left time: 9190.6403s
	iters: 4400, epoch: 2 | loss: 0.1080339
	speed: 0.1127s/iter; left time: 9048.9508s
Epoch: 2 cost time: 00h:08m:30.12s
Epoch: 2 | Train Loss: 0.1063434 Vali Loss: 0.1159233 Test Loss: 0.1404574
Validation loss decreased (0.117180 --> 0.115923).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0953313
	speed: 1.5298s/iter; left time: 122579.7741s
	iters: 200, epoch: 3 | loss: 0.0960641
	speed: 0.1129s/iter; left time: 9037.5760s
	iters: 300, epoch: 3 | loss: 0.1168496
	speed: 0.1128s/iter; left time: 9018.4111s
	iters: 400, epoch: 3 | loss: 0.1128009
	speed: 0.1139s/iter; left time: 9091.4012s
	iters: 500, epoch: 3 | loss: 0.1003084
	speed: 0.1134s/iter; left time: 9037.9726s
	iters: 600, epoch: 3 | loss: 0.1153115
	speed: 0.1150s/iter; left time: 9153.9593s
	iters: 700, epoch: 3 | loss: 0.1167073
	speed: 0.1128s/iter; left time: 8969.6655s
	iters: 800, epoch: 3 | loss: 0.1098146
	speed: 0.1131s/iter; left time: 8983.1531s
	iters: 900, epoch: 3 | loss: 0.0888241
	speed: 0.1131s/iter; left time: 8970.7544s
	iters: 1000, epoch: 3 | loss: 0.0963814
	speed: 0.1139s/iter; left time: 9022.4195s
	iters: 1100, epoch: 3 | loss: 0.1247230
	speed: 0.1133s/iter; left time: 8968.2897s
	iters: 1200, epoch: 3 | loss: 0.1112344
	speed: 0.1125s/iter; left time: 8891.8323s
	iters: 1300, epoch: 3 | loss: 0.1090816
	speed: 0.1131s/iter; left time: 8923.5137s
	iters: 1400, epoch: 3 | loss: 0.1014220
	speed: 0.1129s/iter; left time: 8897.4957s
	iters: 1500, epoch: 3 | loss: 0.1205137
	speed: 0.1142s/iter; left time: 8989.3578s
	iters: 1600, epoch: 3 | loss: 0.0969793
	speed: 0.1143s/iter; left time: 8985.5839s
	iters: 1700, epoch: 3 | loss: 0.1139035
	speed: 0.1153s/iter; left time: 9057.3622s
	iters: 1800, epoch: 3 | loss: 0.1128580
	speed: 0.1135s/iter; left time: 8903.3702s
	iters: 1900, epoch: 3 | loss: 0.1043471
	speed: 0.1139s/iter; left time: 8917.9254s
	iters: 2000, epoch: 3 | loss: 0.0987270
	speed: 0.1139s/iter; left time: 8912.4455s
	iters: 2100, epoch: 3 | loss: 0.0881278
	speed: 0.1126s/iter; left time: 8796.8159s
	iters: 2200, epoch: 3 | loss: 0.1081288
	speed: 0.1120s/iter; left time: 8738.4418s
	iters: 2300, epoch: 3 | loss: 0.0976076
	speed: 0.1126s/iter; left time: 8772.7511s
	iters: 2400, epoch: 3 | loss: 0.0961220
	speed: 0.1128s/iter; left time: 8775.3532s
	iters: 2500, epoch: 3 | loss: 0.0965293
	speed: 0.1127s/iter; left time: 8760.7689s
	iters: 2600, epoch: 3 | loss: 0.1095369
	speed: 0.1120s/iter; left time: 8697.7938s
	iters: 2700, epoch: 3 | loss: 0.1212904
	speed: 0.1144s/iter; left time: 8865.4812s
	iters: 2800, epoch: 3 | loss: 0.1003948
	speed: 0.1133s/iter; left time: 8775.0465s
	iters: 2900, epoch: 3 | loss: 0.1081474
	speed: 0.1133s/iter; left time: 8761.8701s
	iters: 3000, epoch: 3 | loss: 0.1015081
	speed: 0.1129s/iter; left time: 8715.9515s
	iters: 3100, epoch: 3 | loss: 0.0989254
	speed: 0.1135s/iter; left time: 8754.3035s
	iters: 3200, epoch: 3 | loss: 0.1039556
	speed: 0.1128s/iter; left time: 8692.0616s
	iters: 3300, epoch: 3 | loss: 0.0903572
	speed: 0.1132s/iter; left time: 8709.2199s
	iters: 3400, epoch: 3 | loss: 0.0759418
	speed: 0.1130s/iter; left time: 8682.8255s
	iters: 3500, epoch: 3 | loss: 0.1176762
	speed: 0.1120s/iter; left time: 8595.1412s
	iters: 3600, epoch: 3 | loss: 0.0941180
	speed: 0.1109s/iter; left time: 8494.2782s
	iters: 3700, epoch: 3 | loss: 0.1044800
	speed: 0.1118s/iter; left time: 8553.7069s
	iters: 3800, epoch: 3 | loss: 0.1119280
	speed: 0.1118s/iter; left time: 8543.0616s
	iters: 3900, epoch: 3 | loss: 0.1174034
	speed: 0.1113s/iter; left time: 8495.1171s
	iters: 4000, epoch: 3 | loss: 0.0906112
	speed: 0.1126s/iter; left time: 8584.3571s
	iters: 4100, epoch: 3 | loss: 0.1110326
	speed: 0.1132s/iter; left time: 8617.3934s
	iters: 4200, epoch: 3 | loss: 0.1211934
	speed: 0.1132s/iter; left time: 8603.3143s
	iters: 4300, epoch: 3 | loss: 0.1134209
	speed: 0.1138s/iter; left time: 8643.2430s
	iters: 4400, epoch: 3 | loss: 0.0881434
	speed: 0.1132s/iter; left time: 8582.5215s
Epoch: 3 cost time: 00h:08m:24.63s
Epoch: 3 | Train Loss: 0.1022726 Vali Loss: 0.1180037 Test Loss: 0.1440704
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0873546
	speed: 1.5100s/iter; left time: 114263.3071s
	iters: 200, epoch: 4 | loss: 0.1036950
	speed: 0.1139s/iter; left time: 8609.2430s
	iters: 300, epoch: 4 | loss: 0.0934119
	speed: 0.1139s/iter; left time: 8593.5786s
	iters: 400, epoch: 4 | loss: 0.1056632
	speed: 0.1150s/iter; left time: 8664.7593s
	iters: 500, epoch: 4 | loss: 0.0883508
	speed: 0.1135s/iter; left time: 8540.5182s
	iters: 600, epoch: 4 | loss: 0.0899846
	speed: 0.1128s/iter; left time: 8478.9874s
	iters: 700, epoch: 4 | loss: 0.0998617
	speed: 0.1132s/iter; left time: 8494.6099s
	iters: 800, epoch: 4 | loss: 0.0895698
	speed: 0.1122s/iter; left time: 8408.1319s
	iters: 900, epoch: 4 | loss: 0.1108057
	speed: 0.1133s/iter; left time: 8481.2006s
	iters: 1000, epoch: 4 | loss: 0.1005503
	speed: 0.1139s/iter; left time: 8514.6839s
	iters: 1100, epoch: 4 | loss: 0.0851609
	speed: 0.1138s/iter; left time: 8497.9852s
	iters: 1200, epoch: 4 | loss: 0.0922965
	speed: 0.1133s/iter; left time: 8452.3653s
	iters: 1300, epoch: 4 | loss: 0.0940839
	speed: 0.1130s/iter; left time: 8413.9763s
	iters: 1400, epoch: 4 | loss: 0.0969528
	speed: 0.1134s/iter; left time: 8436.9304s
	iters: 1500, epoch: 4 | loss: 0.0909017
	speed: 0.1125s/iter; left time: 8358.9278s
	iters: 1600, epoch: 4 | loss: 0.0886021
	speed: 0.1141s/iter; left time: 8463.9709s
	iters: 1700, epoch: 4 | loss: 0.0961353
	speed: 0.1132s/iter; left time: 8384.6226s
	iters: 1800, epoch: 4 | loss: 0.0882971
	speed: 0.1139s/iter; left time: 8427.3077s
	iters: 1900, epoch: 4 | loss: 0.0977799
	speed: 0.1143s/iter; left time: 8446.6530s
	iters: 2000, epoch: 4 | loss: 0.0880991
	speed: 0.1126s/iter; left time: 8309.3337s
	iters: 2100, epoch: 4 | loss: 0.0910579
	speed: 0.1132s/iter; left time: 8340.1650s
	iters: 2200, epoch: 4 | loss: 0.0977751
	speed: 0.1129s/iter; left time: 8305.7125s
	iters: 2300, epoch: 4 | loss: 0.0931557
	speed: 0.1141s/iter; left time: 8380.7850s
	iters: 2400, epoch: 4 | loss: 0.1089414
	speed: 0.1128s/iter; left time: 8275.7434s
	iters: 2500, epoch: 4 | loss: 0.1060289
	speed: 0.1136s/iter; left time: 8326.6336s
	iters: 2600, epoch: 4 | loss: 0.0834869
	speed: 0.1109s/iter; left time: 8113.2451s
	iters: 2700, epoch: 4 | loss: 0.1122872
	speed: 0.1139s/iter; left time: 8325.9781s
	iters: 2800, epoch: 4 | loss: 0.0878354
	speed: 0.1136s/iter; left time: 8292.4274s
	iters: 2900, epoch: 4 | loss: 0.0907886
	speed: 0.1146s/iter; left time: 8353.3154s
	iters: 3000, epoch: 4 | loss: 0.0977618
	speed: 0.1131s/iter; left time: 8230.6683s
	iters: 3100, epoch: 4 | loss: 0.0923466
	speed: 0.1129s/iter; left time: 8204.9562s
	iters: 3200, epoch: 4 | loss: 0.0991563
	speed: 0.1173s/iter; left time: 8508.9227s
	iters: 3300, epoch: 4 | loss: 0.1049987
	speed: 0.1162s/iter; left time: 8419.4591s
	iters: 3400, epoch: 4 | loss: 0.0708893
	speed: 0.1140s/iter; left time: 8252.0366s
	iters: 3500, epoch: 4 | loss: 0.0792143
	speed: 0.1137s/iter; left time: 8215.6924s
	iters: 3600, epoch: 4 | loss: 0.0895646
	speed: 0.1126s/iter; left time: 8129.8788s
	iters: 3700, epoch: 4 | loss: 0.1049187
	speed: 0.1127s/iter; left time: 8124.3975s
	iters: 3800, epoch: 4 | loss: 0.0842904
	speed: 0.1129s/iter; left time: 8126.8559s
	iters: 3900, epoch: 4 | loss: 0.0941178
	speed: 0.1108s/iter; left time: 7961.7936s
	iters: 4000, epoch: 4 | loss: 0.1109897
	speed: 0.1139s/iter; left time: 8177.1761s
	iters: 4100, epoch: 4 | loss: 0.1001586
	speed: 0.1125s/iter; left time: 8065.4055s
	iters: 4200, epoch: 4 | loss: 0.1093832
	speed: 0.1127s/iter; left time: 8068.1410s
	iters: 4300, epoch: 4 | loss: 0.0876529
	speed: 0.1123s/iter; left time: 8028.4879s
	iters: 4400, epoch: 4 | loss: 0.0952323
	speed: 0.1132s/iter; left time: 8081.8479s
Epoch: 4 cost time: 00h:08m:25.73s
Epoch: 4 | Train Loss: 0.0973941 Vali Loss: 0.1181420 Test Loss: 0.1481285
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0899206
	speed: 1.5235s/iter; left time: 108491.2324s
	iters: 200, epoch: 5 | loss: 0.1038604
	speed: 0.1154s/iter; left time: 8205.3218s
	iters: 300, epoch: 5 | loss: 0.1103195
	speed: 0.1156s/iter; left time: 8207.7192s
	iters: 400, epoch: 5 | loss: 0.0988987
	speed: 0.1153s/iter; left time: 8173.8791s
	iters: 500, epoch: 5 | loss: 0.1051342
	speed: 0.1136s/iter; left time: 8046.3911s
	iters: 600, epoch: 5 | loss: 0.0994484
	speed: 0.1174s/iter; left time: 8298.3677s
	iters: 700, epoch: 5 | loss: 0.0807362
	speed: 0.1152s/iter; left time: 8132.8384s
	iters: 800, epoch: 5 | loss: 0.1006454
	speed: 0.1152s/iter; left time: 8125.9078s
	iters: 900, epoch: 5 | loss: 0.1117228
	speed: 0.1140s/iter; left time: 8025.7115s
	iters: 1000, epoch: 5 | loss: 0.0958334
	speed: 0.1154s/iter; left time: 8114.8124s
	iters: 1100, epoch: 5 | loss: 0.0945488
	speed: 0.1149s/iter; left time: 8068.0753s
	iters: 1200, epoch: 5 | loss: 0.0999299
	speed: 0.1168s/iter; left time: 8190.4201s
	iters: 1300, epoch: 5 | loss: 0.0833874
	speed: 0.1151s/iter; left time: 8061.9571s
	iters: 1400, epoch: 5 | loss: 0.0800731
	speed: 0.1166s/iter; left time: 8150.3149s
	iters: 1500, epoch: 5 | loss: 0.0873000
	speed: 0.1170s/iter; left time: 8169.8289s
	iters: 1600, epoch: 5 | loss: 0.0974982
	speed: 0.1148s/iter; left time: 8005.9197s
	iters: 1700, epoch: 5 | loss: 0.0832424
	speed: 0.1148s/iter; left time: 7990.4724s
	iters: 1800, epoch: 5 | loss: 0.0964874
	speed: 0.1142s/iter; left time: 7938.4620s
	iters: 1900, epoch: 5 | loss: 0.1015488
	speed: 0.1148s/iter; left time: 7971.9532s
	iters: 2000, epoch: 5 | loss: 0.0962706
	speed: 0.1139s/iter; left time: 7893.5208s
	iters: 2100, epoch: 5 | loss: 0.0944651
	speed: 0.1158s/iter; left time: 8014.9157s
	iters: 2200, epoch: 5 | loss: 0.0883529
	speed: 0.1142s/iter; left time: 7892.4674s
	iters: 2300, epoch: 5 | loss: 0.0954471
	speed: 0.1152s/iter; left time: 7952.3328s
	iters: 2400, epoch: 5 | loss: 0.0827175
	speed: 0.1146s/iter; left time: 7899.6119s
	iters: 2500, epoch: 5 | loss: 0.1006347
	speed: 0.1144s/iter; left time: 7870.0949s
	iters: 2600, epoch: 5 | loss: 0.0951255
	speed: 0.1165s/iter; left time: 8005.8141s
	iters: 2700, epoch: 5 | loss: 0.1033527
	speed: 0.1175s/iter; left time: 8060.1569s
	iters: 2800, epoch: 5 | loss: 0.0756043
	speed: 0.1147s/iter; left time: 7858.7596s
	iters: 2900, epoch: 5 | loss: 0.0850169
	speed: 0.1152s/iter; left time: 7882.4580s
	iters: 3000, epoch: 5 | loss: 0.1090293
	speed: 0.1144s/iter; left time: 7814.8763s
	iters: 3100, epoch: 5 | loss: 0.0975026
	speed: 0.1145s/iter; left time: 7813.4333s
	iters: 3200, epoch: 5 | loss: 0.0954872
	speed: 0.1149s/iter; left time: 7823.0406s
	iters: 3300, epoch: 5 | loss: 0.0834685
	speed: 0.1166s/iter; left time: 7931.9783s
	iters: 3400, epoch: 5 | loss: 0.0841382
	speed: 0.1164s/iter; left time: 7902.3602s
	iters: 3500, epoch: 5 | loss: 0.0745072
	speed: 0.1160s/iter; left time: 7863.0053s
	iters: 3600, epoch: 5 | loss: 0.1053615
	speed: 0.1157s/iter; left time: 7837.6776s
	iters: 3700, epoch: 5 | loss: 0.0791975
	speed: 0.1165s/iter; left time: 7879.8089s
	iters: 3800, epoch: 5 | loss: 0.0998375
	speed: 0.1157s/iter; left time: 7814.3196s
	iters: 3900, epoch: 5 | loss: 0.0949914
	speed: 0.1157s/iter; left time: 7801.0721s
	iters: 4000, epoch: 5 | loss: 0.0968361
	speed: 0.1149s/iter; left time: 7735.8557s
	iters: 4100, epoch: 5 | loss: 0.0942416
	speed: 0.1143s/iter; left time: 7685.6907s
	iters: 4200, epoch: 5 | loss: 0.1008289
	speed: 0.1138s/iter; left time: 7634.2870s
	iters: 4300, epoch: 5 | loss: 0.0779671
	speed: 0.1151s/iter; left time: 7711.2709s
	iters: 4400, epoch: 5 | loss: 0.0973403
	speed: 0.1155s/iter; left time: 7725.3286s
Epoch: 5 cost time: 00h:08m:34.07s
Epoch: 5 | Train Loss: 0.0930669 Vali Loss: 0.1177695 Test Loss: 0.1494393
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0950565
	speed: 1.5478s/iter; left time: 103326.1281s
	iters: 200, epoch: 6 | loss: 0.0880194
	speed: 0.1140s/iter; left time: 7598.5819s
	iters: 300, epoch: 6 | loss: 0.0845609
	speed: 0.1146s/iter; left time: 7628.5804s
	iters: 400, epoch: 6 | loss: 0.0856797
	speed: 0.1171s/iter; left time: 7784.0110s
	iters: 500, epoch: 6 | loss: 0.0811084
	speed: 0.1152s/iter; left time: 7641.6682s
	iters: 600, epoch: 6 | loss: 0.1066922
	speed: 0.1153s/iter; left time: 7640.4823s
	iters: 700, epoch: 6 | loss: 0.0946200
	speed: 0.1154s/iter; left time: 7632.8492s
	iters: 800, epoch: 6 | loss: 0.1000760
	speed: 0.1148s/iter; left time: 7581.1448s
	iters: 900, epoch: 6 | loss: 0.0695545
	speed: 0.1170s/iter; left time: 7717.6166s
	iters: 1000, epoch: 6 | loss: 0.1009072
	speed: 0.1155s/iter; left time: 7606.8553s
	iters: 1100, epoch: 6 | loss: 0.0820811
	speed: 0.1148s/iter; left time: 7547.9258s
	iters: 1200, epoch: 6 | loss: 0.1012075
	speed: 0.1142s/iter; left time: 7495.7848s
	iters: 1300, epoch: 6 | loss: 0.0863402
	speed: 0.1158s/iter; left time: 7588.2879s
	iters: 1400, epoch: 6 | loss: 0.0826545
	speed: 0.1159s/iter; left time: 7587.4863s
	iters: 1500, epoch: 6 | loss: 0.0777465
	speed: 0.1156s/iter; left time: 7557.8843s
	iters: 1600, epoch: 6 | loss: 0.1057802
	speed: 0.1166s/iter; left time: 7611.9507s
	iters: 1700, epoch: 6 | loss: 0.0942861
	speed: 0.1162s/iter; left time: 7569.9625s
	iters: 1800, epoch: 6 | loss: 0.0920153
	speed: 0.1164s/iter; left time: 7574.8956s
	iters: 1900, epoch: 6 | loss: 0.0782236
	speed: 0.1161s/iter; left time: 7542.9847s
	iters: 2000, epoch: 6 | loss: 0.0907045
	speed: 0.1116s/iter; left time: 7237.2041s
	iters: 2100, epoch: 6 | loss: 0.0759282
	speed: 0.1137s/iter; left time: 7359.8177s
	iters: 2200, epoch: 6 | loss: 0.1017066
	speed: 0.1148s/iter; left time: 7422.9566s
	iters: 2300, epoch: 6 | loss: 0.0679502
	speed: 0.1181s/iter; left time: 7621.3176s
	iters: 2400, epoch: 6 | loss: 0.0776927
	speed: 0.1167s/iter; left time: 7525.2174s
	iters: 2500, epoch: 6 | loss: 0.0888472
	speed: 0.1147s/iter; left time: 7383.1680s
	iters: 2600, epoch: 6 | loss: 0.0768875
	speed: 0.1166s/iter; left time: 7491.8912s
	iters: 2700, epoch: 6 | loss: 0.0782935
	speed: 0.1167s/iter; left time: 7489.6762s
	iters: 2800, epoch: 6 | loss: 0.0903737
	speed: 0.1143s/iter; left time: 7319.0551s
	iters: 2900, epoch: 6 | loss: 0.1004810
	speed: 0.1151s/iter; left time: 7362.3392s
	iters: 3000, epoch: 6 | loss: 0.0948790
	speed: 0.1163s/iter; left time: 7428.4829s
	iters: 3100, epoch: 6 | loss: 0.0886455
	speed: 0.1128s/iter; left time: 7194.6490s
	iters: 3200, epoch: 6 | loss: 0.0854608
	speed: 0.1158s/iter; left time: 7370.2266s
	iters: 3300, epoch: 6 | loss: 0.0769016
	speed: 0.1162s/iter; left time: 7384.1257s
	iters: 3400, epoch: 6 | loss: 0.0817375
	speed: 0.1164s/iter; left time: 7384.1548s
	iters: 3500, epoch: 6 | loss: 0.0888851
	speed: 0.1152s/iter; left time: 7295.7853s
	iters: 3600, epoch: 6 | loss: 0.0727457
	speed: 0.1156s/iter; left time: 7311.4228s
	iters: 3700, epoch: 6 | loss: 0.0903441
	speed: 0.1161s/iter; left time: 7334.4639s
	iters: 3800, epoch: 6 | loss: 0.0950212
	speed: 0.1164s/iter; left time: 7338.4941s
	iters: 3900, epoch: 6 | loss: 0.0870087
	speed: 0.1164s/iter; left time: 7330.3570s
	iters: 4000, epoch: 6 | loss: 0.0871792
	speed: 0.1141s/iter; left time: 7170.3075s
	iters: 4100, epoch: 6 | loss: 0.0932686
	speed: 0.1145s/iter; left time: 7187.2149s
	iters: 4200, epoch: 6 | loss: 0.0874465
	speed: 0.1179s/iter; left time: 7389.2674s
	iters: 4300, epoch: 6 | loss: 0.0889675
	speed: 0.1146s/iter; left time: 7171.8204s
	iters: 4400, epoch: 6 | loss: 0.0926063
	speed: 0.1141s/iter; left time: 7129.0473s
Epoch: 6 cost time: 00h:08m:35.30s
Epoch: 6 | Train Loss: 0.0893757 Vali Loss: 0.1196648 Test Loss: 0.1541289
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.1048594
	speed: 1.5670s/iter; left time: 97624.5618s
	iters: 200, epoch: 7 | loss: 0.0843566
	speed: 0.1158s/iter; left time: 7202.4942s
	iters: 300, epoch: 7 | loss: 0.0917804
	speed: 0.1159s/iter; left time: 7197.7076s
	iters: 400, epoch: 7 | loss: 0.0795149
	speed: 0.1163s/iter; left time: 7208.8362s
	iters: 500, epoch: 7 | loss: 0.0842911
	speed: 0.1164s/iter; left time: 7204.4799s
	iters: 600, epoch: 7 | loss: 0.0841490
	speed: 0.1165s/iter; left time: 7197.0453s
	iters: 700, epoch: 7 | loss: 0.1009502
	speed: 0.1176s/iter; left time: 7256.1310s
	iters: 800, epoch: 7 | loss: 0.0739675
	speed: 0.1168s/iter; left time: 7195.5046s
	iters: 900, epoch: 7 | loss: 0.0888571
	speed: 0.1167s/iter; left time: 7176.0577s
	iters: 1000, epoch: 7 | loss: 0.0870971
	speed: 0.1167s/iter; left time: 7162.7047s
	iters: 1100, epoch: 7 | loss: 0.0928913
	speed: 0.1164s/iter; left time: 7136.7999s
	iters: 1200, epoch: 7 | loss: 0.0886939
	speed: 0.1136s/iter; left time: 6953.2413s
	iters: 1300, epoch: 7 | loss: 0.0893422
	speed: 0.1159s/iter; left time: 7082.8468s
	iters: 1400, epoch: 7 | loss: 0.0847866
	speed: 0.1163s/iter; left time: 7092.0799s
	iters: 1500, epoch: 7 | loss: 0.0769473
	speed: 0.1159s/iter; left time: 7060.6891s
	iters: 1600, epoch: 7 | loss: 0.0924601
	speed: 0.1148s/iter; left time: 6981.6211s
	iters: 1700, epoch: 7 | loss: 0.0808676
	speed: 0.1129s/iter; left time: 6850.2870s
	iters: 1800, epoch: 7 | loss: 0.0922723
	speed: 0.1167s/iter; left time: 7071.4805s
	iters: 1900, epoch: 7 | loss: 0.0814242
	speed: 0.1156s/iter; left time: 6992.7185s
	iters: 2000, epoch: 7 | loss: 0.0870774
	speed: 0.1151s/iter; left time: 6950.2598s
	iters: 2100, epoch: 7 | loss: 0.0811431
	speed: 0.1156s/iter; left time: 6970.0987s
	iters: 2200, epoch: 7 | loss: 0.0951526
	speed: 0.1132s/iter; left time: 6812.4758s
	iters: 2300, epoch: 7 | loss: 0.0774082
	speed: 0.1148s/iter; left time: 6898.2062s
	iters: 2400, epoch: 7 | loss: 0.0838267
	speed: 0.1152s/iter; left time: 6909.5983s
	iters: 2500, epoch: 7 | loss: 0.0840728
	speed: 0.1140s/iter; left time: 6825.7495s
	iters: 2600, epoch: 7 | loss: 0.0857305
	speed: 0.1154s/iter; left time: 6900.0571s
	iters: 2700, epoch: 7 | loss: 0.0911212
	speed: 0.1161s/iter; left time: 6931.8133s
	iters: 2800, epoch: 7 | loss: 0.0788338
	speed: 0.1136s/iter; left time: 6770.5995s
	iters: 2900, epoch: 7 | loss: 0.0812203
	speed: 0.1129s/iter; left time: 6717.0057s
	iters: 3000, epoch: 7 | loss: 0.0968771
	speed: 0.1153s/iter; left time: 6846.5521s
	iters: 3100, epoch: 7 | loss: 0.0815360
	speed: 0.1158s/iter; left time: 6866.4748s
	iters: 3200, epoch: 7 | loss: 0.0820606
	speed: 0.1159s/iter; left time: 6862.3245s
	iters: 3300, epoch: 7 | loss: 0.0775566
	speed: 0.1134s/iter; left time: 6703.6955s
	iters: 3400, epoch: 7 | loss: 0.1014951
	speed: 0.1149s/iter; left time: 6777.4195s
	iters: 3500, epoch: 7 | loss: 0.0893218
	speed: 0.1148s/iter; left time: 6759.9584s
	iters: 3600, epoch: 7 | loss: 0.0940796
	speed: 0.1172s/iter; left time: 6888.9346s
	iters: 3700, epoch: 7 | loss: 0.0836638
	speed: 0.1131s/iter; left time: 6636.1693s
	iters: 3800, epoch: 7 | loss: 0.1027704
	speed: 0.1150s/iter; left time: 6736.3065s
	iters: 3900, epoch: 7 | loss: 0.0680492
	speed: 0.1139s/iter; left time: 6663.9134s
	iters: 4000, epoch: 7 | loss: 0.1034615
	speed: 0.1145s/iter; left time: 6683.8426s
	iters: 4100, epoch: 7 | loss: 0.0949323
	speed: 0.1138s/iter; left time: 6632.1384s
	iters: 4200, epoch: 7 | loss: 0.0865043
	speed: 0.1150s/iter; left time: 6693.9101s
	iters: 4300, epoch: 7 | loss: 0.0960433
	speed: 0.1149s/iter; left time: 6677.9859s
	iters: 4400, epoch: 7 | loss: 0.0965981
	speed: 0.1142s/iter; left time: 6624.5261s
Epoch: 7 cost time: 00h:08m:34.14s
Epoch: 7 | Train Loss: 0.0862290 Vali Loss: 0.1190629 Test Loss: 0.1528910
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.04200141876935959, rmse:0.2049424797296524, mae:0.14045733213424683, rse:0.7086868286132812
success delete checkpoints
Intermediate time for GB and pred_len 96: 01h:18m:33.66s

=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
train 142285
val 30365
test 30365
[2024-11-03 09:16:27,227] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-03 09:16:28,647] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-03 09:16:28,647] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-03 09:16:28,648] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-03 09:16:28,773] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-03 09:16:28,773] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-03 09:16:29,576] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-03 09:16:29,577] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-03 09:16:29,577] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-03 09:16:29,579] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-03 09:16:29,579] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-03 09:16:29,579] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-03 09:16:29,579] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-03 09:16:29,579] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-03 09:16:29,579] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-03 09:16:29,579] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-03 09:16:29,986] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-03 09:16:29,987] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-03 09:16:29,988] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 161.5 GB, percent = 21.4%
[2024-11-03 09:16:30,171] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-03 09:16:30,172] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.74 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-03 09:16:30,172] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 161.51 GB, percent = 21.4%
[2024-11-03 09:16:30,172] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-03 09:16:30,348] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-03 09:16:30,349] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-03 09:16:30,349] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 161.51 GB, percent = 21.4%
[2024-11-03 09:16:30,350] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-03 09:16:30,351] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-03 09:16:30,351] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-03 09:16:30,351] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-03 09:16:30,352] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-03 09:16:30,352] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-03 09:16:30,352] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-03 09:16:30,352] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-03 09:16:30,352] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f80738ae1d0>
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-03 09:16:30,353] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-03 09:16:30,354] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-03 09:16:30,354] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-03 09:16:30,354] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-03 09:16:30,354] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-03 09:16:30,354] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-03 09:16:30,354] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-03 09:16:30,354] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-03 09:16:30,354] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-03 09:16:30,354] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-03 09:16:30,354] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-03 09:16:30,354] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-03 09:16:30,355] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-03 09:16:30,356] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-03 09:16:30,356] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-03 09:16:30,356] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-03 09:16:30,356] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-03 09:16:30,356] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-03 09:16:30,356] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-03 09:16:30,356] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-03 09:16:30,356] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-03 09:16:30,356] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-03 09:16:30,356] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-03 09:16:30,356] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-03 09:16:30,356] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-03 09:16:30,356] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1482348
	speed: 0.1806s/iter; left time: 16043.0744s
	iters: 200, epoch: 1 | loss: 0.1453139
	speed: 0.1298s/iter; left time: 11516.6845s
	iters: 300, epoch: 1 | loss: 0.1553313
	speed: 0.1296s/iter; left time: 11486.2147s
	iters: 400, epoch: 1 | loss: 0.1554058
	speed: 0.1298s/iter; left time: 11493.2830s
	iters: 500, epoch: 1 | loss: 0.1471658
	speed: 0.1276s/iter; left time: 11279.4548s
	iters: 600, epoch: 1 | loss: 0.1542638
	speed: 0.1299s/iter; left time: 11473.4496s
	iters: 700, epoch: 1 | loss: 0.1336013
	speed: 0.1302s/iter; left time: 11485.4159s
	iters: 800, epoch: 1 | loss: 0.1162374
	speed: 0.1307s/iter; left time: 11521.5088s
	iters: 900, epoch: 1 | loss: 0.1247154
	speed: 0.1290s/iter; left time: 11358.7186s
	iters: 1000, epoch: 1 | loss: 0.1020275
	speed: 0.1299s/iter; left time: 11422.7040s
	iters: 1100, epoch: 1 | loss: 0.1375454
	speed: 0.1282s/iter; left time: 11259.6940s
	iters: 1200, epoch: 1 | loss: 0.1161896
	speed: 0.1314s/iter; left time: 11523.9214s
	iters: 1300, epoch: 1 | loss: 0.1136029
	speed: 0.1286s/iter; left time: 11267.5807s
	iters: 1400, epoch: 1 | loss: 0.1167578
	speed: 0.1286s/iter; left time: 11253.9748s
	iters: 1500, epoch: 1 | loss: 0.1177376
	speed: 0.1304s/iter; left time: 11401.8118s
	iters: 1600, epoch: 1 | loss: 0.1085610
	speed: 0.1304s/iter; left time: 11385.5133s
	iters: 1700, epoch: 1 | loss: 0.1154755
	speed: 0.1287s/iter; left time: 11223.4444s
	iters: 1800, epoch: 1 | loss: 0.0951475
	speed: 0.1291s/iter; left time: 11248.3587s
	iters: 1900, epoch: 1 | loss: 0.1343727
	speed: 0.1315s/iter; left time: 11440.2881s
	iters: 2000, epoch: 1 | loss: 0.1305830
	speed: 0.1288s/iter; left time: 11194.6836s
	iters: 2100, epoch: 1 | loss: 0.1169467
	speed: 0.1273s/iter; left time: 11050.9776s
	iters: 2200, epoch: 1 | loss: 0.1000786
	speed: 0.1265s/iter; left time: 10966.5075s
	iters: 2300, epoch: 1 | loss: 0.0901878
	speed: 0.1276s/iter; left time: 11055.7600s
	iters: 2400, epoch: 1 | loss: 0.1336366
	speed: 0.1273s/iter; left time: 11016.1030s
	iters: 2500, epoch: 1 | loss: 0.1131255
	speed: 0.1289s/iter; left time: 11142.5916s
	iters: 2600, epoch: 1 | loss: 0.1157848
	speed: 0.1275s/iter; left time: 11003.2673s
	iters: 2700, epoch: 1 | loss: 0.1087803
	speed: 0.1296s/iter; left time: 11171.4330s
	iters: 2800, epoch: 1 | loss: 0.1142708
	speed: 0.1293s/iter; left time: 11135.9459s
	iters: 2900, epoch: 1 | loss: 0.1243213
	speed: 0.1301s/iter; left time: 11193.6051s
	iters: 3000, epoch: 1 | loss: 0.0919846
	speed: 0.1320s/iter; left time: 11342.2288s
	iters: 3100, epoch: 1 | loss: 0.1445014
	speed: 0.1291s/iter; left time: 11081.8479s
	iters: 3200, epoch: 1 | loss: 0.0993669
	speed: 0.1289s/iter; left time: 11046.5269s
	iters: 3300, epoch: 1 | loss: 0.1163438
	speed: 0.1293s/iter; left time: 11069.4295s
	iters: 3400, epoch: 1 | loss: 0.1209128
	speed: 0.1283s/iter; left time: 10975.8670s
	iters: 3500, epoch: 1 | loss: 0.0993587
	speed: 0.1268s/iter; left time: 10831.2122s
	iters: 3600, epoch: 1 | loss: 0.1136707
	speed: 0.1281s/iter; left time: 10929.0588s
	iters: 3700, epoch: 1 | loss: 0.1139015
	speed: 0.1290s/iter; left time: 10996.0999s
	iters: 3800, epoch: 1 | loss: 0.1168825
	speed: 0.1306s/iter; left time: 11112.7088s
	iters: 3900, epoch: 1 | loss: 0.1059878
	speed: 0.1280s/iter; left time: 10882.4153s
	iters: 4000, epoch: 1 | loss: 0.1127900
	speed: 0.1280s/iter; left time: 10865.7985s
	iters: 4100, epoch: 1 | loss: 0.1130453
	speed: 0.1272s/iter; left time: 10787.6265s
	iters: 4200, epoch: 1 | loss: 0.1120209
	speed: 0.1293s/iter; left time: 10953.2413s
	iters: 4300, epoch: 1 | loss: 0.1165368
	speed: 0.1280s/iter; left time: 10831.6520s
	iters: 4400, epoch: 1 | loss: 0.1169618
	speed: 0.1292s/iter; left time: 10917.5637s
Epoch: 1 cost time: 00h:09m:35.04s
Epoch: 1 | Train Loss: 0.1205897 Vali Loss: 0.1209952 Test Loss: 0.1438364
Validation loss decreased (inf --> 0.120995).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.1197857
	speed: 1.8114s/iter; left time: 152836.4726s
	iters: 200, epoch: 2 | loss: 0.1099122
	speed: 0.1168s/iter; left time: 9845.0516s
	iters: 300, epoch: 2 | loss: 0.1050249
	speed: 0.1172s/iter; left time: 9866.8842s
	iters: 400, epoch: 2 | loss: 0.1127598
	speed: 0.1170s/iter; left time: 9837.4411s
	iters: 500, epoch: 2 | loss: 0.0847004
	speed: 0.1180s/iter; left time: 9909.6726s
	iters: 600, epoch: 2 | loss: 0.1266375
	speed: 0.1166s/iter; left time: 9776.1746s
	iters: 700, epoch: 2 | loss: 0.1209411
	speed: 0.1175s/iter; left time: 9841.5933s
	iters: 800, epoch: 2 | loss: 0.1068922
	speed: 0.1167s/iter; left time: 9763.5481s
	iters: 900, epoch: 2 | loss: 0.0993572
	speed: 0.1166s/iter; left time: 9743.6605s
	iters: 1000, epoch: 2 | loss: 0.1088792
	speed: 0.1193s/iter; left time: 9954.9116s
	iters: 1100, epoch: 2 | loss: 0.1103762
	speed: 0.1184s/iter; left time: 9871.9279s
	iters: 1200, epoch: 2 | loss: 0.1110987
	speed: 0.1178s/iter; left time: 9809.1376s
	iters: 1300, epoch: 2 | loss: 0.0816215
	speed: 0.1163s/iter; left time: 9669.8693s
	iters: 1400, epoch: 2 | loss: 0.1149543
	speed: 0.1170s/iter; left time: 9723.7857s
	iters: 1500, epoch: 2 | loss: 0.1127167
	speed: 0.1155s/iter; left time: 9583.8694s
	iters: 1600, epoch: 2 | loss: 0.1143629
	speed: 0.1171s/iter; left time: 9706.3140s
	iters: 1700, epoch: 2 | loss: 0.1134126
	speed: 0.1158s/iter; left time: 9581.8043s
	iters: 1800, epoch: 2 | loss: 0.1078830
	speed: 0.1166s/iter; left time: 9640.7901s
	iters: 1900, epoch: 2 | loss: 0.0992961
	speed: 0.1160s/iter; left time: 9576.2030s
	iters: 2000, epoch: 2 | loss: 0.1067948
	speed: 0.1166s/iter; left time: 9617.4982s
	iters: 2100, epoch: 2 | loss: 0.1038578
	speed: 0.1145s/iter; left time: 9432.7129s
	iters: 2200, epoch: 2 | loss: 0.1177262
	speed: 0.1165s/iter; left time: 9584.8832s
	iters: 2300, epoch: 2 | loss: 0.1152344
	speed: 0.1140s/iter; left time: 9365.2021s
	iters: 2400, epoch: 2 | loss: 0.1077954
	speed: 0.1157s/iter; left time: 9498.0317s
	iters: 2500, epoch: 2 | loss: 0.1127032
	speed: 0.1171s/iter; left time: 9602.6803s
	iters: 2600, epoch: 2 | loss: 0.1118686
	speed: 0.1122s/iter; left time: 9184.2086s
	iters: 2700, epoch: 2 | loss: 0.1096208
	speed: 0.1129s/iter; left time: 9234.7673s
	iters: 2800, epoch: 2 | loss: 0.0965174
	speed: 0.1125s/iter; left time: 9190.5343s
	iters: 2900, epoch: 2 | loss: 0.1007073
	speed: 0.1129s/iter; left time: 9208.9160s
	iters: 3000, epoch: 2 | loss: 0.0923950
	speed: 0.1153s/iter; left time: 9395.5281s
	iters: 3100, epoch: 2 | loss: 0.1115430
	speed: 0.1138s/iter; left time: 9260.0025s
	iters: 3200, epoch: 2 | loss: 0.1126868
	speed: 0.1146s/iter; left time: 9311.4516s
	iters: 3300, epoch: 2 | loss: 0.1034839
	speed: 0.1118s/iter; left time: 9072.6644s
	iters: 3400, epoch: 2 | loss: 0.1078405
	speed: 0.1113s/iter; left time: 9022.3053s
	iters: 3500, epoch: 2 | loss: 0.1037599
	speed: 0.1137s/iter; left time: 9208.3424s
	iters: 3600, epoch: 2 | loss: 0.0952058
	speed: 0.1122s/iter; left time: 9076.4295s
	iters: 3700, epoch: 2 | loss: 0.1051804
	speed: 0.1120s/iter; left time: 9045.5504s
	iters: 3800, epoch: 2 | loss: 0.1044087
	speed: 0.1130s/iter; left time: 9113.2990s
	iters: 3900, epoch: 2 | loss: 0.1066130
	speed: 0.1147s/iter; left time: 9241.7066s
	iters: 4000, epoch: 2 | loss: 0.1092677
	speed: 0.1133s/iter; left time: 9121.1625s
	iters: 4100, epoch: 2 | loss: 0.1083696
	speed: 0.1133s/iter; left time: 9110.3547s
	iters: 4200, epoch: 2 | loss: 0.1197105
	speed: 0.1132s/iter; left time: 9089.6904s
	iters: 4300, epoch: 2 | loss: 0.1068081
	speed: 0.1117s/iter; left time: 8954.9869s
	iters: 4400, epoch: 2 | loss: 0.1261329
	speed: 0.1128s/iter; left time: 9030.0277s
Epoch: 2 cost time: 00h:08m:32.27s
Epoch: 2 | Train Loss: 0.1098766 Vali Loss: 0.1225332 Test Loss: 0.1477604
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0998430
	speed: 1.5405s/iter; left time: 123129.9321s
	iters: 200, epoch: 3 | loss: 0.1029584
	speed: 0.1128s/iter; left time: 9008.1590s
	iters: 300, epoch: 3 | loss: 0.0965041
	speed: 0.1161s/iter; left time: 9253.1586s
	iters: 400, epoch: 3 | loss: 0.1077358
	speed: 0.1167s/iter; left time: 9291.2182s
	iters: 500, epoch: 3 | loss: 0.1056079
	speed: 0.1153s/iter; left time: 9165.7626s
	iters: 600, epoch: 3 | loss: 0.1190159
	speed: 0.1167s/iter; left time: 9271.6581s
	iters: 700, epoch: 3 | loss: 0.1028953
	speed: 0.1166s/iter; left time: 9248.6437s
	iters: 800, epoch: 3 | loss: 0.1252995
	speed: 0.1160s/iter; left time: 9193.5876s
	iters: 900, epoch: 3 | loss: 0.0910322
	speed: 0.1143s/iter; left time: 9045.1347s
	iters: 1000, epoch: 3 | loss: 0.1096593
	speed: 0.1166s/iter; left time: 9214.4819s
	iters: 1100, epoch: 3 | loss: 0.0958329
	speed: 0.1161s/iter; left time: 9163.4822s
	iters: 1200, epoch: 3 | loss: 0.1051666
	speed: 0.1139s/iter; left time: 8978.8459s
	iters: 1300, epoch: 3 | loss: 0.1145009
	speed: 0.1157s/iter; left time: 9111.8886s
	iters: 1400, epoch: 3 | loss: 0.1089370
	speed: 0.1166s/iter; left time: 9170.4829s
	iters: 1500, epoch: 3 | loss: 0.0982486
	speed: 0.1153s/iter; left time: 9055.8982s
	iters: 1600, epoch: 3 | loss: 0.1116064
	speed: 0.1162s/iter; left time: 9112.0542s
	iters: 1700, epoch: 3 | loss: 0.1152646
	speed: 0.1147s/iter; left time: 8981.9711s
	iters: 1800, epoch: 3 | loss: 0.1033108
	speed: 0.1157s/iter; left time: 9047.4058s
	iters: 1900, epoch: 3 | loss: 0.1160483
	speed: 0.1145s/iter; left time: 8942.6018s
	iters: 2000, epoch: 3 | loss: 0.1133725
	speed: 0.1152s/iter; left time: 8988.5962s
	iters: 2100, epoch: 3 | loss: 0.0946887
	speed: 0.1162s/iter; left time: 9056.8138s
	iters: 2200, epoch: 3 | loss: 0.1068842
	speed: 0.1158s/iter; left time: 9008.9040s
	iters: 2300, epoch: 3 | loss: 0.1091909
	speed: 0.1141s/iter; left time: 8869.8343s
	iters: 2400, epoch: 3 | loss: 0.0988755
	speed: 0.1144s/iter; left time: 8880.5515s
	iters: 2500, epoch: 3 | loss: 0.0938124
	speed: 0.1152s/iter; left time: 8929.7448s
	iters: 2600, epoch: 3 | loss: 0.1091160
	speed: 0.1153s/iter; left time: 8929.1321s
	iters: 2700, epoch: 3 | loss: 0.1095193
	speed: 0.1152s/iter; left time: 8908.6028s
	iters: 2800, epoch: 3 | loss: 0.1060785
	speed: 0.1142s/iter; left time: 8823.2657s
	iters: 2900, epoch: 3 | loss: 0.0896944
	speed: 0.1151s/iter; left time: 8875.4527s
	iters: 3000, epoch: 3 | loss: 0.0934717
	speed: 0.1164s/iter; left time: 8969.1079s
	iters: 3100, epoch: 3 | loss: 0.1221983
	speed: 0.1152s/iter; left time: 8861.5937s
	iters: 3200, epoch: 3 | loss: 0.0963738
	speed: 0.1147s/iter; left time: 8815.4265s
	iters: 3300, epoch: 3 | loss: 0.1190489
	speed: 0.1161s/iter; left time: 8908.4538s
	iters: 3400, epoch: 3 | loss: 0.1036496
	speed: 0.1165s/iter; left time: 8928.5374s
	iters: 3500, epoch: 3 | loss: 0.1124387
	speed: 0.1168s/iter; left time: 8939.4267s
	iters: 3600, epoch: 3 | loss: 0.1170041
	speed: 0.1155s/iter; left time: 8827.6652s
	iters: 3700, epoch: 3 | loss: 0.1089111
	speed: 0.1159s/iter; left time: 8850.0768s
	iters: 3800, epoch: 3 | loss: 0.0951907
	speed: 0.1147s/iter; left time: 8746.3940s
	iters: 3900, epoch: 3 | loss: 0.0979321
	speed: 0.1144s/iter; left time: 8706.1174s
	iters: 4000, epoch: 3 | loss: 0.0999806
	speed: 0.1163s/iter; left time: 8842.1246s
	iters: 4100, epoch: 3 | loss: 0.0940368
	speed: 0.1148s/iter; left time: 8719.9476s
	iters: 4200, epoch: 3 | loss: 0.0999659
	speed: 0.1162s/iter; left time: 8810.3419s
	iters: 4300, epoch: 3 | loss: 0.0951753
	speed: 0.1153s/iter; left time: 8732.1293s
	iters: 4400, epoch: 3 | loss: 0.0947775
	speed: 0.1145s/iter; left time: 8662.4110s
Epoch: 3 cost time: 00h:08m:33.85s
Epoch: 3 | Train Loss: 0.1043304 Vali Loss: 0.1245715 Test Loss: 0.1501074
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0944092
	speed: 1.5497s/iter; left time: 116975.3279s
	iters: 200, epoch: 4 | loss: 0.0867483
	speed: 0.1149s/iter; left time: 8658.0705s
	iters: 300, epoch: 4 | loss: 0.1064334
	speed: 0.1155s/iter; left time: 8698.3918s
	iters: 400, epoch: 4 | loss: 0.0956620
	speed: 0.1158s/iter; left time: 8705.6986s
	iters: 500, epoch: 4 | loss: 0.1117885
	speed: 0.1166s/iter; left time: 8758.2921s
	iters: 600, epoch: 4 | loss: 0.1063067
	speed: 0.1150s/iter; left time: 8626.7746s
	iters: 700, epoch: 4 | loss: 0.0915639
	speed: 0.1156s/iter; left time: 8655.7974s
	iters: 800, epoch: 4 | loss: 0.1026455
	speed: 0.1153s/iter; left time: 8624.9928s
	iters: 900, epoch: 4 | loss: 0.1035407
	speed: 0.1159s/iter; left time: 8652.7572s
	iters: 1000, epoch: 4 | loss: 0.1075997
	speed: 0.1163s/iter; left time: 8675.9252s
	iters: 1100, epoch: 4 | loss: 0.0891981
	speed: 0.1140s/iter; left time: 8491.5195s
	iters: 1200, epoch: 4 | loss: 0.1041374
	speed: 0.1134s/iter; left time: 8438.0519s
	iters: 1300, epoch: 4 | loss: 0.1022310
	speed: 0.1133s/iter; left time: 8418.8444s
	iters: 1400, epoch: 4 | loss: 0.1072065
	speed: 0.1122s/iter; left time: 8324.7086s
	iters: 1500, epoch: 4 | loss: 0.0838472
	speed: 0.1134s/iter; left time: 8403.0457s
	iters: 1600, epoch: 4 | loss: 0.0923450
	speed: 0.1137s/iter; left time: 8410.4056s
	iters: 1700, epoch: 4 | loss: 0.1015804
	speed: 0.1152s/iter; left time: 8511.1904s
	iters: 1800, epoch: 4 | loss: 0.1218250
	speed: 0.1150s/iter; left time: 8486.1731s
	iters: 1900, epoch: 4 | loss: 0.1150391
	speed: 0.1155s/iter; left time: 8510.3849s
	iters: 2000, epoch: 4 | loss: 0.1164713
	speed: 0.1148s/iter; left time: 8449.4671s
	iters: 2100, epoch: 4 | loss: 0.1034276
	speed: 0.1131s/iter; left time: 8312.4625s
	iters: 2200, epoch: 4 | loss: 0.0898664
	speed: 0.1181s/iter; left time: 8665.1293s
	iters: 2300, epoch: 4 | loss: 0.0815171
	speed: 0.1187s/iter; left time: 8698.5061s
	iters: 2400, epoch: 4 | loss: 0.1059342
	speed: 0.1173s/iter; left time: 8586.7144s
	iters: 2500, epoch: 4 | loss: 0.1042058
	speed: 0.1165s/iter; left time: 8515.5548s
	iters: 2600, epoch: 4 | loss: 0.0878983
	speed: 0.1162s/iter; left time: 8481.3466s
	iters: 2700, epoch: 4 | loss: 0.0832504
	speed: 0.1187s/iter; left time: 8649.1016s
	iters: 2800, epoch: 4 | loss: 0.0833858
	speed: 0.1179s/iter; left time: 8580.0004s
	iters: 2900, epoch: 4 | loss: 0.1033833
	speed: 0.1149s/iter; left time: 8354.4193s
	iters: 3000, epoch: 4 | loss: 0.0952015
	speed: 0.1168s/iter; left time: 8477.1869s
	iters: 3100, epoch: 4 | loss: 0.0781978
	speed: 0.1149s/iter; left time: 8326.1763s
	iters: 3200, epoch: 4 | loss: 0.1017636
	speed: 0.1138s/iter; left time: 8238.4425s
	iters: 3300, epoch: 4 | loss: 0.1010068
	speed: 0.1156s/iter; left time: 8357.3458s
	iters: 3400, epoch: 4 | loss: 0.1017999
	speed: 0.1184s/iter; left time: 8548.1644s
	iters: 3500, epoch: 4 | loss: 0.0878085
	speed: 0.1168s/iter; left time: 8419.6193s
	iters: 3600, epoch: 4 | loss: 0.0985364
	speed: 0.1170s/iter; left time: 8422.9713s
	iters: 3700, epoch: 4 | loss: 0.0910970
	speed: 0.1139s/iter; left time: 8190.7131s
	iters: 3800, epoch: 4 | loss: 0.0913839
	speed: 0.1141s/iter; left time: 8192.0792s
	iters: 3900, epoch: 4 | loss: 0.0918390
	speed: 0.1143s/iter; left time: 8189.9435s
	iters: 4000, epoch: 4 | loss: 0.1008365
	speed: 0.1174s/iter; left time: 8401.5474s
	iters: 4100, epoch: 4 | loss: 0.0926459
	speed: 0.1177s/iter; left time: 8410.5593s
	iters: 4200, epoch: 4 | loss: 0.0991397
	speed: 0.1154s/iter; left time: 8239.6806s
	iters: 4300, epoch: 4 | loss: 0.0954166
	speed: 0.1142s/iter; left time: 8141.7228s
	iters: 4400, epoch: 4 | loss: 0.0878920
	speed: 0.1161s/iter; left time: 8266.2998s
Epoch: 4 cost time: 00h:08m:34.28s
Epoch: 4 | Train Loss: 0.0984264 Vali Loss: 0.1281532 Test Loss: 0.1525455
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.1027972
	speed: 1.5516s/iter; left time: 110220.2287s
	iters: 200, epoch: 5 | loss: 0.1047456
	speed: 0.1157s/iter; left time: 8208.4461s
	iters: 300, epoch: 5 | loss: 0.0907510
	speed: 0.1167s/iter; left time: 8265.7405s
	iters: 400, epoch: 5 | loss: 0.0943936
	speed: 0.1172s/iter; left time: 8292.2366s
	iters: 500, epoch: 5 | loss: 0.0821496
	speed: 0.1161s/iter; left time: 8200.0644s
	iters: 600, epoch: 5 | loss: 0.0936060
	speed: 0.1160s/iter; left time: 8185.4850s
	iters: 700, epoch: 5 | loss: 0.0996595
	speed: 0.1171s/iter; left time: 8250.5821s
	iters: 800, epoch: 5 | loss: 0.0979459
	speed: 0.1154s/iter; left time: 8119.3812s
	iters: 900, epoch: 5 | loss: 0.1001264
	speed: 0.1133s/iter; left time: 7958.2826s
	iters: 1000, epoch: 5 | loss: 0.1090219
	speed: 0.1141s/iter; left time: 8005.5584s
	iters: 1100, epoch: 5 | loss: 0.1011967
	speed: 0.1139s/iter; left time: 7978.4549s
	iters: 1200, epoch: 5 | loss: 0.0915010
	speed: 0.1158s/iter; left time: 8096.2294s
	iters: 1300, epoch: 5 | loss: 0.1061302
	speed: 0.1162s/iter; left time: 8116.5520s
	iters: 1400, epoch: 5 | loss: 0.1118270
	speed: 0.1164s/iter; left time: 8118.4551s
	iters: 1500, epoch: 5 | loss: 0.0901711
	speed: 0.1157s/iter; left time: 8055.1593s
	iters: 1600, epoch: 5 | loss: 0.0990031
	speed: 0.1164s/iter; left time: 8095.2933s
	iters: 1700, epoch: 5 | loss: 0.1073154
	speed: 0.1151s/iter; left time: 7990.1939s
	iters: 1800, epoch: 5 | loss: 0.0957215
	speed: 0.1146s/iter; left time: 7948.0382s
	iters: 1900, epoch: 5 | loss: 0.0969568
	speed: 0.1147s/iter; left time: 7938.2746s
	iters: 2000, epoch: 5 | loss: 0.1063399
	speed: 0.1152s/iter; left time: 7965.5585s
	iters: 2100, epoch: 5 | loss: 0.1092876
	speed: 0.1184s/iter; left time: 8170.8366s
	iters: 2200, epoch: 5 | loss: 0.0891375
	speed: 0.1147s/iter; left time: 7910.2817s
	iters: 2300, epoch: 5 | loss: 0.0779103
	speed: 0.1175s/iter; left time: 8087.8896s
	iters: 2400, epoch: 5 | loss: 0.0807228
	speed: 0.1168s/iter; left time: 8025.9800s
	iters: 2500, epoch: 5 | loss: 0.0742790
	speed: 0.1168s/iter; left time: 8016.6586s
	iters: 2600, epoch: 5 | loss: 0.0908970
	speed: 0.1147s/iter; left time: 7858.3526s
	iters: 2700, epoch: 5 | loss: 0.1129368
	speed: 0.1143s/iter; left time: 7820.8059s
	iters: 2800, epoch: 5 | loss: 0.0733277
	speed: 0.1184s/iter; left time: 8090.8699s
	iters: 2900, epoch: 5 | loss: 0.1080936
	speed: 0.1183s/iter; left time: 8070.8115s
	iters: 3000, epoch: 5 | loss: 0.0774377
	speed: 0.1167s/iter; left time: 7949.2214s
	iters: 3100, epoch: 5 | loss: 0.0847868
	speed: 0.1155s/iter; left time: 7861.0918s
	iters: 3200, epoch: 5 | loss: 0.0902236
	speed: 0.1149s/iter; left time: 7805.2258s
	iters: 3300, epoch: 5 | loss: 0.0947069
	speed: 0.1163s/iter; left time: 7886.0970s
	iters: 3400, epoch: 5 | loss: 0.0958610
	speed: 0.1161s/iter; left time: 7863.7970s
	iters: 3500, epoch: 5 | loss: 0.0908997
	speed: 0.1148s/iter; left time: 7767.2626s
	iters: 3600, epoch: 5 | loss: 0.0939663
	speed: 0.1141s/iter; left time: 7708.7375s
	iters: 3700, epoch: 5 | loss: 0.0827342
	speed: 0.1151s/iter; left time: 7761.5226s
	iters: 3800, epoch: 5 | loss: 0.1009660
	speed: 0.1139s/iter; left time: 7667.6180s
	iters: 3900, epoch: 5 | loss: 0.0889867
	speed: 0.1142s/iter; left time: 7681.4587s
	iters: 4000, epoch: 5 | loss: 0.0949150
	speed: 0.1134s/iter; left time: 7613.2535s
	iters: 4100, epoch: 5 | loss: 0.1014487
	speed: 0.1142s/iter; left time: 7656.9560s
	iters: 4200, epoch: 5 | loss: 0.0968869
	speed: 0.1153s/iter; left time: 7716.1146s
	iters: 4300, epoch: 5 | loss: 0.0901529
	speed: 0.1157s/iter; left time: 7732.6608s
	iters: 4400, epoch: 5 | loss: 0.0915154
	speed: 0.1180s/iter; left time: 7871.9444s
Epoch: 5 cost time: 00h:08m:34.78s
Epoch: 5 | Train Loss: 0.0934047 Vali Loss: 0.1274233 Test Loss: 0.1514446
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0924059
	speed: 1.5476s/iter; left time: 103055.2063s
	iters: 200, epoch: 6 | loss: 0.0953507
	speed: 0.1191s/iter; left time: 7915.8442s
	iters: 300, epoch: 6 | loss: 0.0743414
	speed: 0.1163s/iter; left time: 7718.9871s
	iters: 400, epoch: 6 | loss: 0.0888031
	speed: 0.1185s/iter; left time: 7852.1903s
	iters: 500, epoch: 6 | loss: 0.1043609
	speed: 0.1168s/iter; left time: 7733.2412s
	iters: 600, epoch: 6 | loss: 0.0847825
	speed: 0.1188s/iter; left time: 7854.5862s
	iters: 700, epoch: 6 | loss: 0.1001649
	speed: 0.1176s/iter; left time: 7758.1293s
	iters: 800, epoch: 6 | loss: 0.1008426
	speed: 0.1162s/iter; left time: 7657.0937s
	iters: 900, epoch: 6 | loss: 0.0914951
	speed: 0.1168s/iter; left time: 7683.7625s
	iters: 1000, epoch: 6 | loss: 0.0961552
	speed: 0.1188s/iter; left time: 7801.7333s
	iters: 1100, epoch: 6 | loss: 0.0863231
	speed: 0.1186s/iter; left time: 7781.1236s
	iters: 1200, epoch: 6 | loss: 0.0925186
	speed: 0.1202s/iter; left time: 7871.2631s
	iters: 1300, epoch: 6 | loss: 0.0857735
	speed: 0.1174s/iter; left time: 7675.7391s
	iters: 1400, epoch: 6 | loss: 0.0983386
	speed: 0.1202s/iter; left time: 7851.0174s
	iters: 1500, epoch: 6 | loss: 0.0876124
	speed: 0.1204s/iter; left time: 7846.9987s
	iters: 1600, epoch: 6 | loss: 0.0781590
	speed: 0.1156s/iter; left time: 7526.7923s
	iters: 1700, epoch: 6 | loss: 0.0933763
	speed: 0.1205s/iter; left time: 7832.0395s
	iters: 1800, epoch: 6 | loss: 0.0982791
	speed: 0.1149s/iter; left time: 7454.8488s
	iters: 1900, epoch: 6 | loss: 0.0728418
	speed: 0.1143s/iter; left time: 7402.4854s
	iters: 2000, epoch: 6 | loss: 0.0914764
	speed: 0.1159s/iter; left time: 7497.4194s
	iters: 2100, epoch: 6 | loss: 0.0815687
	speed: 0.1173s/iter; left time: 7575.4451s
	iters: 2200, epoch: 6 | loss: 0.0897236
	speed: 0.1172s/iter; left time: 7557.0015s
	iters: 2300, epoch: 6 | loss: 0.0844050
	speed: 0.1166s/iter; left time: 7508.0284s
	iters: 2400, epoch: 6 | loss: 0.0881767
	speed: 0.1161s/iter; left time: 7461.0308s
	iters: 2500, epoch: 6 | loss: 0.0834182
	speed: 0.1222s/iter; left time: 7841.6178s
	iters: 2600, epoch: 6 | loss: 0.0942059
	speed: 0.1146s/iter; left time: 7342.8139s
	iters: 2700, epoch: 6 | loss: 0.0970327
	speed: 0.1168s/iter; left time: 7472.0707s
	iters: 2800, epoch: 6 | loss: 0.0989593
	speed: 0.1172s/iter; left time: 7486.8818s
	iters: 2900, epoch: 6 | loss: 0.0968164
	speed: 0.1192s/iter; left time: 7603.9717s
	iters: 3000, epoch: 6 | loss: 0.0916561
	speed: 0.1167s/iter; left time: 7429.6563s
	iters: 3100, epoch: 6 | loss: 0.0938281
	speed: 0.1172s/iter; left time: 7455.4710s
	iters: 3200, epoch: 6 | loss: 0.0751842
	speed: 0.1199s/iter; left time: 7613.1808s
	iters: 3300, epoch: 6 | loss: 0.0846767
	speed: 0.1195s/iter; left time: 7572.9081s
	iters: 3400, epoch: 6 | loss: 0.0979014
	speed: 0.1223s/iter; left time: 7737.9127s
	iters: 3500, epoch: 6 | loss: 0.0967091
	speed: 0.1144s/iter; left time: 7230.6336s
	iters: 3600, epoch: 6 | loss: 0.0888710
	speed: 0.1178s/iter; left time: 7430.2501s
	iters: 3700, epoch: 6 | loss: 0.0812877
	speed: 0.1143s/iter; left time: 7198.5841s
	iters: 3800, epoch: 6 | loss: 0.0757051
	speed: 0.1140s/iter; left time: 7168.3648s
	iters: 3900, epoch: 6 | loss: 0.0898106
	speed: 0.1154s/iter; left time: 7244.5771s
	iters: 4000, epoch: 6 | loss: 0.1019688
	speed: 0.1157s/iter; left time: 7252.7306s
	iters: 4100, epoch: 6 | loss: 0.0886026
	speed: 0.1212s/iter; left time: 7585.3348s
	iters: 4200, epoch: 6 | loss: 0.0841476
	speed: 0.1170s/iter; left time: 7309.4672s
	iters: 4300, epoch: 6 | loss: 0.0868416
	speed: 0.1157s/iter; left time: 7217.7561s
	iters: 4400, epoch: 6 | loss: 0.0976313
	speed: 0.1141s/iter; left time: 7107.8399s
Epoch: 6 cost time: 00h:08m:42.56s
Epoch: 6 | Train Loss: 0.0896105 Vali Loss: 0.1277131 Test Loss: 0.1531950
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.04277150332927704, rmse:0.20681272447109222, mae:0.14383640885353088, rse:0.7167763113975525
success delete checkpoints
Intermediate time for GB and pred_len 168: 01h:08m:23.04s
Intermediate time for GB: 04h:19m:43.32s

=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
train 85803
val 18651
test 18651
[2024-11-03 10:24:52,917] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-03 10:24:54,700] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-03 10:24:54,700] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-03 10:24:54,700] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-03 10:24:54,895] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-03 10:24:54,895] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-03 10:24:55,670] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-03 10:24:55,671] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-03 10:24:55,672] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-03 10:24:55,673] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-03 10:24:55,673] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-03 10:24:55,673] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-03 10:24:55,673] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-03 10:24:55,673] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-03 10:24:55,673] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-03 10:24:55,673] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-03 10:24:56,136] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-03 10:24:56,138] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-03 10:24:56,138] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 162.22 GB, percent = 21.5%
[2024-11-03 10:24:56,274] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-03 10:24:56,275] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 10:24:56,275] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 162.16 GB, percent = 21.5%
[2024-11-03 10:24:56,275] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-03 10:24:56,398] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-03 10:24:56,399] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 10:24:56,399] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 162.13 GB, percent = 21.5%
[2024-11-03 10:24:56,400] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-03 10:24:56,400] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-03 10:24:56,400] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-03 10:24:56,400] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-03 10:24:56,401] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-03 10:24:56,401] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-03 10:24:56,401] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-03 10:24:56,401] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-03 10:24:56,401] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-03 10:24:56,401] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-03 10:24:56,401] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-03 10:24:56,401] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-03 10:24:56,401] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-03 10:24:56,401] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-03 10:24:56,401] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-03 10:24:56,401] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f755575a050>
[2024-11-03 10:24:56,401] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-03 10:24:56,401] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-03 10:24:56,402] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-03 10:24:56,403] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-03 10:24:56,403] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1790063
	speed: 0.1804s/iter; left time: 9654.8354s
	iters: 200, epoch: 1 | loss: 0.1687252
	speed: 0.1288s/iter; left time: 6882.6025s
	iters: 300, epoch: 1 | loss: 0.1309537
	speed: 0.1273s/iter; left time: 6785.8478s
	iters: 400, epoch: 1 | loss: 0.1245550
	speed: 0.1274s/iter; left time: 6779.2307s
	iters: 500, epoch: 1 | loss: 0.1051500
	speed: 0.1296s/iter; left time: 6883.5540s
	iters: 600, epoch: 1 | loss: 0.0886984
	speed: 0.1291s/iter; left time: 6847.2720s
	iters: 700, epoch: 1 | loss: 0.0941334
	speed: 0.1298s/iter; left time: 6866.7539s
	iters: 800, epoch: 1 | loss: 0.0780938
	speed: 0.1254s/iter; left time: 6625.6681s
	iters: 900, epoch: 1 | loss: 0.0840373
	speed: 0.1287s/iter; left time: 6784.1158s
	iters: 1000, epoch: 1 | loss: 0.0893998
	speed: 0.1293s/iter; left time: 6803.2337s
	iters: 1100, epoch: 1 | loss: 0.0767727
	speed: 0.1283s/iter; left time: 6739.6440s
	iters: 1200, epoch: 1 | loss: 0.0874630
	speed: 0.1275s/iter; left time: 6685.8349s
	iters: 1300, epoch: 1 | loss: 0.0802690
	speed: 0.1263s/iter; left time: 6608.3775s
	iters: 1400, epoch: 1 | loss: 0.0984690
	speed: 0.1274s/iter; left time: 6652.6463s
	iters: 1500, epoch: 1 | loss: 0.0814931
	speed: 0.1302s/iter; left time: 6785.3352s
	iters: 1600, epoch: 1 | loss: 0.0775438
	speed: 0.1344s/iter; left time: 6989.4507s
	iters: 1700, epoch: 1 | loss: 0.0801652
	speed: 0.1321s/iter; left time: 6860.4821s
	iters: 1800, epoch: 1 | loss: 0.0743842
	speed: 0.1277s/iter; left time: 6618.4710s
	iters: 1900, epoch: 1 | loss: 0.0854426
	speed: 0.1287s/iter; left time: 6654.7200s
	iters: 2000, epoch: 1 | loss: 0.0780391
	speed: 0.1286s/iter; left time: 6638.0561s
	iters: 2100, epoch: 1 | loss: 0.0724551
	speed: 0.1272s/iter; left time: 6552.3398s
	iters: 2200, epoch: 1 | loss: 0.0770094
	speed: 0.1267s/iter; left time: 6515.2400s
	iters: 2300, epoch: 1 | loss: 0.0864393
	speed: 0.1267s/iter; left time: 6501.0342s
	iters: 2400, epoch: 1 | loss: 0.0777969
	speed: 0.1283s/iter; left time: 6572.1778s
	iters: 2500, epoch: 1 | loss: 0.0745067
	speed: 0.1275s/iter; left time: 6518.0973s
	iters: 2600, epoch: 1 | loss: 0.0927263
	speed: 0.1279s/iter; left time: 6526.9623s
Epoch: 1 cost time: 00h:05m:45.68s
Epoch: 1 | Train Loss: 0.0993755 Vali Loss: 0.0662276 Test Loss: 0.0754743
Validation loss decreased (inf --> 0.066228).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0936529
	speed: 1.2303s/iter; left time: 62549.7002s
	iters: 200, epoch: 2 | loss: 0.0912237
	speed: 0.1184s/iter; left time: 6010.0761s
	iters: 300, epoch: 2 | loss: 0.0807760
	speed: 0.1178s/iter; left time: 5966.7274s
	iters: 400, epoch: 2 | loss: 0.0864775
	speed: 0.1187s/iter; left time: 5997.6103s
	iters: 500, epoch: 2 | loss: 0.0780736
	speed: 0.1146s/iter; left time: 5781.9483s
	iters: 600, epoch: 2 | loss: 0.0745789
	speed: 0.1154s/iter; left time: 5809.9201s
	iters: 700, epoch: 2 | loss: 0.0697930
	speed: 0.1180s/iter; left time: 5926.9884s
	iters: 800, epoch: 2 | loss: 0.0780450
	speed: 0.1161s/iter; left time: 5821.2941s
	iters: 900, epoch: 2 | loss: 0.0729557
	speed: 0.1163s/iter; left time: 5819.5825s
	iters: 1000, epoch: 2 | loss: 0.0800805
	speed: 0.1147s/iter; left time: 5727.8370s
	iters: 1100, epoch: 2 | loss: 0.0736994
	speed: 0.1143s/iter; left time: 5696.9979s
	iters: 1200, epoch: 2 | loss: 0.0718818
	speed: 0.1132s/iter; left time: 5631.1617s
	iters: 1300, epoch: 2 | loss: 0.0728408
	speed: 0.1143s/iter; left time: 5672.7104s
	iters: 1400, epoch: 2 | loss: 0.0732936
	speed: 0.1155s/iter; left time: 5721.5886s
	iters: 1500, epoch: 2 | loss: 0.0862661
	speed: 0.1155s/iter; left time: 5708.7566s
	iters: 1600, epoch: 2 | loss: 0.0885015
	speed: 0.1165s/iter; left time: 5746.3741s
	iters: 1700, epoch: 2 | loss: 0.0699046
	speed: 0.1194s/iter; left time: 5877.9799s
	iters: 1800, epoch: 2 | loss: 0.0673015
	speed: 0.1178s/iter; left time: 5786.2836s
	iters: 1900, epoch: 2 | loss: 0.0852279
	speed: 0.1161s/iter; left time: 5693.6767s
	iters: 2000, epoch: 2 | loss: 0.0779036
	speed: 0.1150s/iter; left time: 5628.4731s
	iters: 2100, epoch: 2 | loss: 0.0709876
	speed: 0.1149s/iter; left time: 5610.1158s
	iters: 2200, epoch: 2 | loss: 0.0774782
	speed: 0.1137s/iter; left time: 5539.6278s
	iters: 2300, epoch: 2 | loss: 0.0751852
	speed: 0.1162s/iter; left time: 5654.1786s
	iters: 2400, epoch: 2 | loss: 0.0819853
	speed: 0.1158s/iter; left time: 5620.3485s
	iters: 2500, epoch: 2 | loss: 0.0652728
	speed: 0.1170s/iter; left time: 5668.2419s
	iters: 2600, epoch: 2 | loss: 0.0770506
	speed: 0.1167s/iter; left time: 5641.0626s
Epoch: 2 cost time: 00h:05m:11.76s
Epoch: 2 | Train Loss: 0.0773266 Vali Loss: 0.0630829 Test Loss: 0.0720199
Validation loss decreased (0.066228 --> 0.063083).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0664506
	speed: 1.0860s/iter; left time: 52298.8217s
	iters: 200, epoch: 3 | loss: 0.0780226
	speed: 0.1148s/iter; left time: 5515.8168s
	iters: 300, epoch: 3 | loss: 0.0809838
	speed: 0.1146s/iter; left time: 5496.9904s
	iters: 400, epoch: 3 | loss: 0.0751593
	speed: 0.1146s/iter; left time: 5482.8314s
	iters: 500, epoch: 3 | loss: 0.0690148
	speed: 0.1186s/iter; left time: 5664.2265s
	iters: 600, epoch: 3 | loss: 0.0651948
	speed: 0.1200s/iter; left time: 5717.9900s
	iters: 700, epoch: 3 | loss: 0.0696828
	speed: 0.1192s/iter; left time: 5669.5340s
	iters: 800, epoch: 3 | loss: 0.0909723
	speed: 0.1180s/iter; left time: 5601.0442s
	iters: 900, epoch: 3 | loss: 0.0693156
	speed: 0.1179s/iter; left time: 5583.0343s
	iters: 1000, epoch: 3 | loss: 0.0763046
	speed: 0.1202s/iter; left time: 5681.1260s
	iters: 1100, epoch: 3 | loss: 0.0654815
	speed: 0.1174s/iter; left time: 5538.4323s
	iters: 1200, epoch: 3 | loss: 0.0816431
	speed: 0.1205s/iter; left time: 5671.2245s
	iters: 1300, epoch: 3 | loss: 0.0731011
	speed: 0.1176s/iter; left time: 5522.5890s
	iters: 1400, epoch: 3 | loss: 0.0798532
	speed: 0.1202s/iter; left time: 5634.7652s
	iters: 1500, epoch: 3 | loss: 0.0781588
	speed: 0.1197s/iter; left time: 5594.8528s
	iters: 1600, epoch: 3 | loss: 0.0688082
	speed: 0.1186s/iter; left time: 5535.3495s
	iters: 1700, epoch: 3 | loss: 0.0722890
	speed: 0.1157s/iter; left time: 5385.5811s
	iters: 1800, epoch: 3 | loss: 0.0578647
	speed: 0.1150s/iter; left time: 5343.9319s
	iters: 1900, epoch: 3 | loss: 0.0831098
	speed: 0.1192s/iter; left time: 5524.3157s
	iters: 2000, epoch: 3 | loss: 0.0657302
	speed: 0.1168s/iter; left time: 5401.8942s
	iters: 2100, epoch: 3 | loss: 0.0686098
	speed: 0.1184s/iter; left time: 5463.8973s
	iters: 2200, epoch: 3 | loss: 0.0793400
	speed: 0.1222s/iter; left time: 5627.4213s
	iters: 2300, epoch: 3 | loss: 0.0739723
	speed: 0.1189s/iter; left time: 5464.7096s
	iters: 2400, epoch: 3 | loss: 0.0883555
	speed: 0.1152s/iter; left time: 5282.4396s
	iters: 2500, epoch: 3 | loss: 0.0636316
	speed: 0.1158s/iter; left time: 5297.6672s
	iters: 2600, epoch: 3 | loss: 0.0704639
	speed: 0.1139s/iter; left time: 5199.1854s
Epoch: 3 cost time: 00h:05m:15.64s
Epoch: 3 | Train Loss: 0.0731855 Vali Loss: 0.0623539 Test Loss: 0.0720562
Validation loss decreased (0.063083 --> 0.062354).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0695748
	speed: 1.0455s/iter; left time: 47545.2099s
	iters: 200, epoch: 4 | loss: 0.0786053
	speed: 0.1144s/iter; left time: 5191.6691s
	iters: 300, epoch: 4 | loss: 0.0584018
	speed: 0.1150s/iter; left time: 5205.4502s
	iters: 400, epoch: 4 | loss: 0.0929034
	speed: 0.1155s/iter; left time: 5216.2159s
	iters: 500, epoch: 4 | loss: 0.0779471
	speed: 0.1114s/iter; left time: 5020.0233s
	iters: 600, epoch: 4 | loss: 0.0695291
	speed: 0.1130s/iter; left time: 5082.2797s
	iters: 700, epoch: 4 | loss: 0.0666811
	speed: 0.1151s/iter; left time: 5166.2757s
	iters: 800, epoch: 4 | loss: 0.0734229
	speed: 0.1154s/iter; left time: 5167.0127s
	iters: 900, epoch: 4 | loss: 0.0612417
	speed: 0.1138s/iter; left time: 5084.3318s
	iters: 1000, epoch: 4 | loss: 0.0748140
	speed: 0.1142s/iter; left time: 5088.6718s
	iters: 1100, epoch: 4 | loss: 0.0748632
	speed: 0.1153s/iter; left time: 5127.5359s
	iters: 1200, epoch: 4 | loss: 0.0688734
	speed: 0.1159s/iter; left time: 5144.1363s
	iters: 1300, epoch: 4 | loss: 0.0741981
	speed: 0.1160s/iter; left time: 5137.8647s
	iters: 1400, epoch: 4 | loss: 0.0658868
	speed: 0.1148s/iter; left time: 5072.0988s
	iters: 1500, epoch: 4 | loss: 0.0664924
	speed: 0.1150s/iter; left time: 5068.6878s
	iters: 1600, epoch: 4 | loss: 0.0765673
	speed: 0.1144s/iter; left time: 5031.6526s
	iters: 1700, epoch: 4 | loss: 0.0755662
	speed: 0.1157s/iter; left time: 5074.7618s
	iters: 1800, epoch: 4 | loss: 0.0777128
	speed: 0.1148s/iter; left time: 5026.6644s
	iters: 1900, epoch: 4 | loss: 0.0851511
	speed: 0.1154s/iter; left time: 5040.0799s
	iters: 2000, epoch: 4 | loss: 0.0781193
	speed: 0.1161s/iter; left time: 5057.9787s
	iters: 2100, epoch: 4 | loss: 0.0825148
	speed: 0.1156s/iter; left time: 5025.7944s
	iters: 2200, epoch: 4 | loss: 0.0718397
	speed: 0.1155s/iter; left time: 5009.7955s
	iters: 2300, epoch: 4 | loss: 0.0678933
	speed: 0.1169s/iter; left time: 5058.4917s
	iters: 2400, epoch: 4 | loss: 0.0727424
	speed: 0.1153s/iter; left time: 4979.7414s
	iters: 2500, epoch: 4 | loss: 0.0754367
	speed: 0.1147s/iter; left time: 4941.4695s
	iters: 2600, epoch: 4 | loss: 0.0694987
	speed: 0.1147s/iter; left time: 4927.9194s
Epoch: 4 cost time: 00h:05m:08.58s
Epoch: 4 | Train Loss: 0.0712121 Vali Loss: 0.0611709 Test Loss: 0.0710917
Validation loss decreased (0.062354 --> 0.061171).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0630679
	speed: 1.0569s/iter; left time: 45230.5762s
	iters: 200, epoch: 5 | loss: 0.0689823
	speed: 0.1152s/iter; left time: 4917.2996s
	iters: 300, epoch: 5 | loss: 0.0810203
	speed: 0.1162s/iter; left time: 4949.1596s
	iters: 400, epoch: 5 | loss: 0.0599910
	speed: 0.1150s/iter; left time: 4886.2999s
	iters: 500, epoch: 5 | loss: 0.0720650
	speed: 0.1143s/iter; left time: 4845.0679s
	iters: 600, epoch: 5 | loss: 0.0723064
	speed: 0.1147s/iter; left time: 4852.3544s
	iters: 700, epoch: 5 | loss: 0.0714625
	speed: 0.1139s/iter; left time: 4807.6518s
	iters: 800, epoch: 5 | loss: 0.0736922
	speed: 0.1128s/iter; left time: 4748.6478s
	iters: 900, epoch: 5 | loss: 0.0730744
	speed: 0.1134s/iter; left time: 4760.4105s
	iters: 1000, epoch: 5 | loss: 0.0762590
	speed: 0.1141s/iter; left time: 4781.9349s
	iters: 1100, epoch: 5 | loss: 0.0776123
	speed: 0.1133s/iter; left time: 4735.9502s
	iters: 1200, epoch: 5 | loss: 0.0766415
	speed: 0.1127s/iter; left time: 4697.1781s
	iters: 1300, epoch: 5 | loss: 0.0700914
	speed: 0.1137s/iter; left time: 4729.9397s
	iters: 1400, epoch: 5 | loss: 0.0647124
	speed: 0.1127s/iter; left time: 4676.9359s
	iters: 1500, epoch: 5 | loss: 0.0750828
	speed: 0.1134s/iter; left time: 4694.3295s
	iters: 1600, epoch: 5 | loss: 0.0726999
	speed: 0.1137s/iter; left time: 4695.2950s
	iters: 1700, epoch: 5 | loss: 0.0699233
	speed: 0.1123s/iter; left time: 4626.5963s
	iters: 1800, epoch: 5 | loss: 0.0737871
	speed: 0.1139s/iter; left time: 4682.4217s
	iters: 1900, epoch: 5 | loss: 0.0672794
	speed: 0.1147s/iter; left time: 4701.4137s
	iters: 2000, epoch: 5 | loss: 0.0721373
	speed: 0.1153s/iter; left time: 4716.3622s
	iters: 2100, epoch: 5 | loss: 0.0577321
	speed: 0.1148s/iter; left time: 4682.7861s
	iters: 2200, epoch: 5 | loss: 0.0599433
	speed: 0.1149s/iter; left time: 4677.9945s
	iters: 2300, epoch: 5 | loss: 0.0708436
	speed: 0.1131s/iter; left time: 4590.2444s
	iters: 2400, epoch: 5 | loss: 0.0647120
	speed: 0.1143s/iter; left time: 4627.6918s
	iters: 2500, epoch: 5 | loss: 0.0707248
	speed: 0.1142s/iter; left time: 4613.0119s
	iters: 2600, epoch: 5 | loss: 0.0699116
	speed: 0.1138s/iter; left time: 4585.3660s
Epoch: 5 cost time: 00h:05m:06.02s
Epoch: 5 | Train Loss: 0.0699275 Vali Loss: 0.0589704 Test Loss: 0.0681652
Validation loss decreased (0.061171 --> 0.058970).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0585817
	speed: 1.0444s/iter; left time: 41895.8387s
	iters: 200, epoch: 6 | loss: 0.0743628
	speed: 0.1150s/iter; left time: 4601.7528s
	iters: 300, epoch: 6 | loss: 0.0816830
	speed: 0.1144s/iter; left time: 4568.0115s
	iters: 400, epoch: 6 | loss: 0.0686249
	speed: 0.1157s/iter; left time: 4606.7715s
	iters: 500, epoch: 6 | loss: 0.0658081
	speed: 0.1160s/iter; left time: 4607.8605s
	iters: 600, epoch: 6 | loss: 0.0699370
	speed: 0.1123s/iter; left time: 4448.1751s
	iters: 700, epoch: 6 | loss: 0.0579729
	speed: 0.1141s/iter; left time: 4509.3703s
	iters: 800, epoch: 6 | loss: 0.0594627
	speed: 0.1135s/iter; left time: 4473.9968s
	iters: 900, epoch: 6 | loss: 0.0765333
	speed: 0.1126s/iter; left time: 4425.4338s
	iters: 1000, epoch: 6 | loss: 0.0679004
	speed: 0.1127s/iter; left time: 4419.3486s
	iters: 1100, epoch: 6 | loss: 0.0628908
	speed: 0.1142s/iter; left time: 4465.3444s
	iters: 1200, epoch: 6 | loss: 0.0643912
	speed: 0.1134s/iter; left time: 4422.9509s
	iters: 1300, epoch: 6 | loss: 0.0718672
	speed: 0.1122s/iter; left time: 4366.1406s
	iters: 1400, epoch: 6 | loss: 0.0650968
	speed: 0.1133s/iter; left time: 4397.1992s
	iters: 1500, epoch: 6 | loss: 0.0803147
	speed: 0.1126s/iter; left time: 4357.9873s
	iters: 1600, epoch: 6 | loss: 0.0721307
	speed: 0.1128s/iter; left time: 4355.1406s
	iters: 1700, epoch: 6 | loss: 0.0664947
	speed: 0.1121s/iter; left time: 4318.4247s
	iters: 1800, epoch: 6 | loss: 0.0713947
	speed: 0.1131s/iter; left time: 4345.8420s
	iters: 1900, epoch: 6 | loss: 0.0666180
	speed: 0.1140s/iter; left time: 4367.4006s
	iters: 2000, epoch: 6 | loss: 0.0742579
	speed: 0.1155s/iter; left time: 4415.1730s
	iters: 2100, epoch: 6 | loss: 0.0744588
	speed: 0.1138s/iter; left time: 4336.3663s
	iters: 2200, epoch: 6 | loss: 0.0583553
	speed: 0.1137s/iter; left time: 4324.2063s
	iters: 2300, epoch: 6 | loss: 0.0706729
	speed: 0.1135s/iter; left time: 4304.5950s
	iters: 2400, epoch: 6 | loss: 0.0550006
	speed: 0.1142s/iter; left time: 4317.8107s
	iters: 2500, epoch: 6 | loss: 0.0605696
	speed: 0.1146s/iter; left time: 4324.0003s
	iters: 2600, epoch: 6 | loss: 0.0701861
	speed: 0.1142s/iter; left time: 4296.4502s
Epoch: 6 cost time: 00h:05m:05.76s
Epoch: 6 | Train Loss: 0.0689073 Vali Loss: 0.0598308 Test Loss: 0.0697114
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0657653
	speed: 1.0371s/iter; left time: 38823.0358s
	iters: 200, epoch: 7 | loss: 0.0665484
	speed: 0.1143s/iter; left time: 4265.6868s
	iters: 300, epoch: 7 | loss: 0.0624240
	speed: 0.1151s/iter; left time: 4287.0299s
	iters: 400, epoch: 7 | loss: 0.0643224
	speed: 0.1143s/iter; left time: 4245.1658s
	iters: 500, epoch: 7 | loss: 0.0836057
	speed: 0.1148s/iter; left time: 4250.6829s
	iters: 600, epoch: 7 | loss: 0.0660850
	speed: 0.1122s/iter; left time: 4144.5433s
	iters: 700, epoch: 7 | loss: 0.0869880
	speed: 0.1148s/iter; left time: 4227.2054s
	iters: 800, epoch: 7 | loss: 0.0704906
	speed: 0.1132s/iter; left time: 4157.9783s
	iters: 900, epoch: 7 | loss: 0.0647015
	speed: 0.1136s/iter; left time: 4162.2106s
	iters: 1000, epoch: 7 | loss: 0.0806929
	speed: 0.1146s/iter; left time: 4187.5710s
	iters: 1100, epoch: 7 | loss: 0.0759010
	speed: 0.1140s/iter; left time: 4153.3982s
	iters: 1200, epoch: 7 | loss: 0.0615634
	speed: 0.1137s/iter; left time: 4131.3824s
	iters: 1300, epoch: 7 | loss: 0.0764042
	speed: 0.1122s/iter; left time: 4064.2429s
	iters: 1400, epoch: 7 | loss: 0.0674644
	speed: 0.1125s/iter; left time: 4065.6722s
	iters: 1500, epoch: 7 | loss: 0.0740616
	speed: 0.1134s/iter; left time: 4084.7985s
	iters: 1600, epoch: 7 | loss: 0.0792665
	speed: 0.1136s/iter; left time: 4082.3793s
	iters: 1700, epoch: 7 | loss: 0.0690767
	speed: 0.1127s/iter; left time: 4039.7644s
	iters: 1800, epoch: 7 | loss: 0.0598226
	speed: 0.1149s/iter; left time: 4104.9907s
	iters: 1900, epoch: 7 | loss: 0.0678398
	speed: 0.1154s/iter; left time: 4113.3813s
	iters: 2000, epoch: 7 | loss: 0.0747984
	speed: 0.1150s/iter; left time: 4087.7855s
	iters: 2100, epoch: 7 | loss: 0.0712984
	speed: 0.1151s/iter; left time: 4077.3569s
	iters: 2200, epoch: 7 | loss: 0.0657289
	speed: 0.1137s/iter; left time: 4016.5526s
	iters: 2300, epoch: 7 | loss: 0.0730863
	speed: 0.1156s/iter; left time: 4073.4537s
	iters: 2400, epoch: 7 | loss: 0.0687535
	speed: 0.1143s/iter; left time: 4015.7164s
	iters: 2500, epoch: 7 | loss: 0.0626324
	speed: 0.1146s/iter; left time: 4016.0510s
	iters: 2600, epoch: 7 | loss: 0.0694073
	speed: 0.1139s/iter; left time: 3980.2275s
Epoch: 7 cost time: 00h:05m:06.51s
Epoch: 7 | Train Loss: 0.0681056 Vali Loss: 0.0597853 Test Loss: 0.0696563
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0955697
	speed: 1.0430s/iter; left time: 36246.7374s
	iters: 200, epoch: 8 | loss: 0.0681316
	speed: 0.1134s/iter; left time: 3929.1527s
	iters: 300, epoch: 8 | loss: 0.0796526
	speed: 0.1125s/iter; left time: 3887.7026s
	iters: 400, epoch: 8 | loss: 0.0672699
	speed: 0.1137s/iter; left time: 3916.2965s
	iters: 500, epoch: 8 | loss: 0.0579451
	speed: 0.1137s/iter; left time: 3905.9708s
	iters: 600, epoch: 8 | loss: 0.0730144
	speed: 0.1146s/iter; left time: 3924.0622s
	iters: 700, epoch: 8 | loss: 0.0561597
	speed: 0.1131s/iter; left time: 3861.1952s
	iters: 800, epoch: 8 | loss: 0.0630030
	speed: 0.1123s/iter; left time: 3823.9748s
	iters: 900, epoch: 8 | loss: 0.0696586
	speed: 0.1131s/iter; left time: 3839.3908s
	iters: 1000, epoch: 8 | loss: 0.0760989
	speed: 0.1129s/iter; left time: 3823.1975s
	iters: 1100, epoch: 8 | loss: 0.0601159
	speed: 0.1125s/iter; left time: 3798.2438s
	iters: 1200, epoch: 8 | loss: 0.0697419
	speed: 0.1127s/iter; left time: 3792.1555s
	iters: 1300, epoch: 8 | loss: 0.0581929
	speed: 0.1156s/iter; left time: 3878.0686s
	iters: 1400, epoch: 8 | loss: 0.0630530
	speed: 0.1134s/iter; left time: 3792.1820s
	iters: 1500, epoch: 8 | loss: 0.0653922
	speed: 0.1125s/iter; left time: 3752.6265s
	iters: 1600, epoch: 8 | loss: 0.0719701
	speed: 0.1122s/iter; left time: 3729.8680s
	iters: 1700, epoch: 8 | loss: 0.0626506
	speed: 0.1124s/iter; left time: 3727.5302s
	iters: 1800, epoch: 8 | loss: 0.0601200
	speed: 0.1121s/iter; left time: 3706.5486s
	iters: 1900, epoch: 8 | loss: 0.0739461
	speed: 0.1125s/iter; left time: 3706.8998s
	iters: 2000, epoch: 8 | loss: 0.0698656
	speed: 0.1148s/iter; left time: 3772.4910s
	iters: 2100, epoch: 8 | loss: 0.0620731
	speed: 0.1124s/iter; left time: 3681.6874s
	iters: 2200, epoch: 8 | loss: 0.0645657
	speed: 0.1139s/iter; left time: 3719.4823s
	iters: 2300, epoch: 8 | loss: 0.0703310
	speed: 0.1129s/iter; left time: 3676.4973s
	iters: 2400, epoch: 8 | loss: 0.0673083
	speed: 0.1124s/iter; left time: 3646.4198s
	iters: 2500, epoch: 8 | loss: 0.0710015
	speed: 0.1135s/iter; left time: 3673.5000s
	iters: 2600, epoch: 8 | loss: 0.0631191
	speed: 0.1134s/iter; left time: 3656.2917s
Epoch: 8 cost time: 00h:05m:04.16s
Epoch: 8 | Train Loss: 0.0675166 Vali Loss: 0.0581114 Test Loss: 0.0668070
Validation loss decreased (0.058970 --> 0.058111).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.0710958
	speed: 1.0400s/iter; left time: 33355.3824s
	iters: 200, epoch: 9 | loss: 0.0710134
	speed: 0.1117s/iter; left time: 3570.8230s
	iters: 300, epoch: 9 | loss: 0.0564387
	speed: 0.1126s/iter; left time: 3588.6726s
	iters: 400, epoch: 9 | loss: 0.0593314
	speed: 0.1127s/iter; left time: 3581.2274s
	iters: 500, epoch: 9 | loss: 0.0549250
	speed: 0.1135s/iter; left time: 3594.9364s
	iters: 600, epoch: 9 | loss: 0.0573312
	speed: 0.1121s/iter; left time: 3538.6037s
	iters: 700, epoch: 9 | loss: 0.0749223
	speed: 0.1143s/iter; left time: 3597.2976s
	iters: 800, epoch: 9 | loss: 0.0616827
	speed: 0.1156s/iter; left time: 3627.1548s
	iters: 900, epoch: 9 | loss: 0.0696181
	speed: 0.1130s/iter; left time: 3533.0747s
	iters: 1000, epoch: 9 | loss: 0.0527223
	speed: 0.1131s/iter; left time: 3524.5021s
	iters: 1100, epoch: 9 | loss: 0.0648112
	speed: 0.1121s/iter; left time: 3484.1837s
	iters: 1200, epoch: 9 | loss: 0.0737804
	speed: 0.1123s/iter; left time: 3478.6223s
	iters: 1300, epoch: 9 | loss: 0.0596698
	speed: 0.1130s/iter; left time: 3488.1215s
	iters: 1400, epoch: 9 | loss: 0.0660387
	speed: 0.1121s/iter; left time: 3449.5615s
	iters: 1500, epoch: 9 | loss: 0.0742668
	speed: 0.1149s/iter; left time: 3523.9911s
	iters: 1600, epoch: 9 | loss: 0.0563254
	speed: 0.1146s/iter; left time: 3504.2331s
	iters: 1700, epoch: 9 | loss: 0.0555071
	speed: 0.1133s/iter; left time: 3453.3819s
	iters: 1800, epoch: 9 | loss: 0.0757507
	speed: 0.1136s/iter; left time: 3451.1903s
	iters: 1900, epoch: 9 | loss: 0.0711249
	speed: 0.1131s/iter; left time: 3423.7884s
	iters: 2000, epoch: 9 | loss: 0.0721804
	speed: 0.1134s/iter; left time: 3420.5568s
	iters: 2100, epoch: 9 | loss: 0.0665950
	speed: 0.1139s/iter; left time: 3425.0314s
	iters: 2200, epoch: 9 | loss: 0.0581865
	speed: 0.1138s/iter; left time: 3411.8899s
	iters: 2300, epoch: 9 | loss: 0.0679084
	speed: 0.1130s/iter; left time: 3376.8615s
	iters: 2400, epoch: 9 | loss: 0.0549888
	speed: 0.1133s/iter; left time: 3372.3990s
	iters: 2500, epoch: 9 | loss: 0.0570390
	speed: 0.1135s/iter; left time: 3368.7344s
	iters: 2600, epoch: 9 | loss: 0.0600057
	speed: 0.1133s/iter; left time: 3350.1827s
Epoch: 9 cost time: 00h:05m:04.05s
Epoch: 9 | Train Loss: 0.0669224 Vali Loss: 0.0591406 Test Loss: 0.0683875
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 10 | loss: 0.0737776
	speed: 1.0245s/iter; left time: 30110.7750s
	iters: 200, epoch: 10 | loss: 0.0724111
	speed: 0.1137s/iter; left time: 3329.1865s
	iters: 300, epoch: 10 | loss: 0.0616018
	speed: 0.1138s/iter; left time: 3321.2091s
	iters: 400, epoch: 10 | loss: 0.0517321
	speed: 0.1130s/iter; left time: 3287.4474s
	iters: 500, epoch: 10 | loss: 0.0636202
	speed: 0.1132s/iter; left time: 3281.2723s
	iters: 600, epoch: 10 | loss: 0.0686904
	speed: 0.1132s/iter; left time: 3270.4862s
	iters: 700, epoch: 10 | loss: 0.0717656
	speed: 0.1130s/iter; left time: 3254.5680s
	iters: 800, epoch: 10 | loss: 0.0680537
	speed: 0.1145s/iter; left time: 3284.0216s
	iters: 900, epoch: 10 | loss: 0.0653778
	speed: 0.1123s/iter; left time: 3211.9863s
	iters: 1000, epoch: 10 | loss: 0.0478307
	speed: 0.1131s/iter; left time: 3222.6684s
	iters: 1100, epoch: 10 | loss: 0.0693082
	speed: 0.1129s/iter; left time: 3204.8677s
	iters: 1200, epoch: 10 | loss: 0.0719121
	speed: 0.1142s/iter; left time: 3231.4140s
	iters: 1300, epoch: 10 | loss: 0.0745866
	speed: 0.1141s/iter; left time: 3215.3624s
	iters: 1400, epoch: 10 | loss: 0.0660974
	speed: 0.1120s/iter; left time: 3146.3648s
	iters: 1500, epoch: 10 | loss: 0.0666839
	speed: 0.1148s/iter; left time: 3213.9156s
	iters: 1600, epoch: 10 | loss: 0.0883639
	speed: 0.1116s/iter; left time: 3113.4350s
	iters: 1700, epoch: 10 | loss: 0.0611924
	speed: 0.1139s/iter; left time: 3166.0606s
	iters: 1800, epoch: 10 | loss: 0.0584188
	speed: 0.1134s/iter; left time: 3139.2218s
	iters: 1900, epoch: 10 | loss: 0.0601275
	speed: 0.1138s/iter; left time: 3138.8746s
	iters: 2000, epoch: 10 | loss: 0.0625480
	speed: 0.1141s/iter; left time: 3136.6568s
	iters: 2100, epoch: 10 | loss: 0.0705743
	speed: 0.1130s/iter; left time: 3095.4025s
	iters: 2200, epoch: 10 | loss: 0.0633123
	speed: 0.1131s/iter; left time: 3086.8010s
	iters: 2300, epoch: 10 | loss: 0.0581706
	speed: 0.1119s/iter; left time: 3042.6933s
	iters: 2400, epoch: 10 | loss: 0.0554645
	speed: 0.1136s/iter; left time: 3076.7753s
	iters: 2500, epoch: 10 | loss: 0.0550835
	speed: 0.1134s/iter; left time: 3060.9786s
	iters: 2600, epoch: 10 | loss: 0.0590457
	speed: 0.1126s/iter; left time: 3028.8592s
Epoch: 10 cost time: 00h:05m:03.96s
Epoch: 10 | Train Loss: 0.0663446 Vali Loss: 0.0583170 Test Loss: 0.0684556
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 11 | loss: 0.0767739
	speed: 1.0372s/iter; left time: 27704.6867s
	iters: 200, epoch: 11 | loss: 0.0565607
	speed: 0.1145s/iter; left time: 3047.2512s
	iters: 300, epoch: 11 | loss: 0.0709955
	speed: 0.1149s/iter; left time: 3046.1056s
	iters: 400, epoch: 11 | loss: 0.0625823
	speed: 0.1138s/iter; left time: 3004.5073s
	iters: 500, epoch: 11 | loss: 0.0661458
	speed: 0.1146s/iter; left time: 3014.9425s
	iters: 600, epoch: 11 | loss: 0.0606733
	speed: 0.1151s/iter; left time: 3016.2975s
	iters: 700, epoch: 11 | loss: 0.0683432
	speed: 0.1140s/iter; left time: 2975.9419s
	iters: 800, epoch: 11 | loss: 0.0626959
	speed: 0.1138s/iter; left time: 2959.4348s
	iters: 900, epoch: 11 | loss: 0.0729644
	speed: 0.1129s/iter; left time: 2924.6392s
	iters: 1000, epoch: 11 | loss: 0.0603989
	speed: 0.1131s/iter; left time: 2919.0391s
	iters: 1100, epoch: 11 | loss: 0.0806362
	speed: 0.1139s/iter; left time: 2928.9323s
	iters: 1200, epoch: 11 | loss: 0.0656467
	speed: 0.1131s/iter; left time: 2896.3354s
	iters: 1300, epoch: 11 | loss: 0.0590451
	speed: 0.1133s/iter; left time: 2890.3598s
	iters: 1400, epoch: 11 | loss: 0.0639197
	speed: 0.1121s/iter; left time: 2848.7497s
	iters: 1500, epoch: 11 | loss: 0.0649276
	speed: 0.1138s/iter; left time: 2881.1500s
	iters: 1600, epoch: 11 | loss: 0.0672397
	speed: 0.1133s/iter; left time: 2856.4783s
	iters: 1700, epoch: 11 | loss: 0.0771958
	speed: 0.1128s/iter; left time: 2832.8237s
	iters: 1800, epoch: 11 | loss: 0.0633096
	speed: 0.1133s/iter; left time: 2833.8208s
	iters: 1900, epoch: 11 | loss: 0.0575457
	speed: 0.1132s/iter; left time: 2819.3834s
	iters: 2000, epoch: 11 | loss: 0.0709095
	speed: 0.1137s/iter; left time: 2821.8423s
	iters: 2100, epoch: 11 | loss: 0.0625228
	speed: 0.1124s/iter; left time: 2776.7867s
	iters: 2200, epoch: 11 | loss: 0.0722681
	speed: 0.1124s/iter; left time: 2765.1727s
	iters: 2300, epoch: 11 | loss: 0.0579663
	speed: 0.1139s/iter; left time: 2790.6840s
	iters: 2400, epoch: 11 | loss: 0.0612664
	speed: 0.1118s/iter; left time: 2728.5146s
	iters: 2500, epoch: 11 | loss: 0.0591755
	speed: 0.1124s/iter; left time: 2732.7433s
	iters: 2600, epoch: 11 | loss: 0.0699752
	speed: 0.1148s/iter; left time: 2778.2495s
Epoch: 11 cost time: 00h:05m:04.77s
Epoch: 11 | Train Loss: 0.0658757 Vali Loss: 0.0578032 Test Loss: 0.0670076
Validation loss decreased (0.058111 --> 0.057803).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 12 | loss: 0.0724038
	speed: 1.0561s/iter; left time: 25377.5917s
	iters: 200, epoch: 12 | loss: 0.0599244
	speed: 0.1167s/iter; left time: 2791.5539s
	iters: 300, epoch: 12 | loss: 0.0652725
	speed: 0.1146s/iter; left time: 2730.2562s
	iters: 400, epoch: 12 | loss: 0.0576787
	speed: 0.1151s/iter; left time: 2731.3073s
	iters: 500, epoch: 12 | loss: 0.0657673
	speed: 0.1162s/iter; left time: 2745.4736s
	iters: 600, epoch: 12 | loss: 0.0662366
	speed: 0.1159s/iter; left time: 2726.3024s
	iters: 700, epoch: 12 | loss: 0.0807744
	speed: 0.1156s/iter; left time: 2708.6135s
	iters: 800, epoch: 12 | loss: 0.0683301
	speed: 0.1149s/iter; left time: 2681.5224s
	iters: 900, epoch: 12 | loss: 0.0653859
	speed: 0.1139s/iter; left time: 2645.7059s
	iters: 1000, epoch: 12 | loss: 0.0721641
	speed: 0.1158s/iter; left time: 2678.6462s
	iters: 1100, epoch: 12 | loss: 0.0629323
	speed: 0.1133s/iter; left time: 2609.9367s
	iters: 1200, epoch: 12 | loss: 0.0567239
	speed: 0.1160s/iter; left time: 2660.6701s
	iters: 1300, epoch: 12 | loss: 0.0589142
	speed: 0.1145s/iter; left time: 2614.6360s
	iters: 1400, epoch: 12 | loss: 0.0682594
	speed: 0.1172s/iter; left time: 2664.7349s
	iters: 1500, epoch: 12 | loss: 0.0660052
	speed: 0.1145s/iter; left time: 2591.8247s
	iters: 1600, epoch: 12 | loss: 0.0597542
	speed: 0.1149s/iter; left time: 2588.6791s
	iters: 1700, epoch: 12 | loss: 0.0569995
	speed: 0.1162s/iter; left time: 2605.3605s
	iters: 1800, epoch: 12 | loss: 0.0621652
	speed: 0.1139s/iter; left time: 2543.5189s
	iters: 1900, epoch: 12 | loss: 0.0574851
	speed: 0.1154s/iter; left time: 2566.3783s
	iters: 2000, epoch: 12 | loss: 0.0754092
	speed: 0.1168s/iter; left time: 2583.9628s
	iters: 2100, epoch: 12 | loss: 0.0705758
	speed: 0.1139s/iter; left time: 2508.5002s
	iters: 2200, epoch: 12 | loss: 0.0638501
	speed: 0.1144s/iter; left time: 2509.4028s
	iters: 2300, epoch: 12 | loss: 0.0607917
	speed: 0.1150s/iter; left time: 2509.3821s
	iters: 2400, epoch: 12 | loss: 0.0704667
	speed: 0.1134s/iter; left time: 2465.0269s
	iters: 2500, epoch: 12 | loss: 0.0649680
	speed: 0.1152s/iter; left time: 2492.0219s
	iters: 2600, epoch: 12 | loss: 0.0622617
	speed: 0.1135s/iter; left time: 2443.2286s
Epoch: 12 cost time: 00h:05m:09.35s
Epoch: 12 | Train Loss: 0.0654141 Vali Loss: 0.0592872 Test Loss: 0.0696159
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 13 | loss: 0.0571517
	speed: 1.0461s/iter; left time: 22332.6199s
	iters: 200, epoch: 13 | loss: 0.0563359
	speed: 0.1160s/iter; left time: 2465.5303s
	iters: 300, epoch: 13 | loss: 0.0752222
	speed: 0.1144s/iter; left time: 2420.4436s
	iters: 400, epoch: 13 | loss: 0.0552250
	speed: 0.1159s/iter; left time: 2440.2397s
	iters: 500, epoch: 13 | loss: 0.0716464
	speed: 0.1161s/iter; left time: 2431.9619s
	iters: 600, epoch: 13 | loss: 0.0713721
	speed: 0.1143s/iter; left time: 2383.0557s
	iters: 700, epoch: 13 | loss: 0.0675928
	speed: 0.1141s/iter; left time: 2367.1671s
	iters: 800, epoch: 13 | loss: 0.0716297
	speed: 0.1131s/iter; left time: 2335.4889s
	iters: 900, epoch: 13 | loss: 0.0656308
	speed: 0.1131s/iter; left time: 2324.4347s
	iters: 1000, epoch: 13 | loss: 0.0822458
	speed: 0.1156s/iter; left time: 2364.7438s
	iters: 1100, epoch: 13 | loss: 0.0752804
	speed: 0.1129s/iter; left time: 2298.0280s
	iters: 1200, epoch: 13 | loss: 0.0652262
	speed: 0.1172s/iter; left time: 2373.8849s
	iters: 1300, epoch: 13 | loss: 0.0598756
	speed: 0.1151s/iter; left time: 2318.4410s
	iters: 1400, epoch: 13 | loss: 0.0691182
	speed: 0.1149s/iter; left time: 2303.1170s
	iters: 1500, epoch: 13 | loss: 0.0635491
	speed: 0.1145s/iter; left time: 2283.3282s
	iters: 1600, epoch: 13 | loss: 0.0895910
	speed: 0.1124s/iter; left time: 2231.5296s
	iters: 1700, epoch: 13 | loss: 0.0710886
	speed: 0.1151s/iter; left time: 2272.3943s
	iters: 1800, epoch: 13 | loss: 0.0558507
	speed: 0.1159s/iter; left time: 2276.5376s
	iters: 1900, epoch: 13 | loss: 0.0647579
	speed: 0.1128s/iter; left time: 2204.6798s
	iters: 2000, epoch: 13 | loss: 0.0736879
	speed: 0.1139s/iter; left time: 2214.5192s
	iters: 2100, epoch: 13 | loss: 0.0558424
	speed: 0.1143s/iter; left time: 2211.3625s
	iters: 2200, epoch: 13 | loss: 0.0630306
	speed: 0.1142s/iter; left time: 2197.4649s
	iters: 2300, epoch: 13 | loss: 0.0580184
	speed: 0.1155s/iter; left time: 2211.6236s
	iters: 2400, epoch: 13 | loss: 0.0643669
	speed: 0.1134s/iter; left time: 2160.5518s
	iters: 2500, epoch: 13 | loss: 0.0530160
	speed: 0.1140s/iter; left time: 2160.1064s
	iters: 2600, epoch: 13 | loss: 0.0617090
	speed: 0.1137s/iter; left time: 2142.7455s
Epoch: 13 cost time: 00h:05m:07.74s
Epoch: 13 | Train Loss: 0.0649905 Vali Loss: 0.0579648 Test Loss: 0.0673596
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 14 | loss: 0.0698010
	speed: 1.0505s/iter; left time: 19609.8385s
	iters: 200, epoch: 14 | loss: 0.0725076
	speed: 0.1178s/iter; left time: 2187.9124s
	iters: 300, epoch: 14 | loss: 0.0715118
	speed: 0.1160s/iter; left time: 2143.0169s
	iters: 400, epoch: 14 | loss: 0.0609961
	speed: 0.1183s/iter; left time: 2172.8697s
	iters: 500, epoch: 14 | loss: 0.0552948
	speed: 0.1142s/iter; left time: 2087.0287s
	iters: 600, epoch: 14 | loss: 0.0565410
	speed: 0.1163s/iter; left time: 2113.0871s
	iters: 700, epoch: 14 | loss: 0.0706945
	speed: 0.1147s/iter; left time: 2072.3260s
	iters: 800, epoch: 14 | loss: 0.0687059
	speed: 0.1151s/iter; left time: 2067.9418s
	iters: 900, epoch: 14 | loss: 0.0700648
	speed: 0.1139s/iter; left time: 2035.3535s
	iters: 1000, epoch: 14 | loss: 0.0679078
	speed: 0.1145s/iter; left time: 2034.5733s
	iters: 1100, epoch: 14 | loss: 0.0623200
	speed: 0.1180s/iter; left time: 2084.1258s
	iters: 1200, epoch: 14 | loss: 0.0606130
	speed: 0.1154s/iter; left time: 2026.6224s
	iters: 1300, epoch: 14 | loss: 0.0608021
	speed: 0.1154s/iter; left time: 2015.2278s
	iters: 1400, epoch: 14 | loss: 0.0654804
	speed: 0.1158s/iter; left time: 2011.5886s
	iters: 1500, epoch: 14 | loss: 0.0613914
	speed: 0.1146s/iter; left time: 1978.1197s
	iters: 1600, epoch: 14 | loss: 0.0539721
	speed: 0.1188s/iter; left time: 2040.0403s
	iters: 1700, epoch: 14 | loss: 0.0673941
	speed: 0.1140s/iter; left time: 1945.7779s
	iters: 1800, epoch: 14 | loss: 0.0644400
	speed: 0.1151s/iter; left time: 1952.6388s
	iters: 1900, epoch: 14 | loss: 0.0617564
	speed: 0.1189s/iter; left time: 2004.8755s
	iters: 2000, epoch: 14 | loss: 0.0573019
	speed: 0.1138s/iter; left time: 1907.5353s
	iters: 2100, epoch: 14 | loss: 0.0627567
	speed: 0.1157s/iter; left time: 1927.8315s
	iters: 2200, epoch: 14 | loss: 0.0622240
	speed: 0.1143s/iter; left time: 1894.0622s
	iters: 2300, epoch: 14 | loss: 0.0786616
	speed: 0.1130s/iter; left time: 1860.1168s
	iters: 2400, epoch: 14 | loss: 0.0765208
	speed: 0.1167s/iter; left time: 1909.5444s
	iters: 2500, epoch: 14 | loss: 0.0689429
	speed: 0.1148s/iter; left time: 1867.9114s
	iters: 2600, epoch: 14 | loss: 0.0559283
	speed: 0.1152s/iter; left time: 1862.1300s
Epoch: 14 cost time: 00h:05m:10.55s
Epoch: 14 | Train Loss: 0.0645770 Vali Loss: 0.0574409 Test Loss: 0.0664566
Validation loss decreased (0.057803 --> 0.057441).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 15 | loss: 0.0564922
	speed: 1.0504s/iter; left time: 16792.2142s
	iters: 200, epoch: 15 | loss: 0.0621809
	speed: 0.1152s/iter; left time: 1830.9058s
	iters: 300, epoch: 15 | loss: 0.0641433
	speed: 0.1150s/iter; left time: 1814.7649s
	iters: 400, epoch: 15 | loss: 0.0578732
	speed: 0.1162s/iter; left time: 1823.4217s
	iters: 500, epoch: 15 | loss: 0.0655350
	speed: 0.1155s/iter; left time: 1800.4331s
	iters: 600, epoch: 15 | loss: 0.0686196
	speed: 0.1140s/iter; left time: 1765.6390s
	iters: 700, epoch: 15 | loss: 0.0824154
	speed: 0.1150s/iter; left time: 1769.5573s
	iters: 800, epoch: 15 | loss: 0.0650468
	speed: 0.1172s/iter; left time: 1790.8980s
	iters: 900, epoch: 15 | loss: 0.0688387
	speed: 0.1168s/iter; left time: 1773.9111s
	iters: 1000, epoch: 15 | loss: 0.0771232
	speed: 0.1136s/iter; left time: 1714.3128s
	iters: 1100, epoch: 15 | loss: 0.0594005
	speed: 0.1151s/iter; left time: 1724.9768s
	iters: 1200, epoch: 15 | loss: 0.0690505
	speed: 0.1168s/iter; left time: 1738.1331s
	iters: 1300, epoch: 15 | loss: 0.0685179
	speed: 0.1155s/iter; left time: 1707.5917s
	iters: 1400, epoch: 15 | loss: 0.0714361
	speed: 0.1157s/iter; left time: 1698.7921s
	iters: 1500, epoch: 15 | loss: 0.0690282
	speed: 0.1158s/iter; left time: 1689.5013s
	iters: 1600, epoch: 15 | loss: 0.0619706
	speed: 0.1154s/iter; left time: 1672.0780s
	iters: 1700, epoch: 15 | loss: 0.0708041
	speed: 0.1165s/iter; left time: 1676.4341s
	iters: 1800, epoch: 15 | loss: 0.0704809
	speed: 0.1164s/iter; left time: 1662.5459s
	iters: 1900, epoch: 15 | loss: 0.0758016
	speed: 0.1157s/iter; left time: 1641.6784s
	iters: 2000, epoch: 15 | loss: 0.0559394
	speed: 0.1133s/iter; left time: 1596.5836s
	iters: 2100, epoch: 15 | loss: 0.0584624
	speed: 0.1185s/iter; left time: 1657.0702s
	iters: 2200, epoch: 15 | loss: 0.0783027
	speed: 0.1177s/iter; left time: 1634.3422s
	iters: 2300, epoch: 15 | loss: 0.0668146
	speed: 0.1158s/iter; left time: 1596.5994s
	iters: 2400, epoch: 15 | loss: 0.0637044
	speed: 0.1169s/iter; left time: 1600.2406s
	iters: 2500, epoch: 15 | loss: 0.0603980
	speed: 0.1133s/iter; left time: 1539.4111s
	iters: 2600, epoch: 15 | loss: 0.0710332
	speed: 0.1172s/iter; left time: 1580.7251s
Epoch: 15 cost time: 00h:05m:11.05s
Epoch: 15 | Train Loss: 0.0641804 Vali Loss: 0.0605943 Test Loss: 0.0706357
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 16 | loss: 0.0574767
	speed: 1.0832s/iter; left time: 14413.1043s
	iters: 200, epoch: 16 | loss: 0.0573915
	speed: 0.1138s/iter; left time: 1503.4549s
	iters: 300, epoch: 16 | loss: 0.0506497
	speed: 0.1197s/iter; left time: 1568.4148s
	iters: 400, epoch: 16 | loss: 0.0601425
	speed: 0.1245s/iter; left time: 1619.3223s
	iters: 500, epoch: 16 | loss: 0.0669079
	speed: 0.1170s/iter; left time: 1510.5657s
	iters: 600, epoch: 16 | loss: 0.0705684
	speed: 0.1265s/iter; left time: 1619.5410s
	iters: 700, epoch: 16 | loss: 0.0603802
	speed: 0.1172s/iter; left time: 1489.1899s
	iters: 800, epoch: 16 | loss: 0.0707469
	speed: 0.1186s/iter; left time: 1494.8500s
	iters: 900, epoch: 16 | loss: 0.0820457
	speed: 0.1133s/iter; left time: 1417.4639s
	iters: 1000, epoch: 16 | loss: 0.0660811
	speed: 0.1144s/iter; left time: 1418.7206s
	iters: 1100, epoch: 16 | loss: 0.0602575
	speed: 0.1211s/iter; left time: 1490.2298s
	iters: 1200, epoch: 16 | loss: 0.0644291
	speed: 0.1163s/iter; left time: 1419.6789s
	iters: 1300, epoch: 16 | loss: 0.0740635
	speed: 0.1166s/iter; left time: 1411.3760s
	iters: 1400, epoch: 16 | loss: 0.0634106
	speed: 0.1186s/iter; left time: 1423.7740s
	iters: 1500, epoch: 16 | loss: 0.0686077
	speed: 0.1129s/iter; left time: 1344.6050s
	iters: 1600, epoch: 16 | loss: 0.0558413
	speed: 0.1153s/iter; left time: 1361.7066s
	iters: 1700, epoch: 16 | loss: 0.0561398
	speed: 0.1176s/iter; left time: 1376.6157s
	iters: 1800, epoch: 16 | loss: 0.0640715
	speed: 0.1212s/iter; left time: 1407.1287s
	iters: 1900, epoch: 16 | loss: 0.0615180
	speed: 0.1137s/iter; left time: 1308.5983s
	iters: 2000, epoch: 16 | loss: 0.0579631
	speed: 0.1218s/iter; left time: 1388.9642s
	iters: 2100, epoch: 16 | loss: 0.0742498
	speed: 0.1371s/iter; left time: 1550.2575s
	iters: 2200, epoch: 16 | loss: 0.0673364
	speed: 0.1217s/iter; left time: 1364.0987s
	iters: 2300, epoch: 16 | loss: 0.0641308
	speed: 0.1156s/iter; left time: 1283.5332s
	iters: 2400, epoch: 16 | loss: 0.0701997
	speed: 0.1180s/iter; left time: 1298.6027s
	iters: 2500, epoch: 16 | loss: 0.0703389
	speed: 0.1198s/iter; left time: 1307.0178s
	iters: 2600, epoch: 16 | loss: 0.0659333
	speed: 0.1143s/iter; left time: 1234.6238s
Epoch: 16 cost time: 00h:05m:18.40s
Epoch: 16 | Train Loss: 0.0638276 Vali Loss: 0.0593083 Test Loss: 0.0686335
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 17 | loss: 0.0632415
	speed: 1.0655s/iter; left time: 11321.3357s
	iters: 200, epoch: 17 | loss: 0.0688461
	speed: 0.1274s/iter; left time: 1340.6059s
	iters: 300, epoch: 17 | loss: 0.0631828
	speed: 0.1190s/iter; left time: 1240.7238s
	iters: 400, epoch: 17 | loss: 0.0736408
	speed: 0.1165s/iter; left time: 1203.3470s
	iters: 500, epoch: 17 | loss: 0.0770576
	speed: 0.1157s/iter; left time: 1182.5244s
	iters: 600, epoch: 17 | loss: 0.0678533
	speed: 0.1210s/iter; left time: 1224.7393s
	iters: 700, epoch: 17 | loss: 0.0549429
	speed: 0.1198s/iter; left time: 1200.9915s
	iters: 800, epoch: 17 | loss: 0.0515392
	speed: 0.1164s/iter; left time: 1155.6964s
	iters: 900, epoch: 17 | loss: 0.0676008
	speed: 0.1183s/iter; left time: 1162.2364s
	iters: 1000, epoch: 17 | loss: 0.0647659
	speed: 0.1275s/iter; left time: 1239.9174s
	iters: 1100, epoch: 17 | loss: 0.0694209
	speed: 0.1152s/iter; left time: 1108.8508s
	iters: 1200, epoch: 17 | loss: 0.0576050
	speed: 0.1232s/iter; left time: 1173.7085s
	iters: 1300, epoch: 17 | loss: 0.0682291
	speed: 0.1285s/iter; left time: 1211.3266s
	iters: 1400, epoch: 17 | loss: 0.0641747
	speed: 0.1159s/iter; left time: 1080.6953s
	iters: 1500, epoch: 17 | loss: 0.0657903
	speed: 0.1203s/iter; left time: 1109.7518s
	iters: 1600, epoch: 17 | loss: 0.0568783
	speed: 0.1165s/iter; left time: 1063.3112s
	iters: 1700, epoch: 17 | loss: 0.0658871
	speed: 0.1160s/iter; left time: 1047.2816s
	iters: 1800, epoch: 17 | loss: 0.0624544
	speed: 0.1171s/iter; left time: 1044.9825s
	iters: 1900, epoch: 17 | loss: 0.0611300
	speed: 0.1184s/iter; left time: 1044.9180s
	iters: 2000, epoch: 17 | loss: 0.0487223
	speed: 0.1155s/iter; left time: 1007.8602s
	iters: 2100, epoch: 17 | loss: 0.0584179
	speed: 0.1158s/iter; left time: 998.5470s
	iters: 2200, epoch: 17 | loss: 0.0644555
	speed: 0.1157s/iter; left time: 986.0106s
	iters: 2300, epoch: 17 | loss: 0.0529996
	speed: 0.1187s/iter; left time: 1000.3853s
	iters: 2400, epoch: 17 | loss: 0.0567144
	speed: 0.1177s/iter; left time: 980.1682s
	iters: 2500, epoch: 17 | loss: 0.0710186
	speed: 0.1150s/iter; left time: 946.1899s
	iters: 2600, epoch: 17 | loss: 0.0712463
	speed: 0.1362s/iter; left time: 1106.6550s
Epoch: 17 cost time: 00h:05m:20.52s
Epoch: 17 | Train Loss: 0.0634753 Vali Loss: 0.0594251 Test Loss: 0.0680345
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 18 | loss: 0.0608606
	speed: 1.0592s/iter; left time: 8414.4599s
	iters: 200, epoch: 18 | loss: 0.0630744
	speed: 0.1173s/iter; left time: 920.3750s
	iters: 300, epoch: 18 | loss: 0.0573201
	speed: 0.1164s/iter; left time: 901.6809s
	iters: 400, epoch: 18 | loss: 0.0669892
	speed: 0.1149s/iter; left time: 878.1572s
	iters: 500, epoch: 18 | loss: 0.0642769
	speed: 0.1175s/iter; left time: 886.4048s
	iters: 600, epoch: 18 | loss: 0.0601702
	speed: 0.1171s/iter; left time: 871.5879s
	iters: 700, epoch: 18 | loss: 0.0813551
	speed: 0.1213s/iter; left time: 891.1741s
	iters: 800, epoch: 18 | loss: 0.0769780
	speed: 0.1153s/iter; left time: 835.3674s
	iters: 900, epoch: 18 | loss: 0.0527711
	speed: 0.1147s/iter; left time: 819.4615s
	iters: 1000, epoch: 18 | loss: 0.0642087
	speed: 0.1179s/iter; left time: 830.5596s
	iters: 1100, epoch: 18 | loss: 0.0753492
	speed: 0.1156s/iter; left time: 802.4335s
	iters: 1200, epoch: 18 | loss: 0.0503302
	speed: 0.1153s/iter; left time: 789.4083s
	iters: 1300, epoch: 18 | loss: 0.0638088
	speed: 0.1176s/iter; left time: 793.3942s
	iters: 1400, epoch: 18 | loss: 0.0659324
	speed: 0.1136s/iter; left time: 755.0098s
	iters: 1500, epoch: 18 | loss: 0.0653730
	speed: 0.1465s/iter; left time: 958.7802s
	iters: 1600, epoch: 18 | loss: 0.0739145
	speed: 0.1208s/iter; left time: 778.5894s
	iters: 1700, epoch: 18 | loss: 0.0535310
	speed: 0.1176s/iter; left time: 746.3211s
	iters: 1800, epoch: 18 | loss: 0.0655848
	speed: 0.1177s/iter; left time: 735.2285s
	iters: 1900, epoch: 18 | loss: 0.0589777
	speed: 0.1218s/iter; left time: 748.3657s
	iters: 2000, epoch: 18 | loss: 0.0685786
	speed: 0.1147s/iter; left time: 693.5202s
	iters: 2100, epoch: 18 | loss: 0.0555254
	speed: 0.1135s/iter; left time: 674.5372s
	iters: 2200, epoch: 18 | loss: 0.0631094
	speed: 0.1178s/iter; left time: 688.4124s
	iters: 2300, epoch: 18 | loss: 0.0528505
	speed: 0.1173s/iter; left time: 673.8333s
	iters: 2400, epoch: 18 | loss: 0.0643650
	speed: 0.1150s/iter; left time: 648.8403s
	iters: 2500, epoch: 18 | loss: 0.0647579
	speed: 0.1146s/iter; left time: 635.5729s
	iters: 2600, epoch: 18 | loss: 0.0699769
	speed: 0.1192s/iter; left time: 649.0398s
Epoch: 18 cost time: 00h:05m:16.65s
Epoch: 18 | Train Loss: 0.0629919 Vali Loss: 0.0601041 Test Loss: 0.0698167
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 19 | loss: 0.0543833
	speed: 1.0633s/iter; left time: 5595.9750s
	iters: 200, epoch: 19 | loss: 0.0554405
	speed: 0.1168s/iter; left time: 602.8683s
	iters: 300, epoch: 19 | loss: 0.0701018
	speed: 0.1165s/iter; left time: 589.9046s
	iters: 400, epoch: 19 | loss: 0.0615413
	speed: 0.1210s/iter; left time: 600.4576s
	iters: 500, epoch: 19 | loss: 0.0614020
	speed: 0.1151s/iter; left time: 559.5217s
	iters: 600, epoch: 19 | loss: 0.0573202
	speed: 0.1146s/iter; left time: 545.8222s
	iters: 700, epoch: 19 | loss: 0.0611640
	speed: 0.1167s/iter; left time: 544.2196s
	iters: 800, epoch: 19 | loss: 0.0607653
	speed: 0.1140s/iter; left time: 520.1647s
	iters: 900, epoch: 19 | loss: 0.0566523
	speed: 0.1147s/iter; left time: 512.0958s
	iters: 1000, epoch: 19 | loss: 0.0622958
	speed: 0.1178s/iter; left time: 514.1242s
	iters: 1100, epoch: 19 | loss: 0.0550250
	speed: 0.1133s/iter; left time: 483.1861s
	iters: 1200, epoch: 19 | loss: 0.0663746
	speed: 0.1155s/iter; left time: 480.6642s
	iters: 1300, epoch: 19 | loss: 0.0650760
	speed: 0.1151s/iter; left time: 467.5133s
	iters: 1400, epoch: 19 | loss: 0.0588802
	speed: 0.1159s/iter; left time: 459.2294s
	iters: 1500, epoch: 19 | loss: 0.0603579
	speed: 0.1202s/iter; left time: 464.4885s
	iters: 1600, epoch: 19 | loss: 0.0569299
	speed: 0.1162s/iter; left time: 437.3346s
	iters: 1700, epoch: 19 | loss: 0.0491759
	speed: 0.1141s/iter; left time: 417.7748s
	iters: 1800, epoch: 19 | loss: 0.0864070
	speed: 0.1154s/iter; left time: 411.2592s
	iters: 1900, epoch: 19 | loss: 0.0639838
	speed: 0.1170s/iter; left time: 405.0338s
	iters: 2000, epoch: 19 | loss: 0.0655531
	speed: 0.1135s/iter; left time: 381.5999s
	iters: 2100, epoch: 19 | loss: 0.0550640
	speed: 0.1187s/iter; left time: 387.3000s
	iters: 2200, epoch: 19 | loss: 0.0624830
	speed: 0.1146s/iter; left time: 362.3764s
	iters: 2300, epoch: 19 | loss: 0.0577416
	speed: 0.1153s/iter; left time: 353.3156s
	iters: 2400, epoch: 19 | loss: 0.0651264
	speed: 0.1176s/iter; left time: 348.4014s
	iters: 2500, epoch: 19 | loss: 0.0614737
	speed: 0.1146s/iter; left time: 328.0820s
	iters: 2600, epoch: 19 | loss: 0.0525950
	speed: 0.1160s/iter; left time: 320.5934s
Epoch: 19 cost time: 00h:05m:11.75s
Epoch: 19 | Train Loss: 0.0626410 Vali Loss: 0.0593832 Test Loss: 0.0687746
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.010672738775610924, rmse:0.10330894589424133, mae:0.0664566159248352, rse:0.3033173382282257
success delete checkpoints
Intermediate time for ES and pred_len 24: 02h:06m:51.14s

=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
train 85587
val 18435
test 18435
[2024-11-03 12:31:39,413] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-03 12:31:40,501] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-03 12:31:40,502] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-03 12:31:40,502] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-03 12:31:40,610] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-03 12:31:40,611] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-03 12:31:41,354] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-03 12:31:41,355] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-03 12:31:41,355] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-03 12:31:41,357] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-03 12:31:41,357] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-03 12:31:41,357] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-03 12:31:41,357] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-03 12:31:41,357] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-03 12:31:41,357] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-03 12:31:41,357] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-03 12:31:41,749] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-03 12:31:41,750] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-03 12:31:41,750] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 413.95 GB, percent = 54.9%
[2024-11-03 12:31:42,004] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-03 12:31:42,006] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 12:31:42,006] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 415.18 GB, percent = 55.0%
[2024-11-03 12:31:42,006] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-03 12:31:42,208] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-03 12:31:42,209] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 12:31:42,209] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 416.07 GB, percent = 55.1%
[2024-11-03 12:31:42,210] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-03 12:31:42,210] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-03 12:31:42,210] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-03 12:31:42,211] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-03 12:31:42,211] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-03 12:31:42,212] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-03 12:31:42,212] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-03 12:31:42,212] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-03 12:31:42,212] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-03 12:31:42,212] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-03 12:31:42,212] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-03 12:31:42,212] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-03 12:31:42,212] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-03 12:31:42,212] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-03 12:31:42,212] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f347c58d590>
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-03 12:31:42,213] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-03 12:31:42,214] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-03 12:31:42,215] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-03 12:31:42,215] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-03 12:31:42,215] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-03 12:31:42,215] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-03 12:31:42,215] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-03 12:31:42,215] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-03 12:31:42,215] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-03 12:31:42,215] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-03 12:31:42,215] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-03 12:31:42,215] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1911721
	speed: 0.2250s/iter; left time: 12010.3608s
	iters: 200, epoch: 1 | loss: 0.1927420
	speed: 0.1312s/iter; left time: 6991.0572s
	iters: 300, epoch: 1 | loss: 0.1694221
	speed: 0.1279s/iter; left time: 6803.3074s
	iters: 400, epoch: 1 | loss: 0.1720468
	speed: 0.1280s/iter; left time: 6792.1212s
	iters: 500, epoch: 1 | loss: 0.1218105
	speed: 0.1259s/iter; left time: 6671.8709s
	iters: 600, epoch: 1 | loss: 0.1114848
	speed: 0.1327s/iter; left time: 7017.3328s
	iters: 700, epoch: 1 | loss: 0.1140701
	speed: 0.1261s/iter; left time: 6657.5580s
	iters: 800, epoch: 1 | loss: 0.1041137
	speed: 0.1255s/iter; left time: 6613.8594s
	iters: 900, epoch: 1 | loss: 0.1242962
	speed: 0.1287s/iter; left time: 6765.5096s
	iters: 1000, epoch: 1 | loss: 0.1122826
	speed: 0.1289s/iter; left time: 6764.8339s
	iters: 1100, epoch: 1 | loss: 0.1078091
	speed: 0.1265s/iter; left time: 6627.9105s
	iters: 1200, epoch: 1 | loss: 0.0886153
	speed: 0.1313s/iter; left time: 6863.7768s
	iters: 1300, epoch: 1 | loss: 0.1067653
	speed: 0.1269s/iter; left time: 6623.9458s
	iters: 1400, epoch: 1 | loss: 0.1063584
	speed: 0.1258s/iter; left time: 6553.2690s
	iters: 1500, epoch: 1 | loss: 0.1006202
	speed: 0.1279s/iter; left time: 6649.1573s
	iters: 1600, epoch: 1 | loss: 0.0992378
	speed: 0.1268s/iter; left time: 6578.8237s
	iters: 1700, epoch: 1 | loss: 0.1159680
	speed: 0.1262s/iter; left time: 6533.5496s
	iters: 1800, epoch: 1 | loss: 0.0989420
	speed: 0.1287s/iter; left time: 6648.8436s
	iters: 1900, epoch: 1 | loss: 0.1210326
	speed: 0.1272s/iter; left time: 6559.0411s
	iters: 2000, epoch: 1 | loss: 0.0897738
	speed: 0.1263s/iter; left time: 6502.1211s
	iters: 2100, epoch: 1 | loss: 0.1054735
	speed: 0.1254s/iter; left time: 6444.7193s
	iters: 2200, epoch: 1 | loss: 0.0856309
	speed: 0.1277s/iter; left time: 6549.6717s
	iters: 2300, epoch: 1 | loss: 0.1068027
	speed: 0.1290s/iter; left time: 6600.0312s
	iters: 2400, epoch: 1 | loss: 0.0811701
	speed: 0.1258s/iter; left time: 6424.3765s
	iters: 2500, epoch: 1 | loss: 0.0951465
	speed: 0.1272s/iter; left time: 6486.0592s
	iters: 2600, epoch: 1 | loss: 0.1027023
	speed: 0.1281s/iter; left time: 6518.3456s
Epoch: 1 cost time: 00h:05m:47.64s
Epoch: 1 | Train Loss: 0.1174485 Vali Loss: 0.0865509 Test Loss: 0.1004628
Validation loss decreased (inf --> 0.086551).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.1076370
	speed: 1.2004s/iter; left time: 60869.2661s
	iters: 200, epoch: 2 | loss: 0.1094375
	speed: 0.1190s/iter; left time: 6020.3157s
	iters: 300, epoch: 2 | loss: 0.0885852
	speed: 0.1138s/iter; left time: 5749.9829s
	iters: 400, epoch: 2 | loss: 0.0921508
	speed: 0.1151s/iter; left time: 5802.3581s
	iters: 500, epoch: 2 | loss: 0.0874121
	speed: 0.1181s/iter; left time: 5942.7607s
	iters: 600, epoch: 2 | loss: 0.0942486
	speed: 0.1156s/iter; left time: 5804.2839s
	iters: 700, epoch: 2 | loss: 0.0875211
	speed: 0.1157s/iter; left time: 5798.5184s
	iters: 800, epoch: 2 | loss: 0.0975673
	speed: 0.1169s/iter; left time: 5844.5824s
	iters: 900, epoch: 2 | loss: 0.0873782
	speed: 0.1145s/iter; left time: 5715.6672s
	iters: 1000, epoch: 2 | loss: 0.0910329
	speed: 0.1148s/iter; left time: 5717.4644s
	iters: 1100, epoch: 2 | loss: 0.0909847
	speed: 0.1147s/iter; left time: 5702.5887s
	iters: 1200, epoch: 2 | loss: 0.0977218
	speed: 0.1141s/iter; left time: 5662.2298s
	iters: 1300, epoch: 2 | loss: 0.0851496
	speed: 0.1118s/iter; left time: 5535.0687s
	iters: 1400, epoch: 2 | loss: 0.0878843
	speed: 0.1116s/iter; left time: 5515.6216s
	iters: 1500, epoch: 2 | loss: 0.0895761
	speed: 0.1254s/iter; left time: 6182.0052s
	iters: 1600, epoch: 2 | loss: 0.0866336
	speed: 0.1183s/iter; left time: 5819.2809s
	iters: 1700, epoch: 2 | loss: 0.1094462
	speed: 0.1163s/iter; left time: 5712.2202s
	iters: 1800, epoch: 2 | loss: 0.1022051
	speed: 0.1145s/iter; left time: 5609.4801s
	iters: 1900, epoch: 2 | loss: 0.0886707
	speed: 0.1180s/iter; left time: 5770.6991s
	iters: 2000, epoch: 2 | loss: 0.0902492
	speed: 0.1182s/iter; left time: 5768.7588s
	iters: 2100, epoch: 2 | loss: 0.0888425
	speed: 0.1190s/iter; left time: 5794.1530s
	iters: 2200, epoch: 2 | loss: 0.0878865
	speed: 0.1177s/iter; left time: 5722.5241s
	iters: 2300, epoch: 2 | loss: 0.0795095
	speed: 0.1194s/iter; left time: 5789.5118s
	iters: 2400, epoch: 2 | loss: 0.0914220
	speed: 0.1162s/iter; left time: 5622.8384s
	iters: 2500, epoch: 2 | loss: 0.0818894
	speed: 0.1161s/iter; left time: 5607.8173s
	iters: 2600, epoch: 2 | loss: 0.0820524
	speed: 0.1184s/iter; left time: 5705.3554s
Epoch: 2 cost time: 00h:05m:12.15s
Epoch: 2 | Train Loss: 0.0935248 Vali Loss: 0.0811140 Test Loss: 0.0944012
Validation loss decreased (0.086551 --> 0.081114).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0952333
	speed: 1.0778s/iter; left time: 51768.2510s
	iters: 200, epoch: 3 | loss: 0.0934332
	speed: 0.1083s/iter; left time: 5191.1988s
	iters: 300, epoch: 3 | loss: 0.0905903
	speed: 0.1008s/iter; left time: 4819.9429s
	iters: 400, epoch: 3 | loss: 0.0940271
	speed: 0.1110s/iter; left time: 5296.5709s
	iters: 500, epoch: 3 | loss: 0.0887500
	speed: 0.0976s/iter; left time: 4648.3151s
	iters: 600, epoch: 3 | loss: 0.0991548
	speed: 0.0925s/iter; left time: 4397.1942s
	iters: 700, epoch: 3 | loss: 0.0992021
	speed: 0.0981s/iter; left time: 4651.3183s
	iters: 800, epoch: 3 | loss: 0.0928352
	speed: 0.0910s/iter; left time: 4306.5169s
	iters: 900, epoch: 3 | loss: 0.0962132
	speed: 0.0898s/iter; left time: 4241.9536s
	iters: 1000, epoch: 3 | loss: 0.0963722
	speed: 0.0940s/iter; left time: 4430.7202s
	iters: 1100, epoch: 3 | loss: 0.0940291
	speed: 0.0908s/iter; left time: 4269.6858s
	iters: 1200, epoch: 3 | loss: 0.0946871
	speed: 0.0876s/iter; left time: 4112.2190s
	iters: 1300, epoch: 3 | loss: 0.0897035
	speed: 0.0935s/iter; left time: 4379.2322s
	iters: 1400, epoch: 3 | loss: 0.0817999
	speed: 0.1109s/iter; left time: 5182.1395s
	iters: 1500, epoch: 3 | loss: 0.0934589
	speed: 0.1107s/iter; left time: 5164.5937s
	iters: 1600, epoch: 3 | loss: 0.1075991
	speed: 0.1093s/iter; left time: 5087.5857s
	iters: 1700, epoch: 3 | loss: 0.1029885
	speed: 0.1141s/iter; left time: 5297.1691s
	iters: 1800, epoch: 3 | loss: 0.0796154
	speed: 0.1162s/iter; left time: 5385.4164s
	iters: 1900, epoch: 3 | loss: 0.1007038
	speed: 0.1152s/iter; left time: 5328.2288s
	iters: 2000, epoch: 3 | loss: 0.0810669
	speed: 0.1161s/iter; left time: 5353.9627s
	iters: 2100, epoch: 3 | loss: 0.1120119
	speed: 0.1162s/iter; left time: 5349.2830s
	iters: 2200, epoch: 3 | loss: 0.1014793
	speed: 0.1159s/iter; left time: 5322.9236s
	iters: 2300, epoch: 3 | loss: 0.0782545
	speed: 0.1156s/iter; left time: 5298.5233s
	iters: 2400, epoch: 3 | loss: 0.0805253
	speed: 0.1144s/iter; left time: 5229.9599s
	iters: 2500, epoch: 3 | loss: 0.0871867
	speed: 0.1147s/iter; left time: 5233.2774s
	iters: 2600, epoch: 3 | loss: 0.0826894
	speed: 0.1139s/iter; left time: 5186.5886s
Epoch: 3 cost time: 00h:04m:44.91s
Epoch: 3 | Train Loss: 0.0897070 Vali Loss: 0.0801801 Test Loss: 0.0940483
Validation loss decreased (0.081114 --> 0.080180).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0769089
	speed: 1.0491s/iter; left time: 47586.7382s
	iters: 200, epoch: 4 | loss: 0.0909401
	speed: 0.1141s/iter; left time: 5162.4431s
	iters: 300, epoch: 4 | loss: 0.0769373
	speed: 0.1169s/iter; left time: 5280.5800s
	iters: 400, epoch: 4 | loss: 0.0873026
	speed: 0.1158s/iter; left time: 5219.3674s
	iters: 500, epoch: 4 | loss: 0.0947193
	speed: 0.1174s/iter; left time: 5280.2416s
	iters: 600, epoch: 4 | loss: 0.0831833
	speed: 0.1155s/iter; left time: 5180.0694s
	iters: 700, epoch: 4 | loss: 0.0980527
	speed: 0.1161s/iter; left time: 5194.4162s
	iters: 800, epoch: 4 | loss: 0.0867212
	speed: 0.1164s/iter; left time: 5197.0489s
	iters: 900, epoch: 4 | loss: 0.0815352
	speed: 0.1140s/iter; left time: 5078.6952s
	iters: 1000, epoch: 4 | loss: 0.0801502
	speed: 0.1139s/iter; left time: 5064.2236s
	iters: 1100, epoch: 4 | loss: 0.0883447
	speed: 0.1138s/iter; left time: 5048.9823s
	iters: 1200, epoch: 4 | loss: 0.0877123
	speed: 0.1137s/iter; left time: 5032.9758s
	iters: 1300, epoch: 4 | loss: 0.0836246
	speed: 0.1149s/iter; left time: 5076.0069s
	iters: 1400, epoch: 4 | loss: 0.0986883
	speed: 0.1153s/iter; left time: 5082.1712s
	iters: 1500, epoch: 4 | loss: 0.0836472
	speed: 0.1137s/iter; left time: 4999.1454s
	iters: 1600, epoch: 4 | loss: 0.0853868
	speed: 0.1142s/iter; left time: 5007.7051s
	iters: 1700, epoch: 4 | loss: 0.0907262
	speed: 0.1127s/iter; left time: 4932.0601s
	iters: 1800, epoch: 4 | loss: 0.0784356
	speed: 0.1122s/iter; left time: 4899.6599s
	iters: 1900, epoch: 4 | loss: 0.0888463
	speed: 0.1158s/iter; left time: 5043.7710s
	iters: 2000, epoch: 4 | loss: 0.0986566
	speed: 0.1152s/iter; left time: 5008.2468s
	iters: 2100, epoch: 4 | loss: 0.0922876
	speed: 0.1123s/iter; left time: 4870.9778s
	iters: 2200, epoch: 4 | loss: 0.0821516
	speed: 0.1154s/iter; left time: 4991.4455s
	iters: 2300, epoch: 4 | loss: 0.0900341
	speed: 0.1147s/iter; left time: 4952.2516s
	iters: 2400, epoch: 4 | loss: 0.0951754
	speed: 0.1142s/iter; left time: 4916.3450s
	iters: 2500, epoch: 4 | loss: 0.0837031
	speed: 0.1139s/iter; left time: 4891.1125s
	iters: 2600, epoch: 4 | loss: 0.0842158
	speed: 0.1163s/iter; left time: 4986.0906s
Epoch: 4 cost time: 00h:05m:07.49s
Epoch: 4 | Train Loss: 0.0869057 Vali Loss: 0.0800106 Test Loss: 0.0955628
Validation loss decreased (0.080180 --> 0.080011).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0871619
	speed: 1.0465s/iter; left time: 44668.5079s
	iters: 200, epoch: 5 | loss: 0.1035479
	speed: 0.1166s/iter; left time: 4966.4781s
	iters: 300, epoch: 5 | loss: 0.0778850
	speed: 0.1167s/iter; left time: 4960.0059s
	iters: 400, epoch: 5 | loss: 0.0712645
	speed: 0.1169s/iter; left time: 4953.1657s
	iters: 500, epoch: 5 | loss: 0.0783551
	speed: 0.1165s/iter; left time: 4925.0533s
	iters: 600, epoch: 5 | loss: 0.0905214
	speed: 0.1162s/iter; left time: 4901.8905s
	iters: 700, epoch: 5 | loss: 0.0817809
	speed: 0.1151s/iter; left time: 4844.6803s
	iters: 800, epoch: 5 | loss: 0.0813011
	speed: 0.1165s/iter; left time: 4890.1612s
	iters: 900, epoch: 5 | loss: 0.0899853
	speed: 0.1141s/iter; left time: 4779.5406s
	iters: 1000, epoch: 5 | loss: 0.0864681
	speed: 0.1146s/iter; left time: 4789.0321s
	iters: 1100, epoch: 5 | loss: 0.0875253
	speed: 0.1164s/iter; left time: 4852.1821s
	iters: 1200, epoch: 5 | loss: 0.0901085
	speed: 0.1122s/iter; left time: 4666.6779s
	iters: 1300, epoch: 5 | loss: 0.0639921
	speed: 0.1127s/iter; left time: 4674.1220s
	iters: 1400, epoch: 5 | loss: 0.0969867
	speed: 0.1155s/iter; left time: 4780.2230s
	iters: 1500, epoch: 5 | loss: 0.0761939
	speed: 0.1140s/iter; left time: 4707.7693s
	iters: 1600, epoch: 5 | loss: 0.0842133
	speed: 0.1135s/iter; left time: 4674.0158s
	iters: 1700, epoch: 5 | loss: 0.0735740
	speed: 0.1144s/iter; left time: 4701.2770s
	iters: 1800, epoch: 5 | loss: 0.0814190
	speed: 0.1134s/iter; left time: 4647.7697s
	iters: 1900, epoch: 5 | loss: 0.0850187
	speed: 0.1138s/iter; left time: 4651.2324s
	iters: 2000, epoch: 5 | loss: 0.0746921
	speed: 0.1143s/iter; left time: 4661.2029s
	iters: 2100, epoch: 5 | loss: 0.0881317
	speed: 0.1139s/iter; left time: 4633.6248s
	iters: 2200, epoch: 5 | loss: 0.0845793
	speed: 0.1158s/iter; left time: 4699.8150s
	iters: 2300, epoch: 5 | loss: 0.0848546
	speed: 0.1141s/iter; left time: 4618.5652s
	iters: 2400, epoch: 5 | loss: 0.0750976
	speed: 0.1138s/iter; left time: 4594.6637s
	iters: 2500, epoch: 5 | loss: 0.0834830
	speed: 0.1144s/iter; left time: 4609.4049s
	iters: 2600, epoch: 5 | loss: 0.0875506
	speed: 0.1140s/iter; left time: 4579.0886s
Epoch: 5 cost time: 00h:05m:07.39s
Epoch: 5 | Train Loss: 0.0848302 Vali Loss: 0.0812559 Test Loss: 0.0953243
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.1068747
	speed: 1.0150s/iter; left time: 40609.2939s
	iters: 200, epoch: 6 | loss: 0.0783328
	speed: 0.1153s/iter; left time: 4602.4415s
	iters: 300, epoch: 6 | loss: 0.0739404
	speed: 0.1158s/iter; left time: 4608.7733s
	iters: 400, epoch: 6 | loss: 0.0745426
	speed: 0.1151s/iter; left time: 4570.9422s
	iters: 500, epoch: 6 | loss: 0.0807710
	speed: 0.1141s/iter; left time: 4521.2147s
	iters: 600, epoch: 6 | loss: 0.0781820
	speed: 0.1145s/iter; left time: 4522.0859s
	iters: 700, epoch: 6 | loss: 0.0852243
	speed: 0.1138s/iter; left time: 4486.1345s
	iters: 800, epoch: 6 | loss: 0.0808892
	speed: 0.1159s/iter; left time: 4556.8919s
	iters: 900, epoch: 6 | loss: 0.0863012
	speed: 0.1144s/iter; left time: 4487.2771s
	iters: 1000, epoch: 6 | loss: 0.0845646
	speed: 0.1148s/iter; left time: 4490.8618s
	iters: 1100, epoch: 6 | loss: 0.0786446
	speed: 0.1156s/iter; left time: 4508.3062s
	iters: 1200, epoch: 6 | loss: 0.0738035
	speed: 0.1137s/iter; left time: 4424.7178s
	iters: 1300, epoch: 6 | loss: 0.0962725
	speed: 0.1139s/iter; left time: 4419.6932s
	iters: 1400, epoch: 6 | loss: 0.0873117
	speed: 0.1157s/iter; left time: 4477.5946s
	iters: 1500, epoch: 6 | loss: 0.0892730
	speed: 0.1148s/iter; left time: 4430.8446s
	iters: 1600, epoch: 6 | loss: 0.0773154
	speed: 0.1143s/iter; left time: 4400.2482s
	iters: 1700, epoch: 6 | loss: 0.0777241
	speed: 0.1152s/iter; left time: 4426.3397s
	iters: 1800, epoch: 6 | loss: 0.0818046
	speed: 0.1160s/iter; left time: 4445.0211s
	iters: 1900, epoch: 6 | loss: 0.0856868
	speed: 0.1147s/iter; left time: 4384.3465s
	iters: 2000, epoch: 6 | loss: 0.0849679
	speed: 0.1143s/iter; left time: 4357.2855s
	iters: 2100, epoch: 6 | loss: 0.0735170
	speed: 0.1158s/iter; left time: 4401.3630s
	iters: 2200, epoch: 6 | loss: 0.0838584
	speed: 0.1133s/iter; left time: 4295.5436s
	iters: 2300, epoch: 6 | loss: 0.0831294
	speed: 0.1176s/iter; left time: 4447.5343s
	iters: 2400, epoch: 6 | loss: 0.0829203
	speed: 0.1143s/iter; left time: 4309.3404s
	iters: 2500, epoch: 6 | loss: 0.0855648
	speed: 0.1149s/iter; left time: 4320.9223s
	iters: 2600, epoch: 6 | loss: 0.0735175
	speed: 0.1140s/iter; left time: 4276.1456s
Epoch: 6 cost time: 00h:05m:07.62s
Epoch: 6 | Train Loss: 0.0828304 Vali Loss: 0.0819640 Test Loss: 0.0980078
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0902265
	speed: 1.0371s/iter; left time: 38722.3254s
	iters: 200, epoch: 7 | loss: 0.0986805
	speed: 0.1142s/iter; left time: 4250.9448s
	iters: 300, epoch: 7 | loss: 0.0778703
	speed: 0.1127s/iter; left time: 4186.3723s
	iters: 400, epoch: 7 | loss: 0.0782931
	speed: 0.1160s/iter; left time: 4295.4712s
	iters: 500, epoch: 7 | loss: 0.0746187
	speed: 0.1161s/iter; left time: 4289.4106s
	iters: 600, epoch: 7 | loss: 0.0827935
	speed: 0.1153s/iter; left time: 4245.6709s
	iters: 700, epoch: 7 | loss: 0.0739331
	speed: 0.1138s/iter; left time: 4180.5216s
	iters: 800, epoch: 7 | loss: 0.0809667
	speed: 0.1159s/iter; left time: 4245.3415s
	iters: 900, epoch: 7 | loss: 0.0907432
	speed: 0.1135s/iter; left time: 4148.0988s
	iters: 1000, epoch: 7 | loss: 0.0945175
	speed: 0.1139s/iter; left time: 4151.0506s
	iters: 1100, epoch: 7 | loss: 0.0788761
	speed: 0.1161s/iter; left time: 4218.0290s
	iters: 1200, epoch: 7 | loss: 0.0823496
	speed: 0.1136s/iter; left time: 4115.4184s
	iters: 1300, epoch: 7 | loss: 0.0750478
	speed: 0.1144s/iter; left time: 4134.4843s
	iters: 1400, epoch: 7 | loss: 0.0663611
	speed: 0.1139s/iter; left time: 4105.3062s
	iters: 1500, epoch: 7 | loss: 0.0791697
	speed: 0.1154s/iter; left time: 4146.3280s
	iters: 1600, epoch: 7 | loss: 0.0843642
	speed: 0.1140s/iter; left time: 4085.1494s
	iters: 1700, epoch: 7 | loss: 0.0820326
	speed: 0.1147s/iter; left time: 4097.9003s
	iters: 1800, epoch: 7 | loss: 0.0798094
	speed: 0.1149s/iter; left time: 4093.0102s
	iters: 1900, epoch: 7 | loss: 0.0762156
	speed: 0.1138s/iter; left time: 4045.6408s
	iters: 2000, epoch: 7 | loss: 0.0743921
	speed: 0.1145s/iter; left time: 4058.3544s
	iters: 2100, epoch: 7 | loss: 0.0891102
	speed: 0.1150s/iter; left time: 4062.2655s
	iters: 2200, epoch: 7 | loss: 0.0900708
	speed: 0.1123s/iter; left time: 3958.3714s
	iters: 2300, epoch: 7 | loss: 0.0966768
	speed: 0.1148s/iter; left time: 4035.3253s
	iters: 2400, epoch: 7 | loss: 0.0648704
	speed: 0.1094s/iter; left time: 3832.9021s
	iters: 2500, epoch: 7 | loss: 0.0843473
	speed: 0.1263s/iter; left time: 4411.6532s
	iters: 2600, epoch: 7 | loss: 0.0859990
	speed: 0.1143s/iter; left time: 3981.3376s
Epoch: 7 cost time: 00h:05m:07.73s
Epoch: 7 | Train Loss: 0.0812575 Vali Loss: 0.0815965 Test Loss: 0.0964520
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0794488
	speed: 1.0163s/iter; left time: 35228.0566s
	iters: 200, epoch: 8 | loss: 0.0848540
	speed: 0.1132s/iter; left time: 3911.2718s
	iters: 300, epoch: 8 | loss: 0.0769302
	speed: 0.1125s/iter; left time: 3876.9898s
	iters: 400, epoch: 8 | loss: 0.0856332
	speed: 0.1128s/iter; left time: 3877.8341s
	iters: 500, epoch: 8 | loss: 0.0824820
	speed: 0.1137s/iter; left time: 3895.0860s
	iters: 600, epoch: 8 | loss: 0.0854290
	speed: 0.1154s/iter; left time: 3943.4592s
	iters: 700, epoch: 8 | loss: 0.0854288
	speed: 0.1132s/iter; left time: 3857.4683s
	iters: 800, epoch: 8 | loss: 0.0680083
	speed: 0.1152s/iter; left time: 3914.0443s
	iters: 900, epoch: 8 | loss: 0.0768383
	speed: 0.1128s/iter; left time: 3819.4727s
	iters: 1000, epoch: 8 | loss: 0.0693779
	speed: 0.1141s/iter; left time: 3852.3100s
	iters: 1100, epoch: 8 | loss: 0.0754587
	speed: 0.1131s/iter; left time: 3805.9977s
	iters: 1200, epoch: 8 | loss: 0.0802685
	speed: 0.1123s/iter; left time: 3770.7072s
	iters: 1300, epoch: 8 | loss: 0.0774171
	speed: 0.1106s/iter; left time: 3700.4081s
	iters: 1400, epoch: 8 | loss: 0.0754229
	speed: 0.1129s/iter; left time: 3767.4139s
	iters: 1500, epoch: 8 | loss: 0.0888831
	speed: 0.1134s/iter; left time: 3771.3276s
	iters: 1600, epoch: 8 | loss: 0.0705786
	speed: 0.1153s/iter; left time: 3823.0475s
	iters: 1700, epoch: 8 | loss: 0.0788224
	speed: 0.1161s/iter; left time: 3838.7923s
	iters: 1800, epoch: 8 | loss: 0.0689727
	speed: 0.1123s/iter; left time: 3702.2267s
	iters: 1900, epoch: 8 | loss: 0.0841972
	speed: 0.1137s/iter; left time: 3736.1949s
	iters: 2000, epoch: 8 | loss: 0.0773610
	speed: 0.1131s/iter; left time: 3705.2475s
	iters: 2100, epoch: 8 | loss: 0.0929009
	speed: 0.1137s/iter; left time: 3715.3777s
	iters: 2200, epoch: 8 | loss: 0.0882238
	speed: 0.1135s/iter; left time: 3697.1907s
	iters: 2300, epoch: 8 | loss: 0.0731173
	speed: 0.1146s/iter; left time: 3718.7553s
	iters: 2400, epoch: 8 | loss: 0.0878904
	speed: 0.1116s/iter; left time: 3611.7746s
	iters: 2500, epoch: 8 | loss: 0.0880044
	speed: 0.1123s/iter; left time: 3624.7379s
	iters: 2600, epoch: 8 | loss: 0.0914146
	speed: 0.1131s/iter; left time: 3638.1944s
Epoch: 8 cost time: 00h:05m:03.87s
Epoch: 8 | Train Loss: 0.0798089 Vali Loss: 0.0830694 Test Loss: 0.0950187
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.0826529
	speed: 1.0051s/iter; left time: 32153.6951s
	iters: 200, epoch: 9 | loss: 0.0691043
	speed: 0.1136s/iter; left time: 3623.4213s
	iters: 300, epoch: 9 | loss: 0.0827234
	speed: 0.1129s/iter; left time: 3589.9077s
	iters: 400, epoch: 9 | loss: 0.0850475
	speed: 0.1135s/iter; left time: 3597.6932s
	iters: 500, epoch: 9 | loss: 0.0775021
	speed: 0.1146s/iter; left time: 3619.6377s
	iters: 600, epoch: 9 | loss: 0.0795878
	speed: 0.1145s/iter; left time: 3605.7645s
	iters: 700, epoch: 9 | loss: 0.0837808
	speed: 0.1141s/iter; left time: 3581.4114s
	iters: 800, epoch: 9 | loss: 0.0798738
	speed: 0.1141s/iter; left time: 3568.5339s
	iters: 900, epoch: 9 | loss: 0.0779057
	speed: 0.1147s/iter; left time: 3576.2283s
	iters: 1000, epoch: 9 | loss: 0.0727953
	speed: 0.1138s/iter; left time: 3537.9186s
	iters: 1100, epoch: 9 | loss: 0.0807575
	speed: 0.1118s/iter; left time: 3463.9758s
	iters: 1200, epoch: 9 | loss: 0.0787443
	speed: 0.1131s/iter; left time: 3492.1398s
	iters: 1300, epoch: 9 | loss: 0.0788000
	speed: 0.1126s/iter; left time: 3466.7881s
	iters: 1400, epoch: 9 | loss: 0.0729088
	speed: 0.1134s/iter; left time: 3480.7516s
	iters: 1500, epoch: 9 | loss: 0.0709907
	speed: 0.1127s/iter; left time: 3447.6636s
	iters: 1600, epoch: 9 | loss: 0.0749613
	speed: 0.1132s/iter; left time: 3450.1363s
	iters: 1700, epoch: 9 | loss: 0.0788948
	speed: 0.1122s/iter; left time: 3410.4812s
	iters: 1800, epoch: 9 | loss: 0.0830306
	speed: 0.1127s/iter; left time: 3412.3783s
	iters: 1900, epoch: 9 | loss: 0.0778918
	speed: 0.1129s/iter; left time: 3409.4986s
	iters: 2000, epoch: 9 | loss: 0.0789471
	speed: 0.1115s/iter; left time: 3355.3329s
	iters: 2100, epoch: 9 | loss: 0.0754702
	speed: 0.1164s/iter; left time: 3489.8922s
	iters: 2200, epoch: 9 | loss: 0.0705925
	speed: 0.1147s/iter; left time: 3428.4263s
	iters: 2300, epoch: 9 | loss: 0.0731009
	speed: 0.1136s/iter; left time: 3383.9702s
	iters: 2400, epoch: 9 | loss: 0.0785734
	speed: 0.1141s/iter; left time: 3388.0698s
	iters: 2500, epoch: 9 | loss: 0.0922928
	speed: 0.1156s/iter; left time: 3419.5757s
	iters: 2600, epoch: 9 | loss: 0.0796332
	speed: 0.1155s/iter; left time: 3406.9806s
Epoch: 9 cost time: 00h:05m:04.53s
Epoch: 9 | Train Loss: 0.0784978 Vali Loss: 0.0850671 Test Loss: 0.0985102
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.02088882215321064, rmse:0.14452965557575226, mae:0.09556279331445694, rse:0.4245525300502777
success delete checkpoints
Intermediate time for ES and pred_len 96: 01h:00m:14.20s

=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
train 85371
val 18219
test 18219
[2024-11-03 13:31:51,060] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-03 13:31:51,984] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-03 13:31:51,984] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-03 13:31:51,984] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-03 13:31:52,087] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-03 13:31:52,087] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-03 13:31:52,844] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-03 13:31:52,845] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-03 13:31:52,845] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-03 13:31:52,846] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-03 13:31:52,846] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-03 13:31:52,846] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-03 13:31:52,846] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-03 13:31:52,847] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-03 13:31:52,847] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-03 13:31:52,847] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-03 13:31:53,247] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-03 13:31:53,248] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-03 13:31:53,248] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 76.46 GB, percent = 10.1%
[2024-11-03 13:31:53,434] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-03 13:31:53,435] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.74 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-03 13:31:53,435] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 76.48 GB, percent = 10.1%
[2024-11-03 13:31:53,435] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-03 13:31:53,587] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-03 13:31:53,588] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-03 13:31:53,589] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 76.46 GB, percent = 10.1%
[2024-11-03 13:31:53,589] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-03 13:31:53,589] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-03 13:31:53,589] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-03 13:31:53,590] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-03 13:31:53,590] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7efcb907f850>
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-03 13:31:53,591] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-03 13:31:53,592] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-03 13:31:53,593] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-03 13:31:53,593] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-03 13:31:53,593] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-03 13:31:53,593] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-03 13:31:53,593] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-03 13:31:53,593] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-03 13:31:53,593] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-03 13:31:53,593] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-03 13:31:53,593] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-03 13:31:53,593] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-03 13:31:53,593] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-03 13:31:53,593] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-03 13:31:53,593] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-03 13:31:53,593] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-03 13:31:53,593] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-03 13:31:53,593] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.2009432
	speed: 0.2035s/iter; left time: 10833.1145s
	iters: 200, epoch: 1 | loss: 0.2018673
	speed: 0.1293s/iter; left time: 6868.6140s
	iters: 300, epoch: 1 | loss: 0.1664647
	speed: 0.1290s/iter; left time: 6843.2504s
	iters: 400, epoch: 1 | loss: 0.1907074
	speed: 0.1283s/iter; left time: 6792.1821s
	iters: 500, epoch: 1 | loss: 0.1524435
	speed: 0.1282s/iter; left time: 6775.9449s
	iters: 600, epoch: 1 | loss: 0.1277965
	speed: 0.1273s/iter; left time: 6713.1010s
	iters: 700, epoch: 1 | loss: 0.1040149
	speed: 0.1279s/iter; left time: 6735.2929s
	iters: 800, epoch: 1 | loss: 0.1075614
	speed: 0.1278s/iter; left time: 6714.1902s
	iters: 900, epoch: 1 | loss: 0.1123559
	speed: 0.1285s/iter; left time: 6738.3145s
	iters: 1000, epoch: 1 | loss: 0.1132720
	speed: 0.1271s/iter; left time: 6650.2271s
	iters: 1100, epoch: 1 | loss: 0.0960071
	speed: 0.1284s/iter; left time: 6706.3182s
	iters: 1200, epoch: 1 | loss: 0.1164301
	speed: 0.1278s/iter; left time: 6661.5176s
	iters: 1300, epoch: 1 | loss: 0.1128735
	speed: 0.1285s/iter; left time: 6687.8148s
	iters: 1400, epoch: 1 | loss: 0.1040649
	speed: 0.1297s/iter; left time: 6737.2592s
	iters: 1500, epoch: 1 | loss: 0.1173225
	speed: 0.1280s/iter; left time: 6633.6710s
	iters: 1600, epoch: 1 | loss: 0.1031440
	speed: 0.1295s/iter; left time: 6699.5237s
	iters: 1700, epoch: 1 | loss: 0.0966299
	speed: 0.1276s/iter; left time: 6591.9157s
	iters: 1800, epoch: 1 | loss: 0.1064342
	speed: 0.1291s/iter; left time: 6654.9832s
	iters: 1900, epoch: 1 | loss: 0.0987400
	speed: 0.1275s/iter; left time: 6559.7447s
	iters: 2000, epoch: 1 | loss: 0.1042845
	speed: 0.1294s/iter; left time: 6643.9934s
	iters: 2100, epoch: 1 | loss: 0.0977351
	speed: 0.1279s/iter; left time: 6552.6752s
	iters: 2200, epoch: 1 | loss: 0.0965085
	speed: 0.1264s/iter; left time: 6463.5276s
	iters: 2300, epoch: 1 | loss: 0.0990303
	speed: 0.1272s/iter; left time: 6491.7162s
	iters: 2400, epoch: 1 | loss: 0.1100298
	speed: 0.1277s/iter; left time: 6505.7362s
	iters: 2500, epoch: 1 | loss: 0.0987217
	speed: 0.1287s/iter; left time: 6541.4817s
	iters: 2600, epoch: 1 | loss: 0.1110397
	speed: 0.1283s/iter; left time: 6507.8580s
Epoch: 1 cost time: 00h:05m:46.31s
Epoch: 1 | Train Loss: 0.1213860 Vali Loss: 0.0894020 Test Loss: 0.1034134
Validation loss decreased (inf --> 0.089402).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0940944
	speed: 1.1672s/iter; left time: 59029.4659s
	iters: 200, epoch: 2 | loss: 0.0937534
	speed: 0.1127s/iter; left time: 5687.0277s
	iters: 300, epoch: 2 | loss: 0.1080840
	speed: 0.1129s/iter; left time: 5685.3026s
	iters: 400, epoch: 2 | loss: 0.0966061
	speed: 0.1141s/iter; left time: 5735.0344s
	iters: 500, epoch: 2 | loss: 0.1093938
	speed: 0.1147s/iter; left time: 5756.6175s
	iters: 600, epoch: 2 | loss: 0.0923856
	speed: 0.1165s/iter; left time: 5835.2127s
	iters: 700, epoch: 2 | loss: 0.0916145
	speed: 0.1149s/iter; left time: 5742.0539s
	iters: 800, epoch: 2 | loss: 0.0939326
	speed: 0.1145s/iter; left time: 5708.3946s
	iters: 900, epoch: 2 | loss: 0.1001902
	speed: 0.1131s/iter; left time: 5629.7220s
	iters: 1000, epoch: 2 | loss: 0.0946725
	speed: 0.1164s/iter; left time: 5780.2450s
	iters: 1100, epoch: 2 | loss: 0.0976080
	speed: 0.1134s/iter; left time: 5622.9334s
	iters: 1200, epoch: 2 | loss: 0.1017308
	speed: 0.1144s/iter; left time: 5662.1506s
	iters: 1300, epoch: 2 | loss: 0.1020761
	speed: 0.1132s/iter; left time: 5588.9233s
	iters: 1400, epoch: 2 | loss: 0.0914178
	speed: 0.1127s/iter; left time: 5554.0966s
	iters: 1500, epoch: 2 | loss: 0.1076127
	speed: 0.1107s/iter; left time: 5443.4879s
	iters: 1600, epoch: 2 | loss: 0.0961113
	speed: 0.1147s/iter; left time: 5627.7270s
	iters: 1700, epoch: 2 | loss: 0.1049188
	speed: 0.1157s/iter; left time: 5664.6585s
	iters: 1800, epoch: 2 | loss: 0.0905886
	speed: 0.1133s/iter; left time: 5536.0354s
	iters: 1900, epoch: 2 | loss: 0.0959672
	speed: 0.1155s/iter; left time: 5631.1644s
	iters: 2000, epoch: 2 | loss: 0.0967659
	speed: 0.1152s/iter; left time: 5605.1883s
	iters: 2100, epoch: 2 | loss: 0.1091169
	speed: 0.1165s/iter; left time: 5656.5862s
	iters: 2200, epoch: 2 | loss: 0.0912857
	speed: 0.1129s/iter; left time: 5471.1685s
	iters: 2300, epoch: 2 | loss: 0.0814347
	speed: 0.1148s/iter; left time: 5555.4270s
	iters: 2400, epoch: 2 | loss: 0.1000843
	speed: 0.1147s/iter; left time: 5537.4035s
	iters: 2500, epoch: 2 | loss: 0.0908363
	speed: 0.1124s/iter; left time: 5415.2498s
	iters: 2600, epoch: 2 | loss: 0.0960613
	speed: 0.1152s/iter; left time: 5539.6381s
Epoch: 2 cost time: 00h:05m:05.02s
Epoch: 2 | Train Loss: 0.0975315 Vali Loss: 0.0867351 Test Loss: 0.0988254
Validation loss decreased (0.089402 --> 0.086735).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0956383
	speed: 1.0260s/iter; left time: 49153.2021s
	iters: 200, epoch: 3 | loss: 0.0700900
	speed: 0.1136s/iter; left time: 5432.9049s
	iters: 300, epoch: 3 | loss: 0.0907799
	speed: 0.1157s/iter; left time: 5521.0043s
	iters: 400, epoch: 3 | loss: 0.1059120
	speed: 0.1128s/iter; left time: 5371.1919s
	iters: 500, epoch: 3 | loss: 0.0847025
	speed: 0.1155s/iter; left time: 5489.1741s
	iters: 600, epoch: 3 | loss: 0.1060325
	speed: 0.1141s/iter; left time: 5408.1395s
	iters: 700, epoch: 3 | loss: 0.0842078
	speed: 0.1145s/iter; left time: 5418.1948s
	iters: 800, epoch: 3 | loss: 0.1065284
	speed: 0.1155s/iter; left time: 5451.8367s
	iters: 900, epoch: 3 | loss: 0.0883381
	speed: 0.1152s/iter; left time: 5427.6164s
	iters: 1000, epoch: 3 | loss: 0.0973774
	speed: 0.1147s/iter; left time: 5392.8294s
	iters: 1100, epoch: 3 | loss: 0.1029167
	speed: 0.1151s/iter; left time: 5398.3411s
	iters: 1200, epoch: 3 | loss: 0.1063046
	speed: 0.1145s/iter; left time: 5361.3742s
	iters: 1300, epoch: 3 | loss: 0.0910941
	speed: 0.1125s/iter; left time: 5255.2026s
	iters: 1400, epoch: 3 | loss: 0.0989402
	speed: 0.1167s/iter; left time: 5436.8592s
	iters: 1500, epoch: 3 | loss: 0.0897562
	speed: 0.1155s/iter; left time: 5372.7001s
	iters: 1600, epoch: 3 | loss: 0.1038726
	speed: 0.1128s/iter; left time: 5234.9290s
	iters: 1700, epoch: 3 | loss: 0.1029803
	speed: 0.1167s/iter; left time: 5402.0971s
	iters: 1800, epoch: 3 | loss: 0.0976344
	speed: 0.1143s/iter; left time: 5281.2633s
	iters: 1900, epoch: 3 | loss: 0.0954050
	speed: 0.1146s/iter; left time: 5285.8710s
	iters: 2000, epoch: 3 | loss: 0.0907561
	speed: 0.1151s/iter; left time: 5297.6428s
	iters: 2100, epoch: 3 | loss: 0.1184174
	speed: 0.1146s/iter; left time: 5259.1909s
	iters: 2200, epoch: 3 | loss: 0.0903510
	speed: 0.1169s/iter; left time: 5356.7739s
	iters: 2300, epoch: 3 | loss: 0.0935952
	speed: 0.1136s/iter; left time: 5190.0479s
	iters: 2400, epoch: 3 | loss: 0.0925637
	speed: 0.1134s/iter; left time: 5174.0763s
	iters: 2500, epoch: 3 | loss: 0.0878491
	speed: 0.1141s/iter; left time: 5191.0910s
	iters: 2600, epoch: 3 | loss: 0.1013690
	speed: 0.1146s/iter; left time: 5203.8776s
Epoch: 3 cost time: 00h:05m:06.35s
Epoch: 3 | Train Loss: 0.0937625 Vali Loss: 0.0846537 Test Loss: 0.0967681
Validation loss decreased (0.086735 --> 0.084654).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0943716
	speed: 1.0024s/iter; left time: 45349.0421s
	iters: 200, epoch: 4 | loss: 0.0859998
	speed: 0.1120s/iter; left time: 5056.7647s
	iters: 300, epoch: 4 | loss: 0.0874903
	speed: 0.1157s/iter; left time: 5209.7013s
	iters: 400, epoch: 4 | loss: 0.1020916
	speed: 0.1141s/iter; left time: 5128.7587s
	iters: 500, epoch: 4 | loss: 0.0874067
	speed: 0.1157s/iter; left time: 5186.5889s
	iters: 600, epoch: 4 | loss: 0.1072563
	speed: 0.1163s/iter; left time: 5201.6022s
	iters: 700, epoch: 4 | loss: 0.0964151
	speed: 0.1148s/iter; left time: 5122.9166s
	iters: 800, epoch: 4 | loss: 0.0861687
	speed: 0.1151s/iter; left time: 5128.6994s
	iters: 900, epoch: 4 | loss: 0.0826063
	speed: 0.1158s/iter; left time: 5148.3643s
	iters: 1000, epoch: 4 | loss: 0.0798693
	speed: 0.1149s/iter; left time: 5095.4728s
	iters: 1100, epoch: 4 | loss: 0.0928330
	speed: 0.1145s/iter; left time: 5063.9366s
	iters: 1200, epoch: 4 | loss: 0.0862791
	speed: 0.1143s/iter; left time: 5045.4097s
	iters: 1300, epoch: 4 | loss: 0.0830672
	speed: 0.1141s/iter; left time: 5023.8441s
	iters: 1400, epoch: 4 | loss: 0.0836192
	speed: 0.1138s/iter; left time: 4998.9174s
	iters: 1500, epoch: 4 | loss: 0.0898090
	speed: 0.1153s/iter; left time: 5053.3962s
	iters: 1600, epoch: 4 | loss: 0.0897531
	speed: 0.1150s/iter; left time: 5031.5050s
	iters: 1700, epoch: 4 | loss: 0.0794996
	speed: 0.1137s/iter; left time: 4962.9002s
	iters: 1800, epoch: 4 | loss: 0.0978874
	speed: 0.1142s/iter; left time: 4973.5847s
	iters: 1900, epoch: 4 | loss: 0.0965451
	speed: 0.1134s/iter; left time: 4927.6185s
	iters: 2000, epoch: 4 | loss: 0.0926374
	speed: 0.1135s/iter; left time: 4919.1444s
	iters: 2100, epoch: 4 | loss: 0.1069342
	speed: 0.1117s/iter; left time: 4830.5466s
	iters: 2200, epoch: 4 | loss: 0.0779019
	speed: 0.1142s/iter; left time: 4927.8059s
	iters: 2300, epoch: 4 | loss: 0.0973944
	speed: 0.1117s/iter; left time: 4808.6873s
	iters: 2400, epoch: 4 | loss: 0.0905181
	speed: 0.1153s/iter; left time: 4952.0385s
	iters: 2500, epoch: 4 | loss: 0.0938979
	speed: 0.1141s/iter; left time: 4887.8665s
	iters: 2600, epoch: 4 | loss: 0.0907974
	speed: 0.1140s/iter; left time: 4873.3340s
Epoch: 4 cost time: 00h:05m:05.20s
Epoch: 4 | Train Loss: 0.0911554 Vali Loss: 0.0860957 Test Loss: 0.0986955
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0987655
	speed: 0.9952s/iter; left time: 42367.6231s
	iters: 200, epoch: 5 | loss: 0.0867120
	speed: 0.1171s/iter; left time: 4973.4730s
	iters: 300, epoch: 5 | loss: 0.0962949
	speed: 0.1150s/iter; left time: 4872.4313s
	iters: 400, epoch: 5 | loss: 0.0800745
	speed: 0.1159s/iter; left time: 4899.5939s
	iters: 500, epoch: 5 | loss: 0.0932057
	speed: 0.1154s/iter; left time: 4867.5819s
	iters: 600, epoch: 5 | loss: 0.0953641
	speed: 0.1147s/iter; left time: 4824.5822s
	iters: 700, epoch: 5 | loss: 0.0878022
	speed: 0.1167s/iter; left time: 4897.0108s
	iters: 800, epoch: 5 | loss: 0.0875066
	speed: 0.1152s/iter; left time: 4824.5467s
	iters: 900, epoch: 5 | loss: 0.0935306
	speed: 0.1156s/iter; left time: 4827.2523s
	iters: 1000, epoch: 5 | loss: 0.0829855
	speed: 0.1151s/iter; left time: 4795.5210s
	iters: 1100, epoch: 5 | loss: 0.0839508
	speed: 0.1156s/iter; left time: 4807.3895s
	iters: 1200, epoch: 5 | loss: 0.0897008
	speed: 0.1156s/iter; left time: 4792.3140s
	iters: 1300, epoch: 5 | loss: 0.0881073
	speed: 0.1146s/iter; left time: 4742.8585s
	iters: 1400, epoch: 5 | loss: 0.0853253
	speed: 0.1140s/iter; left time: 4704.8949s
	iters: 1500, epoch: 5 | loss: 0.0889603
	speed: 0.1154s/iter; left time: 4752.0199s
	iters: 1600, epoch: 5 | loss: 0.1002251
	speed: 0.1152s/iter; left time: 4732.4010s
	iters: 1700, epoch: 5 | loss: 0.1032137
	speed: 0.1144s/iter; left time: 4687.8406s
	iters: 1800, epoch: 5 | loss: 0.0937006
	speed: 0.1135s/iter; left time: 4638.2335s
	iters: 1900, epoch: 5 | loss: 0.0855721
	speed: 0.1146s/iter; left time: 4671.3233s
	iters: 2000, epoch: 5 | loss: 0.0733401
	speed: 0.1138s/iter; left time: 4628.5156s
	iters: 2100, epoch: 5 | loss: 0.0945749
	speed: 0.1134s/iter; left time: 4600.9319s
	iters: 2200, epoch: 5 | loss: 0.0890472
	speed: 0.1146s/iter; left time: 4636.7185s
	iters: 2300, epoch: 5 | loss: 0.0819968
	speed: 0.1150s/iter; left time: 4642.4987s
	iters: 2400, epoch: 5 | loss: 0.0929638
	speed: 0.1133s/iter; left time: 4561.2040s
	iters: 2500, epoch: 5 | loss: 0.0771377
	speed: 0.1118s/iter; left time: 4492.8096s
	iters: 2600, epoch: 5 | loss: 0.0927820
	speed: 0.1145s/iter; left time: 4588.9597s
Epoch: 5 cost time: 00h:05m:06.40s
Epoch: 5 | Train Loss: 0.0889107 Vali Loss: 0.0877582 Test Loss: 0.1025786
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0778098
	speed: 0.9945s/iter; left time: 39685.6441s
	iters: 200, epoch: 6 | loss: 0.0997249
	speed: 0.1172s/iter; left time: 4664.5360s
	iters: 300, epoch: 6 | loss: 0.0860444
	speed: 0.1130s/iter; left time: 4487.8382s
	iters: 400, epoch: 6 | loss: 0.0840693
	speed: 0.1132s/iter; left time: 4483.2478s
	iters: 500, epoch: 6 | loss: 0.0925132
	speed: 0.1152s/iter; left time: 4551.5005s
	iters: 600, epoch: 6 | loss: 0.0898937
	speed: 0.1136s/iter; left time: 4477.7601s
	iters: 700, epoch: 6 | loss: 0.0814919
	speed: 0.1136s/iter; left time: 4463.2690s
	iters: 800, epoch: 6 | loss: 0.1018386
	speed: 0.1140s/iter; left time: 4470.2427s
	iters: 900, epoch: 6 | loss: 0.0892932
	speed: 0.1119s/iter; left time: 4376.0153s
	iters: 1000, epoch: 6 | loss: 0.1022972
	speed: 0.1144s/iter; left time: 4463.6517s
	iters: 1100, epoch: 6 | loss: 0.0904634
	speed: 0.1123s/iter; left time: 4368.4022s
	iters: 1200, epoch: 6 | loss: 0.0951061
	speed: 0.1129s/iter; left time: 4379.7294s
	iters: 1300, epoch: 6 | loss: 0.0853480
	speed: 0.1134s/iter; left time: 4387.5211s
	iters: 1400, epoch: 6 | loss: 0.0741242
	speed: 0.1127s/iter; left time: 4350.3364s
	iters: 1500, epoch: 6 | loss: 0.0868103
	speed: 0.1131s/iter; left time: 4355.5334s
	iters: 1600, epoch: 6 | loss: 0.0908482
	speed: 0.1155s/iter; left time: 4437.4801s
	iters: 1700, epoch: 6 | loss: 0.0931770
	speed: 0.1144s/iter; left time: 4381.3060s
	iters: 1800, epoch: 6 | loss: 0.0878102
	speed: 0.1139s/iter; left time: 4351.3232s
	iters: 1900, epoch: 6 | loss: 0.0864693
	speed: 0.1136s/iter; left time: 4328.0597s
	iters: 2000, epoch: 6 | loss: 0.0849704
	speed: 0.1143s/iter; left time: 4343.3339s
	iters: 2100, epoch: 6 | loss: 0.0827954
	speed: 0.1146s/iter; left time: 4342.5904s
	iters: 2200, epoch: 6 | loss: 0.0875449
	speed: 0.1159s/iter; left time: 4380.5153s
	iters: 2300, epoch: 6 | loss: 0.0922521
	speed: 0.1128s/iter; left time: 4252.8108s
	iters: 2400, epoch: 6 | loss: 0.0752860
	speed: 0.1127s/iter; left time: 4238.0111s
	iters: 2500, epoch: 6 | loss: 0.0840485
	speed: 0.1136s/iter; left time: 4262.2877s
	iters: 2600, epoch: 6 | loss: 0.0845857
	speed: 0.1137s/iter; left time: 4253.1654s
Epoch: 6 cost time: 00h:05m:04.20s
Epoch: 6 | Train Loss: 0.0867293 Vali Loss: 0.0884304 Test Loss: 0.1025518
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0863808
	speed: 0.9864s/iter; left time: 36732.8987s
	iters: 200, epoch: 7 | loss: 0.0894201
	speed: 0.1121s/iter; left time: 4164.6086s
	iters: 300, epoch: 7 | loss: 0.0827672
	speed: 0.1130s/iter; left time: 4184.5254s
	iters: 400, epoch: 7 | loss: 0.0769152
	speed: 0.1119s/iter; left time: 4134.6707s
	iters: 500, epoch: 7 | loss: 0.0987583
	speed: 0.1143s/iter; left time: 4212.1974s
	iters: 600, epoch: 7 | loss: 0.0983056
	speed: 0.1149s/iter; left time: 4219.9864s
	iters: 700, epoch: 7 | loss: 0.0806711
	speed: 0.1140s/iter; left time: 4177.7662s
	iters: 800, epoch: 7 | loss: 0.0801147
	speed: 0.1122s/iter; left time: 4100.5414s
	iters: 900, epoch: 7 | loss: 0.0864820
	speed: 0.1124s/iter; left time: 4094.9165s
	iters: 1000, epoch: 7 | loss: 0.0967652
	speed: 0.1134s/iter; left time: 4119.4826s
	iters: 1100, epoch: 7 | loss: 0.0854905
	speed: 0.1120s/iter; left time: 4058.1003s
	iters: 1200, epoch: 7 | loss: 0.0898021
	speed: 0.1120s/iter; left time: 4047.9327s
	iters: 1300, epoch: 7 | loss: 0.0775288
	speed: 0.1125s/iter; left time: 4052.7830s
	iters: 1400, epoch: 7 | loss: 0.0811367
	speed: 0.1133s/iter; left time: 4073.1715s
	iters: 1500, epoch: 7 | loss: 0.0821564
	speed: 0.1130s/iter; left time: 4048.8283s
	iters: 1600, epoch: 7 | loss: 0.0834867
	speed: 0.1149s/iter; left time: 4105.0264s
	iters: 1700, epoch: 7 | loss: 0.0906567
	speed: 0.1133s/iter; left time: 4037.1594s
	iters: 1800, epoch: 7 | loss: 0.0855301
	speed: 0.1132s/iter; left time: 4024.6562s
	iters: 1900, epoch: 7 | loss: 0.0763849
	speed: 0.1151s/iter; left time: 4080.5070s
	iters: 2000, epoch: 7 | loss: 0.0703013
	speed: 0.1135s/iter; left time: 4012.6210s
	iters: 2100, epoch: 7 | loss: 0.0814764
	speed: 0.1135s/iter; left time: 4000.1259s
	iters: 2200, epoch: 7 | loss: 0.0879330
	speed: 0.1136s/iter; left time: 3992.9013s
	iters: 2300, epoch: 7 | loss: 0.0835790
	speed: 0.1154s/iter; left time: 4043.7016s
	iters: 2400, epoch: 7 | loss: 0.0896361
	speed: 0.1151s/iter; left time: 4023.0234s
	iters: 2500, epoch: 7 | loss: 0.0880383
	speed: 0.1147s/iter; left time: 3994.3573s
	iters: 2600, epoch: 7 | loss: 0.0784809
	speed: 0.1152s/iter; left time: 4000.8033s
Epoch: 7 cost time: 00h:05m:03.25s
Epoch: 7 | Train Loss: 0.0847558 Vali Loss: 0.0862495 Test Loss: 0.0994056
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0741981
	speed: 0.9933s/iter; left time: 34339.2805s
	iters: 200, epoch: 8 | loss: 0.0925967
	speed: 0.1136s/iter; left time: 3917.0845s
	iters: 300, epoch: 8 | loss: 0.0885595
	speed: 0.1148s/iter; left time: 3946.5618s
	iters: 400, epoch: 8 | loss: 0.0859595
	speed: 0.1137s/iter; left time: 3896.4052s
	iters: 500, epoch: 8 | loss: 0.0826866
	speed: 0.1135s/iter; left time: 3878.4150s
	iters: 600, epoch: 8 | loss: 0.0911786
	speed: 0.1126s/iter; left time: 3838.0058s
	iters: 700, epoch: 8 | loss: 0.0777338
	speed: 0.1148s/iter; left time: 3901.0649s
	iters: 800, epoch: 8 | loss: 0.0907550
	speed: 0.1159s/iter; left time: 3924.6959s
	iters: 900, epoch: 8 | loss: 0.0851398
	speed: 0.1143s/iter; left time: 3860.4160s
	iters: 1000, epoch: 8 | loss: 0.0833690
	speed: 0.1141s/iter; left time: 3841.0356s
	iters: 1100, epoch: 8 | loss: 0.0865234
	speed: 0.1131s/iter; left time: 3797.9051s
	iters: 1200, epoch: 8 | loss: 0.0920289
	speed: 0.1137s/iter; left time: 3805.3657s
	iters: 1300, epoch: 8 | loss: 0.0871832
	speed: 0.1141s/iter; left time: 3807.8263s
	iters: 1400, epoch: 8 | loss: 0.0754475
	speed: 0.1139s/iter; left time: 3791.0663s
	iters: 1500, epoch: 8 | loss: 0.0724243
	speed: 0.1130s/iter; left time: 3748.3517s
	iters: 1600, epoch: 8 | loss: 0.0741268
	speed: 0.1149s/iter; left time: 3801.4922s
	iters: 1700, epoch: 8 | loss: 0.0789550
	speed: 0.1151s/iter; left time: 3795.2618s
	iters: 1800, epoch: 8 | loss: 0.0848181
	speed: 0.1131s/iter; left time: 3719.2967s
	iters: 1900, epoch: 8 | loss: 0.0913343
	speed: 0.1155s/iter; left time: 3786.3674s
	iters: 2000, epoch: 8 | loss: 0.0802559
	speed: 0.1130s/iter; left time: 3693.1555s
	iters: 2100, epoch: 8 | loss: 0.0726332
	speed: 0.1144s/iter; left time: 3725.4667s
	iters: 2200, epoch: 8 | loss: 0.0801809
	speed: 0.1176s/iter; left time: 3818.9217s
	iters: 2300, epoch: 8 | loss: 0.0922091
	speed: 0.1157s/iter; left time: 3746.9757s
	iters: 2400, epoch: 8 | loss: 0.0758863
	speed: 0.1144s/iter; left time: 3692.1940s
	iters: 2500, epoch: 8 | loss: 0.0947716
	speed: 0.1168s/iter; left time: 3757.6151s
	iters: 2600, epoch: 8 | loss: 0.0881028
	speed: 0.1149s/iter; left time: 3685.7139s
Epoch: 8 cost time: 00h:05m:05.67s
Epoch: 8 | Train Loss: 0.0829597 Vali Loss: 0.0875380 Test Loss: 0.1024083
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.02114104852080345, rmse:0.14539961516857147, mae:0.09676817059516907, rse:0.4269324839115143
success delete checkpoints
Intermediate time for ES and pred_len 168: 00h:53m:27.00s
Intermediate time for ES: 04h:00m:32.34s

=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
train 85803
val 18651
test 18651
[2024-11-03 14:25:18,527] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-03 14:25:19,550] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-03 14:25:19,551] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-03 14:25:19,551] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-03 14:25:19,613] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-03 14:25:19,613] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-03 14:25:20,311] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-03 14:25:20,312] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-03 14:25:20,312] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-03 14:25:20,313] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-03 14:25:20,313] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-03 14:25:20,313] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-03 14:25:20,313] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-03 14:25:20,313] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-03 14:25:20,313] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-03 14:25:20,313] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-03 14:25:20,667] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-03 14:25:20,669] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-03 14:25:20,702] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 76.49 GB, percent = 10.1%
[2024-11-03 14:25:20,874] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-03 14:25:20,875] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 14:25:20,876] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 76.52 GB, percent = 10.1%
[2024-11-03 14:25:20,876] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-03 14:25:21,034] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-03 14:25:21,035] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 14:25:21,035] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 76.42 GB, percent = 10.1%
[2024-11-03 14:25:21,036] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-03 14:25:21,036] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-03 14:25:21,036] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-03 14:25:21,036] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-03 14:25:21,037] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f9a91d56f50>
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-03 14:25:21,038] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-03 14:25:21,039] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-03 14:25:21,040] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-03 14:25:21,040] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-03 14:25:21,040] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-03 14:25:21,040] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-03 14:25:21,040] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-03 14:25:21,040] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-03 14:25:21,040] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-03 14:25:21,040] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-03 14:25:21,040] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-03 14:25:21,040] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-03 14:25:21,040] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-03 14:25:21,040] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-03 14:25:21,040] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1535002
	speed: 0.1670s/iter; left time: 8937.9413s
	iters: 200, epoch: 1 | loss: 0.1159472
	speed: 0.1275s/iter; left time: 6809.3841s
	iters: 300, epoch: 1 | loss: 0.1058322
	speed: 0.1286s/iter; left time: 6857.4477s
	iters: 400, epoch: 1 | loss: 0.0828711
	speed: 0.1281s/iter; left time: 6815.4143s
	iters: 500, epoch: 1 | loss: 0.0717254
	speed: 0.1262s/iter; left time: 6705.7068s
	iters: 600, epoch: 1 | loss: 0.0627306
	speed: 0.1277s/iter; left time: 6771.5508s
	iters: 700, epoch: 1 | loss: 0.0745939
	speed: 0.1279s/iter; left time: 6769.5948s
	iters: 800, epoch: 1 | loss: 0.0592833
	speed: 0.1284s/iter; left time: 6781.5981s
	iters: 900, epoch: 1 | loss: 0.0581057
	speed: 0.1259s/iter; left time: 6636.9253s
	iters: 1000, epoch: 1 | loss: 0.0899070
	speed: 0.1285s/iter; left time: 6763.9433s
	iters: 1100, epoch: 1 | loss: 0.0486953
	speed: 0.1277s/iter; left time: 6706.1418s
	iters: 1200, epoch: 1 | loss: 0.0688207
	speed: 0.1277s/iter; left time: 6694.8470s
	iters: 1300, epoch: 1 | loss: 0.0650532
	speed: 0.1284s/iter; left time: 6719.3383s
	iters: 1400, epoch: 1 | loss: 0.0587849
	speed: 0.1262s/iter; left time: 6591.1690s
	iters: 1500, epoch: 1 | loss: 0.0618791
	speed: 0.1259s/iter; left time: 6559.9799s
	iters: 1600, epoch: 1 | loss: 0.0509475
	speed: 0.1254s/iter; left time: 6524.6139s
	iters: 1700, epoch: 1 | loss: 0.0735843
	speed: 0.1276s/iter; left time: 6624.1152s
	iters: 1800, epoch: 1 | loss: 0.0482276
	speed: 0.1256s/iter; left time: 6506.3246s
	iters: 1900, epoch: 1 | loss: 0.0562918
	speed: 0.1279s/iter; left time: 6613.9771s
	iters: 2000, epoch: 1 | loss: 0.0636575
	speed: 0.1298s/iter; left time: 6700.3561s
	iters: 2100, epoch: 1 | loss: 0.0499355
	speed: 0.1273s/iter; left time: 6560.9881s
	iters: 2200, epoch: 1 | loss: 0.0701026
	speed: 0.1284s/iter; left time: 6600.1536s
	iters: 2300, epoch: 1 | loss: 0.0674836
	speed: 0.1258s/iter; left time: 6457.8720s
	iters: 2400, epoch: 1 | loss: 0.0581415
	speed: 0.1270s/iter; left time: 6507.2497s
	iters: 2500, epoch: 1 | loss: 0.0673574
	speed: 0.1290s/iter; left time: 6595.6348s
	iters: 2600, epoch: 1 | loss: 0.0543020
	speed: 0.1304s/iter; left time: 6651.2315s
Epoch: 1 cost time: 00h:05m:42.77s
Epoch: 1 | Train Loss: 0.0739179 Vali Loss: 0.0605835 Test Loss: 0.0654644
Validation loss decreased (inf --> 0.060583).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0619027
	speed: 1.1911s/iter; left time: 60556.0340s
	iters: 200, epoch: 2 | loss: 0.0812935
	speed: 0.1142s/iter; left time: 5796.6521s
	iters: 300, epoch: 2 | loss: 0.0682675
	speed: 0.1137s/iter; left time: 5756.8308s
	iters: 400, epoch: 2 | loss: 0.0864105
	speed: 0.1148s/iter; left time: 5803.4670s
	iters: 500, epoch: 2 | loss: 0.0529756
	speed: 0.1137s/iter; left time: 5734.8439s
	iters: 600, epoch: 2 | loss: 0.0543025
	speed: 0.1122s/iter; left time: 5647.7195s
	iters: 700, epoch: 2 | loss: 0.0502084
	speed: 0.1135s/iter; left time: 5704.4916s
	iters: 800, epoch: 2 | loss: 0.0579205
	speed: 0.1151s/iter; left time: 5773.4711s
	iters: 900, epoch: 2 | loss: 0.0560098
	speed: 0.1139s/iter; left time: 5697.6910s
	iters: 1000, epoch: 2 | loss: 0.0432923
	speed: 0.1140s/iter; left time: 5695.6111s
	iters: 1100, epoch: 2 | loss: 0.0533719
	speed: 0.1131s/iter; left time: 5635.8386s
	iters: 1200, epoch: 2 | loss: 0.0699260
	speed: 0.1132s/iter; left time: 5630.1798s
	iters: 1300, epoch: 2 | loss: 0.0667628
	speed: 0.1142s/iter; left time: 5667.3855s
	iters: 1400, epoch: 2 | loss: 0.0512179
	speed: 0.1156s/iter; left time: 5729.1609s
	iters: 1500, epoch: 2 | loss: 0.0579801
	speed: 0.1151s/iter; left time: 5689.2001s
	iters: 1600, epoch: 2 | loss: 0.0674562
	speed: 0.1125s/iter; left time: 5552.5770s
	iters: 1700, epoch: 2 | loss: 0.0445822
	speed: 0.1139s/iter; left time: 5607.3974s
	iters: 1800, epoch: 2 | loss: 0.0552087
	speed: 0.1140s/iter; left time: 5602.9960s
	iters: 1900, epoch: 2 | loss: 0.0708642
	speed: 0.1177s/iter; left time: 5773.8578s
	iters: 2000, epoch: 2 | loss: 0.0525380
	speed: 0.1167s/iter; left time: 5713.1574s
	iters: 2100, epoch: 2 | loss: 0.0523798
	speed: 0.1136s/iter; left time: 5549.7491s
	iters: 2200, epoch: 2 | loss: 0.0721295
	speed: 0.1166s/iter; left time: 5685.0079s
	iters: 2300, epoch: 2 | loss: 0.0610736
	speed: 0.1142s/iter; left time: 5555.7468s
	iters: 2400, epoch: 2 | loss: 0.0564372
	speed: 0.1164s/iter; left time: 5648.3881s
	iters: 2500, epoch: 2 | loss: 0.0445440
	speed: 0.1162s/iter; left time: 5627.6453s
	iters: 2600, epoch: 2 | loss: 0.0545508
	speed: 0.1149s/iter; left time: 5555.9755s
Epoch: 2 cost time: 00h:05m:07.46s
Epoch: 2 | Train Loss: 0.0589849 Vali Loss: 0.0589729 Test Loss: 0.0641147
Validation loss decreased (0.060583 --> 0.058973).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0636515
	speed: 1.0464s/iter; left time: 50393.2997s
	iters: 200, epoch: 3 | loss: 0.0587107
	speed: 0.1175s/iter; left time: 5646.8515s
	iters: 300, epoch: 3 | loss: 0.0566106
	speed: 0.1164s/iter; left time: 5582.5851s
	iters: 400, epoch: 3 | loss: 0.0612787
	speed: 0.1159s/iter; left time: 5546.6321s
	iters: 500, epoch: 3 | loss: 0.0468024
	speed: 0.1167s/iter; left time: 5574.9883s
	iters: 600, epoch: 3 | loss: 0.0613940
	speed: 0.1163s/iter; left time: 5541.0090s
	iters: 700, epoch: 3 | loss: 0.0506664
	speed: 0.1168s/iter; left time: 5554.4904s
	iters: 800, epoch: 3 | loss: 0.0535050
	speed: 0.1146s/iter; left time: 5439.7039s
	iters: 900, epoch: 3 | loss: 0.0552201
	speed: 0.1144s/iter; left time: 5418.4324s
	iters: 1000, epoch: 3 | loss: 0.0510626
	speed: 0.1163s/iter; left time: 5494.0462s
	iters: 1100, epoch: 3 | loss: 0.0414352
	speed: 0.1163s/iter; left time: 5485.1237s
	iters: 1200, epoch: 3 | loss: 0.0635938
	speed: 0.1138s/iter; left time: 5357.0654s
	iters: 1300, epoch: 3 | loss: 0.0423877
	speed: 0.1161s/iter; left time: 5452.5070s
	iters: 1400, epoch: 3 | loss: 0.0537974
	speed: 0.1151s/iter; left time: 5392.1644s
	iters: 1500, epoch: 3 | loss: 0.0664770
	speed: 0.1158s/iter; left time: 5414.7966s
	iters: 1600, epoch: 3 | loss: 0.0489237
	speed: 0.1161s/iter; left time: 5418.3764s
	iters: 1700, epoch: 3 | loss: 0.0435316
	speed: 0.1177s/iter; left time: 5479.9241s
	iters: 1800, epoch: 3 | loss: 0.0485576
	speed: 0.1181s/iter; left time: 5487.7930s
	iters: 1900, epoch: 3 | loss: 0.0613631
	speed: 0.1161s/iter; left time: 5382.2814s
	iters: 2000, epoch: 3 | loss: 0.0441004
	speed: 0.1166s/iter; left time: 5391.9324s
	iters: 2100, epoch: 3 | loss: 0.0450289
	speed: 0.1163s/iter; left time: 5370.0735s
	iters: 2200, epoch: 3 | loss: 0.0547356
	speed: 0.1152s/iter; left time: 5304.7146s
	iters: 2300, epoch: 3 | loss: 0.0599108
	speed: 0.1152s/iter; left time: 5295.8818s
	iters: 2400, epoch: 3 | loss: 0.0434626
	speed: 0.1159s/iter; left time: 5313.3749s
	iters: 2500, epoch: 3 | loss: 0.0669618
	speed: 0.1147s/iter; left time: 5246.7893s
	iters: 2600, epoch: 3 | loss: 0.0644993
	speed: 0.1144s/iter; left time: 5222.2977s
Epoch: 3 cost time: 00h:05m:11.03s
Epoch: 3 | Train Loss: 0.0563925 Vali Loss: 0.0578105 Test Loss: 0.0628996
Validation loss decreased (0.058973 --> 0.057811).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0500212
	speed: 1.0506s/iter; left time: 47778.1646s
	iters: 200, epoch: 4 | loss: 0.0662548
	speed: 0.1175s/iter; left time: 5330.5472s
	iters: 300, epoch: 4 | loss: 0.0432065
	speed: 0.1171s/iter; left time: 5300.3254s
	iters: 400, epoch: 4 | loss: 0.0570253
	speed: 0.1166s/iter; left time: 5266.3735s
	iters: 500, epoch: 4 | loss: 0.0514172
	speed: 0.1160s/iter; left time: 5229.6123s
	iters: 600, epoch: 4 | loss: 0.0459452
	speed: 0.1163s/iter; left time: 5231.5868s
	iters: 700, epoch: 4 | loss: 0.0489160
	speed: 0.1175s/iter; left time: 5272.4026s
	iters: 800, epoch: 4 | loss: 0.0543107
	speed: 0.1173s/iter; left time: 5251.5969s
	iters: 900, epoch: 4 | loss: 0.0444514
	speed: 0.1172s/iter; left time: 5235.3134s
	iters: 1000, epoch: 4 | loss: 0.0546588
	speed: 0.1172s/iter; left time: 5224.0163s
	iters: 1100, epoch: 4 | loss: 0.0588563
	speed: 0.1181s/iter; left time: 5253.8665s
	iters: 1200, epoch: 4 | loss: 0.0534603
	speed: 0.1166s/iter; left time: 5174.8999s
	iters: 1300, epoch: 4 | loss: 0.0535597
	speed: 0.1171s/iter; left time: 5183.7953s
	iters: 1400, epoch: 4 | loss: 0.0503390
	speed: 0.1161s/iter; left time: 5130.1821s
	iters: 1500, epoch: 4 | loss: 0.0542765
	speed: 0.1151s/iter; left time: 5072.2718s
	iters: 1600, epoch: 4 | loss: 0.0546105
	speed: 0.1151s/iter; left time: 5059.6824s
	iters: 1700, epoch: 4 | loss: 0.0538735
	speed: 0.1161s/iter; left time: 5095.0027s
	iters: 1800, epoch: 4 | loss: 0.0518390
	speed: 0.1178s/iter; left time: 5156.7007s
	iters: 1900, epoch: 4 | loss: 0.0519650
	speed: 0.1165s/iter; left time: 5089.3941s
	iters: 2000, epoch: 4 | loss: 0.0477860
	speed: 0.1168s/iter; left time: 5092.0510s
	iters: 2100, epoch: 4 | loss: 0.0585879
	speed: 0.1162s/iter; left time: 5052.5469s
	iters: 2200, epoch: 4 | loss: 0.0599166
	speed: 0.1159s/iter; left time: 5026.3131s
	iters: 2300, epoch: 4 | loss: 0.0504315
	speed: 0.1145s/iter; left time: 4956.8512s
	iters: 2400, epoch: 4 | loss: 0.0512709
	speed: 0.1140s/iter; left time: 4922.5263s
	iters: 2500, epoch: 4 | loss: 0.0432640
	speed: 0.1139s/iter; left time: 4905.8741s
	iters: 2600, epoch: 4 | loss: 0.0526977
	speed: 0.1152s/iter; left time: 4953.0588s
Epoch: 4 cost time: 00h:05m:11.89s
Epoch: 4 | Train Loss: 0.0547071 Vali Loss: 0.0565705 Test Loss: 0.0614690
Validation loss decreased (0.057811 --> 0.056570).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0500493
	speed: 1.0484s/iter; left time: 44866.7391s
	iters: 200, epoch: 5 | loss: 0.0452871
	speed: 0.1145s/iter; left time: 4888.1574s
	iters: 300, epoch: 5 | loss: 0.0708607
	speed: 0.1138s/iter; left time: 4846.1708s
	iters: 400, epoch: 5 | loss: 0.0393255
	speed: 0.1172s/iter; left time: 4982.5589s
	iters: 500, epoch: 5 | loss: 0.0584477
	speed: 0.1150s/iter; left time: 4875.3948s
	iters: 600, epoch: 5 | loss: 0.0544610
	speed: 0.1140s/iter; left time: 4821.9702s
	iters: 700, epoch: 5 | loss: 0.0538923
	speed: 0.1139s/iter; left time: 4805.8009s
	iters: 800, epoch: 5 | loss: 0.0542743
	speed: 0.1144s/iter; left time: 4815.9957s
	iters: 900, epoch: 5 | loss: 0.0646305
	speed: 0.1151s/iter; left time: 4835.4620s
	iters: 1000, epoch: 5 | loss: 0.0515460
	speed: 0.1158s/iter; left time: 4850.9438s
	iters: 1100, epoch: 5 | loss: 0.0574071
	speed: 0.1162s/iter; left time: 4856.9851s
	iters: 1200, epoch: 5 | loss: 0.0493728
	speed: 0.1156s/iter; left time: 4819.2445s
	iters: 1300, epoch: 5 | loss: 0.0618911
	speed: 0.1169s/iter; left time: 4862.4262s
	iters: 1400, epoch: 5 | loss: 0.0536328
	speed: 0.1164s/iter; left time: 4829.5067s
	iters: 1500, epoch: 5 | loss: 0.0613508
	speed: 0.1165s/iter; left time: 4823.5586s
	iters: 1600, epoch: 5 | loss: 0.0503679
	speed: 0.1169s/iter; left time: 4825.6196s
	iters: 1700, epoch: 5 | loss: 0.0521905
	speed: 0.1185s/iter; left time: 4882.8882s
	iters: 1800, epoch: 5 | loss: 0.0556836
	speed: 0.1160s/iter; left time: 4767.8640s
	iters: 1900, epoch: 5 | loss: 0.0641983
	speed: 0.1143s/iter; left time: 4683.9989s
	iters: 2000, epoch: 5 | loss: 0.0585940
	speed: 0.1147s/iter; left time: 4690.2370s
	iters: 2100, epoch: 5 | loss: 0.0435131
	speed: 0.1145s/iter; left time: 4672.2849s
	iters: 2200, epoch: 5 | loss: 0.0479925
	speed: 0.1142s/iter; left time: 4646.0430s
	iters: 2300, epoch: 5 | loss: 0.0534774
	speed: 0.1155s/iter; left time: 4689.6705s
	iters: 2400, epoch: 5 | loss: 0.0596892
	speed: 0.1144s/iter; left time: 4633.2802s
	iters: 2500, epoch: 5 | loss: 0.0679414
	speed: 0.1129s/iter; left time: 4560.5640s
	iters: 2600, epoch: 5 | loss: 0.0447534
	speed: 0.1147s/iter; left time: 4622.3254s
Epoch: 5 cost time: 00h:05m:09.46s
Epoch: 5 | Train Loss: 0.0534883 Vali Loss: 0.0565160 Test Loss: 0.0616658
Validation loss decreased (0.056570 --> 0.056516).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0517764
	speed: 1.0445s/iter; left time: 41900.6783s
	iters: 200, epoch: 6 | loss: 0.0638383
	speed: 0.1134s/iter; left time: 4537.3457s
	iters: 300, epoch: 6 | loss: 0.0642103
	speed: 0.1128s/iter; left time: 4502.1621s
	iters: 400, epoch: 6 | loss: 0.0472873
	speed: 0.1133s/iter; left time: 4512.5762s
	iters: 500, epoch: 6 | loss: 0.0434228
	speed: 0.1128s/iter; left time: 4479.2753s
	iters: 600, epoch: 6 | loss: 0.0501320
	speed: 0.1136s/iter; left time: 4501.4273s
	iters: 700, epoch: 6 | loss: 0.0372537
	speed: 0.1124s/iter; left time: 4441.1197s
	iters: 800, epoch: 6 | loss: 0.0626084
	speed: 0.1113s/iter; left time: 4388.8442s
	iters: 900, epoch: 6 | loss: 0.0585214
	speed: 0.1117s/iter; left time: 4392.3550s
	iters: 1000, epoch: 6 | loss: 0.0676461
	speed: 0.1126s/iter; left time: 4416.9388s
	iters: 1100, epoch: 6 | loss: 0.0532079
	speed: 0.1122s/iter; left time: 4388.2556s
	iters: 1200, epoch: 6 | loss: 0.0608200
	speed: 0.1120s/iter; left time: 4369.7022s
	iters: 1300, epoch: 6 | loss: 0.0481969
	speed: 0.1127s/iter; left time: 4384.0525s
	iters: 1400, epoch: 6 | loss: 0.0451223
	speed: 0.1121s/iter; left time: 4351.5105s
	iters: 1500, epoch: 6 | loss: 0.0623270
	speed: 0.1142s/iter; left time: 4422.8118s
	iters: 1600, epoch: 6 | loss: 0.0533873
	speed: 0.1136s/iter; left time: 4385.8150s
	iters: 1700, epoch: 6 | loss: 0.0445180
	speed: 0.1126s/iter; left time: 4336.7563s
	iters: 1800, epoch: 6 | loss: 0.0662053
	speed: 0.1132s/iter; left time: 4348.3974s
	iters: 1900, epoch: 6 | loss: 0.0493251
	speed: 0.1128s/iter; left time: 4320.9003s
	iters: 2000, epoch: 6 | loss: 0.0448093
	speed: 0.1136s/iter; left time: 4340.1308s
	iters: 2100, epoch: 6 | loss: 0.0606518
	speed: 0.1118s/iter; left time: 4261.2007s
	iters: 2200, epoch: 6 | loss: 0.0587236
	speed: 0.1131s/iter; left time: 4299.3428s
	iters: 2300, epoch: 6 | loss: 0.0420482
	speed: 0.1136s/iter; left time: 4305.8230s
	iters: 2400, epoch: 6 | loss: 0.0426998
	speed: 0.1142s/iter; left time: 4319.9757s
	iters: 2500, epoch: 6 | loss: 0.0466667
	speed: 0.1155s/iter; left time: 4355.6813s
	iters: 2600, epoch: 6 | loss: 0.0537168
	speed: 0.1127s/iter; left time: 4240.1491s
Epoch: 6 cost time: 00h:05m:03.61s
Epoch: 6 | Train Loss: 0.0525643 Vali Loss: 0.0556040 Test Loss: 0.0610864
Validation loss decreased (0.056516 --> 0.055604).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0668757
	speed: 1.0519s/iter; left time: 39376.3420s
	iters: 200, epoch: 7 | loss: 0.0545903
	speed: 0.1115s/iter; left time: 4163.8687s
	iters: 300, epoch: 7 | loss: 0.0470054
	speed: 0.1123s/iter; left time: 4181.6989s
	iters: 400, epoch: 7 | loss: 0.0559453
	speed: 0.1150s/iter; left time: 4270.1900s
	iters: 500, epoch: 7 | loss: 0.0481483
	speed: 0.1164s/iter; left time: 4309.3933s
	iters: 600, epoch: 7 | loss: 0.0419734
	speed: 0.1134s/iter; left time: 4187.1318s
	iters: 700, epoch: 7 | loss: 0.0507655
	speed: 0.1132s/iter; left time: 4171.0630s
	iters: 800, epoch: 7 | loss: 0.0553637
	speed: 0.1127s/iter; left time: 4138.8237s
	iters: 900, epoch: 7 | loss: 0.0417836
	speed: 0.1129s/iter; left time: 4136.5673s
	iters: 1000, epoch: 7 | loss: 0.0594274
	speed: 0.1124s/iter; left time: 4107.9578s
	iters: 1100, epoch: 7 | loss: 0.0467496
	speed: 0.1130s/iter; left time: 4116.9479s
	iters: 1200, epoch: 7 | loss: 0.0645316
	speed: 0.1121s/iter; left time: 4074.7185s
	iters: 1300, epoch: 7 | loss: 0.0443441
	speed: 0.1142s/iter; left time: 4136.5834s
	iters: 1400, epoch: 7 | loss: 0.0480593
	speed: 0.1133s/iter; left time: 4093.1993s
	iters: 1500, epoch: 7 | loss: 0.0565358
	speed: 0.1144s/iter; left time: 4122.1659s
	iters: 1600, epoch: 7 | loss: 0.0584448
	speed: 0.1122s/iter; left time: 4030.6157s
	iters: 1700, epoch: 7 | loss: 0.0491271
	speed: 0.1134s/iter; left time: 4063.1363s
	iters: 1800, epoch: 7 | loss: 0.0501366
	speed: 0.1122s/iter; left time: 4011.0066s
	iters: 1900, epoch: 7 | loss: 0.0490542
	speed: 0.1133s/iter; left time: 4035.9678s
	iters: 2000, epoch: 7 | loss: 0.0508287
	speed: 0.1151s/iter; left time: 4088.5964s
	iters: 2100, epoch: 7 | loss: 0.0515859
	speed: 0.1139s/iter; left time: 4036.4593s
	iters: 2200, epoch: 7 | loss: 0.0453970
	speed: 0.1135s/iter; left time: 4009.3773s
	iters: 2300, epoch: 7 | loss: 0.0537278
	speed: 0.1134s/iter; left time: 3996.6944s
	iters: 2400, epoch: 7 | loss: 0.0542764
	speed: 0.1138s/iter; left time: 3998.1799s
	iters: 2500, epoch: 7 | loss: 0.0465567
	speed: 0.1138s/iter; left time: 3985.5715s
	iters: 2600, epoch: 7 | loss: 0.0497594
	speed: 0.1147s/iter; left time: 4006.3793s
Epoch: 7 cost time: 00h:05m:04.75s
Epoch: 7 | Train Loss: 0.0518482 Vali Loss: 0.0550725 Test Loss: 0.0603381
Validation loss decreased (0.055604 --> 0.055073).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0724908
	speed: 1.0599s/iter; left time: 36834.1324s
	iters: 200, epoch: 8 | loss: 0.0371657
	speed: 0.1160s/iter; left time: 4019.2294s
	iters: 300, epoch: 8 | loss: 0.0593067
	speed: 0.1154s/iter; left time: 3985.9655s
	iters: 400, epoch: 8 | loss: 0.0512719
	speed: 0.1166s/iter; left time: 4017.0193s
	iters: 500, epoch: 8 | loss: 0.0472560
	speed: 0.1165s/iter; left time: 4003.6044s
	iters: 600, epoch: 8 | loss: 0.0475125
	speed: 0.1151s/iter; left time: 3942.3386s
	iters: 700, epoch: 8 | loss: 0.0528827
	speed: 0.1138s/iter; left time: 3886.4899s
	iters: 800, epoch: 8 | loss: 0.0542871
	speed: 0.1135s/iter; left time: 3865.0685s
	iters: 900, epoch: 8 | loss: 0.0525813
	speed: 0.1143s/iter; left time: 3880.3574s
	iters: 1000, epoch: 8 | loss: 0.0576860
	speed: 0.1137s/iter; left time: 3849.6669s
	iters: 1100, epoch: 8 | loss: 0.0429319
	speed: 0.1154s/iter; left time: 3896.3183s
	iters: 1200, epoch: 8 | loss: 0.0528561
	speed: 0.1133s/iter; left time: 3813.9504s
	iters: 1300, epoch: 8 | loss: 0.0534785
	speed: 0.1126s/iter; left time: 3778.5499s
	iters: 1400, epoch: 8 | loss: 0.0459838
	speed: 0.1152s/iter; left time: 3855.0111s
	iters: 1500, epoch: 8 | loss: 0.0495800
	speed: 0.1134s/iter; left time: 3780.7558s
	iters: 1600, epoch: 8 | loss: 0.0621961
	speed: 0.1122s/iter; left time: 3730.8639s
	iters: 1700, epoch: 8 | loss: 0.0502770
	speed: 0.1138s/iter; left time: 3771.8794s
	iters: 1800, epoch: 8 | loss: 0.0546408
	speed: 0.1121s/iter; left time: 3704.1273s
	iters: 1900, epoch: 8 | loss: 0.0553437
	speed: 0.1153s/iter; left time: 3800.1403s
	iters: 2000, epoch: 8 | loss: 0.0498420
	speed: 0.1125s/iter; left time: 3694.8584s
	iters: 2100, epoch: 8 | loss: 0.0456712
	speed: 0.1123s/iter; left time: 3676.7870s
	iters: 2200, epoch: 8 | loss: 0.0570142
	speed: 0.1142s/iter; left time: 3729.3105s
	iters: 2300, epoch: 8 | loss: 0.0586175
	speed: 0.1147s/iter; left time: 3734.0547s
	iters: 2400, epoch: 8 | loss: 0.0472034
	speed: 0.1149s/iter; left time: 3727.6649s
	iters: 2500, epoch: 8 | loss: 0.0537372
	speed: 0.1137s/iter; left time: 3677.3987s
	iters: 2600, epoch: 8 | loss: 0.0509919
	speed: 0.1121s/iter; left time: 3615.2861s
Epoch: 8 cost time: 00h:05m:06.39s
Epoch: 8 | Train Loss: 0.0511598 Vali Loss: 0.0561661 Test Loss: 0.0617564
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.0486406
	speed: 1.0277s/iter; left time: 32960.2609s
	iters: 200, epoch: 9 | loss: 0.0556457
	speed: 0.1133s/iter; left time: 3623.7339s
	iters: 300, epoch: 9 | loss: 0.0395175
	speed: 0.1130s/iter; left time: 3601.6127s
	iters: 400, epoch: 9 | loss: 0.0557750
	speed: 0.1131s/iter; left time: 3594.7021s
	iters: 500, epoch: 9 | loss: 0.0424190
	speed: 0.1129s/iter; left time: 3575.5721s
	iters: 600, epoch: 9 | loss: 0.0351209
	speed: 0.1124s/iter; left time: 3547.6705s
	iters: 700, epoch: 9 | loss: 0.0446073
	speed: 0.1135s/iter; left time: 3572.3584s
	iters: 800, epoch: 9 | loss: 0.0384792
	speed: 0.1122s/iter; left time: 3520.8111s
	iters: 900, epoch: 9 | loss: 0.0720906
	speed: 0.1121s/iter; left time: 3505.5232s
	iters: 1000, epoch: 9 | loss: 0.0432853
	speed: 0.1126s/iter; left time: 3511.5431s
	iters: 1100, epoch: 9 | loss: 0.0520263
	speed: 0.1140s/iter; left time: 3542.9423s
	iters: 1200, epoch: 9 | loss: 0.0406994
	speed: 0.1136s/iter; left time: 3518.8090s
	iters: 1300, epoch: 9 | loss: 0.0368552
	speed: 0.1128s/iter; left time: 3483.4962s
	iters: 1400, epoch: 9 | loss: 0.0537488
	speed: 0.1140s/iter; left time: 3509.3689s
	iters: 1500, epoch: 9 | loss: 0.0565366
	speed: 0.1129s/iter; left time: 3462.6149s
	iters: 1600, epoch: 9 | loss: 0.0400267
	speed: 0.1144s/iter; left time: 3497.2432s
	iters: 1700, epoch: 9 | loss: 0.0363783
	speed: 0.1132s/iter; left time: 3450.2868s
	iters: 1800, epoch: 9 | loss: 0.0432666
	speed: 0.1121s/iter; left time: 3405.0745s
	iters: 1900, epoch: 9 | loss: 0.0467523
	speed: 0.1126s/iter; left time: 3408.0894s
	iters: 2000, epoch: 9 | loss: 0.0596244
	speed: 0.1132s/iter; left time: 3416.5046s
	iters: 2100, epoch: 9 | loss: 0.0576644
	speed: 0.1129s/iter; left time: 3394.4302s
	iters: 2200, epoch: 9 | loss: 0.0496884
	speed: 0.1102s/iter; left time: 3301.5614s
	iters: 2300, epoch: 9 | loss: 0.0494345
	speed: 0.1091s/iter; left time: 3259.4055s
	iters: 2400, epoch: 9 | loss: 0.0386619
	speed: 0.1149s/iter; left time: 3420.6504s
	iters: 2500, epoch: 9 | loss: 0.0411887
	speed: 0.1115s/iter; left time: 3308.3598s
	iters: 2600, epoch: 9 | loss: 0.0443211
	speed: 0.1138s/iter; left time: 3365.7200s
Epoch: 9 cost time: 00h:05m:03.14s
Epoch: 9 | Train Loss: 0.0506318 Vali Loss: 0.0546863 Test Loss: 0.0599749
Validation loss decreased (0.055073 --> 0.054686).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 10 | loss: 0.0549749
	speed: 1.0393s/iter; left time: 30545.8957s
	iters: 200, epoch: 10 | loss: 0.0383406
	speed: 0.1121s/iter; left time: 3282.3379s
	iters: 300, epoch: 10 | loss: 0.0472804
	speed: 0.1125s/iter; left time: 3283.6315s
	iters: 400, epoch: 10 | loss: 0.0422506
	speed: 0.1118s/iter; left time: 3253.6303s
	iters: 500, epoch: 10 | loss: 0.0550114
	speed: 0.1137s/iter; left time: 3296.0525s
	iters: 600, epoch: 10 | loss: 0.0441338
	speed: 0.1127s/iter; left time: 3255.9567s
	iters: 700, epoch: 10 | loss: 0.0540485
	speed: 0.1117s/iter; left time: 3215.9544s
	iters: 800, epoch: 10 | loss: 0.0546766
	speed: 0.1133s/iter; left time: 3252.0772s
	iters: 900, epoch: 10 | loss: 0.0499431
	speed: 0.1119s/iter; left time: 3198.8956s
	iters: 1000, epoch: 10 | loss: 0.0570361
	speed: 0.1122s/iter; left time: 3195.4844s
	iters: 1100, epoch: 10 | loss: 0.0438565
	speed: 0.1123s/iter; left time: 3188.3446s
	iters: 1200, epoch: 10 | loss: 0.0453070
	speed: 0.1106s/iter; left time: 3127.9442s
	iters: 1300, epoch: 10 | loss: 0.0541585
	speed: 0.1130s/iter; left time: 3186.5914s
	iters: 1400, epoch: 10 | loss: 0.0488800
	speed: 0.1114s/iter; left time: 3129.6275s
	iters: 1500, epoch: 10 | loss: 0.0653748
	speed: 0.1134s/iter; left time: 3174.8546s
	iters: 1600, epoch: 10 | loss: 0.0513718
	speed: 0.1116s/iter; left time: 3113.5575s
	iters: 1700, epoch: 10 | loss: 0.0519211
	speed: 0.1117s/iter; left time: 3103.9028s
	iters: 1800, epoch: 10 | loss: 0.0510913
	speed: 0.1127s/iter; left time: 3121.0756s
	iters: 1900, epoch: 10 | loss: 0.0787238
	speed: 0.1153s/iter; left time: 3181.8783s
	iters: 2000, epoch: 10 | loss: 0.0443497
	speed: 0.1139s/iter; left time: 3130.7918s
	iters: 2100, epoch: 10 | loss: 0.0386278
	speed: 0.1122s/iter; left time: 3073.5192s
	iters: 2200, epoch: 10 | loss: 0.0553838
	speed: 0.1118s/iter; left time: 3051.9252s
	iters: 2300, epoch: 10 | loss: 0.0513475
	speed: 0.1139s/iter; left time: 3097.5671s
	iters: 2400, epoch: 10 | loss: 0.0396648
	speed: 0.1116s/iter; left time: 3024.2607s
	iters: 2500, epoch: 10 | loss: 0.0409211
	speed: 0.1113s/iter; left time: 3004.2385s
	iters: 2600, epoch: 10 | loss: 0.0425374
	speed: 0.1118s/iter; left time: 3007.5790s
Epoch: 10 cost time: 00h:05m:02.03s
Epoch: 10 | Train Loss: 0.0501928 Vali Loss: 0.0552204 Test Loss: 0.0600623
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 11 | loss: 0.0620002
	speed: 1.0251s/iter; left time: 27382.6088s
	iters: 200, epoch: 11 | loss: 0.0374523
	speed: 0.1119s/iter; left time: 2977.7641s
	iters: 300, epoch: 11 | loss: 0.0529428
	speed: 0.1136s/iter; left time: 3011.8567s
	iters: 400, epoch: 11 | loss: 0.0386790
	speed: 0.1130s/iter; left time: 2983.6250s
	iters: 500, epoch: 11 | loss: 0.0355124
	speed: 0.1119s/iter; left time: 2943.1978s
	iters: 600, epoch: 11 | loss: 0.0515568
	speed: 0.1151s/iter; left time: 3017.2496s
	iters: 700, epoch: 11 | loss: 0.0656706
	speed: 0.1176s/iter; left time: 3071.1696s
	iters: 800, epoch: 11 | loss: 0.0524726
	speed: 0.1126s/iter; left time: 2929.5851s
	iters: 900, epoch: 11 | loss: 0.0677181
	speed: 0.1138s/iter; left time: 2949.0683s
	iters: 1000, epoch: 11 | loss: 0.0548737
	speed: 0.1144s/iter; left time: 2951.5983s
	iters: 1100, epoch: 11 | loss: 0.0569288
	speed: 0.1127s/iter; left time: 2898.6880s
	iters: 1200, epoch: 11 | loss: 0.0609900
	speed: 0.1115s/iter; left time: 2856.0894s
	iters: 1300, epoch: 11 | loss: 0.0399404
	speed: 0.1144s/iter; left time: 2918.1807s
	iters: 1400, epoch: 11 | loss: 0.0586750
	speed: 0.1136s/iter; left time: 2886.1428s
	iters: 1500, epoch: 11 | loss: 0.0501058
	speed: 0.1107s/iter; left time: 2800.8886s
	iters: 1600, epoch: 11 | loss: 0.0411009
	speed: 0.1105s/iter; left time: 2785.1531s
	iters: 1700, epoch: 11 | loss: 0.0643648
	speed: 0.1137s/iter; left time: 2854.6794s
	iters: 1800, epoch: 11 | loss: 0.0525917
	speed: 0.1141s/iter; left time: 2854.7075s
	iters: 1900, epoch: 11 | loss: 0.0451737
	speed: 0.1122s/iter; left time: 2794.4115s
	iters: 2000, epoch: 11 | loss: 0.0579281
	speed: 0.1119s/iter; left time: 2777.5283s
	iters: 2100, epoch: 11 | loss: 0.0540055
	speed: 0.1122s/iter; left time: 2771.3486s
	iters: 2200, epoch: 11 | loss: 0.0435182
	speed: 0.1105s/iter; left time: 2718.7439s
	iters: 2300, epoch: 11 | loss: 0.0541128
	speed: 0.1131s/iter; left time: 2771.3440s
	iters: 2400, epoch: 11 | loss: 0.0472108
	speed: 0.1135s/iter; left time: 2771.5390s
	iters: 2500, epoch: 11 | loss: 0.0526714
	speed: 0.1147s/iter; left time: 2789.4014s
	iters: 2600, epoch: 11 | loss: 0.0492443
	speed: 0.1118s/iter; left time: 2706.8650s
Epoch: 11 cost time: 00h:05m:03.58s
Epoch: 11 | Train Loss: 0.0496507 Vali Loss: 0.0557215 Test Loss: 0.0603047
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 12 | loss: 0.0461969
	speed: 1.0286s/iter; left time: 24718.1822s
	iters: 200, epoch: 12 | loss: 0.0482488
	speed: 0.1127s/iter; left time: 2697.5579s
	iters: 300, epoch: 12 | loss: 0.0463038
	speed: 0.1140s/iter; left time: 2716.9514s
	iters: 400, epoch: 12 | loss: 0.0601207
	speed: 0.1123s/iter; left time: 2663.8539s
	iters: 500, epoch: 12 | loss: 0.0524425
	speed: 0.1156s/iter; left time: 2731.6391s
	iters: 600, epoch: 12 | loss: 0.0494985
	speed: 0.1158s/iter; left time: 2724.5077s
	iters: 700, epoch: 12 | loss: 0.0530444
	speed: 0.1140s/iter; left time: 2671.1297s
	iters: 800, epoch: 12 | loss: 0.0502007
	speed: 0.1148s/iter; left time: 2677.7831s
	iters: 900, epoch: 12 | loss: 0.0386652
	speed: 0.1154s/iter; left time: 2679.8984s
	iters: 1000, epoch: 12 | loss: 0.0524950
	speed: 0.1140s/iter; left time: 2637.0591s
	iters: 1100, epoch: 12 | loss: 0.0360246
	speed: 0.1154s/iter; left time: 2657.0871s
	iters: 1200, epoch: 12 | loss: 0.0573246
	speed: 0.1153s/iter; left time: 2643.9142s
	iters: 1300, epoch: 12 | loss: 0.0448311
	speed: 0.1121s/iter; left time: 2558.4108s
	iters: 1400, epoch: 12 | loss: 0.0468765
	speed: 0.1130s/iter; left time: 2568.5121s
	iters: 1500, epoch: 12 | loss: 0.0427486
	speed: 0.1146s/iter; left time: 2592.7664s
	iters: 1600, epoch: 12 | loss: 0.0422873
	speed: 0.1144s/iter; left time: 2576.6648s
	iters: 1700, epoch: 12 | loss: 0.0424657
	speed: 0.1082s/iter; left time: 2427.6676s
	iters: 1800, epoch: 12 | loss: 0.0512158
	speed: 0.1091s/iter; left time: 2436.9783s
	iters: 1900, epoch: 12 | loss: 0.0482876
	speed: 0.1118s/iter; left time: 2485.1582s
	iters: 2000, epoch: 12 | loss: 0.0403065
	speed: 0.1119s/iter; left time: 2476.3739s
	iters: 2100, epoch: 12 | loss: 0.0512401
	speed: 0.1121s/iter; left time: 2470.0594s
	iters: 2200, epoch: 12 | loss: 0.0528152
	speed: 0.1136s/iter; left time: 2490.4916s
	iters: 2300, epoch: 12 | loss: 0.0479994
	speed: 0.1122s/iter; left time: 2448.9373s
	iters: 2400, epoch: 12 | loss: 0.0547172
	speed: 0.1116s/iter; left time: 2426.1544s
	iters: 2500, epoch: 12 | loss: 0.0471118
	speed: 0.1123s/iter; left time: 2429.9498s
	iters: 2600, epoch: 12 | loss: 0.0501922
	speed: 0.1138s/iter; left time: 2449.2207s
Epoch: 12 cost time: 00h:05m:03.90s
Epoch: 12 | Train Loss: 0.0491253 Vali Loss: 0.0558346 Test Loss: 0.0616492
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 13 | loss: 0.0454289
	speed: 1.0255s/iter; left time: 21893.8210s
	iters: 200, epoch: 13 | loss: 0.0566784
	speed: 0.1133s/iter; left time: 2406.8231s
	iters: 300, epoch: 13 | loss: 0.0492385
	speed: 0.1141s/iter; left time: 2413.8053s
	iters: 400, epoch: 13 | loss: 0.0413138
	speed: 0.1131s/iter; left time: 2380.9215s
	iters: 500, epoch: 13 | loss: 0.0430361
	speed: 0.1147s/iter; left time: 2401.8599s
	iters: 600, epoch: 13 | loss: 0.0513702
	speed: 0.1137s/iter; left time: 2370.2280s
	iters: 700, epoch: 13 | loss: 0.0502950
	speed: 0.1152s/iter; left time: 2391.1957s
	iters: 800, epoch: 13 | loss: 0.0534758
	speed: 0.1164s/iter; left time: 2402.5526s
	iters: 900, epoch: 13 | loss: 0.0518013
	speed: 0.1142s/iter; left time: 2346.3902s
	iters: 1000, epoch: 13 | loss: 0.0583335
	speed: 0.1140s/iter; left time: 2331.8613s
	iters: 1100, epoch: 13 | loss: 0.0650049
	speed: 0.1123s/iter; left time: 2285.9362s
	iters: 1200, epoch: 13 | loss: 0.0528312
	speed: 0.1121s/iter; left time: 2270.7913s
	iters: 1300, epoch: 13 | loss: 0.0473740
	speed: 0.1127s/iter; left time: 2270.3789s
	iters: 1400, epoch: 13 | loss: 0.0452519
	speed: 0.1119s/iter; left time: 2243.0886s
	iters: 1500, epoch: 13 | loss: 0.0424276
	speed: 0.1122s/iter; left time: 2237.7048s
	iters: 1600, epoch: 13 | loss: 0.0521983
	speed: 0.1140s/iter; left time: 2262.3137s
	iters: 1700, epoch: 13 | loss: 0.0471075
	speed: 0.1110s/iter; left time: 2192.8490s
	iters: 1800, epoch: 13 | loss: 0.0435151
	speed: 0.1114s/iter; left time: 2188.5153s
	iters: 1900, epoch: 13 | loss: 0.0494255
	speed: 0.1151s/iter; left time: 2249.1457s
	iters: 2000, epoch: 13 | loss: 0.0469670
	speed: 0.1146s/iter; left time: 2228.1475s
	iters: 2100, epoch: 13 | loss: 0.0472251
	speed: 0.1128s/iter; left time: 2183.4210s
	iters: 2200, epoch: 13 | loss: 0.0486188
	speed: 0.1151s/iter; left time: 2215.8062s
	iters: 2300, epoch: 13 | loss: 0.0509845
	speed: 0.1136s/iter; left time: 2175.1362s
	iters: 2400, epoch: 13 | loss: 0.0457661
	speed: 0.1142s/iter; left time: 2174.7222s
	iters: 2500, epoch: 13 | loss: 0.0508229
	speed: 0.1117s/iter; left time: 2116.8378s
	iters: 2600, epoch: 13 | loss: 0.0558406
	speed: 0.1130s/iter; left time: 2129.6985s
Epoch: 13 cost time: 00h:05m:04.57s
Epoch: 13 | Train Loss: 0.0487104 Vali Loss: 0.0579919 Test Loss: 0.0634963
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 14 | loss: 0.0413323
	speed: 1.0277s/iter; left time: 19185.7892s
	iters: 200, epoch: 14 | loss: 0.0421818
	speed: 0.1115s/iter; left time: 2070.8073s
	iters: 300, epoch: 14 | loss: 0.0630368
	speed: 0.1124s/iter; left time: 2076.6077s
	iters: 400, epoch: 14 | loss: 0.0455646
	speed: 0.1125s/iter; left time: 2067.1773s
	iters: 500, epoch: 14 | loss: 0.0373397
	speed: 0.1103s/iter; left time: 2014.1091s
	iters: 600, epoch: 14 | loss: 0.0462459
	speed: 0.1112s/iter; left time: 2020.9447s
	iters: 700, epoch: 14 | loss: 0.0535143
	speed: 0.1137s/iter; left time: 2054.4473s
	iters: 800, epoch: 14 | loss: 0.0559032
	speed: 0.1129s/iter; left time: 2028.6877s
	iters: 900, epoch: 14 | loss: 0.0622907
	speed: 0.1120s/iter; left time: 2000.8022s
	iters: 1000, epoch: 14 | loss: 0.0430358
	speed: 0.1112s/iter; left time: 1975.0108s
	iters: 1100, epoch: 14 | loss: 0.0412004
	speed: 0.1117s/iter; left time: 1974.1785s
	iters: 1200, epoch: 14 | loss: 0.0447963
	speed: 0.1132s/iter; left time: 1988.1058s
	iters: 1300, epoch: 14 | loss: 0.0473538
	speed: 0.1146s/iter; left time: 2002.2731s
	iters: 1400, epoch: 14 | loss: 0.0410066
	speed: 0.1133s/iter; left time: 1967.6612s
	iters: 1500, epoch: 14 | loss: 0.0531902
	speed: 0.1126s/iter; left time: 1945.0240s
	iters: 1600, epoch: 14 | loss: 0.0443050
	speed: 0.1142s/iter; left time: 1960.8417s
	iters: 1700, epoch: 14 | loss: 0.0529488
	speed: 0.1144s/iter; left time: 1953.0810s
	iters: 1800, epoch: 14 | loss: 0.0568460
	speed: 0.1163s/iter; left time: 1973.1694s
	iters: 1900, epoch: 14 | loss: 0.0442665
	speed: 0.1132s/iter; left time: 1908.8723s
	iters: 2000, epoch: 14 | loss: 0.0497327
	speed: 0.1127s/iter; left time: 1889.8253s
	iters: 2100, epoch: 14 | loss: 0.0499501
	speed: 0.1154s/iter; left time: 1922.7709s
	iters: 2200, epoch: 14 | loss: 0.0507595
	speed: 0.1127s/iter; left time: 1867.6123s
	iters: 2300, epoch: 14 | loss: 0.0538237
	speed: 0.1122s/iter; left time: 1848.2104s
	iters: 2400, epoch: 14 | loss: 0.0460961
	speed: 0.1136s/iter; left time: 1859.4444s
	iters: 2500, epoch: 14 | loss: 0.0627327
	speed: 0.1098s/iter; left time: 1786.1661s
	iters: 2600, epoch: 14 | loss: 0.0460155
	speed: 0.1111s/iter; left time: 1796.8610s
Epoch: 14 cost time: 00h:05m:02.79s
Epoch: 14 | Train Loss: 0.0482707 Vali Loss: 0.0567447 Test Loss: 0.0618993
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.011070186272263527, rmse:0.10521495342254639, mae:0.059974875301122665, rse:0.40591442584991455
success delete checkpoints
Intermediate time for FR and pred_len 24: 01h:32m:37.52s

=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
train 85587
val 18435
test 18435
[2024-11-03 15:57:56,806] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-03 15:57:57,848] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-03 15:57:57,848] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-03 15:57:57,848] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-03 15:57:57,978] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-03 15:57:57,979] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-03 15:57:58,762] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-03 15:57:58,764] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-03 15:57:58,764] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-03 15:57:58,766] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-03 15:57:58,766] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-03 15:57:58,766] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-03 15:57:58,766] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-03 15:57:58,766] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-03 15:57:58,766] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-03 15:57:58,766] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-03 15:57:59,171] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-03 15:57:59,172] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-03 15:57:59,172] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 311.58 GB, percent = 41.3%
[2024-11-03 15:57:59,319] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-03 15:57:59,320] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 15:57:59,320] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 311.63 GB, percent = 41.3%
[2024-11-03 15:57:59,320] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-03 15:57:59,489] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-03 15:57:59,490] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 15:57:59,490] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 311.67 GB, percent = 41.3%
[2024-11-03 15:57:59,491] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-03 15:57:59,491] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-03 15:57:59,491] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-03 15:57:59,491] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-03 15:57:59,492] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-03 15:57:59,493] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-03 15:57:59,493] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-03 15:57:59,493] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-03 15:57:59,493] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-03 15:57:59,493] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-03 15:57:59,493] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-03 15:57:59,493] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-03 15:57:59,493] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-03 15:57:59,493] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-03 15:57:59,493] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-03 15:57:59,493] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f5a92bc61d0>
[2024-11-03 15:57:59,493] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-03 15:57:59,493] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-03 15:57:59,493] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-03 15:57:59,493] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-03 15:57:59,493] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-03 15:57:59,493] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-03 15:57:59,494] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-03 15:57:59,495] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-03 15:57:59,496] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1506957
	speed: 0.1707s/iter; left time: 9113.0167s
	iters: 200, epoch: 1 | loss: 0.1479850
	speed: 0.1272s/iter; left time: 6776.0640s
	iters: 300, epoch: 1 | loss: 0.1137763
	speed: 0.1266s/iter; left time: 6732.0131s
	iters: 400, epoch: 1 | loss: 0.1076533
	speed: 0.1272s/iter; left time: 6750.7454s
	iters: 500, epoch: 1 | loss: 0.0889011
	speed: 0.1260s/iter; left time: 6677.0404s
	iters: 600, epoch: 1 | loss: 0.0769084
	speed: 0.1259s/iter; left time: 6658.3469s
	iters: 700, epoch: 1 | loss: 0.0896481
	speed: 0.1268s/iter; left time: 6693.0274s
	iters: 800, epoch: 1 | loss: 0.0794844
	speed: 0.1264s/iter; left time: 6658.0271s
	iters: 900, epoch: 1 | loss: 0.0815863
	speed: 0.1259s/iter; left time: 6619.0603s
	iters: 1000, epoch: 1 | loss: 0.0779093
	speed: 0.1268s/iter; left time: 6653.2277s
	iters: 1100, epoch: 1 | loss: 0.0663487
	speed: 0.1268s/iter; left time: 6639.5392s
	iters: 1200, epoch: 1 | loss: 0.0627032
	speed: 0.1270s/iter; left time: 6641.1303s
	iters: 1300, epoch: 1 | loss: 0.0696527
	speed: 0.1250s/iter; left time: 6525.2010s
	iters: 1400, epoch: 1 | loss: 0.0784859
	speed: 0.1281s/iter; left time: 6671.6439s
	iters: 1500, epoch: 1 | loss: 0.0762833
	speed: 0.1253s/iter; left time: 6512.1729s
	iters: 1600, epoch: 1 | loss: 0.0648971
	speed: 0.1261s/iter; left time: 6542.8828s
	iters: 1700, epoch: 1 | loss: 0.0801568
	speed: 0.1264s/iter; left time: 6544.9091s
	iters: 1800, epoch: 1 | loss: 0.0775711
	speed: 0.1235s/iter; left time: 6383.1070s
	iters: 1900, epoch: 1 | loss: 0.0935053
	speed: 0.1275s/iter; left time: 6577.2110s
	iters: 2000, epoch: 1 | loss: 0.0565456
	speed: 0.1257s/iter; left time: 6472.9286s
	iters: 2100, epoch: 1 | loss: 0.0903167
	speed: 0.1253s/iter; left time: 6438.8915s
	iters: 2200, epoch: 1 | loss: 0.0752582
	speed: 0.1283s/iter; left time: 6581.6070s
	iters: 2300, epoch: 1 | loss: 0.0761704
	speed: 0.1280s/iter; left time: 6552.6275s
	iters: 2400, epoch: 1 | loss: 0.0646984
	speed: 0.1251s/iter; left time: 6390.5272s
	iters: 2500, epoch: 1 | loss: 0.0703335
	speed: 0.1260s/iter; left time: 6425.0778s
	iters: 2600, epoch: 1 | loss: 0.0783555
	speed: 0.1272s/iter; left time: 6472.8357s
Epoch: 1 cost time: 00h:05m:39.18s
Epoch: 1 | Train Loss: 0.0856850 Vali Loss: 0.0756439 Test Loss: 0.0843909
Validation loss decreased (inf --> 0.075644).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0820017
	speed: 1.1856s/iter; left time: 60116.7690s
	iters: 200, epoch: 2 | loss: 0.0687233
	speed: 0.1123s/iter; left time: 5684.0124s
	iters: 300, epoch: 2 | loss: 0.0772514
	speed: 0.1136s/iter; left time: 5735.1321s
	iters: 400, epoch: 2 | loss: 0.0848139
	speed: 0.1172s/iter; left time: 5908.0864s
	iters: 500, epoch: 2 | loss: 0.0686562
	speed: 0.1156s/iter; left time: 5817.7403s
	iters: 600, epoch: 2 | loss: 0.0745008
	speed: 0.1163s/iter; left time: 5841.3102s
	iters: 700, epoch: 2 | loss: 0.0605222
	speed: 0.1161s/iter; left time: 5817.0332s
	iters: 800, epoch: 2 | loss: 0.0737291
	speed: 0.1160s/iter; left time: 5800.6933s
	iters: 900, epoch: 2 | loss: 0.0731786
	speed: 0.1150s/iter; left time: 5737.7970s
	iters: 1000, epoch: 2 | loss: 0.0705629
	speed: 0.1147s/iter; left time: 5714.8002s
	iters: 1100, epoch: 2 | loss: 0.0684758
	speed: 0.1153s/iter; left time: 5733.4341s
	iters: 1200, epoch: 2 | loss: 0.1017207
	speed: 0.1130s/iter; left time: 5603.5418s
	iters: 1300, epoch: 2 | loss: 0.0608158
	speed: 0.1151s/iter; left time: 5699.1413s
	iters: 1400, epoch: 2 | loss: 0.0733602
	speed: 0.1129s/iter; left time: 5576.6890s
	iters: 1500, epoch: 2 | loss: 0.0823769
	speed: 0.1142s/iter; left time: 5632.0723s
	iters: 1600, epoch: 2 | loss: 0.0670033
	speed: 0.1133s/iter; left time: 5574.8166s
	iters: 1700, epoch: 2 | loss: 0.0635963
	speed: 0.1143s/iter; left time: 5613.5456s
	iters: 1800, epoch: 2 | loss: 0.0702989
	speed: 0.1162s/iter; left time: 5693.8001s
	iters: 1900, epoch: 2 | loss: 0.0682929
	speed: 0.1155s/iter; left time: 5650.0819s
	iters: 2000, epoch: 2 | loss: 0.0600829
	speed: 0.1143s/iter; left time: 5577.4614s
	iters: 2100, epoch: 2 | loss: 0.0654664
	speed: 0.1160s/iter; left time: 5650.9377s
	iters: 2200, epoch: 2 | loss: 0.0597576
	speed: 0.1135s/iter; left time: 5518.1442s
	iters: 2300, epoch: 2 | loss: 0.0667420
	speed: 0.1160s/iter; left time: 5629.2045s
	iters: 2400, epoch: 2 | loss: 0.0765030
	speed: 0.1169s/iter; left time: 5656.5137s
	iters: 2500, epoch: 2 | loss: 0.0623692
	speed: 0.1144s/iter; left time: 5527.0673s
	iters: 2600, epoch: 2 | loss: 0.0587819
	speed: 0.1134s/iter; left time: 5467.1744s
Epoch: 2 cost time: 00h:05m:07.74s
Epoch: 2 | Train Loss: 0.0710048 Vali Loss: 0.0745253 Test Loss: 0.0838230
Validation loss decreased (0.075644 --> 0.074525).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0658879
	speed: 1.0551s/iter; left time: 50679.4805s
	iters: 200, epoch: 3 | loss: 0.0615703
	speed: 0.1147s/iter; left time: 5498.9434s
	iters: 300, epoch: 3 | loss: 0.0726208
	speed: 0.1124s/iter; left time: 5374.3410s
	iters: 400, epoch: 3 | loss: 0.0762616
	speed: 0.1152s/iter; left time: 5497.1977s
	iters: 500, epoch: 3 | loss: 0.0660659
	speed: 0.1135s/iter; left time: 5404.0749s
	iters: 600, epoch: 3 | loss: 0.0651958
	speed: 0.1157s/iter; left time: 5500.9620s
	iters: 700, epoch: 3 | loss: 0.0897581
	speed: 0.1144s/iter; left time: 5425.0195s
	iters: 800, epoch: 3 | loss: 0.0652855
	speed: 0.1165s/iter; left time: 5513.4883s
	iters: 900, epoch: 3 | loss: 0.0668169
	speed: 0.1150s/iter; left time: 5429.7491s
	iters: 1000, epoch: 3 | loss: 0.0626059
	speed: 0.1127s/iter; left time: 5313.1327s
	iters: 1100, epoch: 3 | loss: 0.0549380
	speed: 0.1151s/iter; left time: 5414.6272s
	iters: 1200, epoch: 3 | loss: 0.0706437
	speed: 0.1127s/iter; left time: 5287.4627s
	iters: 1300, epoch: 3 | loss: 0.0740227
	speed: 0.1168s/iter; left time: 5471.6214s
	iters: 1400, epoch: 3 | loss: 0.0664061
	speed: 0.1158s/iter; left time: 5410.8156s
	iters: 1500, epoch: 3 | loss: 0.0757374
	speed: 0.1141s/iter; left time: 5320.4736s
	iters: 1600, epoch: 3 | loss: 0.0855467
	speed: 0.1139s/iter; left time: 5301.0619s
	iters: 1700, epoch: 3 | loss: 0.0756636
	speed: 0.1169s/iter; left time: 5428.4163s
	iters: 1800, epoch: 3 | loss: 0.0538661
	speed: 0.1141s/iter; left time: 5286.8755s
	iters: 1900, epoch: 3 | loss: 0.0783621
	speed: 0.1174s/iter; left time: 5426.1842s
	iters: 2000, epoch: 3 | loss: 0.0645575
	speed: 0.1167s/iter; left time: 5384.5331s
	iters: 2100, epoch: 3 | loss: 0.0941539
	speed: 0.1144s/iter; left time: 5266.8994s
	iters: 2200, epoch: 3 | loss: 0.0742499
	speed: 0.1152s/iter; left time: 5292.9174s
	iters: 2300, epoch: 3 | loss: 0.0604884
	speed: 0.1164s/iter; left time: 5336.3567s
	iters: 2400, epoch: 3 | loss: 0.0683079
	speed: 0.1133s/iter; left time: 5182.0659s
	iters: 2500, epoch: 3 | loss: 0.0758141
	speed: 0.1135s/iter; left time: 5177.5742s
	iters: 2600, epoch: 3 | loss: 0.0615954
	speed: 0.1145s/iter; left time: 5213.3850s
Epoch: 3 cost time: 00h:05m:07.65s
Epoch: 3 | Train Loss: 0.0687785 Vali Loss: 0.0725997 Test Loss: 0.0817405
Validation loss decreased (0.074525 --> 0.072600).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0635042
	speed: 1.0342s/iter; left time: 46908.5323s
	iters: 200, epoch: 4 | loss: 0.0766480
	speed: 0.1169s/iter; left time: 5290.6569s
	iters: 300, epoch: 4 | loss: 0.0603194
	speed: 0.1149s/iter; left time: 5190.9310s
	iters: 400, epoch: 4 | loss: 0.0879604
	speed: 0.1153s/iter; left time: 5196.5941s
	iters: 500, epoch: 4 | loss: 0.0716096
	speed: 0.1173s/iter; left time: 5274.9817s
	iters: 600, epoch: 4 | loss: 0.0661810
	speed: 0.1123s/iter; left time: 5036.5761s
	iters: 700, epoch: 4 | loss: 0.0630168
	speed: 0.1146s/iter; left time: 5130.1413s
	iters: 800, epoch: 4 | loss: 0.0750177
	speed: 0.1139s/iter; left time: 5085.6809s
	iters: 900, epoch: 4 | loss: 0.0560872
	speed: 0.1120s/iter; left time: 4991.7414s
	iters: 1000, epoch: 4 | loss: 0.0561997
	speed: 0.1138s/iter; left time: 5061.1343s
	iters: 1100, epoch: 4 | loss: 0.0634589
	speed: 0.1102s/iter; left time: 4889.6764s
	iters: 1200, epoch: 4 | loss: 0.0602584
	speed: 0.1117s/iter; left time: 4944.1367s
	iters: 1300, epoch: 4 | loss: 0.0809753
	speed: 0.1122s/iter; left time: 4952.7185s
	iters: 1400, epoch: 4 | loss: 0.0696282
	speed: 0.1121s/iter; left time: 4940.2120s
	iters: 1500, epoch: 4 | loss: 0.0582918
	speed: 0.1145s/iter; left time: 5032.7009s
	iters: 1600, epoch: 4 | loss: 0.0587403
	speed: 0.1132s/iter; left time: 4966.3179s
	iters: 1700, epoch: 4 | loss: 0.0575944
	speed: 0.1112s/iter; left time: 4867.8195s
	iters: 1800, epoch: 4 | loss: 0.0667402
	speed: 0.1137s/iter; left time: 4962.0644s
	iters: 1900, epoch: 4 | loss: 0.0664581
	speed: 0.1148s/iter; left time: 5002.5965s
	iters: 2000, epoch: 4 | loss: 0.0745811
	speed: 0.1129s/iter; left time: 4907.8576s
	iters: 2100, epoch: 4 | loss: 0.0695823
	speed: 0.1111s/iter; left time: 4817.2379s
	iters: 2200, epoch: 4 | loss: 0.0542657
	speed: 0.1129s/iter; left time: 4882.6145s
	iters: 2300, epoch: 4 | loss: 0.0670997
	speed: 0.1105s/iter; left time: 4770.8912s
	iters: 2400, epoch: 4 | loss: 0.0595331
	speed: 0.1125s/iter; left time: 4843.8712s
	iters: 2500, epoch: 4 | loss: 0.0590853
	speed: 0.1134s/iter; left time: 4869.7242s
	iters: 2600, epoch: 4 | loss: 0.0622148
	speed: 0.1115s/iter; left time: 4778.2491s
Epoch: 4 cost time: 00h:05m:03.21s
Epoch: 4 | Train Loss: 0.0669450 Vali Loss: 0.0741470 Test Loss: 0.0824094
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0655506
	speed: 1.0279s/iter; left time: 43876.3073s
	iters: 200, epoch: 5 | loss: 0.0827420
	speed: 0.1139s/iter; left time: 4849.6463s
	iters: 300, epoch: 5 | loss: 0.0619815
	speed: 0.1149s/iter; left time: 4883.1241s
	iters: 400, epoch: 5 | loss: 0.0519550
	speed: 0.1118s/iter; left time: 4738.8475s
	iters: 500, epoch: 5 | loss: 0.0678731
	speed: 0.1125s/iter; left time: 4758.4126s
	iters: 600, epoch: 5 | loss: 0.0686385
	speed: 0.1133s/iter; left time: 4778.2636s
	iters: 700, epoch: 5 | loss: 0.0715512
	speed: 0.1117s/iter; left time: 4700.8591s
	iters: 800, epoch: 5 | loss: 0.0702961
	speed: 0.1136s/iter; left time: 4770.0126s
	iters: 900, epoch: 5 | loss: 0.0748347
	speed: 0.1141s/iter; left time: 4778.6170s
	iters: 1000, epoch: 5 | loss: 0.0546004
	speed: 0.1121s/iter; left time: 4682.2282s
	iters: 1100, epoch: 5 | loss: 0.0699323
	speed: 0.1169s/iter; left time: 4871.2229s
	iters: 1200, epoch: 5 | loss: 0.0556661
	speed: 0.1123s/iter; left time: 4670.5481s
	iters: 1300, epoch: 5 | loss: 0.0645581
	speed: 0.1148s/iter; left time: 4764.2947s
	iters: 1400, epoch: 5 | loss: 0.0688608
	speed: 0.1150s/iter; left time: 4758.5611s
	iters: 1500, epoch: 5 | loss: 0.0485171
	speed: 0.1118s/iter; left time: 4615.0795s
	iters: 1600, epoch: 5 | loss: 0.0664087
	speed: 0.1126s/iter; left time: 4638.3682s
	iters: 1700, epoch: 5 | loss: 0.0548556
	speed: 0.1134s/iter; left time: 4659.2041s
	iters: 1800, epoch: 5 | loss: 0.0654618
	speed: 0.1146s/iter; left time: 4695.4469s
	iters: 1900, epoch: 5 | loss: 0.0673945
	speed: 0.1149s/iter; left time: 4697.6498s
	iters: 2000, epoch: 5 | loss: 0.0469344
	speed: 0.1129s/iter; left time: 4602.5989s
	iters: 2100, epoch: 5 | loss: 0.0672865
	speed: 0.1125s/iter; left time: 4578.5228s
	iters: 2200, epoch: 5 | loss: 0.0703256
	speed: 0.1153s/iter; left time: 4679.2620s
	iters: 2300, epoch: 5 | loss: 0.0843584
	speed: 0.1133s/iter; left time: 4586.4834s
	iters: 2400, epoch: 5 | loss: 0.0603486
	speed: 0.1109s/iter; left time: 4477.8991s
	iters: 2500, epoch: 5 | loss: 0.0761832
	speed: 0.1141s/iter; left time: 4597.2399s
	iters: 2600, epoch: 5 | loss: 0.0514573
	speed: 0.1127s/iter; left time: 4528.0888s
Epoch: 5 cost time: 00h:05m:03.59s
Epoch: 5 | Train Loss: 0.0649131 Vali Loss: 0.0754854 Test Loss: 0.0844793
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0773710
	speed: 1.0069s/iter; left time: 40285.6555s
	iters: 200, epoch: 6 | loss: 0.0613844
	speed: 0.1138s/iter; left time: 4542.1712s
	iters: 300, epoch: 6 | loss: 0.0576228
	speed: 0.1128s/iter; left time: 4491.8380s
	iters: 400, epoch: 6 | loss: 0.0596324
	speed: 0.1127s/iter; left time: 4476.8733s
	iters: 500, epoch: 6 | loss: 0.0579083
	speed: 0.1122s/iter; left time: 4442.8573s
	iters: 600, epoch: 6 | loss: 0.0726682
	speed: 0.1135s/iter; left time: 4482.6344s
	iters: 700, epoch: 6 | loss: 0.0726198
	speed: 0.1146s/iter; left time: 4516.1612s
	iters: 800, epoch: 6 | loss: 0.0645957
	speed: 0.1146s/iter; left time: 4504.1012s
	iters: 900, epoch: 6 | loss: 0.0725977
	speed: 0.1156s/iter; left time: 4531.2633s
	iters: 1000, epoch: 6 | loss: 0.0638610
	speed: 0.1151s/iter; left time: 4501.1788s
	iters: 1100, epoch: 6 | loss: 0.0556347
	speed: 0.1140s/iter; left time: 4446.7623s
	iters: 1200, epoch: 6 | loss: 0.0472695
	speed: 0.1152s/iter; left time: 4481.4860s
	iters: 1300, epoch: 6 | loss: 0.0792933
	speed: 0.1131s/iter; left time: 4389.8681s
	iters: 1400, epoch: 6 | loss: 0.0675426
	speed: 0.1117s/iter; left time: 4322.6630s
	iters: 1500, epoch: 6 | loss: 0.0533914
	speed: 0.1132s/iter; left time: 4371.7503s
	iters: 1600, epoch: 6 | loss: 0.0623400
	speed: 0.1111s/iter; left time: 4278.8181s
	iters: 1700, epoch: 6 | loss: 0.0586607
	speed: 0.1123s/iter; left time: 4311.9919s
	iters: 1800, epoch: 6 | loss: 0.0620784
	speed: 0.1118s/iter; left time: 4283.5127s
	iters: 1900, epoch: 6 | loss: 0.0596254
	speed: 0.1134s/iter; left time: 4334.5241s
	iters: 2000, epoch: 6 | loss: 0.0587260
	speed: 0.1135s/iter; left time: 4326.0426s
	iters: 2100, epoch: 6 | loss: 0.0641739
	speed: 0.1125s/iter; left time: 4277.7994s
	iters: 2200, epoch: 6 | loss: 0.0735683
	speed: 0.1132s/iter; left time: 4293.3688s
	iters: 2300, epoch: 6 | loss: 0.0535805
	speed: 0.1139s/iter; left time: 4307.2052s
	iters: 2400, epoch: 6 | loss: 0.0671832
	speed: 0.1129s/iter; left time: 4257.8680s
	iters: 2500, epoch: 6 | loss: 0.0640754
	speed: 0.1123s/iter; left time: 4224.7128s
	iters: 2600, epoch: 6 | loss: 0.0475231
	speed: 0.1124s/iter; left time: 4216.1819s
Epoch: 6 cost time: 00h:05m:03.11s
Epoch: 6 | Train Loss: 0.0630431 Vali Loss: 0.0751659 Test Loss: 0.0838745
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0737136
	speed: 1.0189s/iter; left time: 38040.9426s
	iters: 200, epoch: 7 | loss: 0.0773198
	speed: 0.1144s/iter; left time: 4260.6138s
	iters: 300, epoch: 7 | loss: 0.0562561
	speed: 0.1137s/iter; left time: 4224.2310s
	iters: 400, epoch: 7 | loss: 0.0674500
	speed: 0.1141s/iter; left time: 4224.7118s
	iters: 500, epoch: 7 | loss: 0.0538294
	speed: 0.1153s/iter; left time: 4259.2230s
	iters: 600, epoch: 7 | loss: 0.0683504
	speed: 0.1155s/iter; left time: 4254.6560s
	iters: 700, epoch: 7 | loss: 0.0571279
	speed: 0.1155s/iter; left time: 4244.5785s
	iters: 800, epoch: 7 | loss: 0.0532890
	speed: 0.1145s/iter; left time: 4193.3060s
	iters: 900, epoch: 7 | loss: 0.0591477
	speed: 0.1146s/iter; left time: 4187.5830s
	iters: 1000, epoch: 7 | loss: 0.0772009
	speed: 0.1166s/iter; left time: 4248.5963s
	iters: 1100, epoch: 7 | loss: 0.0556193
	speed: 0.1131s/iter; left time: 4110.9963s
	iters: 1200, epoch: 7 | loss: 0.0560169
	speed: 0.1131s/iter; left time: 4097.1813s
	iters: 1300, epoch: 7 | loss: 0.0597722
	speed: 0.1163s/iter; left time: 4204.4354s
	iters: 1400, epoch: 7 | loss: 0.0604149
	speed: 0.1141s/iter; left time: 4111.2249s
	iters: 1500, epoch: 7 | loss: 0.0788255
	speed: 0.1133s/iter; left time: 4070.2651s
	iters: 1600, epoch: 7 | loss: 0.0704609
	speed: 0.1124s/iter; left time: 4028.6042s
	iters: 1700, epoch: 7 | loss: 0.0629530
	speed: 0.1124s/iter; left time: 4015.4502s
	iters: 1800, epoch: 7 | loss: 0.0610598
	speed: 0.1121s/iter; left time: 3994.9430s
	iters: 1900, epoch: 7 | loss: 0.0446289
	speed: 0.1151s/iter; left time: 4089.8119s
	iters: 2000, epoch: 7 | loss: 0.0594098
	speed: 0.1126s/iter; left time: 3991.0313s
	iters: 2100, epoch: 7 | loss: 0.0708012
	speed: 0.1122s/iter; left time: 3965.9981s
	iters: 2200, epoch: 7 | loss: 0.0720370
	speed: 0.1143s/iter; left time: 4026.7334s
	iters: 2300, epoch: 7 | loss: 0.0789985
	speed: 0.1111s/iter; left time: 3903.4207s
	iters: 2400, epoch: 7 | loss: 0.0545131
	speed: 0.1114s/iter; left time: 3902.6692s
	iters: 2500, epoch: 7 | loss: 0.0678101
	speed: 0.1142s/iter; left time: 3990.9587s
	iters: 2600, epoch: 7 | loss: 0.0619310
	speed: 0.1112s/iter; left time: 3873.8694s
Epoch: 7 cost time: 00h:05m:04.62s
Epoch: 7 | Train Loss: 0.0613680 Vali Loss: 0.0761664 Test Loss: 0.0845503
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0591804
	speed: 1.0174s/iter; left time: 35265.2915s
	iters: 200, epoch: 8 | loss: 0.0601895
	speed: 0.1139s/iter; left time: 3936.2679s
	iters: 300, epoch: 8 | loss: 0.0537779
	speed: 0.1147s/iter; left time: 3951.2009s
	iters: 400, epoch: 8 | loss: 0.0596471
	speed: 0.1150s/iter; left time: 3952.8149s
	iters: 500, epoch: 8 | loss: 0.0748389
	speed: 0.1152s/iter; left time: 3946.7594s
	iters: 600, epoch: 8 | loss: 0.0619526
	speed: 0.1142s/iter; left time: 3900.6351s
	iters: 700, epoch: 8 | loss: 0.0492099
	speed: 0.1158s/iter; left time: 3943.2424s
	iters: 800, epoch: 8 | loss: 0.0553380
	speed: 0.1146s/iter; left time: 3893.2388s
	iters: 900, epoch: 8 | loss: 0.0660264
	speed: 0.1124s/iter; left time: 3804.8857s
	iters: 1000, epoch: 8 | loss: 0.0512587
	speed: 0.1160s/iter; left time: 3916.6093s
	iters: 1100, epoch: 8 | loss: 0.0606477
	speed: 0.1154s/iter; left time: 3885.3929s
	iters: 1200, epoch: 8 | loss: 0.0488810
	speed: 0.1150s/iter; left time: 3860.4352s
	iters: 1300, epoch: 8 | loss: 0.0636803
	speed: 0.1152s/iter; left time: 3854.7517s
	iters: 1400, epoch: 8 | loss: 0.0603122
	speed: 0.1152s/iter; left time: 3843.0386s
	iters: 1500, epoch: 8 | loss: 0.0753196
	speed: 0.1143s/iter; left time: 3802.7447s
	iters: 1600, epoch: 8 | loss: 0.0476781
	speed: 0.1152s/iter; left time: 3820.4807s
	iters: 1700, epoch: 8 | loss: 0.0543786
	speed: 0.1175s/iter; left time: 3885.4586s
	iters: 1800, epoch: 8 | loss: 0.0479689
	speed: 0.1144s/iter; left time: 3772.0123s
	iters: 1900, epoch: 8 | loss: 0.0567113
	speed: 0.1152s/iter; left time: 3786.4991s
	iters: 2000, epoch: 8 | loss: 0.0584764
	speed: 0.1148s/iter; left time: 3762.3402s
	iters: 2100, epoch: 8 | loss: 0.0674268
	speed: 0.1149s/iter; left time: 3753.6997s
	iters: 2200, epoch: 8 | loss: 0.0617867
	speed: 0.1140s/iter; left time: 3711.0942s
	iters: 2300, epoch: 8 | loss: 0.0588714
	speed: 0.1135s/iter; left time: 3684.6010s
	iters: 2400, epoch: 8 | loss: 0.0716897
	speed: 0.1161s/iter; left time: 3756.1475s
	iters: 2500, epoch: 8 | loss: 0.0649153
	speed: 0.1134s/iter; left time: 3658.8856s
	iters: 2600, epoch: 8 | loss: 0.0538609
	speed: 0.1148s/iter; left time: 3691.1308s
Epoch: 8 cost time: 00h:05m:07.49s
Epoch: 8 | Train Loss: 0.0601105 Vali Loss: 0.0785164 Test Loss: 0.0872316
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.018459701910614967, rmse:0.13586649298667908, mae:0.08174050599336624, rse:0.5256097912788391
success delete checkpoints
Intermediate time for FR and pred_len 96: 00h:53m:37.48s

=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
train 85371
val 18219
test 18219
[2024-11-03 16:51:34,589] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-03 16:51:35,763] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-03 16:51:35,764] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-03 16:51:35,764] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-03 16:51:35,879] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-03 16:51:35,879] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-03 16:51:36,608] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-03 16:51:36,609] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-03 16:51:36,609] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-03 16:51:36,610] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-03 16:51:36,611] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-03 16:51:36,611] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-03 16:51:36,611] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-03 16:51:36,611] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-03 16:51:36,611] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-03 16:51:36,611] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-03 16:51:37,007] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-03 16:51:37,008] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-03 16:51:37,008] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 312.97 GB, percent = 41.5%
[2024-11-03 16:51:37,202] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-03 16:51:37,203] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.74 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-03 16:51:37,203] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 313.01 GB, percent = 41.5%
[2024-11-03 16:51:37,203] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-03 16:51:37,377] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-03 16:51:37,378] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-03 16:51:37,379] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 313.01 GB, percent = 41.5%
[2024-11-03 16:51:37,380] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-03 16:51:37,380] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-03 16:51:37,380] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-03 16:51:37,380] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-03 16:51:37,381] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-03 16:51:37,381] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-03 16:51:37,381] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-03 16:51:37,381] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-03 16:51:37,381] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fd374ba9ed0>
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-03 16:51:37,382] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-03 16:51:37,383] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-03 16:51:37,384] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-03 16:51:37,384] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-03 16:51:37,384] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1461806
	speed: 0.1728s/iter; left time: 9201.6091s
	iters: 200, epoch: 1 | loss: 0.1501896
	speed: 0.1258s/iter; left time: 6685.5717s
	iters: 300, epoch: 1 | loss: 0.1255645
	speed: 0.1265s/iter; left time: 6707.1471s
	iters: 400, epoch: 1 | loss: 0.0948358
	speed: 0.1274s/iter; left time: 6742.0429s
	iters: 500, epoch: 1 | loss: 0.0860671
	speed: 0.1254s/iter; left time: 6627.6459s
	iters: 600, epoch: 1 | loss: 0.0797759
	speed: 0.1268s/iter; left time: 6686.3868s
	iters: 700, epoch: 1 | loss: 0.0779733
	speed: 0.1257s/iter; left time: 6618.0314s
	iters: 800, epoch: 1 | loss: 0.0854992
	speed: 0.1223s/iter; left time: 6426.5638s
	iters: 900, epoch: 1 | loss: 0.0824629
	speed: 0.1239s/iter; left time: 6498.8014s
	iters: 1000, epoch: 1 | loss: 0.0905522
	speed: 0.1266s/iter; left time: 6625.9316s
	iters: 1100, epoch: 1 | loss: 0.0848468
	speed: 0.1262s/iter; left time: 6591.7380s
	iters: 1200, epoch: 1 | loss: 0.0831938
	speed: 0.1253s/iter; left time: 6531.3858s
	iters: 1300, epoch: 1 | loss: 0.0840276
	speed: 0.1238s/iter; left time: 6443.5033s
	iters: 1400, epoch: 1 | loss: 0.0715065
	speed: 0.1244s/iter; left time: 6459.2688s
	iters: 1500, epoch: 1 | loss: 0.0868700
	speed: 0.1237s/iter; left time: 6412.8650s
	iters: 1600, epoch: 1 | loss: 0.0816183
	speed: 0.1259s/iter; left time: 6516.6899s
	iters: 1700, epoch: 1 | loss: 0.0746674
	speed: 0.1258s/iter; left time: 6496.2027s
	iters: 1800, epoch: 1 | loss: 0.0842547
	speed: 0.1277s/iter; left time: 6581.8055s
	iters: 1900, epoch: 1 | loss: 0.0750883
	speed: 0.1244s/iter; left time: 6396.8053s
	iters: 2000, epoch: 1 | loss: 0.0767707
	speed: 0.1264s/iter; left time: 6489.2698s
	iters: 2100, epoch: 1 | loss: 0.0823143
	speed: 0.1248s/iter; left time: 6394.4898s
	iters: 2200, epoch: 1 | loss: 0.0773541
	speed: 0.1260s/iter; left time: 6441.5222s
	iters: 2300, epoch: 1 | loss: 0.0822798
	speed: 0.1244s/iter; left time: 6351.4653s
	iters: 2400, epoch: 1 | loss: 0.0697680
	speed: 0.1264s/iter; left time: 6440.4329s
	iters: 2500, epoch: 1 | loss: 0.0781708
	speed: 0.1239s/iter; left time: 6299.2218s
	iters: 2600, epoch: 1 | loss: 0.0923201
	speed: 0.1256s/iter; left time: 6372.9236s
Epoch: 1 cost time: 00h:05m:35.64s
Epoch: 1 | Train Loss: 0.0882067 Vali Loss: 0.0789939 Test Loss: 0.0885378
Validation loss decreased (inf --> 0.078994).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0682366
	speed: 1.1571s/iter; left time: 58517.2971s
	iters: 200, epoch: 2 | loss: 0.0756340
	speed: 0.1126s/iter; left time: 5682.0940s
	iters: 300, epoch: 2 | loss: 0.0757687
	speed: 0.1163s/iter; left time: 5856.8647s
	iters: 400, epoch: 2 | loss: 0.0809062
	speed: 0.1147s/iter; left time: 5765.0768s
	iters: 500, epoch: 2 | loss: 0.0785947
	speed: 0.1158s/iter; left time: 5810.3476s
	iters: 600, epoch: 2 | loss: 0.0788290
	speed: 0.1148s/iter; left time: 5748.4740s
	iters: 700, epoch: 2 | loss: 0.0643081
	speed: 0.1140s/iter; left time: 5699.4764s
	iters: 800, epoch: 2 | loss: 0.0724190
	speed: 0.1153s/iter; left time: 5749.9291s
	iters: 900, epoch: 2 | loss: 0.0765032
	speed: 0.1134s/iter; left time: 5645.3463s
	iters: 1000, epoch: 2 | loss: 0.0680958
	speed: 0.1127s/iter; left time: 5596.1018s
	iters: 1100, epoch: 2 | loss: 0.0636572
	speed: 0.1140s/iter; left time: 5650.9959s
	iters: 1200, epoch: 2 | loss: 0.0647527
	speed: 0.1138s/iter; left time: 5628.4425s
	iters: 1300, epoch: 2 | loss: 0.0695712
	speed: 0.1125s/iter; left time: 5556.3360s
	iters: 1400, epoch: 2 | loss: 0.0781222
	speed: 0.1108s/iter; left time: 5459.3519s
	iters: 1500, epoch: 2 | loss: 0.0884119
	speed: 0.1148s/iter; left time: 5646.0649s
	iters: 1600, epoch: 2 | loss: 0.0732782
	speed: 0.1128s/iter; left time: 5537.6323s
	iters: 1700, epoch: 2 | loss: 0.0834294
	speed: 0.1125s/iter; left time: 5510.1069s
	iters: 1800, epoch: 2 | loss: 0.0762573
	speed: 0.1135s/iter; left time: 5545.8452s
	iters: 1900, epoch: 2 | loss: 0.0638730
	speed: 0.1122s/iter; left time: 5473.9790s
	iters: 2000, epoch: 2 | loss: 0.0719824
	speed: 0.1118s/iter; left time: 5440.0921s
	iters: 2100, epoch: 2 | loss: 0.0811448
	speed: 0.1130s/iter; left time: 5487.5219s
	iters: 2200, epoch: 2 | loss: 0.0702735
	speed: 0.1139s/iter; left time: 5522.9308s
	iters: 2300, epoch: 2 | loss: 0.0598425
	speed: 0.1125s/iter; left time: 5441.5109s
	iters: 2400, epoch: 2 | loss: 0.0801101
	speed: 0.1135s/iter; left time: 5481.4252s
	iters: 2500, epoch: 2 | loss: 0.0596308
	speed: 0.1117s/iter; left time: 5383.4181s
	iters: 2600, epoch: 2 | loss: 0.0712510
	speed: 0.1133s/iter; left time: 5448.0658s
Epoch: 2 cost time: 00h:05m:03.32s
Epoch: 2 | Train Loss: 0.0743254 Vali Loss: 0.0777038 Test Loss: 0.0871744
Validation loss decreased (0.078994 --> 0.077704).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0675267
	speed: 1.0175s/iter; left time: 48745.3355s
	iters: 200, epoch: 3 | loss: 0.0488273
	speed: 0.1142s/iter; left time: 5457.8495s
	iters: 300, epoch: 3 | loss: 0.0692624
	speed: 0.1129s/iter; left time: 5385.2999s
	iters: 400, epoch: 3 | loss: 0.0781940
	speed: 0.1140s/iter; left time: 5425.0041s
	iters: 500, epoch: 3 | loss: 0.0633163
	speed: 0.1146s/iter; left time: 5446.1456s
	iters: 600, epoch: 3 | loss: 0.0786292
	speed: 0.1144s/iter; left time: 5422.7847s
	iters: 700, epoch: 3 | loss: 0.0660528
	speed: 0.1128s/iter; left time: 5334.5753s
	iters: 800, epoch: 3 | loss: 0.0873496
	speed: 0.1138s/iter; left time: 5373.4053s
	iters: 900, epoch: 3 | loss: 0.0665047
	speed: 0.1121s/iter; left time: 5280.7909s
	iters: 1000, epoch: 3 | loss: 0.0717470
	speed: 0.1128s/iter; left time: 5303.9321s
	iters: 1100, epoch: 3 | loss: 0.0673361
	speed: 0.1147s/iter; left time: 5382.1805s
	iters: 1200, epoch: 3 | loss: 0.0878783
	speed: 0.1125s/iter; left time: 5267.7362s
	iters: 1300, epoch: 3 | loss: 0.0672138
	speed: 0.1147s/iter; left time: 5357.9900s
	iters: 1400, epoch: 3 | loss: 0.0739039
	speed: 0.1151s/iter; left time: 5365.0421s
	iters: 1500, epoch: 3 | loss: 0.0644442
	speed: 0.1117s/iter; left time: 5195.0276s
	iters: 1600, epoch: 3 | loss: 0.0913087
	speed: 0.1122s/iter; left time: 5206.8303s
	iters: 1700, epoch: 3 | loss: 0.0859381
	speed: 0.1127s/iter; left time: 5219.3783s
	iters: 1800, epoch: 3 | loss: 0.0756321
	speed: 0.1105s/iter; left time: 5107.9640s
	iters: 1900, epoch: 3 | loss: 0.0888247
	speed: 0.1094s/iter; left time: 5043.7622s
	iters: 2000, epoch: 3 | loss: 0.0595378
	speed: 0.1115s/iter; left time: 5127.8967s
	iters: 2100, epoch: 3 | loss: 0.0935414
	speed: 0.1130s/iter; left time: 5188.4238s
	iters: 2200, epoch: 3 | loss: 0.0669725
	speed: 0.1131s/iter; left time: 5178.5974s
	iters: 2300, epoch: 3 | loss: 0.0605008
	speed: 0.1144s/iter; left time: 5227.8167s
	iters: 2400, epoch: 3 | loss: 0.0831451
	speed: 0.1111s/iter; left time: 5066.6465s
	iters: 2500, epoch: 3 | loss: 0.0697700
	speed: 0.1123s/iter; left time: 5112.1039s
	iters: 2600, epoch: 3 | loss: 0.0661712
	speed: 0.1122s/iter; left time: 5095.2971s
Epoch: 3 cost time: 00h:05m:01.88s
Epoch: 3 | Train Loss: 0.0718358 Vali Loss: 0.0789278 Test Loss: 0.0876987
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0648829
	speed: 0.9919s/iter; left time: 44872.7863s
	iters: 200, epoch: 4 | loss: 0.0765537
	speed: 0.1145s/iter; left time: 5167.3367s
	iters: 300, epoch: 4 | loss: 0.0551690
	speed: 0.1123s/iter; left time: 5059.4413s
	iters: 400, epoch: 4 | loss: 0.0743216
	speed: 0.1145s/iter; left time: 5144.3220s
	iters: 500, epoch: 4 | loss: 0.0566139
	speed: 0.1147s/iter; left time: 5143.2865s
	iters: 600, epoch: 4 | loss: 0.0790194
	speed: 0.1133s/iter; left time: 5069.6998s
	iters: 700, epoch: 4 | loss: 0.0843454
	speed: 0.1173s/iter; left time: 5234.2535s
	iters: 800, epoch: 4 | loss: 0.0670473
	speed: 0.1154s/iter; left time: 5138.4053s
	iters: 900, epoch: 4 | loss: 0.0606182
	speed: 0.1156s/iter; left time: 5136.3097s
	iters: 1000, epoch: 4 | loss: 0.0734311
	speed: 0.1161s/iter; left time: 5148.5885s
	iters: 1100, epoch: 4 | loss: 0.0760170
	speed: 0.1164s/iter; left time: 5150.3318s
	iters: 1200, epoch: 4 | loss: 0.0643949
	speed: 0.1147s/iter; left time: 5062.8959s
	iters: 1300, epoch: 4 | loss: 0.0647174
	speed: 0.1145s/iter; left time: 5043.0254s
	iters: 1400, epoch: 4 | loss: 0.0552365
	speed: 0.1156s/iter; left time: 5077.9105s
	iters: 1500, epoch: 4 | loss: 0.0723340
	speed: 0.1150s/iter; left time: 5040.2806s
	iters: 1600, epoch: 4 | loss: 0.0671190
	speed: 0.1131s/iter; left time: 4948.4789s
	iters: 1700, epoch: 4 | loss: 0.0635535
	speed: 0.1122s/iter; left time: 4895.0363s
	iters: 1800, epoch: 4 | loss: 0.0668017
	speed: 0.1162s/iter; left time: 5058.7632s
	iters: 1900, epoch: 4 | loss: 0.0685256
	speed: 0.1150s/iter; left time: 4994.0688s
	iters: 2000, epoch: 4 | loss: 0.0721530
	speed: 0.1153s/iter; left time: 4996.1174s
	iters: 2100, epoch: 4 | loss: 0.0882780
	speed: 0.1124s/iter; left time: 4859.0463s
	iters: 2200, epoch: 4 | loss: 0.0493336
	speed: 0.1148s/iter; left time: 4954.4873s
	iters: 2300, epoch: 4 | loss: 0.0750259
	speed: 0.1153s/iter; left time: 4964.6474s
	iters: 2400, epoch: 4 | loss: 0.0622560
	speed: 0.1117s/iter; left time: 4798.4092s
	iters: 2500, epoch: 4 | loss: 0.0759433
	speed: 0.1141s/iter; left time: 4887.5694s
	iters: 2600, epoch: 4 | loss: 0.0722388
	speed: 0.1123s/iter; left time: 4800.1817s
Epoch: 4 cost time: 00h:05m:05.82s
Epoch: 4 | Train Loss: 0.0692130 Vali Loss: 0.0806310 Test Loss: 0.0891718
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0739205
	speed: 1.0042s/iter; left time: 42753.4276s
	iters: 200, epoch: 5 | loss: 0.0671281
	speed: 0.1143s/iter; left time: 4853.5783s
	iters: 300, epoch: 5 | loss: 0.0831495
	speed: 0.1165s/iter; left time: 4937.0348s
	iters: 400, epoch: 5 | loss: 0.0562803
	speed: 0.1164s/iter; left time: 4918.9635s
	iters: 500, epoch: 5 | loss: 0.0612629
	speed: 0.1151s/iter; left time: 4855.1824s
	iters: 600, epoch: 5 | loss: 0.0725645
	speed: 0.1160s/iter; left time: 4880.8346s
	iters: 700, epoch: 5 | loss: 0.0736510
	speed: 0.1155s/iter; left time: 4846.2801s
	iters: 800, epoch: 5 | loss: 0.0621689
	speed: 0.1132s/iter; left time: 4738.0259s
	iters: 900, epoch: 5 | loss: 0.0703253
	speed: 0.1148s/iter; left time: 4794.1539s
	iters: 1000, epoch: 5 | loss: 0.0583030
	speed: 0.1140s/iter; left time: 4751.3104s
	iters: 1100, epoch: 5 | loss: 0.0703888
	speed: 0.1148s/iter; left time: 4771.1987s
	iters: 1200, epoch: 5 | loss: 0.0585797
	speed: 0.1134s/iter; left time: 4704.2690s
	iters: 1300, epoch: 5 | loss: 0.0742435
	speed: 0.1126s/iter; left time: 4659.8960s
	iters: 1400, epoch: 5 | loss: 0.0719956
	speed: 0.1149s/iter; left time: 4742.0219s
	iters: 1500, epoch: 5 | loss: 0.0606002
	speed: 0.1151s/iter; left time: 4737.2574s
	iters: 1600, epoch: 5 | loss: 0.0692182
	speed: 0.1123s/iter; left time: 4611.1768s
	iters: 1700, epoch: 5 | loss: 0.0654579
	speed: 0.1119s/iter; left time: 4585.1680s
	iters: 1800, epoch: 5 | loss: 0.0808130
	speed: 0.1136s/iter; left time: 4642.1484s
	iters: 1900, epoch: 5 | loss: 0.0635292
	speed: 0.1130s/iter; left time: 4606.2225s
	iters: 2000, epoch: 5 | loss: 0.0533435
	speed: 0.1117s/iter; left time: 4544.1873s
	iters: 2100, epoch: 5 | loss: 0.0679128
	speed: 0.1130s/iter; left time: 4586.4621s
	iters: 2200, epoch: 5 | loss: 0.0734313
	speed: 0.1126s/iter; left time: 4556.3801s
	iters: 2300, epoch: 5 | loss: 0.0613091
	speed: 0.1141s/iter; left time: 4607.2712s
	iters: 2400, epoch: 5 | loss: 0.0723060
	speed: 0.1129s/iter; left time: 4547.2335s
	iters: 2500, epoch: 5 | loss: 0.0571138
	speed: 0.1128s/iter; left time: 4530.7935s
	iters: 2600, epoch: 5 | loss: 0.0643532
	speed: 0.1128s/iter; left time: 4520.1549s
Epoch: 5 cost time: 00h:05m:04.35s
Epoch: 5 | Train Loss: 0.0666898 Vali Loss: 0.0816376 Test Loss: 0.0911526
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0592945
	speed: 0.9876s/iter; left time: 39411.1732s
	iters: 200, epoch: 6 | loss: 0.0701825
	speed: 0.1144s/iter; left time: 4555.2524s
	iters: 300, epoch: 6 | loss: 0.0733728
	speed: 0.1133s/iter; left time: 4498.4615s
	iters: 400, epoch: 6 | loss: 0.0500985
	speed: 0.1121s/iter; left time: 4440.6552s
	iters: 500, epoch: 6 | loss: 0.0708840
	speed: 0.1141s/iter; left time: 4508.6746s
	iters: 600, epoch: 6 | loss: 0.0746798
	speed: 0.1151s/iter; left time: 4534.9810s
	iters: 700, epoch: 6 | loss: 0.0672090
	speed: 0.1126s/iter; left time: 4426.7414s
	iters: 800, epoch: 6 | loss: 0.0675267
	speed: 0.1126s/iter; left time: 4416.2322s
	iters: 900, epoch: 6 | loss: 0.0650174
	speed: 0.1131s/iter; left time: 4422.3891s
	iters: 1000, epoch: 6 | loss: 0.0685931
	speed: 0.1135s/iter; left time: 4427.0639s
	iters: 1100, epoch: 6 | loss: 0.0609383
	speed: 0.1119s/iter; left time: 4351.8524s
	iters: 1200, epoch: 6 | loss: 0.0727255
	speed: 0.1125s/iter; left time: 4365.8285s
	iters: 1300, epoch: 6 | loss: 0.0623817
	speed: 0.1120s/iter; left time: 4335.5399s
	iters: 1400, epoch: 6 | loss: 0.0603095
	speed: 0.1135s/iter; left time: 4380.0029s
	iters: 1500, epoch: 6 | loss: 0.0660724
	speed: 0.1131s/iter; left time: 4353.1481s
	iters: 1600, epoch: 6 | loss: 0.0712819
	speed: 0.1116s/iter; left time: 4285.8897s
	iters: 1700, epoch: 6 | loss: 0.0682647
	speed: 0.1127s/iter; left time: 4318.5119s
	iters: 1800, epoch: 6 | loss: 0.0655491
	speed: 0.1132s/iter; left time: 4325.5446s
	iters: 1900, epoch: 6 | loss: 0.0615094
	speed: 0.1136s/iter; left time: 4329.7846s
	iters: 2000, epoch: 6 | loss: 0.0686113
	speed: 0.1129s/iter; left time: 4292.6018s
	iters: 2100, epoch: 6 | loss: 0.0684695
	speed: 0.1131s/iter; left time: 4286.8611s
	iters: 2200, epoch: 6 | loss: 0.0678513
	speed: 0.1119s/iter; left time: 4230.2983s
	iters: 2300, epoch: 6 | loss: 0.0722934
	speed: 0.1124s/iter; left time: 4237.9501s
	iters: 2400, epoch: 6 | loss: 0.0518117
	speed: 0.1115s/iter; left time: 4194.3563s
	iters: 2500, epoch: 6 | loss: 0.0615523
	speed: 0.1132s/iter; left time: 4244.6177s
	iters: 2600, epoch: 6 | loss: 0.0523729
	speed: 0.1137s/iter; left time: 4252.3758s
Epoch: 6 cost time: 00h:05m:01.92s
Epoch: 6 | Train Loss: 0.0646321 Vali Loss: 0.0833404 Test Loss: 0.0923264
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0626126
	speed: 0.9871s/iter; left time: 36759.9347s
	iters: 200, epoch: 7 | loss: 0.0635089
	speed: 0.1141s/iter; left time: 4239.2426s
	iters: 300, epoch: 7 | loss: 0.0645225
	speed: 0.1116s/iter; left time: 4132.2544s
	iters: 400, epoch: 7 | loss: 0.0587169
	speed: 0.1136s/iter; left time: 4194.6714s
	iters: 500, epoch: 7 | loss: 0.0679099
	speed: 0.1126s/iter; left time: 4147.4079s
	iters: 600, epoch: 7 | loss: 0.0761093
	speed: 0.1128s/iter; left time: 4143.3336s
	iters: 700, epoch: 7 | loss: 0.0614073
	speed: 0.1146s/iter; left time: 4200.4443s
	iters: 800, epoch: 7 | loss: 0.0606054
	speed: 0.1138s/iter; left time: 4156.8729s
	iters: 900, epoch: 7 | loss: 0.0640666
	speed: 0.1133s/iter; left time: 4128.3271s
	iters: 1000, epoch: 7 | loss: 0.0652940
	speed: 0.1120s/iter; left time: 4068.4261s
	iters: 1100, epoch: 7 | loss: 0.0591778
	speed: 0.1137s/iter; left time: 4122.0008s
	iters: 1200, epoch: 7 | loss: 0.0599352
	speed: 0.1132s/iter; left time: 4091.2681s
	iters: 1300, epoch: 7 | loss: 0.0674185
	speed: 0.1136s/iter; left time: 4094.0902s
	iters: 1400, epoch: 7 | loss: 0.0645608
	speed: 0.1127s/iter; left time: 4048.6741s
	iters: 1500, epoch: 7 | loss: 0.0626351
	speed: 0.1126s/iter; left time: 4036.2563s
	iters: 1600, epoch: 7 | loss: 0.0564335
	speed: 0.1140s/iter; left time: 4075.1212s
	iters: 1700, epoch: 7 | loss: 0.0628764
	speed: 0.1123s/iter; left time: 4002.8423s
	iters: 1800, epoch: 7 | loss: 0.0579112
	speed: 0.1133s/iter; left time: 4025.9566s
	iters: 1900, epoch: 7 | loss: 0.0576657
	speed: 0.1140s/iter; left time: 4039.2995s
	iters: 2000, epoch: 7 | loss: 0.0645774
	speed: 0.1120s/iter; left time: 3958.6573s
	iters: 2100, epoch: 7 | loss: 0.0611573
	speed: 0.1133s/iter; left time: 3991.7090s
	iters: 2200, epoch: 7 | loss: 0.0668616
	speed: 0.1108s/iter; left time: 3891.7385s
	iters: 2300, epoch: 7 | loss: 0.0692711
	speed: 0.1121s/iter; left time: 3927.3236s
	iters: 2400, epoch: 7 | loss: 0.0704450
	speed: 0.1122s/iter; left time: 3920.1121s
	iters: 2500, epoch: 7 | loss: 0.0594643
	speed: 0.1145s/iter; left time: 3987.4141s
	iters: 2600, epoch: 7 | loss: 0.0567257
	speed: 0.1143s/iter; left time: 3971.3102s
Epoch: 7 cost time: 00h:05m:01.84s
Epoch: 7 | Train Loss: 0.0629600 Vali Loss: 0.0832727 Test Loss: 0.0938695
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.02040581777691841, rmse:0.142848938703537, mae:0.08717440813779831, rse:0.5534131526947021
success delete checkpoints
Intermediate time for FR and pred_len 168: 00h:46m:39.29s
Intermediate time for FR: 03h:12m:54.28s

=== Starting experiments for country: IT ===

=== Starting experiments for pred_len: 24 ===

--- Running model for IT, pred_len=24 ---
train 85803
val 18651
test 18651
[2024-11-03 17:38:13,775] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-03 17:38:14,961] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-03 17:38:14,962] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-03 17:38:14,962] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-03 17:38:15,055] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-03 17:38:15,055] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-03 17:38:15,742] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-03 17:38:15,744] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-03 17:38:15,744] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-03 17:38:15,745] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-03 17:38:15,745] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-03 17:38:15,745] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-03 17:38:15,745] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-03 17:38:15,745] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-03 17:38:15,745] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-03 17:38:15,745] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-03 17:38:16,138] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-03 17:38:16,141] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-03 17:38:16,141] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 311.71 GB, percent = 41.3%
[2024-11-03 17:38:16,321] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-03 17:38:16,322] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 17:38:16,322] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 311.71 GB, percent = 41.3%
[2024-11-03 17:38:16,322] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-03 17:38:16,520] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-03 17:38:16,521] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 17:38:16,521] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 311.6 GB, percent = 41.3%
[2024-11-03 17:38:16,522] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-03 17:38:16,522] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-03 17:38:16,522] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-03 17:38:16,522] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-03 17:38:16,523] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-03 17:38:16,523] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-03 17:38:16,523] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f7e6cfcd050>
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-03 17:38:16,524] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-03 17:38:16,525] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-03 17:38:16,526] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-03 17:38:16,526] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-03 17:38:16,526] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-03 17:38:16,526] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-03 17:38:16,526] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-03 17:38:16,526] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-03 17:38:16,526] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-03 17:38:16,526] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1961632
	speed: 0.1721s/iter; left time: 9212.2875s
	iters: 200, epoch: 1 | loss: 0.1897899
	speed: 0.1240s/iter; left time: 6625.8756s
	iters: 300, epoch: 1 | loss: 0.1400119
	speed: 0.1264s/iter; left time: 6740.8285s
	iters: 400, epoch: 1 | loss: 0.1414553
	speed: 0.1249s/iter; left time: 6646.2304s
	iters: 500, epoch: 1 | loss: 0.1245781
	speed: 0.1244s/iter; left time: 6608.3626s
	iters: 600, epoch: 1 | loss: 0.0947767
	speed: 0.1283s/iter; left time: 6802.8842s
	iters: 700, epoch: 1 | loss: 0.0984841
	speed: 0.1260s/iter; left time: 6670.1009s
	iters: 800, epoch: 1 | loss: 0.0828382
	speed: 0.1247s/iter; left time: 6585.5102s
	iters: 900, epoch: 1 | loss: 0.0719742
	speed: 0.1284s/iter; left time: 6768.0768s
	iters: 1000, epoch: 1 | loss: 0.1195307
	speed: 0.1332s/iter; left time: 7008.2822s
	iters: 1100, epoch: 1 | loss: 0.0817368
	speed: 0.1278s/iter; left time: 6709.7699s
	iters: 1200, epoch: 1 | loss: 0.0921901
	speed: 0.1293s/iter; left time: 6778.1289s
	iters: 1300, epoch: 1 | loss: 0.0989637
	speed: 0.1268s/iter; left time: 6632.0273s
	iters: 1400, epoch: 1 | loss: 0.0795155
	speed: 0.1257s/iter; left time: 6565.8398s
	iters: 1500, epoch: 1 | loss: 0.0898348
	speed: 0.1275s/iter; left time: 6645.7793s
	iters: 1600, epoch: 1 | loss: 0.0705952
	speed: 0.1250s/iter; left time: 6502.1500s
	iters: 1700, epoch: 1 | loss: 0.0890884
	speed: 0.1274s/iter; left time: 6616.2715s
	iters: 1800, epoch: 1 | loss: 0.0708546
	speed: 0.1278s/iter; left time: 6621.3609s
	iters: 1900, epoch: 1 | loss: 0.0823215
	speed: 0.1279s/iter; left time: 6614.7988s
	iters: 2000, epoch: 1 | loss: 0.0903587
	speed: 0.1271s/iter; left time: 6558.6651s
	iters: 2100, epoch: 1 | loss: 0.0667403
	speed: 0.1263s/iter; left time: 6506.3228s
	iters: 2200, epoch: 1 | loss: 0.0840566
	speed: 0.1270s/iter; left time: 6530.3758s
	iters: 2300, epoch: 1 | loss: 0.1007551
	speed: 0.1270s/iter; left time: 6517.5440s
	iters: 2400, epoch: 1 | loss: 0.0791763
	speed: 0.1250s/iter; left time: 6404.0763s
	iters: 2500, epoch: 1 | loss: 0.0936417
	speed: 0.1246s/iter; left time: 6368.7051s
	iters: 2600, epoch: 1 | loss: 0.0681735
	speed: 0.1263s/iter; left time: 6441.6549s
Epoch: 1 cost time: 00h:05m:40.50s
Epoch: 1 | Train Loss: 0.1042742 Vali Loss: 0.0697548 Test Loss: 0.0724680
Validation loss decreased (inf --> 0.069755).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0968200
	speed: 1.1964s/iter; left time: 60823.4643s
	iters: 200, epoch: 2 | loss: 0.0908526
	speed: 0.1135s/iter; left time: 5759.7286s
	iters: 300, epoch: 2 | loss: 0.0880430
	speed: 0.1132s/iter; left time: 5733.4311s
	iters: 400, epoch: 2 | loss: 0.0909087
	speed: 0.1148s/iter; left time: 5800.0278s
	iters: 500, epoch: 2 | loss: 0.0755832
	speed: 0.1150s/iter; left time: 5800.8973s
	iters: 600, epoch: 2 | loss: 0.0719677
	speed: 0.1130s/iter; left time: 5690.1754s
	iters: 700, epoch: 2 | loss: 0.0632761
	speed: 0.1161s/iter; left time: 5833.7360s
	iters: 800, epoch: 2 | loss: 0.0799158
	speed: 0.1135s/iter; left time: 5689.4282s
	iters: 900, epoch: 2 | loss: 0.0778257
	speed: 0.1120s/iter; left time: 5604.9770s
	iters: 1000, epoch: 2 | loss: 0.0686750
	speed: 0.1139s/iter; left time: 5689.7352s
	iters: 1100, epoch: 2 | loss: 0.0759580
	speed: 0.1121s/iter; left time: 5589.1426s
	iters: 1200, epoch: 2 | loss: 0.0850438
	speed: 0.1132s/iter; left time: 5628.8998s
	iters: 1300, epoch: 2 | loss: 0.0768398
	speed: 0.1126s/iter; left time: 5591.4223s
	iters: 1400, epoch: 2 | loss: 0.0734043
	speed: 0.1126s/iter; left time: 5576.2087s
	iters: 1500, epoch: 2 | loss: 0.0702756
	speed: 0.1134s/iter; left time: 5608.4505s
	iters: 1600, epoch: 2 | loss: 0.0901470
	speed: 0.1134s/iter; left time: 5595.7804s
	iters: 1700, epoch: 2 | loss: 0.0736003
	speed: 0.1132s/iter; left time: 5574.8807s
	iters: 1800, epoch: 2 | loss: 0.0812662
	speed: 0.1141s/iter; left time: 5607.1686s
	iters: 1900, epoch: 2 | loss: 0.0856911
	speed: 0.1117s/iter; left time: 5479.8548s
	iters: 2000, epoch: 2 | loss: 0.0710515
	speed: 0.1123s/iter; left time: 5494.9948s
	iters: 2100, epoch: 2 | loss: 0.0731606
	speed: 0.1108s/iter; left time: 5413.7384s
	iters: 2200, epoch: 2 | loss: 0.0908238
	speed: 0.1137s/iter; left time: 5541.7092s
	iters: 2300, epoch: 2 | loss: 0.0716156
	speed: 0.1145s/iter; left time: 5569.4548s
	iters: 2400, epoch: 2 | loss: 0.0662761
	speed: 0.1124s/iter; left time: 5454.4864s
	iters: 2500, epoch: 2 | loss: 0.0705364
	speed: 0.1146s/iter; left time: 5552.5707s
	iters: 2600, epoch: 2 | loss: 0.0787798
	speed: 0.1157s/iter; left time: 5591.1339s
Epoch: 2 cost time: 00h:05m:04.83s
Epoch: 2 | Train Loss: 0.0792366 Vali Loss: 0.0630193 Test Loss: 0.0664905
Validation loss decreased (0.069755 --> 0.063019).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0837417
	speed: 1.0566s/iter; left time: 50887.1933s
	iters: 200, epoch: 3 | loss: 0.0720257
	speed: 0.1153s/iter; left time: 5539.1675s
	iters: 300, epoch: 3 | loss: 0.0743371
	speed: 0.1143s/iter; left time: 5483.9913s
	iters: 400, epoch: 3 | loss: 0.0783527
	speed: 0.1124s/iter; left time: 5378.7126s
	iters: 500, epoch: 3 | loss: 0.0714736
	speed: 0.1124s/iter; left time: 5367.3301s
	iters: 600, epoch: 3 | loss: 0.0732643
	speed: 0.1158s/iter; left time: 5517.5317s
	iters: 700, epoch: 3 | loss: 0.0646055
	speed: 0.1127s/iter; left time: 5357.9279s
	iters: 800, epoch: 3 | loss: 0.0739734
	speed: 0.1117s/iter; left time: 5300.4545s
	iters: 900, epoch: 3 | loss: 0.0694846
	speed: 0.1164s/iter; left time: 5513.7908s
	iters: 1000, epoch: 3 | loss: 0.0750011
	speed: 0.1145s/iter; left time: 5409.1384s
	iters: 1100, epoch: 3 | loss: 0.0742698
	speed: 0.1131s/iter; left time: 5331.3288s
	iters: 1200, epoch: 3 | loss: 0.0718982
	speed: 0.1133s/iter; left time: 5332.9434s
	iters: 1300, epoch: 3 | loss: 0.0686082
	speed: 0.1150s/iter; left time: 5398.8493s
	iters: 1400, epoch: 3 | loss: 0.0775685
	speed: 0.1141s/iter; left time: 5346.2458s
	iters: 1500, epoch: 3 | loss: 0.0676080
	speed: 0.1129s/iter; left time: 5281.1198s
	iters: 1600, epoch: 3 | loss: 0.0703222
	speed: 0.1147s/iter; left time: 5351.9548s
	iters: 1700, epoch: 3 | loss: 0.0706295
	speed: 0.1164s/iter; left time: 5419.2978s
	iters: 1800, epoch: 3 | loss: 0.0611054
	speed: 0.1123s/iter; left time: 5216.7241s
	iters: 1900, epoch: 3 | loss: 0.0822397
	speed: 0.1122s/iter; left time: 5203.7787s
	iters: 2000, epoch: 3 | loss: 0.0630606
	speed: 0.1133s/iter; left time: 5243.2936s
	iters: 2100, epoch: 3 | loss: 0.0664413
	speed: 0.1144s/iter; left time: 5280.1509s
	iters: 2200, epoch: 3 | loss: 0.0754516
	speed: 0.1126s/iter; left time: 5183.9776s
	iters: 2300, epoch: 3 | loss: 0.0628932
	speed: 0.1117s/iter; left time: 5135.4868s
	iters: 2400, epoch: 3 | loss: 0.0689445
	speed: 0.1132s/iter; left time: 5193.1520s
	iters: 2500, epoch: 3 | loss: 0.0753874
	speed: 0.1143s/iter; left time: 5231.9445s
	iters: 2600, epoch: 3 | loss: 0.0803154
	speed: 0.1117s/iter; left time: 5100.1547s
Epoch: 3 cost time: 00h:05m:05.16s
Epoch: 3 | Train Loss: 0.0754979 Vali Loss: 0.0626933 Test Loss: 0.0662443
Validation loss decreased (0.063019 --> 0.062693).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0701278
	speed: 1.0424s/iter; left time: 47406.5237s
	iters: 200, epoch: 4 | loss: 0.0728249
	speed: 0.1145s/iter; left time: 5197.6080s
	iters: 300, epoch: 4 | loss: 0.0778461
	speed: 0.1130s/iter; left time: 5117.2262s
	iters: 400, epoch: 4 | loss: 0.0785829
	speed: 0.1132s/iter; left time: 5116.0930s
	iters: 500, epoch: 4 | loss: 0.0790459
	speed: 0.1153s/iter; left time: 5197.8971s
	iters: 600, epoch: 4 | loss: 0.0710924
	speed: 0.1143s/iter; left time: 5139.3973s
	iters: 700, epoch: 4 | loss: 0.0721118
	speed: 0.1152s/iter; left time: 5171.2332s
	iters: 800, epoch: 4 | loss: 0.0836879
	speed: 0.1165s/iter; left time: 5217.0912s
	iters: 900, epoch: 4 | loss: 0.0670347
	speed: 0.1127s/iter; left time: 5037.3830s
	iters: 1000, epoch: 4 | loss: 0.0732893
	speed: 0.1135s/iter; left time: 5058.3337s
	iters: 1100, epoch: 4 | loss: 0.0734157
	speed: 0.1130s/iter; left time: 5026.3469s
	iters: 1200, epoch: 4 | loss: 0.0836176
	speed: 0.1125s/iter; left time: 4993.3019s
	iters: 1300, epoch: 4 | loss: 0.0914069
	speed: 0.1140s/iter; left time: 5049.6116s
	iters: 1400, epoch: 4 | loss: 0.0554709
	speed: 0.1130s/iter; left time: 4994.0839s
	iters: 1500, epoch: 4 | loss: 0.0638680
	speed: 0.1121s/iter; left time: 4940.7801s
	iters: 1600, epoch: 4 | loss: 0.0843564
	speed: 0.1153s/iter; left time: 5072.0975s
	iters: 1700, epoch: 4 | loss: 0.0867873
	speed: 0.1154s/iter; left time: 5062.8955s
	iters: 1800, epoch: 4 | loss: 0.0825667
	speed: 0.1119s/iter; left time: 4899.0202s
	iters: 1900, epoch: 4 | loss: 0.0808909
	speed: 0.1123s/iter; left time: 4903.3557s
	iters: 2000, epoch: 4 | loss: 0.0671010
	speed: 0.1135s/iter; left time: 4947.8210s
	iters: 2100, epoch: 4 | loss: 0.0800280
	speed: 0.1121s/iter; left time: 4873.7499s
	iters: 2200, epoch: 4 | loss: 0.0652930
	speed: 0.1110s/iter; left time: 4816.3385s
	iters: 2300, epoch: 4 | loss: 0.0597176
	speed: 0.1110s/iter; left time: 4805.4423s
	iters: 2400, epoch: 4 | loss: 0.0868424
	speed: 0.1124s/iter; left time: 4852.0543s
	iters: 2500, epoch: 4 | loss: 0.0782121
	speed: 0.1127s/iter; left time: 4856.6246s
	iters: 2600, epoch: 4 | loss: 0.0802435
	speed: 0.1120s/iter; left time: 4812.7082s
Epoch: 4 cost time: 00h:05m:04.23s
Epoch: 4 | Train Loss: 0.0732161 Vali Loss: 0.0602605 Test Loss: 0.0639531
Validation loss decreased (0.062693 --> 0.060260).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0794265
	speed: 1.0445s/iter; left time: 44703.2173s
	iters: 200, epoch: 5 | loss: 0.0705508
	speed: 0.1145s/iter; left time: 4889.2588s
	iters: 300, epoch: 5 | loss: 0.0829213
	speed: 0.1137s/iter; left time: 4841.8229s
	iters: 400, epoch: 5 | loss: 0.0772983
	speed: 0.1103s/iter; left time: 4687.0188s
	iters: 500, epoch: 5 | loss: 0.0697670
	speed: 0.1129s/iter; left time: 4788.1117s
	iters: 600, epoch: 5 | loss: 0.0615391
	speed: 0.1130s/iter; left time: 4779.3203s
	iters: 700, epoch: 5 | loss: 0.0567918
	speed: 0.1124s/iter; left time: 4742.9584s
	iters: 800, epoch: 5 | loss: 0.0847099
	speed: 0.1118s/iter; left time: 4707.3078s
	iters: 900, epoch: 5 | loss: 0.0704188
	speed: 0.1122s/iter; left time: 4713.4398s
	iters: 1000, epoch: 5 | loss: 0.0620770
	speed: 0.1124s/iter; left time: 4708.3377s
	iters: 1100, epoch: 5 | loss: 0.0741380
	speed: 0.1131s/iter; left time: 4725.7189s
	iters: 1200, epoch: 5 | loss: 0.0661858
	speed: 0.1152s/iter; left time: 4802.3252s
	iters: 1300, epoch: 5 | loss: 0.0621480
	speed: 0.1118s/iter; left time: 4652.4158s
	iters: 1400, epoch: 5 | loss: 0.0629700
	speed: 0.1152s/iter; left time: 4779.4661s
	iters: 1500, epoch: 5 | loss: 0.0820492
	speed: 0.1127s/iter; left time: 4665.4697s
	iters: 1600, epoch: 5 | loss: 0.0610860
	speed: 0.1122s/iter; left time: 4633.4398s
	iters: 1700, epoch: 5 | loss: 0.0861114
	speed: 0.1111s/iter; left time: 4575.4531s
	iters: 1800, epoch: 5 | loss: 0.0606930
	speed: 0.1111s/iter; left time: 4567.4049s
	iters: 1900, epoch: 5 | loss: 0.0612833
	speed: 0.1121s/iter; left time: 4597.4820s
	iters: 2000, epoch: 5 | loss: 0.0786318
	speed: 0.1110s/iter; left time: 4539.6443s
	iters: 2100, epoch: 5 | loss: 0.0779789
	speed: 0.1123s/iter; left time: 4580.0710s
	iters: 2200, epoch: 5 | loss: 0.0667817
	speed: 0.1111s/iter; left time: 4523.4657s
	iters: 2300, epoch: 5 | loss: 0.0773585
	speed: 0.1128s/iter; left time: 4581.3611s
	iters: 2400, epoch: 5 | loss: 0.0830474
	speed: 0.1119s/iter; left time: 4533.0059s
	iters: 2500, epoch: 5 | loss: 0.0766403
	speed: 0.1110s/iter; left time: 4485.0244s
	iters: 2600, epoch: 5 | loss: 0.0594169
	speed: 0.1122s/iter; left time: 4521.0120s
Epoch: 5 cost time: 00h:05m:01.95s
Epoch: 5 | Train Loss: 0.0718611 Vali Loss: 0.0608224 Test Loss: 0.0644853
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0779639
	speed: 1.0313s/iter; left time: 41373.1934s
	iters: 200, epoch: 6 | loss: 0.0661459
	speed: 0.1129s/iter; left time: 4519.0567s
	iters: 300, epoch: 6 | loss: 0.0925239
	speed: 0.1145s/iter; left time: 4568.8113s
	iters: 400, epoch: 6 | loss: 0.0681258
	speed: 0.1124s/iter; left time: 4473.6384s
	iters: 500, epoch: 6 | loss: 0.0705238
	speed: 0.1128s/iter; left time: 4479.2027s
	iters: 600, epoch: 6 | loss: 0.0755477
	speed: 0.1134s/iter; left time: 4494.4193s
	iters: 700, epoch: 6 | loss: 0.0716280
	speed: 0.1112s/iter; left time: 4395.6017s
	iters: 800, epoch: 6 | loss: 0.0619959
	speed: 0.1134s/iter; left time: 4469.7612s
	iters: 900, epoch: 6 | loss: 0.0714130
	speed: 0.1125s/iter; left time: 4421.3718s
	iters: 1000, epoch: 6 | loss: 0.0737989
	speed: 0.1145s/iter; left time: 4490.0219s
	iters: 1100, epoch: 6 | loss: 0.0621136
	speed: 0.1151s/iter; left time: 4501.3607s
	iters: 1200, epoch: 6 | loss: 0.0685738
	speed: 0.1155s/iter; left time: 4504.9048s
	iters: 1300, epoch: 6 | loss: 0.0633010
	speed: 0.1145s/iter; left time: 4454.9581s
	iters: 1400, epoch: 6 | loss: 0.0603377
	speed: 0.1131s/iter; left time: 4388.6346s
	iters: 1500, epoch: 6 | loss: 0.0727599
	speed: 0.1139s/iter; left time: 4409.1309s
	iters: 1600, epoch: 6 | loss: 0.0715380
	speed: 0.1111s/iter; left time: 4289.6488s
	iters: 1700, epoch: 6 | loss: 0.0616430
	speed: 0.1125s/iter; left time: 4333.5642s
	iters: 1800, epoch: 6 | loss: 0.0798777
	speed: 0.1129s/iter; left time: 4335.9876s
	iters: 1900, epoch: 6 | loss: 0.0765420
	speed: 0.1119s/iter; left time: 4286.7227s
	iters: 2000, epoch: 6 | loss: 0.0671012
	speed: 0.1099s/iter; left time: 4200.8745s
	iters: 2100, epoch: 6 | loss: 0.0616646
	speed: 0.1135s/iter; left time: 4325.0934s
	iters: 2200, epoch: 6 | loss: 0.0681724
	speed: 0.1132s/iter; left time: 4302.4291s
	iters: 2300, epoch: 6 | loss: 0.0847921
	speed: 0.1123s/iter; left time: 4259.4616s
	iters: 2400, epoch: 6 | loss: 0.0787449
	speed: 0.1131s/iter; left time: 4275.7450s
	iters: 2500, epoch: 6 | loss: 0.0638925
	speed: 0.1127s/iter; left time: 4251.6605s
	iters: 2600, epoch: 6 | loss: 0.0637040
	speed: 0.1121s/iter; left time: 4218.4933s
Epoch: 6 cost time: 00h:05m:03.44s
Epoch: 6 | Train Loss: 0.0710204 Vali Loss: 0.0602071 Test Loss: 0.0637255
Validation loss decreased (0.060260 --> 0.060207).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0805032
	speed: 1.0514s/iter; left time: 39357.4660s
	iters: 200, epoch: 7 | loss: 0.0928424
	speed: 0.1134s/iter; left time: 4234.1236s
	iters: 300, epoch: 7 | loss: 0.0699223
	speed: 0.1140s/iter; left time: 4245.8493s
	iters: 400, epoch: 7 | loss: 0.0772188
	speed: 0.1138s/iter; left time: 4225.0050s
	iters: 500, epoch: 7 | loss: 0.0806367
	speed: 0.1140s/iter; left time: 4222.1278s
	iters: 600, epoch: 7 | loss: 0.0634284
	speed: 0.1119s/iter; left time: 4131.5210s
	iters: 700, epoch: 7 | loss: 0.0699541
	speed: 0.1147s/iter; left time: 4223.7646s
	iters: 800, epoch: 7 | loss: 0.0892019
	speed: 0.1146s/iter; left time: 4210.1537s
	iters: 900, epoch: 7 | loss: 0.0712903
	speed: 0.1136s/iter; left time: 4163.4128s
	iters: 1000, epoch: 7 | loss: 0.0747735
	speed: 0.1142s/iter; left time: 4170.9985s
	iters: 1100, epoch: 7 | loss: 0.0782191
	speed: 0.1127s/iter; left time: 4106.8679s
	iters: 1200, epoch: 7 | loss: 0.0647047
	speed: 0.1116s/iter; left time: 4055.0160s
	iters: 1300, epoch: 7 | loss: 0.0666225
	speed: 0.1144s/iter; left time: 4146.6489s
	iters: 1400, epoch: 7 | loss: 0.0843146
	speed: 0.1130s/iter; left time: 4081.5626s
	iters: 1500, epoch: 7 | loss: 0.0681136
	speed: 0.1137s/iter; left time: 4097.0857s
	iters: 1600, epoch: 7 | loss: 0.0701010
	speed: 0.1120s/iter; left time: 4026.2285s
	iters: 1700, epoch: 7 | loss: 0.0843430
	speed: 0.1126s/iter; left time: 4034.4264s
	iters: 1800, epoch: 7 | loss: 0.0538953
	speed: 0.1131s/iter; left time: 4042.4488s
	iters: 1900, epoch: 7 | loss: 0.0655326
	speed: 0.1124s/iter; left time: 4006.9932s
	iters: 2000, epoch: 7 | loss: 0.0805343
	speed: 0.1128s/iter; left time: 4006.6221s
	iters: 2100, epoch: 7 | loss: 0.0631403
	speed: 0.1123s/iter; left time: 3980.9580s
	iters: 2200, epoch: 7 | loss: 0.0604495
	speed: 0.1122s/iter; left time: 3964.3230s
	iters: 2300, epoch: 7 | loss: 0.0642110
	speed: 0.1123s/iter; left time: 3958.0783s
	iters: 2400, epoch: 7 | loss: 0.0664487
	speed: 0.1137s/iter; left time: 3995.3425s
	iters: 2500, epoch: 7 | loss: 0.0816911
	speed: 0.1134s/iter; left time: 3972.5020s
	iters: 2600, epoch: 7 | loss: 0.0661209
	speed: 0.1129s/iter; left time: 3944.3765s
Epoch: 7 cost time: 00h:05m:03.94s
Epoch: 7 | Train Loss: 0.0702127 Vali Loss: 0.0597712 Test Loss: 0.0634713
Validation loss decreased (0.060207 --> 0.059771).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0825887
	speed: 1.0613s/iter; left time: 36883.3912s
	iters: 200, epoch: 8 | loss: 0.0750446
	speed: 0.1157s/iter; left time: 4008.4034s
	iters: 300, epoch: 8 | loss: 0.0714472
	speed: 0.1147s/iter; left time: 3964.0194s
	iters: 400, epoch: 8 | loss: 0.0683220
	speed: 0.1138s/iter; left time: 3919.4924s
	iters: 500, epoch: 8 | loss: 0.0658177
	speed: 0.1144s/iter; left time: 3930.1622s
	iters: 600, epoch: 8 | loss: 0.0671118
	speed: 0.1134s/iter; left time: 3886.0113s
	iters: 700, epoch: 8 | loss: 0.0654151
	speed: 0.1139s/iter; left time: 3888.8765s
	iters: 800, epoch: 8 | loss: 0.0633116
	speed: 0.1150s/iter; left time: 3916.3384s
	iters: 900, epoch: 8 | loss: 0.0762280
	speed: 0.1129s/iter; left time: 3834.4540s
	iters: 1000, epoch: 8 | loss: 0.0904688
	speed: 0.1132s/iter; left time: 3833.6557s
	iters: 1100, epoch: 8 | loss: 0.0685867
	speed: 0.1157s/iter; left time: 3904.7728s
	iters: 1200, epoch: 8 | loss: 0.0753753
	speed: 0.1157s/iter; left time: 3892.1284s
	iters: 1300, epoch: 8 | loss: 0.0869639
	speed: 0.1128s/iter; left time: 3783.3242s
	iters: 1400, epoch: 8 | loss: 0.0656767
	speed: 0.1127s/iter; left time: 3769.6066s
	iters: 1500, epoch: 8 | loss: 0.0751337
	speed: 0.1129s/iter; left time: 3767.1325s
	iters: 1600, epoch: 8 | loss: 0.0769074
	speed: 0.1114s/iter; left time: 3705.3295s
	iters: 1700, epoch: 8 | loss: 0.0628735
	speed: 0.1138s/iter; left time: 3774.2191s
	iters: 1800, epoch: 8 | loss: 0.0630130
	speed: 0.1123s/iter; left time: 3712.3849s
	iters: 1900, epoch: 8 | loss: 0.0680705
	speed: 0.1126s/iter; left time: 3710.9236s
	iters: 2000, epoch: 8 | loss: 0.0652012
	speed: 0.1123s/iter; left time: 3690.3335s
	iters: 2100, epoch: 8 | loss: 0.0650971
	speed: 0.1104s/iter; left time: 3616.4226s
	iters: 2200, epoch: 8 | loss: 0.0778571
	speed: 0.1124s/iter; left time: 3669.9809s
	iters: 2300, epoch: 8 | loss: 0.0902112
	speed: 0.1117s/iter; left time: 3637.1336s
	iters: 2400, epoch: 8 | loss: 0.0791112
	speed: 0.1114s/iter; left time: 3616.3970s
	iters: 2500, epoch: 8 | loss: 0.0677406
	speed: 0.1130s/iter; left time: 3655.9542s
	iters: 2600, epoch: 8 | loss: 0.0605854
	speed: 0.1125s/iter; left time: 3628.7290s
Epoch: 8 cost time: 00h:05m:04.33s
Epoch: 8 | Train Loss: 0.0696060 Vali Loss: 0.0590203 Test Loss: 0.0629085
Validation loss decreased (0.059771 --> 0.059020).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.0732988
	speed: 1.0469s/iter; left time: 33575.7486s
	iters: 200, epoch: 9 | loss: 0.0632006
	speed: 0.1134s/iter; left time: 3625.6311s
	iters: 300, epoch: 9 | loss: 0.0675089
	speed: 0.1133s/iter; left time: 3610.2588s
	iters: 400, epoch: 9 | loss: 0.0753807
	speed: 0.1126s/iter; left time: 3576.9251s
	iters: 500, epoch: 9 | loss: 0.0688046
	speed: 0.1139s/iter; left time: 3606.3103s
	iters: 600, epoch: 9 | loss: 0.0563322
	speed: 0.1114s/iter; left time: 3518.7991s
	iters: 700, epoch: 9 | loss: 0.0637789
	speed: 0.1147s/iter; left time: 3609.5353s
	iters: 800, epoch: 9 | loss: 0.0552997
	speed: 0.1143s/iter; left time: 3585.2895s
	iters: 900, epoch: 9 | loss: 0.0730415
	speed: 0.1131s/iter; left time: 3536.3882s
	iters: 1000, epoch: 9 | loss: 0.0624509
	speed: 0.1131s/iter; left time: 3525.1544s
	iters: 1100, epoch: 9 | loss: 0.0611722
	speed: 0.1142s/iter; left time: 3548.2124s
	iters: 1200, epoch: 9 | loss: 0.0624793
	speed: 0.1136s/iter; left time: 3518.4102s
	iters: 1300, epoch: 9 | loss: 0.0554433
	speed: 0.1126s/iter; left time: 3474.9651s
	iters: 1400, epoch: 9 | loss: 0.0854482
	speed: 0.1130s/iter; left time: 3478.8142s
	iters: 1500, epoch: 9 | loss: 0.1009781
	speed: 0.1139s/iter; left time: 3494.9430s
	iters: 1600, epoch: 9 | loss: 0.0588896
	speed: 0.1126s/iter; left time: 3443.7265s
	iters: 1700, epoch: 9 | loss: 0.0664771
	speed: 0.1125s/iter; left time: 3427.2529s
	iters: 1800, epoch: 9 | loss: 0.0875199
	speed: 0.1135s/iter; left time: 3447.8911s
	iters: 1900, epoch: 9 | loss: 0.0652644
	speed: 0.1130s/iter; left time: 3421.9041s
	iters: 2000, epoch: 9 | loss: 0.0729210
	speed: 0.1112s/iter; left time: 3355.2659s
	iters: 2100, epoch: 9 | loss: 0.0595015
	speed: 0.1128s/iter; left time: 3391.7246s
	iters: 2200, epoch: 9 | loss: 0.0645168
	speed: 0.1130s/iter; left time: 3388.3325s
	iters: 2300, epoch: 9 | loss: 0.0664069
	speed: 0.1108s/iter; left time: 3310.9877s
	iters: 2400, epoch: 9 | loss: 0.0560363
	speed: 0.1127s/iter; left time: 3354.7876s
	iters: 2500, epoch: 9 | loss: 0.0640769
	speed: 0.1137s/iter; left time: 3373.7109s
	iters: 2600, epoch: 9 | loss: 0.0609662
	speed: 0.1146s/iter; left time: 3390.4395s
Epoch: 9 cost time: 00h:05m:04.13s
Epoch: 9 | Train Loss: 0.0688502 Vali Loss: 0.0579161 Test Loss: 0.0620261
Validation loss decreased (0.059020 --> 0.057916).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 10 | loss: 0.0692350
	speed: 1.0613s/iter; left time: 31192.3696s
	iters: 200, epoch: 10 | loss: 0.0792829
	speed: 0.1143s/iter; left time: 3349.2427s
	iters: 300, epoch: 10 | loss: 0.0651196
	speed: 0.1137s/iter; left time: 3317.6927s
	iters: 400, epoch: 10 | loss: 0.0529624
	speed: 0.1138s/iter; left time: 3309.5114s
	iters: 500, epoch: 10 | loss: 0.0596995
	speed: 0.1145s/iter; left time: 3320.1693s
	iters: 600, epoch: 10 | loss: 0.0596051
	speed: 0.1158s/iter; left time: 3346.7888s
	iters: 700, epoch: 10 | loss: 0.0729908
	speed: 0.1113s/iter; left time: 3205.6438s
	iters: 800, epoch: 10 | loss: 0.0748923
	speed: 0.1140s/iter; left time: 3270.4554s
	iters: 900, epoch: 10 | loss: 0.0764702
	speed: 0.1167s/iter; left time: 3335.9231s
	iters: 1000, epoch: 10 | loss: 0.0590842
	speed: 0.1168s/iter; left time: 3327.6925s
	iters: 1100, epoch: 10 | loss: 0.0709747
	speed: 0.1160s/iter; left time: 3292.8934s
	iters: 1200, epoch: 10 | loss: 0.0812026
	speed: 0.1153s/iter; left time: 3260.7871s
	iters: 1300, epoch: 10 | loss: 0.0673435
	speed: 0.1149s/iter; left time: 3238.6523s
	iters: 1400, epoch: 10 | loss: 0.0555878
	speed: 0.1158s/iter; left time: 3251.9341s
	iters: 1500, epoch: 10 | loss: 0.0766573
	speed: 0.1145s/iter; left time: 3205.1303s
	iters: 1600, epoch: 10 | loss: 0.0764899
	speed: 0.1143s/iter; left time: 3187.6596s
	iters: 1700, epoch: 10 | loss: 0.0618597
	speed: 0.1160s/iter; left time: 3223.2066s
	iters: 1800, epoch: 10 | loss: 0.0638845
	speed: 0.1111s/iter; left time: 3077.8686s
	iters: 1900, epoch: 10 | loss: 0.0900016
	speed: 0.1143s/iter; left time: 3152.6443s
	iters: 2000, epoch: 10 | loss: 0.0711123
	speed: 0.1149s/iter; left time: 3158.2682s
	iters: 2100, epoch: 10 | loss: 0.0715640
	speed: 0.1122s/iter; left time: 3072.3091s
	iters: 2200, epoch: 10 | loss: 0.0749826
	speed: 0.1123s/iter; left time: 3064.6542s
	iters: 2300, epoch: 10 | loss: 0.0696980
	speed: 0.1130s/iter; left time: 3071.7559s
	iters: 2400, epoch: 10 | loss: 0.0574644
	speed: 0.1118s/iter; left time: 3029.9863s
	iters: 2500, epoch: 10 | loss: 0.0694450
	speed: 0.1117s/iter; left time: 3014.1432s
	iters: 2600, epoch: 10 | loss: 0.0577533
	speed: 0.1135s/iter; left time: 3051.3840s
Epoch: 10 cost time: 00h:05m:06.70s
Epoch: 10 | Train Loss: 0.0683724 Vali Loss: 0.0582843 Test Loss: 0.0620225
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 11 | loss: 0.0733247
	speed: 1.0370s/iter; left time: 27698.2191s
	iters: 200, epoch: 11 | loss: 0.0593850
	speed: 0.1133s/iter; left time: 3016.3245s
	iters: 300, epoch: 11 | loss: 0.0672786
	speed: 0.1143s/iter; left time: 3028.9575s
	iters: 400, epoch: 11 | loss: 0.0505884
	speed: 0.1162s/iter; left time: 3067.8889s
	iters: 500, epoch: 11 | loss: 0.0644879
	speed: 0.1131s/iter; left time: 2976.2848s
	iters: 600, epoch: 11 | loss: 0.0813994
	speed: 0.1134s/iter; left time: 2972.4012s
	iters: 700, epoch: 11 | loss: 0.0774051
	speed: 0.1157s/iter; left time: 3021.8245s
	iters: 800, epoch: 11 | loss: 0.0700469
	speed: 0.1136s/iter; left time: 2954.5585s
	iters: 900, epoch: 11 | loss: 0.0562205
	speed: 0.1144s/iter; left time: 2965.5106s
	iters: 1000, epoch: 11 | loss: 0.0744258
	speed: 0.1142s/iter; left time: 2947.7942s
	iters: 1100, epoch: 11 | loss: 0.0834967
	speed: 0.1150s/iter; left time: 2957.1412s
	iters: 1200, epoch: 11 | loss: 0.0731772
	speed: 0.1142s/iter; left time: 2924.9462s
	iters: 1300, epoch: 11 | loss: 0.0543189
	speed: 0.1162s/iter; left time: 2964.6617s
	iters: 1400, epoch: 11 | loss: 0.0754633
	speed: 0.1160s/iter; left time: 2947.0532s
	iters: 1500, epoch: 11 | loss: 0.0645236
	speed: 0.1141s/iter; left time: 2888.1280s
	iters: 1600, epoch: 11 | loss: 0.0708787
	speed: 0.1155s/iter; left time: 2911.1337s
	iters: 1700, epoch: 11 | loss: 0.0754559
	speed: 0.1132s/iter; left time: 2842.4902s
	iters: 1800, epoch: 11 | loss: 0.0719775
	speed: 0.1122s/iter; left time: 2804.9962s
	iters: 1900, epoch: 11 | loss: 0.0709032
	speed: 0.1151s/iter; left time: 2867.6776s
	iters: 2000, epoch: 11 | loss: 0.0738048
	speed: 0.1125s/iter; left time: 2791.8765s
	iters: 2100, epoch: 11 | loss: 0.0666654
	speed: 0.1133s/iter; left time: 2800.5792s
	iters: 2200, epoch: 11 | loss: 0.0716899
	speed: 0.1127s/iter; left time: 2774.4368s
	iters: 2300, epoch: 11 | loss: 0.0751313
	speed: 0.1113s/iter; left time: 2728.3758s
	iters: 2400, epoch: 11 | loss: 0.0650967
	speed: 0.1115s/iter; left time: 2722.6908s
	iters: 2500, epoch: 11 | loss: 0.0566285
	speed: 0.1131s/iter; left time: 2748.4264s
	iters: 2600, epoch: 11 | loss: 0.0661598
	speed: 0.1119s/iter; left time: 2709.0795s
Epoch: 11 cost time: 00h:05m:06.02s
Epoch: 11 | Train Loss: 0.0677539 Vali Loss: 0.0579457 Test Loss: 0.0615977
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 12 | loss: 0.0564539
	speed: 1.0320s/iter; left time: 24800.0710s
	iters: 200, epoch: 12 | loss: 0.0552143
	speed: 0.1127s/iter; left time: 2696.2229s
	iters: 300, epoch: 12 | loss: 0.0666377
	speed: 0.1130s/iter; left time: 2693.7457s
	iters: 400, epoch: 12 | loss: 0.0854366
	speed: 0.1118s/iter; left time: 2653.1796s
	iters: 500, epoch: 12 | loss: 0.0836129
	speed: 0.1138s/iter; left time: 2688.2405s
	iters: 600, epoch: 12 | loss: 0.0733599
	speed: 0.1144s/iter; left time: 2692.4083s
	iters: 700, epoch: 12 | loss: 0.0519824
	speed: 0.1141s/iter; left time: 2674.1239s
	iters: 800, epoch: 12 | loss: 0.0707659
	speed: 0.1120s/iter; left time: 2612.7351s
	iters: 900, epoch: 12 | loss: 0.0599417
	speed: 0.1124s/iter; left time: 2610.4100s
	iters: 1000, epoch: 12 | loss: 0.0641551
	speed: 0.1119s/iter; left time: 2587.2098s
	iters: 1100, epoch: 12 | loss: 0.0645704
	speed: 0.1141s/iter; left time: 2627.2422s
	iters: 1200, epoch: 12 | loss: 0.0506950
	speed: 0.1148s/iter; left time: 2631.2853s
	iters: 1300, epoch: 12 | loss: 0.0640931
	speed: 0.1143s/iter; left time: 2610.5703s
	iters: 1400, epoch: 12 | loss: 0.0689833
	speed: 0.1145s/iter; left time: 2601.8537s
	iters: 1500, epoch: 12 | loss: 0.0576060
	speed: 0.1140s/iter; left time: 2580.7300s
	iters: 1600, epoch: 12 | loss: 0.0531667
	speed: 0.1152s/iter; left time: 2595.6259s
	iters: 1700, epoch: 12 | loss: 0.0634687
	speed: 0.1156s/iter; left time: 2592.7872s
	iters: 1800, epoch: 12 | loss: 0.0635579
	speed: 0.1152s/iter; left time: 2571.7915s
	iters: 1900, epoch: 12 | loss: 0.0655776
	speed: 0.1167s/iter; left time: 2594.8326s
	iters: 2000, epoch: 12 | loss: 0.0597161
	speed: 0.1159s/iter; left time: 2565.2309s
	iters: 2100, epoch: 12 | loss: 0.0718565
	speed: 0.1146s/iter; left time: 2525.0952s
	iters: 2200, epoch: 12 | loss: 0.0863532
	speed: 0.1146s/iter; left time: 2512.7847s
	iters: 2300, epoch: 12 | loss: 0.0655009
	speed: 0.1138s/iter; left time: 2483.6130s
	iters: 2400, epoch: 12 | loss: 0.0780334
	speed: 0.1132s/iter; left time: 2459.7022s
	iters: 2500, epoch: 12 | loss: 0.0685403
	speed: 0.1140s/iter; left time: 2465.9565s
	iters: 2600, epoch: 12 | loss: 0.0669672
	speed: 0.1128s/iter; left time: 2428.6642s
Epoch: 12 cost time: 00h:05m:06.14s
Epoch: 12 | Train Loss: 0.0672516 Vali Loss: 0.0583924 Test Loss: 0.0623229
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 13 | loss: 0.0646751
	speed: 1.0364s/iter; left time: 22126.2339s
	iters: 200, epoch: 13 | loss: 0.0718063
	speed: 0.1127s/iter; left time: 2394.7919s
	iters: 300, epoch: 13 | loss: 0.0704412
	speed: 0.1128s/iter; left time: 2385.4888s
	iters: 400, epoch: 13 | loss: 0.0566958
	speed: 0.1143s/iter; left time: 2406.1945s
	iters: 500, epoch: 13 | loss: 0.0677867
	speed: 0.1114s/iter; left time: 2334.0660s
	iters: 600, epoch: 13 | loss: 0.0662406
	speed: 0.1131s/iter; left time: 2358.9155s
	iters: 700, epoch: 13 | loss: 0.0692414
	speed: 0.1158s/iter; left time: 2403.1566s
	iters: 800, epoch: 13 | loss: 0.0744722
	speed: 0.1136s/iter; left time: 2345.5722s
	iters: 900, epoch: 13 | loss: 0.0682855
	speed: 0.1139s/iter; left time: 2339.8397s
	iters: 1000, epoch: 13 | loss: 0.0692520
	speed: 0.1138s/iter; left time: 2327.3567s
	iters: 1100, epoch: 13 | loss: 0.0754888
	speed: 0.1127s/iter; left time: 2293.1628s
	iters: 1200, epoch: 13 | loss: 0.0644453
	speed: 0.1117s/iter; left time: 2262.0843s
	iters: 1300, epoch: 13 | loss: 0.0570012
	speed: 0.1152s/iter; left time: 2321.7263s
	iters: 1400, epoch: 13 | loss: 0.0658361
	speed: 0.1138s/iter; left time: 2282.3398s
	iters: 1500, epoch: 13 | loss: 0.0681140
	speed: 0.1120s/iter; left time: 2234.3692s
	iters: 1600, epoch: 13 | loss: 0.0861393
	speed: 0.1131s/iter; left time: 2244.6265s
	iters: 1700, epoch: 13 | loss: 0.0685929
	speed: 0.1121s/iter; left time: 2213.1584s
	iters: 1800, epoch: 13 | loss: 0.0834594
	speed: 0.1121s/iter; left time: 2201.6722s
	iters: 1900, epoch: 13 | loss: 0.0550227
	speed: 0.1143s/iter; left time: 2234.3334s
	iters: 2000, epoch: 13 | loss: 0.0614033
	speed: 0.1144s/iter; left time: 2225.0598s
	iters: 2100, epoch: 13 | loss: 0.0588906
	speed: 0.1141s/iter; left time: 2207.2866s
	iters: 2200, epoch: 13 | loss: 0.0599210
	speed: 0.1156s/iter; left time: 2224.4833s
	iters: 2300, epoch: 13 | loss: 0.0557182
	speed: 0.1158s/iter; left time: 2216.8033s
	iters: 2400, epoch: 13 | loss: 0.0523902
	speed: 0.1137s/iter; left time: 2165.3673s
	iters: 2500, epoch: 13 | loss: 0.0614735
	speed: 0.1128s/iter; left time: 2138.0992s
	iters: 2600, epoch: 13 | loss: 0.0746370
	speed: 0.1149s/iter; left time: 2166.1827s
Epoch: 13 cost time: 00h:05m:05.24s
Epoch: 13 | Train Loss: 0.0666866 Vali Loss: 0.0598697 Test Loss: 0.0634292
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 14 | loss: 0.0550120
	speed: 1.0248s/iter; left time: 19130.7921s
	iters: 200, epoch: 14 | loss: 0.0765724
	speed: 0.1136s/iter; left time: 2109.4309s
	iters: 300, epoch: 14 | loss: 0.0594586
	speed: 0.1121s/iter; left time: 2069.9351s
	iters: 400, epoch: 14 | loss: 0.0718415
	speed: 0.1145s/iter; left time: 2102.6518s
	iters: 500, epoch: 14 | loss: 0.0611447
	speed: 0.1153s/iter; left time: 2106.0231s
	iters: 600, epoch: 14 | loss: 0.0523001
	speed: 0.1114s/iter; left time: 2023.0540s
	iters: 700, epoch: 14 | loss: 0.0722972
	speed: 0.1141s/iter; left time: 2060.6737s
	iters: 800, epoch: 14 | loss: 0.0649306
	speed: 0.1160s/iter; left time: 2083.8280s
	iters: 900, epoch: 14 | loss: 0.0694602
	speed: 0.1121s/iter; left time: 2003.6791s
	iters: 1000, epoch: 14 | loss: 0.0615104
	speed: 0.1132s/iter; left time: 2011.5344s
	iters: 1100, epoch: 14 | loss: 0.0770956
	speed: 0.1140s/iter; left time: 2014.7615s
	iters: 1200, epoch: 14 | loss: 0.0567148
	speed: 0.1149s/iter; left time: 2019.0759s
	iters: 1300, epoch: 14 | loss: 0.0728452
	speed: 0.1126s/iter; left time: 1967.7282s
	iters: 1400, epoch: 14 | loss: 0.0593382
	speed: 0.1136s/iter; left time: 1972.6366s
	iters: 1500, epoch: 14 | loss: 0.0824114
	speed: 0.1135s/iter; left time: 1960.3904s
	iters: 1600, epoch: 14 | loss: 0.0644274
	speed: 0.1138s/iter; left time: 1954.0745s
	iters: 1700, epoch: 14 | loss: 0.0727649
	speed: 0.1132s/iter; left time: 1932.2008s
	iters: 1800, epoch: 14 | loss: 0.0557669
	speed: 0.1159s/iter; left time: 1966.0186s
	iters: 1900, epoch: 14 | loss: 0.0580711
	speed: 0.1141s/iter; left time: 1925.0778s
	iters: 2000, epoch: 14 | loss: 0.0541300
	speed: 0.1131s/iter; left time: 1896.9430s
	iters: 2100, epoch: 14 | loss: 0.0559602
	speed: 0.1127s/iter; left time: 1878.8913s
	iters: 2200, epoch: 14 | loss: 0.0641657
	speed: 0.1133s/iter; left time: 1876.6334s
	iters: 2300, epoch: 14 | loss: 0.0765522
	speed: 0.1120s/iter; left time: 1843.8689s
	iters: 2400, epoch: 14 | loss: 0.0656291
	speed: 0.1125s/iter; left time: 1841.0284s
	iters: 2500, epoch: 14 | loss: 0.0698191
	speed: 0.1118s/iter; left time: 1818.2485s
	iters: 2600, epoch: 14 | loss: 0.0704088
	speed: 0.1125s/iter; left time: 1819.4298s
Epoch: 14 cost time: 00h:05m:04.54s
Epoch: 14 | Train Loss: 0.0661358 Vali Loss: 0.0595082 Test Loss: 0.0636313
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.010770452208817005, rmse:0.10378079116344452, mae:0.06202606484293938, rse:0.39211392402648926
success delete checkpoints
Intermediate time for IT and pred_len 24: 01h:32m:28.32s

=== Starting experiments for pred_len: 96 ===

--- Running model for IT, pred_len=96 ---
train 85587
val 18435
test 18435
[2024-11-03 19:10:42,525] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-03 19:10:43,613] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-03 19:10:43,613] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-03 19:10:43,613] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-03 19:10:43,698] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-03 19:10:43,698] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-03 19:10:44,422] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-03 19:10:44,423] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-03 19:10:44,423] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-03 19:10:44,425] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-03 19:10:44,425] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-03 19:10:44,425] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-03 19:10:44,425] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-03 19:10:44,425] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-03 19:10:44,425] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-03 19:10:44,425] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-03 19:10:44,816] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-03 19:10:44,817] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-03 19:10:44,817] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 303.89 GB, percent = 40.3%
[2024-11-03 19:10:44,985] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-03 19:10:44,986] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 19:10:44,986] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 303.96 GB, percent = 40.3%
[2024-11-03 19:10:44,986] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-03 19:10:45,157] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-03 19:10:45,158] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-03 19:10:45,158] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 303.98 GB, percent = 40.3%
[2024-11-03 19:10:45,159] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-03 19:10:45,159] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-03 19:10:45,159] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-03 19:10:45,159] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-03 19:10:45,160] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f7f2cac6550>
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-03 19:10:45,161] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-03 19:10:45,162] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-03 19:10:45,163] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-03 19:10:45,163] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-03 19:10:45,163] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-03 19:10:45,163] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-03 19:10:45,163] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-03 19:10:45,163] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-03 19:10:45,163] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-03 19:10:45,163] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-03 19:10:45,163] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-03 19:10:45,163] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-03 19:10:45,163] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-03 19:10:45,163] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.2074100
	speed: 0.1698s/iter; left time: 9065.7885s
	iters: 200, epoch: 1 | loss: 0.1933736
	speed: 0.1209s/iter; left time: 6441.2101s
	iters: 300, epoch: 1 | loss: 0.1680937
	speed: 0.1243s/iter; left time: 6612.0969s
	iters: 400, epoch: 1 | loss: 0.1478600
	speed: 0.1233s/iter; left time: 6543.0074s
	iters: 500, epoch: 1 | loss: 0.1329422
	speed: 0.1241s/iter; left time: 6574.7097s
	iters: 600, epoch: 1 | loss: 0.1080209
	speed: 0.1237s/iter; left time: 6541.7857s
	iters: 700, epoch: 1 | loss: 0.1268893
	speed: 0.1274s/iter; left time: 6724.4386s
	iters: 800, epoch: 1 | loss: 0.1043758
	speed: 0.1244s/iter; left time: 6552.9860s
	iters: 900, epoch: 1 | loss: 0.1108791
	speed: 0.1236s/iter; left time: 6499.0257s
	iters: 1000, epoch: 1 | loss: 0.1154346
	speed: 0.1242s/iter; left time: 6520.1496s
	iters: 1100, epoch: 1 | loss: 0.0978668
	speed: 0.1230s/iter; left time: 6444.5262s
	iters: 1200, epoch: 1 | loss: 0.0894702
	speed: 0.1251s/iter; left time: 6540.3517s
	iters: 1300, epoch: 1 | loss: 0.1008194
	speed: 0.1253s/iter; left time: 6537.7925s
	iters: 1400, epoch: 1 | loss: 0.1065734
	speed: 0.1244s/iter; left time: 6480.2460s
	iters: 1500, epoch: 1 | loss: 0.1051371
	speed: 0.1249s/iter; left time: 6494.8085s
	iters: 1600, epoch: 1 | loss: 0.0991306
	speed: 0.1247s/iter; left time: 6467.0995s
	iters: 1700, epoch: 1 | loss: 0.1286744
	speed: 0.1231s/iter; left time: 6375.7148s
	iters: 1800, epoch: 1 | loss: 0.1012800
	speed: 0.1206s/iter; left time: 6234.7451s
	iters: 1900, epoch: 1 | loss: 0.1123592
	speed: 0.1227s/iter; left time: 6330.6444s
	iters: 2000, epoch: 1 | loss: 0.0761735
	speed: 0.1225s/iter; left time: 6308.5215s
	iters: 2100, epoch: 1 | loss: 0.1169404
	speed: 0.1229s/iter; left time: 6316.9931s
	iters: 2200, epoch: 1 | loss: 0.1165787
	speed: 0.1224s/iter; left time: 6277.8256s
	iters: 2300, epoch: 1 | loss: 0.1044903
	speed: 0.1213s/iter; left time: 6206.7813s
	iters: 2400, epoch: 1 | loss: 0.0961953
	speed: 0.1252s/iter; left time: 6397.0164s
	iters: 2500, epoch: 1 | loss: 0.1058684
	speed: 0.1251s/iter; left time: 6377.4777s
	iters: 2600, epoch: 1 | loss: 0.0999430
	speed: 0.1232s/iter; left time: 6268.4567s
Epoch: 1 cost time: 00h:05m:32.20s
Epoch: 1 | Train Loss: 0.1198931 Vali Loss: 0.0841650 Test Loss: 0.0884351
Validation loss decreased (inf --> 0.084165).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.1127564
	speed: 1.1665s/iter; left time: 59149.8786s
	iters: 200, epoch: 2 | loss: 0.0858049
	speed: 0.1124s/iter; left time: 5687.4056s
	iters: 300, epoch: 2 | loss: 0.0845444
	speed: 0.1103s/iter; left time: 5568.9101s
	iters: 400, epoch: 2 | loss: 0.0956632
	speed: 0.1131s/iter; left time: 5699.8288s
	iters: 500, epoch: 2 | loss: 0.0922268
	speed: 0.1148s/iter; left time: 5775.3422s
	iters: 600, epoch: 2 | loss: 0.0877490
	speed: 0.1141s/iter; left time: 5730.1084s
	iters: 700, epoch: 2 | loss: 0.0789305
	speed: 0.1129s/iter; left time: 5658.8953s
	iters: 800, epoch: 2 | loss: 0.1000123
	speed: 0.1131s/iter; left time: 5655.9864s
	iters: 900, epoch: 2 | loss: 0.1008030
	speed: 0.1136s/iter; left time: 5670.5816s
	iters: 1000, epoch: 2 | loss: 0.0849907
	speed: 0.1112s/iter; left time: 5537.6149s
	iters: 1100, epoch: 2 | loss: 0.0847871
	speed: 0.1123s/iter; left time: 5580.6413s
	iters: 1200, epoch: 2 | loss: 0.1110906
	speed: 0.1117s/iter; left time: 5543.3750s
	iters: 1300, epoch: 2 | loss: 0.0902140
	speed: 0.1116s/iter; left time: 5526.9080s
	iters: 1400, epoch: 2 | loss: 0.1075663
	speed: 0.1122s/iter; left time: 5543.3304s
	iters: 1500, epoch: 2 | loss: 0.0813371
	speed: 0.1151s/iter; left time: 5674.4658s
	iters: 1600, epoch: 2 | loss: 0.0910764
	speed: 0.1130s/iter; left time: 5562.6063s
	iters: 1700, epoch: 2 | loss: 0.0874856
	speed: 0.1129s/iter; left time: 5545.6735s
	iters: 1800, epoch: 2 | loss: 0.1003650
	speed: 0.1132s/iter; left time: 5548.0881s
	iters: 1900, epoch: 2 | loss: 0.0853289
	speed: 0.1134s/iter; left time: 5544.9215s
	iters: 2000, epoch: 2 | loss: 0.0867084
	speed: 0.1125s/iter; left time: 5489.3666s
	iters: 2100, epoch: 2 | loss: 0.0767493
	speed: 0.1130s/iter; left time: 5503.8645s
	iters: 2200, epoch: 2 | loss: 0.0793778
	speed: 0.1144s/iter; left time: 5559.9907s
	iters: 2300, epoch: 2 | loss: 0.0787130
	speed: 0.1138s/iter; left time: 5518.6469s
	iters: 2400, epoch: 2 | loss: 0.0944487
	speed: 0.1144s/iter; left time: 5536.3076s
	iters: 2500, epoch: 2 | loss: 0.0862754
	speed: 0.1154s/iter; left time: 5573.3013s
	iters: 2600, epoch: 2 | loss: 0.0699872
	speed: 0.1159s/iter; left time: 5585.2136s
Epoch: 2 cost time: 00h:05m:03.44s
Epoch: 2 | Train Loss: 0.0951379 Vali Loss: 0.0802616 Test Loss: 0.0852105
Validation loss decreased (0.084165 --> 0.080262).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0913631
	speed: 1.0426s/iter; left time: 50079.0402s
	iters: 200, epoch: 3 | loss: 0.0941604
	speed: 0.1148s/iter; left time: 5503.5955s
	iters: 300, epoch: 3 | loss: 0.0937610
	speed: 0.1146s/iter; left time: 5481.5325s
	iters: 400, epoch: 3 | loss: 0.0962613
	speed: 0.1151s/iter; left time: 5493.5033s
	iters: 500, epoch: 3 | loss: 0.1008476
	speed: 0.1144s/iter; left time: 5446.8518s
	iters: 600, epoch: 3 | loss: 0.1072278
	speed: 0.1149s/iter; left time: 5461.5053s
	iters: 700, epoch: 3 | loss: 0.0809577
	speed: 0.1160s/iter; left time: 5500.3849s
	iters: 800, epoch: 3 | loss: 0.0869908
	speed: 0.1144s/iter; left time: 5417.0870s
	iters: 900, epoch: 3 | loss: 0.1061004
	speed: 0.1130s/iter; left time: 5337.2130s
	iters: 1000, epoch: 3 | loss: 0.1013325
	speed: 0.1142s/iter; left time: 5382.7579s
	iters: 1100, epoch: 3 | loss: 0.0924709
	speed: 0.1162s/iter; left time: 5467.3840s
	iters: 1200, epoch: 3 | loss: 0.0991043
	speed: 0.1144s/iter; left time: 5368.7871s
	iters: 1300, epoch: 3 | loss: 0.1008329
	speed: 0.1141s/iter; left time: 5345.9778s
	iters: 1400, epoch: 3 | loss: 0.0831598
	speed: 0.1160s/iter; left time: 5421.5980s
	iters: 1500, epoch: 3 | loss: 0.1090582
	speed: 0.1150s/iter; left time: 5364.5424s
	iters: 1600, epoch: 3 | loss: 0.1031286
	speed: 0.1160s/iter; left time: 5395.8119s
	iters: 1700, epoch: 3 | loss: 0.0970030
	speed: 0.1178s/iter; left time: 5468.1474s
	iters: 1800, epoch: 3 | loss: 0.0891229
	speed: 0.1160s/iter; left time: 5376.3383s
	iters: 1900, epoch: 3 | loss: 0.0952215
	speed: 0.1142s/iter; left time: 5281.1271s
	iters: 2000, epoch: 3 | loss: 0.0831259
	speed: 0.1140s/iter; left time: 5257.9225s
	iters: 2100, epoch: 3 | loss: 0.1124142
	speed: 0.1154s/iter; left time: 5312.1351s
	iters: 2200, epoch: 3 | loss: 0.1149694
	speed: 0.1158s/iter; left time: 5321.2063s
	iters: 2300, epoch: 3 | loss: 0.0783673
	speed: 0.1138s/iter; left time: 5214.8664s
	iters: 2400, epoch: 3 | loss: 0.0836947
	speed: 0.1117s/iter; left time: 5108.9117s
	iters: 2500, epoch: 3 | loss: 0.0893349
	speed: 0.1122s/iter; left time: 5118.3652s
	iters: 2600, epoch: 3 | loss: 0.0813950
	speed: 0.1163s/iter; left time: 5294.5987s
Epoch: 3 cost time: 00h:05m:08.15s
Epoch: 3 | Train Loss: 0.0912028 Vali Loss: 0.0809163 Test Loss: 0.0860651
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0766129
	speed: 1.0843s/iter; left time: 49181.3535s
	iters: 200, epoch: 4 | loss: 0.1203493
	speed: 0.1202s/iter; left time: 5437.9964s
	iters: 300, epoch: 4 | loss: 0.0836161
	speed: 0.1240s/iter; left time: 5599.3588s
	iters: 400, epoch: 4 | loss: 0.0988006
	speed: 0.1207s/iter; left time: 5437.8985s
	iters: 500, epoch: 4 | loss: 0.0826896
	speed: 0.1217s/iter; left time: 5472.9887s
	iters: 600, epoch: 4 | loss: 0.0930348
	speed: 0.1205s/iter; left time: 5403.7398s
	iters: 700, epoch: 4 | loss: 0.0988240
	speed: 0.1237s/iter; left time: 5534.5948s
	iters: 800, epoch: 4 | loss: 0.0805480
	speed: 0.1199s/iter; left time: 5354.3449s
	iters: 900, epoch: 4 | loss: 0.0826487
	speed: 0.1188s/iter; left time: 5293.6080s
	iters: 1000, epoch: 4 | loss: 0.0710772
	speed: 0.1274s/iter; left time: 5665.2333s
	iters: 1100, epoch: 4 | loss: 0.0831637
	speed: 0.1225s/iter; left time: 5435.6249s
	iters: 1200, epoch: 4 | loss: 0.0868283
	speed: 0.1206s/iter; left time: 5336.0502s
	iters: 1300, epoch: 4 | loss: 0.1062559
	speed: 0.1246s/iter; left time: 5502.1697s
	iters: 1400, epoch: 4 | loss: 0.0913987
	speed: 0.1224s/iter; left time: 5394.5232s
	iters: 1500, epoch: 4 | loss: 0.0884490
	speed: 0.1231s/iter; left time: 5411.4485s
	iters: 1600, epoch: 4 | loss: 0.0850192
	speed: 0.1212s/iter; left time: 5317.7873s
	iters: 1700, epoch: 4 | loss: 0.0802786
	speed: 0.1164s/iter; left time: 5095.0696s
	iters: 1800, epoch: 4 | loss: 0.0982129
	speed: 0.1213s/iter; left time: 5295.9952s
	iters: 1900, epoch: 4 | loss: 0.0785628
	speed: 0.1255s/iter; left time: 5467.6361s
	iters: 2000, epoch: 4 | loss: 0.0918725
	speed: 0.1253s/iter; left time: 5444.4988s
	iters: 2100, epoch: 4 | loss: 0.0956076
	speed: 0.1261s/iter; left time: 5466.6697s
	iters: 2200, epoch: 4 | loss: 0.0837968
	speed: 0.1245s/iter; left time: 5384.6818s
	iters: 2300, epoch: 4 | loss: 0.1122651
	speed: 0.1187s/iter; left time: 5123.9010s
	iters: 2400, epoch: 4 | loss: 0.0925200
	speed: 0.1248s/iter; left time: 5374.0130s
	iters: 2500, epoch: 4 | loss: 0.0905496
	speed: 0.1263s/iter; left time: 5426.8022s
	iters: 2600, epoch: 4 | loss: 0.0913031
	speed: 0.1276s/iter; left time: 5469.0224s
Epoch: 4 cost time: 00h:05m:28.50s
Epoch: 4 | Train Loss: 0.0887905 Vali Loss: 0.0801354 Test Loss: 0.0864428
Validation loss decreased (0.080262 --> 0.080135).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0905916
	speed: 1.0963s/iter; left time: 46795.9889s
	iters: 200, epoch: 5 | loss: 0.0949473
	speed: 0.1195s/iter; left time: 5087.5571s
	iters: 300, epoch: 5 | loss: 0.0949715
	speed: 0.1325s/iter; left time: 5630.9090s
	iters: 400, epoch: 5 | loss: 0.0939259
	speed: 0.1198s/iter; left time: 5077.4282s
	iters: 500, epoch: 5 | loss: 0.0792014
	speed: 0.1198s/iter; left time: 5065.8468s
	iters: 600, epoch: 5 | loss: 0.1021533
	speed: 0.1211s/iter; left time: 5107.1698s
	iters: 700, epoch: 5 | loss: 0.0821311
	speed: 0.1221s/iter; left time: 5138.0385s
	iters: 800, epoch: 5 | loss: 0.0785077
	speed: 0.1227s/iter; left time: 5152.3935s
	iters: 900, epoch: 5 | loss: 0.0880126
	speed: 0.1273s/iter; left time: 5331.1461s
	iters: 1000, epoch: 5 | loss: 0.0763944
	speed: 0.1233s/iter; left time: 5152.4257s
	iters: 1100, epoch: 5 | loss: 0.0758381
	speed: 0.1199s/iter; left time: 4997.8302s
	iters: 1200, epoch: 5 | loss: 0.0830716
	speed: 0.1227s/iter; left time: 5101.1974s
	iters: 1300, epoch: 5 | loss: 0.0800337
	speed: 0.1215s/iter; left time: 5039.0160s
	iters: 1400, epoch: 5 | loss: 0.0928819
	speed: 0.1201s/iter; left time: 4972.1698s
	iters: 1500, epoch: 5 | loss: 0.0703389
	speed: 0.1223s/iter; left time: 5049.8767s
	iters: 1600, epoch: 5 | loss: 0.0925038
	speed: 0.1186s/iter; left time: 4885.4127s
	iters: 1700, epoch: 5 | loss: 0.0736254
	speed: 0.1254s/iter; left time: 5152.7273s
	iters: 1800, epoch: 5 | loss: 0.0827256
	speed: 0.1205s/iter; left time: 4939.7981s
	iters: 1900, epoch: 5 | loss: 0.0770165
	speed: 0.1248s/iter; left time: 5100.7339s
	iters: 2000, epoch: 5 | loss: 0.0748519
	speed: 0.1214s/iter; left time: 4951.9783s
	iters: 2100, epoch: 5 | loss: 0.0818176
	speed: 0.1238s/iter; left time: 5038.1865s
	iters: 2200, epoch: 5 | loss: 0.0815690
	speed: 0.1294s/iter; left time: 5250.8622s
	iters: 2300, epoch: 5 | loss: 0.1056789
	speed: 0.1219s/iter; left time: 4933.6225s
	iters: 2400, epoch: 5 | loss: 0.0869661
	speed: 0.1203s/iter; left time: 4858.3086s
	iters: 2500, epoch: 5 | loss: 0.0985921
	speed: 0.1241s/iter; left time: 5000.0069s
	iters: 2600, epoch: 5 | loss: 0.0684036
	speed: 0.1212s/iter; left time: 4869.5123s
Epoch: 5 cost time: 00h:05m:28.74s
Epoch: 5 | Train Loss: 0.0866818 Vali Loss: 0.0797001 Test Loss: 0.0868311
Validation loss decreased (0.080135 --> 0.079700).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.1188883
	speed: 1.0801s/iter; left time: 43215.1434s
	iters: 200, epoch: 6 | loss: 0.0875507
	speed: 0.1203s/iter; left time: 4802.4070s
	iters: 300, epoch: 6 | loss: 0.0807057
	speed: 0.1217s/iter; left time: 4846.0808s
	iters: 400, epoch: 6 | loss: 0.0704877
	speed: 0.1247s/iter; left time: 4951.6835s
	iters: 500, epoch: 6 | loss: 0.0778315
	speed: 0.1205s/iter; left time: 4772.8739s
	iters: 600, epoch: 6 | loss: 0.0950918
	speed: 0.1252s/iter; left time: 4948.2841s
	iters: 700, epoch: 6 | loss: 0.0813851
	speed: 0.1257s/iter; left time: 4954.3791s
	iters: 800, epoch: 6 | loss: 0.0890235
	speed: 0.1145s/iter; left time: 4502.3709s
	iters: 900, epoch: 6 | loss: 0.0926933
	speed: 0.1220s/iter; left time: 4782.3417s
	iters: 1000, epoch: 6 | loss: 0.0856443
	speed: 0.1242s/iter; left time: 4856.5758s
	iters: 1100, epoch: 6 | loss: 0.0886120
	speed: 0.1291s/iter; left time: 5037.0379s
	iters: 1200, epoch: 6 | loss: 0.0603817
	speed: 0.1206s/iter; left time: 4691.3295s
	iters: 1300, epoch: 6 | loss: 0.0879021
	speed: 0.1214s/iter; left time: 4710.2026s
	iters: 1400, epoch: 6 | loss: 0.1013661
	speed: 0.1237s/iter; left time: 4790.2180s
	iters: 1500, epoch: 6 | loss: 0.0748302
	speed: 0.1179s/iter; left time: 4550.8062s
	iters: 1600, epoch: 6 | loss: 0.0890142
	speed: 0.1261s/iter; left time: 4855.4099s
	iters: 1700, epoch: 6 | loss: 0.0706096
	speed: 0.1201s/iter; left time: 4611.3015s
	iters: 1800, epoch: 6 | loss: 0.0830537
	speed: 0.1210s/iter; left time: 4634.2511s
	iters: 1900, epoch: 6 | loss: 0.0720259
	speed: 0.1204s/iter; left time: 4602.0593s
	iters: 2000, epoch: 6 | loss: 0.0876311
	speed: 0.1194s/iter; left time: 4549.9251s
	iters: 2100, epoch: 6 | loss: 0.0846190
	speed: 0.1153s/iter; left time: 4381.5095s
	iters: 2200, epoch: 6 | loss: 0.0942824
	speed: 0.1197s/iter; left time: 4537.4921s
	iters: 2300, epoch: 6 | loss: 0.0858440
	speed: 0.1261s/iter; left time: 4767.5138s
	iters: 2400, epoch: 6 | loss: 0.0759794
	speed: 0.1173s/iter; left time: 4423.4440s
	iters: 2500, epoch: 6 | loss: 0.0880383
	speed: 0.1215s/iter; left time: 4568.3632s
	iters: 2600, epoch: 6 | loss: 0.0596848
	speed: 0.1271s/iter; left time: 4768.3723s
Epoch: 6 cost time: 00h:05m:27.11s
Epoch: 6 | Train Loss: 0.0846411 Vali Loss: 0.0798222 Test Loss: 0.0859858
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0920638
	speed: 1.0889s/iter; left time: 40654.9404s
	iters: 200, epoch: 7 | loss: 0.1065395
	speed: 0.1244s/iter; left time: 4630.9616s
	iters: 300, epoch: 7 | loss: 0.0627838
	speed: 0.1228s/iter; left time: 4560.1871s
	iters: 400, epoch: 7 | loss: 0.0834983
	speed: 0.1213s/iter; left time: 4493.4944s
	iters: 500, epoch: 7 | loss: 0.0813256
	speed: 0.1187s/iter; left time: 4383.3373s
	iters: 600, epoch: 7 | loss: 0.0936052
	speed: 0.1211s/iter; left time: 4461.3375s
	iters: 700, epoch: 7 | loss: 0.0897368
	speed: 0.1188s/iter; left time: 4363.0497s
	iters: 800, epoch: 7 | loss: 0.0712877
	speed: 0.1177s/iter; left time: 4311.6725s
	iters: 900, epoch: 7 | loss: 0.0922524
	speed: 0.1268s/iter; left time: 4634.0975s
	iters: 1000, epoch: 7 | loss: 0.1083432
	speed: 0.1203s/iter; left time: 4384.3760s
	iters: 1100, epoch: 7 | loss: 0.0795755
	speed: 0.1130s/iter; left time: 4104.9531s
	iters: 1200, epoch: 7 | loss: 0.0830358
	speed: 0.1221s/iter; left time: 4423.9972s
	iters: 1300, epoch: 7 | loss: 0.0777278
	speed: 0.1252s/iter; left time: 4522.7798s
	iters: 1400, epoch: 7 | loss: 0.0791193
	speed: 0.1157s/iter; left time: 4169.6404s
	iters: 1500, epoch: 7 | loss: 0.0937434
	speed: 0.1221s/iter; left time: 4389.5757s
	iters: 1600, epoch: 7 | loss: 0.0894421
	speed: 0.1193s/iter; left time: 4273.6029s
	iters: 1700, epoch: 7 | loss: 0.0789753
	speed: 0.1208s/iter; left time: 4316.0113s
	iters: 1800, epoch: 7 | loss: 0.0762554
	speed: 0.1264s/iter; left time: 4503.6826s
	iters: 1900, epoch: 7 | loss: 0.0578167
	speed: 0.1265s/iter; left time: 4497.0209s
	iters: 2000, epoch: 7 | loss: 0.0893710
	speed: 0.1247s/iter; left time: 4420.4862s
	iters: 2100, epoch: 7 | loss: 0.0829187
	speed: 0.1202s/iter; left time: 4246.8789s
	iters: 2200, epoch: 7 | loss: 0.1052914
	speed: 0.1248s/iter; left time: 4396.5759s
	iters: 2300, epoch: 7 | loss: 0.1023362
	speed: 0.1258s/iter; left time: 4421.6090s
	iters: 2400, epoch: 7 | loss: 0.0633124
	speed: 0.1253s/iter; left time: 4390.6589s
	iters: 2500, epoch: 7 | loss: 0.0897403
	speed: 0.1147s/iter; left time: 4008.3266s
	iters: 2600, epoch: 7 | loss: 0.0877524
	speed: 0.1172s/iter; left time: 4084.1017s
Epoch: 7 cost time: 00h:05m:25.04s
Epoch: 7 | Train Loss: 0.0827914 Vali Loss: 0.0802376 Test Loss: 0.0865027
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0741210
	speed: 1.0234s/iter; left time: 35472.6250s
	iters: 200, epoch: 8 | loss: 0.0855546
	speed: 0.1134s/iter; left time: 3919.1548s
	iters: 300, epoch: 8 | loss: 0.0862117
	speed: 0.1145s/iter; left time: 3944.8104s
	iters: 400, epoch: 8 | loss: 0.0810832
	speed: 0.1152s/iter; left time: 3958.8356s
	iters: 500, epoch: 8 | loss: 0.0992447
	speed: 0.1152s/iter; left time: 3947.5852s
	iters: 600, epoch: 8 | loss: 0.0759280
	speed: 0.1157s/iter; left time: 3951.6902s
	iters: 700, epoch: 8 | loss: 0.0706180
	speed: 0.1156s/iter; left time: 3939.2951s
	iters: 800, epoch: 8 | loss: 0.0777954
	speed: 0.1154s/iter; left time: 3918.7120s
	iters: 900, epoch: 8 | loss: 0.0899965
	speed: 0.1138s/iter; left time: 3854.2748s
	iters: 1000, epoch: 8 | loss: 0.0714895
	speed: 0.1137s/iter; left time: 3838.9223s
	iters: 1100, epoch: 8 | loss: 0.0831028
	speed: 0.1137s/iter; left time: 3828.9141s
	iters: 1200, epoch: 8 | loss: 0.0776870
	speed: 0.1142s/iter; left time: 3834.2195s
	iters: 1300, epoch: 8 | loss: 0.0858583
	speed: 0.1170s/iter; left time: 3916.1538s
	iters: 1400, epoch: 8 | loss: 0.0750962
	speed: 0.1143s/iter; left time: 3813.1582s
	iters: 1500, epoch: 8 | loss: 0.0934992
	speed: 0.1136s/iter; left time: 3777.5693s
	iters: 1600, epoch: 8 | loss: 0.0680919
	speed: 0.1178s/iter; left time: 3905.2622s
	iters: 1700, epoch: 8 | loss: 0.0809952
	speed: 0.1163s/iter; left time: 3844.2126s
	iters: 1800, epoch: 8 | loss: 0.0644422
	speed: 0.1131s/iter; left time: 3727.5083s
	iters: 1900, epoch: 8 | loss: 0.0749647
	speed: 0.1140s/iter; left time: 3746.4699s
	iters: 2000, epoch: 8 | loss: 0.0769117
	speed: 0.1155s/iter; left time: 3783.7151s
	iters: 2100, epoch: 8 | loss: 0.0895205
	speed: 0.1166s/iter; left time: 3809.9989s
	iters: 2200, epoch: 8 | loss: 0.0856249
	speed: 0.1153s/iter; left time: 3755.7292s
	iters: 2300, epoch: 8 | loss: 0.0781523
	speed: 0.1150s/iter; left time: 3731.7042s
	iters: 2400, epoch: 8 | loss: 0.0775857
	speed: 0.1160s/iter; left time: 3754.0185s
	iters: 2500, epoch: 8 | loss: 0.0808454
	speed: 0.1143s/iter; left time: 3686.3988s
	iters: 2600, epoch: 8 | loss: 0.0844256
	speed: 0.1156s/iter; left time: 3716.4597s
Epoch: 8 cost time: 00h:05m:08.22s
Epoch: 8 | Train Loss: 0.0808754 Vali Loss: 0.0805583 Test Loss: 0.0866693
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.0862420
	speed: 1.0197s/iter; left time: 32618.5266s
	iters: 200, epoch: 9 | loss: 0.0791138
	speed: 0.1145s/iter; left time: 3651.2684s
	iters: 300, epoch: 9 | loss: 0.0770254
	speed: 0.1177s/iter; left time: 3741.3610s
	iters: 400, epoch: 9 | loss: 0.0769348
	speed: 0.1145s/iter; left time: 3629.4086s
	iters: 500, epoch: 9 | loss: 0.0745477
	speed: 0.1163s/iter; left time: 3672.3151s
	iters: 600, epoch: 9 | loss: 0.0885054
	speed: 0.1173s/iter; left time: 3693.0668s
	iters: 700, epoch: 9 | loss: 0.0813209
	speed: 0.1145s/iter; left time: 3595.4994s
	iters: 800, epoch: 9 | loss: 0.0839284
	speed: 0.1154s/iter; left time: 3609.6311s
	iters: 900, epoch: 9 | loss: 0.0726186
	speed: 0.1157s/iter; left time: 3610.0175s
	iters: 1000, epoch: 9 | loss: 0.0716390
	speed: 0.1154s/iter; left time: 3587.6555s
	iters: 1100, epoch: 9 | loss: 0.0776923
	speed: 0.1136s/iter; left time: 3519.9077s
	iters: 1200, epoch: 9 | loss: 0.0776154
	speed: 0.1131s/iter; left time: 3492.6586s
	iters: 1300, epoch: 9 | loss: 0.0860990
	speed: 0.1160s/iter; left time: 3570.2019s
	iters: 1400, epoch: 9 | loss: 0.0690729
	speed: 0.1139s/iter; left time: 3496.1104s
	iters: 1500, epoch: 9 | loss: 0.0735717
	speed: 0.1116s/iter; left time: 3412.3343s
	iters: 1600, epoch: 9 | loss: 0.0749671
	speed: 0.1152s/iter; left time: 3511.0997s
	iters: 1700, epoch: 9 | loss: 0.0911820
	speed: 0.1138s/iter; left time: 3458.6774s
	iters: 1800, epoch: 9 | loss: 0.0734640
	speed: 0.1157s/iter; left time: 3505.0243s
	iters: 1900, epoch: 9 | loss: 0.0728578
	speed: 0.1153s/iter; left time: 3481.0690s
	iters: 2000, epoch: 9 | loss: 0.0706099
	speed: 0.1147s/iter; left time: 3452.3748s
	iters: 2100, epoch: 9 | loss: 0.0727396
	speed: 0.1155s/iter; left time: 3462.6380s
	iters: 2200, epoch: 9 | loss: 0.0882496
	speed: 0.1152s/iter; left time: 3443.8173s
	iters: 2300, epoch: 9 | loss: 0.0900344
	speed: 0.1159s/iter; left time: 3451.6548s
	iters: 2400, epoch: 9 | loss: 0.0780393
	speed: 0.1155s/iter; left time: 3428.7190s
	iters: 2500, epoch: 9 | loss: 0.0849080
	speed: 0.1150s/iter; left time: 3403.7123s
	iters: 2600, epoch: 9 | loss: 0.0787509
	speed: 0.1151s/iter; left time: 3394.7966s
Epoch: 9 cost time: 00h:05m:08.25s
Epoch: 9 | Train Loss: 0.0790067 Vali Loss: 0.0807893 Test Loss: 0.0869210
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 10 | loss: 0.0815329
	speed: 1.0193s/iter; left time: 29881.4935s
	iters: 200, epoch: 10 | loss: 0.0723726
	speed: 0.1165s/iter; left time: 3403.3836s
	iters: 300, epoch: 10 | loss: 0.0746200
	speed: 0.1142s/iter; left time: 3324.3854s
	iters: 400, epoch: 10 | loss: 0.0674459
	speed: 0.1128s/iter; left time: 3273.8902s
	iters: 500, epoch: 10 | loss: 0.0791470
	speed: 0.1145s/iter; left time: 3310.3644s
	iters: 600, epoch: 10 | loss: 0.0762916
	speed: 0.1190s/iter; left time: 3428.5021s
	iters: 700, epoch: 10 | loss: 0.0842900
	speed: 0.1147s/iter; left time: 3294.8868s
	iters: 800, epoch: 10 | loss: 0.0661934
	speed: 0.1133s/iter; left time: 3242.7917s
	iters: 900, epoch: 10 | loss: 0.0785321
	speed: 0.1158s/iter; left time: 3300.6932s
	iters: 1000, epoch: 10 | loss: 0.0710449
	speed: 0.1159s/iter; left time: 3294.2681s
	iters: 1100, epoch: 10 | loss: 0.0821774
	speed: 0.1136s/iter; left time: 3215.6312s
	iters: 1200, epoch: 10 | loss: 0.0766501
	speed: 0.1129s/iter; left time: 3184.4876s
	iters: 1300, epoch: 10 | loss: 0.0781828
	speed: 0.1144s/iter; left time: 3216.5979s
	iters: 1400, epoch: 10 | loss: 0.1004712
	speed: 0.1140s/iter; left time: 3194.0989s
	iters: 1500, epoch: 10 | loss: 0.0783593
	speed: 0.1131s/iter; left time: 3158.2657s
	iters: 1600, epoch: 10 | loss: 0.0835777
	speed: 0.1176s/iter; left time: 3271.0312s
	iters: 1700, epoch: 10 | loss: 0.0684503
	speed: 0.1142s/iter; left time: 3165.4326s
	iters: 1800, epoch: 10 | loss: 0.0780601
	speed: 0.1144s/iter; left time: 3159.8146s
	iters: 1900, epoch: 10 | loss: 0.0802295
	speed: 0.1141s/iter; left time: 3140.6876s
	iters: 2000, epoch: 10 | loss: 0.0798366
	speed: 0.1135s/iter; left time: 3110.5581s
	iters: 2100, epoch: 10 | loss: 0.0814212
	speed: 0.1143s/iter; left time: 3121.5129s
	iters: 2200, epoch: 10 | loss: 0.0743018
	speed: 0.1154s/iter; left time: 3139.6100s
	iters: 2300, epoch: 10 | loss: 0.0766831
	speed: 0.1115s/iter; left time: 3024.2273s
	iters: 2400, epoch: 10 | loss: 0.0754861
	speed: 0.1085s/iter; left time: 2931.5074s
	iters: 2500, epoch: 10 | loss: 0.0673950
	speed: 0.1141s/iter; left time: 3071.9885s
	iters: 2600, epoch: 10 | loss: 0.0699747
	speed: 0.1135s/iter; left time: 3044.8236s
Epoch: 10 cost time: 00h:05m:05.94s
Epoch: 10 | Train Loss: 0.0774372 Vali Loss: 0.0823554 Test Loss: 0.0883417
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.019759919494390488, rmse:0.14056998491287231, mae:0.08683112263679504, rse:0.5315272808074951
success delete checkpoints
Intermediate time for IT and pred_len 96: 01h:08m:14.72s

=== Starting experiments for pred_len: 168 ===

--- Running model for IT, pred_len=168 ---
train 85371
val 18219
test 18219
[2024-11-03 20:18:56,405] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-03 20:18:57,458] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-03 20:18:57,458] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-03 20:18:57,458] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-03 20:18:57,560] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-03 20:18:57,561] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-03 20:18:58,200] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-03 20:18:58,201] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-03 20:18:58,201] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-03 20:18:58,202] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-03 20:18:58,202] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-03 20:18:58,202] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-03 20:18:58,202] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-03 20:18:58,202] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-03 20:18:58,202] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-03 20:18:58,202] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-03 20:18:58,588] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-03 20:18:58,589] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-03 20:18:58,589] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 193.29 GB, percent = 25.6%
[2024-11-03 20:18:58,741] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-03 20:18:58,742] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.74 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-03 20:18:58,743] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 193.33 GB, percent = 25.6%
[2024-11-03 20:18:58,743] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-03 20:18:58,910] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-03 20:18:58,911] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-03 20:18:58,911] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 193.34 GB, percent = 25.6%
[2024-11-03 20:18:58,912] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-03 20:18:58,912] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-03 20:18:58,912] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-03 20:18:58,912] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-03 20:18:58,913] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-03 20:18:58,914] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-03 20:18:58,914] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-03 20:18:58,914] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-03 20:18:58,914] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-03 20:18:58,914] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-03 20:18:58,914] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-03 20:18:58,914] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-03 20:18:58,914] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-03 20:18:58,914] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-03 20:18:58,914] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fc06dfa3110>
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-03 20:18:58,915] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-03 20:18:58,916] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-03 20:18:58,917] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-03 20:18:58,917] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-03 20:18:58,917] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-03 20:18:58,917] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-03 20:18:58,917] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-03 20:18:58,917] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.2159382
	speed: 0.1688s/iter; left time: 8987.9947s
	iters: 200, epoch: 1 | loss: 0.2169471
	speed: 0.1266s/iter; left time: 6725.1401s
	iters: 300, epoch: 1 | loss: 0.1850180
	speed: 0.1284s/iter; left time: 6811.7981s
	iters: 400, epoch: 1 | loss: 0.1335363
	speed: 0.1263s/iter; left time: 6688.5373s
	iters: 500, epoch: 1 | loss: 0.1362359
	speed: 0.1277s/iter; left time: 6745.5131s
	iters: 600, epoch: 1 | loss: 0.1168138
	speed: 0.1284s/iter; left time: 6770.0533s
	iters: 700, epoch: 1 | loss: 0.1086815
	speed: 0.1276s/iter; left time: 6718.7430s
	iters: 800, epoch: 1 | loss: 0.1136740
	speed: 0.1258s/iter; left time: 6611.2388s
	iters: 900, epoch: 1 | loss: 0.1117396
	speed: 0.1259s/iter; left time: 6603.8215s
	iters: 1000, epoch: 1 | loss: 0.1147921
	speed: 0.1270s/iter; left time: 6647.8004s
	iters: 1100, epoch: 1 | loss: 0.1080129
	speed: 0.1250s/iter; left time: 6528.0576s
	iters: 1200, epoch: 1 | loss: 0.1242537
	speed: 0.1255s/iter; left time: 6544.4916s
	iters: 1300, epoch: 1 | loss: 0.1189426
	speed: 0.1259s/iter; left time: 6549.9950s
	iters: 1400, epoch: 1 | loss: 0.0914909
	speed: 0.1247s/iter; left time: 6476.1490s
	iters: 1500, epoch: 1 | loss: 0.1163723
	speed: 0.1269s/iter; left time: 6580.0809s
	iters: 1600, epoch: 1 | loss: 0.1010581
	speed: 0.1263s/iter; left time: 6535.9959s
	iters: 1700, epoch: 1 | loss: 0.0958032
	speed: 0.1242s/iter; left time: 6414.0186s
	iters: 1800, epoch: 1 | loss: 0.0969449
	speed: 0.1264s/iter; left time: 6515.8776s
	iters: 1900, epoch: 1 | loss: 0.0934629
	speed: 0.1251s/iter; left time: 6433.0175s
	iters: 2000, epoch: 1 | loss: 0.1103176
	speed: 0.1234s/iter; left time: 6336.3626s
	iters: 2100, epoch: 1 | loss: 0.1056070
	speed: 0.1263s/iter; left time: 6473.2160s
	iters: 2200, epoch: 1 | loss: 0.1026355
	speed: 0.1239s/iter; left time: 6335.1837s
	iters: 2300, epoch: 1 | loss: 0.1064908
	speed: 0.1255s/iter; left time: 6407.7300s
	iters: 2400, epoch: 1 | loss: 0.1117751
	speed: 0.1287s/iter; left time: 6554.4221s
	iters: 2500, epoch: 1 | loss: 0.1078130
	speed: 0.1267s/iter; left time: 6440.2062s
	iters: 2600, epoch: 1 | loss: 0.1026039
	speed: 0.1235s/iter; left time: 6264.4007s
Epoch: 1 cost time: 00h:05m:37.43s
Epoch: 1 | Train Loss: 0.1204411 Vali Loss: 0.0876045 Test Loss: 0.0915034
Validation loss decreased (inf --> 0.087604).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0972830
	speed: 1.1562s/iter; left time: 58472.3019s
	iters: 200, epoch: 2 | loss: 0.0874374
	speed: 0.1141s/iter; left time: 5757.8750s
	iters: 300, epoch: 2 | loss: 0.0931379
	speed: 0.1170s/iter; left time: 5896.2167s
	iters: 400, epoch: 2 | loss: 0.1136137
	speed: 0.1134s/iter; left time: 5699.3104s
	iters: 500, epoch: 2 | loss: 0.1128266
	speed: 0.1152s/iter; left time: 5782.3263s
	iters: 600, epoch: 2 | loss: 0.1001407
	speed: 0.1126s/iter; left time: 5639.9692s
	iters: 700, epoch: 2 | loss: 0.0840503
	speed: 0.1158s/iter; left time: 5788.7249s
	iters: 800, epoch: 2 | loss: 0.0859213
	speed: 0.1116s/iter; left time: 5564.6505s
	iters: 900, epoch: 2 | loss: 0.1103960
	speed: 0.1139s/iter; left time: 5670.9123s
	iters: 1000, epoch: 2 | loss: 0.0919214
	speed: 0.1186s/iter; left time: 5891.5262s
	iters: 1100, epoch: 2 | loss: 0.0923761
	speed: 0.1154s/iter; left time: 5719.5178s
	iters: 1200, epoch: 2 | loss: 0.0950010
	speed: 0.1120s/iter; left time: 5539.8004s
	iters: 1300, epoch: 2 | loss: 0.0965657
	speed: 0.1130s/iter; left time: 5578.7222s
	iters: 1400, epoch: 2 | loss: 0.0979968
	speed: 0.1154s/iter; left time: 5686.1529s
	iters: 1500, epoch: 2 | loss: 0.1063472
	speed: 0.1147s/iter; left time: 5640.1787s
	iters: 1600, epoch: 2 | loss: 0.1021644
	speed: 0.1122s/iter; left time: 5506.7581s
	iters: 1700, epoch: 2 | loss: 0.1312233
	speed: 0.1127s/iter; left time: 5521.2830s
	iters: 1800, epoch: 2 | loss: 0.0861884
	speed: 0.1138s/iter; left time: 5564.2598s
	iters: 1900, epoch: 2 | loss: 0.0921369
	speed: 0.1164s/iter; left time: 5677.3142s
	iters: 2000, epoch: 2 | loss: 0.0864059
	speed: 0.1137s/iter; left time: 5535.1938s
	iters: 2100, epoch: 2 | loss: 0.1039751
	speed: 0.1140s/iter; left time: 5537.6795s
	iters: 2200, epoch: 2 | loss: 0.1015228
	speed: 0.1138s/iter; left time: 5514.8010s
	iters: 2300, epoch: 2 | loss: 0.0781528
	speed: 0.1124s/iter; left time: 5438.5495s
	iters: 2400, epoch: 2 | loss: 0.0949763
	speed: 0.1110s/iter; left time: 5360.2614s
	iters: 2500, epoch: 2 | loss: 0.0828070
	speed: 0.1103s/iter; left time: 5313.6583s
	iters: 2600, epoch: 2 | loss: 0.0963483
	speed: 0.1130s/iter; left time: 5430.7824s
Epoch: 2 cost time: 00h:05m:03.97s
Epoch: 2 | Train Loss: 0.0979559 Vali Loss: 0.0849390 Test Loss: 0.0888758
Validation loss decreased (0.087604 --> 0.084939).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0922209
	speed: 1.0196s/iter; left time: 48844.0855s
	iters: 200, epoch: 3 | loss: 0.0644474
	speed: 0.1129s/iter; left time: 5399.0376s
	iters: 300, epoch: 3 | loss: 0.1041549
	speed: 0.1143s/iter; left time: 5450.7034s
	iters: 400, epoch: 3 | loss: 0.1109336
	speed: 0.1132s/iter; left time: 5388.7711s
	iters: 500, epoch: 3 | loss: 0.1064243
	speed: 0.1131s/iter; left time: 5373.5663s
	iters: 600, epoch: 3 | loss: 0.0900191
	speed: 0.1145s/iter; left time: 5429.0218s
	iters: 700, epoch: 3 | loss: 0.0858806
	speed: 0.1136s/iter; left time: 5374.8444s
	iters: 800, epoch: 3 | loss: 0.1083349
	speed: 0.1112s/iter; left time: 5249.5299s
	iters: 900, epoch: 3 | loss: 0.1029609
	speed: 0.1125s/iter; left time: 5301.7130s
	iters: 1000, epoch: 3 | loss: 0.0872559
	speed: 0.1136s/iter; left time: 5340.4887s
	iters: 1100, epoch: 3 | loss: 0.0983983
	speed: 0.1154s/iter; left time: 5411.2824s
	iters: 1200, epoch: 3 | loss: 0.1123618
	speed: 0.1119s/iter; left time: 5239.3426s
	iters: 1300, epoch: 3 | loss: 0.0855980
	speed: 0.1120s/iter; left time: 5231.0785s
	iters: 1400, epoch: 3 | loss: 0.0841101
	speed: 0.1118s/iter; left time: 5209.5184s
	iters: 1500, epoch: 3 | loss: 0.0859778
	speed: 0.1124s/iter; left time: 5226.8275s
	iters: 1600, epoch: 3 | loss: 0.1071441
	speed: 0.1128s/iter; left time: 5235.5990s
	iters: 1700, epoch: 3 | loss: 0.0972808
	speed: 0.1125s/iter; left time: 5209.3522s
	iters: 1800, epoch: 3 | loss: 0.0949871
	speed: 0.1119s/iter; left time: 5170.4263s
	iters: 1900, epoch: 3 | loss: 0.1109390
	speed: 0.1138s/iter; left time: 5244.8320s
	iters: 2000, epoch: 3 | loss: 0.0801679
	speed: 0.1160s/iter; left time: 5336.6812s
	iters: 2100, epoch: 3 | loss: 0.1097496
	speed: 0.1120s/iter; left time: 5142.8642s
	iters: 2200, epoch: 3 | loss: 0.0926881
	speed: 0.1125s/iter; left time: 5151.9609s
	iters: 2300, epoch: 3 | loss: 0.0823457
	speed: 0.1121s/iter; left time: 5125.4586s
	iters: 2400, epoch: 3 | loss: 0.0971059
	speed: 0.1141s/iter; left time: 5201.8496s
	iters: 2500, epoch: 3 | loss: 0.0847562
	speed: 0.1130s/iter; left time: 5144.3606s
	iters: 2600, epoch: 3 | loss: 0.0877398
	speed: 0.1137s/iter; left time: 5161.3596s
Epoch: 3 cost time: 00h:05m:02.27s
Epoch: 3 | Train Loss: 0.0939890 Vali Loss: 0.0849982 Test Loss: 0.0889016
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0809531
	speed: 1.0044s/iter; left time: 45438.6496s
	iters: 200, epoch: 4 | loss: 0.1035346
	speed: 0.1128s/iter; left time: 5093.4320s
	iters: 300, epoch: 4 | loss: 0.0931954
	speed: 0.1140s/iter; left time: 5133.4622s
	iters: 400, epoch: 4 | loss: 0.0936391
	speed: 0.1149s/iter; left time: 5163.9889s
	iters: 500, epoch: 4 | loss: 0.0769154
	speed: 0.1148s/iter; left time: 5146.0266s
	iters: 600, epoch: 4 | loss: 0.1011256
	speed: 0.1127s/iter; left time: 5042.1903s
	iters: 700, epoch: 4 | loss: 0.1071842
	speed: 0.1131s/iter; left time: 5050.2225s
	iters: 800, epoch: 4 | loss: 0.0825684
	speed: 0.1130s/iter; left time: 5032.1413s
	iters: 900, epoch: 4 | loss: 0.0715358
	speed: 0.1175s/iter; left time: 5222.1823s
	iters: 1000, epoch: 4 | loss: 0.0911235
	speed: 0.1122s/iter; left time: 4976.4855s
	iters: 1100, epoch: 4 | loss: 0.0931380
	speed: 0.1121s/iter; left time: 4957.5722s
	iters: 1200, epoch: 4 | loss: 0.0906525
	speed: 0.1126s/iter; left time: 4970.0985s
	iters: 1300, epoch: 4 | loss: 0.0844347
	speed: 0.1125s/iter; left time: 4952.3628s
	iters: 1400, epoch: 4 | loss: 0.0868495
	speed: 0.1140s/iter; left time: 5010.1955s
	iters: 1500, epoch: 4 | loss: 0.0898872
	speed: 0.1120s/iter; left time: 4909.2841s
	iters: 1600, epoch: 4 | loss: 0.0944612
	speed: 0.1123s/iter; left time: 4912.6020s
	iters: 1700, epoch: 4 | loss: 0.0744505
	speed: 0.1140s/iter; left time: 4976.5667s
	iters: 1800, epoch: 4 | loss: 0.0840901
	speed: 0.1121s/iter; left time: 4879.4054s
	iters: 1900, epoch: 4 | loss: 0.0785889
	speed: 0.1157s/iter; left time: 5027.3227s
	iters: 2000, epoch: 4 | loss: 0.0908988
	speed: 0.1145s/iter; left time: 4963.6864s
	iters: 2100, epoch: 4 | loss: 0.1051483
	speed: 0.1126s/iter; left time: 4870.4880s
	iters: 2200, epoch: 4 | loss: 0.0749808
	speed: 0.1124s/iter; left time: 4847.8524s
	iters: 2300, epoch: 4 | loss: 0.0964035
	speed: 0.1123s/iter; left time: 4833.6900s
	iters: 2400, epoch: 4 | loss: 0.0797054
	speed: 0.1128s/iter; left time: 4841.5484s
	iters: 2500, epoch: 4 | loss: 0.0989241
	speed: 0.1122s/iter; left time: 4808.3043s
	iters: 2600, epoch: 4 | loss: 0.0763184
	speed: 0.1124s/iter; left time: 4803.4697s
Epoch: 4 cost time: 00h:05m:02.73s
Epoch: 4 | Train Loss: 0.0912334 Vali Loss: 0.0860498 Test Loss: 0.0906333
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.1012761
	speed: 0.9978s/iter; left time: 42479.9415s
	iters: 200, epoch: 5 | loss: 0.0788181
	speed: 0.1127s/iter; left time: 4784.7008s
	iters: 300, epoch: 5 | loss: 0.0916079
	speed: 0.1132s/iter; left time: 4795.1335s
	iters: 400, epoch: 5 | loss: 0.0774744
	speed: 0.1142s/iter; left time: 4828.3127s
	iters: 500, epoch: 5 | loss: 0.0913393
	speed: 0.1145s/iter; left time: 4827.0348s
	iters: 600, epoch: 5 | loss: 0.0951685
	speed: 0.1133s/iter; left time: 4768.1042s
	iters: 700, epoch: 5 | loss: 0.0887147
	speed: 0.1131s/iter; left time: 4745.9684s
	iters: 800, epoch: 5 | loss: 0.0910846
	speed: 0.1139s/iter; left time: 4768.2605s
	iters: 900, epoch: 5 | loss: 0.0891837
	speed: 0.1128s/iter; left time: 4711.0590s
	iters: 1000, epoch: 5 | loss: 0.0790758
	speed: 0.1133s/iter; left time: 4722.2869s
	iters: 1100, epoch: 5 | loss: 0.0895170
	speed: 0.1145s/iter; left time: 4760.3129s
	iters: 1200, epoch: 5 | loss: 0.0942188
	speed: 0.1131s/iter; left time: 4690.9434s
	iters: 1300, epoch: 5 | loss: 0.0948133
	speed: 0.1126s/iter; left time: 4659.9481s
	iters: 1400, epoch: 5 | loss: 0.0987849
	speed: 0.1167s/iter; left time: 4815.8104s
	iters: 1500, epoch: 5 | loss: 0.0812767
	speed: 0.1149s/iter; left time: 4732.1020s
	iters: 1600, epoch: 5 | loss: 0.0904108
	speed: 0.1145s/iter; left time: 4700.9119s
	iters: 1700, epoch: 5 | loss: 0.1042102
	speed: 0.1130s/iter; left time: 4631.5456s
	iters: 1800, epoch: 5 | loss: 0.0898959
	speed: 0.1130s/iter; left time: 4617.0331s
	iters: 1900, epoch: 5 | loss: 0.0911765
	speed: 0.1132s/iter; left time: 4616.6145s
	iters: 2000, epoch: 5 | loss: 0.0696084
	speed: 0.1135s/iter; left time: 4617.9026s
	iters: 2100, epoch: 5 | loss: 0.0943199
	speed: 0.1152s/iter; left time: 4672.8086s
	iters: 2200, epoch: 5 | loss: 0.0874961
	speed: 0.1113s/iter; left time: 4505.1616s
	iters: 2300, epoch: 5 | loss: 0.0919802
	speed: 0.1122s/iter; left time: 4529.2977s
	iters: 2400, epoch: 5 | loss: 0.0831057
	speed: 0.1130s/iter; left time: 4550.3049s
	iters: 2500, epoch: 5 | loss: 0.0805359
	speed: 0.1137s/iter; left time: 4569.3736s
	iters: 2600, epoch: 5 | loss: 0.0857960
	speed: 0.1137s/iter; left time: 4554.3336s
Epoch: 5 cost time: 00h:05m:03.27s
Epoch: 5 | Train Loss: 0.0882231 Vali Loss: 0.0871280 Test Loss: 0.0905764
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0777886
	speed: 0.9981s/iter; left time: 39828.6754s
	iters: 200, epoch: 6 | loss: 0.0941440
	speed: 0.1153s/iter; left time: 4590.3012s
	iters: 300, epoch: 6 | loss: 0.0958172
	speed: 0.1138s/iter; left time: 4518.4601s
	iters: 400, epoch: 6 | loss: 0.0725196
	speed: 0.1136s/iter; left time: 4497.4792s
	iters: 500, epoch: 6 | loss: 0.0889861
	speed: 0.1136s/iter; left time: 4486.5884s
	iters: 600, epoch: 6 | loss: 0.0903357
	speed: 0.1140s/iter; left time: 4494.2167s
	iters: 700, epoch: 6 | loss: 0.0943096
	speed: 0.1158s/iter; left time: 4552.7988s
	iters: 800, epoch: 6 | loss: 0.0846683
	speed: 0.1139s/iter; left time: 4465.7063s
	iters: 900, epoch: 6 | loss: 0.0848038
	speed: 0.1174s/iter; left time: 4591.0282s
	iters: 1000, epoch: 6 | loss: 0.0868105
	speed: 0.1137s/iter; left time: 4436.4564s
	iters: 1100, epoch: 6 | loss: 0.0821280
	speed: 0.1144s/iter; left time: 4449.0651s
	iters: 1200, epoch: 6 | loss: 0.0953802
	speed: 0.1142s/iter; left time: 4430.3935s
	iters: 1300, epoch: 6 | loss: 0.0808989
	speed: 0.1159s/iter; left time: 4487.6126s
	iters: 1400, epoch: 6 | loss: 0.0898427
	speed: 0.1138s/iter; left time: 4394.5421s
	iters: 1500, epoch: 6 | loss: 0.0939664
	speed: 0.1166s/iter; left time: 4490.2968s
	iters: 1600, epoch: 6 | loss: 0.0925003
	speed: 0.1140s/iter; left time: 4380.1347s
	iters: 1700, epoch: 6 | loss: 0.0959591
	speed: 0.1141s/iter; left time: 4369.6036s
	iters: 1800, epoch: 6 | loss: 0.0839964
	speed: 0.1109s/iter; left time: 4235.9092s
	iters: 1900, epoch: 6 | loss: 0.0757705
	speed: 0.1123s/iter; left time: 4278.5917s
	iters: 2000, epoch: 6 | loss: 0.0871647
	speed: 0.1121s/iter; left time: 4261.2119s
	iters: 2100, epoch: 6 | loss: 0.0874589
	speed: 0.1125s/iter; left time: 4263.0298s
	iters: 2200, epoch: 6 | loss: 0.0961731
	speed: 0.1130s/iter; left time: 4273.7239s
	iters: 2300, epoch: 6 | loss: 0.0795345
	speed: 0.1139s/iter; left time: 4296.2716s
	iters: 2400, epoch: 6 | loss: 0.0825180
	speed: 0.1130s/iter; left time: 4251.1629s
	iters: 2500, epoch: 6 | loss: 0.0753969
	speed: 0.1122s/iter; left time: 4208.6607s
	iters: 2600, epoch: 6 | loss: 0.0764885
	speed: 0.1132s/iter; left time: 4234.7952s
Epoch: 6 cost time: 00h:05m:04.35s
Epoch: 6 | Train Loss: 0.0857598 Vali Loss: 0.0890246 Test Loss: 0.0932542
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0879309
	speed: 1.0021s/iter; left time: 37316.4604s
	iters: 200, epoch: 7 | loss: 0.0852456
	speed: 0.1156s/iter; left time: 4293.4604s
	iters: 300, epoch: 7 | loss: 0.0813645
	speed: 0.1148s/iter; left time: 4253.5320s
	iters: 400, epoch: 7 | loss: 0.0748249
	speed: 0.1139s/iter; left time: 4207.1884s
	iters: 500, epoch: 7 | loss: 0.0818025
	speed: 0.1149s/iter; left time: 4232.5474s
	iters: 600, epoch: 7 | loss: 0.0957716
	speed: 0.1157s/iter; left time: 4249.1404s
	iters: 700, epoch: 7 | loss: 0.0731218
	speed: 0.1143s/iter; left time: 4186.5099s
	iters: 800, epoch: 7 | loss: 0.0727848
	speed: 0.1144s/iter; left time: 4181.6516s
	iters: 900, epoch: 7 | loss: 0.0822178
	speed: 0.1148s/iter; left time: 4181.4862s
	iters: 1000, epoch: 7 | loss: 0.0866405
	speed: 0.1143s/iter; left time: 4152.4235s
	iters: 1100, epoch: 7 | loss: 0.0839373
	speed: 0.1160s/iter; left time: 4202.3776s
	iters: 1200, epoch: 7 | loss: 0.0864395
	speed: 0.1117s/iter; left time: 4035.0252s
	iters: 1300, epoch: 7 | loss: 0.1001431
	speed: 0.1156s/iter; left time: 4165.4831s
	iters: 1400, epoch: 7 | loss: 0.0870203
	speed: 0.1135s/iter; left time: 4079.4270s
	iters: 1500, epoch: 7 | loss: 0.0783804
	speed: 0.1138s/iter; left time: 4079.6902s
	iters: 1600, epoch: 7 | loss: 0.0840335
	speed: 0.1152s/iter; left time: 4116.2249s
	iters: 1700, epoch: 7 | loss: 0.0848608
	speed: 0.1136s/iter; left time: 4048.5709s
	iters: 1800, epoch: 7 | loss: 0.0887816
	speed: 0.1140s/iter; left time: 4049.6803s
	iters: 1900, epoch: 7 | loss: 0.0716856
	speed: 0.1126s/iter; left time: 3990.8076s
	iters: 2000, epoch: 7 | loss: 0.0809039
	speed: 0.1142s/iter; left time: 4034.9774s
	iters: 2100, epoch: 7 | loss: 0.0809592
	speed: 0.1132s/iter; left time: 3990.2337s
	iters: 2200, epoch: 7 | loss: 0.0854933
	speed: 0.1133s/iter; left time: 3982.5259s
	iters: 2300, epoch: 7 | loss: 0.0758755
	speed: 0.1122s/iter; left time: 3932.4847s
	iters: 2400, epoch: 7 | loss: 0.0947762
	speed: 0.1110s/iter; left time: 3877.5687s
	iters: 2500, epoch: 7 | loss: 0.0809882
	speed: 0.1130s/iter; left time: 3937.3034s
	iters: 2600, epoch: 7 | loss: 0.0749397
	speed: 0.1143s/iter; left time: 3971.5130s
Epoch: 7 cost time: 00h:05m:04.25s
Epoch: 7 | Train Loss: 0.0833416 Vali Loss: 0.0886686 Test Loss: 0.0912572
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.019771769642829895, rmse:0.14061212539672852, mae:0.08887572586536407, rse:0.531994640827179
success delete checkpoints
Intermediate time for IT and pred_len 168: 00h:46m:46.48s
Intermediate time for IT: 03h:27m:29.51s
Total time: 19h:53m:35.94s
