
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
train 143885
val 31085
test 31085
[2024-11-02 04:05:41,780] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-02 04:05:42,950] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-02 04:05:42,950] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-02 04:05:42,950] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-02 04:05:43,048] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-02 04:05:43,048] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-02 04:05:43,713] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-02 04:05:43,714] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-02 04:05:43,714] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-02 04:05:43,716] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-02 04:05:43,716] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-02 04:05:43,716] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-02 04:05:43,716] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-02 04:05:43,716] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-02 04:05:43,716] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-02 04:05:43,716] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-02 04:05:44,034] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-02 04:05:44,035] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-02 04:05:44,062] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 74.46 GB, percent = 9.9%
[2024-11-02 04:05:44,198] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-02 04:05:44,199] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 04:05:44,200] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 74.46 GB, percent = 9.9%
[2024-11-02 04:05:44,200] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-02 04:05:44,312] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-02 04:05:44,313] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 04:05:44,313] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 74.46 GB, percent = 9.9%
[2024-11-02 04:05:44,313] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-02 04:05:44,314] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-02 04:05:44,314] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-02 04:05:44,314] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-02 04:05:44,314] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f6394bf6dd0>
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-02 04:05:44,315] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-02 04:05:44,316] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-02 04:05:44,317] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-02 04:05:44,317] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1751984
	speed: 0.1735s/iter; left time: 15584.1708s
	iters: 200, epoch: 1 | loss: 0.1696132
	speed: 0.1309s/iter; left time: 11748.6723s
	iters: 300, epoch: 1 | loss: 0.1651162
	speed: 0.1313s/iter; left time: 11767.3423s
	iters: 400, epoch: 1 | loss: 0.1374285
	speed: 0.1307s/iter; left time: 11699.3748s
	iters: 500, epoch: 1 | loss: 0.0960834
	speed: 0.1272s/iter; left time: 11378.5702s
	iters: 600, epoch: 1 | loss: 0.0871328
	speed: 0.1259s/iter; left time: 11242.6723s
	iters: 700, epoch: 1 | loss: 0.1093957
	speed: 0.1296s/iter; left time: 11562.0570s
	iters: 800, epoch: 1 | loss: 0.0864986
	speed: 0.1166s/iter; left time: 10388.0754s
	iters: 900, epoch: 1 | loss: 0.1236022
	speed: 0.1189s/iter; left time: 10586.8357s
	iters: 1000, epoch: 1 | loss: 0.1236182
	speed: 0.1289s/iter; left time: 11463.7493s
	iters: 1100, epoch: 1 | loss: 0.1068401
	speed: 0.1264s/iter; left time: 11230.1935s
	iters: 1200, epoch: 1 | loss: 0.1080805
	speed: 0.1299s/iter; left time: 11522.8253s
	iters: 1300, epoch: 1 | loss: 0.1073034
	speed: 0.1300s/iter; left time: 11524.5034s
	iters: 1400, epoch: 1 | loss: 0.0848949
	speed: 0.1256s/iter; left time: 11122.0103s
	iters: 1500, epoch: 1 | loss: 0.1067144
	speed: 0.1307s/iter; left time: 11555.8828s
	iters: 1600, epoch: 1 | loss: 0.0850505
	speed: 0.1298s/iter; left time: 11467.4007s
	iters: 1700, epoch: 1 | loss: 0.0994569
	speed: 0.1308s/iter; left time: 11535.5314s
	iters: 1800, epoch: 1 | loss: 0.1062451
	speed: 0.1303s/iter; left time: 11481.1729s
	iters: 1900, epoch: 1 | loss: 0.0976172
	speed: 0.1307s/iter; left time: 11501.9078s
	iters: 2000, epoch: 1 | loss: 0.0936665
	speed: 0.1300s/iter; left time: 11431.7189s
	iters: 2100, epoch: 1 | loss: 0.1149349
	speed: 0.1103s/iter; left time: 9690.5952s
	iters: 2200, epoch: 1 | loss: 0.0990795
	speed: 0.1246s/iter; left time: 10931.3024s
	iters: 2300, epoch: 1 | loss: 0.1037625
	speed: 0.1204s/iter; left time: 10549.2546s
	iters: 2400, epoch: 1 | loss: 0.0966860
	speed: 0.1097s/iter; left time: 9603.1471s
	iters: 2500, epoch: 1 | loss: 0.1019908
	speed: 0.1092s/iter; left time: 9544.9901s
	iters: 2600, epoch: 1 | loss: 0.0780252
	speed: 0.1089s/iter; left time: 9510.2132s
	iters: 2700, epoch: 1 | loss: 0.0944925
	speed: 0.1090s/iter; left time: 9509.5887s
	iters: 2800, epoch: 1 | loss: 0.0935264
	speed: 0.1088s/iter; left time: 9475.9938s
	iters: 2900, epoch: 1 | loss: 0.0859544
	speed: 0.1091s/iter; left time: 9490.9660s
	iters: 3000, epoch: 1 | loss: 0.0855883
	speed: 0.1229s/iter; left time: 10684.9461s
	iters: 3100, epoch: 1 | loss: 0.0829413
	speed: 0.1277s/iter; left time: 11088.7397s
	iters: 3200, epoch: 1 | loss: 0.0780405
	speed: 0.1285s/iter; left time: 11141.1512s
	iters: 3300, epoch: 1 | loss: 0.0817463
	speed: 0.1259s/iter; left time: 10907.2366s
	iters: 3400, epoch: 1 | loss: 0.1099318
	speed: 0.1302s/iter; left time: 11264.9607s
	iters: 3500, epoch: 1 | loss: 0.0809699
	speed: 0.1291s/iter; left time: 11154.1947s
	iters: 3600, epoch: 1 | loss: 0.1028950
	speed: 0.1301s/iter; left time: 11227.4162s
	iters: 3700, epoch: 1 | loss: 0.0928097
	speed: 0.1261s/iter; left time: 10874.1060s
	iters: 3800, epoch: 1 | loss: 0.0896632
	speed: 0.1254s/iter; left time: 10800.9263s
	iters: 3900, epoch: 1 | loss: 0.0757574
	speed: 0.1244s/iter; left time: 10697.8411s
	iters: 4000, epoch: 1 | loss: 0.0994942
	speed: 0.1246s/iter; left time: 10707.7015s
	iters: 4100, epoch: 1 | loss: 0.0882582
	speed: 0.1291s/iter; left time: 11080.5087s
	iters: 4200, epoch: 1 | loss: 0.1168685
	speed: 0.1298s/iter; left time: 11126.1313s
	iters: 4300, epoch: 1 | loss: 0.1015711
	speed: 0.1307s/iter; left time: 11189.2471s
	iters: 4400, epoch: 1 | loss: 0.0811718
	speed: 0.1312s/iter; left time: 11220.3463s
Epoch: 1 cost time: 00h:09m:22.97s
Epoch: 1 | Train Loss: 0.1040335 Vali Loss: 0.0961287 Test Loss: 0.0975929
Validation loss decreased (inf --> 0.096129).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0796660
	speed: 1.7371s/iter; left time: 148215.5008s
	iters: 200, epoch: 2 | loss: 0.0931822
	speed: 0.1176s/iter; left time: 10020.1966s
	iters: 300, epoch: 2 | loss: 0.1017061
	speed: 0.1195s/iter; left time: 10173.8280s
	iters: 400, epoch: 2 | loss: 0.0949261
	speed: 0.1142s/iter; left time: 9710.3122s
	iters: 500, epoch: 2 | loss: 0.1168831
	speed: 0.1137s/iter; left time: 9659.6283s
	iters: 600, epoch: 2 | loss: 0.0772928
	speed: 0.1134s/iter; left time: 9616.1355s
	iters: 700, epoch: 2 | loss: 0.0832478
	speed: 0.1129s/iter; left time: 9569.1699s
	iters: 800, epoch: 2 | loss: 0.0981834
	speed: 0.1166s/iter; left time: 9870.3455s
	iters: 900, epoch: 2 | loss: 0.1037944
	speed: 0.1193s/iter; left time: 10082.1692s
	iters: 1000, epoch: 2 | loss: 0.0856554
	speed: 0.1135s/iter; left time: 9583.9284s
	iters: 1100, epoch: 2 | loss: 0.1003807
	speed: 0.1193s/iter; left time: 10059.9384s
	iters: 1200, epoch: 2 | loss: 0.0889630
	speed: 0.1208s/iter; left time: 10176.5481s
	iters: 1300, epoch: 2 | loss: 0.0855101
	speed: 0.1167s/iter; left time: 9820.3638s
	iters: 1400, epoch: 2 | loss: 0.1153450
	speed: 0.1152s/iter; left time: 9675.8513s
	iters: 1500, epoch: 2 | loss: 0.0956274
	speed: 0.1067s/iter; left time: 8955.2998s
	iters: 1600, epoch: 2 | loss: 0.1119400
	speed: 0.0961s/iter; left time: 8058.9779s
	iters: 1700, epoch: 2 | loss: 0.0828846
	speed: 0.0962s/iter; left time: 8051.7727s
	iters: 1800, epoch: 2 | loss: 0.1111595
	speed: 0.0961s/iter; left time: 8037.0539s
	iters: 1900, epoch: 2 | loss: 0.1014844
	speed: 0.0963s/iter; left time: 8041.7422s
	iters: 2000, epoch: 2 | loss: 0.0966399
	speed: 0.1111s/iter; left time: 9270.6148s
	iters: 2100, epoch: 2 | loss: 0.0997675
	speed: 0.1125s/iter; left time: 9376.3954s
	iters: 2200, epoch: 2 | loss: 0.1031985
	speed: 0.1125s/iter; left time: 9362.4143s
	iters: 2300, epoch: 2 | loss: 0.0954874
	speed: 0.1132s/iter; left time: 9409.2818s
	iters: 2400, epoch: 2 | loss: 0.0890880
	speed: 0.1094s/iter; left time: 9080.3776s
	iters: 2500, epoch: 2 | loss: 0.1061457
	speed: 0.1010s/iter; left time: 8373.6327s
	iters: 2600, epoch: 2 | loss: 0.1096236
	speed: 0.1133s/iter; left time: 9380.5049s
	iters: 2700, epoch: 2 | loss: 0.1097501
	speed: 0.1127s/iter; left time: 9323.8457s
	iters: 2800, epoch: 2 | loss: 0.0776054
	speed: 0.1133s/iter; left time: 9358.0218s
	iters: 2900, epoch: 2 | loss: 0.0837930
	speed: 0.1125s/iter; left time: 9279.9873s
	iters: 3000, epoch: 2 | loss: 0.1149195
	speed: 0.1127s/iter; left time: 9293.0983s
	iters: 3100, epoch: 2 | loss: 0.0764869
	speed: 0.1148s/iter; left time: 9453.8410s
	iters: 3200, epoch: 2 | loss: 0.0779453
	speed: 0.1141s/iter; left time: 9384.4575s
	iters: 3300, epoch: 2 | loss: 0.0975494
	speed: 0.1144s/iter; left time: 9393.0479s
	iters: 3400, epoch: 2 | loss: 0.0804761
	speed: 0.1153s/iter; left time: 9453.6404s
	iters: 3500, epoch: 2 | loss: 0.0919167
	speed: 0.1151s/iter; left time: 9426.7968s
	iters: 3600, epoch: 2 | loss: 0.0746915
	speed: 0.1150s/iter; left time: 9409.6590s
	iters: 3700, epoch: 2 | loss: 0.0837285
	speed: 0.1133s/iter; left time: 9257.2814s
	iters: 3800, epoch: 2 | loss: 0.0917258
	speed: 0.1142s/iter; left time: 9318.9132s
	iters: 3900, epoch: 2 | loss: 0.0715970
	speed: 0.1145s/iter; left time: 9331.8389s
	iters: 4000, epoch: 2 | loss: 0.0857370
	speed: 0.1136s/iter; left time: 9248.2053s
	iters: 4100, epoch: 2 | loss: 0.0920830
	speed: 0.1140s/iter; left time: 9268.6945s
	iters: 4200, epoch: 2 | loss: 0.0768602
	speed: 0.1140s/iter; left time: 9257.3731s
	iters: 4300, epoch: 2 | loss: 0.0806141
	speed: 0.1144s/iter; left time: 9283.5268s
	iters: 4400, epoch: 2 | loss: 0.0979972
	speed: 0.1138s/iter; left time: 9222.8458s
Epoch: 2 cost time: 00h:08m:25.36s
Epoch: 2 | Train Loss: 0.0885479 Vali Loss: 0.0917196 Test Loss: 0.0938499
Validation loss decreased (0.096129 --> 0.091720).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0962270
	speed: 1.5176s/iter; left time: 122666.1800s
	iters: 200, epoch: 3 | loss: 0.0868109
	speed: 0.1207s/iter; left time: 9740.0078s
	iters: 300, epoch: 3 | loss: 0.0884279
	speed: 0.1213s/iter; left time: 9781.4377s
	iters: 400, epoch: 3 | loss: 0.0981889
	speed: 0.1211s/iter; left time: 9751.3365s
	iters: 500, epoch: 3 | loss: 0.0899171
	speed: 0.1207s/iter; left time: 9709.9214s
	iters: 600, epoch: 3 | loss: 0.0844401
	speed: 0.1206s/iter; left time: 9689.5479s
	iters: 700, epoch: 3 | loss: 0.0752369
	speed: 0.1187s/iter; left time: 9520.6208s
	iters: 800, epoch: 3 | loss: 0.1060660
	speed: 0.1208s/iter; left time: 9680.7391s
	iters: 900, epoch: 3 | loss: 0.0833049
	speed: 0.1208s/iter; left time: 9668.7466s
	iters: 1000, epoch: 3 | loss: 0.0819281
	speed: 0.1203s/iter; left time: 9615.2239s
	iters: 1100, epoch: 3 | loss: 0.0777918
	speed: 0.1209s/iter; left time: 9652.0103s
	iters: 1200, epoch: 3 | loss: 0.0780214
	speed: 0.1177s/iter; left time: 9387.0852s
	iters: 1300, epoch: 3 | loss: 0.0893477
	speed: 0.1156s/iter; left time: 9203.5842s
	iters: 1400, epoch: 3 | loss: 0.1029789
	speed: 0.1209s/iter; left time: 9618.1192s
	iters: 1500, epoch: 3 | loss: 0.0834389
	speed: 0.1209s/iter; left time: 9603.3986s
	iters: 1600, epoch: 3 | loss: 0.0866824
	speed: 0.1183s/iter; left time: 9383.2547s
	iters: 1700, epoch: 3 | loss: 0.0818847
	speed: 0.1208s/iter; left time: 9572.4971s
	iters: 1800, epoch: 3 | loss: 0.0906848
	speed: 0.1213s/iter; left time: 9599.9935s
	iters: 1900, epoch: 3 | loss: 0.1146158
	speed: 0.1195s/iter; left time: 9447.6256s
	iters: 2000, epoch: 3 | loss: 0.1075108
	speed: 0.1056s/iter; left time: 8332.5540s
	iters: 2100, epoch: 3 | loss: 0.0804141
	speed: 0.1122s/iter; left time: 8843.5249s
	iters: 2200, epoch: 3 | loss: 0.0912658
	speed: 0.1183s/iter; left time: 9313.1841s
	iters: 2300, epoch: 3 | loss: 0.0801835
	speed: 0.1185s/iter; left time: 9316.9041s
	iters: 2400, epoch: 3 | loss: 0.0916704
	speed: 0.1210s/iter; left time: 9504.5358s
	iters: 2500, epoch: 3 | loss: 0.0994615
	speed: 0.1174s/iter; left time: 9204.7229s
	iters: 2600, epoch: 3 | loss: 0.1034542
	speed: 0.1202s/iter; left time: 9416.0022s
	iters: 2700, epoch: 3 | loss: 0.0897656
	speed: 0.1209s/iter; left time: 9459.9946s
	iters: 2800, epoch: 3 | loss: 0.1089268
	speed: 0.1208s/iter; left time: 9440.5900s
	iters: 2900, epoch: 3 | loss: 0.0789208
	speed: 0.1212s/iter; left time: 9457.2291s
	iters: 3000, epoch: 3 | loss: 0.0762717
	speed: 0.1165s/iter; left time: 9082.1749s
	iters: 3100, epoch: 3 | loss: 0.0869183
	speed: 0.1207s/iter; left time: 9395.2146s
	iters: 3200, epoch: 3 | loss: 0.0751872
	speed: 0.1154s/iter; left time: 8971.9236s
	iters: 3300, epoch: 3 | loss: 0.0878178
	speed: 0.1213s/iter; left time: 9413.0328s
	iters: 3400, epoch: 3 | loss: 0.0656829
	speed: 0.1207s/iter; left time: 9357.4105s
	iters: 3500, epoch: 3 | loss: 0.0847644
	speed: 0.1191s/iter; left time: 9220.4443s
	iters: 3600, epoch: 3 | loss: 0.0789355
	speed: 0.1208s/iter; left time: 9342.9600s
	iters: 3700, epoch: 3 | loss: 0.0871209
	speed: 0.1179s/iter; left time: 9103.4060s
	iters: 3800, epoch: 3 | loss: 0.0978919
	speed: 0.1205s/iter; left time: 9290.4399s
	iters: 3900, epoch: 3 | loss: 0.0924827
	speed: 0.1217s/iter; left time: 9377.2864s
	iters: 4000, epoch: 3 | loss: 0.0813397
	speed: 0.1194s/iter; left time: 9185.8177s
	iters: 4100, epoch: 3 | loss: 0.0784988
	speed: 0.1202s/iter; left time: 9236.4669s
	iters: 4200, epoch: 3 | loss: 0.0991811
	speed: 0.1209s/iter; left time: 9276.9542s
	iters: 4300, epoch: 3 | loss: 0.0861519
	speed: 0.1210s/iter; left time: 9272.3883s
	iters: 4400, epoch: 3 | loss: 0.0760844
	speed: 0.1200s/iter; left time: 9186.2755s
Epoch: 3 cost time: 00h:08m:57.62s
Epoch: 3 | Train Loss: 0.0849499 Vali Loss: 0.0901408 Test Loss: 0.0926513
Validation loss decreased (0.091720 --> 0.090141).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.1111427
	speed: 1.5235s/iter; left time: 116290.6463s
	iters: 200, epoch: 4 | loss: 0.0753410
	speed: 0.1209s/iter; left time: 9216.7592s
	iters: 300, epoch: 4 | loss: 0.0888413
	speed: 0.1208s/iter; left time: 9197.5835s
	iters: 400, epoch: 4 | loss: 0.0714968
	speed: 0.1192s/iter; left time: 9065.1911s
	iters: 500, epoch: 4 | loss: 0.0833365
	speed: 0.1151s/iter; left time: 8739.0584s
	iters: 600, epoch: 4 | loss: 0.0899843
	speed: 0.1184s/iter; left time: 8976.1350s
	iters: 700, epoch: 4 | loss: 0.0789592
	speed: 0.1167s/iter; left time: 8841.6298s
	iters: 800, epoch: 4 | loss: 0.0856384
	speed: 0.1136s/iter; left time: 8592.4849s
	iters: 900, epoch: 4 | loss: 0.0778323
	speed: 0.1137s/iter; left time: 8585.3265s
	iters: 1000, epoch: 4 | loss: 0.0816742
	speed: 0.1140s/iter; left time: 8599.2045s
	iters: 1100, epoch: 4 | loss: 0.0672043
	speed: 0.1184s/iter; left time: 8920.9904s
	iters: 1200, epoch: 4 | loss: 0.0746364
	speed: 0.1208s/iter; left time: 9087.3051s
	iters: 1300, epoch: 4 | loss: 0.0835876
	speed: 0.1208s/iter; left time: 9074.5038s
	iters: 1400, epoch: 4 | loss: 0.0832614
	speed: 0.1192s/iter; left time: 8945.4002s
	iters: 1500, epoch: 4 | loss: 0.0914626
	speed: 0.1205s/iter; left time: 9032.8420s
	iters: 1600, epoch: 4 | loss: 0.0810632
	speed: 0.1167s/iter; left time: 8731.8975s
	iters: 1700, epoch: 4 | loss: 0.0825682
	speed: 0.1207s/iter; left time: 9019.9769s
	iters: 1800, epoch: 4 | loss: 0.0768290
	speed: 0.1207s/iter; left time: 9009.0520s
	iters: 1900, epoch: 4 | loss: 0.1031834
	speed: 0.1204s/iter; left time: 8974.2922s
	iters: 2000, epoch: 4 | loss: 0.0810642
	speed: 0.1205s/iter; left time: 8968.9662s
	iters: 2100, epoch: 4 | loss: 0.1011447
	speed: 0.1185s/iter; left time: 8809.8841s
	iters: 2200, epoch: 4 | loss: 0.0945584
	speed: 0.1131s/iter; left time: 8393.2932s
	iters: 2300, epoch: 4 | loss: 0.0859294
	speed: 0.1130s/iter; left time: 8373.3779s
	iters: 2400, epoch: 4 | loss: 0.0821534
	speed: 0.1129s/iter; left time: 8356.1091s
	iters: 2500, epoch: 4 | loss: 0.0808725
	speed: 0.1137s/iter; left time: 8405.3245s
	iters: 2600, epoch: 4 | loss: 0.0857516
	speed: 0.1193s/iter; left time: 8808.3368s
	iters: 2700, epoch: 4 | loss: 0.0724460
	speed: 0.1210s/iter; left time: 8918.9110s
	iters: 2800, epoch: 4 | loss: 0.0676562
	speed: 0.1206s/iter; left time: 8881.6904s
	iters: 2900, epoch: 4 | loss: 0.0927680
	speed: 0.1205s/iter; left time: 8858.0213s
	iters: 3000, epoch: 4 | loss: 0.0894543
	speed: 0.1152s/iter; left time: 8461.9201s
	iters: 3100, epoch: 4 | loss: 0.0880243
	speed: 0.1147s/iter; left time: 8409.3481s
	iters: 3200, epoch: 4 | loss: 0.0814270
	speed: 0.1162s/iter; left time: 8507.9933s
	iters: 3300, epoch: 4 | loss: 0.0787635
	speed: 0.1172s/iter; left time: 8570.4009s
	iters: 3400, epoch: 4 | loss: 0.0685097
	speed: 0.1157s/iter; left time: 8452.7793s
	iters: 3500, epoch: 4 | loss: 0.0689826
	speed: 0.1148s/iter; left time: 8372.5090s
	iters: 3600, epoch: 4 | loss: 0.1017262
	speed: 0.1141s/iter; left time: 8312.6962s
	iters: 3700, epoch: 4 | loss: 0.0673666
	speed: 0.1152s/iter; left time: 8376.7681s
	iters: 3800, epoch: 4 | loss: 0.0698210
	speed: 0.1127s/iter; left time: 8184.9480s
	iters: 3900, epoch: 4 | loss: 0.0750384
	speed: 0.1125s/iter; left time: 8157.1098s
	iters: 4000, epoch: 4 | loss: 0.0919478
	speed: 0.1131s/iter; left time: 8189.3309s
	iters: 4100, epoch: 4 | loss: 0.0796407
	speed: 0.0963s/iter; left time: 6968.1981s
	iters: 4200, epoch: 4 | loss: 0.0891761
	speed: 0.1107s/iter; left time: 7993.9332s
	iters: 4300, epoch: 4 | loss: 0.0734849
	speed: 0.1142s/iter; left time: 8236.1714s
	iters: 4400, epoch: 4 | loss: 0.0780938
	speed: 0.1141s/iter; left time: 8221.2131s
Epoch: 4 cost time: 00h:08m:43.54s
Epoch: 4 | Train Loss: 0.0830537 Vali Loss: 0.0887350 Test Loss: 0.0919589
Validation loss decreased (0.090141 --> 0.088735).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0724721
	speed: 1.5060s/iter; left time: 108189.1676s
	iters: 200, epoch: 5 | loss: 0.0816491
	speed: 0.1202s/iter; left time: 8623.4440s
	iters: 300, epoch: 5 | loss: 0.0865343
	speed: 0.1167s/iter; left time: 8360.7473s
	iters: 400, epoch: 5 | loss: 0.0748772
	speed: 0.1129s/iter; left time: 8075.5640s
	iters: 500, epoch: 5 | loss: 0.0879068
	speed: 0.1137s/iter; left time: 8123.7226s
	iters: 600, epoch: 5 | loss: 0.0776411
	speed: 0.1134s/iter; left time: 8086.9740s
	iters: 700, epoch: 5 | loss: 0.0837840
	speed: 0.1134s/iter; left time: 8076.2918s
	iters: 800, epoch: 5 | loss: 0.0696601
	speed: 0.1163s/iter; left time: 8271.1694s
	iters: 900, epoch: 5 | loss: 0.0858637
	speed: 0.1159s/iter; left time: 8233.1103s
	iters: 1000, epoch: 5 | loss: 0.0875993
	speed: 0.1137s/iter; left time: 8063.5210s
	iters: 1100, epoch: 5 | loss: 0.0880472
	speed: 0.1159s/iter; left time: 8211.4916s
	iters: 1200, epoch: 5 | loss: 0.0787003
	speed: 0.1140s/iter; left time: 8060.8014s
	iters: 1300, epoch: 5 | loss: 0.0790513
	speed: 0.1149s/iter; left time: 8119.3239s
	iters: 1400, epoch: 5 | loss: 0.0656777
	speed: 0.1213s/iter; left time: 8558.4860s
	iters: 1500, epoch: 5 | loss: 0.0692728
	speed: 0.1212s/iter; left time: 8534.1719s
	iters: 1600, epoch: 5 | loss: 0.0867893
	speed: 0.1185s/iter; left time: 8337.5441s
	iters: 1700, epoch: 5 | loss: 0.0772494
	speed: 0.1151s/iter; left time: 8082.2563s
	iters: 1800, epoch: 5 | loss: 0.1018692
	speed: 0.1172s/iter; left time: 8223.1548s
	iters: 1900, epoch: 5 | loss: 0.0822593
	speed: 0.1211s/iter; left time: 8482.3100s
	iters: 2000, epoch: 5 | loss: 0.0723740
	speed: 0.1204s/iter; left time: 8419.7675s
	iters: 2100, epoch: 5 | loss: 0.0827404
	speed: 0.1177s/iter; left time: 8221.5918s
	iters: 2200, epoch: 5 | loss: 0.0853322
	speed: 0.1207s/iter; left time: 8418.3833s
	iters: 2300, epoch: 5 | loss: 0.0850059
	speed: 0.1212s/iter; left time: 8441.9546s
	iters: 2400, epoch: 5 | loss: 0.0737549
	speed: 0.1212s/iter; left time: 8430.9857s
	iters: 2500, epoch: 5 | loss: 0.0851119
	speed: 0.1207s/iter; left time: 8377.8651s
	iters: 2600, epoch: 5 | loss: 0.0840694
	speed: 0.1202s/iter; left time: 8334.7514s
	iters: 2700, epoch: 5 | loss: 0.0876200
	speed: 0.1209s/iter; left time: 8368.1360s
	iters: 2800, epoch: 5 | loss: 0.0861114
	speed: 0.1200s/iter; left time: 8293.5198s
	iters: 2900, epoch: 5 | loss: 0.0650319
	speed: 0.1171s/iter; left time: 8086.0150s
	iters: 3000, epoch: 5 | loss: 0.0898532
	speed: 0.1208s/iter; left time: 8327.2123s
	iters: 3100, epoch: 5 | loss: 0.0896070
	speed: 0.1181s/iter; left time: 8131.1862s
	iters: 3200, epoch: 5 | loss: 0.0580150
	speed: 0.1154s/iter; left time: 7934.0417s
	iters: 3300, epoch: 5 | loss: 0.0968894
	speed: 0.1192s/iter; left time: 8182.1327s
	iters: 3400, epoch: 5 | loss: 0.0927546
	speed: 0.1209s/iter; left time: 8286.1156s
	iters: 3500, epoch: 5 | loss: 0.0884232
	speed: 0.1204s/iter; left time: 8241.1341s
	iters: 3600, epoch: 5 | loss: 0.0773740
	speed: 0.1149s/iter; left time: 7848.5766s
	iters: 3700, epoch: 5 | loss: 0.0735403
	speed: 0.1157s/iter; left time: 7893.2557s
	iters: 3800, epoch: 5 | loss: 0.0843595
	speed: 0.1185s/iter; left time: 8071.4490s
	iters: 3900, epoch: 5 | loss: 0.0890049
	speed: 0.1212s/iter; left time: 8247.9663s
	iters: 4000, epoch: 5 | loss: 0.0733620
	speed: 0.1180s/iter; left time: 8016.0967s
	iters: 4100, epoch: 5 | loss: 0.0826425
	speed: 0.1195s/iter; left time: 8108.4777s
	iters: 4200, epoch: 5 | loss: 0.0942001
	speed: 0.1175s/iter; left time: 7958.0431s
	iters: 4300, epoch: 5 | loss: 0.0662682
	speed: 0.1208s/iter; left time: 8169.3140s
	iters: 4400, epoch: 5 | loss: 0.0639044
	speed: 0.1202s/iter; left time: 8118.1535s
Epoch: 5 cost time: 00h:08m:51.87s
Epoch: 5 | Train Loss: 0.0819060 Vali Loss: 0.0899136 Test Loss: 0.0937484
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0834547
	speed: 1.5025s/iter; left time: 101181.7385s
	iters: 200, epoch: 6 | loss: 0.0788915
	speed: 0.1156s/iter; left time: 7776.1217s
	iters: 300, epoch: 6 | loss: 0.0766931
	speed: 0.1185s/iter; left time: 7954.5460s
	iters: 400, epoch: 6 | loss: 0.0621577
	speed: 0.1160s/iter; left time: 7779.0340s
	iters: 500, epoch: 6 | loss: 0.0798744
	speed: 0.1150s/iter; left time: 7700.7145s
	iters: 600, epoch: 6 | loss: 0.0737847
	speed: 0.1144s/iter; left time: 7647.0265s
	iters: 700, epoch: 6 | loss: 0.0843354
	speed: 0.1210s/iter; left time: 8075.2940s
	iters: 800, epoch: 6 | loss: 0.0722700
	speed: 0.1209s/iter; left time: 8057.6134s
	iters: 900, epoch: 6 | loss: 0.0824605
	speed: 0.1207s/iter; left time: 8032.2200s
	iters: 1000, epoch: 6 | loss: 0.0940322
	speed: 0.1201s/iter; left time: 7979.0409s
	iters: 1100, epoch: 6 | loss: 0.0984112
	speed: 0.1182s/iter; left time: 7840.0682s
	iters: 1200, epoch: 6 | loss: 0.0816496
	speed: 0.1212s/iter; left time: 8029.8885s
	iters: 1300, epoch: 6 | loss: 0.0897281
	speed: 0.1208s/iter; left time: 7991.1979s
	iters: 1400, epoch: 6 | loss: 0.0707488
	speed: 0.1212s/iter; left time: 8002.9449s
	iters: 1500, epoch: 6 | loss: 0.0827402
	speed: 0.1209s/iter; left time: 7973.2661s
	iters: 1600, epoch: 6 | loss: 0.0788377
	speed: 0.1208s/iter; left time: 7952.6845s
	iters: 1700, epoch: 6 | loss: 0.0708660
	speed: 0.1208s/iter; left time: 7939.3029s
	iters: 1800, epoch: 6 | loss: 0.0858712
	speed: 0.1144s/iter; left time: 7512.0945s
	iters: 1900, epoch: 6 | loss: 0.0694004
	speed: 0.1157s/iter; left time: 7582.9526s
	iters: 2000, epoch: 6 | loss: 0.0808107
	speed: 0.1208s/iter; left time: 7903.0900s
	iters: 2100, epoch: 6 | loss: 0.0673134
	speed: 0.1139s/iter; left time: 7440.9977s
	iters: 2200, epoch: 6 | loss: 0.0682330
	speed: 0.1151s/iter; left time: 7506.4159s
	iters: 2300, epoch: 6 | loss: 0.0918810
	speed: 0.1209s/iter; left time: 7874.9710s
	iters: 2400, epoch: 6 | loss: 0.0851345
	speed: 0.1208s/iter; left time: 7855.7979s
	iters: 2500, epoch: 6 | loss: 0.0815403
	speed: 0.1209s/iter; left time: 7854.2735s
	iters: 2600, epoch: 6 | loss: 0.0941485
	speed: 0.1208s/iter; left time: 7834.8281s
	iters: 2700, epoch: 6 | loss: 0.0907783
	speed: 0.1209s/iter; left time: 7829.0331s
	iters: 2800, epoch: 6 | loss: 0.0615061
	speed: 0.1212s/iter; left time: 7834.7400s
	iters: 2900, epoch: 6 | loss: 0.0898525
	speed: 0.1187s/iter; left time: 7662.9349s
	iters: 3000, epoch: 6 | loss: 0.0763716
	speed: 0.1052s/iter; left time: 6779.6397s
	iters: 3100, epoch: 6 | loss: 0.0835483
	speed: 0.1076s/iter; left time: 6922.0729s
	iters: 3200, epoch: 6 | loss: 0.0802400
	speed: 0.1186s/iter; left time: 7616.6857s
	iters: 3300, epoch: 6 | loss: 0.0705647
	speed: 0.1210s/iter; left time: 7760.8542s
	iters: 3400, epoch: 6 | loss: 0.0637157
	speed: 0.1209s/iter; left time: 7740.7803s
	iters: 3500, epoch: 6 | loss: 0.0887412
	speed: 0.1211s/iter; left time: 7743.5506s
	iters: 3600, epoch: 6 | loss: 0.0846283
	speed: 0.1158s/iter; left time: 7395.1846s
	iters: 3700, epoch: 6 | loss: 0.0793136
	speed: 0.1203s/iter; left time: 7668.3205s
	iters: 3800, epoch: 6 | loss: 0.0903979
	speed: 0.1206s/iter; left time: 7674.0616s
	iters: 3900, epoch: 6 | loss: 0.0845485
	speed: 0.1208s/iter; left time: 7674.5317s
	iters: 4000, epoch: 6 | loss: 0.0887016
	speed: 0.1209s/iter; left time: 7668.5008s
	iters: 4100, epoch: 6 | loss: 0.0647517
	speed: 0.1188s/iter; left time: 7525.8907s
	iters: 4200, epoch: 6 | loss: 0.0810043
	speed: 0.1141s/iter; left time: 7215.1798s
	iters: 4300, epoch: 6 | loss: 0.0847861
	speed: 0.1206s/iter; left time: 7615.9642s
	iters: 4400, epoch: 6 | loss: 0.0607698
	speed: 0.1209s/iter; left time: 7620.7176s
Epoch: 6 cost time: 00h:08m:53.65s
Epoch: 6 | Train Loss: 0.0808758 Vali Loss: 0.0904147 Test Loss: 0.0949829
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0776564
	speed: 1.5165s/iter; left time: 95306.6113s
	iters: 200, epoch: 7 | loss: 0.0784396
	speed: 0.1208s/iter; left time: 7578.0014s
	iters: 300, epoch: 7 | loss: 0.0935769
	speed: 0.1209s/iter; left time: 7571.0067s
	iters: 400, epoch: 7 | loss: 0.1011236
	speed: 0.1210s/iter; left time: 7569.2014s
	iters: 500, epoch: 7 | loss: 0.0993084
	speed: 0.1199s/iter; left time: 7488.3781s
	iters: 600, epoch: 7 | loss: 0.0678284
	speed: 0.1153s/iter; left time: 7190.7073s
	iters: 700, epoch: 7 | loss: 0.0915019
	speed: 0.1158s/iter; left time: 7210.0226s
	iters: 800, epoch: 7 | loss: 0.0908480
	speed: 0.1212s/iter; left time: 7534.5951s
	iters: 900, epoch: 7 | loss: 0.1084777
	speed: 0.1211s/iter; left time: 7514.2712s
	iters: 1000, epoch: 7 | loss: 0.0742308
	speed: 0.1202s/iter; left time: 7445.9882s
	iters: 1100, epoch: 7 | loss: 0.0900566
	speed: 0.1200s/iter; left time: 7419.1822s
	iters: 1200, epoch: 7 | loss: 0.0717520
	speed: 0.1169s/iter; left time: 7216.7687s
	iters: 1300, epoch: 7 | loss: 0.0896325
	speed: 0.1197s/iter; left time: 7377.1597s
	iters: 1400, epoch: 7 | loss: 0.0751720
	speed: 0.1205s/iter; left time: 7416.6328s
	iters: 1500, epoch: 7 | loss: 0.0697805
	speed: 0.1168s/iter; left time: 7178.5825s
	iters: 1600, epoch: 7 | loss: 0.0777683
	speed: 0.1154s/iter; left time: 7076.2840s
	iters: 1700, epoch: 7 | loss: 0.0931582
	speed: 0.1211s/iter; left time: 7415.2672s
	iters: 1800, epoch: 7 | loss: 0.0872888
	speed: 0.1206s/iter; left time: 7373.5675s
	iters: 1900, epoch: 7 | loss: 0.0675946
	speed: 0.1210s/iter; left time: 7385.9729s
	iters: 2000, epoch: 7 | loss: 0.0718096
	speed: 0.1211s/iter; left time: 7381.1314s
	iters: 2100, epoch: 7 | loss: 0.0726633
	speed: 0.1209s/iter; left time: 7358.4123s
	iters: 2200, epoch: 7 | loss: 0.0895870
	speed: 0.1173s/iter; left time: 7128.2462s
	iters: 2300, epoch: 7 | loss: 0.0828907
	speed: 0.1143s/iter; left time: 6931.1229s
	iters: 2400, epoch: 7 | loss: 0.0906809
	speed: 0.1088s/iter; left time: 6585.8205s
	iters: 2500, epoch: 7 | loss: 0.0836006
	speed: 0.1187s/iter; left time: 7173.4855s
	iters: 2600, epoch: 7 | loss: 0.0730073
	speed: 0.0993s/iter; left time: 5990.1222s
	iters: 2700, epoch: 7 | loss: 0.0711934
	speed: 0.1122s/iter; left time: 6760.5423s
	iters: 2800, epoch: 7 | loss: 0.0955372
	speed: 0.1142s/iter; left time: 6867.4480s
	iters: 2900, epoch: 7 | loss: 0.0695751
	speed: 0.1138s/iter; left time: 6831.3028s
	iters: 3000, epoch: 7 | loss: 0.0690845
	speed: 0.1166s/iter; left time: 6987.5757s
	iters: 3100, epoch: 7 | loss: 0.0937775
	speed: 0.1209s/iter; left time: 7234.3981s
	iters: 3200, epoch: 7 | loss: 0.1030593
	speed: 0.1212s/iter; left time: 7242.7967s
	iters: 3300, epoch: 7 | loss: 0.0797456
	speed: 0.1211s/iter; left time: 7225.2851s
	iters: 3400, epoch: 7 | loss: 0.0739272
	speed: 0.1209s/iter; left time: 7199.8657s
	iters: 3500, epoch: 7 | loss: 0.0762674
	speed: 0.1210s/iter; left time: 7192.6481s
	iters: 3600, epoch: 7 | loss: 0.0890733
	speed: 0.1211s/iter; left time: 7186.6449s
	iters: 3700, epoch: 7 | loss: 0.0628304
	speed: 0.1172s/iter; left time: 6940.8726s
	iters: 3800, epoch: 7 | loss: 0.0651186
	speed: 0.1178s/iter; left time: 6968.0551s
	iters: 3900, epoch: 7 | loss: 0.0825545
	speed: 0.1209s/iter; left time: 7139.1120s
	iters: 4000, epoch: 7 | loss: 0.0898772
	speed: 0.1208s/iter; left time: 7121.8930s
	iters: 4100, epoch: 7 | loss: 0.0976483
	speed: 0.1194s/iter; left time: 7024.7355s
	iters: 4200, epoch: 7 | loss: 0.0855372
	speed: 0.1156s/iter; left time: 6789.4006s
	iters: 4300, epoch: 7 | loss: 0.0670111
	speed: 0.1152s/iter; left time: 6754.4861s
	iters: 4400, epoch: 7 | loss: 0.0837409
	speed: 0.1206s/iter; left time: 7062.9214s
Epoch: 7 cost time: 00h:08m:52.25s
Epoch: 7 | Train Loss: 0.0799692 Vali Loss: 0.0892061 Test Loss: 0.0939316
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0858032
	speed: 1.4986s/iter; left time: 87440.8666s
	iters: 200, epoch: 8 | loss: 0.0891609
	speed: 0.1206s/iter; left time: 7025.2453s
	iters: 300, epoch: 8 | loss: 0.0738470
	speed: 0.1218s/iter; left time: 7085.3730s
	iters: 400, epoch: 8 | loss: 0.0654960
	speed: 0.1156s/iter; left time: 6710.4905s
	iters: 500, epoch: 8 | loss: 0.0660103
	speed: 0.1153s/iter; left time: 6682.4981s
	iters: 600, epoch: 8 | loss: 0.0857095
	speed: 0.1220s/iter; left time: 7056.9123s
	iters: 700, epoch: 8 | loss: 0.0678255
	speed: 0.1206s/iter; left time: 6962.1952s
	iters: 800, epoch: 8 | loss: 0.0832420
	speed: 0.1209s/iter; left time: 6970.8135s
	iters: 900, epoch: 8 | loss: 0.0736113
	speed: 0.1211s/iter; left time: 6969.5437s
	iters: 1000, epoch: 8 | loss: 0.0566616
	speed: 0.1201s/iter; left time: 6897.1962s
	iters: 1100, epoch: 8 | loss: 0.0793718
	speed: 0.1152s/iter; left time: 6607.7398s
	iters: 1200, epoch: 8 | loss: 0.0917201
	speed: 0.1205s/iter; left time: 6898.9591s
	iters: 1300, epoch: 8 | loss: 0.0691053
	speed: 0.1183s/iter; left time: 6761.3995s
	iters: 1400, epoch: 8 | loss: 0.0720860
	speed: 0.1199s/iter; left time: 6840.1601s
	iters: 1500, epoch: 8 | loss: 0.0792802
	speed: 0.1200s/iter; left time: 6835.0838s
	iters: 1600, epoch: 8 | loss: 0.0826451
	speed: 0.1216s/iter; left time: 6915.1612s
	iters: 1700, epoch: 8 | loss: 0.0810083
	speed: 0.1210s/iter; left time: 6867.3659s
	iters: 1800, epoch: 8 | loss: 0.1009962
	speed: 0.1204s/iter; left time: 6820.7911s
	iters: 1900, epoch: 8 | loss: 0.0958357
	speed: 0.1183s/iter; left time: 6689.8956s
	iters: 2000, epoch: 8 | loss: 0.0718374
	speed: 0.1189s/iter; left time: 6709.0451s
	iters: 2100, epoch: 8 | loss: 0.0927144
	speed: 0.1200s/iter; left time: 6761.6151s
	iters: 2200, epoch: 8 | loss: 0.0949822
	speed: 0.1210s/iter; left time: 6807.8392s
	iters: 2300, epoch: 8 | loss: 0.0678577
	speed: 0.1204s/iter; left time: 6761.3589s
	iters: 2400, epoch: 8 | loss: 0.0812559
	speed: 0.1168s/iter; left time: 6543.9464s
	iters: 2500, epoch: 8 | loss: 0.0822914
	speed: 0.1195s/iter; left time: 6684.1770s
	iters: 2600, epoch: 8 | loss: 0.0643865
	speed: 0.1171s/iter; left time: 6541.8708s
	iters: 2700, epoch: 8 | loss: 0.0984127
	speed: 0.1209s/iter; left time: 6740.7699s
	iters: 2800, epoch: 8 | loss: 0.0899339
	speed: 0.1208s/iter; left time: 6724.1681s
	iters: 2900, epoch: 8 | loss: 0.0574796
	speed: 0.1213s/iter; left time: 6738.5486s
	iters: 3000, epoch: 8 | loss: 0.0782979
	speed: 0.1184s/iter; left time: 6563.7757s
	iters: 3100, epoch: 8 | loss: 0.0836753
	speed: 0.1175s/iter; left time: 6503.8366s
	iters: 3200, epoch: 8 | loss: 0.0640419
	speed: 0.1172s/iter; left time: 6473.2469s
	iters: 3300, epoch: 8 | loss: 0.0771721
	speed: 0.1215s/iter; left time: 6700.6903s
	iters: 3400, epoch: 8 | loss: 0.0778379
	speed: 0.1222s/iter; left time: 6727.0175s
	iters: 3500, epoch: 8 | loss: 0.0805037
	speed: 0.1208s/iter; left time: 6635.9473s
	iters: 3600, epoch: 8 | loss: 0.0769201
	speed: 0.1209s/iter; left time: 6632.4699s
	iters: 3700, epoch: 8 | loss: 0.0943394
	speed: 0.1207s/iter; left time: 6608.6204s
	iters: 3800, epoch: 8 | loss: 0.0953691
	speed: 0.1208s/iter; left time: 6600.3599s
	iters: 3900, epoch: 8 | loss: 0.0673332
	speed: 0.1209s/iter; left time: 6596.0071s
	iters: 4000, epoch: 8 | loss: 0.0977372
	speed: 0.1215s/iter; left time: 6616.9175s
	iters: 4100, epoch: 8 | loss: 0.0735301
	speed: 0.1205s/iter; left time: 6550.7294s
	iters: 4200, epoch: 8 | loss: 0.0813443
	speed: 0.1207s/iter; left time: 6548.4466s
	iters: 4300, epoch: 8 | loss: 0.0507200
	speed: 0.1207s/iter; left time: 6534.2047s
	iters: 4400, epoch: 8 | loss: 0.0746277
	speed: 0.1213s/iter; left time: 6557.3912s
Epoch: 8 cost time: 00h:08m:59.78s
Epoch: 8 | Train Loss: 0.0791088 Vali Loss: 0.0891922 Test Loss: 0.0933998
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.0883823
	speed: 1.4926s/iter; left time: 80382.3245s
	iters: 200, epoch: 9 | loss: 0.0742780
	speed: 0.1143s/iter; left time: 6142.0410s
	iters: 300, epoch: 9 | loss: 0.0729224
	speed: 0.1201s/iter; left time: 6441.2238s
	iters: 400, epoch: 9 | loss: 0.0771885
	speed: 0.1207s/iter; left time: 6463.8236s
	iters: 500, epoch: 9 | loss: 0.0633648
	speed: 0.1197s/iter; left time: 6400.8904s
	iters: 600, epoch: 9 | loss: 0.0877349
	speed: 0.1186s/iter; left time: 6325.5573s
	iters: 700, epoch: 9 | loss: 0.0688003
	speed: 0.1209s/iter; left time: 6437.5326s
	iters: 800, epoch: 9 | loss: 0.0829574
	speed: 0.1209s/iter; left time: 6426.9728s
	iters: 900, epoch: 9 | loss: 0.0724092
	speed: 0.1204s/iter; left time: 6387.5727s
	iters: 1000, epoch: 9 | loss: 0.0991572
	speed: 0.1208s/iter; left time: 6396.3747s
	iters: 1100, epoch: 9 | loss: 0.0887690
	speed: 0.1202s/iter; left time: 6351.6722s
	iters: 1200, epoch: 9 | loss: 0.0728898
	speed: 0.1207s/iter; left time: 6365.8803s
	iters: 1300, epoch: 9 | loss: 0.0847884
	speed: 0.1209s/iter; left time: 6367.3844s
	iters: 1400, epoch: 9 | loss: 0.0939002
	speed: 0.1167s/iter; left time: 6131.6376s
	iters: 1500, epoch: 9 | loss: 0.0808990
	speed: 0.1090s/iter; left time: 5716.1509s
	iters: 1600, epoch: 9 | loss: 0.0823213
	speed: 0.1135s/iter; left time: 5939.6949s
	iters: 1700, epoch: 9 | loss: 0.0796168
	speed: 0.1195s/iter; left time: 6245.6759s
	iters: 1800, epoch: 9 | loss: 0.0721289
	speed: 0.1208s/iter; left time: 6300.5310s
	iters: 1900, epoch: 9 | loss: 0.0679318
	speed: 0.1194s/iter; left time: 6216.6185s
	iters: 2000, epoch: 9 | loss: 0.0717794
	speed: 0.1184s/iter; left time: 6152.9969s
	iters: 2100, epoch: 9 | loss: 0.0890689
	speed: 0.1140s/iter; left time: 5910.6588s
	iters: 2200, epoch: 9 | loss: 0.0657449
	speed: 0.1195s/iter; left time: 6186.4854s
	iters: 2300, epoch: 9 | loss: 0.0594654
	speed: 0.1209s/iter; left time: 6245.2868s
	iters: 2400, epoch: 9 | loss: 0.0709143
	speed: 0.1209s/iter; left time: 6233.7558s
	iters: 2500, epoch: 9 | loss: 0.0705610
	speed: 0.1191s/iter; left time: 6130.5124s
	iters: 2600, epoch: 9 | loss: 0.0897841
	speed: 0.1159s/iter; left time: 5952.4614s
	iters: 2700, epoch: 9 | loss: 0.0816959
	speed: 0.1198s/iter; left time: 6140.9849s
	iters: 2800, epoch: 9 | loss: 0.0750316
	speed: 0.1207s/iter; left time: 6176.0496s
	iters: 2900, epoch: 9 | loss: 0.0815326
	speed: 0.1208s/iter; left time: 6169.1837s
	iters: 3000, epoch: 9 | loss: 0.0938492
	speed: 0.1186s/iter; left time: 6043.0369s
	iters: 3100, epoch: 9 | loss: 0.0800535
	speed: 0.1145s/iter; left time: 5825.0162s
	iters: 3200, epoch: 9 | loss: 0.0835484
	speed: 0.1131s/iter; left time: 5737.9751s
	iters: 3300, epoch: 9 | loss: 0.0548027
	speed: 0.1160s/iter; left time: 5875.0380s
	iters: 3400, epoch: 9 | loss: 0.0590655
	speed: 0.1189s/iter; left time: 6010.3775s
	iters: 3500, epoch: 9 | loss: 0.0721123
	speed: 0.1180s/iter; left time: 5954.1996s
	iters: 3600, epoch: 9 | loss: 0.0877456
	speed: 0.1141s/iter; left time: 5744.7532s
	iters: 3700, epoch: 9 | loss: 0.0746561
	speed: 0.1183s/iter; left time: 5943.7809s
	iters: 3800, epoch: 9 | loss: 0.0877061
	speed: 0.1192s/iter; left time: 5979.5753s
	iters: 3900, epoch: 9 | loss: 0.0804281
	speed: 0.1201s/iter; left time: 6011.7280s
	iters: 4000, epoch: 9 | loss: 0.0666070
	speed: 0.1166s/iter; left time: 5823.0049s
	iters: 4100, epoch: 9 | loss: 0.0842516
	speed: 0.1181s/iter; left time: 5886.4829s
	iters: 4200, epoch: 9 | loss: 0.0634511
	speed: 0.1156s/iter; left time: 5751.5241s
	iters: 4300, epoch: 9 | loss: 0.0862772
	speed: 0.1136s/iter; left time: 5639.1242s
	iters: 4400, epoch: 9 | loss: 0.0666628
	speed: 0.1130s/iter; left time: 5600.0875s
Epoch: 9 cost time: 00h:08m:51.02s
Epoch: 9 | Train Loss: 0.0782179 Vali Loss: 0.0899105 Test Loss: 0.0940169
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.02172875590622425, rmse:0.14740677177906036, mae:0.0919589027762413, rse:0.5206128358840942
success delete checkpoints
Intermediate time for DE and pred_len 24: 01h:40m:54.77s

=== Starting experiments for pred_len: 96 ===

--- Running model for DE, pred_len=96 ---
train 143525
val 30725
test 30725
[2024-11-02 05:46:36,884] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-02 05:46:38,092] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-02 05:46:38,092] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-02 05:46:38,093] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-02 05:46:38,196] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-02 05:46:38,196] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-02 05:46:38,862] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-02 05:46:38,864] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-02 05:46:38,864] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-02 05:46:38,865] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-02 05:46:38,865] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-02 05:46:38,865] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-02 05:46:38,866] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-02 05:46:38,866] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-02 05:46:38,866] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-02 05:46:38,866] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-02 05:46:39,195] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-02 05:46:39,196] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-02 05:46:39,197] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 74.27 GB, percent = 9.8%
[2024-11-02 05:46:39,323] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-02 05:46:39,324] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-02 05:46:39,324] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 74.27 GB, percent = 9.8%
[2024-11-02 05:46:39,324] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-02 05:46:39,441] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-02 05:46:39,443] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-02 05:46:39,443] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 74.27 GB, percent = 9.8%
[2024-11-02 05:46:39,443] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-02 05:46:39,444] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-02 05:46:39,444] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-02 05:46:39,444] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-02 05:46:39,444] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-02 05:46:39,445] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-02 05:46:39,445] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-02 05:46:39,445] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-02 05:46:39,445] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-02 05:46:39,445] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-02 05:46:39,445] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-02 05:46:39,445] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-02 05:46:39,445] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-02 05:46:39,445] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-02 05:46:39,445] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-02 05:46:39,445] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f9778b9ae50>
[2024-11-02 05:46:39,445] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-02 05:46:39,445] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-02 05:46:39,445] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-02 05:46:39,445] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-02 05:46:39,445] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-02 05:46:39,445] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-02 05:46:39,445] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-02 05:46:39,446] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-02 05:46:39,447] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-02 05:46:39,447] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1796905
	speed: 0.1577s/iter; left time: 14133.7593s
	iters: 200, epoch: 1 | loss: 0.1528330
	speed: 0.1278s/iter; left time: 11439.1865s
	iters: 300, epoch: 1 | loss: 0.1636411
	speed: 0.1276s/iter; left time: 11403.7132s
	iters: 400, epoch: 1 | loss: 0.1717221
	speed: 0.1243s/iter; left time: 11104.3602s
	iters: 500, epoch: 1 | loss: 0.1625754
	speed: 0.1295s/iter; left time: 11553.6505s
	iters: 600, epoch: 1 | loss: 0.1756469
	speed: 0.1281s/iter; left time: 11417.1809s
	iters: 700, epoch: 1 | loss: 0.1374525
	speed: 0.1274s/iter; left time: 11335.4492s
	iters: 800, epoch: 1 | loss: 0.1207612
	speed: 0.1274s/iter; left time: 11324.7311s
	iters: 900, epoch: 1 | loss: 0.1471106
	speed: 0.1264s/iter; left time: 11227.5124s
	iters: 1000, epoch: 1 | loss: 0.1346920
	speed: 0.1189s/iter; left time: 10544.4150s
	iters: 1100, epoch: 1 | loss: 0.1261072
	speed: 0.1074s/iter; left time: 9516.7964s
	iters: 1200, epoch: 1 | loss: 0.1214257
	speed: 0.1180s/iter; left time: 10447.1125s
	iters: 1300, epoch: 1 | loss: 0.1278190
	speed: 0.1280s/iter; left time: 11318.8812s
	iters: 1400, epoch: 1 | loss: 0.1183581
	speed: 0.1278s/iter; left time: 11283.1554s
	iters: 1500, epoch: 1 | loss: 0.1059927
	speed: 0.1275s/iter; left time: 11248.9772s
	iters: 1600, epoch: 1 | loss: 0.1225744
	speed: 0.1286s/iter; left time: 11326.9879s
	iters: 1700, epoch: 1 | loss: 0.1184389
	speed: 0.1284s/iter; left time: 11298.2002s
	iters: 1800, epoch: 1 | loss: 0.1273916
	speed: 0.1280s/iter; left time: 11254.2115s
	iters: 1900, epoch: 1 | loss: 0.1305389
	speed: 0.1272s/iter; left time: 11166.4987s
	iters: 2000, epoch: 1 | loss: 0.1092692
	speed: 0.1274s/iter; left time: 11172.1297s
	iters: 2100, epoch: 1 | loss: 0.1127294
	speed: 0.1260s/iter; left time: 11039.1152s
	iters: 2200, epoch: 1 | loss: 0.1192679
	speed: 0.1277s/iter; left time: 11177.4816s
	iters: 2300, epoch: 1 | loss: 0.1197385
	speed: 0.1074s/iter; left time: 9389.1119s
	iters: 2400, epoch: 1 | loss: 0.1230457
	speed: 0.1143s/iter; left time: 9981.0137s
	iters: 2500, epoch: 1 | loss: 0.1455796
	speed: 0.1242s/iter; left time: 10829.2640s
	iters: 2600, epoch: 1 | loss: 0.1400923
	speed: 0.1104s/iter; left time: 9615.3961s
	iters: 2700, epoch: 1 | loss: 0.1138726
	speed: 0.1156s/iter; left time: 10056.6128s
	iters: 2800, epoch: 1 | loss: 0.1174629
	speed: 0.1278s/iter; left time: 11106.0899s
	iters: 2900, epoch: 1 | loss: 0.1184106
	speed: 0.1274s/iter; left time: 11058.7338s
	iters: 3000, epoch: 1 | loss: 0.1312887
	speed: 0.1269s/iter; left time: 11005.5283s
	iters: 3100, epoch: 1 | loss: 0.1324136
	speed: 0.1278s/iter; left time: 11071.3846s
	iters: 3200, epoch: 1 | loss: 0.1211721
	speed: 0.1211s/iter; left time: 10473.4759s
	iters: 3300, epoch: 1 | loss: 0.1178138
	speed: 0.1249s/iter; left time: 10794.9082s
	iters: 3400, epoch: 1 | loss: 0.1224443
	speed: 0.1261s/iter; left time: 10881.3066s
	iters: 3500, epoch: 1 | loss: 0.1183141
	speed: 0.1274s/iter; left time: 10980.9751s
	iters: 3600, epoch: 1 | loss: 0.1242890
	speed: 0.1273s/iter; left time: 10958.4074s
	iters: 3700, epoch: 1 | loss: 0.1144471
	speed: 0.1281s/iter; left time: 11012.8003s
	iters: 3800, epoch: 1 | loss: 0.1015655
	speed: 0.1274s/iter; left time: 10939.5922s
	iters: 3900, epoch: 1 | loss: 0.1111848
	speed: 0.1269s/iter; left time: 10891.3807s
	iters: 4000, epoch: 1 | loss: 0.1316575
	speed: 0.1284s/iter; left time: 11005.7130s
	iters: 4100, epoch: 1 | loss: 0.1088002
	speed: 0.1266s/iter; left time: 10841.2923s
	iters: 4200, epoch: 1 | loss: 0.1164419
	speed: 0.1271s/iter; left time: 10870.0765s
	iters: 4300, epoch: 1 | loss: 0.1259046
	speed: 0.1272s/iter; left time: 10862.7851s
	iters: 4400, epoch: 1 | loss: 0.1085604
	speed: 0.1257s/iter; left time: 10722.8313s
Epoch: 1 cost time: 00h:09m:20.10s
Epoch: 1 | Train Loss: 0.1268652 Vali Loss: 0.1215782 Test Loss: 0.1305961
Validation loss decreased (inf --> 0.121578).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0937665
	speed: 1.7150s/iter; left time: 145973.5313s
	iters: 200, epoch: 2 | loss: 0.1341150
	speed: 0.1166s/iter; left time: 9911.0785s
	iters: 300, epoch: 2 | loss: 0.1132426
	speed: 0.1154s/iter; left time: 9796.2151s
	iters: 400, epoch: 2 | loss: 0.1143301
	speed: 0.1156s/iter; left time: 9801.1368s
	iters: 500, epoch: 2 | loss: 0.0936279
	speed: 0.1152s/iter; left time: 9760.1670s
	iters: 600, epoch: 2 | loss: 0.1210652
	speed: 0.1165s/iter; left time: 9855.5831s
	iters: 700, epoch: 2 | loss: 0.1088079
	speed: 0.1156s/iter; left time: 9767.0333s
	iters: 800, epoch: 2 | loss: 0.1030090
	speed: 0.1160s/iter; left time: 9795.4755s
	iters: 900, epoch: 2 | loss: 0.1108489
	speed: 0.1152s/iter; left time: 9711.7447s
	iters: 1000, epoch: 2 | loss: 0.1083097
	speed: 0.1155s/iter; left time: 9728.4191s
	iters: 1100, epoch: 2 | loss: 0.1051919
	speed: 0.1161s/iter; left time: 9761.8822s
	iters: 1200, epoch: 2 | loss: 0.1058292
	speed: 0.1166s/iter; left time: 9794.1186s
	iters: 1300, epoch: 2 | loss: 0.1199586
	speed: 0.1125s/iter; left time: 9438.4597s
	iters: 1400, epoch: 2 | loss: 0.1058512
	speed: 0.1161s/iter; left time: 9733.0043s
	iters: 1500, epoch: 2 | loss: 0.1033324
	speed: 0.1153s/iter; left time: 9651.2989s
	iters: 1600, epoch: 2 | loss: 0.1068781
	speed: 0.1155s/iter; left time: 9653.7709s
	iters: 1700, epoch: 2 | loss: 0.1302516
	speed: 0.1162s/iter; left time: 9703.8041s
	iters: 1800, epoch: 2 | loss: 0.0881851
	speed: 0.1156s/iter; left time: 9644.9497s
	iters: 1900, epoch: 2 | loss: 0.1368857
	speed: 0.1155s/iter; left time: 9624.0595s
	iters: 2000, epoch: 2 | loss: 0.1057539
	speed: 0.1158s/iter; left time: 9637.0728s
	iters: 2100, epoch: 2 | loss: 0.1266332
	speed: 0.1150s/iter; left time: 9559.3286s
	iters: 2200, epoch: 2 | loss: 0.1175085
	speed: 0.1074s/iter; left time: 8920.0190s
	iters: 2300, epoch: 2 | loss: 0.0942677
	speed: 0.1158s/iter; left time: 9605.4521s
	iters: 2400, epoch: 2 | loss: 0.1120734
	speed: 0.1093s/iter; left time: 9050.4594s
	iters: 2500, epoch: 2 | loss: 0.1228208
	speed: 0.1142s/iter; left time: 9444.7890s
	iters: 2600, epoch: 2 | loss: 0.1139171
	speed: 0.1172s/iter; left time: 9685.9896s
	iters: 2700, epoch: 2 | loss: 0.1344807
	speed: 0.1079s/iter; left time: 8904.6353s
	iters: 2800, epoch: 2 | loss: 0.0970470
	speed: 0.1166s/iter; left time: 9607.0546s
	iters: 2900, epoch: 2 | loss: 0.1221787
	speed: 0.1143s/iter; left time: 9411.3897s
	iters: 3000, epoch: 2 | loss: 0.1317635
	speed: 0.1162s/iter; left time: 9555.0655s
	iters: 3100, epoch: 2 | loss: 0.1116549
	speed: 0.1154s/iter; left time: 9472.8397s
	iters: 3200, epoch: 2 | loss: 0.1177123
	speed: 0.1151s/iter; left time: 9437.1712s
	iters: 3300, epoch: 2 | loss: 0.1062045
	speed: 0.1152s/iter; left time: 9438.3001s
	iters: 3400, epoch: 2 | loss: 0.1368778
	speed: 0.1154s/iter; left time: 9442.2239s
	iters: 3500, epoch: 2 | loss: 0.1050819
	speed: 0.1156s/iter; left time: 9450.0167s
	iters: 3600, epoch: 2 | loss: 0.0943935
	speed: 0.1152s/iter; left time: 9398.9143s
	iters: 3700, epoch: 2 | loss: 0.1096257
	speed: 0.1152s/iter; left time: 9387.5670s
	iters: 3800, epoch: 2 | loss: 0.1289937
	speed: 0.1157s/iter; left time: 9420.3089s
	iters: 3900, epoch: 2 | loss: 0.1044328
	speed: 0.1159s/iter; left time: 9425.1984s
	iters: 4000, epoch: 2 | loss: 0.1009454
	speed: 0.1122s/iter; left time: 9109.3106s
	iters: 4100, epoch: 2 | loss: 0.1349109
	speed: 0.1134s/iter; left time: 9199.0742s
	iters: 4200, epoch: 2 | loss: 0.1130775
	speed: 0.1154s/iter; left time: 9346.9434s
	iters: 4300, epoch: 2 | loss: 0.0991431
	speed: 0.0968s/iter; left time: 7830.6714s
	iters: 4400, epoch: 2 | loss: 0.1101747
	speed: 0.0967s/iter; left time: 7816.9526s
Epoch: 2 cost time: 00h:08m:31.10s
Epoch: 2 | Train Loss: 0.1110525 Vali Loss: 0.1208038 Test Loss: 0.1302489
Validation loss decreased (0.121578 --> 0.120804).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.1169660
	speed: 1.4572s/iter; left time: 117493.7390s
	iters: 200, epoch: 3 | loss: 0.1078827
	speed: 0.1170s/iter; left time: 9421.6242s
	iters: 300, epoch: 3 | loss: 0.1039631
	speed: 0.1156s/iter; left time: 9301.5319s
	iters: 400, epoch: 3 | loss: 0.1180947
	speed: 0.1156s/iter; left time: 9285.7093s
	iters: 500, epoch: 3 | loss: 0.1180327
	speed: 0.1161s/iter; left time: 9313.3744s
	iters: 600, epoch: 3 | loss: 0.0924053
	speed: 0.1146s/iter; left time: 9185.8182s
	iters: 700, epoch: 3 | loss: 0.1207208
	speed: 0.1144s/iter; left time: 9155.2845s
	iters: 800, epoch: 3 | loss: 0.1209414
	speed: 0.1149s/iter; left time: 9184.5775s
	iters: 900, epoch: 3 | loss: 0.1271856
	speed: 0.1151s/iter; left time: 9192.0041s
	iters: 1000, epoch: 3 | loss: 0.1029982
	speed: 0.1169s/iter; left time: 9321.4557s
	iters: 1100, epoch: 3 | loss: 0.1220193
	speed: 0.1147s/iter; left time: 9136.6739s
	iters: 1200, epoch: 3 | loss: 0.0876944
	speed: 0.1166s/iter; left time: 9272.6736s
	iters: 1300, epoch: 3 | loss: 0.0800447
	speed: 0.1177s/iter; left time: 9346.4810s
	iters: 1400, epoch: 3 | loss: 0.1022078
	speed: 0.1156s/iter; left time: 9167.7192s
	iters: 1500, epoch: 3 | loss: 0.0931360
	speed: 0.1172s/iter; left time: 9286.0300s
	iters: 1600, epoch: 3 | loss: 0.0966400
	speed: 0.1152s/iter; left time: 9119.7205s
	iters: 1700, epoch: 3 | loss: 0.1089689
	speed: 0.1145s/iter; left time: 9049.5219s
	iters: 1800, epoch: 3 | loss: 0.1262760
	speed: 0.1156s/iter; left time: 9123.7408s
	iters: 1900, epoch: 3 | loss: 0.1214038
	speed: 0.1169s/iter; left time: 9216.6460s
	iters: 2000, epoch: 3 | loss: 0.1131916
	speed: 0.1180s/iter; left time: 9291.4135s
	iters: 2100, epoch: 3 | loss: 0.0910320
	speed: 0.1178s/iter; left time: 9262.6729s
	iters: 2200, epoch: 3 | loss: 0.1071264
	speed: 0.1164s/iter; left time: 9138.9622s
	iters: 2300, epoch: 3 | loss: 0.1228675
	speed: 0.1169s/iter; left time: 9169.1644s
	iters: 2400, epoch: 3 | loss: 0.1094589
	speed: 0.1165s/iter; left time: 9124.5763s
	iters: 2500, epoch: 3 | loss: 0.0970292
	speed: 0.1196s/iter; left time: 9357.8439s
	iters: 2600, epoch: 3 | loss: 0.1208833
	speed: 0.1177s/iter; left time: 9196.2377s
	iters: 2700, epoch: 3 | loss: 0.1006875
	speed: 0.1178s/iter; left time: 9192.0300s
	iters: 2800, epoch: 3 | loss: 0.0891459
	speed: 0.1157s/iter; left time: 9016.8123s
	iters: 2900, epoch: 3 | loss: 0.1074533
	speed: 0.1165s/iter; left time: 9070.8716s
	iters: 3000, epoch: 3 | loss: 0.1291854
	speed: 0.1162s/iter; left time: 9029.8660s
	iters: 3100, epoch: 3 | loss: 0.1223493
	speed: 0.1171s/iter; left time: 9092.2994s
	iters: 3200, epoch: 3 | loss: 0.1235415
	speed: 0.1169s/iter; left time: 9061.9804s
	iters: 3300, epoch: 3 | loss: 0.0978686
	speed: 0.1164s/iter; left time: 9014.0719s
	iters: 3400, epoch: 3 | loss: 0.1255539
	speed: 0.1168s/iter; left time: 9030.1651s
	iters: 3500, epoch: 3 | loss: 0.0985570
	speed: 0.1172s/iter; left time: 9052.8040s
	iters: 3600, epoch: 3 | loss: 0.0875186
	speed: 0.1137s/iter; left time: 8770.0572s
	iters: 3700, epoch: 3 | loss: 0.0979343
	speed: 0.1147s/iter; left time: 8833.0443s
	iters: 3800, epoch: 3 | loss: 0.1091715
	speed: 0.1158s/iter; left time: 8909.1244s
	iters: 3900, epoch: 3 | loss: 0.1004776
	speed: 0.1161s/iter; left time: 8921.2142s
	iters: 4000, epoch: 3 | loss: 0.0880002
	speed: 0.1155s/iter; left time: 8859.3549s
	iters: 4100, epoch: 3 | loss: 0.1066579
	speed: 0.1155s/iter; left time: 8847.4811s
	iters: 4200, epoch: 3 | loss: 0.1162613
	speed: 0.1103s/iter; left time: 8442.6629s
	iters: 4300, epoch: 3 | loss: 0.1064103
	speed: 0.1093s/iter; left time: 8355.1387s
	iters: 4400, epoch: 3 | loss: 0.1064245
	speed: 0.1126s/iter; left time: 8592.9947s
Epoch: 3 cost time: 00h:08m:40.34s
Epoch: 3 | Train Loss: 0.1070935 Vali Loss: 0.1214075 Test Loss: 0.1343616
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0998068
	speed: 1.4499s/iter; left time: 110404.1637s
	iters: 200, epoch: 4 | loss: 0.0908893
	speed: 0.1157s/iter; left time: 8798.1010s
	iters: 300, epoch: 4 | loss: 0.1107343
	speed: 0.1172s/iter; left time: 8901.5089s
	iters: 400, epoch: 4 | loss: 0.1227403
	speed: 0.1148s/iter; left time: 8707.7615s
	iters: 500, epoch: 4 | loss: 0.1063603
	speed: 0.1164s/iter; left time: 8817.2421s
	iters: 600, epoch: 4 | loss: 0.1203433
	speed: 0.1154s/iter; left time: 8731.4206s
	iters: 700, epoch: 4 | loss: 0.1365832
	speed: 0.1154s/iter; left time: 8720.3389s
	iters: 800, epoch: 4 | loss: 0.0913843
	speed: 0.1152s/iter; left time: 8693.4082s
	iters: 900, epoch: 4 | loss: 0.1054852
	speed: 0.1156s/iter; left time: 8711.6342s
	iters: 1000, epoch: 4 | loss: 0.0973554
	speed: 0.1146s/iter; left time: 8626.5125s
	iters: 1100, epoch: 4 | loss: 0.0843453
	speed: 0.1155s/iter; left time: 8677.2394s
	iters: 1200, epoch: 4 | loss: 0.0939158
	speed: 0.1066s/iter; left time: 8001.1407s
	iters: 1300, epoch: 4 | loss: 0.0991926
	speed: 0.1078s/iter; left time: 8079.6909s
	iters: 1400, epoch: 4 | loss: 0.0926170
	speed: 0.1164s/iter; left time: 8710.1360s
	iters: 1500, epoch: 4 | loss: 0.0980558
	speed: 0.1150s/iter; left time: 8592.9991s
	iters: 1600, epoch: 4 | loss: 0.1088924
	speed: 0.1165s/iter; left time: 8692.9161s
	iters: 1700, epoch: 4 | loss: 0.1093120
	speed: 0.1152s/iter; left time: 8586.7060s
	iters: 1800, epoch: 4 | loss: 0.1005844
	speed: 0.1150s/iter; left time: 8557.7215s
	iters: 1900, epoch: 4 | loss: 0.1107281
	speed: 0.1146s/iter; left time: 8519.5482s
	iters: 2000, epoch: 4 | loss: 0.1060532
	speed: 0.1163s/iter; left time: 8637.1994s
	iters: 2100, epoch: 4 | loss: 0.0904001
	speed: 0.1151s/iter; left time: 8531.3305s
	iters: 2200, epoch: 4 | loss: 0.1109696
	speed: 0.1162s/iter; left time: 8605.2239s
	iters: 2300, epoch: 4 | loss: 0.1122366
	speed: 0.0992s/iter; left time: 7336.7084s
	iters: 2400, epoch: 4 | loss: 0.0989136
	speed: 0.1142s/iter; left time: 8431.5912s
	iters: 2500, epoch: 4 | loss: 0.0947601
	speed: 0.1094s/iter; left time: 8071.1090s
	iters: 2600, epoch: 4 | loss: 0.1021152
	speed: 0.1161s/iter; left time: 8547.9752s
	iters: 2700, epoch: 4 | loss: 0.1003583
	speed: 0.1147s/iter; left time: 8435.3343s
	iters: 2800, epoch: 4 | loss: 0.1050423
	speed: 0.1150s/iter; left time: 8446.1468s
	iters: 2900, epoch: 4 | loss: 0.0937110
	speed: 0.1147s/iter; left time: 8410.0946s
	iters: 3000, epoch: 4 | loss: 0.1102281
	speed: 0.1137s/iter; left time: 8324.9367s
	iters: 3100, epoch: 4 | loss: 0.1013796
	speed: 0.1164s/iter; left time: 8513.4038s
	iters: 3200, epoch: 4 | loss: 0.0967339
	speed: 0.1167s/iter; left time: 8526.7652s
	iters: 3300, epoch: 4 | loss: 0.1165496
	speed: 0.1159s/iter; left time: 8452.3091s
	iters: 3400, epoch: 4 | loss: 0.1168198
	speed: 0.1157s/iter; left time: 8426.7270s
	iters: 3500, epoch: 4 | loss: 0.0818577
	speed: 0.1156s/iter; left time: 8406.8334s
	iters: 3600, epoch: 4 | loss: 0.0995615
	speed: 0.1147s/iter; left time: 8332.7640s
	iters: 3700, epoch: 4 | loss: 0.1094128
	speed: 0.1161s/iter; left time: 8419.6498s
	iters: 3800, epoch: 4 | loss: 0.0862050
	speed: 0.1141s/iter; left time: 8262.7599s
	iters: 3900, epoch: 4 | loss: 0.0992920
	speed: 0.1144s/iter; left time: 8276.9377s
	iters: 4000, epoch: 4 | loss: 0.1077046
	speed: 0.1143s/iter; left time: 8259.7362s
	iters: 4100, epoch: 4 | loss: 0.0952680
	speed: 0.1147s/iter; left time: 8273.2550s
	iters: 4200, epoch: 4 | loss: 0.1204872
	speed: 0.1153s/iter; left time: 8305.8857s
	iters: 4300, epoch: 4 | loss: 0.1002148
	speed: 0.1159s/iter; left time: 8335.4637s
	iters: 4400, epoch: 4 | loss: 0.0981565
	speed: 0.1051s/iter; left time: 7553.5532s
Epoch: 4 cost time: 00h:08m:32.22s
Epoch: 4 | Train Loss: 0.1034841 Vali Loss: 0.1205657 Test Loss: 0.1323852
Validation loss decreased (0.120804 --> 0.120566).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.1074458
	speed: 1.4627s/iter; left time: 104821.1352s
	iters: 200, epoch: 5 | loss: 0.1058937
	speed: 0.1138s/iter; left time: 8143.2592s
	iters: 300, epoch: 5 | loss: 0.1061051
	speed: 0.1151s/iter; left time: 8225.7194s
	iters: 400, epoch: 5 | loss: 0.1060566
	speed: 0.1141s/iter; left time: 8142.5112s
	iters: 500, epoch: 5 | loss: 0.1082695
	speed: 0.1147s/iter; left time: 8172.9705s
	iters: 600, epoch: 5 | loss: 0.0998992
	speed: 0.1160s/iter; left time: 8253.3638s
	iters: 700, epoch: 5 | loss: 0.0936923
	speed: 0.1155s/iter; left time: 8203.9940s
	iters: 800, epoch: 5 | loss: 0.0949209
	speed: 0.1158s/iter; left time: 8217.0675s
	iters: 900, epoch: 5 | loss: 0.1189355
	speed: 0.1003s/iter; left time: 7110.8602s
	iters: 1000, epoch: 5 | loss: 0.1086110
	speed: 0.1004s/iter; left time: 7103.0959s
	iters: 1100, epoch: 5 | loss: 0.1019219
	speed: 0.1086s/iter; left time: 7671.5343s
	iters: 1200, epoch: 5 | loss: 0.0848749
	speed: 0.1152s/iter; left time: 8130.4813s
	iters: 1300, epoch: 5 | loss: 0.0860293
	speed: 0.1161s/iter; left time: 8180.9625s
	iters: 1400, epoch: 5 | loss: 0.0869483
	speed: 0.1174s/iter; left time: 8260.7919s
	iters: 1500, epoch: 5 | loss: 0.0946057
	speed: 0.1175s/iter; left time: 8256.7838s
	iters: 1600, epoch: 5 | loss: 0.0962429
	speed: 0.1163s/iter; left time: 8156.7721s
	iters: 1700, epoch: 5 | loss: 0.0948651
	speed: 0.1148s/iter; left time: 8041.5830s
	iters: 1800, epoch: 5 | loss: 0.0928815
	speed: 0.1178s/iter; left time: 8239.3558s
	iters: 1900, epoch: 5 | loss: 0.1203045
	speed: 0.1154s/iter; left time: 8060.0481s
	iters: 2000, epoch: 5 | loss: 0.0950496
	speed: 0.1155s/iter; left time: 8055.3206s
	iters: 2100, epoch: 5 | loss: 0.1085438
	speed: 0.1163s/iter; left time: 8099.8594s
	iters: 2200, epoch: 5 | loss: 0.0956611
	speed: 0.1155s/iter; left time: 8034.8774s
	iters: 2300, epoch: 5 | loss: 0.1001744
	speed: 0.1175s/iter; left time: 8164.6710s
	iters: 2400, epoch: 5 | loss: 0.0964360
	speed: 0.1170s/iter; left time: 8115.6164s
	iters: 2500, epoch: 5 | loss: 0.0808083
	speed: 0.1161s/iter; left time: 8039.4640s
	iters: 2600, epoch: 5 | loss: 0.1084981
	speed: 0.1153s/iter; left time: 7970.9301s
	iters: 2700, epoch: 5 | loss: 0.0833636
	speed: 0.1156s/iter; left time: 7985.1967s
	iters: 2800, epoch: 5 | loss: 0.0960330
	speed: 0.1157s/iter; left time: 7978.9113s
	iters: 2900, epoch: 5 | loss: 0.1077119
	speed: 0.1151s/iter; left time: 7924.2324s
	iters: 3000, epoch: 5 | loss: 0.1022597
	speed: 0.1148s/iter; left time: 7892.3061s
	iters: 3100, epoch: 5 | loss: 0.0829771
	speed: 0.1138s/iter; left time: 7811.7347s
	iters: 3200, epoch: 5 | loss: 0.1020444
	speed: 0.1139s/iter; left time: 7812.5222s
	iters: 3300, epoch: 5 | loss: 0.0871775
	speed: 0.1146s/iter; left time: 7844.7267s
	iters: 3400, epoch: 5 | loss: 0.0848032
	speed: 0.1055s/iter; left time: 7215.2609s
	iters: 3500, epoch: 5 | loss: 0.1116961
	speed: 0.1134s/iter; left time: 7740.9983s
	iters: 3600, epoch: 5 | loss: 0.0996750
	speed: 0.1150s/iter; left time: 7837.7535s
	iters: 3700, epoch: 5 | loss: 0.0903397
	speed: 0.1167s/iter; left time: 7940.6002s
	iters: 3800, epoch: 5 | loss: 0.0819974
	speed: 0.1170s/iter; left time: 7948.9063s
	iters: 3900, epoch: 5 | loss: 0.1081164
	speed: 0.1148s/iter; left time: 7789.3585s
	iters: 4000, epoch: 5 | loss: 0.0874876
	speed: 0.1128s/iter; left time: 7643.4199s
	iters: 4100, epoch: 5 | loss: 0.1060955
	speed: 0.1146s/iter; left time: 7752.6454s
	iters: 4200, epoch: 5 | loss: 0.1013475
	speed: 0.1142s/iter; left time: 7712.8244s
	iters: 4300, epoch: 5 | loss: 0.0901750
	speed: 0.1146s/iter; left time: 7733.9478s
	iters: 4400, epoch: 5 | loss: 0.0789233
	speed: 0.1155s/iter; left time: 7777.1008s
Epoch: 5 cost time: 00h:08m:33.46s
Epoch: 5 | Train Loss: 0.1003134 Vali Loss: 0.1239620 Test Loss: 0.1393968
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.1080867
	speed: 1.4367s/iter; left time: 96512.7582s
	iters: 200, epoch: 6 | loss: 0.0835378
	speed: 0.0964s/iter; left time: 6466.7118s
	iters: 300, epoch: 6 | loss: 0.0942729
	speed: 0.1157s/iter; left time: 7749.9778s
	iters: 400, epoch: 6 | loss: 0.0856797
	speed: 0.1176s/iter; left time: 7867.5322s
	iters: 500, epoch: 6 | loss: 0.1078456
	speed: 0.1151s/iter; left time: 7684.6486s
	iters: 600, epoch: 6 | loss: 0.0982793
	speed: 0.1155s/iter; left time: 7701.8178s
	iters: 700, epoch: 6 | loss: 0.0959515
	speed: 0.1153s/iter; left time: 7677.6807s
	iters: 800, epoch: 6 | loss: 0.0882172
	speed: 0.1154s/iter; left time: 7670.4021s
	iters: 900, epoch: 6 | loss: 0.1032411
	speed: 0.1157s/iter; left time: 7677.2243s
	iters: 1000, epoch: 6 | loss: 0.0916246
	speed: 0.1144s/iter; left time: 7583.0094s
	iters: 1100, epoch: 6 | loss: 0.1052714
	speed: 0.1147s/iter; left time: 7589.3536s
	iters: 1200, epoch: 6 | loss: 0.1026374
	speed: 0.1131s/iter; left time: 7472.7404s
	iters: 1300, epoch: 6 | loss: 0.0844505
	speed: 0.1157s/iter; left time: 7633.2029s
	iters: 1400, epoch: 6 | loss: 0.1079274
	speed: 0.1151s/iter; left time: 7579.2040s
	iters: 1500, epoch: 6 | loss: 0.1132590
	speed: 0.1150s/iter; left time: 7561.5080s
	iters: 1600, epoch: 6 | loss: 0.0864766
	speed: 0.1174s/iter; left time: 7710.4596s
	iters: 1700, epoch: 6 | loss: 0.0859761
	speed: 0.1161s/iter; left time: 7614.6673s
	iters: 1800, epoch: 6 | loss: 0.0804487
	speed: 0.1173s/iter; left time: 7680.2563s
	iters: 1900, epoch: 6 | loss: 0.1012686
	speed: 0.1132s/iter; left time: 7403.0954s
	iters: 2000, epoch: 6 | loss: 0.1165255
	speed: 0.1149s/iter; left time: 7497.9783s
	iters: 2100, epoch: 6 | loss: 0.1132169
	speed: 0.1162s/iter; left time: 7570.7355s
	iters: 2200, epoch: 6 | loss: 0.0798103
	speed: 0.1155s/iter; left time: 7513.9598s
	iters: 2300, epoch: 6 | loss: 0.0966341
	speed: 0.1159s/iter; left time: 7528.6904s
	iters: 2400, epoch: 6 | loss: 0.1069327
	speed: 0.1148s/iter; left time: 7450.4132s
	iters: 2500, epoch: 6 | loss: 0.0875472
	speed: 0.1152s/iter; left time: 7460.0947s
	iters: 2600, epoch: 6 | loss: 0.1107147
	speed: 0.1157s/iter; left time: 7482.2903s
	iters: 2700, epoch: 6 | loss: 0.1130749
	speed: 0.1159s/iter; left time: 7484.2634s
	iters: 2800, epoch: 6 | loss: 0.0955565
	speed: 0.1170s/iter; left time: 7542.6318s
	iters: 2900, epoch: 6 | loss: 0.1047895
	speed: 0.1165s/iter; left time: 7498.4011s
	iters: 3000, epoch: 6 | loss: 0.1028518
	speed: 0.1150s/iter; left time: 7393.8324s
	iters: 3100, epoch: 6 | loss: 0.0772144
	speed: 0.1179s/iter; left time: 7566.3026s
	iters: 3200, epoch: 6 | loss: 0.1066739
	speed: 0.1046s/iter; left time: 6704.5906s
	iters: 3300, epoch: 6 | loss: 0.1067312
	speed: 0.1149s/iter; left time: 7351.1931s
	iters: 3400, epoch: 6 | loss: 0.0982327
	speed: 0.1157s/iter; left time: 7387.9009s
	iters: 3500, epoch: 6 | loss: 0.1066106
	speed: 0.1128s/iter; left time: 7196.3515s
	iters: 3600, epoch: 6 | loss: 0.1092574
	speed: 0.1153s/iter; left time: 7343.8735s
	iters: 3700, epoch: 6 | loss: 0.1125807
	speed: 0.1151s/iter; left time: 7319.3994s
	iters: 3800, epoch: 6 | loss: 0.0988214
	speed: 0.1149s/iter; left time: 7293.2887s
	iters: 3900, epoch: 6 | loss: 0.0866890
	speed: 0.1149s/iter; left time: 7283.4518s
	iters: 4000, epoch: 6 | loss: 0.0922776
	speed: 0.1156s/iter; left time: 7315.6730s
	iters: 4100, epoch: 6 | loss: 0.1005166
	speed: 0.1143s/iter; left time: 7220.2949s
	iters: 4200, epoch: 6 | loss: 0.0808731
	speed: 0.1142s/iter; left time: 7205.7780s
	iters: 4300, epoch: 6 | loss: 0.0855673
	speed: 0.1162s/iter; left time: 7315.5184s
	iters: 4400, epoch: 6 | loss: 0.1201236
	speed: 0.1161s/iter; left time: 7298.1147s
Epoch: 6 cost time: 00h:08m:34.03s
Epoch: 6 | Train Loss: 0.0972888 Vali Loss: 0.1255503 Test Loss: 0.1417521
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0924498
	speed: 1.4499s/iter; left time: 90895.6183s
	iters: 200, epoch: 7 | loss: 0.1178812
	speed: 0.1154s/iter; left time: 7223.4450s
	iters: 300, epoch: 7 | loss: 0.0915430
	speed: 0.1141s/iter; left time: 7127.9345s
	iters: 400, epoch: 7 | loss: 0.0889588
	speed: 0.1117s/iter; left time: 6967.4425s
	iters: 500, epoch: 7 | loss: 0.0823657
	speed: 0.1092s/iter; left time: 6805.2207s
	iters: 600, epoch: 7 | loss: 0.1029791
	speed: 0.1162s/iter; left time: 7227.7682s
	iters: 700, epoch: 7 | loss: 0.0904151
	speed: 0.1155s/iter; left time: 7168.4667s
	iters: 800, epoch: 7 | loss: 0.1373906
	speed: 0.1147s/iter; left time: 7108.8489s
	iters: 900, epoch: 7 | loss: 0.0987064
	speed: 0.1150s/iter; left time: 7116.0598s
	iters: 1000, epoch: 7 | loss: 0.0955451
	speed: 0.1145s/iter; left time: 7072.5929s
	iters: 1100, epoch: 7 | loss: 0.0812314
	speed: 0.1156s/iter; left time: 7133.7479s
	iters: 1200, epoch: 7 | loss: 0.1071944
	speed: 0.1165s/iter; left time: 7177.3804s
	iters: 1300, epoch: 7 | loss: 0.1112599
	speed: 0.1133s/iter; left time: 6967.3636s
	iters: 1400, epoch: 7 | loss: 0.0859119
	speed: 0.0965s/iter; left time: 5924.9031s
	iters: 1500, epoch: 7 | loss: 0.0963456
	speed: 0.0979s/iter; left time: 6003.2388s
	iters: 1600, epoch: 7 | loss: 0.0927925
	speed: 0.1155s/iter; left time: 7066.2155s
	iters: 1700, epoch: 7 | loss: 0.1041150
	speed: 0.1158s/iter; left time: 7075.9964s
	iters: 1800, epoch: 7 | loss: 0.0919541
	speed: 0.1151s/iter; left time: 7021.1483s
	iters: 1900, epoch: 7 | loss: 0.0924811
	speed: 0.0964s/iter; left time: 5872.0157s
	iters: 2000, epoch: 7 | loss: 0.0916734
	speed: 0.1116s/iter; left time: 6783.0743s
	iters: 2100, epoch: 7 | loss: 0.0851152
	speed: 0.1072s/iter; left time: 6504.1584s
	iters: 2200, epoch: 7 | loss: 0.0713027
	speed: 0.1148s/iter; left time: 6956.5648s
	iters: 2300, epoch: 7 | loss: 0.0756128
	speed: 0.1156s/iter; left time: 6990.4095s
	iters: 2400, epoch: 7 | loss: 0.0799808
	speed: 0.1154s/iter; left time: 6968.6508s
	iters: 2500, epoch: 7 | loss: 0.0849434
	speed: 0.1138s/iter; left time: 6863.1466s
	iters: 2600, epoch: 7 | loss: 0.0794628
	speed: 0.1151s/iter; left time: 6926.4028s
	iters: 2700, epoch: 7 | loss: 0.0931070
	speed: 0.1150s/iter; left time: 6909.9753s
	iters: 2800, epoch: 7 | loss: 0.1051028
	speed: 0.1161s/iter; left time: 6965.8407s
	iters: 2900, epoch: 7 | loss: 0.1156529
	speed: 0.1153s/iter; left time: 6907.9654s
	iters: 3000, epoch: 7 | loss: 0.0889909
	speed: 0.1139s/iter; left time: 6812.9981s
	iters: 3100, epoch: 7 | loss: 0.0863874
	speed: 0.1157s/iter; left time: 6908.3129s
	iters: 3200, epoch: 7 | loss: 0.0882615
	speed: 0.1150s/iter; left time: 6855.6170s
	iters: 3300, epoch: 7 | loss: 0.0995574
	speed: 0.1155s/iter; left time: 6869.2117s
	iters: 3400, epoch: 7 | loss: 0.0981942
	speed: 0.1167s/iter; left time: 6928.9357s
	iters: 3500, epoch: 7 | loss: 0.1015216
	speed: 0.1157s/iter; left time: 6858.1393s
	iters: 3600, epoch: 7 | loss: 0.0947982
	speed: 0.1156s/iter; left time: 6841.4885s
	iters: 3700, epoch: 7 | loss: 0.1041567
	speed: 0.1163s/iter; left time: 6872.8146s
	iters: 3800, epoch: 7 | loss: 0.0952044
	speed: 0.1136s/iter; left time: 6698.5930s
	iters: 3900, epoch: 7 | loss: 0.0995766
	speed: 0.1144s/iter; left time: 6734.4282s
	iters: 4000, epoch: 7 | loss: 0.0990296
	speed: 0.1152s/iter; left time: 6772.2692s
	iters: 4100, epoch: 7 | loss: 0.1016947
	speed: 0.1158s/iter; left time: 6794.1004s
	iters: 4200, epoch: 7 | loss: 0.1040053
	speed: 0.1145s/iter; left time: 6707.6129s
	iters: 4300, epoch: 7 | loss: 0.0988609
	speed: 0.1154s/iter; left time: 6748.8651s
	iters: 4400, epoch: 7 | loss: 0.0869684
	speed: 0.1148s/iter; left time: 6705.4233s
Epoch: 7 cost time: 00h:08m:29.48s
Epoch: 7 | Train Loss: 0.0946513 Vali Loss: 0.1245566 Test Loss: 0.1390361
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0918592
	speed: 1.4296s/iter; left time: 83208.9369s
	iters: 200, epoch: 8 | loss: 0.0835139
	speed: 0.1151s/iter; left time: 6685.1469s
	iters: 300, epoch: 8 | loss: 0.0830909
	speed: 0.1116s/iter; left time: 6470.8564s
	iters: 400, epoch: 8 | loss: 0.0773382
	speed: 0.1140s/iter; left time: 6599.3565s
	iters: 500, epoch: 8 | loss: 0.0999175
	speed: 0.1146s/iter; left time: 6627.2344s
	iters: 600, epoch: 8 | loss: 0.0910697
	speed: 0.1148s/iter; left time: 6624.5143s
	iters: 700, epoch: 8 | loss: 0.0925420
	speed: 0.1106s/iter; left time: 6371.0272s
	iters: 800, epoch: 8 | loss: 0.0842696
	speed: 0.1029s/iter; left time: 5918.4271s
	iters: 900, epoch: 8 | loss: 0.1030085
	speed: 0.1137s/iter; left time: 6527.5101s
	iters: 1000, epoch: 8 | loss: 0.0857712
	speed: 0.1155s/iter; left time: 6619.3193s
	iters: 1100, epoch: 8 | loss: 0.0929789
	speed: 0.1149s/iter; left time: 6575.7293s
	iters: 1200, epoch: 8 | loss: 0.0848481
	speed: 0.1145s/iter; left time: 6537.3795s
	iters: 1300, epoch: 8 | loss: 0.0990944
	speed: 0.1163s/iter; left time: 6631.5699s
	iters: 1400, epoch: 8 | loss: 0.0971840
	speed: 0.1146s/iter; left time: 6518.8950s
	iters: 1500, epoch: 8 | loss: 0.0843722
	speed: 0.1154s/iter; left time: 6553.7758s
	iters: 1600, epoch: 8 | loss: 0.0780336
	speed: 0.1153s/iter; left time: 6537.3273s
	iters: 1700, epoch: 8 | loss: 0.0831821
	speed: 0.1145s/iter; left time: 6479.4710s
	iters: 1800, epoch: 8 | loss: 0.0875997
	speed: 0.1154s/iter; left time: 6523.5061s
	iters: 1900, epoch: 8 | loss: 0.0869278
	speed: 0.1149s/iter; left time: 6479.1692s
	iters: 2000, epoch: 8 | loss: 0.1146180
	speed: 0.1152s/iter; left time: 6487.1368s
	iters: 2100, epoch: 8 | loss: 0.0729130
	speed: 0.1153s/iter; left time: 6479.4428s
	iters: 2200, epoch: 8 | loss: 0.0905604
	speed: 0.1149s/iter; left time: 6443.9184s
	iters: 2300, epoch: 8 | loss: 0.0900590
	speed: 0.1151s/iter; left time: 6444.2595s
	iters: 2400, epoch: 8 | loss: 0.1031543
	speed: 0.1156s/iter; left time: 6460.4231s
	iters: 2500, epoch: 8 | loss: 0.1029483
	speed: 0.1149s/iter; left time: 6414.3145s
	iters: 2600, epoch: 8 | loss: 0.0795364
	speed: 0.1156s/iter; left time: 6440.5292s
	iters: 2700, epoch: 8 | loss: 0.1111625
	speed: 0.1165s/iter; left time: 6477.0374s
	iters: 2800, epoch: 8 | loss: 0.0862386
	speed: 0.1157s/iter; left time: 6422.2466s
	iters: 2900, epoch: 8 | loss: 0.1006412
	speed: 0.1155s/iter; left time: 6401.8719s
	iters: 3000, epoch: 8 | loss: 0.0985600
	speed: 0.1148s/iter; left time: 6347.0249s
	iters: 3100, epoch: 8 | loss: 0.0790469
	speed: 0.1148s/iter; left time: 6335.9774s
	iters: 3200, epoch: 8 | loss: 0.1037440
	speed: 0.1138s/iter; left time: 6272.0306s
	iters: 3300, epoch: 8 | loss: 0.0927985
	speed: 0.1136s/iter; left time: 6250.9363s
	iters: 3400, epoch: 8 | loss: 0.0887386
	speed: 0.1141s/iter; left time: 6266.1795s
	iters: 3500, epoch: 8 | loss: 0.0954302
	speed: 0.1143s/iter; left time: 6263.9716s
	iters: 3600, epoch: 8 | loss: 0.0882672
	speed: 0.1138s/iter; left time: 6224.1715s
	iters: 3700, epoch: 8 | loss: 0.0840252
	speed: 0.1159s/iter; left time: 6328.9136s
	iters: 3800, epoch: 8 | loss: 0.0825819
	speed: 0.1165s/iter; left time: 6349.1319s
	iters: 3900, epoch: 8 | loss: 0.0817300
	speed: 0.1174s/iter; left time: 6386.4907s
	iters: 4000, epoch: 8 | loss: 0.0904208
	speed: 0.1162s/iter; left time: 6312.9097s
	iters: 4100, epoch: 8 | loss: 0.0837452
	speed: 0.1152s/iter; left time: 6244.6775s
	iters: 4200, epoch: 8 | loss: 0.0895528
	speed: 0.1163s/iter; left time: 6290.0829s
	iters: 4300, epoch: 8 | loss: 0.1021302
	speed: 0.1163s/iter; left time: 6279.4962s
	iters: 4400, epoch: 8 | loss: 0.0824312
	speed: 0.1157s/iter; left time: 6235.1450s
Epoch: 8 cost time: 00h:08m:33.60s
Epoch: 8 | Train Loss: 0.0923321 Vali Loss: 0.1244166 Test Loss: 0.1393789
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.0860157
	speed: 1.4456s/iter; left time: 77658.5198s
	iters: 200, epoch: 9 | loss: 0.0827482
	speed: 0.1145s/iter; left time: 6139.4815s
	iters: 300, epoch: 9 | loss: 0.0886363
	speed: 0.1163s/iter; left time: 6222.9455s
	iters: 400, epoch: 9 | loss: 0.1117299
	speed: 0.1188s/iter; left time: 6347.3701s
	iters: 500, epoch: 9 | loss: 0.0810957
	speed: 0.1137s/iter; left time: 6065.0390s
	iters: 600, epoch: 9 | loss: 0.0957763
	speed: 0.1145s/iter; left time: 6093.8977s
	iters: 700, epoch: 9 | loss: 0.1021896
	speed: 0.1150s/iter; left time: 6108.0329s
	iters: 800, epoch: 9 | loss: 0.0900560
	speed: 0.1154s/iter; left time: 6120.9355s
	iters: 900, epoch: 9 | loss: 0.0941611
	speed: 0.1150s/iter; left time: 6084.2274s
	iters: 1000, epoch: 9 | loss: 0.1047803
	speed: 0.1155s/iter; left time: 6101.7430s
	iters: 1100, epoch: 9 | loss: 0.0963440
	speed: 0.1166s/iter; left time: 6148.0789s
	iters: 1200, epoch: 9 | loss: 0.0966223
	speed: 0.1084s/iter; left time: 5703.9226s
	iters: 1300, epoch: 9 | loss: 0.0858766
	speed: 0.1122s/iter; left time: 5892.2736s
	iters: 1400, epoch: 9 | loss: 0.0874112
	speed: 0.1171s/iter; left time: 6136.1091s
	iters: 1500, epoch: 9 | loss: 0.0868891
	speed: 0.1177s/iter; left time: 6159.6734s
	iters: 1600, epoch: 9 | loss: 0.0750172
	speed: 0.1163s/iter; left time: 6073.6480s
	iters: 1700, epoch: 9 | loss: 0.0886351
	speed: 0.1155s/iter; left time: 6018.5100s
	iters: 1800, epoch: 9 | loss: 0.0861389
	speed: 0.1154s/iter; left time: 6003.2281s
	iters: 1900, epoch: 9 | loss: 0.0806216
	speed: 0.1158s/iter; left time: 6012.8285s
	iters: 2000, epoch: 9 | loss: 0.0933814
	speed: 0.1143s/iter; left time: 5922.7467s
	iters: 2100, epoch: 9 | loss: 0.0894557
	speed: 0.1152s/iter; left time: 5956.7469s
	iters: 2200, epoch: 9 | loss: 0.0905567
	speed: 0.1162s/iter; left time: 5997.0745s
	iters: 2300, epoch: 9 | loss: 0.0910580
	speed: 0.1166s/iter; left time: 6008.7362s
	iters: 2400, epoch: 9 | loss: 0.0801017
	speed: 0.1160s/iter; left time: 5966.8233s
	iters: 2500, epoch: 9 | loss: 0.0770919
	speed: 0.1170s/iter; left time: 6003.3777s
	iters: 2600, epoch: 9 | loss: 0.1063322
	speed: 0.1162s/iter; left time: 5949.3625s
	iters: 2700, epoch: 9 | loss: 0.0792379
	speed: 0.1167s/iter; left time: 5964.2041s
	iters: 2800, epoch: 9 | loss: 0.0964480
	speed: 0.1146s/iter; left time: 5848.1760s
	iters: 2900, epoch: 9 | loss: 0.0888367
	speed: 0.1149s/iter; left time: 5849.4877s
	iters: 3000, epoch: 9 | loss: 0.0799860
	speed: 0.1154s/iter; left time: 5862.9364s
	iters: 3100, epoch: 9 | loss: 0.0811218
	speed: 0.1146s/iter; left time: 5811.2544s
	iters: 3200, epoch: 9 | loss: 0.0989336
	speed: 0.1165s/iter; left time: 5896.8224s
	iters: 3300, epoch: 9 | loss: 0.0911095
	speed: 0.1160s/iter; left time: 5862.5736s
	iters: 3400, epoch: 9 | loss: 0.0657498
	speed: 0.1151s/iter; left time: 5802.7048s
	iters: 3500, epoch: 9 | loss: 0.0899863
	speed: 0.1167s/iter; left time: 5871.3044s
	iters: 3600, epoch: 9 | loss: 0.0988450
	speed: 0.1156s/iter; left time: 5807.9330s
	iters: 3700, epoch: 9 | loss: 0.0745410
	speed: 0.1168s/iter; left time: 5854.1877s
	iters: 3800, epoch: 9 | loss: 0.0895517
	speed: 0.1154s/iter; left time: 5770.9914s
	iters: 3900, epoch: 9 | loss: 0.0853783
	speed: 0.1190s/iter; left time: 5941.1843s
	iters: 4000, epoch: 9 | loss: 0.0899109
	speed: 0.1159s/iter; left time: 5771.9665s
	iters: 4100, epoch: 9 | loss: 0.0919613
	speed: 0.1152s/iter; left time: 5728.7361s
	iters: 4200, epoch: 9 | loss: 0.0816684
	speed: 0.1166s/iter; left time: 5787.2196s
	iters: 4300, epoch: 9 | loss: 0.0924804
	speed: 0.1147s/iter; left time: 5679.0589s
	iters: 4400, epoch: 9 | loss: 0.0909822
	speed: 0.1150s/iter; left time: 5684.1695s
Epoch: 9 cost time: 00h:08m:38.94s
Epoch: 9 | Train Loss: 0.0901876 Vali Loss: 0.1248721 Test Loss: 0.1431583
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.039549555629491806, rmse:0.1988707035779953, mae:0.13238517940044403, rse:0.704233705997467
success delete checkpoints
Intermediate time for DE and pred_len 96: 01h:38m:18.51s

=== Starting experiments for pred_len: 168 ===

--- Running model for DE, pred_len=168 ---
train 143165
val 30365
test 30365
[2024-11-02 07:24:55,161] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-02 07:24:56,387] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-02 07:24:56,388] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-02 07:24:56,388] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-02 07:24:56,497] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-02 07:24:56,497] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-02 07:24:57,181] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-02 07:24:57,182] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-02 07:24:57,183] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-02 07:24:57,184] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-02 07:24:57,184] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-02 07:24:57,184] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-02 07:24:57,185] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-02 07:24:57,185] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-02 07:24:57,185] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-02 07:24:57,185] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-02 07:24:57,498] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-02 07:24:57,499] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-02 07:24:57,499] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 74.35 GB, percent = 9.9%
[2024-11-02 07:24:57,616] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-02 07:24:57,617] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 07:24:57,617] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 74.35 GB, percent = 9.9%
[2024-11-02 07:24:57,617] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-02 07:24:57,729] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-02 07:24:57,730] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 07:24:57,730] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 74.35 GB, percent = 9.9%
[2024-11-02 07:24:57,731] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-02 07:24:57,731] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-02 07:24:57,731] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-02 07:24:57,731] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-02 07:24:57,732] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-02 07:24:57,732] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-02 07:24:57,732] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-02 07:24:57,732] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-02 07:24:57,732] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-02 07:24:57,732] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fe52e535310>
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-02 07:24:57,733] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-02 07:24:57,734] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-02 07:24:57,735] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1796879
	speed: 0.1726s/iter; left time: 15419.9925s
	iters: 200, epoch: 1 | loss: 0.1421639
	speed: 0.1283s/iter; left time: 11449.1534s
	iters: 300, epoch: 1 | loss: 0.1639913
	speed: 0.1281s/iter; left time: 11420.8693s
	iters: 400, epoch: 1 | loss: 0.1615290
	speed: 0.1281s/iter; left time: 11406.5486s
	iters: 500, epoch: 1 | loss: 0.1515372
	speed: 0.1288s/iter; left time: 11457.7404s
	iters: 600, epoch: 1 | loss: 0.1479097
	speed: 0.1276s/iter; left time: 11341.7462s
	iters: 700, epoch: 1 | loss: 0.1270908
	speed: 0.1274s/iter; left time: 11312.0453s
	iters: 800, epoch: 1 | loss: 0.1200892
	speed: 0.1268s/iter; left time: 11239.8093s
	iters: 900, epoch: 1 | loss: 0.1140285
	speed: 0.1252s/iter; left time: 11088.1436s
	iters: 1000, epoch: 1 | loss: 0.1321990
	speed: 0.1076s/iter; left time: 9519.3615s
	iters: 1100, epoch: 1 | loss: 0.1220576
	speed: 0.1197s/iter; left time: 10577.6750s
	iters: 1200, epoch: 1 | loss: 0.1186985
	speed: 0.1267s/iter; left time: 11179.6567s
	iters: 1300, epoch: 1 | loss: 0.1086995
	speed: 0.1194s/iter; left time: 10525.2684s
	iters: 1400, epoch: 1 | loss: 0.1446381
	speed: 0.1219s/iter; left time: 10730.7447s
	iters: 1500, epoch: 1 | loss: 0.1293692
	speed: 0.1276s/iter; left time: 11220.7259s
	iters: 1600, epoch: 1 | loss: 0.1335815
	speed: 0.1262s/iter; left time: 11084.1032s
	iters: 1700, epoch: 1 | loss: 0.1137727
	speed: 0.1228s/iter; left time: 10779.0151s
	iters: 1800, epoch: 1 | loss: 0.1187546
	speed: 0.1106s/iter; left time: 9695.9841s
	iters: 1900, epoch: 1 | loss: 0.1147917
	speed: 0.1275s/iter; left time: 11166.8687s
	iters: 2000, epoch: 1 | loss: 0.1335327
	speed: 0.1269s/iter; left time: 11098.9680s
	iters: 2100, epoch: 1 | loss: 0.1156783
	speed: 0.1265s/iter; left time: 11051.8360s
	iters: 2200, epoch: 1 | loss: 0.1262950
	speed: 0.1260s/iter; left time: 10998.5858s
	iters: 2300, epoch: 1 | loss: 0.1381016
	speed: 0.1279s/iter; left time: 11152.1526s
	iters: 2400, epoch: 1 | loss: 0.1440842
	speed: 0.1272s/iter; left time: 11073.5955s
	iters: 2500, epoch: 1 | loss: 0.1314677
	speed: 0.1258s/iter; left time: 10941.4413s
	iters: 2600, epoch: 1 | loss: 0.1136199
	speed: 0.1251s/iter; left time: 10868.1463s
	iters: 2700, epoch: 1 | loss: 0.1499220
	speed: 0.1276s/iter; left time: 11072.2368s
	iters: 2800, epoch: 1 | loss: 0.1278764
	speed: 0.1280s/iter; left time: 11093.0776s
	iters: 2900, epoch: 1 | loss: 0.1151534
	speed: 0.1271s/iter; left time: 11001.7898s
	iters: 3000, epoch: 1 | loss: 0.1235821
	speed: 0.1075s/iter; left time: 9291.7831s
	iters: 3100, epoch: 1 | loss: 0.1166754
	speed: 0.1202s/iter; left time: 10382.4649s
	iters: 3200, epoch: 1 | loss: 0.1334251
	speed: 0.1275s/iter; left time: 10999.5686s
	iters: 3300, epoch: 1 | loss: 0.1084857
	speed: 0.1260s/iter; left time: 10859.4316s
	iters: 3400, epoch: 1 | loss: 0.1111453
	speed: 0.1242s/iter; left time: 10693.0066s
	iters: 3500, epoch: 1 | loss: 0.1186036
	speed: 0.1165s/iter; left time: 10018.6891s
	iters: 3600, epoch: 1 | loss: 0.1027479
	speed: 0.1232s/iter; left time: 10577.1327s
	iters: 3700, epoch: 1 | loss: 0.1280373
	speed: 0.1284s/iter; left time: 11015.6281s
	iters: 3800, epoch: 1 | loss: 0.1071356
	speed: 0.1274s/iter; left time: 10911.9701s
	iters: 3900, epoch: 1 | loss: 0.1510007
	speed: 0.1261s/iter; left time: 10787.3226s
	iters: 4000, epoch: 1 | loss: 0.1181215
	speed: 0.1189s/iter; left time: 10163.3112s
	iters: 4100, epoch: 1 | loss: 0.1273197
	speed: 0.1188s/iter; left time: 10142.5712s
	iters: 4200, epoch: 1 | loss: 0.1286651
	speed: 0.1070s/iter; left time: 9124.9525s
	iters: 4300, epoch: 1 | loss: 0.1168264
	speed: 0.1070s/iter; left time: 9108.0538s
	iters: 4400, epoch: 1 | loss: 0.1208781
	speed: 0.1251s/iter; left time: 10639.2787s
Epoch: 1 cost time: 00h:09m:13.64s
Epoch: 1 | Train Loss: 0.1312128 Vali Loss: 0.1250472 Test Loss: 0.1346043
Validation loss decreased (inf --> 0.125047).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.1518959
	speed: 1.6594s/iter; left time: 140860.2401s
	iters: 200, epoch: 2 | loss: 0.0964266
	speed: 0.1082s/iter; left time: 9171.5763s
	iters: 300, epoch: 2 | loss: 0.1247060
	speed: 0.1168s/iter; left time: 9893.8506s
	iters: 400, epoch: 2 | loss: 0.1089664
	speed: 0.1169s/iter; left time: 9885.9224s
	iters: 500, epoch: 2 | loss: 0.1381617
	speed: 0.1180s/iter; left time: 9972.6544s
	iters: 600, epoch: 2 | loss: 0.1414172
	speed: 0.0988s/iter; left time: 8335.2298s
	iters: 700, epoch: 2 | loss: 0.1288400
	speed: 0.1173s/iter; left time: 9884.6857s
	iters: 800, epoch: 2 | loss: 0.1145916
	speed: 0.1160s/iter; left time: 9764.8300s
	iters: 900, epoch: 2 | loss: 0.1190638
	speed: 0.1128s/iter; left time: 9486.3662s
	iters: 1000, epoch: 2 | loss: 0.1355297
	speed: 0.1170s/iter; left time: 9824.2876s
	iters: 1100, epoch: 2 | loss: 0.1262201
	speed: 0.1157s/iter; left time: 9704.0627s
	iters: 1200, epoch: 2 | loss: 0.1185752
	speed: 0.1148s/iter; left time: 9615.0635s
	iters: 1300, epoch: 2 | loss: 0.1181296
	speed: 0.1173s/iter; left time: 9820.5802s
	iters: 1400, epoch: 2 | loss: 0.1286746
	speed: 0.1173s/iter; left time: 9803.8865s
	iters: 1500, epoch: 2 | loss: 0.1001056
	speed: 0.1164s/iter; left time: 9715.2900s
	iters: 1600, epoch: 2 | loss: 0.1140635
	speed: 0.1154s/iter; left time: 9626.1250s
	iters: 1700, epoch: 2 | loss: 0.1254133
	speed: 0.1170s/iter; left time: 9746.7219s
	iters: 1800, epoch: 2 | loss: 0.0982282
	speed: 0.1166s/iter; left time: 9701.4404s
	iters: 1900, epoch: 2 | loss: 0.1218288
	speed: 0.1164s/iter; left time: 9674.1802s
	iters: 2000, epoch: 2 | loss: 0.1265479
	speed: 0.1169s/iter; left time: 9700.0668s
	iters: 2100, epoch: 2 | loss: 0.1115575
	speed: 0.1167s/iter; left time: 9671.6086s
	iters: 2200, epoch: 2 | loss: 0.1242154
	speed: 0.1161s/iter; left time: 9610.3575s
	iters: 2300, epoch: 2 | loss: 0.1200421
	speed: 0.1162s/iter; left time: 9611.5781s
	iters: 2400, epoch: 2 | loss: 0.1178377
	speed: 0.1158s/iter; left time: 9561.1125s
	iters: 2500, epoch: 2 | loss: 0.1067296
	speed: 0.1165s/iter; left time: 9613.9227s
	iters: 2600, epoch: 2 | loss: 0.1391483
	speed: 0.1156s/iter; left time: 9527.7564s
	iters: 2700, epoch: 2 | loss: 0.0934009
	speed: 0.1165s/iter; left time: 9590.4439s
	iters: 2800, epoch: 2 | loss: 0.1260687
	speed: 0.1175s/iter; left time: 9660.2411s
	iters: 2900, epoch: 2 | loss: 0.1159549
	speed: 0.1160s/iter; left time: 9524.8115s
	iters: 3000, epoch: 2 | loss: 0.1432488
	speed: 0.1148s/iter; left time: 9414.2710s
	iters: 3100, epoch: 2 | loss: 0.1512252
	speed: 0.1157s/iter; left time: 9477.0973s
	iters: 3200, epoch: 2 | loss: 0.1017725
	speed: 0.1154s/iter; left time: 9435.5917s
	iters: 3300, epoch: 2 | loss: 0.1183511
	speed: 0.1151s/iter; left time: 9401.9968s
	iters: 3400, epoch: 2 | loss: 0.1324611
	speed: 0.1160s/iter; left time: 9464.5271s
	iters: 3500, epoch: 2 | loss: 0.1085706
	speed: 0.1165s/iter; left time: 9490.2395s
	iters: 3600, epoch: 2 | loss: 0.1149569
	speed: 0.1154s/iter; left time: 9388.3903s
	iters: 3700, epoch: 2 | loss: 0.1181808
	speed: 0.1161s/iter; left time: 9435.1903s
	iters: 3800, epoch: 2 | loss: 0.0986252
	speed: 0.1152s/iter; left time: 9354.0269s
	iters: 3900, epoch: 2 | loss: 0.1190111
	speed: 0.1155s/iter; left time: 9365.0712s
	iters: 4000, epoch: 2 | loss: 0.1110677
	speed: 0.1172s/iter; left time: 9489.5820s
	iters: 4100, epoch: 2 | loss: 0.1073243
	speed: 0.1152s/iter; left time: 9322.0756s
	iters: 4200, epoch: 2 | loss: 0.1071260
	speed: 0.1155s/iter; left time: 9328.9636s
	iters: 4300, epoch: 2 | loss: 0.1088651
	speed: 0.1162s/iter; left time: 9378.4993s
	iters: 4400, epoch: 2 | loss: 0.1130303
	speed: 0.1143s/iter; left time: 9207.5642s
Epoch: 2 cost time: 00h:08m:37.30s
Epoch: 2 | Train Loss: 0.1167669 Vali Loss: 0.1236090 Test Loss: 0.1348319
Validation loss decreased (0.125047 --> 0.123609).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.1316700
	speed: 1.4469s/iter; left time: 116354.8227s
	iters: 200, epoch: 3 | loss: 0.1039964
	speed: 0.1161s/iter; left time: 9324.3219s
	iters: 300, epoch: 3 | loss: 0.1126300
	speed: 0.1174s/iter; left time: 9418.7683s
	iters: 400, epoch: 3 | loss: 0.1131036
	speed: 0.1179s/iter; left time: 9441.8684s
	iters: 500, epoch: 3 | loss: 0.1220148
	speed: 0.1157s/iter; left time: 9255.2142s
	iters: 600, epoch: 3 | loss: 0.1027394
	speed: 0.1173s/iter; left time: 9375.9775s
	iters: 700, epoch: 3 | loss: 0.0868261
	speed: 0.1194s/iter; left time: 9529.9573s
	iters: 800, epoch: 3 | loss: 0.1178839
	speed: 0.1147s/iter; left time: 9145.8728s
	iters: 900, epoch: 3 | loss: 0.1133176
	speed: 0.1156s/iter; left time: 9206.9141s
	iters: 1000, epoch: 3 | loss: 0.1266209
	speed: 0.1094s/iter; left time: 8700.7189s
	iters: 1100, epoch: 3 | loss: 0.1104170
	speed: 0.1161s/iter; left time: 9216.2815s
	iters: 1200, epoch: 3 | loss: 0.1124218
	speed: 0.1152s/iter; left time: 9139.3929s
	iters: 1300, epoch: 3 | loss: 0.1273887
	speed: 0.1155s/iter; left time: 9149.5361s
	iters: 1400, epoch: 3 | loss: 0.1296332
	speed: 0.1165s/iter; left time: 9215.2192s
	iters: 1500, epoch: 3 | loss: 0.1154967
	speed: 0.1157s/iter; left time: 9144.4551s
	iters: 1600, epoch: 3 | loss: 0.1137325
	speed: 0.1173s/iter; left time: 9260.2878s
	iters: 1700, epoch: 3 | loss: 0.1128048
	speed: 0.1148s/iter; left time: 9045.8627s
	iters: 1800, epoch: 3 | loss: 0.1064127
	speed: 0.1156s/iter; left time: 9103.3748s
	iters: 1900, epoch: 3 | loss: 0.1183627
	speed: 0.1174s/iter; left time: 9226.3196s
	iters: 2000, epoch: 3 | loss: 0.1283379
	speed: 0.1165s/iter; left time: 9150.0116s
	iters: 2100, epoch: 3 | loss: 0.1172018
	speed: 0.1149s/iter; left time: 9009.6223s
	iters: 2200, epoch: 3 | loss: 0.1036158
	speed: 0.1161s/iter; left time: 9093.2266s
	iters: 2300, epoch: 3 | loss: 0.1167738
	speed: 0.1157s/iter; left time: 9051.7936s
	iters: 2400, epoch: 3 | loss: 0.1137663
	speed: 0.1147s/iter; left time: 8962.3061s
	iters: 2500, epoch: 3 | loss: 0.1288111
	speed: 0.1158s/iter; left time: 9031.7794s
	iters: 2600, epoch: 3 | loss: 0.1302198
	speed: 0.1154s/iter; left time: 8988.4020s
	iters: 2700, epoch: 3 | loss: 0.1083783
	speed: 0.1160s/iter; left time: 9029.4703s
	iters: 2800, epoch: 3 | loss: 0.1071675
	speed: 0.1170s/iter; left time: 9095.9111s
	iters: 2900, epoch: 3 | loss: 0.1293719
	speed: 0.1189s/iter; left time: 9224.6144s
	iters: 3000, epoch: 3 | loss: 0.1187557
	speed: 0.1176s/iter; left time: 9118.7357s
	iters: 3100, epoch: 3 | loss: 0.0963806
	speed: 0.1170s/iter; left time: 9058.7001s
	iters: 3200, epoch: 3 | loss: 0.1214169
	speed: 0.1165s/iter; left time: 9006.0014s
	iters: 3300, epoch: 3 | loss: 0.0924854
	speed: 0.1175s/iter; left time: 9071.1331s
	iters: 3400, epoch: 3 | loss: 0.0961636
	speed: 0.1161s/iter; left time: 8950.3778s
	iters: 3500, epoch: 3 | loss: 0.1234925
	speed: 0.1174s/iter; left time: 9038.1773s
	iters: 3600, epoch: 3 | loss: 0.1198209
	speed: 0.1161s/iter; left time: 8926.9670s
	iters: 3700, epoch: 3 | loss: 0.1148769
	speed: 0.1172s/iter; left time: 9003.4303s
	iters: 3800, epoch: 3 | loss: 0.1119351
	speed: 0.1161s/iter; left time: 8903.0600s
	iters: 3900, epoch: 3 | loss: 0.1058953
	speed: 0.1188s/iter; left time: 9104.9184s
	iters: 4000, epoch: 3 | loss: 0.1222074
	speed: 0.1186s/iter; left time: 9075.6974s
	iters: 4100, epoch: 3 | loss: 0.1121319
	speed: 0.1168s/iter; left time: 8924.4999s
	iters: 4200, epoch: 3 | loss: 0.0926314
	speed: 0.1174s/iter; left time: 8958.3413s
	iters: 4300, epoch: 3 | loss: 0.1098126
	speed: 0.1200s/iter; left time: 9144.0661s
	iters: 4400, epoch: 3 | loss: 0.1091134
	speed: 0.1167s/iter; left time: 8879.8932s
Epoch: 3 cost time: 00h:08m:41.53s
Epoch: 3 | Train Loss: 0.1130445 Vali Loss: 0.1239033 Test Loss: 0.1380568
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.1118852
	speed: 1.4256s/iter; left time: 108259.1567s
	iters: 200, epoch: 4 | loss: 0.1162335
	speed: 0.1163s/iter; left time: 8822.3548s
	iters: 300, epoch: 4 | loss: 0.0995601
	speed: 0.1157s/iter; left time: 8766.8859s
	iters: 400, epoch: 4 | loss: 0.1132471
	speed: 0.1149s/iter; left time: 8689.4645s
	iters: 500, epoch: 4 | loss: 0.1124692
	speed: 0.1151s/iter; left time: 8698.4065s
	iters: 600, epoch: 4 | loss: 0.1041030
	speed: 0.1161s/iter; left time: 8756.2922s
	iters: 700, epoch: 4 | loss: 0.1155552
	speed: 0.1168s/iter; left time: 8798.0051s
	iters: 800, epoch: 4 | loss: 0.1389403
	speed: 0.1162s/iter; left time: 8744.8484s
	iters: 900, epoch: 4 | loss: 0.1264938
	speed: 0.1158s/iter; left time: 8700.2851s
	iters: 1000, epoch: 4 | loss: 0.1071267
	speed: 0.1144s/iter; left time: 8584.7234s
	iters: 1100, epoch: 4 | loss: 0.1268844
	speed: 0.1149s/iter; left time: 8608.8614s
	iters: 1200, epoch: 4 | loss: 0.0896029
	speed: 0.1144s/iter; left time: 8563.0431s
	iters: 1300, epoch: 4 | loss: 0.0967841
	speed: 0.1154s/iter; left time: 8622.9499s
	iters: 1400, epoch: 4 | loss: 0.0985883
	speed: 0.1175s/iter; left time: 8771.2091s
	iters: 1500, epoch: 4 | loss: 0.1171656
	speed: 0.1145s/iter; left time: 8532.8823s
	iters: 1600, epoch: 4 | loss: 0.1105181
	speed: 0.1167s/iter; left time: 8686.1936s
	iters: 1700, epoch: 4 | loss: 0.0927968
	speed: 0.1149s/iter; left time: 8541.6680s
	iters: 1800, epoch: 4 | loss: 0.0862853
	speed: 0.1159s/iter; left time: 8601.1435s
	iters: 1900, epoch: 4 | loss: 0.0791367
	speed: 0.1150s/iter; left time: 8528.6747s
	iters: 2000, epoch: 4 | loss: 0.0964180
	speed: 0.1163s/iter; left time: 8614.4506s
	iters: 2100, epoch: 4 | loss: 0.1272053
	speed: 0.1150s/iter; left time: 8501.9548s
	iters: 2200, epoch: 4 | loss: 0.1248995
	speed: 0.1149s/iter; left time: 8486.9660s
	iters: 2300, epoch: 4 | loss: 0.1133061
	speed: 0.1163s/iter; left time: 8573.9003s
	iters: 2400, epoch: 4 | loss: 0.0944415
	speed: 0.1160s/iter; left time: 8540.5527s
	iters: 2500, epoch: 4 | loss: 0.0903405
	speed: 0.1155s/iter; left time: 8493.4931s
	iters: 2600, epoch: 4 | loss: 0.1078932
	speed: 0.1163s/iter; left time: 8539.2716s
	iters: 2700, epoch: 4 | loss: 0.1252578
	speed: 0.1151s/iter; left time: 8442.0480s
	iters: 2800, epoch: 4 | loss: 0.1257209
	speed: 0.1174s/iter; left time: 8597.6128s
	iters: 2900, epoch: 4 | loss: 0.1187883
	speed: 0.1158s/iter; left time: 8467.2677s
	iters: 3000, epoch: 4 | loss: 0.1017213
	speed: 0.1168s/iter; left time: 8532.3864s
	iters: 3100, epoch: 4 | loss: 0.0994309
	speed: 0.1160s/iter; left time: 8462.6957s
	iters: 3200, epoch: 4 | loss: 0.1110925
	speed: 0.1155s/iter; left time: 8415.8009s
	iters: 3300, epoch: 4 | loss: 0.1359264
	speed: 0.1148s/iter; left time: 8349.8342s
	iters: 3400, epoch: 4 | loss: 0.1213765
	speed: 0.1159s/iter; left time: 8416.6438s
	iters: 3500, epoch: 4 | loss: 0.1151622
	speed: 0.1152s/iter; left time: 8353.7053s
	iters: 3600, epoch: 4 | loss: 0.0981746
	speed: 0.1146s/iter; left time: 8305.3391s
	iters: 3700, epoch: 4 | loss: 0.1020091
	speed: 0.1042s/iter; left time: 7537.6323s
	iters: 3800, epoch: 4 | loss: 0.1195145
	speed: 0.1161s/iter; left time: 8384.9630s
	iters: 3900, epoch: 4 | loss: 0.1091338
	speed: 0.1151s/iter; left time: 8306.8368s
	iters: 4000, epoch: 4 | loss: 0.0933681
	speed: 0.1152s/iter; left time: 8301.8588s
	iters: 4100, epoch: 4 | loss: 0.1090270
	speed: 0.1157s/iter; left time: 8321.0657s
	iters: 4200, epoch: 4 | loss: 0.0897193
	speed: 0.1150s/iter; left time: 8265.2853s
	iters: 4300, epoch: 4 | loss: 0.0790287
	speed: 0.1148s/iter; left time: 8238.9496s
	iters: 4400, epoch: 4 | loss: 0.0960602
	speed: 0.1144s/iter; left time: 8193.9019s
Epoch: 4 cost time: 00h:08m:36.70s
Epoch: 4 | Train Loss: 0.1090248 Vali Loss: 0.1242168 Test Loss: 0.1387148
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0958029
	speed: 1.4214s/iter; left time: 101586.7235s
	iters: 200, epoch: 5 | loss: 0.1198548
	speed: 0.1155s/iter; left time: 8242.3255s
	iters: 300, epoch: 5 | loss: 0.0923079
	speed: 0.1149s/iter; left time: 8191.2940s
	iters: 400, epoch: 5 | loss: 0.1043584
	speed: 0.1146s/iter; left time: 8159.1562s
	iters: 500, epoch: 5 | loss: 0.1197232
	speed: 0.1137s/iter; left time: 8078.0820s
	iters: 600, epoch: 5 | loss: 0.0903645
	speed: 0.1134s/iter; left time: 8051.2072s
	iters: 700, epoch: 5 | loss: 0.1047615
	speed: 0.1144s/iter; left time: 8105.6870s
	iters: 800, epoch: 5 | loss: 0.1033622
	speed: 0.1110s/iter; left time: 7853.1599s
	iters: 900, epoch: 5 | loss: 0.1312480
	speed: 0.1155s/iter; left time: 8158.7599s
	iters: 1000, epoch: 5 | loss: 0.1187147
	speed: 0.1154s/iter; left time: 8140.9617s
	iters: 1100, epoch: 5 | loss: 0.1290016
	speed: 0.1163s/iter; left time: 8193.0191s
	iters: 1200, epoch: 5 | loss: 0.1014192
	speed: 0.1159s/iter; left time: 8155.0929s
	iters: 1300, epoch: 5 | loss: 0.1014588
	speed: 0.1163s/iter; left time: 8170.1980s
	iters: 1400, epoch: 5 | loss: 0.1132953
	speed: 0.1156s/iter; left time: 8113.3698s
	iters: 1500, epoch: 5 | loss: 0.0985292
	speed: 0.1143s/iter; left time: 8007.2994s
	iters: 1600, epoch: 5 | loss: 0.0970728
	speed: 0.1145s/iter; left time: 8014.6014s
	iters: 1700, epoch: 5 | loss: 0.1024207
	speed: 0.1070s/iter; left time: 7476.1594s
	iters: 1800, epoch: 5 | loss: 0.1228088
	speed: 0.1087s/iter; left time: 7581.0328s
	iters: 1900, epoch: 5 | loss: 0.1073534
	speed: 0.1151s/iter; left time: 8021.4381s
	iters: 2000, epoch: 5 | loss: 0.1048014
	speed: 0.1160s/iter; left time: 8072.1069s
	iters: 2100, epoch: 5 | loss: 0.0878087
	speed: 0.1153s/iter; left time: 8013.1637s
	iters: 2200, epoch: 5 | loss: 0.0974426
	speed: 0.1161s/iter; left time: 8053.1329s
	iters: 2300, epoch: 5 | loss: 0.1010784
	speed: 0.1145s/iter; left time: 7929.1990s
	iters: 2400, epoch: 5 | loss: 0.1082448
	speed: 0.1146s/iter; left time: 7928.9050s
	iters: 2500, epoch: 5 | loss: 0.1082602
	speed: 0.1134s/iter; left time: 7835.5237s
	iters: 2600, epoch: 5 | loss: 0.1061032
	speed: 0.1153s/iter; left time: 7950.3988s
	iters: 2700, epoch: 5 | loss: 0.1009885
	speed: 0.1140s/iter; left time: 7851.8386s
	iters: 2800, epoch: 5 | loss: 0.1107342
	speed: 0.1146s/iter; left time: 7883.3197s
	iters: 2900, epoch: 5 | loss: 0.1206490
	speed: 0.1171s/iter; left time: 8043.8140s
	iters: 3000, epoch: 5 | loss: 0.0938140
	speed: 0.1124s/iter; left time: 7704.7116s
	iters: 3100, epoch: 5 | loss: 0.0936605
	speed: 0.1148s/iter; left time: 7862.1151s
	iters: 3200, epoch: 5 | loss: 0.1181608
	speed: 0.1047s/iter; left time: 7156.0041s
	iters: 3300, epoch: 5 | loss: 0.1202567
	speed: 0.1147s/iter; left time: 7827.1282s
	iters: 3400, epoch: 5 | loss: 0.1185086
	speed: 0.1150s/iter; left time: 7838.4699s
	iters: 3500, epoch: 5 | loss: 0.1326381
	speed: 0.1151s/iter; left time: 7833.1310s
	iters: 3600, epoch: 5 | loss: 0.1140965
	speed: 0.1146s/iter; left time: 7791.2881s
	iters: 3700, epoch: 5 | loss: 0.0983576
	speed: 0.1150s/iter; left time: 7804.9407s
	iters: 3800, epoch: 5 | loss: 0.1108841
	speed: 0.1152s/iter; left time: 7808.9477s
	iters: 3900, epoch: 5 | loss: 0.1224041
	speed: 0.1163s/iter; left time: 7867.3697s
	iters: 4000, epoch: 5 | loss: 0.1092387
	speed: 0.1151s/iter; left time: 7780.1666s
	iters: 4100, epoch: 5 | loss: 0.1015882
	speed: 0.1163s/iter; left time: 7843.3600s
	iters: 4200, epoch: 5 | loss: 0.1037027
	speed: 0.1158s/iter; left time: 7800.7583s
	iters: 4300, epoch: 5 | loss: 0.1098816
	speed: 0.1146s/iter; left time: 7710.4665s
	iters: 4400, epoch: 5 | loss: 0.0915770
	speed: 0.1142s/iter; left time: 7673.7397s
Epoch: 5 cost time: 00h:08m:32.11s
Epoch: 5 | Train Loss: 0.1055163 Vali Loss: 0.1278250 Test Loss: 0.1433094
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.1131890
	speed: 1.4163s/iter; left time: 94886.3687s
	iters: 200, epoch: 6 | loss: 0.1149606
	speed: 0.1160s/iter; left time: 7760.3897s
	iters: 300, epoch: 6 | loss: 0.0889585
	speed: 0.1161s/iter; left time: 7753.3661s
	iters: 400, epoch: 6 | loss: 0.0879647
	speed: 0.1154s/iter; left time: 7696.7286s
	iters: 500, epoch: 6 | loss: 0.0849967
	speed: 0.1151s/iter; left time: 7663.1614s
	iters: 600, epoch: 6 | loss: 0.1211026
	speed: 0.1138s/iter; left time: 7567.4627s
	iters: 700, epoch: 6 | loss: 0.0971647
	speed: 0.1136s/iter; left time: 7543.8119s
	iters: 800, epoch: 6 | loss: 0.0980629
	speed: 0.1142s/iter; left time: 7572.5191s
	iters: 900, epoch: 6 | loss: 0.0897351
	speed: 0.1146s/iter; left time: 7585.9983s
	iters: 1000, epoch: 6 | loss: 0.0996988
	speed: 0.1164s/iter; left time: 7693.5253s
	iters: 1100, epoch: 6 | loss: 0.0931935
	speed: 0.1145s/iter; left time: 7555.4581s
	iters: 1200, epoch: 6 | loss: 0.0953249
	speed: 0.1157s/iter; left time: 7623.4250s
	iters: 1300, epoch: 6 | loss: 0.0887816
	speed: 0.1163s/iter; left time: 7653.2949s
	iters: 1400, epoch: 6 | loss: 0.0984268
	speed: 0.1158s/iter; left time: 7605.3619s
	iters: 1500, epoch: 6 | loss: 0.1156681
	speed: 0.1156s/iter; left time: 7586.0758s
	iters: 1600, epoch: 6 | loss: 0.0764754
	speed: 0.1149s/iter; left time: 7522.5356s
	iters: 1700, epoch: 6 | loss: 0.0990757
	speed: 0.1140s/iter; left time: 7455.4058s
	iters: 1800, epoch: 6 | loss: 0.0968827
	speed: 0.1153s/iter; left time: 7527.6041s
	iters: 1900, epoch: 6 | loss: 0.1168354
	speed: 0.1150s/iter; left time: 7497.9210s
	iters: 2000, epoch: 6 | loss: 0.1053651
	speed: 0.1154s/iter; left time: 7510.2694s
	iters: 2100, epoch: 6 | loss: 0.0823664
	speed: 0.1151s/iter; left time: 7482.7343s
	iters: 2200, epoch: 6 | loss: 0.1102771
	speed: 0.1166s/iter; left time: 7564.2998s
	iters: 2300, epoch: 6 | loss: 0.1032612
	speed: 0.1114s/iter; left time: 7215.5340s
	iters: 2400, epoch: 6 | loss: 0.1231637
	speed: 0.1150s/iter; left time: 7438.2102s
	iters: 2500, epoch: 6 | loss: 0.0966471
	speed: 0.1137s/iter; left time: 7345.7661s
	iters: 2600, epoch: 6 | loss: 0.1128988
	speed: 0.1171s/iter; left time: 7553.1837s
	iters: 2700, epoch: 6 | loss: 0.0957244
	speed: 0.1161s/iter; left time: 7475.1081s
	iters: 2800, epoch: 6 | loss: 0.1045579
	speed: 0.1151s/iter; left time: 7401.1844s
	iters: 2900, epoch: 6 | loss: 0.1174107
	speed: 0.1138s/iter; left time: 7303.1345s
	iters: 3000, epoch: 6 | loss: 0.1265308
	speed: 0.1158s/iter; left time: 7422.9778s
	iters: 3100, epoch: 6 | loss: 0.1023416
	speed: 0.1147s/iter; left time: 7343.3806s
	iters: 3200, epoch: 6 | loss: 0.1108819
	speed: 0.1153s/iter; left time: 7365.2338s
	iters: 3300, epoch: 6 | loss: 0.1014752
	speed: 0.1148s/iter; left time: 7324.4552s
	iters: 3400, epoch: 6 | loss: 0.1040500
	speed: 0.1133s/iter; left time: 7219.1967s
	iters: 3500, epoch: 6 | loss: 0.0979548
	speed: 0.1142s/iter; left time: 7261.3570s
	iters: 3600, epoch: 6 | loss: 0.0927388
	speed: 0.1071s/iter; left time: 6798.5022s
	iters: 3700, epoch: 6 | loss: 0.1014158
	speed: 0.1152s/iter; left time: 7302.8676s
	iters: 3800, epoch: 6 | loss: 0.0997907
	speed: 0.1131s/iter; left time: 7156.3863s
	iters: 3900, epoch: 6 | loss: 0.0954398
	speed: 0.0966s/iter; left time: 6102.8671s
	iters: 4000, epoch: 6 | loss: 0.1046737
	speed: 0.1147s/iter; left time: 7238.7126s
	iters: 4100, epoch: 6 | loss: 0.1015742
	speed: 0.1153s/iter; left time: 7262.5951s
	iters: 4200, epoch: 6 | loss: 0.1010522
	speed: 0.1145s/iter; left time: 7200.6178s
	iters: 4300, epoch: 6 | loss: 0.1013126
	speed: 0.1159s/iter; left time: 7276.7739s
	iters: 4400, epoch: 6 | loss: 0.1157126
	speed: 0.1157s/iter; left time: 7253.7991s
Epoch: 6 cost time: 00h:08m:32.30s
Epoch: 6 | Train Loss: 0.1023981 Vali Loss: 0.1287997 Test Loss: 0.1417000
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.1052988
	speed: 1.4231s/iter; left time: 88977.0848s
	iters: 200, epoch: 7 | loss: 0.0873112
	speed: 0.1171s/iter; left time: 7307.5313s
	iters: 300, epoch: 7 | loss: 0.1031646
	speed: 0.1071s/iter; left time: 6677.3176s
	iters: 400, epoch: 7 | loss: 0.1072783
	speed: 0.1167s/iter; left time: 7258.5221s
	iters: 500, epoch: 7 | loss: 0.1088210
	speed: 0.1060s/iter; left time: 6582.6507s
	iters: 600, epoch: 7 | loss: 0.1105814
	speed: 0.1077s/iter; left time: 6677.1701s
	iters: 700, epoch: 7 | loss: 0.0999586
	speed: 0.0995s/iter; left time: 6159.3849s
	iters: 800, epoch: 7 | loss: 0.1067762
	speed: 0.1153s/iter; left time: 7125.3779s
	iters: 900, epoch: 7 | loss: 0.1046992
	speed: 0.1151s/iter; left time: 7101.8821s
	iters: 1000, epoch: 7 | loss: 0.0837644
	speed: 0.1085s/iter; left time: 6686.3988s
	iters: 1100, epoch: 7 | loss: 0.0945975
	speed: 0.1145s/iter; left time: 7044.0881s
	iters: 1200, epoch: 7 | loss: 0.0875397
	speed: 0.1145s/iter; left time: 7034.8019s
	iters: 1300, epoch: 7 | loss: 0.1284341
	speed: 0.1173s/iter; left time: 7192.9399s
	iters: 1400, epoch: 7 | loss: 0.0821818
	speed: 0.1187s/iter; left time: 7267.4471s
	iters: 1500, epoch: 7 | loss: 0.0969216
	speed: 0.1176s/iter; left time: 7188.5354s
	iters: 1600, epoch: 7 | loss: 0.1076515
	speed: 0.1160s/iter; left time: 7079.3109s
	iters: 1700, epoch: 7 | loss: 0.0943058
	speed: 0.1171s/iter; left time: 7134.9859s
	iters: 1800, epoch: 7 | loss: 0.1208289
	speed: 0.1172s/iter; left time: 7127.2384s
	iters: 1900, epoch: 7 | loss: 0.0957807
	speed: 0.1169s/iter; left time: 7096.7321s
	iters: 2000, epoch: 7 | loss: 0.0940845
	speed: 0.1146s/iter; left time: 6949.6210s
	iters: 2100, epoch: 7 | loss: 0.0939218
	speed: 0.1155s/iter; left time: 6990.7062s
	iters: 2200, epoch: 7 | loss: 0.0780332
	speed: 0.1163s/iter; left time: 7027.2516s
	iters: 2300, epoch: 7 | loss: 0.0861988
	speed: 0.1159s/iter; left time: 6991.9481s
	iters: 2400, epoch: 7 | loss: 0.0930833
	speed: 0.1150s/iter; left time: 6923.8736s
	iters: 2500, epoch: 7 | loss: 0.0916982
	speed: 0.1156s/iter; left time: 6947.3130s
	iters: 2600, epoch: 7 | loss: 0.0973968
	speed: 0.1179s/iter; left time: 7077.8250s
	iters: 2700, epoch: 7 | loss: 0.0994120
	speed: 0.1165s/iter; left time: 6983.2574s
	iters: 2800, epoch: 7 | loss: 0.1021433
	speed: 0.1164s/iter; left time: 6961.0543s
	iters: 2900, epoch: 7 | loss: 0.1025242
	speed: 0.1172s/iter; left time: 6997.5293s
	iters: 3000, epoch: 7 | loss: 0.0995893
	speed: 0.1159s/iter; left time: 6908.7495s
	iters: 3100, epoch: 7 | loss: 0.1242002
	speed: 0.1170s/iter; left time: 6966.5509s
	iters: 3200, epoch: 7 | loss: 0.0999554
	speed: 0.1165s/iter; left time: 6921.0840s
	iters: 3300, epoch: 7 | loss: 0.0944341
	speed: 0.1157s/iter; left time: 6863.4892s
	iters: 3400, epoch: 7 | loss: 0.0867006
	speed: 0.1150s/iter; left time: 6809.7276s
	iters: 3500, epoch: 7 | loss: 0.0829456
	speed: 0.1168s/iter; left time: 6903.4284s
	iters: 3600, epoch: 7 | loss: 0.1114448
	speed: 0.1150s/iter; left time: 6787.7201s
	iters: 3700, epoch: 7 | loss: 0.1034871
	speed: 0.1146s/iter; left time: 6754.5146s
	iters: 3800, epoch: 7 | loss: 0.0981191
	speed: 0.1161s/iter; left time: 6831.5273s
	iters: 3900, epoch: 7 | loss: 0.0835699
	speed: 0.1052s/iter; left time: 6179.2232s
	iters: 4000, epoch: 7 | loss: 0.0970934
	speed: 0.1162s/iter; left time: 6809.7888s
	iters: 4100, epoch: 7 | loss: 0.0923245
	speed: 0.1168s/iter; left time: 6834.4963s
	iters: 4200, epoch: 7 | loss: 0.0830892
	speed: 0.1151s/iter; left time: 6726.9684s
	iters: 4300, epoch: 7 | loss: 0.1040890
	speed: 0.1190s/iter; left time: 6939.1710s
	iters: 4400, epoch: 7 | loss: 0.1054323
	speed: 0.1153s/iter; left time: 6711.2376s
Epoch: 7 cost time: 00h:08m:33.95s
Epoch: 7 | Train Loss: 0.0994186 Vali Loss: 0.1318476 Test Loss: 0.1430013
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.039509814232587814, rmse:0.19877076148986816, mae:0.13483189046382904, rse:0.7042074799537659
success delete checkpoints
Intermediate time for DE and pred_len 168: 01h:16m:53.78s
Intermediate time for DE: 04h:36m:07.06s

=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
train 143885
val 31085
test 31085
[2024-11-02 08:41:48,941] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-02 08:41:50,078] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-02 08:41:50,079] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-02 08:41:50,079] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-02 08:41:50,183] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-02 08:41:50,184] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-02 08:41:50,862] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-02 08:41:50,864] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-02 08:41:50,864] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-02 08:41:50,866] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-02 08:41:50,866] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-02 08:41:50,866] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-02 08:41:50,866] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-02 08:41:50,866] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-02 08:41:50,866] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-02 08:41:50,866] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-02 08:41:51,181] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-02 08:41:51,182] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-02 08:41:51,182] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 74.42 GB, percent = 9.9%
[2024-11-02 08:41:51,300] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-02 08:41:51,301] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 08:41:51,302] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 74.43 GB, percent = 9.9%
[2024-11-02 08:41:51,302] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-02 08:41:51,417] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-02 08:41:51,418] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 08:41:51,418] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 74.43 GB, percent = 9.9%
[2024-11-02 08:41:51,418] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-02 08:41:51,419] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-02 08:41:51,419] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-02 08:41:51,419] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-02 08:41:51,419] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f66915c2150>
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-02 08:41:51,420] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-02 08:41:51,421] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-02 08:41:51,422] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-02 08:41:51,422] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-02 08:41:51,422] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-02 08:41:51,422] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-02 08:41:51,422] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-02 08:41:51,422] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-02 08:41:51,422] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-02 08:41:51,422] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-02 08:41:51,422] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-02 08:41:51,422] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-02 08:41:51,422] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-02 08:41:51,422] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-02 08:41:51,422] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-02 08:41:51,422] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-02 08:41:51,422] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-02 08:41:51,422] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-02 08:41:51,422] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-02 08:41:51,422] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1480396
	speed: 0.1702s/iter; left time: 15289.4378s
	iters: 200, epoch: 1 | loss: 0.1359396
	speed: 0.1278s/iter; left time: 11462.0213s
	iters: 300, epoch: 1 | loss: 0.1393571
	speed: 0.1281s/iter; left time: 11476.6610s
	iters: 400, epoch: 1 | loss: 0.1382776
	speed: 0.1272s/iter; left time: 11387.7617s
	iters: 500, epoch: 1 | loss: 0.1498523
	speed: 0.1274s/iter; left time: 11392.2678s
	iters: 600, epoch: 1 | loss: 0.1618727
	speed: 0.1290s/iter; left time: 11522.9930s
	iters: 700, epoch: 1 | loss: 0.1502969
	speed: 0.1276s/iter; left time: 11387.8297s
	iters: 800, epoch: 1 | loss: 0.1506559
	speed: 0.1273s/iter; left time: 11347.5577s
	iters: 900, epoch: 1 | loss: 0.1592317
	speed: 0.1270s/iter; left time: 11304.4541s
	iters: 1000, epoch: 1 | loss: 0.1277500
	speed: 0.1272s/iter; left time: 11310.4209s
	iters: 1100, epoch: 1 | loss: 0.1013472
	speed: 0.1176s/iter; left time: 10443.7474s
	iters: 1200, epoch: 1 | loss: 0.0913689
	speed: 0.1276s/iter; left time: 11323.0255s
	iters: 1300, epoch: 1 | loss: 0.1019253
	speed: 0.1258s/iter; left time: 11146.2666s
	iters: 1400, epoch: 1 | loss: 0.0914617
	speed: 0.1257s/iter; left time: 11124.8529s
	iters: 1500, epoch: 1 | loss: 0.1200864
	speed: 0.1285s/iter; left time: 11359.2716s
	iters: 1600, epoch: 1 | loss: 0.0783514
	speed: 0.1288s/iter; left time: 11377.0559s
	iters: 1700, epoch: 1 | loss: 0.0821924
	speed: 0.1281s/iter; left time: 11305.0679s
	iters: 1800, epoch: 1 | loss: 0.1186250
	speed: 0.1286s/iter; left time: 11334.6789s
	iters: 1900, epoch: 1 | loss: 0.1131187
	speed: 0.1290s/iter; left time: 11357.9233s
	iters: 2000, epoch: 1 | loss: 0.0995416
	speed: 0.1274s/iter; left time: 11200.8495s
	iters: 2100, epoch: 1 | loss: 0.1084358
	speed: 0.1263s/iter; left time: 11089.8330s
	iters: 2200, epoch: 1 | loss: 0.1041089
	speed: 0.1216s/iter; left time: 10669.8667s
	iters: 2300, epoch: 1 | loss: 0.0937779
	speed: 0.1275s/iter; left time: 11172.8503s
	iters: 2400, epoch: 1 | loss: 0.0927153
	speed: 0.1284s/iter; left time: 11238.5934s
	iters: 2500, epoch: 1 | loss: 0.0854183
	speed: 0.1272s/iter; left time: 11121.1070s
	iters: 2600, epoch: 1 | loss: 0.0832396
	speed: 0.1262s/iter; left time: 11015.7884s
	iters: 2700, epoch: 1 | loss: 0.0943345
	speed: 0.1268s/iter; left time: 11055.6223s
	iters: 2800, epoch: 1 | loss: 0.0730870
	speed: 0.1261s/iter; left time: 10982.9476s
	iters: 2900, epoch: 1 | loss: 0.0838178
	speed: 0.1265s/iter; left time: 11009.8294s
	iters: 3000, epoch: 1 | loss: 0.1037557
	speed: 0.1275s/iter; left time: 11079.0149s
	iters: 3100, epoch: 1 | loss: 0.0776548
	speed: 0.1297s/iter; left time: 11257.6756s
	iters: 3200, epoch: 1 | loss: 0.0702538
	speed: 0.1265s/iter; left time: 10968.0991s
	iters: 3300, epoch: 1 | loss: 0.0951389
	speed: 0.1280s/iter; left time: 11083.8968s
	iters: 3400, epoch: 1 | loss: 0.0885212
	speed: 0.1282s/iter; left time: 11091.3444s
	iters: 3500, epoch: 1 | loss: 0.0847573
	speed: 0.1266s/iter; left time: 10939.4751s
	iters: 3600, epoch: 1 | loss: 0.0946836
	speed: 0.1263s/iter; left time: 10904.2457s
	iters: 3700, epoch: 1 | loss: 0.0944981
	speed: 0.1257s/iter; left time: 10838.8317s
	iters: 3800, epoch: 1 | loss: 0.0870032
	speed: 0.1268s/iter; left time: 10923.8423s
	iters: 3900, epoch: 1 | loss: 0.0747629
	speed: 0.1260s/iter; left time: 10842.5188s
	iters: 4000, epoch: 1 | loss: 0.0820309
	speed: 0.1268s/iter; left time: 10893.2202s
	iters: 4100, epoch: 1 | loss: 0.0989253
	speed: 0.1259s/iter; left time: 10808.3815s
	iters: 4200, epoch: 1 | loss: 0.1019376
	speed: 0.1260s/iter; left time: 10804.7401s
	iters: 4300, epoch: 1 | loss: 0.0859145
	speed: 0.1267s/iter; left time: 10852.4174s
	iters: 4400, epoch: 1 | loss: 0.0804792
	speed: 0.1259s/iter; left time: 10770.4280s
Epoch: 1 cost time: 00h:09m:31.74s
Epoch: 1 | Train Loss: 0.1045278 Vali Loss: 0.0942639 Test Loss: 0.1063175
Validation loss decreased (inf --> 0.094264).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0567711
	speed: 1.7215s/iter; left time: 146883.7925s
	iters: 200, epoch: 2 | loss: 0.0760146
	speed: 0.1167s/iter; left time: 9949.4148s
	iters: 300, epoch: 2 | loss: 0.0817795
	speed: 0.1183s/iter; left time: 10069.3451s
	iters: 400, epoch: 2 | loss: 0.0809524
	speed: 0.1157s/iter; left time: 9835.0170s
	iters: 500, epoch: 2 | loss: 0.0880101
	speed: 0.1165s/iter; left time: 9893.0284s
	iters: 600, epoch: 2 | loss: 0.0825832
	speed: 0.1120s/iter; left time: 9503.7633s
	iters: 700, epoch: 2 | loss: 0.0830727
	speed: 0.1167s/iter; left time: 9884.5535s
	iters: 800, epoch: 2 | loss: 0.1017664
	speed: 0.1153s/iter; left time: 9755.3256s
	iters: 900, epoch: 2 | loss: 0.0834542
	speed: 0.1169s/iter; left time: 9879.2239s
	iters: 1000, epoch: 2 | loss: 0.1037458
	speed: 0.1166s/iter; left time: 9842.4837s
	iters: 1100, epoch: 2 | loss: 0.0702419
	speed: 0.1164s/iter; left time: 9813.7170s
	iters: 1200, epoch: 2 | loss: 0.0827916
	speed: 0.1170s/iter; left time: 9854.5568s
	iters: 1300, epoch: 2 | loss: 0.0975119
	speed: 0.1160s/iter; left time: 9756.9489s
	iters: 1400, epoch: 2 | loss: 0.0909550
	speed: 0.1171s/iter; left time: 9838.3383s
	iters: 1500, epoch: 2 | loss: 0.0980282
	speed: 0.1166s/iter; left time: 9783.2063s
	iters: 1600, epoch: 2 | loss: 0.0983221
	speed: 0.1169s/iter; left time: 9798.2750s
	iters: 1700, epoch: 2 | loss: 0.0979449
	speed: 0.1001s/iter; left time: 8381.6061s
	iters: 1800, epoch: 2 | loss: 0.0913448
	speed: 0.1151s/iter; left time: 9624.4655s
	iters: 1900, epoch: 2 | loss: 0.1151030
	speed: 0.0990s/iter; left time: 8271.8433s
	iters: 2000, epoch: 2 | loss: 0.0902165
	speed: 0.1029s/iter; left time: 8583.1806s
	iters: 2100, epoch: 2 | loss: 0.1013854
	speed: 0.1163s/iter; left time: 9688.5822s
	iters: 2200, epoch: 2 | loss: 0.0748697
	speed: 0.1169s/iter; left time: 9727.6551s
	iters: 2300, epoch: 2 | loss: 0.0970995
	speed: 0.1162s/iter; left time: 9657.8191s
	iters: 2400, epoch: 2 | loss: 0.0777804
	speed: 0.1171s/iter; left time: 9719.2870s
	iters: 2500, epoch: 2 | loss: 0.0974897
	speed: 0.1164s/iter; left time: 9656.5650s
	iters: 2600, epoch: 2 | loss: 0.0840274
	speed: 0.1173s/iter; left time: 9717.8059s
	iters: 2700, epoch: 2 | loss: 0.0875587
	speed: 0.1163s/iter; left time: 9620.4784s
	iters: 2800, epoch: 2 | loss: 0.0773716
	speed: 0.1161s/iter; left time: 9589.8572s
	iters: 2900, epoch: 2 | loss: 0.0789836
	speed: 0.1172s/iter; left time: 9675.8173s
	iters: 3000, epoch: 2 | loss: 0.1230920
	speed: 0.1069s/iter; left time: 8809.7361s
	iters: 3100, epoch: 2 | loss: 0.0794076
	speed: 0.1163s/iter; left time: 9571.7775s
	iters: 3200, epoch: 2 | loss: 0.0580312
	speed: 0.1174s/iter; left time: 9650.7737s
	iters: 3300, epoch: 2 | loss: 0.0819194
	speed: 0.1185s/iter; left time: 9732.8212s
	iters: 3400, epoch: 2 | loss: 0.0737068
	speed: 0.1160s/iter; left time: 9511.0434s
	iters: 3500, epoch: 2 | loss: 0.0817206
	speed: 0.1171s/iter; left time: 9589.7468s
	iters: 3600, epoch: 2 | loss: 0.0782916
	speed: 0.1154s/iter; left time: 9444.9179s
	iters: 3700, epoch: 2 | loss: 0.0830257
	speed: 0.1156s/iter; left time: 9447.7819s
	iters: 3800, epoch: 2 | loss: 0.0800915
	speed: 0.1166s/iter; left time: 9520.3294s
	iters: 3900, epoch: 2 | loss: 0.0705851
	speed: 0.1166s/iter; left time: 9502.4624s
	iters: 4000, epoch: 2 | loss: 0.0799635
	speed: 0.1160s/iter; left time: 9444.6185s
	iters: 4100, epoch: 2 | loss: 0.0793858
	speed: 0.1160s/iter; left time: 9436.8695s
	iters: 4200, epoch: 2 | loss: 0.0901380
	speed: 0.1153s/iter; left time: 9366.7847s
	iters: 4300, epoch: 2 | loss: 0.0854981
	speed: 0.1141s/iter; left time: 9252.7679s
	iters: 4400, epoch: 2 | loss: 0.0815358
	speed: 0.1147s/iter; left time: 9294.2794s
Epoch: 2 cost time: 00h:08m:37.60s
Epoch: 2 | Train Loss: 0.0874084 Vali Loss: 0.0943880 Test Loss: 0.1067109
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0967912
	speed: 1.4692s/iter; left time: 118749.9835s
	iters: 200, epoch: 3 | loss: 0.0968783
	speed: 0.1170s/iter; left time: 9444.9843s
	iters: 300, epoch: 3 | loss: 0.0831899
	speed: 0.1130s/iter; left time: 9111.0593s
	iters: 400, epoch: 3 | loss: 0.1071719
	speed: 0.1002s/iter; left time: 8069.0538s
	iters: 500, epoch: 3 | loss: 0.0645533
	speed: 0.1145s/iter; left time: 9206.0888s
	iters: 600, epoch: 3 | loss: 0.0737154
	speed: 0.1159s/iter; left time: 9309.3799s
	iters: 700, epoch: 3 | loss: 0.0825373
	speed: 0.1158s/iter; left time: 9287.1080s
	iters: 800, epoch: 3 | loss: 0.0860664
	speed: 0.1155s/iter; left time: 9252.1500s
	iters: 900, epoch: 3 | loss: 0.0782738
	speed: 0.1165s/iter; left time: 9320.8989s
	iters: 1000, epoch: 3 | loss: 0.0969616
	speed: 0.1144s/iter; left time: 9147.7179s
	iters: 1100, epoch: 3 | loss: 0.0766379
	speed: 0.1160s/iter; left time: 9258.4540s
	iters: 1200, epoch: 3 | loss: 0.0865378
	speed: 0.1171s/iter; left time: 9337.5920s
	iters: 1300, epoch: 3 | loss: 0.0749705
	speed: 0.1167s/iter; left time: 9295.8511s
	iters: 1400, epoch: 3 | loss: 0.0806904
	speed: 0.1173s/iter; left time: 9331.6695s
	iters: 1500, epoch: 3 | loss: 0.0795831
	speed: 0.1159s/iter; left time: 9207.2889s
	iters: 1600, epoch: 3 | loss: 0.0955335
	speed: 0.1153s/iter; left time: 9149.3765s
	iters: 1700, epoch: 3 | loss: 0.0916460
	speed: 0.1150s/iter; left time: 9110.7891s
	iters: 1800, epoch: 3 | loss: 0.0964015
	speed: 0.1154s/iter; left time: 9134.8030s
	iters: 1900, epoch: 3 | loss: 0.1013548
	speed: 0.1146s/iter; left time: 9054.9745s
	iters: 2000, epoch: 3 | loss: 0.0869623
	speed: 0.1157s/iter; left time: 9134.3805s
	iters: 2100, epoch: 3 | loss: 0.0899700
	speed: 0.1149s/iter; left time: 9056.0083s
	iters: 2200, epoch: 3 | loss: 0.0860984
	speed: 0.1153s/iter; left time: 9073.9541s
	iters: 2300, epoch: 3 | loss: 0.0814408
	speed: 0.1150s/iter; left time: 9041.0419s
	iters: 2400, epoch: 3 | loss: 0.1089024
	speed: 0.1159s/iter; left time: 9101.7565s
	iters: 2500, epoch: 3 | loss: 0.1013576
	speed: 0.1147s/iter; left time: 8996.6029s
	iters: 2600, epoch: 3 | loss: 0.0859051
	speed: 0.1149s/iter; left time: 9000.8520s
	iters: 2700, epoch: 3 | loss: 0.0691349
	speed: 0.1153s/iter; left time: 9018.4082s
	iters: 2800, epoch: 3 | loss: 0.0932444
	speed: 0.1172s/iter; left time: 9156.3923s
	iters: 2900, epoch: 3 | loss: 0.0649643
	speed: 0.1152s/iter; left time: 8985.3477s
	iters: 3000, epoch: 3 | loss: 0.0698654
	speed: 0.1167s/iter; left time: 9093.0110s
	iters: 3100, epoch: 3 | loss: 0.0942341
	speed: 0.1162s/iter; left time: 9041.9563s
	iters: 3200, epoch: 3 | loss: 0.0748233
	speed: 0.1176s/iter; left time: 9139.4906s
	iters: 3300, epoch: 3 | loss: 0.0922656
	speed: 0.1159s/iter; left time: 8999.5240s
	iters: 3400, epoch: 3 | loss: 0.0845802
	speed: 0.1149s/iter; left time: 8910.5060s
	iters: 3500, epoch: 3 | loss: 0.0817511
	speed: 0.1145s/iter; left time: 8868.7184s
	iters: 3600, epoch: 3 | loss: 0.0760563
	speed: 0.1152s/iter; left time: 8910.8561s
	iters: 3700, epoch: 3 | loss: 0.1167071
	speed: 0.1158s/iter; left time: 8946.6072s
	iters: 3800, epoch: 3 | loss: 0.0771297
	speed: 0.1146s/iter; left time: 8839.2269s
	iters: 3900, epoch: 3 | loss: 0.0774214
	speed: 0.1131s/iter; left time: 8712.6860s
	iters: 4000, epoch: 3 | loss: 0.0806527
	speed: 0.1131s/iter; left time: 8702.0080s
	iters: 4100, epoch: 3 | loss: 0.1028307
	speed: 0.1151s/iter; left time: 8840.9925s
	iters: 4200, epoch: 3 | loss: 0.0881696
	speed: 0.1156s/iter; left time: 8869.1441s
	iters: 4300, epoch: 3 | loss: 0.0913428
	speed: 0.1154s/iter; left time: 8841.1989s
	iters: 4400, epoch: 3 | loss: 0.0837192
	speed: 0.1158s/iter; left time: 8863.6025s
Epoch: 3 cost time: 00h:08m:37.48s
Epoch: 3 | Train Loss: 0.0860432 Vali Loss: 0.0918118 Test Loss: 0.1031213
Validation loss decreased (0.094264 --> 0.091812).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0954896
	speed: 1.5194s/iter; left time: 115982.9203s
	iters: 200, epoch: 4 | loss: 0.0677183
	speed: 0.1153s/iter; left time: 8792.1664s
	iters: 300, epoch: 4 | loss: 0.0733540
	speed: 0.1169s/iter; left time: 8903.2544s
	iters: 400, epoch: 4 | loss: 0.0691343
	speed: 0.1165s/iter; left time: 8855.6881s
	iters: 500, epoch: 4 | loss: 0.0786122
	speed: 0.1158s/iter; left time: 8793.4333s
	iters: 600, epoch: 4 | loss: 0.0799889
	speed: 0.1163s/iter; left time: 8821.3362s
	iters: 700, epoch: 4 | loss: 0.0815678
	speed: 0.1158s/iter; left time: 8770.7137s
	iters: 800, epoch: 4 | loss: 0.0852794
	speed: 0.1154s/iter; left time: 8730.4849s
	iters: 900, epoch: 4 | loss: 0.1063726
	speed: 0.1149s/iter; left time: 8676.3405s
	iters: 1000, epoch: 4 | loss: 0.0828676
	speed: 0.1170s/iter; left time: 8826.2468s
	iters: 1100, epoch: 4 | loss: 0.0860450
	speed: 0.1163s/iter; left time: 8757.7761s
	iters: 1200, epoch: 4 | loss: 0.0846064
	speed: 0.1153s/iter; left time: 8677.9395s
	iters: 1300, epoch: 4 | loss: 0.0873416
	speed: 0.1159s/iter; left time: 8705.9777s
	iters: 1400, epoch: 4 | loss: 0.0829189
	speed: 0.1152s/iter; left time: 8641.3069s
	iters: 1500, epoch: 4 | loss: 0.0689046
	speed: 0.1153s/iter; left time: 8636.5696s
	iters: 1600, epoch: 4 | loss: 0.0895178
	speed: 0.1149s/iter; left time: 8601.3822s
	iters: 1700, epoch: 4 | loss: 0.0820116
	speed: 0.1145s/iter; left time: 8555.8162s
	iters: 1800, epoch: 4 | loss: 0.0827952
	speed: 0.1149s/iter; left time: 8571.8162s
	iters: 1900, epoch: 4 | loss: 0.1026970
	speed: 0.1159s/iter; left time: 8640.1371s
	iters: 2000, epoch: 4 | loss: 0.0725404
	speed: 0.1149s/iter; left time: 8555.6678s
	iters: 2100, epoch: 4 | loss: 0.0876920
	speed: 0.1146s/iter; left time: 8520.9992s
	iters: 2200, epoch: 4 | loss: 0.1142400
	speed: 0.1148s/iter; left time: 8518.8770s
	iters: 2300, epoch: 4 | loss: 0.0928669
	speed: 0.1153s/iter; left time: 8550.5162s
	iters: 2400, epoch: 4 | loss: 0.0878178
	speed: 0.1153s/iter; left time: 8533.5576s
	iters: 2500, epoch: 4 | loss: 0.0795425
	speed: 0.1148s/iter; left time: 8490.3157s
	iters: 2600, epoch: 4 | loss: 0.0796704
	speed: 0.1119s/iter; left time: 8262.1208s
	iters: 2700, epoch: 4 | loss: 0.0722193
	speed: 0.1150s/iter; left time: 8476.6537s
	iters: 2800, epoch: 4 | loss: 0.0852612
	speed: 0.1181s/iter; left time: 8693.9337s
	iters: 2900, epoch: 4 | loss: 0.0933903
	speed: 0.1176s/iter; left time: 8645.8405s
	iters: 3000, epoch: 4 | loss: 0.0701374
	speed: 0.1161s/iter; left time: 8525.0474s
	iters: 3100, epoch: 4 | loss: 0.1009073
	speed: 0.1153s/iter; left time: 8457.3872s
	iters: 3200, epoch: 4 | loss: 0.0881226
	speed: 0.1151s/iter; left time: 8425.6172s
	iters: 3300, epoch: 4 | loss: 0.0878723
	speed: 0.1011s/iter; left time: 7397.3712s
	iters: 3400, epoch: 4 | loss: 0.0679823
	speed: 0.1073s/iter; left time: 7839.9911s
	iters: 3500, epoch: 4 | loss: 0.0670110
	speed: 0.1052s/iter; left time: 7669.5679s
	iters: 3600, epoch: 4 | loss: 0.1087624
	speed: 0.1088s/iter; left time: 7922.7925s
	iters: 3700, epoch: 4 | loss: 0.0843604
	speed: 0.1083s/iter; left time: 7879.6771s
	iters: 3800, epoch: 4 | loss: 0.0843288
	speed: 0.1079s/iter; left time: 7837.0638s
	iters: 3900, epoch: 4 | loss: 0.0889594
	speed: 0.1070s/iter; left time: 7758.4626s
	iters: 4000, epoch: 4 | loss: 0.0709078
	speed: 0.1089s/iter; left time: 7890.1776s
	iters: 4100, epoch: 4 | loss: 0.0785354
	speed: 0.1110s/iter; left time: 8031.3928s
	iters: 4200, epoch: 4 | loss: 0.1014095
	speed: 0.1110s/iter; left time: 8020.0764s
	iters: 4300, epoch: 4 | loss: 0.0900307
	speed: 0.1059s/iter; left time: 7638.1102s
	iters: 4400, epoch: 4 | loss: 0.0985371
	speed: 0.1094s/iter; left time: 7878.0186s
Epoch: 4 cost time: 00h:08m:29.98s
Epoch: 4 | Train Loss: 0.0849872 Vali Loss: 0.0910281 Test Loss: 0.1025915
Validation loss decreased (0.091812 --> 0.091028).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0995415
	speed: 1.5141s/iter; left time: 108771.3119s
	iters: 200, epoch: 5 | loss: 0.0702179
	speed: 0.1096s/iter; left time: 7862.5018s
	iters: 300, epoch: 5 | loss: 0.0926327
	speed: 0.1035s/iter; left time: 7416.0335s
	iters: 400, epoch: 5 | loss: 0.0842026
	speed: 0.1086s/iter; left time: 7768.5542s
	iters: 500, epoch: 5 | loss: 0.0849711
	speed: 0.1071s/iter; left time: 7651.4452s
	iters: 600, epoch: 5 | loss: 0.0858472
	speed: 0.1107s/iter; left time: 7895.3261s
	iters: 700, epoch: 5 | loss: 0.0910149
	speed: 0.1118s/iter; left time: 7961.6434s
	iters: 800, epoch: 5 | loss: 0.0706106
	speed: 0.1095s/iter; left time: 7791.4857s
	iters: 900, epoch: 5 | loss: 0.0857396
	speed: 0.1097s/iter; left time: 7792.7134s
	iters: 1000, epoch: 5 | loss: 0.0778304
	speed: 0.1025s/iter; left time: 7269.0923s
	iters: 1100, epoch: 5 | loss: 0.0807632
	speed: 0.1059s/iter; left time: 7499.7300s
	iters: 1200, epoch: 5 | loss: 0.0821455
	speed: 0.1095s/iter; left time: 7742.7626s
	iters: 1300, epoch: 5 | loss: 0.0761781
	speed: 0.1053s/iter; left time: 7436.2212s
	iters: 1400, epoch: 5 | loss: 0.0864105
	speed: 0.1110s/iter; left time: 7829.8405s
	iters: 1500, epoch: 5 | loss: 0.0635816
	speed: 0.1109s/iter; left time: 7811.5784s
	iters: 1600, epoch: 5 | loss: 0.0796172
	speed: 0.1117s/iter; left time: 7858.3424s
	iters: 1700, epoch: 5 | loss: 0.0873830
	speed: 0.1121s/iter; left time: 7870.4731s
	iters: 1800, epoch: 5 | loss: 0.0776808
	speed: 0.1071s/iter; left time: 7515.0193s
	iters: 1900, epoch: 5 | loss: 0.0813784
	speed: 0.1095s/iter; left time: 7671.4312s
	iters: 2000, epoch: 5 | loss: 0.0825241
	speed: 0.1087s/iter; left time: 7604.7255s
	iters: 2100, epoch: 5 | loss: 0.0971226
	speed: 0.1092s/iter; left time: 7627.9008s
	iters: 2200, epoch: 5 | loss: 0.0820535
	speed: 0.1085s/iter; left time: 7569.6907s
	iters: 2300, epoch: 5 | loss: 0.0787062
	speed: 0.1073s/iter; left time: 7475.1698s
	iters: 2400, epoch: 5 | loss: 0.0813770
	speed: 0.1124s/iter; left time: 7818.5126s
	iters: 2500, epoch: 5 | loss: 0.0734397
	speed: 0.1090s/iter; left time: 7565.5047s
	iters: 2600, epoch: 5 | loss: 0.0811693
	speed: 0.1101s/iter; left time: 7636.4951s
	iters: 2700, epoch: 5 | loss: 0.0857649
	speed: 0.1077s/iter; left time: 7454.6958s
	iters: 2800, epoch: 5 | loss: 0.0826442
	speed: 0.1079s/iter; left time: 7463.0407s
	iters: 2900, epoch: 5 | loss: 0.0696512
	speed: 0.1070s/iter; left time: 7390.0087s
	iters: 3000, epoch: 5 | loss: 0.0978351
	speed: 0.1050s/iter; left time: 7237.8526s
	iters: 3100, epoch: 5 | loss: 0.0703570
	speed: 0.1089s/iter; left time: 7497.3170s
	iters: 3200, epoch: 5 | loss: 0.0664298
	speed: 0.1118s/iter; left time: 7682.5474s
	iters: 3300, epoch: 5 | loss: 0.0841569
	speed: 0.1085s/iter; left time: 7450.3132s
	iters: 3400, epoch: 5 | loss: 0.0866328
	speed: 0.1054s/iter; left time: 7222.5796s
	iters: 3500, epoch: 5 | loss: 0.0752724
	speed: 0.1060s/iter; left time: 7254.2415s
	iters: 3600, epoch: 5 | loss: 0.0709817
	speed: 0.1054s/iter; left time: 7202.8623s
	iters: 3700, epoch: 5 | loss: 0.0909998
	speed: 0.1073s/iter; left time: 7322.7343s
	iters: 3800, epoch: 5 | loss: 0.0780020
	speed: 0.1077s/iter; left time: 7339.9173s
	iters: 3900, epoch: 5 | loss: 0.0807215
	speed: 0.1071s/iter; left time: 7288.4246s
	iters: 4000, epoch: 5 | loss: 0.0772602
	speed: 0.1110s/iter; left time: 7539.4364s
	iters: 4100, epoch: 5 | loss: 0.0780594
	speed: 0.1099s/iter; left time: 7454.3440s
	iters: 4200, epoch: 5 | loss: 0.0868828
	speed: 0.1059s/iter; left time: 7173.3815s
	iters: 4300, epoch: 5 | loss: 0.0795707
	speed: 0.1116s/iter; left time: 7546.4290s
	iters: 4400, epoch: 5 | loss: 0.0779867
	speed: 0.1115s/iter; left time: 7530.1593s
Epoch: 5 cost time: 00h:08m:08.52s
Epoch: 5 | Train Loss: 0.0839314 Vali Loss: 0.0930410 Test Loss: 0.1055147
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0871269
	speed: 1.4553s/iter; left time: 97999.8378s
	iters: 200, epoch: 6 | loss: 0.0924439
	speed: 0.1085s/iter; left time: 7298.9540s
	iters: 300, epoch: 6 | loss: 0.0767670
	speed: 0.1099s/iter; left time: 7376.6712s
	iters: 400, epoch: 6 | loss: 0.0709401
	speed: 0.1076s/iter; left time: 7210.7371s
	iters: 500, epoch: 6 | loss: 0.0788817
	speed: 0.1076s/iter; left time: 7204.0856s
	iters: 600, epoch: 6 | loss: 0.0702770
	speed: 0.1099s/iter; left time: 7345.0702s
	iters: 700, epoch: 6 | loss: 0.0980311
	speed: 0.1111s/iter; left time: 7412.3065s
	iters: 800, epoch: 6 | loss: 0.0822494
	speed: 0.1077s/iter; left time: 7176.0579s
	iters: 900, epoch: 6 | loss: 0.0677797
	speed: 0.1082s/iter; left time: 7200.6620s
	iters: 1000, epoch: 6 | loss: 0.0886040
	speed: 0.1012s/iter; left time: 6723.6221s
	iters: 1100, epoch: 6 | loss: 0.0871691
	speed: 0.1067s/iter; left time: 7080.8750s
	iters: 1200, epoch: 6 | loss: 0.0784157
	speed: 0.1088s/iter; left time: 7206.3865s
	iters: 1300, epoch: 6 | loss: 0.0943549
	speed: 0.1088s/iter; left time: 7197.4000s
	iters: 1400, epoch: 6 | loss: 0.0763766
	speed: 0.1080s/iter; left time: 7134.1124s
	iters: 1500, epoch: 6 | loss: 0.0764059
	speed: 0.1043s/iter; left time: 6874.9185s
	iters: 1600, epoch: 6 | loss: 0.0744005
	speed: 0.1080s/iter; left time: 7110.8253s
	iters: 1700, epoch: 6 | loss: 0.0694969
	speed: 0.1099s/iter; left time: 7228.1110s
	iters: 1800, epoch: 6 | loss: 0.0677618
	speed: 0.1077s/iter; left time: 7071.5907s
	iters: 1900, epoch: 6 | loss: 0.0911437
	speed: 0.1043s/iter; left time: 6835.3529s
	iters: 2000, epoch: 6 | loss: 0.0920015
	speed: 0.1050s/iter; left time: 6870.2395s
	iters: 2100, epoch: 6 | loss: 0.0828903
	speed: 0.1066s/iter; left time: 6963.6891s
	iters: 2200, epoch: 6 | loss: 0.0758576
	speed: 0.1048s/iter; left time: 6838.2962s
	iters: 2300, epoch: 6 | loss: 0.0807692
	speed: 0.1054s/iter; left time: 6865.9606s
	iters: 2400, epoch: 6 | loss: 0.0943944
	speed: 0.1056s/iter; left time: 6869.0119s
	iters: 2500, epoch: 6 | loss: 0.0872433
	speed: 0.1052s/iter; left time: 6829.1467s
	iters: 2600, epoch: 6 | loss: 0.0959055
	speed: 0.1082s/iter; left time: 7018.1775s
	iters: 2700, epoch: 6 | loss: 0.0809270
	speed: 0.1070s/iter; left time: 6927.1189s
	iters: 2800, epoch: 6 | loss: 0.0640975
	speed: 0.1080s/iter; left time: 6980.9291s
	iters: 2900, epoch: 6 | loss: 0.0803174
	speed: 0.1088s/iter; left time: 7021.9549s
	iters: 3000, epoch: 6 | loss: 0.0886245
	speed: 0.1073s/iter; left time: 6912.7752s
	iters: 3100, epoch: 6 | loss: 0.0835691
	speed: 0.1070s/iter; left time: 6882.9547s
	iters: 3200, epoch: 6 | loss: 0.0802454
	speed: 0.1089s/iter; left time: 6996.6120s
	iters: 3300, epoch: 6 | loss: 0.0707895
	speed: 0.1076s/iter; left time: 6898.5370s
	iters: 3400, epoch: 6 | loss: 0.0747536
	speed: 0.1047s/iter; left time: 6703.4284s
	iters: 3500, epoch: 6 | loss: 0.1065182
	speed: 0.1062s/iter; left time: 6789.0110s
	iters: 3600, epoch: 6 | loss: 0.0878420
	speed: 0.1058s/iter; left time: 6755.5887s
	iters: 3700, epoch: 6 | loss: 0.0774292
	speed: 0.1043s/iter; left time: 6645.3086s
	iters: 3800, epoch: 6 | loss: 0.1086048
	speed: 0.1087s/iter; left time: 6918.0962s
	iters: 3900, epoch: 6 | loss: 0.0799593
	speed: 0.1091s/iter; left time: 6931.3972s
	iters: 4000, epoch: 6 | loss: 0.1003824
	speed: 0.1062s/iter; left time: 6738.8975s
	iters: 4100, epoch: 6 | loss: 0.0854066
	speed: 0.1048s/iter; left time: 6637.6901s
	iters: 4200, epoch: 6 | loss: 0.0746893
	speed: 0.1052s/iter; left time: 6651.1235s
	iters: 4300, epoch: 6 | loss: 0.0869709
	speed: 0.1079s/iter; left time: 6813.7169s
	iters: 4400, epoch: 6 | loss: 0.0689251
	speed: 0.1046s/iter; left time: 6591.0560s
Epoch: 6 cost time: 00h:08m:02.06s
Epoch: 6 | Train Loss: 0.0833013 Vali Loss: 0.0915693 Test Loss: 0.1043275
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0705436
	speed: 1.4515s/iter; left time: 91216.5162s
	iters: 200, epoch: 7 | loss: 0.0841148
	speed: 0.1086s/iter; left time: 6812.7254s
	iters: 300, epoch: 7 | loss: 0.0840711
	speed: 0.1057s/iter; left time: 6619.8859s
	iters: 400, epoch: 7 | loss: 0.0786994
	speed: 0.1054s/iter; left time: 6594.1110s
	iters: 500, epoch: 7 | loss: 0.0765329
	speed: 0.1063s/iter; left time: 6635.6774s
	iters: 600, epoch: 7 | loss: 0.0759210
	speed: 0.1084s/iter; left time: 6759.8873s
	iters: 700, epoch: 7 | loss: 0.1062268
	speed: 0.1092s/iter; left time: 6798.3646s
	iters: 800, epoch: 7 | loss: 0.0814249
	speed: 0.1101s/iter; left time: 6839.5005s
	iters: 900, epoch: 7 | loss: 0.0928968
	speed: 0.1049s/iter; left time: 6510.9280s
	iters: 1000, epoch: 7 | loss: 0.0790363
	speed: 0.1078s/iter; left time: 6675.1641s
	iters: 1100, epoch: 7 | loss: 0.0801770
	speed: 0.1099s/iter; left time: 6794.7556s
	iters: 1200, epoch: 7 | loss: 0.0799099
	speed: 0.1067s/iter; left time: 6590.6523s
	iters: 1300, epoch: 7 | loss: 0.1077784
	speed: 0.1079s/iter; left time: 6651.2303s
	iters: 1400, epoch: 7 | loss: 0.0819536
	speed: 0.1085s/iter; left time: 6676.5453s
	iters: 1500, epoch: 7 | loss: 0.0709243
	speed: 0.1049s/iter; left time: 6448.0119s
	iters: 1600, epoch: 7 | loss: 0.0715297
	speed: 0.1081s/iter; left time: 6629.1512s
	iters: 1700, epoch: 7 | loss: 0.0753313
	speed: 0.1093s/iter; left time: 6696.5055s
	iters: 1800, epoch: 7 | loss: 0.0870889
	speed: 0.1102s/iter; left time: 6739.3079s
	iters: 1900, epoch: 7 | loss: 0.0596218
	speed: 0.1086s/iter; left time: 6630.2702s
	iters: 2000, epoch: 7 | loss: 0.0800639
	speed: 0.1082s/iter; left time: 6594.2838s
	iters: 2100, epoch: 7 | loss: 0.0774808
	speed: 0.1067s/iter; left time: 6494.8406s
	iters: 2200, epoch: 7 | loss: 0.0776948
	speed: 0.1076s/iter; left time: 6533.1254s
	iters: 2300, epoch: 7 | loss: 0.0848682
	speed: 0.1044s/iter; left time: 6332.0964s
	iters: 2400, epoch: 7 | loss: 0.0881115
	speed: 0.1089s/iter; left time: 6590.3729s
	iters: 2500, epoch: 7 | loss: 0.0899723
	speed: 0.1089s/iter; left time: 6582.7269s
	iters: 2600, epoch: 7 | loss: 0.0730382
	speed: 0.1074s/iter; left time: 6480.5943s
	iters: 2700, epoch: 7 | loss: 0.0763565
	speed: 0.1096s/iter; left time: 6602.4794s
	iters: 2800, epoch: 7 | loss: 0.0803490
	speed: 0.1102s/iter; left time: 6626.0847s
	iters: 2900, epoch: 7 | loss: 0.0798958
	speed: 0.1091s/iter; left time: 6551.9400s
	iters: 3000, epoch: 7 | loss: 0.0765674
	speed: 0.1093s/iter; left time: 6552.8049s
	iters: 3100, epoch: 7 | loss: 0.0898325
	speed: 0.1057s/iter; left time: 6323.5382s
	iters: 3200, epoch: 7 | loss: 0.0746160
	speed: 0.1094s/iter; left time: 6537.2984s
	iters: 3300, epoch: 7 | loss: 0.0873410
	speed: 0.1089s/iter; left time: 6496.4498s
	iters: 3400, epoch: 7 | loss: 0.0789864
	speed: 0.1070s/iter; left time: 6369.8082s
	iters: 3500, epoch: 7 | loss: 0.0850723
	speed: 0.1098s/iter; left time: 6526.5437s
	iters: 3600, epoch: 7 | loss: 0.0945234
	speed: 0.1103s/iter; left time: 6544.1685s
	iters: 3700, epoch: 7 | loss: 0.0540937
	speed: 0.1099s/iter; left time: 6512.3603s
	iters: 3800, epoch: 7 | loss: 0.0729968
	speed: 0.1103s/iter; left time: 6525.2250s
	iters: 3900, epoch: 7 | loss: 0.0832610
	speed: 0.1082s/iter; left time: 6386.7499s
	iters: 4000, epoch: 7 | loss: 0.0856799
	speed: 0.1079s/iter; left time: 6358.0768s
	iters: 4100, epoch: 7 | loss: 0.0843669
	speed: 0.1104s/iter; left time: 6494.3987s
	iters: 4200, epoch: 7 | loss: 0.0647494
	speed: 0.1095s/iter; left time: 6429.6583s
	iters: 4300, epoch: 7 | loss: 0.0789265
	speed: 0.1112s/iter; left time: 6520.6726s
	iters: 4400, epoch: 7 | loss: 0.0709903
	speed: 0.1100s/iter; left time: 6441.0770s
Epoch: 7 cost time: 00h:08m:08.20s
Epoch: 7 | Train Loss: 0.0827715 Vali Loss: 0.0898659 Test Loss: 0.1015000
Validation loss decreased (0.091028 --> 0.089866).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0960936
	speed: 1.5094s/iter; left time: 88072.7849s
	iters: 200, epoch: 8 | loss: 0.0740620
	speed: 0.1050s/iter; left time: 6115.0676s
	iters: 300, epoch: 8 | loss: 0.0876887
	speed: 0.1119s/iter; left time: 6506.2064s
	iters: 400, epoch: 8 | loss: 0.0733641
	speed: 0.1081s/iter; left time: 6274.1387s
	iters: 500, epoch: 8 | loss: 0.0889757
	speed: 0.1083s/iter; left time: 6274.7419s
	iters: 600, epoch: 8 | loss: 0.1005570
	speed: 0.1054s/iter; left time: 6094.9406s
	iters: 700, epoch: 8 | loss: 0.0792509
	speed: 0.1126s/iter; left time: 6501.3859s
	iters: 800, epoch: 8 | loss: 0.0805020
	speed: 0.1068s/iter; left time: 6159.3257s
	iters: 900, epoch: 8 | loss: 0.0761237
	speed: 0.1087s/iter; left time: 6256.3690s
	iters: 1000, epoch: 8 | loss: 0.0728325
	speed: 0.1060s/iter; left time: 6089.1869s
	iters: 1100, epoch: 8 | loss: 0.0897990
	speed: 0.1098s/iter; left time: 6298.3499s
	iters: 1200, epoch: 8 | loss: 0.0857851
	speed: 0.1108s/iter; left time: 6343.7974s
	iters: 1300, epoch: 8 | loss: 0.0711524
	speed: 0.1111s/iter; left time: 6349.4167s
	iters: 1400, epoch: 8 | loss: 0.0887766
	speed: 0.1093s/iter; left time: 6236.5120s
	iters: 1500, epoch: 8 | loss: 0.0786460
	speed: 0.1121s/iter; left time: 6382.6439s
	iters: 1600, epoch: 8 | loss: 0.0860998
	speed: 0.1038s/iter; left time: 5898.5450s
	iters: 1700, epoch: 8 | loss: 0.0714980
	speed: 0.1081s/iter; left time: 6132.1933s
	iters: 1800, epoch: 8 | loss: 0.0794795
	speed: 0.1082s/iter; left time: 6129.5536s
	iters: 1900, epoch: 8 | loss: 0.0873640
	speed: 0.1103s/iter; left time: 6237.7933s
	iters: 2000, epoch: 8 | loss: 0.0895032
	speed: 0.1057s/iter; left time: 5968.5749s
	iters: 2100, epoch: 8 | loss: 0.0804572
	speed: 0.1046s/iter; left time: 5894.8727s
	iters: 2200, epoch: 8 | loss: 0.0963350
	speed: 0.1049s/iter; left time: 5902.4230s
	iters: 2300, epoch: 8 | loss: 0.0714696
	speed: 0.1079s/iter; left time: 6058.4630s
	iters: 2400, epoch: 8 | loss: 0.0926667
	speed: 0.1065s/iter; left time: 5968.7561s
	iters: 2500, epoch: 8 | loss: 0.0717168
	speed: 0.1051s/iter; left time: 5877.8041s
	iters: 2600, epoch: 8 | loss: 0.0704690
	speed: 0.1094s/iter; left time: 6109.9223s
	iters: 2700, epoch: 8 | loss: 0.1047586
	speed: 0.1073s/iter; left time: 5979.3563s
	iters: 2800, epoch: 8 | loss: 0.0844329
	speed: 0.1085s/iter; left time: 6040.4353s
	iters: 2900, epoch: 8 | loss: 0.0658040
	speed: 0.1090s/iter; left time: 6054.4304s
	iters: 3000, epoch: 8 | loss: 0.0744485
	speed: 0.1104s/iter; left time: 6120.4387s
	iters: 3100, epoch: 8 | loss: 0.0894325
	speed: 0.1031s/iter; left time: 5706.3880s
	iters: 3200, epoch: 8 | loss: 0.0886287
	speed: 0.1051s/iter; left time: 5809.2085s
	iters: 3300, epoch: 8 | loss: 0.0864769
	speed: 0.1071s/iter; left time: 5905.0952s
	iters: 3400, epoch: 8 | loss: 0.0689103
	speed: 0.1057s/iter; left time: 5816.6354s
	iters: 3500, epoch: 8 | loss: 0.0874014
	speed: 0.1106s/iter; left time: 6074.7154s
	iters: 3600, epoch: 8 | loss: 0.0792102
	speed: 0.1088s/iter; left time: 5966.3641s
	iters: 3700, epoch: 8 | loss: 0.0755558
	speed: 0.1102s/iter; left time: 6032.5168s
	iters: 3800, epoch: 8 | loss: 0.0958932
	speed: 0.1094s/iter; left time: 5978.0712s
	iters: 3900, epoch: 8 | loss: 0.0898063
	speed: 0.1048s/iter; left time: 5715.3486s
	iters: 4000, epoch: 8 | loss: 0.0988585
	speed: 0.1072s/iter; left time: 5835.3402s
	iters: 4100, epoch: 8 | loss: 0.0759023
	speed: 0.1122s/iter; left time: 6098.8360s
	iters: 4200, epoch: 8 | loss: 0.0791041
	speed: 0.1084s/iter; left time: 5878.6637s
	iters: 4300, epoch: 8 | loss: 0.0657694
	speed: 0.1105s/iter; left time: 5985.4459s
	iters: 4400, epoch: 8 | loss: 0.0909220
	speed: 0.1087s/iter; left time: 5873.7307s
Epoch: 8 cost time: 00h:08m:06.34s
Epoch: 8 | Train Loss: 0.0823500 Vali Loss: 0.0910530 Test Loss: 0.1034771
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.0831056
	speed: 1.4514s/iter; left time: 78163.0226s
	iters: 200, epoch: 9 | loss: 0.0952516
	speed: 0.1094s/iter; left time: 5881.2074s
	iters: 300, epoch: 9 | loss: 0.0744533
	speed: 0.1068s/iter; left time: 5732.5674s
	iters: 400, epoch: 9 | loss: 0.0850896
	speed: 0.1049s/iter; left time: 5620.3388s
	iters: 500, epoch: 9 | loss: 0.0550304
	speed: 0.1058s/iter; left time: 5652.9427s
	iters: 600, epoch: 9 | loss: 0.0789448
	speed: 0.1081s/iter; left time: 5769.2775s
	iters: 700, epoch: 9 | loss: 0.0687364
	speed: 0.1090s/iter; left time: 5802.5814s
	iters: 800, epoch: 9 | loss: 0.0792406
	speed: 0.1101s/iter; left time: 5850.5956s
	iters: 900, epoch: 9 | loss: 0.0835051
	speed: 0.1086s/iter; left time: 5759.2836s
	iters: 1000, epoch: 9 | loss: 0.0730056
	speed: 0.1064s/iter; left time: 5632.9452s
	iters: 1100, epoch: 9 | loss: 0.0977784
	speed: 0.1065s/iter; left time: 5629.5731s
	iters: 1200, epoch: 9 | loss: 0.0776352
	speed: 0.1103s/iter; left time: 5816.3402s
	iters: 1300, epoch: 9 | loss: 0.0933063
	speed: 0.1051s/iter; left time: 5533.8348s
	iters: 1400, epoch: 9 | loss: 0.0774592
	speed: 0.1051s/iter; left time: 5521.6245s
	iters: 1500, epoch: 9 | loss: 0.0733840
	speed: 0.1095s/iter; left time: 5742.2190s
	iters: 1600, epoch: 9 | loss: 0.0761116
	speed: 0.1027s/iter; left time: 5376.5107s
	iters: 1700, epoch: 9 | loss: 0.0698281
	speed: 0.1076s/iter; left time: 5623.5312s
	iters: 1800, epoch: 9 | loss: 0.0795811
	speed: 0.1061s/iter; left time: 5533.4007s
	iters: 1900, epoch: 9 | loss: 0.0838274
	speed: 0.1069s/iter; left time: 5564.5762s
	iters: 2000, epoch: 9 | loss: 0.0694626
	speed: 0.1096s/iter; left time: 5693.9632s
	iters: 2100, epoch: 9 | loss: 0.0945157
	speed: 0.1065s/iter; left time: 5522.7097s
	iters: 2200, epoch: 9 | loss: 0.0914454
	speed: 0.1068s/iter; left time: 5524.8859s
	iters: 2300, epoch: 9 | loss: 0.0576647
	speed: 0.1093s/iter; left time: 5646.5105s
	iters: 2400, epoch: 9 | loss: 0.0809036
	speed: 0.1080s/iter; left time: 5565.1956s
	iters: 2500, epoch: 9 | loss: 0.0779389
	speed: 0.1088s/iter; left time: 5597.4147s
	iters: 2600, epoch: 9 | loss: 0.0879130
	speed: 0.1061s/iter; left time: 5450.2346s
	iters: 2700, epoch: 9 | loss: 0.0842345
	speed: 0.1090s/iter; left time: 5585.2469s
	iters: 2800, epoch: 9 | loss: 0.0857091
	speed: 0.1087s/iter; left time: 5558.0092s
	iters: 2900, epoch: 9 | loss: 0.0836044
	speed: 0.1111s/iter; left time: 5673.4564s
	iters: 3000, epoch: 9 | loss: 0.0857766
	speed: 0.1081s/iter; left time: 5508.9101s
	iters: 3100, epoch: 9 | loss: 0.0825322
	speed: 0.1088s/iter; left time: 5532.1036s
	iters: 3200, epoch: 9 | loss: 0.0827652
	speed: 0.1090s/iter; left time: 5534.3862s
	iters: 3300, epoch: 9 | loss: 0.0923525
	speed: 0.1109s/iter; left time: 5618.1983s
	iters: 3400, epoch: 9 | loss: 0.0894057
	speed: 0.1113s/iter; left time: 5627.0260s
	iters: 3500, epoch: 9 | loss: 0.0685351
	speed: 0.1100s/iter; left time: 5548.8322s
	iters: 3600, epoch: 9 | loss: 0.1009678
	speed: 0.1096s/iter; left time: 5520.7287s
	iters: 3700, epoch: 9 | loss: 0.0932600
	speed: 0.1091s/iter; left time: 5481.8443s
	iters: 3800, epoch: 9 | loss: 0.0711512
	speed: 0.1107s/iter; left time: 5551.6595s
	iters: 3900, epoch: 9 | loss: 0.0905252
	speed: 0.1082s/iter; left time: 5417.3414s
	iters: 4000, epoch: 9 | loss: 0.0613631
	speed: 0.1092s/iter; left time: 5454.7988s
	iters: 4100, epoch: 9 | loss: 0.1000974
	speed: 0.1096s/iter; left time: 5464.4524s
	iters: 4200, epoch: 9 | loss: 0.0895644
	speed: 0.1071s/iter; left time: 5329.8063s
	iters: 4300, epoch: 9 | loss: 0.0789975
	speed: 0.1096s/iter; left time: 5440.5652s
	iters: 4400, epoch: 9 | loss: 0.0666418
	speed: 0.1103s/iter; left time: 5466.5605s
Epoch: 9 cost time: 00h:08m:07.22s
Epoch: 9 | Train Loss: 0.0819719 Vali Loss: 0.0893733 Test Loss: 0.1011986
Validation loss decreased (0.089866 --> 0.089373).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 10 | loss: 0.0804666
	speed: 1.4863s/iter; left time: 73357.6544s
	iters: 200, epoch: 10 | loss: 0.0945602
	speed: 0.1068s/iter; left time: 5262.0357s
	iters: 300, epoch: 10 | loss: 0.0714898
	speed: 0.1039s/iter; left time: 5109.3410s
	iters: 400, epoch: 10 | loss: 0.0826127
	speed: 0.1065s/iter; left time: 5226.0831s
	iters: 500, epoch: 10 | loss: 0.0924424
	speed: 0.1054s/iter; left time: 5159.2442s
	iters: 600, epoch: 10 | loss: 0.0706647
	speed: 0.1053s/iter; left time: 5144.5541s
	iters: 700, epoch: 10 | loss: 0.0966906
	speed: 0.1032s/iter; left time: 5032.6570s
	iters: 800, epoch: 10 | loss: 0.0714759
	speed: 0.1039s/iter; left time: 5055.0802s
	iters: 900, epoch: 10 | loss: 0.0955755
	speed: 0.1062s/iter; left time: 5158.1279s
	iters: 1000, epoch: 10 | loss: 0.0649942
	speed: 0.1036s/iter; left time: 5019.2797s
	iters: 1100, epoch: 10 | loss: 0.0779102
	speed: 0.1044s/iter; left time: 5050.6463s
	iters: 1200, epoch: 10 | loss: 0.0758527
	speed: 0.1072s/iter; left time: 5174.5789s
	iters: 1300, epoch: 10 | loss: 0.0841196
	speed: 0.1065s/iter; left time: 5130.6830s
	iters: 1400, epoch: 10 | loss: 0.0752938
	speed: 0.1070s/iter; left time: 5141.2591s
	iters: 1500, epoch: 10 | loss: 0.0925946
	speed: 0.1082s/iter; left time: 5189.7579s
	iters: 1600, epoch: 10 | loss: 0.0713231
	speed: 0.1038s/iter; left time: 4969.1839s
	iters: 1700, epoch: 10 | loss: 0.0798582
	speed: 0.1127s/iter; left time: 5380.6080s
	iters: 1800, epoch: 10 | loss: 0.0845527
	speed: 0.1071s/iter; left time: 5105.6895s
	iters: 1900, epoch: 10 | loss: 0.0802245
	speed: 0.1076s/iter; left time: 5118.1966s
	iters: 2000, epoch: 10 | loss: 0.0924563
	speed: 0.1104s/iter; left time: 5237.8094s
	iters: 2100, epoch: 10 | loss: 0.0730820
	speed: 0.1012s/iter; left time: 4792.8719s
	iters: 2200, epoch: 10 | loss: 0.0877439
	speed: 0.1074s/iter; left time: 5076.2265s
	iters: 2300, epoch: 10 | loss: 0.0808664
	speed: 0.1048s/iter; left time: 4940.3052s
	iters: 2400, epoch: 10 | loss: 0.0805754
	speed: 0.1059s/iter; left time: 4983.9050s
	iters: 2500, epoch: 10 | loss: 0.1015715
	speed: 0.1105s/iter; left time: 5190.6395s
	iters: 2600, epoch: 10 | loss: 0.0852922
	speed: 0.1080s/iter; left time: 5059.2391s
	iters: 2700, epoch: 10 | loss: 0.0820987
	speed: 0.1081s/iter; left time: 5054.6425s
	iters: 2800, epoch: 10 | loss: 0.0819424
	speed: 0.1097s/iter; left time: 5116.0070s
	iters: 2900, epoch: 10 | loss: 0.0815215
	speed: 0.1092s/iter; left time: 5083.0218s
	iters: 3000, epoch: 10 | loss: 0.0779925
	speed: 0.1052s/iter; left time: 4888.9427s
	iters: 3100, epoch: 10 | loss: 0.0649120
	speed: 0.1102s/iter; left time: 5108.8914s
	iters: 3200, epoch: 10 | loss: 0.0969833
	speed: 0.1060s/iter; left time: 4901.9683s
	iters: 3300, epoch: 10 | loss: 0.0975729
	speed: 0.1111s/iter; left time: 5128.5113s
	iters: 3400, epoch: 10 | loss: 0.0759113
	speed: 0.1112s/iter; left time: 5121.4709s
	iters: 3500, epoch: 10 | loss: 0.0715975
	speed: 0.1098s/iter; left time: 5048.0698s
	iters: 3600, epoch: 10 | loss: 0.0765458
	speed: 0.1084s/iter; left time: 4972.8561s
	iters: 3700, epoch: 10 | loss: 0.0926370
	speed: 0.1044s/iter; left time: 4778.0693s
	iters: 3800, epoch: 10 | loss: 0.0954896
	speed: 0.1069s/iter; left time: 4880.9876s
	iters: 3900, epoch: 10 | loss: 0.0901705
	speed: 0.1108s/iter; left time: 5048.6446s
	iters: 4000, epoch: 10 | loss: 0.1011319
	speed: 0.1098s/iter; left time: 4990.8753s
	iters: 4100, epoch: 10 | loss: 0.0829659
	speed: 0.1103s/iter; left time: 5002.8850s
	iters: 4200, epoch: 10 | loss: 0.0952567
	speed: 0.1095s/iter; left time: 4953.7826s
	iters: 4300, epoch: 10 | loss: 0.0830213
	speed: 0.1058s/iter; left time: 4779.4080s
	iters: 4400, epoch: 10 | loss: 0.0838863
	speed: 0.1099s/iter; left time: 4949.9624s
Epoch: 10 cost time: 00h:08m:03.38s
Epoch: 10 | Train Loss: 0.0815905 Vali Loss: 0.0900862 Test Loss: 0.1020951
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 11 | loss: 0.0954875
	speed: 1.4550s/iter; left time: 65271.2623s
	iters: 200, epoch: 11 | loss: 0.0963455
	speed: 0.1072s/iter; left time: 4799.7547s
	iters: 300, epoch: 11 | loss: 0.0792705
	speed: 0.1024s/iter; left time: 4574.7534s
	iters: 400, epoch: 11 | loss: 0.0801558
	speed: 0.1040s/iter; left time: 4635.7560s
	iters: 500, epoch: 11 | loss: 0.1015538
	speed: 0.1042s/iter; left time: 4634.8272s
	iters: 600, epoch: 11 | loss: 0.0732061
	speed: 0.1071s/iter; left time: 4751.7992s
	iters: 700, epoch: 11 | loss: 0.0891110
	speed: 0.1045s/iter; left time: 4625.1676s
	iters: 800, epoch: 11 | loss: 0.0999442
	speed: 0.1068s/iter; left time: 4717.5128s
	iters: 900, epoch: 11 | loss: 0.0800853
	speed: 0.1101s/iter; left time: 4852.0515s
	iters: 1000, epoch: 11 | loss: 0.0720467
	speed: 0.1090s/iter; left time: 4793.5842s
	iters: 1100, epoch: 11 | loss: 0.0852719
	speed: 0.1118s/iter; left time: 4905.7622s
	iters: 1200, epoch: 11 | loss: 0.0710463
	speed: 0.1097s/iter; left time: 4799.9479s
	iters: 1300, epoch: 11 | loss: 0.0742209
	speed: 0.1043s/iter; left time: 4554.0590s
	iters: 1400, epoch: 11 | loss: 0.0696262
	speed: 0.1074s/iter; left time: 4679.7211s
	iters: 1500, epoch: 11 | loss: 0.0862678
	speed: 0.1109s/iter; left time: 4818.6020s
	iters: 1600, epoch: 11 | loss: 0.0709689
	speed: 0.1081s/iter; left time: 4687.5179s
	iters: 1700, epoch: 11 | loss: 0.1065298
	speed: 0.1079s/iter; left time: 4665.8927s
	iters: 1800, epoch: 11 | loss: 0.0639064
	speed: 0.1081s/iter; left time: 4666.2391s
	iters: 1900, epoch: 11 | loss: 0.0827991
	speed: 0.1073s/iter; left time: 4620.0134s
	iters: 2000, epoch: 11 | loss: 0.0793500
	speed: 0.1103s/iter; left time: 4736.9666s
	iters: 2100, epoch: 11 | loss: 0.0814809
	speed: 0.1079s/iter; left time: 4623.5706s
	iters: 2200, epoch: 11 | loss: 0.0918499
	speed: 0.1014s/iter; left time: 4335.5316s
	iters: 2300, epoch: 11 | loss: 0.0911202
	speed: 0.1064s/iter; left time: 4538.3178s
	iters: 2400, epoch: 11 | loss: 0.0762489
	speed: 0.1056s/iter; left time: 4493.1566s
	iters: 2500, epoch: 11 | loss: 0.0705035
	speed: 0.1079s/iter; left time: 4580.0884s
	iters: 2600, epoch: 11 | loss: 0.0713519
	speed: 0.1070s/iter; left time: 4533.2017s
	iters: 2700, epoch: 11 | loss: 0.0821046
	speed: 0.1100s/iter; left time: 4648.8504s
	iters: 2800, epoch: 11 | loss: 0.0885580
	speed: 0.1076s/iter; left time: 4538.2544s
	iters: 2900, epoch: 11 | loss: 0.1035070
	speed: 0.1077s/iter; left time: 4528.9081s
	iters: 3000, epoch: 11 | loss: 0.0753226
	speed: 0.1110s/iter; left time: 4658.2426s
	iters: 3100, epoch: 11 | loss: 0.0714463
	speed: 0.1099s/iter; left time: 4602.4249s
	iters: 3200, epoch: 11 | loss: 0.0673974
	speed: 0.1101s/iter; left time: 4595.9124s
	iters: 3300, epoch: 11 | loss: 0.0771680
	speed: 0.1084s/iter; left time: 4517.1873s
	iters: 3400, epoch: 11 | loss: 0.1020880
	speed: 0.1084s/iter; left time: 4504.3102s
	iters: 3500, epoch: 11 | loss: 0.0695742
	speed: 0.1058s/iter; left time: 4386.2004s
	iters: 3600, epoch: 11 | loss: 0.0783400
	speed: 0.1074s/iter; left time: 4440.7268s
	iters: 3700, epoch: 11 | loss: 0.0872828
	speed: 0.1115s/iter; left time: 4599.9908s
	iters: 3800, epoch: 11 | loss: 0.1151122
	speed: 0.1067s/iter; left time: 4391.6117s
	iters: 3900, epoch: 11 | loss: 0.0821990
	speed: 0.1072s/iter; left time: 4402.9774s
	iters: 4000, epoch: 11 | loss: 0.0874506
	speed: 0.1060s/iter; left time: 4343.0573s
	iters: 4100, epoch: 11 | loss: 0.0895397
	speed: 0.1070s/iter; left time: 4370.8742s
	iters: 4200, epoch: 11 | loss: 0.0791727
	speed: 0.1031s/iter; left time: 4203.4028s
	iters: 4300, epoch: 11 | loss: 0.0826887
	speed: 0.1092s/iter; left time: 4438.7178s
	iters: 4400, epoch: 11 | loss: 0.0772736
	speed: 0.1077s/iter; left time: 4369.1912s
Epoch: 11 cost time: 00h:08m:04.10s
Epoch: 11 | Train Loss: 0.0812005 Vali Loss: 0.0898660 Test Loss: 0.1020890
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 12 | loss: 0.0749976
	speed: 1.4556s/iter; left time: 58756.9022s
	iters: 200, epoch: 12 | loss: 0.0952725
	speed: 0.1065s/iter; left time: 4289.6273s
	iters: 300, epoch: 12 | loss: 0.0830348
	speed: 0.1096s/iter; left time: 4400.5693s
	iters: 400, epoch: 12 | loss: 0.0752531
	speed: 0.1069s/iter; left time: 4280.9562s
	iters: 500, epoch: 12 | loss: 0.0754286
	speed: 0.1077s/iter; left time: 4304.1247s
	iters: 600, epoch: 12 | loss: 0.0688584
	speed: 0.1023s/iter; left time: 4079.0040s
	iters: 700, epoch: 12 | loss: 0.0959318
	speed: 0.1121s/iter; left time: 4458.9278s
	iters: 800, epoch: 12 | loss: 0.0900387
	speed: 0.1073s/iter; left time: 4256.0677s
	iters: 900, epoch: 12 | loss: 0.0738986
	speed: 0.1089s/iter; left time: 4308.1859s
	iters: 1000, epoch: 12 | loss: 0.0676233
	speed: 0.1106s/iter; left time: 4365.5835s
	iters: 1100, epoch: 12 | loss: 0.0989304
	speed: 0.1078s/iter; left time: 4244.1168s
	iters: 1200, epoch: 12 | loss: 0.0711347
	speed: 0.1088s/iter; left time: 4271.1816s
	iters: 1300, epoch: 12 | loss: 0.0813206
	speed: 0.1084s/iter; left time: 4243.7253s
	iters: 1400, epoch: 12 | loss: 0.0788712
	speed: 0.1089s/iter; left time: 4254.6615s
	iters: 1500, epoch: 12 | loss: 0.0956492
	speed: 0.1081s/iter; left time: 4213.0126s
	iters: 1600, epoch: 12 | loss: 0.0699590
	speed: 0.1080s/iter; left time: 4196.8728s
	iters: 1700, epoch: 12 | loss: 0.0868768
	speed: 0.1063s/iter; left time: 4120.3310s
	iters: 1800, epoch: 12 | loss: 0.0729411
	speed: 0.1082s/iter; left time: 4181.6406s
	iters: 1900, epoch: 12 | loss: 0.0975851
	speed: 0.1111s/iter; left time: 4283.0566s
	iters: 2000, epoch: 12 | loss: 0.0993183
	speed: 0.1085s/iter; left time: 4171.9905s
	iters: 2100, epoch: 12 | loss: 0.0732370
	speed: 0.1108s/iter; left time: 4251.6781s
	iters: 2200, epoch: 12 | loss: 0.0761602
	speed: 0.1122s/iter; left time: 4293.5015s
	iters: 2300, epoch: 12 | loss: 0.0807065
	speed: 0.1080s/iter; left time: 4121.3202s
	iters: 2400, epoch: 12 | loss: 0.0800232
	speed: 0.1035s/iter; left time: 3939.6190s
	iters: 2500, epoch: 12 | loss: 0.0855232
	speed: 0.1056s/iter; left time: 4009.5346s
	iters: 2600, epoch: 12 | loss: 0.0662207
	speed: 0.1056s/iter; left time: 3997.0229s
	iters: 2700, epoch: 12 | loss: 0.0743456
	speed: 0.1110s/iter; left time: 4192.5218s
	iters: 2800, epoch: 12 | loss: 0.0744488
	speed: 0.1060s/iter; left time: 3993.9229s
	iters: 2900, epoch: 12 | loss: 0.0875774
	speed: 0.1047s/iter; left time: 3933.6907s
	iters: 3000, epoch: 12 | loss: 0.0959495
	speed: 0.1060s/iter; left time: 3971.4837s
	iters: 3100, epoch: 12 | loss: 0.0766992
	speed: 0.1080s/iter; left time: 4036.6462s
	iters: 3200, epoch: 12 | loss: 0.1069204
	speed: 0.1120s/iter; left time: 4174.6158s
	iters: 3300, epoch: 12 | loss: 0.0903072
	speed: 0.1115s/iter; left time: 4142.5623s
	iters: 3400, epoch: 12 | loss: 0.0947618
	speed: 0.1073s/iter; left time: 3978.7131s
	iters: 3500, epoch: 12 | loss: 0.0750581
	speed: 0.1036s/iter; left time: 3831.4114s
	iters: 3600, epoch: 12 | loss: 0.0677229
	speed: 0.1084s/iter; left time: 3997.1009s
	iters: 3700, epoch: 12 | loss: 0.0825931
	speed: 0.1081s/iter; left time: 3973.8821s
	iters: 3800, epoch: 12 | loss: 0.0663846
	speed: 0.1060s/iter; left time: 3884.6832s
	iters: 3900, epoch: 12 | loss: 0.0917371
	speed: 0.1075s/iter; left time: 3931.7501s
	iters: 4000, epoch: 12 | loss: 0.0844175
	speed: 0.1066s/iter; left time: 3887.4367s
	iters: 4100, epoch: 12 | loss: 0.0886744
	speed: 0.1089s/iter; left time: 3958.6021s
	iters: 4200, epoch: 12 | loss: 0.0929067
	speed: 0.1079s/iter; left time: 3912.8887s
	iters: 4300, epoch: 12 | loss: 0.0852121
	speed: 0.1067s/iter; left time: 3860.3138s
	iters: 4400, epoch: 12 | loss: 0.0680903
	speed: 0.1112s/iter; left time: 4011.7576s
Epoch: 12 cost time: 00h:08m:05.89s
Epoch: 12 | Train Loss: 0.0808781 Vali Loss: 0.0895198 Test Loss: 0.1023670
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 13 | loss: 0.0941976
	speed: 1.4546s/iter; left time: 52174.8459s
	iters: 200, epoch: 13 | loss: 0.0721684
	speed: 0.1104s/iter; left time: 3947.4954s
	iters: 300, epoch: 13 | loss: 0.0847256
	speed: 0.1083s/iter; left time: 3864.1808s
	iters: 400, epoch: 13 | loss: 0.1075728
	speed: 0.1071s/iter; left time: 3810.8300s
	iters: 500, epoch: 13 | loss: 0.0736173
	speed: 0.1069s/iter; left time: 3793.3650s
	iters: 600, epoch: 13 | loss: 0.0811842
	speed: 0.1108s/iter; left time: 3918.6544s
	iters: 700, epoch: 13 | loss: 0.0647019
	speed: 0.1064s/iter; left time: 3753.0734s
	iters: 800, epoch: 13 | loss: 0.1009579
	speed: 0.1078s/iter; left time: 3790.5590s
	iters: 900, epoch: 13 | loss: 0.0781825
	speed: 0.1050s/iter; left time: 3682.7212s
	iters: 1000, epoch: 13 | loss: 0.0830416
	speed: 0.1079s/iter; left time: 3774.3421s
	iters: 1100, epoch: 13 | loss: 0.0865278
	speed: 0.1098s/iter; left time: 3828.0344s
	iters: 1200, epoch: 13 | loss: 0.0713144
	speed: 0.1072s/iter; left time: 3725.7387s
	iters: 1300, epoch: 13 | loss: 0.0747054
	speed: 0.1075s/iter; left time: 3726.8043s
	iters: 1400, epoch: 13 | loss: 0.0833910
	speed: 0.1099s/iter; left time: 3798.9485s
	iters: 1500, epoch: 13 | loss: 0.0931288
	speed: 0.1079s/iter; left time: 3718.0445s
	iters: 1600, epoch: 13 | loss: 0.0980143
	speed: 0.1069s/iter; left time: 3675.7590s
	iters: 1700, epoch: 13 | loss: 0.0957459
	speed: 0.1097s/iter; left time: 3758.7045s
	iters: 1800, epoch: 13 | loss: 0.0775483
	speed: 0.1064s/iter; left time: 3634.4467s
	iters: 1900, epoch: 13 | loss: 0.0813203
	speed: 0.1075s/iter; left time: 3663.9863s
	iters: 2000, epoch: 13 | loss: 0.0666705
	speed: 0.1049s/iter; left time: 3562.7860s
	iters: 2100, epoch: 13 | loss: 0.0789099
	speed: 0.1056s/iter; left time: 3577.9141s
	iters: 2200, epoch: 13 | loss: 0.0800629
	speed: 0.1114s/iter; left time: 3760.1997s
	iters: 2300, epoch: 13 | loss: 0.0889463
	speed: 0.1077s/iter; left time: 3625.9342s
	iters: 2400, epoch: 13 | loss: 0.0802381
	speed: 0.1075s/iter; left time: 3609.9553s
	iters: 2500, epoch: 13 | loss: 0.0825546
	speed: 0.1083s/iter; left time: 3625.2111s
	iters: 2600, epoch: 13 | loss: 0.0956851
	speed: 0.1044s/iter; left time: 3485.0140s
	iters: 2700, epoch: 13 | loss: 0.0856287
	speed: 0.1031s/iter; left time: 3429.1250s
	iters: 2800, epoch: 13 | loss: 0.1151457
	speed: 0.1070s/iter; left time: 3549.4356s
	iters: 2900, epoch: 13 | loss: 0.0953493
	speed: 0.1076s/iter; left time: 3558.8930s
	iters: 3000, epoch: 13 | loss: 0.0769377
	speed: 0.1126s/iter; left time: 3712.9364s
	iters: 3100, epoch: 13 | loss: 0.0727554
	speed: 0.1106s/iter; left time: 3635.8976s
	iters: 3200, epoch: 13 | loss: 0.0860205
	speed: 0.1076s/iter; left time: 3526.6133s
	iters: 3300, epoch: 13 | loss: 0.0888060
	speed: 0.1038s/iter; left time: 3389.9225s
	iters: 3400, epoch: 13 | loss: 0.0835236
	speed: 0.1047s/iter; left time: 3410.0364s
	iters: 3500, epoch: 13 | loss: 0.0703757
	speed: 0.1057s/iter; left time: 3431.4315s
	iters: 3600, epoch: 13 | loss: 0.0632925
	speed: 0.1075s/iter; left time: 3478.4818s
	iters: 3700, epoch: 13 | loss: 0.0658673
	speed: 0.1066s/iter; left time: 3440.8265s
	iters: 3800, epoch: 13 | loss: 0.0704690
	speed: 0.1087s/iter; left time: 3498.0750s
	iters: 3900, epoch: 13 | loss: 0.0829609
	speed: 0.1065s/iter; left time: 3413.9607s
	iters: 4000, epoch: 13 | loss: 0.0752248
	speed: 0.1053s/iter; left time: 3365.6733s
	iters: 4100, epoch: 13 | loss: 0.0729631
	speed: 0.1063s/iter; left time: 3386.1781s
	iters: 4200, epoch: 13 | loss: 0.0699356
	speed: 0.1087s/iter; left time: 3453.0041s
	iters: 4300, epoch: 13 | loss: 0.0826374
	speed: 0.1099s/iter; left time: 3481.2287s
	iters: 4400, epoch: 13 | loss: 0.0771110
	speed: 0.1064s/iter; left time: 3359.4156s
Epoch: 13 cost time: 00h:08m:04.11s
Epoch: 13 | Train Loss: 0.0804917 Vali Loss: 0.0901564 Test Loss: 0.1021227
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 14 | loss: 0.0726042
	speed: 1.4495s/iter; left time: 45476.5048s
	iters: 200, epoch: 14 | loss: 0.0950259
	speed: 0.1076s/iter; left time: 3364.6307s
	iters: 300, epoch: 14 | loss: 0.0974067
	speed: 0.1079s/iter; left time: 3363.5395s
	iters: 400, epoch: 14 | loss: 0.0626494
	speed: 0.1086s/iter; left time: 3373.3374s
	iters: 500, epoch: 14 | loss: 0.0716593
	speed: 0.1055s/iter; left time: 3266.4000s
	iters: 600, epoch: 14 | loss: 0.0849337
	speed: 0.1108s/iter; left time: 3420.4207s
	iters: 700, epoch: 14 | loss: 0.0826007
	speed: 0.1101s/iter; left time: 3387.3099s
	iters: 800, epoch: 14 | loss: 0.0776362
	speed: 0.1077s/iter; left time: 3304.1345s
	iters: 900, epoch: 14 | loss: 0.0640049
	speed: 0.1058s/iter; left time: 3235.4062s
	iters: 1000, epoch: 14 | loss: 0.0785243
	speed: 0.1041s/iter; left time: 3171.9672s
	iters: 1100, epoch: 14 | loss: 0.0750521
	speed: 0.1087s/iter; left time: 3300.1446s
	iters: 1200, epoch: 14 | loss: 0.0951579
	speed: 0.1021s/iter; left time: 3089.9786s
	iters: 1300, epoch: 14 | loss: 0.0776445
	speed: 0.1113s/iter; left time: 3357.0679s
	iters: 1400, epoch: 14 | loss: 0.0870477
	speed: 0.1059s/iter; left time: 3184.9689s
	iters: 1500, epoch: 14 | loss: 0.0794556
	speed: 0.1069s/iter; left time: 3203.1593s
	iters: 1600, epoch: 14 | loss: 0.0775292
	speed: 0.1096s/iter; left time: 3273.3867s
	iters: 1700, epoch: 14 | loss: 0.0893918
	speed: 0.1069s/iter; left time: 3183.1147s
	iters: 1800, epoch: 14 | loss: 0.0848042
	speed: 0.1055s/iter; left time: 3129.6010s
	iters: 1900, epoch: 14 | loss: 0.0841384
	speed: 0.1057s/iter; left time: 3126.2171s
	iters: 2000, epoch: 14 | loss: 0.0834215
	speed: 0.1064s/iter; left time: 3136.4897s
	iters: 2100, epoch: 14 | loss: 0.0687327
	speed: 0.1073s/iter; left time: 3151.7779s
	iters: 2200, epoch: 14 | loss: 0.0857227
	speed: 0.1084s/iter; left time: 3172.1934s
	iters: 2300, epoch: 14 | loss: 0.0868264
	speed: 0.1084s/iter; left time: 3161.2270s
	iters: 2400, epoch: 14 | loss: 0.0743876
	speed: 0.1093s/iter; left time: 3179.0395s
	iters: 2500, epoch: 14 | loss: 0.0917093
	speed: 0.1080s/iter; left time: 3129.3420s
	iters: 2600, epoch: 14 | loss: 0.0774212
	speed: 0.1094s/iter; left time: 3157.7117s
	iters: 2700, epoch: 14 | loss: 0.0725287
	speed: 0.1075s/iter; left time: 3094.0871s
	iters: 2800, epoch: 14 | loss: 0.0763098
	speed: 0.1096s/iter; left time: 3142.6273s
	iters: 2900, epoch: 14 | loss: 0.0796201
	speed: 0.1094s/iter; left time: 3125.3975s
	iters: 3000, epoch: 14 | loss: 0.0665898
	speed: 0.1109s/iter; left time: 3158.3338s
	iters: 3100, epoch: 14 | loss: 0.0787124
	speed: 0.1109s/iter; left time: 3145.5942s
	iters: 3200, epoch: 14 | loss: 0.1122939
	speed: 0.1145s/iter; left time: 3237.6875s
	iters: 3300, epoch: 14 | loss: 0.0970755
	speed: 0.1156s/iter; left time: 3257.6814s
	iters: 3400, epoch: 14 | loss: 0.0779423
	speed: 0.1159s/iter; left time: 3253.2467s
	iters: 3500, epoch: 14 | loss: 0.0917225
	speed: 0.1117s/iter; left time: 3124.7020s
	iters: 3600, epoch: 14 | loss: 0.1003116
	speed: 0.1090s/iter; left time: 3037.3148s
	iters: 3700, epoch: 14 | loss: 0.0843237
	speed: 0.1060s/iter; left time: 2942.8000s
	iters: 3800, epoch: 14 | loss: 0.0673942
	speed: 0.1037s/iter; left time: 2868.8723s
	iters: 3900, epoch: 14 | loss: 0.0758277
	speed: 0.1104s/iter; left time: 3044.4335s
	iters: 4000, epoch: 14 | loss: 0.0841069
	speed: 0.1100s/iter; left time: 3021.1814s
	iters: 4100, epoch: 14 | loss: 0.0972049
	speed: 0.1096s/iter; left time: 2999.6882s
	iters: 4200, epoch: 14 | loss: 0.0760971
	speed: 0.1091s/iter; left time: 2974.1384s
	iters: 4300, epoch: 14 | loss: 0.0766167
	speed: 0.1087s/iter; left time: 2953.0563s
	iters: 4400, epoch: 14 | loss: 0.0637466
	speed: 0.1071s/iter; left time: 2899.3748s
Epoch: 14 cost time: 00h:08m:08.22s
Epoch: 14 | Train Loss: 0.0801451 Vali Loss: 0.0898751 Test Loss: 0.1022130
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.025205422192811966, rmse:0.1587621569633484, mae:0.10119861364364624, rse:0.5474064350128174
success delete checkpoints
Intermediate time for GB and pred_len 24: 02h:27m:18.85s

=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
train 143525
val 30725
test 30725
[2024-11-02 11:09:05,393] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-02 11:09:06,553] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-02 11:09:06,553] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-02 11:09:06,553] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-02 11:09:06,653] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-02 11:09:06,654] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-02 11:09:07,351] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-02 11:09:07,352] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-02 11:09:07,353] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-02 11:09:07,354] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-02 11:09:07,354] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-02 11:09:07,354] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-02 11:09:07,354] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-02 11:09:07,354] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-02 11:09:07,354] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-02 11:09:07,354] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-02 11:09:07,670] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-02 11:09:07,671] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-02 11:09:07,671] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 113.55 GB, percent = 15.0%
[2024-11-02 11:09:07,803] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-02 11:09:07,804] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-02 11:09:07,804] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 113.55 GB, percent = 15.0%
[2024-11-02 11:09:07,804] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-02 11:09:07,925] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-02 11:09:07,926] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-02 11:09:07,926] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 113.55 GB, percent = 15.0%
[2024-11-02 11:09:07,927] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-02 11:09:07,927] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-02 11:09:07,927] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-02 11:09:07,927] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-02 11:09:07,928] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-02 11:09:07,928] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-02 11:09:07,928] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-02 11:09:07,928] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-02 11:09:07,928] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-02 11:09:07,928] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-02 11:09:07,928] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-02 11:09:07,928] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-02 11:09:07,928] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-02 11:09:07,928] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-02 11:09:07,928] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-02 11:09:07,928] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fea95d33c90>
[2024-11-02 11:09:07,928] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-02 11:09:07,928] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-02 11:09:07,928] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-02 11:09:07,929] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-02 11:09:07,930] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-02 11:09:07,930] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1523321
	speed: 0.1642s/iter; left time: 14716.1394s
	iters: 200, epoch: 1 | loss: 0.1570973
	speed: 0.1209s/iter; left time: 10817.3486s
	iters: 300, epoch: 1 | loss: 0.1372597
	speed: 0.1232s/iter; left time: 11013.3695s
	iters: 400, epoch: 1 | loss: 0.1611106
	speed: 0.1167s/iter; left time: 10422.9751s
	iters: 500, epoch: 1 | loss: 0.1438916
	speed: 0.1254s/iter; left time: 11183.1044s
	iters: 600, epoch: 1 | loss: 0.1517782
	speed: 0.1189s/iter; left time: 10597.6413s
	iters: 700, epoch: 1 | loss: 0.1311948
	speed: 0.1241s/iter; left time: 11042.8284s
	iters: 800, epoch: 1 | loss: 0.1038204
	speed: 0.1179s/iter; left time: 10481.2214s
	iters: 900, epoch: 1 | loss: 0.1193201
	speed: 0.1216s/iter; left time: 10800.0383s
	iters: 1000, epoch: 1 | loss: 0.1048014
	speed: 0.1208s/iter; left time: 10711.8491s
	iters: 1100, epoch: 1 | loss: 0.1129711
	speed: 0.1191s/iter; left time: 10548.4015s
	iters: 1200, epoch: 1 | loss: 0.1085250
	speed: 0.1219s/iter; left time: 10791.5197s
	iters: 1300, epoch: 1 | loss: 0.1155873
	speed: 0.1198s/iter; left time: 10589.9816s
	iters: 1400, epoch: 1 | loss: 0.1127517
	speed: 0.1150s/iter; left time: 10150.9681s
	iters: 1500, epoch: 1 | loss: 0.1008264
	speed: 0.1230s/iter; left time: 10845.5863s
	iters: 1600, epoch: 1 | loss: 0.1333221
	speed: 0.1181s/iter; left time: 10403.3260s
	iters: 1700, epoch: 1 | loss: 0.1157868
	speed: 0.1178s/iter; left time: 10362.5586s
	iters: 1800, epoch: 1 | loss: 0.1128253
	speed: 0.1150s/iter; left time: 10106.5354s
	iters: 1900, epoch: 1 | loss: 0.1154400
	speed: 0.1197s/iter; left time: 10510.2128s
	iters: 2000, epoch: 1 | loss: 0.1206072
	speed: 0.1213s/iter; left time: 10637.7866s
	iters: 2100, epoch: 1 | loss: 0.1116072
	speed: 0.1179s/iter; left time: 10332.3801s
	iters: 2200, epoch: 1 | loss: 0.1246088
	speed: 0.1199s/iter; left time: 10488.1211s
	iters: 2300, epoch: 1 | loss: 0.1120683
	speed: 0.1125s/iter; left time: 9832.5137s
	iters: 2400, epoch: 1 | loss: 0.1298170
	speed: 0.1194s/iter; left time: 10426.5338s
	iters: 2500, epoch: 1 | loss: 0.1402837
	speed: 0.1181s/iter; left time: 10296.0634s
	iters: 2600, epoch: 1 | loss: 0.1254882
	speed: 0.1183s/iter; left time: 10305.0880s
	iters: 2700, epoch: 1 | loss: 0.1003666
	speed: 0.1171s/iter; left time: 10189.6375s
	iters: 2800, epoch: 1 | loss: 0.1112671
	speed: 0.1172s/iter; left time: 10185.2528s
	iters: 2900, epoch: 1 | loss: 0.1137624
	speed: 0.1198s/iter; left time: 10402.4663s
	iters: 3000, epoch: 1 | loss: 0.1242562
	speed: 0.1185s/iter; left time: 10278.3318s
	iters: 3100, epoch: 1 | loss: 0.1275978
	speed: 0.1142s/iter; left time: 9893.9340s
	iters: 3200, epoch: 1 | loss: 0.1161146
	speed: 0.1141s/iter; left time: 9870.8651s
	iters: 3300, epoch: 1 | loss: 0.1244878
	speed: 0.1178s/iter; left time: 10178.6933s
	iters: 3400, epoch: 1 | loss: 0.1080193
	speed: 0.1216s/iter; left time: 10497.7282s
	iters: 3500, epoch: 1 | loss: 0.1138757
	speed: 0.1196s/iter; left time: 10309.6014s
	iters: 3600, epoch: 1 | loss: 0.1165035
	speed: 0.1162s/iter; left time: 10009.1216s
	iters: 3700, epoch: 1 | loss: 0.1057020
	speed: 0.1226s/iter; left time: 10542.4120s
	iters: 3800, epoch: 1 | loss: 0.0968045
	speed: 0.1225s/iter; left time: 10519.0971s
	iters: 3900, epoch: 1 | loss: 0.1031482
	speed: 0.1164s/iter; left time: 9983.3868s
	iters: 4000, epoch: 1 | loss: 0.1125728
	speed: 0.1196s/iter; left time: 10247.4907s
	iters: 4100, epoch: 1 | loss: 0.1198684
	speed: 0.1194s/iter; left time: 10223.1208s
	iters: 4200, epoch: 1 | loss: 0.1088336
	speed: 0.1180s/iter; left time: 10091.9961s
	iters: 4300, epoch: 1 | loss: 0.1251617
	speed: 0.1194s/iter; left time: 10195.8646s
	iters: 4400, epoch: 1 | loss: 0.1200401
	speed: 0.1176s/iter; left time: 10031.5046s
Epoch: 1 cost time: 00h:08m:55.29s
Epoch: 1 | Train Loss: 0.1178117 Vali Loss: 0.1184595 Test Loss: 0.1412180
Validation loss decreased (inf --> 0.118459).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0888638
	speed: 1.6645s/iter; left time: 141672.5188s
	iters: 200, epoch: 2 | loss: 0.1137921
	speed: 0.1082s/iter; left time: 9202.4579s
	iters: 300, epoch: 2 | loss: 0.1233345
	speed: 0.1080s/iter; left time: 9173.1189s
	iters: 400, epoch: 2 | loss: 0.1065918
	speed: 0.1019s/iter; left time: 8639.2576s
	iters: 500, epoch: 2 | loss: 0.0876302
	speed: 0.1067s/iter; left time: 9043.3081s
	iters: 600, epoch: 2 | loss: 0.1139689
	speed: 0.1069s/iter; left time: 9046.5598s
	iters: 700, epoch: 2 | loss: 0.1090599
	speed: 0.1102s/iter; left time: 9316.3301s
	iters: 800, epoch: 2 | loss: 0.0918770
	speed: 0.1101s/iter; left time: 9290.4094s
	iters: 900, epoch: 2 | loss: 0.1054808
	speed: 0.1096s/iter; left time: 9244.5952s
	iters: 1000, epoch: 2 | loss: 0.1240198
	speed: 0.1094s/iter; left time: 9214.8151s
	iters: 1100, epoch: 2 | loss: 0.1188949
	speed: 0.1060s/iter; left time: 8912.7695s
	iters: 1200, epoch: 2 | loss: 0.1082713
	speed: 0.1068s/iter; left time: 8970.2357s
	iters: 1300, epoch: 2 | loss: 0.1121853
	speed: 0.1107s/iter; left time: 9291.2580s
	iters: 1400, epoch: 2 | loss: 0.1057807
	speed: 0.1094s/iter; left time: 9167.4611s
	iters: 1500, epoch: 2 | loss: 0.1165954
	speed: 0.1027s/iter; left time: 8595.6482s
	iters: 1600, epoch: 2 | loss: 0.1163039
	speed: 0.1082s/iter; left time: 9048.2322s
	iters: 1700, epoch: 2 | loss: 0.1402899
	speed: 0.1080s/iter; left time: 9019.2083s
	iters: 1800, epoch: 2 | loss: 0.0893394
	speed: 0.1091s/iter; left time: 9103.0766s
	iters: 1900, epoch: 2 | loss: 0.1250467
	speed: 0.1082s/iter; left time: 9012.4281s
	iters: 2000, epoch: 2 | loss: 0.0956506
	speed: 0.1055s/iter; left time: 8779.0126s
	iters: 2100, epoch: 2 | loss: 0.1079546
	speed: 0.1074s/iter; left time: 8925.6004s
	iters: 2200, epoch: 2 | loss: 0.1003428
	speed: 0.1034s/iter; left time: 8584.0707s
	iters: 2300, epoch: 2 | loss: 0.1021225
	speed: 0.1088s/iter; left time: 9022.0597s
	iters: 2400, epoch: 2 | loss: 0.1186273
	speed: 0.1034s/iter; left time: 8566.1653s
	iters: 2500, epoch: 2 | loss: 0.1165032
	speed: 0.1061s/iter; left time: 8774.0694s
	iters: 2600, epoch: 2 | loss: 0.1051225
	speed: 0.1063s/iter; left time: 8779.5792s
	iters: 2700, epoch: 2 | loss: 0.1007597
	speed: 0.1062s/iter; left time: 8762.9591s
	iters: 2800, epoch: 2 | loss: 0.0979256
	speed: 0.1066s/iter; left time: 8782.6368s
	iters: 2900, epoch: 2 | loss: 0.1156221
	speed: 0.1103s/iter; left time: 9078.6564s
	iters: 3000, epoch: 2 | loss: 0.1229274
	speed: 0.1086s/iter; left time: 8929.6905s
	iters: 3100, epoch: 2 | loss: 0.1010010
	speed: 0.1101s/iter; left time: 9038.0092s
	iters: 3200, epoch: 2 | loss: 0.0914321
	speed: 0.1050s/iter; left time: 8608.4418s
	iters: 3300, epoch: 2 | loss: 0.0996214
	speed: 0.1090s/iter; left time: 8932.6923s
	iters: 3400, epoch: 2 | loss: 0.1225803
	speed: 0.1057s/iter; left time: 8645.2226s
	iters: 3500, epoch: 2 | loss: 0.1037378
	speed: 0.1081s/iter; left time: 8834.8982s
	iters: 3600, epoch: 2 | loss: 0.0835612
	speed: 0.1081s/iter; left time: 8819.2208s
	iters: 3700, epoch: 2 | loss: 0.1148943
	speed: 0.1078s/iter; left time: 8789.5885s
	iters: 3800, epoch: 2 | loss: 0.1152604
	speed: 0.1082s/iter; left time: 8807.0794s
	iters: 3900, epoch: 2 | loss: 0.1060695
	speed: 0.1106s/iter; left time: 8992.8881s
	iters: 4000, epoch: 2 | loss: 0.0958115
	speed: 0.1089s/iter; left time: 8840.9779s
	iters: 4100, epoch: 2 | loss: 0.1165176
	speed: 0.1086s/iter; left time: 8810.6341s
	iters: 4200, epoch: 2 | loss: 0.1040161
	speed: 0.1081s/iter; left time: 8754.8615s
	iters: 4300, epoch: 2 | loss: 0.1187941
	speed: 0.1120s/iter; left time: 9065.4638s
	iters: 4400, epoch: 2 | loss: 0.1056552
	speed: 0.1088s/iter; left time: 8793.8298s
Epoch: 2 cost time: 00h:08m:03.68s
Epoch: 2 | Train Loss: 0.1077817 Vali Loss: 0.1173895 Test Loss: 0.1434370
Validation loss decreased (0.118459 --> 0.117389).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.1310282
	speed: 1.4511s/iter; left time: 117006.7300s
	iters: 200, epoch: 3 | loss: 0.1085388
	speed: 0.1104s/iter; left time: 8894.4253s
	iters: 300, epoch: 3 | loss: 0.1202963
	speed: 0.1118s/iter; left time: 8993.4722s
	iters: 400, epoch: 3 | loss: 0.1198052
	speed: 0.1101s/iter; left time: 8841.1450s
	iters: 500, epoch: 3 | loss: 0.1075269
	speed: 0.1087s/iter; left time: 8723.8894s
	iters: 600, epoch: 3 | loss: 0.0981584
	speed: 0.1058s/iter; left time: 8480.3468s
	iters: 700, epoch: 3 | loss: 0.1196058
	speed: 0.1064s/iter; left time: 8511.6395s
	iters: 800, epoch: 3 | loss: 0.1243347
	speed: 0.1088s/iter; left time: 8696.4165s
	iters: 900, epoch: 3 | loss: 0.1134376
	speed: 0.1091s/iter; left time: 8712.2458s
	iters: 1000, epoch: 3 | loss: 0.1046471
	speed: 0.1055s/iter; left time: 8408.6168s
	iters: 1100, epoch: 3 | loss: 0.1102815
	speed: 0.1084s/iter; left time: 8632.7852s
	iters: 1200, epoch: 3 | loss: 0.0851324
	speed: 0.1071s/iter; left time: 8521.0054s
	iters: 1300, epoch: 3 | loss: 0.0943000
	speed: 0.1090s/iter; left time: 8655.1238s
	iters: 1400, epoch: 3 | loss: 0.0990528
	speed: 0.1087s/iter; left time: 8621.0262s
	iters: 1500, epoch: 3 | loss: 0.0970403
	speed: 0.1089s/iter; left time: 8625.9391s
	iters: 1600, epoch: 3 | loss: 0.0781570
	speed: 0.1078s/iter; left time: 8528.1395s
	iters: 1700, epoch: 3 | loss: 0.0904602
	speed: 0.1093s/iter; left time: 8634.1985s
	iters: 1800, epoch: 3 | loss: 0.1183398
	speed: 0.1104s/iter; left time: 8716.5300s
	iters: 1900, epoch: 3 | loss: 0.1106287
	speed: 0.1113s/iter; left time: 8772.8133s
	iters: 2000, epoch: 3 | loss: 0.1017435
	speed: 0.1107s/iter; left time: 8712.6664s
	iters: 2100, epoch: 3 | loss: 0.0943806
	speed: 0.1108s/iter; left time: 8715.7095s
	iters: 2200, epoch: 3 | loss: 0.1140733
	speed: 0.1109s/iter; left time: 8710.2082s
	iters: 2300, epoch: 3 | loss: 0.1258210
	speed: 0.1093s/iter; left time: 8571.6508s
	iters: 2400, epoch: 3 | loss: 0.0975943
	speed: 0.1101s/iter; left time: 8623.4105s
	iters: 2500, epoch: 3 | loss: 0.1019286
	speed: 0.1087s/iter; left time: 8507.3984s
	iters: 2600, epoch: 3 | loss: 0.1040863
	speed: 0.1103s/iter; left time: 8615.2479s
	iters: 2700, epoch: 3 | loss: 0.1137355
	speed: 0.1101s/iter; left time: 8591.0793s
	iters: 2800, epoch: 3 | loss: 0.1007091
	speed: 0.1104s/iter; left time: 8604.1474s
	iters: 2900, epoch: 3 | loss: 0.1016200
	speed: 0.1113s/iter; left time: 8660.1653s
	iters: 3000, epoch: 3 | loss: 0.1144505
	speed: 0.1112s/iter; left time: 8642.1682s
	iters: 3100, epoch: 3 | loss: 0.1279829
	speed: 0.1097s/iter; left time: 8513.7131s
	iters: 3200, epoch: 3 | loss: 0.1213689
	speed: 0.1090s/iter; left time: 8451.7399s
	iters: 3300, epoch: 3 | loss: 0.1051345
	speed: 0.1110s/iter; left time: 8597.2565s
	iters: 3400, epoch: 3 | loss: 0.1120226
	speed: 0.1148s/iter; left time: 8874.1319s
	iters: 3500, epoch: 3 | loss: 0.1024189
	speed: 0.1163s/iter; left time: 8980.1940s
	iters: 3600, epoch: 3 | loss: 0.0943960
	speed: 0.1137s/iter; left time: 8772.9666s
	iters: 3700, epoch: 3 | loss: 0.1066416
	speed: 0.1149s/iter; left time: 8854.0322s
	iters: 3800, epoch: 3 | loss: 0.0961487
	speed: 0.1144s/iter; left time: 8803.2502s
	iters: 3900, epoch: 3 | loss: 0.0950556
	speed: 0.1143s/iter; left time: 8778.9043s
	iters: 4000, epoch: 3 | loss: 0.1026345
	speed: 0.1149s/iter; left time: 8814.8270s
	iters: 4100, epoch: 3 | loss: 0.1027451
	speed: 0.1094s/iter; left time: 8386.3927s
	iters: 4200, epoch: 3 | loss: 0.1061701
	speed: 0.1059s/iter; left time: 8105.5696s
	iters: 4300, epoch: 3 | loss: 0.0936683
	speed: 0.1023s/iter; left time: 7818.0689s
	iters: 4400, epoch: 3 | loss: 0.1012166
	speed: 0.1054s/iter; left time: 8046.8008s
Epoch: 3 cost time: 00h:08m:13.06s
Epoch: 3 | Train Loss: 0.1043771 Vali Loss: 0.1187507 Test Loss: 0.1443793
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.1020158
	speed: 1.4266s/iter; left time: 108629.7933s
	iters: 200, epoch: 4 | loss: 0.1003834
	speed: 0.1065s/iter; left time: 8099.1186s
	iters: 300, epoch: 4 | loss: 0.1127172
	speed: 0.1054s/iter; left time: 8005.5924s
	iters: 400, epoch: 4 | loss: 0.1082551
	speed: 0.1117s/iter; left time: 8468.3907s
	iters: 500, epoch: 4 | loss: 0.1041521
	speed: 0.1102s/iter; left time: 8350.9373s
	iters: 600, epoch: 4 | loss: 0.1070160
	speed: 0.1089s/iter; left time: 8237.1190s
	iters: 700, epoch: 4 | loss: 0.1449660
	speed: 0.1088s/iter; left time: 8222.5166s
	iters: 800, epoch: 4 | loss: 0.0877978
	speed: 0.1106s/iter; left time: 8345.7626s
	iters: 900, epoch: 4 | loss: 0.0985263
	speed: 0.1102s/iter; left time: 8304.9653s
	iters: 1000, epoch: 4 | loss: 0.1049943
	speed: 0.1072s/iter; left time: 8069.5046s
	iters: 1100, epoch: 4 | loss: 0.0958291
	speed: 0.1103s/iter; left time: 8288.1820s
	iters: 1200, epoch: 4 | loss: 0.0853065
	speed: 0.1109s/iter; left time: 8324.7872s
	iters: 1300, epoch: 4 | loss: 0.0855185
	speed: 0.1059s/iter; left time: 7939.1575s
	iters: 1400, epoch: 4 | loss: 0.0994194
	speed: 0.1074s/iter; left time: 8038.8326s
	iters: 1500, epoch: 4 | loss: 0.1068409
	speed: 0.1097s/iter; left time: 8196.6038s
	iters: 1600, epoch: 4 | loss: 0.1120063
	speed: 0.1123s/iter; left time: 8379.7792s
	iters: 1700, epoch: 4 | loss: 0.1221094
	speed: 0.1110s/iter; left time: 8274.3631s
	iters: 1800, epoch: 4 | loss: 0.0878371
	speed: 0.1078s/iter; left time: 8023.7988s
	iters: 1900, epoch: 4 | loss: 0.1065904
	speed: 0.1085s/iter; left time: 8069.4740s
	iters: 2000, epoch: 4 | loss: 0.1217954
	speed: 0.1044s/iter; left time: 7747.9174s
	iters: 2100, epoch: 4 | loss: 0.0763485
	speed: 0.1073s/iter; left time: 7958.5286s
	iters: 2200, epoch: 4 | loss: 0.1082068
	speed: 0.1090s/iter; left time: 8070.6059s
	iters: 2300, epoch: 4 | loss: 0.0984239
	speed: 0.1061s/iter; left time: 7844.5492s
	iters: 2400, epoch: 4 | loss: 0.0943878
	speed: 0.1040s/iter; left time: 7681.8681s
	iters: 2500, epoch: 4 | loss: 0.1143633
	speed: 0.1093s/iter; left time: 8060.9938s
	iters: 2600, epoch: 4 | loss: 0.1017567
	speed: 0.1068s/iter; left time: 7866.4857s
	iters: 2700, epoch: 4 | loss: 0.0997897
	speed: 0.1085s/iter; left time: 7979.5815s
	iters: 2800, epoch: 4 | loss: 0.1115867
	speed: 0.1097s/iter; left time: 8059.9033s
	iters: 2900, epoch: 4 | loss: 0.0922957
	speed: 0.1011s/iter; left time: 7417.0598s
	iters: 3000, epoch: 4 | loss: 0.1038117
	speed: 0.1058s/iter; left time: 7746.4603s
	iters: 3100, epoch: 4 | loss: 0.0926916
	speed: 0.1085s/iter; left time: 7933.7269s
	iters: 3200, epoch: 4 | loss: 0.0785196
	speed: 0.1055s/iter; left time: 7706.2941s
	iters: 3300, epoch: 4 | loss: 0.1024314
	speed: 0.1066s/iter; left time: 7777.9395s
	iters: 3400, epoch: 4 | loss: 0.0930109
	speed: 0.0964s/iter; left time: 7019.4791s
	iters: 3500, epoch: 4 | loss: 0.0849443
	speed: 0.1076s/iter; left time: 7830.5603s
	iters: 3600, epoch: 4 | loss: 0.0900325
	speed: 0.1052s/iter; left time: 7642.6536s
	iters: 3700, epoch: 4 | loss: 0.1102086
	speed: 0.1036s/iter; left time: 7515.5689s
	iters: 3800, epoch: 4 | loss: 0.0800017
	speed: 0.1056s/iter; left time: 7651.7566s
	iters: 3900, epoch: 4 | loss: 0.0829896
	speed: 0.1077s/iter; left time: 7789.8891s
	iters: 4000, epoch: 4 | loss: 0.0955721
	speed: 0.1121s/iter; left time: 8097.7927s
	iters: 4100, epoch: 4 | loss: 0.1014783
	speed: 0.1107s/iter; left time: 7987.8152s
	iters: 4200, epoch: 4 | loss: 0.1079314
	speed: 0.1064s/iter; left time: 7664.9586s
	iters: 4300, epoch: 4 | loss: 0.1017345
	speed: 0.1061s/iter; left time: 7632.5592s
	iters: 4400, epoch: 4 | loss: 0.0957486
	speed: 0.1083s/iter; left time: 7778.6908s
Epoch: 4 cost time: 00h:08m:02.79s
Epoch: 4 | Train Loss: 0.1004036 Vali Loss: 0.1205356 Test Loss: 0.1469130
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.1013267
	speed: 1.4324s/iter; left time: 102648.4436s
	iters: 200, epoch: 5 | loss: 0.1063943
	speed: 0.1077s/iter; left time: 7703.5968s
	iters: 300, epoch: 5 | loss: 0.1020837
	speed: 0.1118s/iter; left time: 7991.0566s
	iters: 400, epoch: 5 | loss: 0.1110498
	speed: 0.1102s/iter; left time: 7867.0923s
	iters: 500, epoch: 5 | loss: 0.1179720
	speed: 0.1061s/iter; left time: 7559.8261s
	iters: 600, epoch: 5 | loss: 0.1031104
	speed: 0.1075s/iter; left time: 7650.7286s
	iters: 700, epoch: 5 | loss: 0.0947505
	speed: 0.1100s/iter; left time: 7815.1928s
	iters: 800, epoch: 5 | loss: 0.0988153
	speed: 0.1023s/iter; left time: 7257.7675s
	iters: 900, epoch: 5 | loss: 0.0980647
	speed: 0.1092s/iter; left time: 7736.7493s
	iters: 1000, epoch: 5 | loss: 0.1027513
	speed: 0.1090s/iter; left time: 7711.4596s
	iters: 1100, epoch: 5 | loss: 0.1019618
	speed: 0.1066s/iter; left time: 7531.4308s
	iters: 1200, epoch: 5 | loss: 0.0872446
	speed: 0.1048s/iter; left time: 7393.3369s
	iters: 1300, epoch: 5 | loss: 0.0995278
	speed: 0.1102s/iter; left time: 7767.5143s
	iters: 1400, epoch: 5 | loss: 0.0856419
	speed: 0.1063s/iter; left time: 7480.2797s
	iters: 1500, epoch: 5 | loss: 0.0984738
	speed: 0.1074s/iter; left time: 7547.4283s
	iters: 1600, epoch: 5 | loss: 0.0897058
	speed: 0.1081s/iter; left time: 7581.8695s
	iters: 1700, epoch: 5 | loss: 0.0837954
	speed: 0.1081s/iter; left time: 7573.9114s
	iters: 1800, epoch: 5 | loss: 0.1022424
	speed: 0.1108s/iter; left time: 7751.0991s
	iters: 1900, epoch: 5 | loss: 0.1100879
	speed: 0.1067s/iter; left time: 7457.5476s
	iters: 2000, epoch: 5 | loss: 0.1003026
	speed: 0.1099s/iter; left time: 7669.4448s
	iters: 2100, epoch: 5 | loss: 0.0989896
	speed: 0.1127s/iter; left time: 7853.8883s
	iters: 2200, epoch: 5 | loss: 0.1024873
	speed: 0.1112s/iter; left time: 7738.3216s
	iters: 2300, epoch: 5 | loss: 0.1089459
	speed: 0.1093s/iter; left time: 7593.1926s
	iters: 2400, epoch: 5 | loss: 0.1069664
	speed: 0.1097s/iter; left time: 7606.0668s
	iters: 2500, epoch: 5 | loss: 0.0821716
	speed: 0.1092s/iter; left time: 7565.3457s
	iters: 2600, epoch: 5 | loss: 0.0913218
	speed: 0.1044s/iter; left time: 7219.4036s
	iters: 2700, epoch: 5 | loss: 0.0889648
	speed: 0.1084s/iter; left time: 7482.9710s
	iters: 2800, epoch: 5 | loss: 0.0932212
	speed: 0.1138s/iter; left time: 7850.3600s
	iters: 2900, epoch: 5 | loss: 0.0853349
	speed: 0.1050s/iter; left time: 7233.3472s
	iters: 3000, epoch: 5 | loss: 0.0956874
	speed: 0.1033s/iter; left time: 7104.3960s
	iters: 3100, epoch: 5 | loss: 0.0857884
	speed: 0.1133s/iter; left time: 7782.6325s
	iters: 3200, epoch: 5 | loss: 0.0957507
	speed: 0.1091s/iter; left time: 7478.0101s
	iters: 3300, epoch: 5 | loss: 0.0887952
	speed: 0.1111s/iter; left time: 7607.7668s
	iters: 3400, epoch: 5 | loss: 0.0878523
	speed: 0.1104s/iter; left time: 7544.4456s
	iters: 3500, epoch: 5 | loss: 0.0892572
	speed: 0.1069s/iter; left time: 7295.6108s
	iters: 3600, epoch: 5 | loss: 0.1093634
	speed: 0.1074s/iter; left time: 7320.9435s
	iters: 3700, epoch: 5 | loss: 0.0850211
	speed: 0.1037s/iter; left time: 7057.2676s
	iters: 3800, epoch: 5 | loss: 0.0877998
	speed: 0.1081s/iter; left time: 7348.3714s
	iters: 3900, epoch: 5 | loss: 0.1017472
	speed: 0.1090s/iter; left time: 7399.1499s
	iters: 4000, epoch: 5 | loss: 0.0930923
	speed: 0.1088s/iter; left time: 7375.1654s
	iters: 4100, epoch: 5 | loss: 0.0939313
	speed: 0.1073s/iter; left time: 7258.2624s
	iters: 4200, epoch: 5 | loss: 0.0919951
	speed: 0.1029s/iter; left time: 6950.2808s
	iters: 4300, epoch: 5 | loss: 0.0943117
	speed: 0.1106s/iter; left time: 7464.2538s
	iters: 4400, epoch: 5 | loss: 0.0894200
	speed: 0.1101s/iter; left time: 7414.6584s
Epoch: 5 cost time: 00h:08m:06.31s
Epoch: 5 | Train Loss: 0.0966544 Vali Loss: 0.1223298 Test Loss: 0.1498027
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0925073
	speed: 1.4349s/iter; left time: 96391.4087s
	iters: 200, epoch: 6 | loss: 0.1033233
	speed: 0.1065s/iter; left time: 7143.5485s
	iters: 300, epoch: 6 | loss: 0.1017852
	speed: 0.1045s/iter; left time: 6996.4023s
	iters: 400, epoch: 6 | loss: 0.0813918
	speed: 0.1054s/iter; left time: 7051.0602s
	iters: 500, epoch: 6 | loss: 0.1012578
	speed: 0.1046s/iter; left time: 6986.6502s
	iters: 600, epoch: 6 | loss: 0.0925734
	speed: 0.1053s/iter; left time: 7019.1729s
	iters: 700, epoch: 6 | loss: 0.0816648
	speed: 0.1059s/iter; left time: 7051.2712s
	iters: 800, epoch: 6 | loss: 0.0903690
	speed: 0.1054s/iter; left time: 7008.7325s
	iters: 900, epoch: 6 | loss: 0.1008372
	speed: 0.1073s/iter; left time: 7119.6150s
	iters: 1000, epoch: 6 | loss: 0.0913643
	speed: 0.1080s/iter; left time: 7158.1052s
	iters: 1100, epoch: 6 | loss: 0.1034070
	speed: 0.1102s/iter; left time: 7291.8303s
	iters: 1200, epoch: 6 | loss: 0.1074490
	speed: 0.1054s/iter; left time: 6966.9283s
	iters: 1300, epoch: 6 | loss: 0.0876377
	speed: 0.1064s/iter; left time: 7017.0102s
	iters: 1400, epoch: 6 | loss: 0.1026839
	speed: 0.1084s/iter; left time: 7141.4853s
	iters: 1500, epoch: 6 | loss: 0.0969250
	speed: 0.1130s/iter; left time: 7435.6748s
	iters: 1600, epoch: 6 | loss: 0.0847653
	speed: 0.1105s/iter; left time: 7254.9230s
	iters: 1700, epoch: 6 | loss: 0.0786244
	speed: 0.1098s/iter; left time: 7202.3233s
	iters: 1800, epoch: 6 | loss: 0.0895295
	speed: 0.1110s/iter; left time: 7266.2878s
	iters: 1900, epoch: 6 | loss: 0.0960533
	speed: 0.1112s/iter; left time: 7269.8468s
	iters: 2000, epoch: 6 | loss: 0.1027374
	speed: 0.1042s/iter; left time: 6802.7242s
	iters: 2100, epoch: 6 | loss: 0.0939934
	speed: 0.1096s/iter; left time: 7140.3883s
	iters: 2200, epoch: 6 | loss: 0.0843199
	speed: 0.1080s/iter; left time: 7025.6123s
	iters: 2300, epoch: 6 | loss: 0.0809122
	speed: 0.1056s/iter; left time: 6864.2003s
	iters: 2400, epoch: 6 | loss: 0.1014044
	speed: 0.1072s/iter; left time: 6957.7941s
	iters: 2500, epoch: 6 | loss: 0.0871974
	speed: 0.1046s/iter; left time: 6775.4703s
	iters: 2600, epoch: 6 | loss: 0.0921036
	speed: 0.1055s/iter; left time: 6823.3170s
	iters: 2700, epoch: 6 | loss: 0.1040257
	speed: 0.1067s/iter; left time: 6893.3519s
	iters: 2800, epoch: 6 | loss: 0.1056846
	speed: 0.1114s/iter; left time: 7185.6550s
	iters: 2900, epoch: 6 | loss: 0.0859896
	speed: 0.1093s/iter; left time: 7033.2292s
	iters: 3000, epoch: 6 | loss: 0.0964024
	speed: 0.1030s/iter; left time: 6619.1718s
	iters: 3100, epoch: 6 | loss: 0.0688204
	speed: 0.1062s/iter; left time: 6816.5541s
	iters: 3200, epoch: 6 | loss: 0.0952048
	speed: 0.1090s/iter; left time: 6987.1033s
	iters: 3300, epoch: 6 | loss: 0.1085152
	speed: 0.1089s/iter; left time: 6967.9033s
	iters: 3400, epoch: 6 | loss: 0.0811777
	speed: 0.1089s/iter; left time: 6958.1351s
	iters: 3500, epoch: 6 | loss: 0.1095598
	speed: 0.1048s/iter; left time: 6682.1048s
	iters: 3600, epoch: 6 | loss: 0.1067103
	speed: 0.1071s/iter; left time: 6818.2425s
	iters: 3700, epoch: 6 | loss: 0.0980428
	speed: 0.1116s/iter; left time: 7095.8458s
	iters: 3800, epoch: 6 | loss: 0.0960030
	speed: 0.1074s/iter; left time: 6816.9789s
	iters: 3900, epoch: 6 | loss: 0.0844862
	speed: 0.1094s/iter; left time: 6931.5156s
	iters: 4000, epoch: 6 | loss: 0.0948572
	speed: 0.1122s/iter; left time: 7098.3958s
	iters: 4100, epoch: 6 | loss: 0.0972997
	speed: 0.1041s/iter; left time: 6578.0725s
	iters: 4200, epoch: 6 | loss: 0.0840513
	speed: 0.1005s/iter; left time: 6342.2825s
	iters: 4300, epoch: 6 | loss: 0.0846837
	speed: 0.1068s/iter; left time: 6726.8852s
	iters: 4400, epoch: 6 | loss: 0.0994278
	speed: 0.1067s/iter; left time: 6710.9728s
Epoch: 6 cost time: 00h:08m:02.05s
Epoch: 6 | Train Loss: 0.0935319 Vali Loss: 0.1227152 Test Loss: 0.1494228
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0913173
	speed: 1.4293s/iter; left time: 89602.9337s
	iters: 200, epoch: 7 | loss: 0.1163411
	speed: 0.1066s/iter; left time: 6672.4964s
	iters: 300, epoch: 7 | loss: 0.0927998
	speed: 0.1023s/iter; left time: 6393.4464s
	iters: 400, epoch: 7 | loss: 0.0917988
	speed: 0.1084s/iter; left time: 6766.0541s
	iters: 500, epoch: 7 | loss: 0.0816753
	speed: 0.1080s/iter; left time: 6724.9604s
	iters: 600, epoch: 7 | loss: 0.1129898
	speed: 0.1079s/iter; left time: 6710.5650s
	iters: 700, epoch: 7 | loss: 0.0816540
	speed: 0.1090s/iter; left time: 6768.0810s
	iters: 800, epoch: 7 | loss: 0.1145246
	speed: 0.1110s/iter; left time: 6878.3435s
	iters: 900, epoch: 7 | loss: 0.0861063
	speed: 0.1078s/iter; left time: 6671.9489s
	iters: 1000, epoch: 7 | loss: 0.0930915
	speed: 0.1067s/iter; left time: 6595.2577s
	iters: 1100, epoch: 7 | loss: 0.0832640
	speed: 0.1060s/iter; left time: 6540.8371s
	iters: 1200, epoch: 7 | loss: 0.1068092
	speed: 0.1047s/iter; left time: 6445.8849s
	iters: 1300, epoch: 7 | loss: 0.1094583
	speed: 0.1059s/iter; left time: 6509.7356s
	iters: 1400, epoch: 7 | loss: 0.0916336
	speed: 0.1056s/iter; left time: 6482.0607s
	iters: 1500, epoch: 7 | loss: 0.0932818
	speed: 0.1042s/iter; left time: 6384.5600s
	iters: 1600, epoch: 7 | loss: 0.0976237
	speed: 0.1079s/iter; left time: 6604.1286s
	iters: 1700, epoch: 7 | loss: 0.1042555
	speed: 0.1116s/iter; left time: 6817.9485s
	iters: 1800, epoch: 7 | loss: 0.0780962
	speed: 0.1084s/iter; left time: 6609.7655s
	iters: 1900, epoch: 7 | loss: 0.0822116
	speed: 0.1047s/iter; left time: 6373.6247s
	iters: 2000, epoch: 7 | loss: 0.0880490
	speed: 0.1074s/iter; left time: 6528.3157s
	iters: 2100, epoch: 7 | loss: 0.0868164
	speed: 0.1072s/iter; left time: 6507.6568s
	iters: 2200, epoch: 7 | loss: 0.0720907
	speed: 0.1071s/iter; left time: 6491.6283s
	iters: 2300, epoch: 7 | loss: 0.0788777
	speed: 0.1096s/iter; left time: 6631.8210s
	iters: 2400, epoch: 7 | loss: 0.0901415
	speed: 0.1063s/iter; left time: 6419.7458s
	iters: 2500, epoch: 7 | loss: 0.0850017
	speed: 0.1067s/iter; left time: 6433.9397s
	iters: 2600, epoch: 7 | loss: 0.0886241
	speed: 0.1072s/iter; left time: 6449.7304s
	iters: 2700, epoch: 7 | loss: 0.0978564
	speed: 0.1041s/iter; left time: 6255.0896s
	iters: 2800, epoch: 7 | loss: 0.0925564
	speed: 0.1065s/iter; left time: 6389.7855s
	iters: 2900, epoch: 7 | loss: 0.1175411
	speed: 0.1077s/iter; left time: 6451.2886s
	iters: 3000, epoch: 7 | loss: 0.0782495
	speed: 0.1077s/iter; left time: 6441.0094s
	iters: 3100, epoch: 7 | loss: 0.0809937
	speed: 0.1041s/iter; left time: 6211.7480s
	iters: 3200, epoch: 7 | loss: 0.0883481
	speed: 0.1054s/iter; left time: 6280.1993s
	iters: 3300, epoch: 7 | loss: 0.0891999
	speed: 0.1065s/iter; left time: 6332.8541s
	iters: 3400, epoch: 7 | loss: 0.0984669
	speed: 0.1078s/iter; left time: 6401.0366s
	iters: 3500, epoch: 7 | loss: 0.0943845
	speed: 0.1074s/iter; left time: 6369.6049s
	iters: 3600, epoch: 7 | loss: 0.0912553
	speed: 0.1056s/iter; left time: 6248.8721s
	iters: 3700, epoch: 7 | loss: 0.0948698
	speed: 0.1060s/iter; left time: 6261.7698s
	iters: 3800, epoch: 7 | loss: 0.0706965
	speed: 0.1072s/iter; left time: 6323.6486s
	iters: 3900, epoch: 7 | loss: 0.1006198
	speed: 0.1067s/iter; left time: 6283.7804s
	iters: 4000, epoch: 7 | loss: 0.0881463
	speed: 0.1084s/iter; left time: 6370.4621s
	iters: 4100, epoch: 7 | loss: 0.1020899
	speed: 0.1086s/iter; left time: 6371.3175s
	iters: 4200, epoch: 7 | loss: 0.0827523
	speed: 0.1070s/iter; left time: 6269.6178s
	iters: 4300, epoch: 7 | loss: 0.1077781
	speed: 0.1092s/iter; left time: 6388.1090s
	iters: 4400, epoch: 7 | loss: 0.0829007
	speed: 0.1105s/iter; left time: 6453.8770s
Epoch: 7 cost time: 00h:08m:01.26s
Epoch: 7 | Train Loss: 0.0908818 Vali Loss: 0.1233640 Test Loss: 0.1499765
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.0437089167535305, rmse:0.20906677842140198, mae:0.143436998128891, rse:0.7229486107826233
success delete checkpoints
Intermediate time for GB and pred_len 96: 01h:13m:33.46s

=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
train 143165
val 30365
test 30365
[2024-11-02 12:22:39,024] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-02 12:22:39,984] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-02 12:22:39,985] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-02 12:22:39,985] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-02 12:22:40,074] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-02 12:22:40,074] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-02 12:22:40,708] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-02 12:22:40,709] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-02 12:22:40,709] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-02 12:22:40,710] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-02 12:22:40,710] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-02 12:22:40,711] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-02 12:22:40,711] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-02 12:22:40,711] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-02 12:22:40,711] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-02 12:22:40,711] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-02 12:22:41,051] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-02 12:22:41,052] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-02 12:22:41,052] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 113.53 GB, percent = 15.0%
[2024-11-02 12:22:41,176] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-02 12:22:41,177] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 12:22:41,177] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 113.53 GB, percent = 15.0%
[2024-11-02 12:22:41,177] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-02 12:22:41,295] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-02 12:22:41,296] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 12:22:41,296] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 113.54 GB, percent = 15.0%
[2024-11-02 12:22:41,297] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-02 12:22:41,297] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-02 12:22:41,297] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-02 12:22:41,297] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-02 12:22:41,298] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-02 12:22:41,299] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-02 12:22:41,299] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-02 12:22:41,299] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-02 12:22:41,299] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f0822259f10>
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-02 12:22:41,300] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-02 12:22:41,301] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-02 12:22:41,302] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-02 12:22:41,302] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-02 12:22:41,302] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-02 12:22:41,302] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-02 12:22:41,302] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-02 12:22:41,302] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-02 12:22:41,302] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-02 12:22:41,302] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1492039
	speed: 0.1558s/iter; left time: 13920.1947s
	iters: 200, epoch: 1 | loss: 0.1571750
	speed: 0.1229s/iter; left time: 10972.2522s
	iters: 300, epoch: 1 | loss: 0.1447653
	speed: 0.1187s/iter; left time: 10586.4424s
	iters: 400, epoch: 1 | loss: 0.1463560
	speed: 0.1149s/iter; left time: 10234.8297s
	iters: 500, epoch: 1 | loss: 0.1403078
	speed: 0.1148s/iter; left time: 10213.2770s
	iters: 600, epoch: 1 | loss: 0.1426290
	speed: 0.1173s/iter; left time: 10421.6835s
	iters: 700, epoch: 1 | loss: 0.1221828
	speed: 0.1194s/iter; left time: 10599.4566s
	iters: 800, epoch: 1 | loss: 0.1188438
	speed: 0.1100s/iter; left time: 9748.9378s
	iters: 900, epoch: 1 | loss: 0.1083227
	speed: 0.1164s/iter; left time: 10306.3772s
	iters: 1000, epoch: 1 | loss: 0.1414768
	speed: 0.1181s/iter; left time: 10450.8120s
	iters: 1100, epoch: 1 | loss: 0.1065454
	speed: 0.1194s/iter; left time: 10553.2745s
	iters: 1200, epoch: 1 | loss: 0.1062137
	speed: 0.1160s/iter; left time: 10237.9912s
	iters: 1300, epoch: 1 | loss: 0.1094389
	speed: 0.1209s/iter; left time: 10656.9320s
	iters: 1400, epoch: 1 | loss: 0.1425477
	speed: 0.1170s/iter; left time: 10306.5998s
	iters: 1500, epoch: 1 | loss: 0.1190569
	speed: 0.1203s/iter; left time: 10578.8675s
	iters: 1600, epoch: 1 | loss: 0.1307243
	speed: 0.1175s/iter; left time: 10327.7661s
	iters: 1700, epoch: 1 | loss: 0.1101217
	speed: 0.1158s/iter; left time: 10165.8935s
	iters: 1800, epoch: 1 | loss: 0.1066481
	speed: 0.1168s/iter; left time: 10235.8467s
	iters: 1900, epoch: 1 | loss: 0.1185276
	speed: 0.1188s/iter; left time: 10399.7914s
	iters: 2000, epoch: 1 | loss: 0.1198424
	speed: 0.1118s/iter; left time: 9778.2014s
	iters: 2100, epoch: 1 | loss: 0.1289180
	speed: 0.1156s/iter; left time: 10096.3713s
	iters: 2200, epoch: 1 | loss: 0.1175074
	speed: 0.1172s/iter; left time: 10222.9627s
	iters: 2300, epoch: 1 | loss: 0.1311432
	speed: 0.1216s/iter; left time: 10596.7156s
	iters: 2400, epoch: 1 | loss: 0.1330000
	speed: 0.1184s/iter; left time: 10305.9827s
	iters: 2500, epoch: 1 | loss: 0.1254928
	speed: 0.1184s/iter; left time: 10299.5504s
	iters: 2600, epoch: 1 | loss: 0.1172541
	speed: 0.1183s/iter; left time: 10272.4490s
	iters: 2700, epoch: 1 | loss: 0.1503642
	speed: 0.1170s/iter; left time: 10152.3566s
	iters: 2800, epoch: 1 | loss: 0.1218206
	speed: 0.1193s/iter; left time: 10341.2122s
	iters: 2900, epoch: 1 | loss: 0.1123841
	speed: 0.1196s/iter; left time: 10353.4101s
	iters: 3000, epoch: 1 | loss: 0.1095140
	speed: 0.1198s/iter; left time: 10360.1082s
	iters: 3100, epoch: 1 | loss: 0.1169514
	speed: 0.1222s/iter; left time: 10555.3391s
	iters: 3200, epoch: 1 | loss: 0.1298743
	speed: 0.1197s/iter; left time: 10325.1203s
	iters: 3300, epoch: 1 | loss: 0.1165393
	speed: 0.1233s/iter; left time: 10622.9657s
	iters: 3400, epoch: 1 | loss: 0.0974565
	speed: 0.1217s/iter; left time: 10474.5007s
	iters: 3500, epoch: 1 | loss: 0.1041744
	speed: 0.1236s/iter; left time: 10620.6693s
	iters: 3600, epoch: 1 | loss: 0.0992299
	speed: 0.1231s/iter; left time: 10572.3640s
	iters: 3700, epoch: 1 | loss: 0.1239099
	speed: 0.1227s/iter; left time: 10524.0074s
	iters: 3800, epoch: 1 | loss: 0.0990040
	speed: 0.1242s/iter; left time: 10642.4687s
	iters: 3900, epoch: 1 | loss: 0.1218022
	speed: 0.1245s/iter; left time: 10655.7635s
	iters: 4000, epoch: 1 | loss: 0.0961539
	speed: 0.1249s/iter; left time: 10676.5093s
	iters: 4100, epoch: 1 | loss: 0.1266004
	speed: 0.1237s/iter; left time: 10561.9273s
	iters: 4200, epoch: 1 | loss: 0.1165152
	speed: 0.1205s/iter; left time: 10275.6515s
	iters: 4300, epoch: 1 | loss: 0.1041826
	speed: 0.1114s/iter; left time: 9484.2204s
	iters: 4400, epoch: 1 | loss: 0.1090055
	speed: 0.1152s/iter; left time: 9801.7413s
Epoch: 1 cost time: 00h:08m:52.60s
Epoch: 1 | Train Loss: 0.1213396 Vali Loss: 0.1232667 Test Loss: 0.1479476
Validation loss decreased (inf --> 0.123267).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.1373354
	speed: 1.6252s/iter; left time: 137957.5657s
	iters: 200, epoch: 2 | loss: 0.1157282
	speed: 0.1053s/iter; left time: 8929.5690s
	iters: 300, epoch: 2 | loss: 0.1186823
	speed: 0.1097s/iter; left time: 9286.5049s
	iters: 400, epoch: 2 | loss: 0.1171655
	speed: 0.0992s/iter; left time: 8390.7134s
	iters: 500, epoch: 2 | loss: 0.1352277
	speed: 0.1048s/iter; left time: 8850.3792s
	iters: 600, epoch: 2 | loss: 0.1214827
	speed: 0.1077s/iter; left time: 9087.7747s
	iters: 700, epoch: 2 | loss: 0.1123141
	speed: 0.1056s/iter; left time: 8898.3932s
	iters: 800, epoch: 2 | loss: 0.1030472
	speed: 0.1077s/iter; left time: 9069.4773s
	iters: 900, epoch: 2 | loss: 0.1189815
	speed: 0.1090s/iter; left time: 9169.2050s
	iters: 1000, epoch: 2 | loss: 0.1273633
	speed: 0.1075s/iter; left time: 9030.3800s
	iters: 1100, epoch: 2 | loss: 0.1186239
	speed: 0.1111s/iter; left time: 9321.8120s
	iters: 1200, epoch: 2 | loss: 0.1002740
	speed: 0.1056s/iter; left time: 8848.6784s
	iters: 1300, epoch: 2 | loss: 0.1090776
	speed: 0.1064s/iter; left time: 8904.2668s
	iters: 1400, epoch: 2 | loss: 0.1267764
	speed: 0.1088s/iter; left time: 9095.7492s
	iters: 1500, epoch: 2 | loss: 0.1032072
	speed: 0.1051s/iter; left time: 8772.7101s
	iters: 1600, epoch: 2 | loss: 0.1147069
	speed: 0.1093s/iter; left time: 9112.9068s
	iters: 1700, epoch: 2 | loss: 0.1185646
	speed: 0.1043s/iter; left time: 8686.1948s
	iters: 1800, epoch: 2 | loss: 0.0919052
	speed: 0.1061s/iter; left time: 8827.8832s
	iters: 1900, epoch: 2 | loss: 0.1263514
	speed: 0.1035s/iter; left time: 8597.2256s
	iters: 2000, epoch: 2 | loss: 0.1148299
	speed: 0.1074s/iter; left time: 8916.4972s
	iters: 2100, epoch: 2 | loss: 0.1236556
	speed: 0.1052s/iter; left time: 8716.8750s
	iters: 2200, epoch: 2 | loss: 0.1127978
	speed: 0.1105s/iter; left time: 9150.8093s
	iters: 2300, epoch: 2 | loss: 0.0918464
	speed: 0.1044s/iter; left time: 8632.4879s
	iters: 2400, epoch: 2 | loss: 0.1098604
	speed: 0.1088s/iter; left time: 8988.8185s
	iters: 2500, epoch: 2 | loss: 0.1160145
	speed: 0.1060s/iter; left time: 8745.7367s
	iters: 2600, epoch: 2 | loss: 0.1331852
	speed: 0.1073s/iter; left time: 8842.2601s
	iters: 2700, epoch: 2 | loss: 0.0922735
	speed: 0.1023s/iter; left time: 8418.5501s
	iters: 2800, epoch: 2 | loss: 0.1118323
	speed: 0.1027s/iter; left time: 8438.4606s
	iters: 2900, epoch: 2 | loss: 0.1124189
	speed: 0.1078s/iter; left time: 8851.2279s
	iters: 3000, epoch: 2 | loss: 0.1435691
	speed: 0.1032s/iter; left time: 8459.3364s
	iters: 3100, epoch: 2 | loss: 0.1239352
	speed: 0.1095s/iter; left time: 8969.4330s
	iters: 3200, epoch: 2 | loss: 0.1055086
	speed: 0.1061s/iter; left time: 8675.8780s
	iters: 3300, epoch: 2 | loss: 0.1100568
	speed: 0.1097s/iter; left time: 8965.1607s
	iters: 3400, epoch: 2 | loss: 0.1202246
	speed: 0.1047s/iter; left time: 8541.5707s
	iters: 3500, epoch: 2 | loss: 0.1090674
	speed: 0.1061s/iter; left time: 8642.5609s
	iters: 3600, epoch: 2 | loss: 0.1158136
	speed: 0.1045s/iter; left time: 8508.9976s
	iters: 3700, epoch: 2 | loss: 0.1121945
	speed: 0.1071s/iter; left time: 8705.8946s
	iters: 3800, epoch: 2 | loss: 0.0966658
	speed: 0.1079s/iter; left time: 8758.5712s
	iters: 3900, epoch: 2 | loss: 0.0989787
	speed: 0.1048s/iter; left time: 8495.3783s
	iters: 4000, epoch: 2 | loss: 0.1137499
	speed: 0.1074s/iter; left time: 8700.3233s
	iters: 4100, epoch: 2 | loss: 0.1053024
	speed: 0.1056s/iter; left time: 8543.3856s
	iters: 4200, epoch: 2 | loss: 0.1246223
	speed: 0.1080s/iter; left time: 8722.7086s
	iters: 4300, epoch: 2 | loss: 0.1095846
	speed: 0.1019s/iter; left time: 8221.0973s
	iters: 4400, epoch: 2 | loss: 0.1080796
	speed: 0.1051s/iter; left time: 8465.9405s
Epoch: 2 cost time: 00h:07m:55.95s
Epoch: 2 | Train Loss: 0.1117745 Vali Loss: 0.1218290 Test Loss: 0.1485942
Validation loss decreased (0.123267 --> 0.121829).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.1073814
	speed: 1.4114s/iter; left time: 113498.1080s
	iters: 200, epoch: 3 | loss: 0.1077686
	speed: 0.1066s/iter; left time: 8560.0081s
	iters: 300, epoch: 3 | loss: 0.1152448
	speed: 0.1063s/iter; left time: 8529.2180s
	iters: 400, epoch: 3 | loss: 0.1090948
	speed: 0.1083s/iter; left time: 8674.1726s
	iters: 500, epoch: 3 | loss: 0.1247426
	speed: 0.1057s/iter; left time: 8457.5316s
	iters: 600, epoch: 3 | loss: 0.1079610
	speed: 0.1063s/iter; left time: 8495.0244s
	iters: 700, epoch: 3 | loss: 0.0978039
	speed: 0.1015s/iter; left time: 8101.7318s
	iters: 800, epoch: 3 | loss: 0.1046700
	speed: 0.1065s/iter; left time: 8491.1226s
	iters: 900, epoch: 3 | loss: 0.1096871
	speed: 0.1093s/iter; left time: 8699.4375s
	iters: 1000, epoch: 3 | loss: 0.1161537
	speed: 0.1058s/iter; left time: 8415.1731s
	iters: 1100, epoch: 3 | loss: 0.1075704
	speed: 0.1060s/iter; left time: 8421.7693s
	iters: 1200, epoch: 3 | loss: 0.0993517
	speed: 0.1085s/iter; left time: 8607.9020s
	iters: 1300, epoch: 3 | loss: 0.1047531
	speed: 0.1059s/iter; left time: 8391.0421s
	iters: 1400, epoch: 3 | loss: 0.1217528
	speed: 0.1048s/iter; left time: 8289.6904s
	iters: 1500, epoch: 3 | loss: 0.1148034
	speed: 0.1097s/iter; left time: 8671.7472s
	iters: 1600, epoch: 3 | loss: 0.1048180
	speed: 0.1082s/iter; left time: 8541.0903s
	iters: 1700, epoch: 3 | loss: 0.1097087
	speed: 0.1065s/iter; left time: 8393.4404s
	iters: 1800, epoch: 3 | loss: 0.1012860
	speed: 0.1089s/iter; left time: 8569.7534s
	iters: 1900, epoch: 3 | loss: 0.1285569
	speed: 0.1107s/iter; left time: 8701.9393s
	iters: 2000, epoch: 3 | loss: 0.1124301
	speed: 0.1103s/iter; left time: 8661.1579s
	iters: 2100, epoch: 3 | loss: 0.1148856
	speed: 0.1060s/iter; left time: 8312.6979s
	iters: 2200, epoch: 3 | loss: 0.0905116
	speed: 0.1039s/iter; left time: 8133.1436s
	iters: 2300, epoch: 3 | loss: 0.1224068
	speed: 0.1103s/iter; left time: 8630.6263s
	iters: 2400, epoch: 3 | loss: 0.1213229
	speed: 0.1031s/iter; left time: 8051.0014s
	iters: 2500, epoch: 3 | loss: 0.1161782
	speed: 0.1136s/iter; left time: 8859.4862s
	iters: 2600, epoch: 3 | loss: 0.1238268
	speed: 0.1084s/iter; left time: 8444.4547s
	iters: 2700, epoch: 3 | loss: 0.1218241
	speed: 0.1141s/iter; left time: 8876.6183s
	iters: 2800, epoch: 3 | loss: 0.1076142
	speed: 0.1111s/iter; left time: 8631.2765s
	iters: 2900, epoch: 3 | loss: 0.1070125
	speed: 0.1054s/iter; left time: 8179.2377s
	iters: 3000, epoch: 3 | loss: 0.1054063
	speed: 0.1093s/iter; left time: 8474.4103s
	iters: 3100, epoch: 3 | loss: 0.0906125
	speed: 0.1092s/iter; left time: 8454.3057s
	iters: 3200, epoch: 3 | loss: 0.1038693
	speed: 0.1100s/iter; left time: 8501.2242s
	iters: 3300, epoch: 3 | loss: 0.0932214
	speed: 0.1023s/iter; left time: 7896.3574s
	iters: 3400, epoch: 3 | loss: 0.1064298
	speed: 0.1070s/iter; left time: 8255.0368s
	iters: 3500, epoch: 3 | loss: 0.1178679
	speed: 0.1087s/iter; left time: 8370.1033s
	iters: 3600, epoch: 3 | loss: 0.1058693
	speed: 0.1068s/iter; left time: 8216.2819s
	iters: 3700, epoch: 3 | loss: 0.1053510
	speed: 0.1035s/iter; left time: 7951.2590s
	iters: 3800, epoch: 3 | loss: 0.1111913
	speed: 0.1086s/iter; left time: 8335.0260s
	iters: 3900, epoch: 3 | loss: 0.1219772
	speed: 0.1066s/iter; left time: 8170.2211s
	iters: 4000, epoch: 3 | loss: 0.1169674
	speed: 0.1051s/iter; left time: 8043.9718s
	iters: 4100, epoch: 3 | loss: 0.1220436
	speed: 0.1082s/iter; left time: 8266.0103s
	iters: 4200, epoch: 3 | loss: 0.0994433
	speed: 0.1064s/iter; left time: 8118.7653s
	iters: 4300, epoch: 3 | loss: 0.1174926
	speed: 0.1058s/iter; left time: 8066.3382s
	iters: 4400, epoch: 3 | loss: 0.1029727
	speed: 0.1032s/iter; left time: 7851.9695s
Epoch: 3 cost time: 00h:08m:00.44s
Epoch: 3 | Train Loss: 0.1101085 Vali Loss: 0.1225816 Test Loss: 0.1483277
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.1163232
	speed: 1.3902s/iter; left time: 105574.8514s
	iters: 200, epoch: 4 | loss: 0.1172400
	speed: 0.1052s/iter; left time: 7979.3333s
	iters: 300, epoch: 4 | loss: 0.1053314
	speed: 0.1014s/iter; left time: 7683.8419s
	iters: 400, epoch: 4 | loss: 0.1159020
	speed: 0.1082s/iter; left time: 8184.8829s
	iters: 500, epoch: 4 | loss: 0.1131369
	speed: 0.1073s/iter; left time: 8103.7347s
	iters: 600, epoch: 4 | loss: 0.1101619
	speed: 0.1095s/iter; left time: 8259.0579s
	iters: 700, epoch: 4 | loss: 0.1124621
	speed: 0.1051s/iter; left time: 7918.2770s
	iters: 800, epoch: 4 | loss: 0.1200308
	speed: 0.1080s/iter; left time: 8122.9645s
	iters: 900, epoch: 4 | loss: 0.1239205
	speed: 0.0996s/iter; left time: 7487.8467s
	iters: 1000, epoch: 4 | loss: 0.1212897
	speed: 0.1060s/iter; left time: 7951.4048s
	iters: 1100, epoch: 4 | loss: 0.1169482
	speed: 0.1068s/iter; left time: 8000.2019s
	iters: 1200, epoch: 4 | loss: 0.0989428
	speed: 0.1103s/iter; left time: 8254.4950s
	iters: 1300, epoch: 4 | loss: 0.1034586
	speed: 0.1093s/iter; left time: 8167.2503s
	iters: 1400, epoch: 4 | loss: 0.1046819
	speed: 0.1049s/iter; left time: 7829.5851s
	iters: 1500, epoch: 4 | loss: 0.1052269
	speed: 0.1072s/iter; left time: 7993.7522s
	iters: 1600, epoch: 4 | loss: 0.1120703
	speed: 0.1058s/iter; left time: 7873.0954s
	iters: 1700, epoch: 4 | loss: 0.1059639
	speed: 0.1120s/iter; left time: 8326.0777s
	iters: 1800, epoch: 4 | loss: 0.0905024
	speed: 0.1119s/iter; left time: 8306.9460s
	iters: 1900, epoch: 4 | loss: 0.0942608
	speed: 0.1082s/iter; left time: 8025.5263s
	iters: 2000, epoch: 4 | loss: 0.1152182
	speed: 0.1061s/iter; left time: 7854.8691s
	iters: 2100, epoch: 4 | loss: 0.1152445
	speed: 0.1064s/iter; left time: 7869.0397s
	iters: 2200, epoch: 4 | loss: 0.1241190
	speed: 0.1049s/iter; left time: 7743.5570s
	iters: 2300, epoch: 4 | loss: 0.1150569
	speed: 0.1040s/iter; left time: 7667.1770s
	iters: 2400, epoch: 4 | loss: 0.0937953
	speed: 0.1090s/iter; left time: 8024.5135s
	iters: 2500, epoch: 4 | loss: 0.1057690
	speed: 0.1082s/iter; left time: 7954.1924s
	iters: 2600, epoch: 4 | loss: 0.1197121
	speed: 0.1095s/iter; left time: 8040.6101s
	iters: 2700, epoch: 4 | loss: 0.1218844
	speed: 0.1095s/iter; left time: 8028.6505s
	iters: 2800, epoch: 4 | loss: 0.1118397
	speed: 0.1071s/iter; left time: 7843.6559s
	iters: 2900, epoch: 4 | loss: 0.1214791
	speed: 0.1087s/iter; left time: 7953.8045s
	iters: 3000, epoch: 4 | loss: 0.0951268
	speed: 0.1071s/iter; left time: 7823.3377s
	iters: 3100, epoch: 4 | loss: 0.1038058
	speed: 0.1046s/iter; left time: 7629.2405s
	iters: 3200, epoch: 4 | loss: 0.1209671
	speed: 0.1118s/iter; left time: 8145.5158s
	iters: 3300, epoch: 4 | loss: 0.1161438
	speed: 0.1112s/iter; left time: 8090.8911s
	iters: 3400, epoch: 4 | loss: 0.1275270
	speed: 0.1061s/iter; left time: 7707.2413s
	iters: 3500, epoch: 4 | loss: 0.1004139
	speed: 0.1078s/iter; left time: 7822.1911s
	iters: 3600, epoch: 4 | loss: 0.1117803
	speed: 0.1035s/iter; left time: 7495.5683s
	iters: 3700, epoch: 4 | loss: 0.1009324
	speed: 0.1039s/iter; left time: 7517.2787s
	iters: 3800, epoch: 4 | loss: 0.1207588
	speed: 0.1094s/iter; left time: 7904.0515s
	iters: 3900, epoch: 4 | loss: 0.1000504
	speed: 0.1033s/iter; left time: 7449.6913s
	iters: 4000, epoch: 4 | loss: 0.0920369
	speed: 0.1054s/iter; left time: 7592.6974s
	iters: 4100, epoch: 4 | loss: 0.0991762
	speed: 0.1084s/iter; left time: 7795.7800s
	iters: 4200, epoch: 4 | loss: 0.0991054
	speed: 0.1024s/iter; left time: 7355.2127s
	iters: 4300, epoch: 4 | loss: 0.0927669
	speed: 0.1055s/iter; left time: 7566.6614s
	iters: 4400, epoch: 4 | loss: 0.1017505
	speed: 0.1043s/iter; left time: 7472.9461s
Epoch: 4 cost time: 00h:07m:57.80s
Epoch: 4 | Train Loss: 0.1083292 Vali Loss: 0.1215903 Test Loss: 0.1486534
Validation loss decreased (0.121829 --> 0.121590).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.1045664
	speed: 1.4170s/iter; left time: 101270.5476s
	iters: 200, epoch: 5 | loss: 0.1140283
	speed: 0.1071s/iter; left time: 7641.6778s
	iters: 300, epoch: 5 | loss: 0.1094048
	speed: 0.1077s/iter; left time: 7674.9133s
	iters: 400, epoch: 5 | loss: 0.1113927
	speed: 0.1065s/iter; left time: 7581.8474s
	iters: 500, epoch: 5 | loss: 0.1201597
	speed: 0.1049s/iter; left time: 7452.3135s
	iters: 600, epoch: 5 | loss: 0.0986795
	speed: 0.1046s/iter; left time: 7420.5370s
	iters: 700, epoch: 5 | loss: 0.1055745
	speed: 0.1063s/iter; left time: 7535.6783s
	iters: 800, epoch: 5 | loss: 0.1066505
	speed: 0.1145s/iter; left time: 8106.1170s
	iters: 900, epoch: 5 | loss: 0.1212705
	speed: 0.1070s/iter; left time: 7560.2260s
	iters: 1000, epoch: 5 | loss: 0.1213971
	speed: 0.1028s/iter; left time: 7254.0450s
	iters: 1100, epoch: 5 | loss: 0.1246218
	speed: 0.1091s/iter; left time: 7685.0141s
	iters: 1200, epoch: 5 | loss: 0.0953918
	speed: 0.1048s/iter; left time: 7374.1161s
	iters: 1300, epoch: 5 | loss: 0.1080353
	speed: 0.1040s/iter; left time: 7305.7016s
	iters: 1400, epoch: 5 | loss: 0.1139053
	speed: 0.1047s/iter; left time: 7347.1126s
	iters: 1500, epoch: 5 | loss: 0.1034893
	speed: 0.1097s/iter; left time: 7683.2607s
	iters: 1600, epoch: 5 | loss: 0.1069212
	speed: 0.1073s/iter; left time: 7506.5233s
	iters: 1700, epoch: 5 | loss: 0.1042794
	speed: 0.1095s/iter; left time: 7650.6211s
	iters: 1800, epoch: 5 | loss: 0.0975064
	speed: 0.1081s/iter; left time: 7545.0210s
	iters: 1900, epoch: 5 | loss: 0.0997893
	speed: 0.1116s/iter; left time: 7772.7529s
	iters: 2000, epoch: 5 | loss: 0.1189045
	speed: 0.1074s/iter; left time: 7475.0823s
	iters: 2100, epoch: 5 | loss: 0.0985344
	speed: 0.1089s/iter; left time: 7566.8525s
	iters: 2200, epoch: 5 | loss: 0.1044963
	speed: 0.1090s/iter; left time: 7558.6321s
	iters: 2300, epoch: 5 | loss: 0.0955015
	speed: 0.1061s/iter; left time: 7350.4122s
	iters: 2400, epoch: 5 | loss: 0.0906615
	speed: 0.1091s/iter; left time: 7543.3621s
	iters: 2500, epoch: 5 | loss: 0.1142124
	speed: 0.1090s/iter; left time: 7525.9499s
	iters: 2600, epoch: 5 | loss: 0.1056934
	speed: 0.1079s/iter; left time: 7441.6523s
	iters: 2700, epoch: 5 | loss: 0.0991283
	speed: 0.1083s/iter; left time: 7461.5399s
	iters: 2800, epoch: 5 | loss: 0.1261882
	speed: 0.1089s/iter; left time: 7488.7920s
	iters: 2900, epoch: 5 | loss: 0.1248673
	speed: 0.1096s/iter; left time: 7524.6232s
	iters: 3000, epoch: 5 | loss: 0.1106820
	speed: 0.1042s/iter; left time: 7143.1180s
	iters: 3100, epoch: 5 | loss: 0.0868233
	speed: 0.1076s/iter; left time: 7364.6034s
	iters: 3200, epoch: 5 | loss: 0.1209657
	speed: 0.1048s/iter; left time: 7165.2671s
	iters: 3300, epoch: 5 | loss: 0.1171299
	speed: 0.1077s/iter; left time: 7353.8246s
	iters: 3400, epoch: 5 | loss: 0.1117137
	speed: 0.1045s/iter; left time: 7125.2499s
	iters: 3500, epoch: 5 | loss: 0.1193861
	speed: 0.1083s/iter; left time: 7368.9425s
	iters: 3600, epoch: 5 | loss: 0.1158210
	speed: 0.1083s/iter; left time: 7363.0574s
	iters: 3700, epoch: 5 | loss: 0.0986645
	speed: 0.1099s/iter; left time: 7456.6559s
	iters: 3800, epoch: 5 | loss: 0.1102005
	speed: 0.1085s/iter; left time: 7352.9382s
	iters: 3900, epoch: 5 | loss: 0.1302816
	speed: 0.1057s/iter; left time: 7152.6720s
	iters: 4000, epoch: 5 | loss: 0.1082248
	speed: 0.1079s/iter; left time: 7290.3610s
	iters: 4100, epoch: 5 | loss: 0.1047803
	speed: 0.1089s/iter; left time: 7345.9116s
	iters: 4200, epoch: 5 | loss: 0.1059765
	speed: 0.1053s/iter; left time: 7091.0210s
	iters: 4300, epoch: 5 | loss: 0.0873054
	speed: 0.1079s/iter; left time: 7258.0964s
	iters: 4400, epoch: 5 | loss: 0.1012158
	speed: 0.1042s/iter; left time: 7001.3385s
Epoch: 5 cost time: 00h:08m:01.40s
Epoch: 5 | Train Loss: 0.1060327 Vali Loss: 0.1232200 Test Loss: 0.1516566
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.1077035
	speed: 1.4035s/iter; left time: 94030.2833s
	iters: 200, epoch: 6 | loss: 0.1206247
	speed: 0.1074s/iter; left time: 7184.5248s
	iters: 300, epoch: 6 | loss: 0.1046793
	speed: 0.1044s/iter; left time: 6971.7072s
	iters: 400, epoch: 6 | loss: 0.0925871
	speed: 0.1091s/iter; left time: 7278.2041s
	iters: 500, epoch: 6 | loss: 0.0974372
	speed: 0.1096s/iter; left time: 7299.0817s
	iters: 600, epoch: 6 | loss: 0.1108949
	speed: 0.1086s/iter; left time: 7223.8138s
	iters: 700, epoch: 6 | loss: 0.1134460
	speed: 0.1101s/iter; left time: 7309.6112s
	iters: 800, epoch: 6 | loss: 0.0946199
	speed: 0.1071s/iter; left time: 7103.3394s
	iters: 900, epoch: 6 | loss: 0.0851431
	speed: 0.1081s/iter; left time: 7154.9901s
	iters: 1000, epoch: 6 | loss: 0.1054931
	speed: 0.1100s/iter; left time: 7269.8564s
	iters: 1100, epoch: 6 | loss: 0.1074604
	speed: 0.1037s/iter; left time: 6845.8158s
	iters: 1200, epoch: 6 | loss: 0.0996368
	speed: 0.1108s/iter; left time: 7303.6716s
	iters: 1300, epoch: 6 | loss: 0.1049811
	speed: 0.1074s/iter; left time: 7064.6280s
	iters: 1400, epoch: 6 | loss: 0.1002386
	speed: 0.1093s/iter; left time: 7181.5366s
	iters: 1500, epoch: 6 | loss: 0.1112094
	speed: 0.1092s/iter; left time: 7161.1726s
	iters: 1600, epoch: 6 | loss: 0.0859496
	speed: 0.1080s/iter; left time: 7075.3391s
	iters: 1700, epoch: 6 | loss: 0.1008478
	speed: 0.1079s/iter; left time: 7057.9541s
	iters: 1800, epoch: 6 | loss: 0.1067413
	speed: 0.1082s/iter; left time: 7067.3598s
	iters: 1900, epoch: 6 | loss: 0.1091929
	speed: 0.1096s/iter; left time: 7148.6972s
	iters: 2000, epoch: 6 | loss: 0.1032816
	speed: 0.1079s/iter; left time: 7026.5516s
	iters: 2100, epoch: 6 | loss: 0.0979405
	speed: 0.1039s/iter; left time: 6751.1192s
	iters: 2200, epoch: 6 | loss: 0.1004898
	speed: 0.1035s/iter; left time: 6717.4816s
	iters: 2300, epoch: 6 | loss: 0.1015077
	speed: 0.1087s/iter; left time: 7045.5153s
	iters: 2400, epoch: 6 | loss: 0.1144938
	speed: 0.1025s/iter; left time: 6633.0213s
	iters: 2500, epoch: 6 | loss: 0.1002379
	speed: 0.1101s/iter; left time: 7114.1428s
	iters: 2600, epoch: 6 | loss: 0.1211278
	speed: 0.1075s/iter; left time: 6931.0536s
	iters: 2700, epoch: 6 | loss: 0.0977566
	speed: 0.1100s/iter; left time: 7086.3973s
	iters: 2800, epoch: 6 | loss: 0.1079447
	speed: 0.1057s/iter; left time: 6793.6288s
	iters: 2900, epoch: 6 | loss: 0.1073356
	speed: 0.1090s/iter; left time: 6994.3897s
	iters: 3000, epoch: 6 | loss: 0.1240855
	speed: 0.1067s/iter; left time: 6838.9963s
	iters: 3100, epoch: 6 | loss: 0.1030167
	speed: 0.1030s/iter; left time: 6590.1235s
	iters: 3200, epoch: 6 | loss: 0.1003815
	speed: 0.1048s/iter; left time: 6693.7532s
	iters: 3300, epoch: 6 | loss: 0.0925418
	speed: 0.1090s/iter; left time: 6953.9689s
	iters: 3400, epoch: 6 | loss: 0.1049529
	speed: 0.1094s/iter; left time: 6969.3809s
	iters: 3500, epoch: 6 | loss: 0.1082636
	speed: 0.1070s/iter; left time: 6802.9650s
	iters: 3600, epoch: 6 | loss: 0.0990641
	speed: 0.1055s/iter; left time: 6695.8233s
	iters: 3700, epoch: 6 | loss: 0.1075102
	speed: 0.1093s/iter; left time: 6930.3496s
	iters: 3800, epoch: 6 | loss: 0.0963298
	speed: 0.1073s/iter; left time: 6792.3152s
	iters: 3900, epoch: 6 | loss: 0.0935764
	speed: 0.1070s/iter; left time: 6760.9030s
	iters: 4000, epoch: 6 | loss: 0.1077523
	speed: 0.1069s/iter; left time: 6743.8358s
	iters: 4100, epoch: 6 | loss: 0.1060187
	speed: 0.1052s/iter; left time: 6627.6069s
	iters: 4200, epoch: 6 | loss: 0.0974801
	speed: 0.1114s/iter; left time: 7008.6623s
	iters: 4300, epoch: 6 | loss: 0.1071582
	speed: 0.1063s/iter; left time: 6674.0641s
	iters: 4400, epoch: 6 | loss: 0.1114140
	speed: 0.1048s/iter; left time: 6568.6052s
Epoch: 6 cost time: 00h:08m:01.53s
Epoch: 6 | Train Loss: 0.1031456 Vali Loss: 0.1234408 Test Loss: 0.1535768
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.1085103
	speed: 1.3971s/iter; left time: 87349.4317s
	iters: 200, epoch: 7 | loss: 0.0954523
	speed: 0.1077s/iter; left time: 6721.8729s
	iters: 300, epoch: 7 | loss: 0.1043126
	speed: 0.1081s/iter; left time: 6734.5693s
	iters: 400, epoch: 7 | loss: 0.0980591
	speed: 0.1057s/iter; left time: 6576.6214s
	iters: 500, epoch: 7 | loss: 0.1085198
	speed: 0.1074s/iter; left time: 6671.3621s
	iters: 600, epoch: 7 | loss: 0.1165193
	speed: 0.1090s/iter; left time: 6758.4967s
	iters: 700, epoch: 7 | loss: 0.0997535
	speed: 0.1054s/iter; left time: 6526.4705s
	iters: 800, epoch: 7 | loss: 0.1118336
	speed: 0.1088s/iter; left time: 6725.1179s
	iters: 900, epoch: 7 | loss: 0.1122482
	speed: 0.1045s/iter; left time: 6452.3190s
	iters: 1000, epoch: 7 | loss: 0.0908243
	speed: 0.1102s/iter; left time: 6790.8038s
	iters: 1100, epoch: 7 | loss: 0.1042221
	speed: 0.1037s/iter; left time: 6378.0513s
	iters: 1200, epoch: 7 | loss: 0.0784654
	speed: 0.1106s/iter; left time: 6791.1001s
	iters: 1300, epoch: 7 | loss: 0.1083403
	speed: 0.1066s/iter; left time: 6534.6632s
	iters: 1400, epoch: 7 | loss: 0.0916019
	speed: 0.1115s/iter; left time: 6827.2860s
	iters: 1500, epoch: 7 | loss: 0.1041972
	speed: 0.1087s/iter; left time: 6643.6646s
	iters: 1600, epoch: 7 | loss: 0.1050012
	speed: 0.1072s/iter; left time: 6542.1357s
	iters: 1700, epoch: 7 | loss: 0.0990551
	speed: 0.1104s/iter; left time: 6725.7379s
	iters: 1800, epoch: 7 | loss: 0.1112182
	speed: 0.1071s/iter; left time: 6513.3864s
	iters: 1900, epoch: 7 | loss: 0.0934280
	speed: 0.1108s/iter; left time: 6729.4060s
	iters: 2000, epoch: 7 | loss: 0.0962716
	speed: 0.1102s/iter; left time: 6680.9932s
	iters: 2100, epoch: 7 | loss: 0.0991424
	speed: 0.1107s/iter; left time: 6702.2612s
	iters: 2200, epoch: 7 | loss: 0.0782585
	speed: 0.1090s/iter; left time: 6583.4074s
	iters: 2300, epoch: 7 | loss: 0.0830829
	speed: 0.1090s/iter; left time: 6574.1501s
	iters: 2400, epoch: 7 | loss: 0.1002160
	speed: 0.1094s/iter; left time: 6590.2696s
	iters: 2500, epoch: 7 | loss: 0.0800429
	speed: 0.1082s/iter; left time: 6507.8364s
	iters: 2600, epoch: 7 | loss: 0.1001138
	speed: 0.1092s/iter; left time: 6554.4086s
	iters: 2700, epoch: 7 | loss: 0.1066886
	speed: 0.1124s/iter; left time: 6735.6474s
	iters: 2800, epoch: 7 | loss: 0.1104560
	speed: 0.1086s/iter; left time: 6498.8932s
	iters: 2900, epoch: 7 | loss: 0.1018884
	speed: 0.1014s/iter; left time: 6058.3551s
	iters: 3000, epoch: 7 | loss: 0.1037253
	speed: 0.0963s/iter; left time: 5740.6386s
	iters: 3100, epoch: 7 | loss: 0.1261247
	speed: 0.0961s/iter; left time: 5722.7381s
	iters: 3200, epoch: 7 | loss: 0.1097564
	speed: 0.1116s/iter; left time: 6630.2530s
	iters: 3300, epoch: 7 | loss: 0.0908472
	speed: 0.1141s/iter; left time: 6771.3907s
	iters: 3400, epoch: 7 | loss: 0.0831330
	speed: 0.1136s/iter; left time: 6726.1647s
	iters: 3500, epoch: 7 | loss: 0.0842484
	speed: 0.1135s/iter; left time: 6708.4212s
	iters: 3600, epoch: 7 | loss: 0.1124989
	speed: 0.1128s/iter; left time: 6655.2255s
	iters: 3700, epoch: 7 | loss: 0.1083518
	speed: 0.1097s/iter; left time: 6463.4231s
	iters: 3800, epoch: 7 | loss: 0.1133735
	speed: 0.1045s/iter; left time: 6144.8654s
	iters: 3900, epoch: 7 | loss: 0.0848982
	speed: 0.1061s/iter; left time: 6228.8058s
	iters: 4000, epoch: 7 | loss: 0.1067260
	speed: 0.1049s/iter; left time: 6148.3412s
	iters: 4100, epoch: 7 | loss: 0.0981014
	speed: 0.1032s/iter; left time: 6036.7361s
	iters: 4200, epoch: 7 | loss: 0.0832176
	speed: 0.1103s/iter; left time: 6443.1575s
	iters: 4300, epoch: 7 | loss: 0.1142252
	speed: 0.1051s/iter; left time: 6131.8096s
	iters: 4400, epoch: 7 | loss: 0.1292363
	speed: 0.1079s/iter; left time: 6283.6865s
Epoch: 7 cost time: 00h:08m:03.49s
Epoch: 7 | Train Loss: 0.1004053 Vali Loss: 0.1252791 Test Loss: 0.1567259
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0986653
	speed: 1.3887s/iter; left time: 80615.4066s
	iters: 200, epoch: 8 | loss: 0.0983105
	speed: 0.1070s/iter; left time: 6202.1602s
	iters: 300, epoch: 8 | loss: 0.1024780
	speed: 0.1065s/iter; left time: 6162.3177s
	iters: 400, epoch: 8 | loss: 0.1091874
	speed: 0.1058s/iter; left time: 6108.2424s
	iters: 500, epoch: 8 | loss: 0.0796972
	speed: 0.1044s/iter; left time: 6021.4761s
	iters: 600, epoch: 8 | loss: 0.1151457
	speed: 0.1078s/iter; left time: 6202.3343s
	iters: 700, epoch: 8 | loss: 0.0923439
	speed: 0.1044s/iter; left time: 5998.1825s
	iters: 800, epoch: 8 | loss: 0.0942501
	speed: 0.1056s/iter; left time: 6054.1411s
	iters: 900, epoch: 8 | loss: 0.0994631
	speed: 0.1035s/iter; left time: 5925.5695s
	iters: 1000, epoch: 8 | loss: 0.0976768
	speed: 0.1049s/iter; left time: 5994.5175s
	iters: 1100, epoch: 8 | loss: 0.0949048
	speed: 0.1066s/iter; left time: 6083.7003s
	iters: 1200, epoch: 8 | loss: 0.0971709
	speed: 0.1062s/iter; left time: 6049.0040s
	iters: 1300, epoch: 8 | loss: 0.0919779
	speed: 0.1087s/iter; left time: 6177.4734s
	iters: 1400, epoch: 8 | loss: 0.0921907
	speed: 0.1005s/iter; left time: 5705.4225s
	iters: 1500, epoch: 8 | loss: 0.1062825
	speed: 0.1044s/iter; left time: 5916.4223s
	iters: 1600, epoch: 8 | loss: 0.0986134
	speed: 0.1040s/iter; left time: 5881.4220s
	iters: 1700, epoch: 8 | loss: 0.0987850
	speed: 0.1087s/iter; left time: 6137.8484s
	iters: 1800, epoch: 8 | loss: 0.0880046
	speed: 0.1025s/iter; left time: 5777.4243s
	iters: 1900, epoch: 8 | loss: 0.0998610
	speed: 0.1077s/iter; left time: 6060.3033s
	iters: 2000, epoch: 8 | loss: 0.1191346
	speed: 0.1032s/iter; left time: 5796.0598s
	iters: 2100, epoch: 8 | loss: 0.0997336
	speed: 0.1071s/iter; left time: 6003.0262s
	iters: 2200, epoch: 8 | loss: 0.0977681
	speed: 0.1060s/iter; left time: 5929.8658s
	iters: 2300, epoch: 8 | loss: 0.0942919
	speed: 0.1015s/iter; left time: 5668.3825s
	iters: 2400, epoch: 8 | loss: 0.1181585
	speed: 0.1077s/iter; left time: 6002.0095s
	iters: 2500, epoch: 8 | loss: 0.0900528
	speed: 0.1019s/iter; left time: 5669.7670s
	iters: 2600, epoch: 8 | loss: 0.1048671
	speed: 0.1085s/iter; left time: 6028.8179s
	iters: 2700, epoch: 8 | loss: 0.0932050
	speed: 0.1105s/iter; left time: 6127.2632s
	iters: 2800, epoch: 8 | loss: 0.1049393
	speed: 0.1059s/iter; left time: 5859.5793s
	iters: 2900, epoch: 8 | loss: 0.0715457
	speed: 0.1100s/iter; left time: 6076.3097s
	iters: 3000, epoch: 8 | loss: 0.1109473
	speed: 0.1064s/iter; left time: 5870.6251s
	iters: 3100, epoch: 8 | loss: 0.0979033
	speed: 0.1070s/iter; left time: 5892.5974s
	iters: 3200, epoch: 8 | loss: 0.1071441
	speed: 0.1064s/iter; left time: 5847.0757s
	iters: 3300, epoch: 8 | loss: 0.0768796
	speed: 0.1068s/iter; left time: 5857.9075s
	iters: 3400, epoch: 8 | loss: 0.0921377
	speed: 0.1109s/iter; left time: 6069.4385s
	iters: 3500, epoch: 8 | loss: 0.0841669
	speed: 0.1046s/iter; left time: 5718.1633s
	iters: 3600, epoch: 8 | loss: 0.0960754
	speed: 0.1100s/iter; left time: 6002.2830s
	iters: 3700, epoch: 8 | loss: 0.0833702
	speed: 0.1091s/iter; left time: 5942.8118s
	iters: 3800, epoch: 8 | loss: 0.1056035
	speed: 0.1073s/iter; left time: 5829.5628s
	iters: 3900, epoch: 8 | loss: 0.1034919
	speed: 0.1085s/iter; left time: 5884.0160s
	iters: 4000, epoch: 8 | loss: 0.0962752
	speed: 0.1091s/iter; left time: 5909.0832s
	iters: 4100, epoch: 8 | loss: 0.0970299
	speed: 0.1030s/iter; left time: 5567.9175s
	iters: 4200, epoch: 8 | loss: 0.0906406
	speed: 0.1062s/iter; left time: 5728.8146s
	iters: 4300, epoch: 8 | loss: 0.0950922
	speed: 0.1062s/iter; left time: 5717.0580s
	iters: 4400, epoch: 8 | loss: 0.1170644
	speed: 0.1060s/iter; left time: 5696.4968s
Epoch: 8 cost time: 00h:07m:55.42s
Epoch: 8 | Train Loss: 0.0976592 Vali Loss: 0.1248156 Test Loss: 0.1552406
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.1081889
	speed: 1.3984s/iter; left time: 74921.6007s
	iters: 200, epoch: 9 | loss: 0.0912347
	speed: 0.1082s/iter; left time: 5787.3827s
	iters: 300, epoch: 9 | loss: 0.0898880
	speed: 0.1094s/iter; left time: 5838.8974s
	iters: 400, epoch: 9 | loss: 0.1006834
	speed: 0.1102s/iter; left time: 5872.0914s
	iters: 500, epoch: 9 | loss: 0.1055464
	speed: 0.1077s/iter; left time: 5727.9411s
	iters: 600, epoch: 9 | loss: 0.0820070
	speed: 0.1102s/iter; left time: 5849.4555s
	iters: 700, epoch: 9 | loss: 0.1049108
	speed: 0.1066s/iter; left time: 5646.1689s
	iters: 800, epoch: 9 | loss: 0.1005554
	speed: 0.1050s/iter; left time: 5552.1492s
	iters: 900, epoch: 9 | loss: 0.0876917
	speed: 0.1079s/iter; left time: 5696.0949s
	iters: 1000, epoch: 9 | loss: 0.0906235
	speed: 0.1055s/iter; left time: 5559.9999s
	iters: 1100, epoch: 9 | loss: 0.0937413
	speed: 0.1011s/iter; left time: 5317.8502s
	iters: 1200, epoch: 9 | loss: 0.1121209
	speed: 0.1073s/iter; left time: 5628.7097s
	iters: 1300, epoch: 9 | loss: 0.1008148
	speed: 0.1059s/iter; left time: 5546.6378s
	iters: 1400, epoch: 9 | loss: 0.0889356
	speed: 0.1017s/iter; left time: 5317.7008s
	iters: 1500, epoch: 9 | loss: 0.0898405
	speed: 0.1116s/iter; left time: 5822.3724s
	iters: 1600, epoch: 9 | loss: 0.0989260
	speed: 0.1074s/iter; left time: 5591.4003s
	iters: 1700, epoch: 9 | loss: 0.1049883
	speed: 0.1090s/iter; left time: 5663.6288s
	iters: 1800, epoch: 9 | loss: 0.0921862
	speed: 0.1057s/iter; left time: 5481.6351s
	iters: 1900, epoch: 9 | loss: 0.1090681
	speed: 0.1083s/iter; left time: 5608.5675s
	iters: 2000, epoch: 9 | loss: 0.0879408
	speed: 0.1095s/iter; left time: 5658.3337s
	iters: 2100, epoch: 9 | loss: 0.0999407
	speed: 0.1078s/iter; left time: 5562.2738s
	iters: 2200, epoch: 9 | loss: 0.0866363
	speed: 0.1113s/iter; left time: 5727.4817s
	iters: 2300, epoch: 9 | loss: 0.1170187
	speed: 0.1026s/iter; left time: 5271.4964s
	iters: 2400, epoch: 9 | loss: 0.0945719
	speed: 0.1057s/iter; left time: 5419.3406s
	iters: 2500, epoch: 9 | loss: 0.0903585
	speed: 0.1045s/iter; left time: 5349.5437s
	iters: 2600, epoch: 9 | loss: 0.0857023
	speed: 0.1057s/iter; left time: 5400.0068s
	iters: 2700, epoch: 9 | loss: 0.1100801
	speed: 0.1023s/iter; left time: 5212.4255s
	iters: 2800, epoch: 9 | loss: 0.0914453
	speed: 0.1075s/iter; left time: 5467.4288s
	iters: 2900, epoch: 9 | loss: 0.1086308
	speed: 0.1097s/iter; left time: 5567.7597s
	iters: 3000, epoch: 9 | loss: 0.1012945
	speed: 0.1082s/iter; left time: 5481.6941s
	iters: 3100, epoch: 9 | loss: 0.0891736
	speed: 0.1059s/iter; left time: 5353.9411s
	iters: 3200, epoch: 9 | loss: 0.0943430
	speed: 0.1087s/iter; left time: 5485.3078s
	iters: 3300, epoch: 9 | loss: 0.1029650
	speed: 0.1107s/iter; left time: 5574.2274s
	iters: 3400, epoch: 9 | loss: 0.0784484
	speed: 0.1102s/iter; left time: 5542.7671s
	iters: 3500, epoch: 9 | loss: 0.1020526
	speed: 0.1077s/iter; left time: 5406.4676s
	iters: 3600, epoch: 9 | loss: 0.0987637
	speed: 0.1053s/iter; left time: 5273.0119s
	iters: 3700, epoch: 9 | loss: 0.0952342
	speed: 0.1086s/iter; left time: 5426.0940s
	iters: 3800, epoch: 9 | loss: 0.1057804
	speed: 0.1071s/iter; left time: 5340.4882s
	iters: 3900, epoch: 9 | loss: 0.0955375
	speed: 0.1068s/iter; left time: 5316.8251s
	iters: 4000, epoch: 9 | loss: 0.0782716
	speed: 0.1136s/iter; left time: 5640.9163s
	iters: 4100, epoch: 9 | loss: 0.0951779
	speed: 0.1067s/iter; left time: 5290.7223s
	iters: 4200, epoch: 9 | loss: 0.0944427
	speed: 0.0983s/iter; left time: 4865.4189s
	iters: 4300, epoch: 9 | loss: 0.0884099
	speed: 0.1075s/iter; left time: 5310.1218s
	iters: 4400, epoch: 9 | loss: 0.1025119
	speed: 0.1111s/iter; left time: 5473.7040s
Epoch: 9 cost time: 00h:08m:00.48s
Epoch: 9 | Train Loss: 0.0950745 Vali Loss: 0.1270755 Test Loss: 0.1571813
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.04692179709672928, rmse:0.21661439538002014, mae:0.14865338802337646, rse:0.7507471442222595
success delete checkpoints
Intermediate time for GB and pred_len 168: 01h:32m:49.29s
Intermediate time for GB: 05h:13m:41.59s

=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
train 86331
val 18651
test 18651
[2024-11-02 13:55:28,723] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-02 13:55:29,733] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-02 13:55:29,733] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-02 13:55:29,733] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-02 13:55:29,819] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-02 13:55:29,819] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-02 13:55:30,452] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-02 13:55:30,453] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-02 13:55:30,453] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-02 13:55:30,454] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-02 13:55:30,454] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-02 13:55:30,454] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-02 13:55:30,455] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-02 13:55:30,455] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-02 13:55:30,455] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-02 13:55:30,455] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-02 13:55:30,811] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-02 13:55:30,812] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-02 13:55:30,813] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 114.85 GB, percent = 15.2%
[2024-11-02 13:55:30,939] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-02 13:55:30,940] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 13:55:30,940] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 114.85 GB, percent = 15.2%
[2024-11-02 13:55:30,940] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-02 13:55:31,057] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-02 13:55:31,058] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 13:55:31,058] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 114.85 GB, percent = 15.2%
[2024-11-02 13:55:31,059] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-02 13:55:31,059] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-02 13:55:31,059] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-02 13:55:31,059] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-02 13:55:31,060] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-02 13:55:31,060] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-02 13:55:31,060] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-02 13:55:31,060] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-02 13:55:31,060] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-02 13:55:31,060] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-02 13:55:31,060] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-02 13:55:31,060] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fd48878e3d0>
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-02 13:55:31,061] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-02 13:55:31,062] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-02 13:55:31,063] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1712448
	speed: 0.1613s/iter; left time: 8684.6738s
	iters: 200, epoch: 1 | loss: 0.2023432
	speed: 0.1201s/iter; left time: 6453.8491s
	iters: 300, epoch: 1 | loss: 0.1408175
	speed: 0.1178s/iter; left time: 6317.8376s
	iters: 400, epoch: 1 | loss: 0.1179628
	speed: 0.1235s/iter; left time: 6610.1309s
	iters: 500, epoch: 1 | loss: 0.0901266
	speed: 0.1234s/iter; left time: 6593.8340s
	iters: 600, epoch: 1 | loss: 0.0898690
	speed: 0.1213s/iter; left time: 6472.8916s
	iters: 700, epoch: 1 | loss: 0.0787271
	speed: 0.1163s/iter; left time: 6190.2511s
	iters: 800, epoch: 1 | loss: 0.1065296
	speed: 0.1186s/iter; left time: 6304.2562s
	iters: 900, epoch: 1 | loss: 0.0820746
	speed: 0.1241s/iter; left time: 6579.9415s
	iters: 1000, epoch: 1 | loss: 0.0925007
	speed: 0.1162s/iter; left time: 6153.6498s
	iters: 1100, epoch: 1 | loss: 0.0864945
	speed: 0.1213s/iter; left time: 6410.4135s
	iters: 1200, epoch: 1 | loss: 0.0853928
	speed: 0.1245s/iter; left time: 6563.8128s
	iters: 1300, epoch: 1 | loss: 0.0853296
	speed: 0.1227s/iter; left time: 6456.6093s
	iters: 1400, epoch: 1 | loss: 0.0815412
	speed: 0.1212s/iter; left time: 6365.9414s
	iters: 1500, epoch: 1 | loss: 0.0878881
	speed: 0.1242s/iter; left time: 6513.1136s
	iters: 1600, epoch: 1 | loss: 0.0781828
	speed: 0.1190s/iter; left time: 6227.6744s
	iters: 1700, epoch: 1 | loss: 0.0933578
	speed: 0.1215s/iter; left time: 6345.8813s
	iters: 1800, epoch: 1 | loss: 0.0840652
	speed: 0.1187s/iter; left time: 6191.7086s
	iters: 1900, epoch: 1 | loss: 0.0744049
	speed: 0.1190s/iter; left time: 6195.1130s
	iters: 2000, epoch: 1 | loss: 0.0831344
	speed: 0.1154s/iter; left time: 5995.7890s
	iters: 2100, epoch: 1 | loss: 0.0764061
	speed: 0.1185s/iter; left time: 6145.6551s
	iters: 2200, epoch: 1 | loss: 0.0826099
	speed: 0.1246s/iter; left time: 6444.6799s
	iters: 2300, epoch: 1 | loss: 0.0772082
	speed: 0.1175s/iter; left time: 6069.2087s
	iters: 2400, epoch: 1 | loss: 0.0781461
	speed: 0.1212s/iter; left time: 6245.1723s
	iters: 2500, epoch: 1 | loss: 0.0887459
	speed: 0.1202s/iter; left time: 6184.5045s
	iters: 2600, epoch: 1 | loss: 0.0926115
	speed: 0.1213s/iter; left time: 6225.8487s
Epoch: 1 cost time: 00h:05m:25.87s
Epoch: 1 | Train Loss: 0.1003548 Vali Loss: 0.0686999 Test Loss: 0.0770876
Validation loss decreased (inf --> 0.068700).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0797757
	speed: 1.1321s/iter; left time: 57899.3057s
	iters: 200, epoch: 2 | loss: 0.0827035
	speed: 0.1055s/iter; left time: 5382.8729s
	iters: 300, epoch: 2 | loss: 0.0977232
	speed: 0.1085s/iter; left time: 5525.9815s
	iters: 400, epoch: 2 | loss: 0.0749713
	speed: 0.1031s/iter; left time: 5244.2386s
	iters: 500, epoch: 2 | loss: 0.0862913
	speed: 0.1044s/iter; left time: 5298.2570s
	iters: 600, epoch: 2 | loss: 0.0929019
	speed: 0.1039s/iter; left time: 5260.8256s
	iters: 700, epoch: 2 | loss: 0.0713457
	speed: 0.1070s/iter; left time: 5410.1494s
	iters: 800, epoch: 2 | loss: 0.0867402
	speed: 0.1100s/iter; left time: 5549.3582s
	iters: 900, epoch: 2 | loss: 0.0903707
	speed: 0.1077s/iter; left time: 5421.1584s
	iters: 1000, epoch: 2 | loss: 0.0810028
	speed: 0.1094s/iter; left time: 5498.9982s
	iters: 1100, epoch: 2 | loss: 0.0841704
	speed: 0.1074s/iter; left time: 5383.8395s
	iters: 1200, epoch: 2 | loss: 0.0849176
	speed: 0.1061s/iter; left time: 5308.9948s
	iters: 1300, epoch: 2 | loss: 0.0906385
	speed: 0.1059s/iter; left time: 5289.1828s
	iters: 1400, epoch: 2 | loss: 0.0782810
	speed: 0.1071s/iter; left time: 5340.6999s
	iters: 1500, epoch: 2 | loss: 0.0824517
	speed: 0.1119s/iter; left time: 5564.5417s
	iters: 1600, epoch: 2 | loss: 0.0916397
	speed: 0.1071s/iter; left time: 5316.0470s
	iters: 1700, epoch: 2 | loss: 0.0733048
	speed: 0.1027s/iter; left time: 5087.5426s
	iters: 1800, epoch: 2 | loss: 0.0718356
	speed: 0.1049s/iter; left time: 5185.6725s
	iters: 1900, epoch: 2 | loss: 0.0834526
	speed: 0.1045s/iter; left time: 5157.8781s
	iters: 2000, epoch: 2 | loss: 0.0808225
	speed: 0.1083s/iter; left time: 5333.7927s
	iters: 2100, epoch: 2 | loss: 0.0826184
	speed: 0.1001s/iter; left time: 4919.7559s
	iters: 2200, epoch: 2 | loss: 0.0727913
	speed: 0.1052s/iter; left time: 5157.3315s
	iters: 2300, epoch: 2 | loss: 0.0784774
	speed: 0.1051s/iter; left time: 5142.4298s
	iters: 2400, epoch: 2 | loss: 0.0701629
	speed: 0.1095s/iter; left time: 5348.5788s
	iters: 2500, epoch: 2 | loss: 0.0810242
	speed: 0.1046s/iter; left time: 5099.7382s
	iters: 2600, epoch: 2 | loss: 0.0680333
	speed: 0.1039s/iter; left time: 5052.3724s
Epoch: 2 cost time: 00h:04m:47.49s
Epoch: 2 | Train Loss: 0.0786239 Vali Loss: 0.0661815 Test Loss: 0.0743510
Validation loss decreased (0.068700 --> 0.066182).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0761278
	speed: 0.9867s/iter; left time: 47803.7469s
	iters: 200, epoch: 3 | loss: 0.0774389
	speed: 0.1055s/iter; left time: 5100.0690s
	iters: 300, epoch: 3 | loss: 0.0796090
	speed: 0.1107s/iter; left time: 5339.9299s
	iters: 400, epoch: 3 | loss: 0.0677147
	speed: 0.1045s/iter; left time: 5033.4590s
	iters: 500, epoch: 3 | loss: 0.0734856
	speed: 0.1086s/iter; left time: 5219.7809s
	iters: 600, epoch: 3 | loss: 0.0857239
	speed: 0.1067s/iter; left time: 5115.9864s
	iters: 700, epoch: 3 | loss: 0.0681393
	speed: 0.1084s/iter; left time: 5184.6248s
	iters: 800, epoch: 3 | loss: 0.0724246
	speed: 0.1068s/iter; left time: 5097.0364s
	iters: 900, epoch: 3 | loss: 0.0910780
	speed: 0.1055s/iter; left time: 5026.2883s
	iters: 1000, epoch: 3 | loss: 0.0728555
	speed: 0.1088s/iter; left time: 5175.3988s
	iters: 1100, epoch: 3 | loss: 0.0870226
	speed: 0.1051s/iter; left time: 4985.4615s
	iters: 1200, epoch: 3 | loss: 0.0779801
	speed: 0.1072s/iter; left time: 5077.1261s
	iters: 1300, epoch: 3 | loss: 0.0614597
	speed: 0.1076s/iter; left time: 5083.3829s
	iters: 1400, epoch: 3 | loss: 0.0864894
	speed: 0.1089s/iter; left time: 5134.2734s
	iters: 1500, epoch: 3 | loss: 0.0696164
	speed: 0.1022s/iter; left time: 4809.6830s
	iters: 1600, epoch: 3 | loss: 0.0833256
	speed: 0.1075s/iter; left time: 5047.4433s
	iters: 1700, epoch: 3 | loss: 0.0790411
	speed: 0.1090s/iter; left time: 5106.4661s
	iters: 1800, epoch: 3 | loss: 0.0904982
	speed: 0.1093s/iter; left time: 5111.1672s
	iters: 1900, epoch: 3 | loss: 0.0717343
	speed: 0.1096s/iter; left time: 5113.7256s
	iters: 2000, epoch: 3 | loss: 0.0635259
	speed: 0.1064s/iter; left time: 4951.5607s
	iters: 2100, epoch: 3 | loss: 0.0628298
	speed: 0.1118s/iter; left time: 5192.2139s
	iters: 2200, epoch: 3 | loss: 0.0658889
	speed: 0.1083s/iter; left time: 5019.2886s
	iters: 2300, epoch: 3 | loss: 0.0762297
	speed: 0.1085s/iter; left time: 5019.5641s
	iters: 2400, epoch: 3 | loss: 0.0619692
	speed: 0.1069s/iter; left time: 4933.1645s
	iters: 2500, epoch: 3 | loss: 0.0707970
	speed: 0.1029s/iter; left time: 4736.3141s
	iters: 2600, epoch: 3 | loss: 0.0759995
	speed: 0.1077s/iter; left time: 4947.2761s
Epoch: 3 cost time: 00h:04m:50.10s
Epoch: 3 | Train Loss: 0.0745886 Vali Loss: 0.0614387 Test Loss: 0.0695850
Validation loss decreased (0.066182 --> 0.061439).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0740035
	speed: 0.9679s/iter; left time: 44283.2179s
	iters: 200, epoch: 4 | loss: 0.0772850
	speed: 0.1074s/iter; left time: 4900.6231s
	iters: 300, epoch: 4 | loss: 0.0706134
	speed: 0.1053s/iter; left time: 4795.4921s
	iters: 400, epoch: 4 | loss: 0.0690192
	speed: 0.1057s/iter; left time: 4804.5128s
	iters: 500, epoch: 4 | loss: 0.0804873
	speed: 0.1013s/iter; left time: 4594.0107s
	iters: 600, epoch: 4 | loss: 0.0721374
	speed: 0.1108s/iter; left time: 5015.3915s
	iters: 700, epoch: 4 | loss: 0.0607685
	speed: 0.1113s/iter; left time: 5023.6644s
	iters: 800, epoch: 4 | loss: 0.0716907
	speed: 0.1018s/iter; left time: 4588.0548s
	iters: 900, epoch: 4 | loss: 0.0583386
	speed: 0.1101s/iter; left time: 4949.3779s
	iters: 1000, epoch: 4 | loss: 0.0691884
	speed: 0.1091s/iter; left time: 4894.8875s
	iters: 1100, epoch: 4 | loss: 0.0729936
	speed: 0.1058s/iter; left time: 4735.7368s
	iters: 1200, epoch: 4 | loss: 0.0830592
	speed: 0.1080s/iter; left time: 4820.6197s
	iters: 1300, epoch: 4 | loss: 0.0928226
	speed: 0.1067s/iter; left time: 4751.9578s
	iters: 1400, epoch: 4 | loss: 0.0729482
	speed: 0.1092s/iter; left time: 4853.6016s
	iters: 1500, epoch: 4 | loss: 0.0764900
	speed: 0.1073s/iter; left time: 4759.7122s
	iters: 1600, epoch: 4 | loss: 0.0752271
	speed: 0.1103s/iter; left time: 4882.1301s
	iters: 1700, epoch: 4 | loss: 0.0638424
	speed: 0.1099s/iter; left time: 4851.0980s
	iters: 1800, epoch: 4 | loss: 0.0620330
	speed: 0.1105s/iter; left time: 4866.3266s
	iters: 1900, epoch: 4 | loss: 0.0701117
	speed: 0.1043s/iter; left time: 4581.8071s
	iters: 2000, epoch: 4 | loss: 0.0681855
	speed: 0.1073s/iter; left time: 4706.3663s
	iters: 2100, epoch: 4 | loss: 0.0762056
	speed: 0.1052s/iter; left time: 4600.4788s
	iters: 2200, epoch: 4 | loss: 0.0690991
	speed: 0.1053s/iter; left time: 4596.0362s
	iters: 2300, epoch: 4 | loss: 0.0679242
	speed: 0.1066s/iter; left time: 4643.4121s
	iters: 2400, epoch: 4 | loss: 0.0739057
	speed: 0.1058s/iter; left time: 4597.1895s
	iters: 2500, epoch: 4 | loss: 0.0679740
	speed: 0.1057s/iter; left time: 4584.1439s
	iters: 2600, epoch: 4 | loss: 0.0779216
	speed: 0.1067s/iter; left time: 4616.2239s
Epoch: 4 cost time: 00h:04m:49.39s
Epoch: 4 | Train Loss: 0.0718865 Vali Loss: 0.0601031 Test Loss: 0.0689823
Validation loss decreased (0.061439 --> 0.060103).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0688475
	speed: 0.9751s/iter; left time: 41981.7101s
	iters: 200, epoch: 5 | loss: 0.0738413
	speed: 0.1063s/iter; left time: 4565.6181s
	iters: 300, epoch: 5 | loss: 0.0718522
	speed: 0.1099s/iter; left time: 4707.6271s
	iters: 400, epoch: 5 | loss: 0.0661217
	speed: 0.1075s/iter; left time: 4598.0354s
	iters: 500, epoch: 5 | loss: 0.0626277
	speed: 0.1086s/iter; left time: 4632.2707s
	iters: 600, epoch: 5 | loss: 0.0671054
	speed: 0.1065s/iter; left time: 4532.0856s
	iters: 700, epoch: 5 | loss: 0.0719781
	speed: 0.1053s/iter; left time: 4472.0714s
	iters: 800, epoch: 5 | loss: 0.0713939
	speed: 0.1057s/iter; left time: 4474.6205s
	iters: 900, epoch: 5 | loss: 0.0793560
	speed: 0.1075s/iter; left time: 4543.0394s
	iters: 1000, epoch: 5 | loss: 0.0704821
	speed: 0.1057s/iter; left time: 4457.0025s
	iters: 1100, epoch: 5 | loss: 0.0659771
	speed: 0.1056s/iter; left time: 4442.2638s
	iters: 1200, epoch: 5 | loss: 0.0808677
	speed: 0.1117s/iter; left time: 4684.9370s
	iters: 1300, epoch: 5 | loss: 0.0577165
	speed: 0.1059s/iter; left time: 4433.9060s
	iters: 1400, epoch: 5 | loss: 0.0701355
	speed: 0.1056s/iter; left time: 4407.8319s
	iters: 1500, epoch: 5 | loss: 0.0783938
	speed: 0.1061s/iter; left time: 4420.4042s
	iters: 1600, epoch: 5 | loss: 0.0703886
	speed: 0.1086s/iter; left time: 4513.3542s
	iters: 1700, epoch: 5 | loss: 0.0750756
	speed: 0.1106s/iter; left time: 4585.5776s
	iters: 1800, epoch: 5 | loss: 0.0745274
	speed: 0.1045s/iter; left time: 4321.2924s
	iters: 1900, epoch: 5 | loss: 0.0632909
	speed: 0.1065s/iter; left time: 4392.0168s
	iters: 2000, epoch: 5 | loss: 0.0572714
	speed: 0.1027s/iter; left time: 4225.5792s
	iters: 2100, epoch: 5 | loss: 0.0697682
	speed: 0.1047s/iter; left time: 4296.4321s
	iters: 2200, epoch: 5 | loss: 0.0775003
	speed: 0.1066s/iter; left time: 4364.6123s
	iters: 2300, epoch: 5 | loss: 0.0681202
	speed: 0.1059s/iter; left time: 4325.2325s
	iters: 2400, epoch: 5 | loss: 0.0675049
	speed: 0.1107s/iter; left time: 4509.7213s
	iters: 2500, epoch: 5 | loss: 0.0756652
	speed: 0.1064s/iter; left time: 4325.3102s
	iters: 2600, epoch: 5 | loss: 0.0688920
	speed: 0.1081s/iter; left time: 4385.1994s
Epoch: 5 cost time: 00h:04m:48.80s
Epoch: 5 | Train Loss: 0.0703978 Vali Loss: 0.0614755 Test Loss: 0.0700821
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0642571
	speed: 0.9516s/iter; left time: 38401.7352s
	iters: 200, epoch: 6 | loss: 0.0717407
	speed: 0.1097s/iter; left time: 4415.2552s
	iters: 300, epoch: 6 | loss: 0.0590067
	speed: 0.1089s/iter; left time: 4373.4624s
	iters: 400, epoch: 6 | loss: 0.0612367
	speed: 0.1097s/iter; left time: 4394.4029s
	iters: 500, epoch: 6 | loss: 0.0722813
	speed: 0.1082s/iter; left time: 4321.3869s
	iters: 600, epoch: 6 | loss: 0.0766656
	speed: 0.1096s/iter; left time: 4366.7746s
	iters: 700, epoch: 6 | loss: 0.0786778
	speed: 0.1089s/iter; left time: 4328.6553s
	iters: 800, epoch: 6 | loss: 0.0702733
	speed: 0.1044s/iter; left time: 4141.1896s
	iters: 900, epoch: 6 | loss: 0.0562902
	speed: 0.1085s/iter; left time: 4291.9032s
	iters: 1000, epoch: 6 | loss: 0.0571464
	speed: 0.1066s/iter; left time: 4205.6505s
	iters: 1100, epoch: 6 | loss: 0.0545283
	speed: 0.1085s/iter; left time: 4269.9388s
	iters: 1200, epoch: 6 | loss: 0.0686143
	speed: 0.1105s/iter; left time: 4337.5885s
	iters: 1300, epoch: 6 | loss: 0.0655344
	speed: 0.1104s/iter; left time: 4324.0077s
	iters: 1400, epoch: 6 | loss: 0.0677483
	speed: 0.1075s/iter; left time: 4198.1122s
	iters: 1500, epoch: 6 | loss: 0.0722037
	speed: 0.1065s/iter; left time: 4146.9597s
	iters: 1600, epoch: 6 | loss: 0.0698562
	speed: 0.1077s/iter; left time: 4183.5869s
	iters: 1700, epoch: 6 | loss: 0.0730506
	speed: 0.1072s/iter; left time: 4154.0216s
	iters: 1800, epoch: 6 | loss: 0.0689412
	speed: 0.1093s/iter; left time: 4225.8563s
	iters: 1900, epoch: 6 | loss: 0.0618468
	speed: 0.1071s/iter; left time: 4131.1059s
	iters: 2000, epoch: 6 | loss: 0.0735297
	speed: 0.1109s/iter; left time: 4265.9072s
	iters: 2100, epoch: 6 | loss: 0.0774064
	speed: 0.1104s/iter; left time: 4235.9062s
	iters: 2200, epoch: 6 | loss: 0.0620106
	speed: 0.1078s/iter; left time: 4123.6705s
	iters: 2300, epoch: 6 | loss: 0.0610147
	speed: 0.1113s/iter; left time: 4245.3779s
	iters: 2400, epoch: 6 | loss: 0.0655296
	speed: 0.1088s/iter; left time: 4139.2595s
	iters: 2500, epoch: 6 | loss: 0.0643461
	speed: 0.1184s/iter; left time: 4495.1187s
	iters: 2600, epoch: 6 | loss: 0.0650501
	speed: 0.1208s/iter; left time: 4572.8638s
Epoch: 6 cost time: 00h:04m:56.77s
Epoch: 6 | Train Loss: 0.0693189 Vali Loss: 0.0591683 Test Loss: 0.0672605
Validation loss decreased (0.060103 --> 0.059168).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0697974
	speed: 0.9952s/iter; left time: 37476.9033s
	iters: 200, epoch: 7 | loss: 0.0755775
	speed: 0.1059s/iter; left time: 3977.0852s
	iters: 300, epoch: 7 | loss: 0.0618644
	speed: 0.1065s/iter; left time: 3990.2135s
	iters: 400, epoch: 7 | loss: 0.0668553
	speed: 0.1030s/iter; left time: 3846.8323s
	iters: 500, epoch: 7 | loss: 0.0719296
	speed: 0.1103s/iter; left time: 4109.9221s
	iters: 600, epoch: 7 | loss: 0.0714099
	speed: 0.1059s/iter; left time: 3934.2465s
	iters: 700, epoch: 7 | loss: 0.0720902
	speed: 0.1040s/iter; left time: 3855.2449s
	iters: 800, epoch: 7 | loss: 0.0795342
	speed: 0.1064s/iter; left time: 3932.9802s
	iters: 900, epoch: 7 | loss: 0.0655722
	speed: 0.1070s/iter; left time: 3943.9740s
	iters: 1000, epoch: 7 | loss: 0.0711685
	speed: 0.1080s/iter; left time: 3968.4331s
	iters: 1100, epoch: 7 | loss: 0.0755553
	speed: 0.1060s/iter; left time: 3887.0493s
	iters: 1200, epoch: 7 | loss: 0.0766494
	speed: 0.1044s/iter; left time: 3815.7570s
	iters: 1300, epoch: 7 | loss: 0.0651874
	speed: 0.1074s/iter; left time: 3917.2365s
	iters: 1400, epoch: 7 | loss: 0.0650540
	speed: 0.1055s/iter; left time: 3836.7274s
	iters: 1500, epoch: 7 | loss: 0.0855093
	speed: 0.1028s/iter; left time: 3725.6440s
	iters: 1600, epoch: 7 | loss: 0.0753963
	speed: 0.1103s/iter; left time: 3988.5567s
	iters: 1700, epoch: 7 | loss: 0.0613949
	speed: 0.1048s/iter; left time: 3779.8557s
	iters: 1800, epoch: 7 | loss: 0.0692656
	speed: 0.1026s/iter; left time: 3689.8381s
	iters: 1900, epoch: 7 | loss: 0.0711877
	speed: 0.1039s/iter; left time: 3723.9673s
	iters: 2000, epoch: 7 | loss: 0.0700283
	speed: 0.1074s/iter; left time: 3842.0613s
	iters: 2100, epoch: 7 | loss: 0.0562870
	speed: 0.1044s/iter; left time: 3721.6851s
	iters: 2200, epoch: 7 | loss: 0.0848084
	speed: 0.1066s/iter; left time: 3788.9110s
	iters: 2300, epoch: 7 | loss: 0.0658100
	speed: 0.1067s/iter; left time: 3784.0007s
	iters: 2400, epoch: 7 | loss: 0.0565042
	speed: 0.1054s/iter; left time: 3727.2828s
	iters: 2500, epoch: 7 | loss: 0.0774072
	speed: 0.1059s/iter; left time: 3734.5611s
	iters: 2600, epoch: 7 | loss: 0.0680225
	speed: 0.1102s/iter; left time: 3874.4911s
Epoch: 7 cost time: 00h:04m:46.58s
Epoch: 7 | Train Loss: 0.0684043 Vali Loss: 0.0598554 Test Loss: 0.0685234
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0863287
	speed: 0.9523s/iter; left time: 33295.2367s
	iters: 200, epoch: 8 | loss: 0.0786934
	speed: 0.1030s/iter; left time: 3590.2538s
	iters: 300, epoch: 8 | loss: 0.0739644
	speed: 0.1023s/iter; left time: 3556.8383s
	iters: 400, epoch: 8 | loss: 0.0589355
	speed: 0.1054s/iter; left time: 3652.8755s
	iters: 500, epoch: 8 | loss: 0.0686779
	speed: 0.1068s/iter; left time: 3692.0885s
	iters: 600, epoch: 8 | loss: 0.0584960
	speed: 0.1051s/iter; left time: 3621.0724s
	iters: 700, epoch: 8 | loss: 0.0871281
	speed: 0.1059s/iter; left time: 3637.8838s
	iters: 800, epoch: 8 | loss: 0.0599374
	speed: 0.1125s/iter; left time: 3855.8626s
	iters: 900, epoch: 8 | loss: 0.0789052
	speed: 0.1069s/iter; left time: 3652.5201s
	iters: 1000, epoch: 8 | loss: 0.0873202
	speed: 0.1076s/iter; left time: 3665.3601s
	iters: 1100, epoch: 8 | loss: 0.0671721
	speed: 0.1031s/iter; left time: 3501.1413s
	iters: 1200, epoch: 8 | loss: 0.0676801
	speed: 0.1005s/iter; left time: 3403.1546s
	iters: 1300, epoch: 8 | loss: 0.0818329
	speed: 0.1073s/iter; left time: 3622.8143s
	iters: 1400, epoch: 8 | loss: 0.0655170
	speed: 0.1114s/iter; left time: 3748.8925s
	iters: 1500, epoch: 8 | loss: 0.0690930
	speed: 0.1100s/iter; left time: 3691.2117s
	iters: 1600, epoch: 8 | loss: 0.0599412
	speed: 0.0992s/iter; left time: 3319.3962s
	iters: 1700, epoch: 8 | loss: 0.0730805
	speed: 0.1004s/iter; left time: 3350.1140s
	iters: 1800, epoch: 8 | loss: 0.0648698
	speed: 0.1098s/iter; left time: 3650.7728s
	iters: 1900, epoch: 8 | loss: 0.0638596
	speed: 0.1068s/iter; left time: 3541.0975s
	iters: 2000, epoch: 8 | loss: 0.0609560
	speed: 0.1096s/iter; left time: 3623.0832s
	iters: 2100, epoch: 8 | loss: 0.0601996
	speed: 0.1109s/iter; left time: 3654.6756s
	iters: 2200, epoch: 8 | loss: 0.0709287
	speed: 0.1060s/iter; left time: 3484.5731s
	iters: 2300, epoch: 8 | loss: 0.0781172
	speed: 0.1091s/iter; left time: 3575.7529s
	iters: 2400, epoch: 8 | loss: 0.0663429
	speed: 0.1096s/iter; left time: 3580.6048s
	iters: 2500, epoch: 8 | loss: 0.0782741
	speed: 0.1062s/iter; left time: 3458.0091s
	iters: 2600, epoch: 8 | loss: 0.0815893
	speed: 0.1087s/iter; left time: 3528.7187s
Epoch: 8 cost time: 00h:04m:47.72s
Epoch: 8 | Train Loss: 0.0677572 Vali Loss: 0.0597144 Test Loss: 0.0685009
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.0733084
	speed: 0.9591s/iter; left time: 30946.8273s
	iters: 200, epoch: 9 | loss: 0.0649616
	speed: 0.1070s/iter; left time: 3441.7858s
	iters: 300, epoch: 9 | loss: 0.0522117
	speed: 0.1106s/iter; left time: 3547.7316s
	iters: 400, epoch: 9 | loss: 0.0659156
	speed: 0.1058s/iter; left time: 3381.2549s
	iters: 500, epoch: 9 | loss: 0.0653602
	speed: 0.1022s/iter; left time: 3255.7305s
	iters: 600, epoch: 9 | loss: 0.0684405
	speed: 0.1054s/iter; left time: 3348.4559s
	iters: 700, epoch: 9 | loss: 0.0707613
	speed: 0.1071s/iter; left time: 3391.6700s
	iters: 800, epoch: 9 | loss: 0.0594048
	speed: 0.1084s/iter; left time: 3421.7803s
	iters: 900, epoch: 9 | loss: 0.0666278
	speed: 0.1108s/iter; left time: 3485.6078s
	iters: 1000, epoch: 9 | loss: 0.0586480
	speed: 0.1058s/iter; left time: 3317.3673s
	iters: 1100, epoch: 9 | loss: 0.0657964
	speed: 0.1075s/iter; left time: 3360.6361s
	iters: 1200, epoch: 9 | loss: 0.0660123
	speed: 0.1072s/iter; left time: 3340.2201s
	iters: 1300, epoch: 9 | loss: 0.0626299
	speed: 0.1068s/iter; left time: 3316.2178s
	iters: 1400, epoch: 9 | loss: 0.0734063
	speed: 0.1075s/iter; left time: 3327.8793s
	iters: 1500, epoch: 9 | loss: 0.0596756
	speed: 0.1052s/iter; left time: 3246.9703s
	iters: 1600, epoch: 9 | loss: 0.0683507
	speed: 0.1067s/iter; left time: 3282.1504s
	iters: 1700, epoch: 9 | loss: 0.0777180
	speed: 0.1058s/iter; left time: 3245.2439s
	iters: 1800, epoch: 9 | loss: 0.0691540
	speed: 0.1076s/iter; left time: 3288.3782s
	iters: 1900, epoch: 9 | loss: 0.0617039
	speed: 0.1008s/iter; left time: 3072.3402s
	iters: 2000, epoch: 9 | loss: 0.0588695
	speed: 0.1043s/iter; left time: 3167.3205s
	iters: 2100, epoch: 9 | loss: 0.0621957
	speed: 0.1058s/iter; left time: 3202.2180s
	iters: 2200, epoch: 9 | loss: 0.0547058
	speed: 0.1109s/iter; left time: 3345.2274s
	iters: 2300, epoch: 9 | loss: 0.0607693
	speed: 0.1073s/iter; left time: 3226.4864s
	iters: 2400, epoch: 9 | loss: 0.0594633
	speed: 0.1104s/iter; left time: 3308.0158s
	iters: 2500, epoch: 9 | loss: 0.0635684
	speed: 0.1045s/iter; left time: 3121.6698s
	iters: 2600, epoch: 9 | loss: 0.0643801
	speed: 0.1124s/iter; left time: 3344.5355s
Epoch: 9 cost time: 00h:04m:49.10s
Epoch: 9 | Train Loss: 0.0671886 Vali Loss: 0.0583229 Test Loss: 0.0672066
Validation loss decreased (0.059168 --> 0.058323).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 10 | loss: 0.0552282
	speed: 0.9887s/iter; left time: 29233.8330s
	iters: 200, epoch: 10 | loss: 0.0693061
	speed: 0.1088s/iter; left time: 3205.9469s
	iters: 300, epoch: 10 | loss: 0.0732012
	speed: 0.1009s/iter; left time: 2963.2220s
	iters: 400, epoch: 10 | loss: 0.0685882
	speed: 0.1064s/iter; left time: 3115.1014s
	iters: 500, epoch: 10 | loss: 0.0663253
	speed: 0.1075s/iter; left time: 3136.1761s
	iters: 600, epoch: 10 | loss: 0.0720553
	speed: 0.1085s/iter; left time: 3153.3737s
	iters: 700, epoch: 10 | loss: 0.0778783
	speed: 0.1088s/iter; left time: 3151.5514s
	iters: 800, epoch: 10 | loss: 0.0587212
	speed: 0.1074s/iter; left time: 3100.8688s
	iters: 900, epoch: 10 | loss: 0.0744800
	speed: 0.1069s/iter; left time: 3074.3845s
	iters: 1000, epoch: 10 | loss: 0.0681581
	speed: 0.1100s/iter; left time: 3153.2325s
	iters: 1100, epoch: 10 | loss: 0.0630505
	speed: 0.1045s/iter; left time: 2985.0956s
	iters: 1200, epoch: 10 | loss: 0.0582443
	speed: 0.1119s/iter; left time: 3184.8198s
	iters: 1300, epoch: 10 | loss: 0.0649366
	speed: 0.1089s/iter; left time: 3089.5797s
	iters: 1400, epoch: 10 | loss: 0.0721512
	speed: 0.1083s/iter; left time: 3060.3826s
	iters: 1500, epoch: 10 | loss: 0.0701118
	speed: 0.1113s/iter; left time: 3135.2027s
	iters: 1600, epoch: 10 | loss: 0.0635339
	speed: 0.1082s/iter; left time: 3035.7514s
	iters: 1700, epoch: 10 | loss: 0.0698001
	speed: 0.1062s/iter; left time: 2969.6689s
	iters: 1800, epoch: 10 | loss: 0.0668549
	speed: 0.1051s/iter; left time: 2928.5506s
	iters: 1900, epoch: 10 | loss: 0.0737289
	speed: 0.1063s/iter; left time: 2952.5134s
	iters: 2000, epoch: 10 | loss: 0.0622393
	speed: 0.1099s/iter; left time: 3039.8494s
	iters: 2100, epoch: 10 | loss: 0.0650669
	speed: 0.1091s/iter; left time: 3006.4543s
	iters: 2200, epoch: 10 | loss: 0.0562495
	speed: 0.1095s/iter; left time: 3007.6895s
	iters: 2300, epoch: 10 | loss: 0.0678977
	speed: 0.1090s/iter; left time: 2982.1215s
	iters: 2400, epoch: 10 | loss: 0.0679341
	speed: 0.1071s/iter; left time: 2920.9894s
	iters: 2500, epoch: 10 | loss: 0.0645824
	speed: 0.1080s/iter; left time: 2935.3384s
	iters: 2600, epoch: 10 | loss: 0.0802735
	speed: 0.1091s/iter; left time: 2953.8478s
Epoch: 10 cost time: 00h:04m:51.61s
Epoch: 10 | Train Loss: 0.0665142 Vali Loss: 0.0596833 Test Loss: 0.0681801
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 11 | loss: 0.0599668
	speed: 0.9573s/iter; left time: 25722.9568s
	iters: 200, epoch: 11 | loss: 0.0571347
	speed: 0.1065s/iter; left time: 2850.5491s
	iters: 300, epoch: 11 | loss: 0.0555977
	speed: 0.1146s/iter; left time: 3056.2351s
	iters: 400, epoch: 11 | loss: 0.0804140
	speed: 0.1061s/iter; left time: 2820.0641s
	iters: 500, epoch: 11 | loss: 0.0598191
	speed: 0.1028s/iter; left time: 2720.1557s
	iters: 600, epoch: 11 | loss: 0.0680211
	speed: 0.1070s/iter; left time: 2821.8647s
	iters: 700, epoch: 11 | loss: 0.0765506
	speed: 0.1089s/iter; left time: 2859.6527s
	iters: 800, epoch: 11 | loss: 0.0773061
	speed: 0.1080s/iter; left time: 2826.4155s
	iters: 900, epoch: 11 | loss: 0.0626874
	speed: 0.1072s/iter; left time: 2796.0956s
	iters: 1000, epoch: 11 | loss: 0.0522671
	speed: 0.1063s/iter; left time: 2760.4022s
	iters: 1100, epoch: 11 | loss: 0.0617847
	speed: 0.1093s/iter; left time: 2827.6076s
	iters: 1200, epoch: 11 | loss: 0.0724408
	speed: 0.1059s/iter; left time: 2730.3436s
	iters: 1300, epoch: 11 | loss: 0.0688577
	speed: 0.1084s/iter; left time: 2783.6595s
	iters: 1400, epoch: 11 | loss: 0.0556950
	speed: 0.1044s/iter; left time: 2669.4810s
	iters: 1500, epoch: 11 | loss: 0.0723047
	speed: 0.1098s/iter; left time: 2797.0139s
	iters: 1600, epoch: 11 | loss: 0.0631053
	speed: 0.1109s/iter; left time: 2812.8506s
	iters: 1700, epoch: 11 | loss: 0.0670555
	speed: 0.1067s/iter; left time: 2696.8812s
	iters: 1800, epoch: 11 | loss: 0.0663534
	speed: 0.1048s/iter; left time: 2637.7162s
	iters: 1900, epoch: 11 | loss: 0.0744134
	speed: 0.1097s/iter; left time: 2751.1074s
	iters: 2000, epoch: 11 | loss: 0.0686474
	speed: 0.1085s/iter; left time: 2708.1896s
	iters: 2100, epoch: 11 | loss: 0.0585510
	speed: 0.1008s/iter; left time: 2508.0445s
	iters: 2200, epoch: 11 | loss: 0.0590663
	speed: 0.1062s/iter; left time: 2629.5855s
	iters: 2300, epoch: 11 | loss: 0.0612476
	speed: 0.1061s/iter; left time: 2618.7157s
	iters: 2400, epoch: 11 | loss: 0.0564206
	speed: 0.1066s/iter; left time: 2620.3427s
	iters: 2500, epoch: 11 | loss: 0.0649748
	speed: 0.1106s/iter; left time: 2705.8915s
	iters: 2600, epoch: 11 | loss: 0.0657220
	speed: 0.1079s/iter; left time: 2630.7462s
Epoch: 11 cost time: 00h:04m:50.00s
Epoch: 11 | Train Loss: 0.0660851 Vali Loss: 0.0592204 Test Loss: 0.0686712
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 12 | loss: 0.0633860
	speed: 0.9599s/iter; left time: 23204.3836s
	iters: 200, epoch: 12 | loss: 0.0610290
	speed: 0.1125s/iter; left time: 2707.5343s
	iters: 300, epoch: 12 | loss: 0.0708786
	speed: 0.1074s/iter; left time: 2574.5213s
	iters: 400, epoch: 12 | loss: 0.0609895
	speed: 0.1086s/iter; left time: 2593.8355s
	iters: 500, epoch: 12 | loss: 0.0662539
	speed: 0.1070s/iter; left time: 2544.1196s
	iters: 600, epoch: 12 | loss: 0.0623685
	speed: 0.1097s/iter; left time: 2596.2447s
	iters: 700, epoch: 12 | loss: 0.0687687
	speed: 0.1121s/iter; left time: 2643.3199s
	iters: 800, epoch: 12 | loss: 0.0648808
	speed: 0.1087s/iter; left time: 2551.1677s
	iters: 900, epoch: 12 | loss: 0.0647268
	speed: 0.1016s/iter; left time: 2373.7196s
	iters: 1000, epoch: 12 | loss: 0.0696728
	speed: 0.1089s/iter; left time: 2535.6462s
	iters: 1100, epoch: 12 | loss: 0.0658773
	speed: 0.1067s/iter; left time: 2471.9854s
	iters: 1200, epoch: 12 | loss: 0.0531521
	speed: 0.1070s/iter; left time: 2468.5060s
	iters: 1300, epoch: 12 | loss: 0.0591090
	speed: 0.1069s/iter; left time: 2455.4522s
	iters: 1400, epoch: 12 | loss: 0.0587741
	speed: 0.1061s/iter; left time: 2426.6691s
	iters: 1500, epoch: 12 | loss: 0.0690005
	speed: 0.1074s/iter; left time: 2446.9495s
	iters: 1600, epoch: 12 | loss: 0.0695689
	speed: 0.1045s/iter; left time: 2369.4013s
	iters: 1700, epoch: 12 | loss: 0.0818760
	speed: 0.1020s/iter; left time: 2302.3399s
	iters: 1800, epoch: 12 | loss: 0.0798704
	speed: 0.1056s/iter; left time: 2374.0073s
	iters: 1900, epoch: 12 | loss: 0.0663811
	speed: 0.1118s/iter; left time: 2502.4097s
	iters: 2000, epoch: 12 | loss: 0.0659007
	speed: 0.1074s/iter; left time: 2392.9768s
	iters: 2100, epoch: 12 | loss: 0.0658267
	speed: 0.1104s/iter; left time: 2447.0488s
	iters: 2200, epoch: 12 | loss: 0.0753273
	speed: 0.1075s/iter; left time: 2373.4862s
	iters: 2300, epoch: 12 | loss: 0.0546868
	speed: 0.1066s/iter; left time: 2343.3964s
	iters: 2400, epoch: 12 | loss: 0.0648501
	speed: 0.1075s/iter; left time: 2351.3421s
	iters: 2500, epoch: 12 | loss: 0.0702483
	speed: 0.1054s/iter; left time: 2294.0471s
	iters: 2600, epoch: 12 | loss: 0.0676616
	speed: 0.1092s/iter; left time: 2367.6167s
Epoch: 12 cost time: 00h:04m:50.84s
Epoch: 12 | Train Loss: 0.0656386 Vali Loss: 0.0598788 Test Loss: 0.0692823
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 13 | loss: 0.0604794
	speed: 0.9623s/iter; left time: 20667.4025s
	iters: 200, epoch: 13 | loss: 0.0566729
	speed: 0.1115s/iter; left time: 2383.8163s
	iters: 300, epoch: 13 | loss: 0.0683386
	speed: 0.1044s/iter; left time: 2221.7334s
	iters: 400, epoch: 13 | loss: 0.0582213
	speed: 0.1044s/iter; left time: 2211.1926s
	iters: 500, epoch: 13 | loss: 0.0658862
	speed: 0.1060s/iter; left time: 2234.2187s
	iters: 600, epoch: 13 | loss: 0.0680031
	speed: 0.1073s/iter; left time: 2250.3047s
	iters: 700, epoch: 13 | loss: 0.0549427
	speed: 0.1084s/iter; left time: 2263.1544s
	iters: 800, epoch: 13 | loss: 0.0744731
	speed: 0.1090s/iter; left time: 2265.1629s
	iters: 900, epoch: 13 | loss: 0.0574103
	speed: 0.1038s/iter; left time: 2146.3706s
	iters: 1000, epoch: 13 | loss: 0.0571434
	speed: 0.1037s/iter; left time: 2133.7964s
	iters: 1100, epoch: 13 | loss: 0.0576256
	speed: 0.1054s/iter; left time: 2157.5566s
	iters: 1200, epoch: 13 | loss: 0.0628352
	speed: 0.1043s/iter; left time: 2124.8254s
	iters: 1300, epoch: 13 | loss: 0.0693550
	speed: 0.1097s/iter; left time: 2224.0056s
	iters: 1400, epoch: 13 | loss: 0.0574602
	speed: 0.1055s/iter; left time: 2128.5007s
	iters: 1500, epoch: 13 | loss: 0.0820113
	speed: 0.1074s/iter; left time: 2156.9764s
	iters: 1600, epoch: 13 | loss: 0.0689111
	speed: 0.1077s/iter; left time: 2152.1251s
	iters: 1700, epoch: 13 | loss: 0.0636011
	speed: 0.1012s/iter; left time: 2012.1593s
	iters: 1800, epoch: 13 | loss: 0.0583539
	speed: 0.1059s/iter; left time: 2094.1268s
	iters: 1900, epoch: 13 | loss: 0.0606554
	speed: 0.1070s/iter; left time: 2105.1503s
	iters: 2000, epoch: 13 | loss: 0.0585214
	speed: 0.1114s/iter; left time: 2181.7210s
	iters: 2100, epoch: 13 | loss: 0.0706814
	speed: 0.1047s/iter; left time: 2038.4392s
	iters: 2200, epoch: 13 | loss: 0.0654261
	speed: 0.1048s/iter; left time: 2031.2516s
	iters: 2300, epoch: 13 | loss: 0.0581603
	speed: 0.1070s/iter; left time: 2062.0388s
	iters: 2400, epoch: 13 | loss: 0.0690250
	speed: 0.1088s/iter; left time: 2086.9024s
	iters: 2500, epoch: 13 | loss: 0.0769652
	speed: 0.1016s/iter; left time: 1938.6240s
	iters: 2600, epoch: 13 | loss: 0.0761575
	speed: 0.1085s/iter; left time: 2059.0608s
Epoch: 13 cost time: 00h:04m:47.77s
Epoch: 13 | Train Loss: 0.0652557 Vali Loss: 0.0595088 Test Loss: 0.0683032
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 14 | loss: 0.0597761
	speed: 0.9633s/iter; left time: 18091.5826s
	iters: 200, epoch: 14 | loss: 0.0597405
	speed: 0.1083s/iter; left time: 2023.3475s
	iters: 300, epoch: 14 | loss: 0.0717362
	speed: 0.1022s/iter; left time: 1899.2130s
	iters: 400, epoch: 14 | loss: 0.0655360
	speed: 0.1077s/iter; left time: 1991.1425s
	iters: 500, epoch: 14 | loss: 0.0798717
	speed: 0.1072s/iter; left time: 1969.8460s
	iters: 600, epoch: 14 | loss: 0.0666957
	speed: 0.1046s/iter; left time: 1911.4793s
	iters: 700, epoch: 14 | loss: 0.0554276
	speed: 0.1062s/iter; left time: 1930.6350s
	iters: 800, epoch: 14 | loss: 0.0766484
	speed: 0.1046s/iter; left time: 1890.7512s
	iters: 900, epoch: 14 | loss: 0.0795836
	speed: 0.1035s/iter; left time: 1861.6078s
	iters: 1000, epoch: 14 | loss: 0.0669616
	speed: 0.1055s/iter; left time: 1885.5383s
	iters: 1100, epoch: 14 | loss: 0.0561617
	speed: 0.1033s/iter; left time: 1837.4406s
	iters: 1200, epoch: 14 | loss: 0.0759818
	speed: 0.1045s/iter; left time: 1846.9357s
	iters: 1300, epoch: 14 | loss: 0.0588643
	speed: 0.1085s/iter; left time: 1907.6299s
	iters: 1400, epoch: 14 | loss: 0.0568695
	speed: 0.1074s/iter; left time: 1876.9303s
	iters: 1500, epoch: 14 | loss: 0.0583049
	speed: 0.1055s/iter; left time: 1834.1887s
	iters: 1600, epoch: 14 | loss: 0.0541657
	speed: 0.1112s/iter; left time: 1922.0183s
	iters: 1700, epoch: 14 | loss: 0.0580471
	speed: 0.1036s/iter; left time: 1780.6303s
	iters: 1800, epoch: 14 | loss: 0.0683933
	speed: 0.1101s/iter; left time: 1879.6820s
	iters: 1900, epoch: 14 | loss: 0.0691114
	speed: 0.1079s/iter; left time: 1831.3454s
	iters: 2000, epoch: 14 | loss: 0.0739959
	speed: 0.1080s/iter; left time: 1823.0459s
	iters: 2100, epoch: 14 | loss: 0.0626454
	speed: 0.1044s/iter; left time: 1751.9195s
	iters: 2200, epoch: 14 | loss: 0.0539643
	speed: 0.1066s/iter; left time: 1777.7894s
	iters: 2300, epoch: 14 | loss: 0.0740233
	speed: 0.1068s/iter; left time: 1770.6359s
	iters: 2400, epoch: 14 | loss: 0.0800757
	speed: 0.1066s/iter; left time: 1756.5512s
	iters: 2500, epoch: 14 | loss: 0.0604383
	speed: 0.1068s/iter; left time: 1748.9560s
	iters: 2600, epoch: 14 | loss: 0.0544207
	speed: 0.1077s/iter; left time: 1753.0148s
Epoch: 14 cost time: 00h:04m:47.33s
Epoch: 14 | Train Loss: 0.0648617 Vali Loss: 0.0584747 Test Loss: 0.0677103
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.0108054019510746, rmse:0.10394903272390366, mae:0.06720664352178574, rse:0.3051966428756714
success delete checkpoints
Intermediate time for ES and pred_len 24: 01h:26m:56.65s

=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
train 86115
val 18435
test 18435
[2024-11-02 15:22:25,021] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-02 15:22:25,963] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-02 15:22:25,963] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-02 15:22:25,964] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-02 15:22:26,034] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-02 15:22:26,034] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-02 15:22:26,699] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-02 15:22:26,700] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-02 15:22:26,700] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-02 15:22:26,702] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-02 15:22:26,702] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-02 15:22:26,702] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-02 15:22:26,702] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-02 15:22:26,702] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-02 15:22:26,702] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-02 15:22:26,703] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-02 15:22:27,032] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-02 15:22:27,033] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-02 15:22:27,033] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 116.19 GB, percent = 15.4%
[2024-11-02 15:22:27,156] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-02 15:22:27,157] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-02 15:22:27,157] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 116.19 GB, percent = 15.4%
[2024-11-02 15:22:27,158] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-02 15:22:27,282] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-02 15:22:27,283] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-02 15:22:27,283] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 116.21 GB, percent = 15.4%
[2024-11-02 15:22:27,283] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-02 15:22:27,284] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-02 15:22:27,284] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-02 15:22:27,284] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-02 15:22:27,284] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f8661b2a450>
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-02 15:22:27,285] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-02 15:22:27,286] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-02 15:22:27,287] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-02 15:22:27,287] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1883777
	speed: 0.1633s/iter; left time: 8775.2950s
	iters: 200, epoch: 1 | loss: 0.1642785
	speed: 0.1161s/iter; left time: 6223.0266s
	iters: 300, epoch: 1 | loss: 0.1586337
	speed: 0.1227s/iter; left time: 6565.8886s
	iters: 400, epoch: 1 | loss: 0.1215111
	speed: 0.1174s/iter; left time: 6270.3139s
	iters: 500, epoch: 1 | loss: 0.1161290
	speed: 0.1187s/iter; left time: 6329.3336s
	iters: 600, epoch: 1 | loss: 0.1045108
	speed: 0.1210s/iter; left time: 6440.0003s
	iters: 700, epoch: 1 | loss: 0.1008641
	speed: 0.1206s/iter; left time: 6404.1045s
	iters: 800, epoch: 1 | loss: 0.1015716
	speed: 0.1204s/iter; left time: 6382.9067s
	iters: 900, epoch: 1 | loss: 0.1061578
	speed: 0.1167s/iter; left time: 6176.6558s
	iters: 1000, epoch: 1 | loss: 0.1075203
	speed: 0.1218s/iter; left time: 6434.9860s
	iters: 1100, epoch: 1 | loss: 0.0915048
	speed: 0.1173s/iter; left time: 6185.6594s
	iters: 1200, epoch: 1 | loss: 0.1113726
	speed: 0.1205s/iter; left time: 6342.6255s
	iters: 1300, epoch: 1 | loss: 0.1193190
	speed: 0.1181s/iter; left time: 6200.5595s
	iters: 1400, epoch: 1 | loss: 0.1057486
	speed: 0.1203s/iter; left time: 6303.7762s
	iters: 1500, epoch: 1 | loss: 0.1058766
	speed: 0.1208s/iter; left time: 6319.5797s
	iters: 1600, epoch: 1 | loss: 0.0978397
	speed: 0.1217s/iter; left time: 6355.8485s
	iters: 1700, epoch: 1 | loss: 0.0993557
	speed: 0.1214s/iter; left time: 6328.9969s
	iters: 1800, epoch: 1 | loss: 0.1031770
	speed: 0.1165s/iter; left time: 6058.6103s
	iters: 1900, epoch: 1 | loss: 0.0965251
	speed: 0.1218s/iter; left time: 6325.7499s
	iters: 2000, epoch: 1 | loss: 0.0928079
	speed: 0.1202s/iter; left time: 6226.6550s
	iters: 2100, epoch: 1 | loss: 0.0932634
	speed: 0.1178s/iter; left time: 6093.9149s
	iters: 2200, epoch: 1 | loss: 0.1016541
	speed: 0.1156s/iter; left time: 5964.9607s
	iters: 2300, epoch: 1 | loss: 0.0999433
	speed: 0.1182s/iter; left time: 6089.1488s
	iters: 2400, epoch: 1 | loss: 0.0873916
	speed: 0.1216s/iter; left time: 6252.8129s
	iters: 2500, epoch: 1 | loss: 0.0910878
	speed: 0.1203s/iter; left time: 6176.1272s
	iters: 2600, epoch: 1 | loss: 0.1087127
	speed: 0.1178s/iter; left time: 6033.2857s
Epoch: 1 cost time: 00h:05m:23.31s
Epoch: 1 | Train Loss: 0.1153284 Vali Loss: 0.0887686 Test Loss: 0.1010105
Validation loss decreased (inf --> 0.088769).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0960205
	speed: 1.1112s/iter; left time: 56705.4595s
	iters: 200, epoch: 2 | loss: 0.0968005
	speed: 0.1084s/iter; left time: 5522.1968s
	iters: 300, epoch: 2 | loss: 0.1073778
	speed: 0.1053s/iter; left time: 5351.6586s
	iters: 400, epoch: 2 | loss: 0.0946367
	speed: 0.1066s/iter; left time: 5407.8782s
	iters: 500, epoch: 2 | loss: 0.1025144
	speed: 0.1079s/iter; left time: 5462.6925s
	iters: 600, epoch: 2 | loss: 0.0983518
	speed: 0.1048s/iter; left time: 5297.9099s
	iters: 700, epoch: 2 | loss: 0.0933921
	speed: 0.1073s/iter; left time: 5408.6273s
	iters: 800, epoch: 2 | loss: 0.0885800
	speed: 0.1069s/iter; left time: 5378.0900s
	iters: 900, epoch: 2 | loss: 0.0950760
	speed: 0.1070s/iter; left time: 5375.5761s
	iters: 1000, epoch: 2 | loss: 0.0934220
	speed: 0.1079s/iter; left time: 5410.7821s
	iters: 1100, epoch: 2 | loss: 0.1022061
	speed: 0.1066s/iter; left time: 5333.7692s
	iters: 1200, epoch: 2 | loss: 0.0829705
	speed: 0.1052s/iter; left time: 5252.5686s
	iters: 1300, epoch: 2 | loss: 0.1148255
	speed: 0.1030s/iter; left time: 5133.3961s
	iters: 1400, epoch: 2 | loss: 0.0892722
	speed: 0.1088s/iter; left time: 5409.7303s
	iters: 1500, epoch: 2 | loss: 0.0866018
	speed: 0.1071s/iter; left time: 5314.3252s
	iters: 1600, epoch: 2 | loss: 0.0827379
	speed: 0.1049s/iter; left time: 5194.5613s
	iters: 1700, epoch: 2 | loss: 0.1050955
	speed: 0.1055s/iter; left time: 5217.1601s
	iters: 1800, epoch: 2 | loss: 0.1068194
	speed: 0.1052s/iter; left time: 5190.2900s
	iters: 1900, epoch: 2 | loss: 0.0907224
	speed: 0.1076s/iter; left time: 5299.5344s
	iters: 2000, epoch: 2 | loss: 0.0889307
	speed: 0.1075s/iter; left time: 5279.8154s
	iters: 2100, epoch: 2 | loss: 0.0828655
	speed: 0.1077s/iter; left time: 5278.4036s
	iters: 2200, epoch: 2 | loss: 0.1026875
	speed: 0.1099s/iter; left time: 5375.0429s
	iters: 2300, epoch: 2 | loss: 0.0875362
	speed: 0.1092s/iter; left time: 5333.6976s
	iters: 2400, epoch: 2 | loss: 0.0809421
	speed: 0.1074s/iter; left time: 5234.9613s
	iters: 2500, epoch: 2 | loss: 0.0847859
	speed: 0.1053s/iter; left time: 5118.4303s
	iters: 2600, epoch: 2 | loss: 0.0868387
	speed: 0.1099s/iter; left time: 5333.3714s
Epoch: 2 cost time: 00h:04m:48.57s
Epoch: 2 | Train Loss: 0.0953358 Vali Loss: 0.0838980 Test Loss: 0.0960651
Validation loss decreased (0.088769 --> 0.083898).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0928329
	speed: 0.9862s/iter; left time: 47670.4618s
	iters: 200, epoch: 3 | loss: 0.0811050
	speed: 0.1161s/iter; left time: 5600.4357s
	iters: 300, epoch: 3 | loss: 0.1074759
	speed: 0.1070s/iter; left time: 5149.8389s
	iters: 400, epoch: 3 | loss: 0.0964614
	speed: 0.1077s/iter; left time: 5172.2576s
	iters: 500, epoch: 3 | loss: 0.0867380
	speed: 0.1053s/iter; left time: 5046.5864s
	iters: 600, epoch: 3 | loss: 0.0928695
	speed: 0.1092s/iter; left time: 5224.6830s
	iters: 700, epoch: 3 | loss: 0.0858418
	speed: 0.1073s/iter; left time: 5121.3753s
	iters: 800, epoch: 3 | loss: 0.0918019
	speed: 0.1065s/iter; left time: 5072.4651s
	iters: 900, epoch: 3 | loss: 0.1130629
	speed: 0.1070s/iter; left time: 5087.8674s
	iters: 1000, epoch: 3 | loss: 0.0996885
	speed: 0.1049s/iter; left time: 4978.5365s
	iters: 1100, epoch: 3 | loss: 0.1002581
	speed: 0.1097s/iter; left time: 5194.1672s
	iters: 1200, epoch: 3 | loss: 0.0801419
	speed: 0.1075s/iter; left time: 5079.1085s
	iters: 1300, epoch: 3 | loss: 0.0852083
	speed: 0.1083s/iter; left time: 5107.1702s
	iters: 1400, epoch: 3 | loss: 0.0802493
	speed: 0.1044s/iter; left time: 4911.2287s
	iters: 1500, epoch: 3 | loss: 0.0922221
	speed: 0.1100s/iter; left time: 5161.9898s
	iters: 1600, epoch: 3 | loss: 0.0829106
	speed: 0.1074s/iter; left time: 5032.8094s
	iters: 1700, epoch: 3 | loss: 0.0909540
	speed: 0.1058s/iter; left time: 4943.1901s
	iters: 1800, epoch: 3 | loss: 0.0992832
	speed: 0.1073s/iter; left time: 5002.3535s
	iters: 1900, epoch: 3 | loss: 0.1036604
	speed: 0.1048s/iter; left time: 4876.7098s
	iters: 2000, epoch: 3 | loss: 0.0947560
	speed: 0.1055s/iter; left time: 4899.8111s
	iters: 2100, epoch: 3 | loss: 0.0935063
	speed: 0.1090s/iter; left time: 5051.4298s
	iters: 2200, epoch: 3 | loss: 0.0912203
	speed: 0.1015s/iter; left time: 4693.5850s
	iters: 2300, epoch: 3 | loss: 0.0946222
	speed: 0.1068s/iter; left time: 4927.4407s
	iters: 2400, epoch: 3 | loss: 0.0792365
	speed: 0.1075s/iter; left time: 4949.7346s
	iters: 2500, epoch: 3 | loss: 0.0930506
	speed: 0.1021s/iter; left time: 4690.1926s
	iters: 2600, epoch: 3 | loss: 0.0854950
	speed: 0.1063s/iter; left time: 4871.2306s
Epoch: 3 cost time: 00h:04m:49.13s
Epoch: 3 | Train Loss: 0.0915215 Vali Loss: 0.0821664 Test Loss: 0.0941079
Validation loss decreased (0.083898 --> 0.082166).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0923687
	speed: 0.9672s/iter; left time: 44149.4505s
	iters: 200, epoch: 4 | loss: 0.0943383
	speed: 0.1023s/iter; left time: 4660.4344s
	iters: 300, epoch: 4 | loss: 0.0941553
	speed: 0.1018s/iter; left time: 4625.8418s
	iters: 400, epoch: 4 | loss: 0.0961315
	speed: 0.1080s/iter; left time: 4896.0319s
	iters: 500, epoch: 4 | loss: 0.1017793
	speed: 0.1084s/iter; left time: 4904.2047s
	iters: 600, epoch: 4 | loss: 0.0789471
	speed: 0.1069s/iter; left time: 4826.5473s
	iters: 700, epoch: 4 | loss: 0.0971971
	speed: 0.1102s/iter; left time: 4962.9907s
	iters: 800, epoch: 4 | loss: 0.0904444
	speed: 0.1110s/iter; left time: 4987.5309s
	iters: 900, epoch: 4 | loss: 0.0791268
	speed: 0.1029s/iter; left time: 4615.9686s
	iters: 1000, epoch: 4 | loss: 0.0881244
	speed: 0.1107s/iter; left time: 4953.3610s
	iters: 1100, epoch: 4 | loss: 0.0926313
	speed: 0.0996s/iter; left time: 4444.7742s
	iters: 1200, epoch: 4 | loss: 0.0894173
	speed: 0.1076s/iter; left time: 4791.3738s
	iters: 1300, epoch: 4 | loss: 0.0785045
	speed: 0.1076s/iter; left time: 4781.0097s
	iters: 1400, epoch: 4 | loss: 0.0893424
	speed: 0.1057s/iter; left time: 4688.4088s
	iters: 1500, epoch: 4 | loss: 0.0989641
	speed: 0.1091s/iter; left time: 4828.1736s
	iters: 1600, epoch: 4 | loss: 0.0902890
	speed: 0.1067s/iter; left time: 4709.9595s
	iters: 1700, epoch: 4 | loss: 0.0750174
	speed: 0.1086s/iter; left time: 4785.6809s
	iters: 1800, epoch: 4 | loss: 0.0954725
	speed: 0.1043s/iter; left time: 4582.1583s
	iters: 1900, epoch: 4 | loss: 0.0801812
	speed: 0.1072s/iter; left time: 4700.9469s
	iters: 2000, epoch: 4 | loss: 0.0892521
	speed: 0.1057s/iter; left time: 4624.6908s
	iters: 2100, epoch: 4 | loss: 0.0967448
	speed: 0.1078s/iter; left time: 4704.9327s
	iters: 2200, epoch: 4 | loss: 0.0892473
	speed: 0.1041s/iter; left time: 4531.9119s
	iters: 2300, epoch: 4 | loss: 0.1105002
	speed: 0.1084s/iter; left time: 4709.2993s
	iters: 2400, epoch: 4 | loss: 0.0882045
	speed: 0.1082s/iter; left time: 4689.7527s
	iters: 2500, epoch: 4 | loss: 0.0999998
	speed: 0.1028s/iter; left time: 4443.7533s
	iters: 2600, epoch: 4 | loss: 0.0820032
	speed: 0.1085s/iter; left time: 4680.1466s
Epoch: 4 cost time: 00h:04m:47.46s
Epoch: 4 | Train Loss: 0.0890123 Vali Loss: 0.0821997 Test Loss: 0.0937731
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0824345
	speed: 0.9453s/iter; left time: 40605.9154s
	iters: 200, epoch: 5 | loss: 0.0922259
	speed: 0.1130s/iter; left time: 4844.8604s
	iters: 300, epoch: 5 | loss: 0.0980015
	speed: 0.1070s/iter; left time: 4576.3462s
	iters: 400, epoch: 5 | loss: 0.0738367
	speed: 0.1104s/iter; left time: 4711.3551s
	iters: 500, epoch: 5 | loss: 0.0708809
	speed: 0.1120s/iter; left time: 4767.7358s
	iters: 600, epoch: 5 | loss: 0.0800962
	speed: 0.1084s/iter; left time: 4602.6269s
	iters: 700, epoch: 5 | loss: 0.0935463
	speed: 0.1072s/iter; left time: 4542.5523s
	iters: 800, epoch: 5 | loss: 0.0977683
	speed: 0.1035s/iter; left time: 4374.0397s
	iters: 900, epoch: 5 | loss: 0.0860935
	speed: 0.1073s/iter; left time: 4523.5646s
	iters: 1000, epoch: 5 | loss: 0.0758314
	speed: 0.1067s/iter; left time: 4489.0283s
	iters: 1100, epoch: 5 | loss: 0.0814082
	speed: 0.1018s/iter; left time: 4270.5619s
	iters: 1200, epoch: 5 | loss: 0.0836338
	speed: 0.1070s/iter; left time: 4479.7320s
	iters: 1300, epoch: 5 | loss: 0.0829336
	speed: 0.1062s/iter; left time: 4435.0494s
	iters: 1400, epoch: 5 | loss: 0.0851112
	speed: 0.1030s/iter; left time: 4289.4145s
	iters: 1500, epoch: 5 | loss: 0.0850937
	speed: 0.1084s/iter; left time: 4506.2151s
	iters: 1600, epoch: 5 | loss: 0.0898389
	speed: 0.1051s/iter; left time: 4357.1480s
	iters: 1700, epoch: 5 | loss: 0.0858165
	speed: 0.1039s/iter; left time: 4298.8632s
	iters: 1800, epoch: 5 | loss: 0.0958296
	speed: 0.1065s/iter; left time: 4392.8802s
	iters: 1900, epoch: 5 | loss: 0.0857323
	speed: 0.1131s/iter; left time: 4655.0584s
	iters: 2000, epoch: 5 | loss: 0.0918692
	speed: 0.1030s/iter; left time: 4228.9117s
	iters: 2100, epoch: 5 | loss: 0.0774475
	speed: 0.1010s/iter; left time: 4136.6069s
	iters: 2200, epoch: 5 | loss: 0.0845494
	speed: 0.1075s/iter; left time: 4392.7368s
	iters: 2300, epoch: 5 | loss: 0.0760283
	speed: 0.1021s/iter; left time: 4161.3874s
	iters: 2400, epoch: 5 | loss: 0.0756378
	speed: 0.1025s/iter; left time: 4167.8196s
	iters: 2500, epoch: 5 | loss: 0.0883363
	speed: 0.1034s/iter; left time: 4195.5177s
	iters: 2600, epoch: 5 | loss: 0.0859664
	speed: 0.1067s/iter; left time: 4316.4279s
Epoch: 5 cost time: 00h:04m:46.37s
Epoch: 5 | Train Loss: 0.0871692 Vali Loss: 0.0830350 Test Loss: 0.0942258
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0915383
	speed: 0.9423s/iter; left time: 37943.1123s
	iters: 200, epoch: 6 | loss: 0.0933986
	speed: 0.1069s/iter; left time: 4292.3560s
	iters: 300, epoch: 6 | loss: 0.0981537
	speed: 0.1058s/iter; left time: 4237.9282s
	iters: 400, epoch: 6 | loss: 0.0806353
	speed: 0.1058s/iter; left time: 4226.9126s
	iters: 500, epoch: 6 | loss: 0.0890182
	speed: 0.1141s/iter; left time: 4546.9666s
	iters: 600, epoch: 6 | loss: 0.0841566
	speed: 0.1106s/iter; left time: 4397.1800s
	iters: 700, epoch: 6 | loss: 0.0806254
	speed: 0.1113s/iter; left time: 4416.3133s
	iters: 800, epoch: 6 | loss: 0.0999852
	speed: 0.1089s/iter; left time: 4308.5975s
	iters: 900, epoch: 6 | loss: 0.0849152
	speed: 0.1071s/iter; left time: 4227.5662s
	iters: 1000, epoch: 6 | loss: 0.0727589
	speed: 0.1046s/iter; left time: 4117.9726s
	iters: 1100, epoch: 6 | loss: 0.0788582
	speed: 0.1120s/iter; left time: 4399.3033s
	iters: 1200, epoch: 6 | loss: 0.0934843
	speed: 0.1049s/iter; left time: 4108.5665s
	iters: 1300, epoch: 6 | loss: 0.0990512
	speed: 0.1068s/iter; left time: 4174.1318s
	iters: 1400, epoch: 6 | loss: 0.0990836
	speed: 0.1097s/iter; left time: 4276.2408s
	iters: 1500, epoch: 6 | loss: 0.0847571
	speed: 0.1060s/iter; left time: 4120.4722s
	iters: 1600, epoch: 6 | loss: 0.0996485
	speed: 0.1086s/iter; left time: 4211.1485s
	iters: 1700, epoch: 6 | loss: 0.0907493
	speed: 0.1077s/iter; left time: 4162.6426s
	iters: 1800, epoch: 6 | loss: 0.0795749
	speed: 0.1084s/iter; left time: 4182.1248s
	iters: 1900, epoch: 6 | loss: 0.0791156
	speed: 0.1107s/iter; left time: 4257.6090s
	iters: 2000, epoch: 6 | loss: 0.0867164
	speed: 0.1088s/iter; left time: 4174.8139s
	iters: 2100, epoch: 6 | loss: 0.0956665
	speed: 0.1075s/iter; left time: 4115.4783s
	iters: 2200, epoch: 6 | loss: 0.0683716
	speed: 0.1060s/iter; left time: 4043.8072s
	iters: 2300, epoch: 6 | loss: 0.0902782
	speed: 0.1065s/iter; left time: 4052.8975s
	iters: 2400, epoch: 6 | loss: 0.0900548
	speed: 0.1069s/iter; left time: 4057.7608s
	iters: 2500, epoch: 6 | loss: 0.0807459
	speed: 0.1102s/iter; left time: 4172.5174s
	iters: 2600, epoch: 6 | loss: 0.0924551
	speed: 0.1109s/iter; left time: 4187.1750s
Epoch: 6 cost time: 00h:04m:51.55s
Epoch: 6 | Train Loss: 0.0856582 Vali Loss: 0.0837385 Test Loss: 0.0947861
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0834660
	speed: 0.9507s/iter; left time: 35723.7371s
	iters: 200, epoch: 7 | loss: 0.0829694
	speed: 0.1115s/iter; left time: 4179.7641s
	iters: 300, epoch: 7 | loss: 0.0874605
	speed: 0.1096s/iter; left time: 4096.6349s
	iters: 400, epoch: 7 | loss: 0.0953893
	speed: 0.1059s/iter; left time: 3945.9474s
	iters: 500, epoch: 7 | loss: 0.0848485
	speed: 0.1095s/iter; left time: 4069.8731s
	iters: 600, epoch: 7 | loss: 0.0755942
	speed: 0.1061s/iter; left time: 3935.3471s
	iters: 700, epoch: 7 | loss: 0.0873404
	speed: 0.1042s/iter; left time: 3852.8437s
	iters: 800, epoch: 7 | loss: 0.0822200
	speed: 0.1124s/iter; left time: 4143.6976s
	iters: 900, epoch: 7 | loss: 0.0831545
	speed: 0.1063s/iter; left time: 3908.0252s
	iters: 1000, epoch: 7 | loss: 0.0765932
	speed: 0.1081s/iter; left time: 3962.8190s
	iters: 1100, epoch: 7 | loss: 0.0916426
	speed: 0.1063s/iter; left time: 3889.7106s
	iters: 1200, epoch: 7 | loss: 0.0759756
	speed: 0.1082s/iter; left time: 3945.4410s
	iters: 1300, epoch: 7 | loss: 0.0766117
	speed: 0.1043s/iter; left time: 3794.8485s
	iters: 1400, epoch: 7 | loss: 0.0788070
	speed: 0.1076s/iter; left time: 3904.0472s
	iters: 1500, epoch: 7 | loss: 0.1004317
	speed: 0.1086s/iter; left time: 3930.3966s
	iters: 1600, epoch: 7 | loss: 0.0882952
	speed: 0.1071s/iter; left time: 3864.3780s
	iters: 1700, epoch: 7 | loss: 0.0867677
	speed: 0.1068s/iter; left time: 3842.4643s
	iters: 1800, epoch: 7 | loss: 0.0723154
	speed: 0.1087s/iter; left time: 3900.5188s
	iters: 1900, epoch: 7 | loss: 0.0990128
	speed: 0.1091s/iter; left time: 3902.1994s
	iters: 2000, epoch: 7 | loss: 0.0675883
	speed: 0.1106s/iter; left time: 3945.9198s
	iters: 2100, epoch: 7 | loss: 0.0852043
	speed: 0.1122s/iter; left time: 3990.1344s
	iters: 2200, epoch: 7 | loss: 0.0885752
	speed: 0.1089s/iter; left time: 3864.1635s
	iters: 2300, epoch: 7 | loss: 0.0817467
	speed: 0.1041s/iter; left time: 3681.1048s
	iters: 2400, epoch: 7 | loss: 0.0783509
	speed: 0.1049s/iter; left time: 3701.9991s
	iters: 2500, epoch: 7 | loss: 0.0753475
	speed: 0.1023s/iter; left time: 3597.0074s
	iters: 2600, epoch: 7 | loss: 0.0807764
	speed: 0.1039s/iter; left time: 3642.7307s
Epoch: 7 cost time: 00h:04m:49.85s
Epoch: 7 | Train Loss: 0.0841171 Vali Loss: 0.0846731 Test Loss: 0.0937717
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0863863
	speed: 0.9494s/iter; left time: 33117.9419s
	iters: 200, epoch: 8 | loss: 0.0749087
	speed: 0.1100s/iter; left time: 3825.2096s
	iters: 300, epoch: 8 | loss: 0.0807150
	speed: 0.1080s/iter; left time: 3745.5055s
	iters: 400, epoch: 8 | loss: 0.0771998
	speed: 0.1100s/iter; left time: 3803.8892s
	iters: 500, epoch: 8 | loss: 0.0875563
	speed: 0.1084s/iter; left time: 3738.6377s
	iters: 600, epoch: 8 | loss: 0.0829368
	speed: 0.1057s/iter; left time: 3634.9542s
	iters: 700, epoch: 8 | loss: 0.0730132
	speed: 0.1059s/iter; left time: 3631.4580s
	iters: 800, epoch: 8 | loss: 0.0852739
	speed: 0.1079s/iter; left time: 3689.0597s
	iters: 900, epoch: 8 | loss: 0.0951376
	speed: 0.1067s/iter; left time: 3637.2869s
	iters: 1000, epoch: 8 | loss: 0.0686005
	speed: 0.1021s/iter; left time: 3468.3762s
	iters: 1100, epoch: 8 | loss: 0.0827262
	speed: 0.1043s/iter; left time: 3535.0200s
	iters: 1200, epoch: 8 | loss: 0.0796252
	speed: 0.1093s/iter; left time: 3691.5745s
	iters: 1300, epoch: 8 | loss: 0.0840250
	speed: 0.1037s/iter; left time: 3491.9403s
	iters: 1400, epoch: 8 | loss: 0.0879034
	speed: 0.1097s/iter; left time: 3684.5622s
	iters: 1500, epoch: 8 | loss: 0.0701827
	speed: 0.1041s/iter; left time: 3485.9761s
	iters: 1600, epoch: 8 | loss: 0.0842006
	speed: 0.1048s/iter; left time: 3497.2469s
	iters: 1700, epoch: 8 | loss: 0.0884516
	speed: 0.1088s/iter; left time: 3619.6541s
	iters: 1800, epoch: 8 | loss: 0.1042492
	speed: 0.1097s/iter; left time: 3640.4532s
	iters: 1900, epoch: 8 | loss: 0.0795427
	speed: 0.1074s/iter; left time: 3552.2897s
	iters: 2000, epoch: 8 | loss: 0.0710123
	speed: 0.1088s/iter; left time: 3589.3398s
	iters: 2100, epoch: 8 | loss: 0.0780427
	speed: 0.1083s/iter; left time: 3562.3860s
	iters: 2200, epoch: 8 | loss: 0.0920559
	speed: 0.1060s/iter; left time: 3473.6784s
	iters: 2300, epoch: 8 | loss: 0.0782730
	speed: 0.1046s/iter; left time: 3418.4985s
	iters: 2400, epoch: 8 | loss: 0.0835265
	speed: 0.1068s/iter; left time: 3478.3846s
	iters: 2500, epoch: 8 | loss: 0.0733754
	speed: 0.1107s/iter; left time: 3596.9654s
	iters: 2600, epoch: 8 | loss: 0.0804105
	speed: 0.1018s/iter; left time: 3295.7376s
Epoch: 8 cost time: 00h:04m:48.48s
Epoch: 8 | Train Loss: 0.0827061 Vali Loss: 0.0853918 Test Loss: 0.0946178
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.019848739728331566, rmse:0.14088556170463562, mae:0.09410795569419861, rse:0.41384807229042053
success delete checkpoints
Intermediate time for ES and pred_len 96: 00h:50m:14.97s

=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
train 85899
val 18219
test 18219
[2024-11-02 16:12:39,498] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-02 16:12:40,572] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-02 16:12:40,573] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-02 16:12:40,573] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-02 16:12:40,675] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-02 16:12:40,676] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-02 16:12:41,349] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-02 16:12:41,350] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-02 16:12:41,350] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-02 16:12:41,352] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-02 16:12:41,352] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-02 16:12:41,352] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-02 16:12:41,352] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-02 16:12:41,352] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-02 16:12:41,352] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-02 16:12:41,352] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-02 16:12:41,689] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-02 16:12:41,690] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-02 16:12:41,690] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 117.48 GB, percent = 15.6%
[2024-11-02 16:12:41,817] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-02 16:12:41,818] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 16:12:41,818] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 117.48 GB, percent = 15.6%
[2024-11-02 16:12:41,818] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-02 16:12:41,937] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-02 16:12:41,938] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 16:12:41,939] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 117.48 GB, percent = 15.6%
[2024-11-02 16:12:41,939] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-02 16:12:41,939] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-02 16:12:41,939] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-02 16:12:41,940] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-02 16:12:41,940] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fc2486677d0>
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-02 16:12:41,941] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-02 16:12:41,942] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-02 16:12:41,943] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-02 16:12:41,943] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1778164
	speed: 0.1568s/iter; left time: 8400.0508s
	iters: 200, epoch: 1 | loss: 0.1971989
	speed: 0.1192s/iter; left time: 6377.3523s
	iters: 300, epoch: 1 | loss: 0.1594778
	speed: 0.1232s/iter; left time: 6575.6436s
	iters: 400, epoch: 1 | loss: 0.1233426
	speed: 0.1147s/iter; left time: 6111.6815s
	iters: 500, epoch: 1 | loss: 0.1213352
	speed: 0.1189s/iter; left time: 6324.4946s
	iters: 600, epoch: 1 | loss: 0.1119261
	speed: 0.1218s/iter; left time: 6463.4824s
	iters: 700, epoch: 1 | loss: 0.1127991
	speed: 0.1219s/iter; left time: 6458.3757s
	iters: 800, epoch: 1 | loss: 0.1025673
	speed: 0.1211s/iter; left time: 6401.9189s
	iters: 900, epoch: 1 | loss: 0.1033708
	speed: 0.1208s/iter; left time: 6373.7260s
	iters: 1000, epoch: 1 | loss: 0.1163776
	speed: 0.1170s/iter; left time: 6163.5149s
	iters: 1100, epoch: 1 | loss: 0.1146140
	speed: 0.1225s/iter; left time: 6440.3435s
	iters: 1200, epoch: 1 | loss: 0.1062645
	speed: 0.1206s/iter; left time: 6330.5963s
	iters: 1300, epoch: 1 | loss: 0.1152460
	speed: 0.1215s/iter; left time: 6363.5154s
	iters: 1400, epoch: 1 | loss: 0.1100958
	speed: 0.1152s/iter; left time: 6025.1233s
	iters: 1500, epoch: 1 | loss: 0.0964408
	speed: 0.1175s/iter; left time: 6133.0263s
	iters: 1600, epoch: 1 | loss: 0.0965621
	speed: 0.1209s/iter; left time: 6297.9019s
	iters: 1700, epoch: 1 | loss: 0.0997088
	speed: 0.1155s/iter; left time: 6005.6949s
	iters: 1800, epoch: 1 | loss: 0.1003732
	speed: 0.1206s/iter; left time: 6257.5801s
	iters: 1900, epoch: 1 | loss: 0.1042660
	speed: 0.1207s/iter; left time: 6248.1295s
	iters: 2000, epoch: 1 | loss: 0.0969521
	speed: 0.1202s/iter; left time: 6210.6491s
	iters: 2100, epoch: 1 | loss: 0.1015071
	speed: 0.1194s/iter; left time: 6159.6435s
	iters: 2200, epoch: 1 | loss: 0.1033745
	speed: 0.1223s/iter; left time: 6297.3941s
	iters: 2300, epoch: 1 | loss: 0.1043368
	speed: 0.1198s/iter; left time: 6157.7247s
	iters: 2400, epoch: 1 | loss: 0.0983482
	speed: 0.1177s/iter; left time: 6037.7931s
	iters: 2500, epoch: 1 | loss: 0.0977514
	speed: 0.1148s/iter; left time: 5873.1216s
	iters: 2600, epoch: 1 | loss: 0.1156735
	speed: 0.1235s/iter; left time: 6309.1311s
Epoch: 1 cost time: 00h:05m:21.95s
Epoch: 1 | Train Loss: 0.1179913 Vali Loss: 0.0912490 Test Loss: 0.1035000
Validation loss decreased (inf --> 0.091249).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.1087977
	speed: 1.0831s/iter; left time: 55126.1953s
	iters: 200, epoch: 2 | loss: 0.1095505
	speed: 0.1064s/iter; left time: 5405.0116s
	iters: 300, epoch: 2 | loss: 0.0956247
	speed: 0.1052s/iter; left time: 5331.4448s
	iters: 400, epoch: 2 | loss: 0.1070556
	speed: 0.1094s/iter; left time: 5535.6977s
	iters: 500, epoch: 2 | loss: 0.0973769
	speed: 0.1070s/iter; left time: 5405.1235s
	iters: 600, epoch: 2 | loss: 0.0893573
	speed: 0.1065s/iter; left time: 5367.3892s
	iters: 700, epoch: 2 | loss: 0.0881983
	speed: 0.1108s/iter; left time: 5572.1252s
	iters: 800, epoch: 2 | loss: 0.0978097
	speed: 0.1110s/iter; left time: 5569.7477s
	iters: 900, epoch: 2 | loss: 0.1160224
	speed: 0.1074s/iter; left time: 5379.9568s
	iters: 1000, epoch: 2 | loss: 0.1127868
	speed: 0.1097s/iter; left time: 5485.2445s
	iters: 1100, epoch: 2 | loss: 0.1066502
	speed: 0.1080s/iter; left time: 5387.8599s
	iters: 1200, epoch: 2 | loss: 0.0881434
	speed: 0.1071s/iter; left time: 5334.1044s
	iters: 1300, epoch: 2 | loss: 0.0893611
	speed: 0.1098s/iter; left time: 5454.9817s
	iters: 1400, epoch: 2 | loss: 0.1034243
	speed: 0.1085s/iter; left time: 5379.1939s
	iters: 1500, epoch: 2 | loss: 0.0995729
	speed: 0.1069s/iter; left time: 5289.2479s
	iters: 1600, epoch: 2 | loss: 0.1037162
	speed: 0.1134s/iter; left time: 5601.0162s
	iters: 1700, epoch: 2 | loss: 0.1003603
	speed: 0.1106s/iter; left time: 5453.2157s
	iters: 1800, epoch: 2 | loss: 0.1068703
	speed: 0.1114s/iter; left time: 5480.0954s
	iters: 1900, epoch: 2 | loss: 0.0950982
	speed: 0.1109s/iter; left time: 5444.0518s
	iters: 2000, epoch: 2 | loss: 0.0966142
	speed: 0.1096s/iter; left time: 5367.6743s
	iters: 2100, epoch: 2 | loss: 0.0983411
	speed: 0.1115s/iter; left time: 5452.8035s
	iters: 2200, epoch: 2 | loss: 0.0992421
	speed: 0.1160s/iter; left time: 5660.8030s
	iters: 2300, epoch: 2 | loss: 0.0934880
	speed: 0.1209s/iter; left time: 5886.0998s
	iters: 2400, epoch: 2 | loss: 0.1001284
	speed: 0.1206s/iter; left time: 5862.0561s
	iters: 2500, epoch: 2 | loss: 0.0928106
	speed: 0.1182s/iter; left time: 5733.7461s
	iters: 2600, epoch: 2 | loss: 0.0870252
	speed: 0.1209s/iter; left time: 5852.0493s
Epoch: 2 cost time: 00h:04m:58.85s
Epoch: 2 | Train Loss: 0.0990444 Vali Loss: 0.0869754 Test Loss: 0.0983193
Validation loss decreased (0.091249 --> 0.086975).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.1038128
	speed: 0.9964s/iter; left time: 48039.4661s
	iters: 200, epoch: 3 | loss: 0.0941214
	speed: 0.1201s/iter; left time: 5779.3333s
	iters: 300, epoch: 3 | loss: 0.0934169
	speed: 0.1213s/iter; left time: 5824.3659s
	iters: 400, epoch: 3 | loss: 0.0778983
	speed: 0.1209s/iter; left time: 5790.6581s
	iters: 500, epoch: 3 | loss: 0.0914758
	speed: 0.1210s/iter; left time: 5786.5365s
	iters: 600, epoch: 3 | loss: 0.0881995
	speed: 0.1208s/iter; left time: 5763.0747s
	iters: 700, epoch: 3 | loss: 0.0977619
	speed: 0.1166s/iter; left time: 5551.1786s
	iters: 800, epoch: 3 | loss: 0.1015535
	speed: 0.1195s/iter; left time: 5676.9406s
	iters: 900, epoch: 3 | loss: 0.1082432
	speed: 0.1198s/iter; left time: 5681.4679s
	iters: 1000, epoch: 3 | loss: 0.0877309
	speed: 0.1202s/iter; left time: 5687.6272s
	iters: 1100, epoch: 3 | loss: 0.1051150
	speed: 0.1181s/iter; left time: 5577.2203s
	iters: 1200, epoch: 3 | loss: 0.0997433
	speed: 0.1216s/iter; left time: 5729.0933s
	iters: 1300, epoch: 3 | loss: 0.1073216
	speed: 0.1207s/iter; left time: 5673.5919s
	iters: 1400, epoch: 3 | loss: 0.1008831
	speed: 0.1204s/iter; left time: 5647.8936s
	iters: 1500, epoch: 3 | loss: 0.1161132
	speed: 0.1190s/iter; left time: 5572.2122s
	iters: 1600, epoch: 3 | loss: 0.0918901
	speed: 0.1205s/iter; left time: 5629.8350s
	iters: 1700, epoch: 3 | loss: 0.0909352
	speed: 0.1207s/iter; left time: 5625.9115s
	iters: 1800, epoch: 3 | loss: 0.1053216
	speed: 0.1179s/iter; left time: 5486.0038s
	iters: 1900, epoch: 3 | loss: 0.0864966
	speed: 0.1188s/iter; left time: 5515.0144s
	iters: 2000, epoch: 3 | loss: 0.0899872
	speed: 0.1170s/iter; left time: 5416.6913s
	iters: 2100, epoch: 3 | loss: 0.0996342
	speed: 0.1210s/iter; left time: 5589.6104s
	iters: 2200, epoch: 3 | loss: 0.0904091
	speed: 0.1197s/iter; left time: 5521.2046s
	iters: 2300, epoch: 3 | loss: 0.0838375
	speed: 0.1196s/iter; left time: 5503.2014s
	iters: 2400, epoch: 3 | loss: 0.0930159
	speed: 0.1201s/iter; left time: 5513.1989s
	iters: 2500, epoch: 3 | loss: 0.0981316
	speed: 0.1194s/iter; left time: 5470.3641s
	iters: 2600, epoch: 3 | loss: 0.0863672
	speed: 0.1208s/iter; left time: 5523.6617s
Epoch: 3 cost time: 00h:05m:22.30s
Epoch: 3 | Train Loss: 0.0952172 Vali Loss: 0.0876163 Test Loss: 0.0995333
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0895635
	speed: 0.9674s/iter; left time: 44045.3275s
	iters: 200, epoch: 4 | loss: 0.0948796
	speed: 0.1135s/iter; left time: 5154.2111s
	iters: 300, epoch: 4 | loss: 0.1079016
	speed: 0.1192s/iter; left time: 5402.4415s
	iters: 400, epoch: 4 | loss: 0.0807232
	speed: 0.1204s/iter; left time: 5447.4501s
	iters: 500, epoch: 4 | loss: 0.0917320
	speed: 0.1206s/iter; left time: 5443.9061s
	iters: 600, epoch: 4 | loss: 0.1008527
	speed: 0.1212s/iter; left time: 5457.4455s
	iters: 700, epoch: 4 | loss: 0.0905929
	speed: 0.1211s/iter; left time: 5441.5946s
	iters: 800, epoch: 4 | loss: 0.0817054
	speed: 0.1209s/iter; left time: 5418.5595s
	iters: 900, epoch: 4 | loss: 0.1022704
	speed: 0.1202s/iter; left time: 5376.9019s
	iters: 1000, epoch: 4 | loss: 0.0999512
	speed: 0.1211s/iter; left time: 5404.3136s
	iters: 1100, epoch: 4 | loss: 0.0844137
	speed: 0.1180s/iter; left time: 5256.2973s
	iters: 1200, epoch: 4 | loss: 0.0867865
	speed: 0.1206s/iter; left time: 5359.1979s
	iters: 1300, epoch: 4 | loss: 0.1027440
	speed: 0.1200s/iter; left time: 5320.0796s
	iters: 1400, epoch: 4 | loss: 0.0912939
	speed: 0.1153s/iter; left time: 5100.1629s
	iters: 1500, epoch: 4 | loss: 0.0903338
	speed: 0.1172s/iter; left time: 5172.8185s
	iters: 1600, epoch: 4 | loss: 0.0982658
	speed: 0.1160s/iter; left time: 5108.6095s
	iters: 1700, epoch: 4 | loss: 0.1128476
	speed: 0.1203s/iter; left time: 5285.2844s
	iters: 1800, epoch: 4 | loss: 0.0907316
	speed: 0.1210s/iter; left time: 5305.2216s
	iters: 1900, epoch: 4 | loss: 0.0883882
	speed: 0.1180s/iter; left time: 5161.3531s
	iters: 2000, epoch: 4 | loss: 0.0840461
	speed: 0.1159s/iter; left time: 5057.2308s
	iters: 2100, epoch: 4 | loss: 0.0890422
	speed: 0.1211s/iter; left time: 5272.9600s
	iters: 2200, epoch: 4 | loss: 0.0912848
	speed: 0.1211s/iter; left time: 5258.3974s
	iters: 2300, epoch: 4 | loss: 0.0897235
	speed: 0.1185s/iter; left time: 5134.2887s
	iters: 2400, epoch: 4 | loss: 0.1019709
	speed: 0.1184s/iter; left time: 5116.5241s
	iters: 2500, epoch: 4 | loss: 0.1029302
	speed: 0.1200s/iter; left time: 5173.7312s
	iters: 2600, epoch: 4 | loss: 0.0911055
	speed: 0.1146s/iter; left time: 4929.7989s
Epoch: 4 cost time: 00h:05m:19.24s
Epoch: 4 | Train Loss: 0.0930185 Vali Loss: 0.0847382 Test Loss: 0.0970126
Validation loss decreased (0.086975 --> 0.084738).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0929508
	speed: 1.0025s/iter; left time: 42951.2239s
	iters: 200, epoch: 5 | loss: 0.0826883
	speed: 0.1199s/iter; left time: 5124.5079s
	iters: 300, epoch: 5 | loss: 0.0946675
	speed: 0.1210s/iter; left time: 5160.7740s
	iters: 400, epoch: 5 | loss: 0.0974359
	speed: 0.1195s/iter; left time: 5082.2881s
	iters: 500, epoch: 5 | loss: 0.0892060
	speed: 0.1167s/iter; left time: 4953.6776s
	iters: 600, epoch: 5 | loss: 0.0965789
	speed: 0.1204s/iter; left time: 5096.6301s
	iters: 700, epoch: 5 | loss: 0.0803632
	speed: 0.1200s/iter; left time: 5067.3871s
	iters: 800, epoch: 5 | loss: 0.0816639
	speed: 0.1213s/iter; left time: 5113.3156s
	iters: 900, epoch: 5 | loss: 0.0796301
	speed: 0.1208s/iter; left time: 5080.1200s
	iters: 1000, epoch: 5 | loss: 0.0947778
	speed: 0.1208s/iter; left time: 5066.0018s
	iters: 1100, epoch: 5 | loss: 0.0807358
	speed: 0.1191s/iter; left time: 4983.2578s
	iters: 1200, epoch: 5 | loss: 0.0978350
	speed: 0.1177s/iter; left time: 4913.5078s
	iters: 1300, epoch: 5 | loss: 0.0848728
	speed: 0.1177s/iter; left time: 4903.4044s
	iters: 1400, epoch: 5 | loss: 0.0797540
	speed: 0.1152s/iter; left time: 4787.1344s
	iters: 1500, epoch: 5 | loss: 0.0875790
	speed: 0.1201s/iter; left time: 4976.1642s
	iters: 1600, epoch: 5 | loss: 0.0836178
	speed: 0.1178s/iter; left time: 4869.7515s
	iters: 1700, epoch: 5 | loss: 0.0997139
	speed: 0.1199s/iter; left time: 4944.8162s
	iters: 1800, epoch: 5 | loss: 0.0831015
	speed: 0.1210s/iter; left time: 4979.7305s
	iters: 1900, epoch: 5 | loss: 0.0892239
	speed: 0.1206s/iter; left time: 4948.1102s
	iters: 2000, epoch: 5 | loss: 0.0964089
	speed: 0.1180s/iter; left time: 4832.3976s
	iters: 2100, epoch: 5 | loss: 0.0864571
	speed: 0.1157s/iter; left time: 4726.1310s
	iters: 2200, epoch: 5 | loss: 0.0878882
	speed: 0.1009s/iter; left time: 4112.1107s
	iters: 2300, epoch: 5 | loss: 0.0879328
	speed: 0.1120s/iter; left time: 4552.9007s
	iters: 2400, epoch: 5 | loss: 0.0824142
	speed: 0.1168s/iter; left time: 4735.5517s
	iters: 2500, epoch: 5 | loss: 0.0919031
	speed: 0.1178s/iter; left time: 4762.9217s
	iters: 2600, epoch: 5 | loss: 0.0861144
	speed: 0.1173s/iter; left time: 4730.6570s
Epoch: 5 cost time: 00h:05m:17.24s
Epoch: 5 | Train Loss: 0.0909510 Vali Loss: 0.0893654 Test Loss: 0.1023573
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0915587
	speed: 0.9724s/iter; left time: 39053.6271s
	iters: 200, epoch: 6 | loss: 0.0839357
	speed: 0.1172s/iter; left time: 4696.5596s
	iters: 300, epoch: 6 | loss: 0.0889259
	speed: 0.1207s/iter; left time: 4824.6661s
	iters: 400, epoch: 6 | loss: 0.0936077
	speed: 0.1174s/iter; left time: 4681.1153s
	iters: 500, epoch: 6 | loss: 0.0880979
	speed: 0.1211s/iter; left time: 4814.4650s
	iters: 600, epoch: 6 | loss: 0.0841514
	speed: 0.1163s/iter; left time: 4613.3570s
	iters: 700, epoch: 6 | loss: 0.0755864
	speed: 0.1119s/iter; left time: 4424.9740s
	iters: 800, epoch: 6 | loss: 0.0940484
	speed: 0.1193s/iter; left time: 4709.3520s
	iters: 900, epoch: 6 | loss: 0.0851911
	speed: 0.1204s/iter; left time: 4738.1928s
	iters: 1000, epoch: 6 | loss: 0.0822518
	speed: 0.1171s/iter; left time: 4596.1306s
	iters: 1100, epoch: 6 | loss: 0.0868344
	speed: 0.1186s/iter; left time: 4645.2629s
	iters: 1200, epoch: 6 | loss: 0.0963878
	speed: 0.1201s/iter; left time: 4691.8284s
	iters: 1300, epoch: 6 | loss: 0.0748070
	speed: 0.1208s/iter; left time: 4707.5500s
	iters: 1400, epoch: 6 | loss: 0.0844528
	speed: 0.1209s/iter; left time: 4699.4556s
	iters: 1500, epoch: 6 | loss: 0.1027090
	speed: 0.1202s/iter; left time: 4657.6838s
	iters: 1600, epoch: 6 | loss: 0.0973790
	speed: 0.1175s/iter; left time: 4543.9550s
	iters: 1700, epoch: 6 | loss: 0.0843874
	speed: 0.1152s/iter; left time: 4442.2165s
	iters: 1800, epoch: 6 | loss: 0.0826969
	speed: 0.1178s/iter; left time: 4530.4196s
	iters: 1900, epoch: 6 | loss: 0.0803014
	speed: 0.1199s/iter; left time: 4599.0814s
	iters: 2000, epoch: 6 | loss: 0.0895572
	speed: 0.1163s/iter; left time: 4449.4302s
	iters: 2100, epoch: 6 | loss: 0.0838565
	speed: 0.1150s/iter; left time: 4389.7193s
	iters: 2200, epoch: 6 | loss: 0.0904025
	speed: 0.1150s/iter; left time: 4378.3628s
	iters: 2300, epoch: 6 | loss: 0.0983820
	speed: 0.1139s/iter; left time: 4323.7095s
	iters: 2400, epoch: 6 | loss: 0.0976380
	speed: 0.1158s/iter; left time: 4382.8892s
	iters: 2500, epoch: 6 | loss: 0.0838670
	speed: 0.1193s/iter; left time: 4505.8964s
	iters: 2600, epoch: 6 | loss: 0.0699371
	speed: 0.1031s/iter; left time: 3882.8722s
Epoch: 6 cost time: 00h:05m:13.96s
Epoch: 6 | Train Loss: 0.0890947 Vali Loss: 0.0903814 Test Loss: 0.1015913
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0818404
	speed: 0.9498s/iter; left time: 35597.2597s
	iters: 200, epoch: 7 | loss: 0.0816711
	speed: 0.1205s/iter; left time: 4505.1611s
	iters: 300, epoch: 7 | loss: 0.0799331
	speed: 0.1183s/iter; left time: 4408.2543s
	iters: 400, epoch: 7 | loss: 0.0868699
	speed: 0.1196s/iter; left time: 4447.8012s
	iters: 500, epoch: 7 | loss: 0.0727430
	speed: 0.1205s/iter; left time: 4468.0822s
	iters: 600, epoch: 7 | loss: 0.1011259
	speed: 0.1199s/iter; left time: 4433.9748s
	iters: 700, epoch: 7 | loss: 0.0941924
	speed: 0.1167s/iter; left time: 4303.5286s
	iters: 800, epoch: 7 | loss: 0.1013498
	speed: 0.1180s/iter; left time: 4338.7645s
	iters: 900, epoch: 7 | loss: 0.0759829
	speed: 0.1145s/iter; left time: 4200.3665s
	iters: 1000, epoch: 7 | loss: 0.0930336
	speed: 0.1187s/iter; left time: 4343.0069s
	iters: 1100, epoch: 7 | loss: 0.0847954
	speed: 0.1173s/iter; left time: 4279.1998s
	iters: 1200, epoch: 7 | loss: 0.0941292
	speed: 0.1117s/iter; left time: 4064.6430s
	iters: 1300, epoch: 7 | loss: 0.0802033
	speed: 0.1201s/iter; left time: 4357.1399s
	iters: 1400, epoch: 7 | loss: 0.0939994
	speed: 0.1140s/iter; left time: 4122.7113s
	iters: 1500, epoch: 7 | loss: 0.0865828
	speed: 0.1168s/iter; left time: 4214.2135s
	iters: 1600, epoch: 7 | loss: 0.1023660
	speed: 0.1166s/iter; left time: 4193.9149s
	iters: 1700, epoch: 7 | loss: 0.0873066
	speed: 0.1160s/iter; left time: 4160.8034s
	iters: 1800, epoch: 7 | loss: 0.0956445
	speed: 0.1195s/iter; left time: 4275.3586s
	iters: 1900, epoch: 7 | loss: 0.0968382
	speed: 0.1204s/iter; left time: 4296.9154s
	iters: 2000, epoch: 7 | loss: 0.0982233
	speed: 0.1196s/iter; left time: 4255.4905s
	iters: 2100, epoch: 7 | loss: 0.0968592
	speed: 0.1206s/iter; left time: 4280.2815s
	iters: 2200, epoch: 7 | loss: 0.0934383
	speed: 0.1163s/iter; left time: 4115.5740s
	iters: 2300, epoch: 7 | loss: 0.0847614
	speed: 0.1069s/iter; left time: 3769.4850s
	iters: 2400, epoch: 7 | loss: 0.0907320
	speed: 0.0988s/iter; left time: 3476.2804s
	iters: 2500, epoch: 7 | loss: 0.0855488
	speed: 0.1049s/iter; left time: 3679.9229s
	iters: 2600, epoch: 7 | loss: 0.0829888
	speed: 0.1192s/iter; left time: 4168.3115s
Epoch: 7 cost time: 00h:05m:12.16s
Epoch: 7 | Train Loss: 0.0873331 Vali Loss: 0.0918732 Test Loss: 0.1017229
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0874928
	speed: 0.9747s/iter; left time: 33914.2749s
	iters: 200, epoch: 8 | loss: 0.0883391
	speed: 0.1208s/iter; left time: 4192.1919s
	iters: 300, epoch: 8 | loss: 0.0920282
	speed: 0.1206s/iter; left time: 4172.7244s
	iters: 400, epoch: 8 | loss: 0.0959568
	speed: 0.1160s/iter; left time: 4002.3766s
	iters: 500, epoch: 8 | loss: 0.0956558
	speed: 0.1137s/iter; left time: 3911.7858s
	iters: 600, epoch: 8 | loss: 0.0814130
	speed: 0.1138s/iter; left time: 3903.7645s
	iters: 700, epoch: 8 | loss: 0.0857233
	speed: 0.1151s/iter; left time: 3936.0245s
	iters: 800, epoch: 8 | loss: 0.0938325
	speed: 0.1149s/iter; left time: 3917.1635s
	iters: 900, epoch: 8 | loss: 0.0937250
	speed: 0.1155s/iter; left time: 3927.7969s
	iters: 1000, epoch: 8 | loss: 0.0781743
	speed: 0.1171s/iter; left time: 3970.0446s
	iters: 1100, epoch: 8 | loss: 0.0944517
	speed: 0.1190s/iter; left time: 4020.8408s
	iters: 1200, epoch: 8 | loss: 0.0741252
	speed: 0.1204s/iter; left time: 4056.7614s
	iters: 1300, epoch: 8 | loss: 0.0715947
	speed: 0.1169s/iter; left time: 3927.1916s
	iters: 1400, epoch: 8 | loss: 0.0883247
	speed: 0.1207s/iter; left time: 4041.0368s
	iters: 1500, epoch: 8 | loss: 0.0868704
	speed: 0.1211s/iter; left time: 4044.6174s
	iters: 1600, epoch: 8 | loss: 0.0939969
	speed: 0.1207s/iter; left time: 4018.8690s
	iters: 1700, epoch: 8 | loss: 0.0877550
	speed: 0.1188s/iter; left time: 3943.0573s
	iters: 1800, epoch: 8 | loss: 0.0865582
	speed: 0.1168s/iter; left time: 3866.4770s
	iters: 1900, epoch: 8 | loss: 0.0877632
	speed: 0.1206s/iter; left time: 3980.0795s
	iters: 2000, epoch: 8 | loss: 0.0904972
	speed: 0.1198s/iter; left time: 3942.0435s
	iters: 2100, epoch: 8 | loss: 0.0918995
	speed: 0.1113s/iter; left time: 3650.8766s
	iters: 2200, epoch: 8 | loss: 0.0880162
	speed: 0.0986s/iter; left time: 3224.0149s
	iters: 2300, epoch: 8 | loss: 0.0901393
	speed: 0.0995s/iter; left time: 3243.9052s
	iters: 2400, epoch: 8 | loss: 0.0813730
	speed: 0.1093s/iter; left time: 3550.2013s
	iters: 2500, epoch: 8 | loss: 0.0902627
	speed: 0.1151s/iter; left time: 3727.5932s
	iters: 2600, epoch: 8 | loss: 0.0779674
	speed: 0.1148s/iter; left time: 3707.7360s
Epoch: 8 cost time: 00h:05m:09.77s
Epoch: 8 | Train Loss: 0.0859112 Vali Loss: 0.0929700 Test Loss: 0.1019867
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.0787471
	speed: 0.9498s/iter; left time: 30497.4128s
	iters: 200, epoch: 9 | loss: 0.0741966
	speed: 0.1207s/iter; left time: 3863.2914s
	iters: 300, epoch: 9 | loss: 0.0855073
	speed: 0.1000s/iter; left time: 3191.7296s
	iters: 400, epoch: 9 | loss: 0.0870367
	speed: 0.1007s/iter; left time: 3204.3736s
	iters: 500, epoch: 9 | loss: 0.0798489
	speed: 0.1197s/iter; left time: 3795.4704s
	iters: 600, epoch: 9 | loss: 0.0822773
	speed: 0.1157s/iter; left time: 3658.4578s
	iters: 700, epoch: 9 | loss: 0.0890888
	speed: 0.1152s/iter; left time: 3631.3840s
	iters: 800, epoch: 9 | loss: 0.0833702
	speed: 0.1192s/iter; left time: 3743.8704s
	iters: 900, epoch: 9 | loss: 0.0905662
	speed: 0.1181s/iter; left time: 3698.1330s
	iters: 1000, epoch: 9 | loss: 0.0836187
	speed: 0.1191s/iter; left time: 3717.9772s
	iters: 1100, epoch: 9 | loss: 0.0860944
	speed: 0.1085s/iter; left time: 3375.6543s
	iters: 1200, epoch: 9 | loss: 0.0905798
	speed: 0.1175s/iter; left time: 3644.6725s
	iters: 1300, epoch: 9 | loss: 0.0945324
	speed: 0.1188s/iter; left time: 3672.6808s
	iters: 1400, epoch: 9 | loss: 0.0950186
	speed: 0.1207s/iter; left time: 3719.6932s
	iters: 1500, epoch: 9 | loss: 0.0807866
	speed: 0.1212s/iter; left time: 3722.9836s
	iters: 1600, epoch: 9 | loss: 0.0886903
	speed: 0.1214s/iter; left time: 3716.6798s
	iters: 1700, epoch: 9 | loss: 0.0865668
	speed: 0.1197s/iter; left time: 3651.5093s
	iters: 1800, epoch: 9 | loss: 0.1007445
	speed: 0.1214s/iter; left time: 3692.1223s
	iters: 1900, epoch: 9 | loss: 0.0763340
	speed: 0.1209s/iter; left time: 3664.0420s
	iters: 2000, epoch: 9 | loss: 0.0765861
	speed: 0.1181s/iter; left time: 3566.9978s
	iters: 2100, epoch: 9 | loss: 0.0786577
	speed: 0.1166s/iter; left time: 3510.5500s
	iters: 2200, epoch: 9 | loss: 0.0867473
	speed: 0.1143s/iter; left time: 3429.0570s
	iters: 2300, epoch: 9 | loss: 0.0803090
	speed: 0.1174s/iter; left time: 3510.2132s
	iters: 2400, epoch: 9 | loss: 0.0835162
	speed: 0.1194s/iter; left time: 3559.9645s
	iters: 2500, epoch: 9 | loss: 0.0848668
	speed: 0.1213s/iter; left time: 3604.7663s
	iters: 2600, epoch: 9 | loss: 0.0791643
	speed: 0.1211s/iter; left time: 3586.6447s
Epoch: 9 cost time: 00h:05m:15.40s
Epoch: 9 | Train Loss: 0.0844346 Vali Loss: 0.0939959 Test Loss: 0.1040973
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.021669914945960045, rmse:0.14720705151557922, mae:0.09701256453990936, rse:0.4322395920753479
success delete checkpoints
Intermediate time for ES and pred_len 168: 00h:59m:42.76s
Intermediate time for ES: 03h:16m:54.38s

=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
train 86331
val 18651
test 18651
[2024-11-02 17:12:24,451] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-02 17:12:25,602] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-02 17:12:25,602] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-02 17:12:25,602] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-02 17:12:25,704] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-02 17:12:25,704] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-02 17:12:26,388] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-02 17:12:26,390] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-02 17:12:26,390] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-02 17:12:26,391] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-02 17:12:26,391] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-02 17:12:26,391] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-02 17:12:26,392] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-02 17:12:26,392] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-02 17:12:26,392] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-02 17:12:26,392] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-02 17:12:26,729] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-02 17:12:26,730] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-02 17:12:26,730] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 75.52 GB, percent = 10.0%
[2024-11-02 17:12:26,855] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-02 17:12:26,856] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 17:12:26,856] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 75.52 GB, percent = 10.0%
[2024-11-02 17:12:26,857] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-02 17:12:26,981] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-02 17:12:26,982] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 17:12:26,982] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 75.52 GB, percent = 10.0%
[2024-11-02 17:12:26,983] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-02 17:12:26,983] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-02 17:12:26,983] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-02 17:12:26,983] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-02 17:12:26,983] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-02 17:12:26,984] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-02 17:12:26,984] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-02 17:12:26,984] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-02 17:12:26,984] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-02 17:12:26,984] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-02 17:12:26,984] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-02 17:12:26,984] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-02 17:12:26,984] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-02 17:12:26,984] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-02 17:12:26,984] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-02 17:12:26,984] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f73cce4d3d0>
[2024-11-02 17:12:26,984] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-02 17:12:26,984] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-02 17:12:26,984] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-02 17:12:26,984] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-02 17:12:26,985] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-02 17:12:26,986] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-02 17:12:26,986] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1235450
	speed: 0.1709s/iter; left time: 9199.2743s
	iters: 200, epoch: 1 | loss: 0.1423506
	speed: 0.1264s/iter; left time: 6791.4893s
	iters: 300, epoch: 1 | loss: 0.1272179
	speed: 0.1274s/iter; left time: 6835.9856s
	iters: 400, epoch: 1 | loss: 0.0875500
	speed: 0.1272s/iter; left time: 6808.7591s
	iters: 500, epoch: 1 | loss: 0.0672416
	speed: 0.1263s/iter; left time: 6751.9674s
	iters: 600, epoch: 1 | loss: 0.0630464
	speed: 0.1064s/iter; left time: 5676.5741s
	iters: 700, epoch: 1 | loss: 0.0556630
	speed: 0.1132s/iter; left time: 6025.5661s
	iters: 800, epoch: 1 | loss: 0.0871794
	speed: 0.1206s/iter; left time: 6411.3034s
	iters: 900, epoch: 1 | loss: 0.0597571
	speed: 0.1234s/iter; left time: 6543.0970s
	iters: 1000, epoch: 1 | loss: 0.0630214
	speed: 0.1252s/iter; left time: 6630.3009s
	iters: 1100, epoch: 1 | loss: 0.0680356
	speed: 0.1159s/iter; left time: 6121.6533s
	iters: 1200, epoch: 1 | loss: 0.0580192
	speed: 0.1251s/iter; left time: 6595.4756s
	iters: 1300, epoch: 1 | loss: 0.0591872
	speed: 0.1258s/iter; left time: 6620.7701s
	iters: 1400, epoch: 1 | loss: 0.0653023
	speed: 0.1249s/iter; left time: 6559.8268s
	iters: 1500, epoch: 1 | loss: 0.0712432
	speed: 0.1207s/iter; left time: 6328.8275s
	iters: 1600, epoch: 1 | loss: 0.0695876
	speed: 0.1167s/iter; left time: 6108.8087s
	iters: 1700, epoch: 1 | loss: 0.0758628
	speed: 0.1251s/iter; left time: 6537.7578s
	iters: 1800, epoch: 1 | loss: 0.0618466
	speed: 0.1250s/iter; left time: 6517.0575s
	iters: 1900, epoch: 1 | loss: 0.0605258
	speed: 0.1239s/iter; left time: 6450.2507s
	iters: 2000, epoch: 1 | loss: 0.0676748
	speed: 0.1252s/iter; left time: 6502.8349s
	iters: 2100, epoch: 1 | loss: 0.0548497
	speed: 0.1245s/iter; left time: 6453.6853s
	iters: 2200, epoch: 1 | loss: 0.0646279
	speed: 0.1233s/iter; left time: 6379.6147s
	iters: 2300, epoch: 1 | loss: 0.0551258
	speed: 0.1231s/iter; left time: 6357.6462s
	iters: 2400, epoch: 1 | loss: 0.0547290
	speed: 0.1202s/iter; left time: 6193.7285s
	iters: 2500, epoch: 1 | loss: 0.0605357
	speed: 0.1090s/iter; left time: 5608.3225s
	iters: 2600, epoch: 1 | loss: 0.0547643
	speed: 0.1256s/iter; left time: 6447.3371s
Epoch: 1 cost time: 00h:05m:31.08s
Epoch: 1 | Train Loss: 0.0753777 Vali Loss: 0.0618922 Test Loss: 0.0666550
Validation loss decreased (inf --> 0.061892).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0666260
	speed: 1.1350s/iter; left time: 58048.2317s
	iters: 200, epoch: 2 | loss: 0.0643385
	speed: 0.1153s/iter; left time: 5883.9379s
	iters: 300, epoch: 2 | loss: 0.0632871
	speed: 0.1162s/iter; left time: 5920.8166s
	iters: 400, epoch: 2 | loss: 0.0495252
	speed: 0.1149s/iter; left time: 5841.7038s
	iters: 500, epoch: 2 | loss: 0.0526561
	speed: 0.1160s/iter; left time: 5884.0225s
	iters: 600, epoch: 2 | loss: 0.0668836
	speed: 0.1148s/iter; left time: 5812.2386s
	iters: 700, epoch: 2 | loss: 0.0494954
	speed: 0.1163s/iter; left time: 5877.8236s
	iters: 800, epoch: 2 | loss: 0.0575383
	speed: 0.1176s/iter; left time: 5930.1979s
	iters: 900, epoch: 2 | loss: 0.0667061
	speed: 0.1162s/iter; left time: 5851.7246s
	iters: 1000, epoch: 2 | loss: 0.0703753
	speed: 0.1163s/iter; left time: 5842.2256s
	iters: 1100, epoch: 2 | loss: 0.0538771
	speed: 0.1175s/iter; left time: 5891.4125s
	iters: 1200, epoch: 2 | loss: 0.0611253
	speed: 0.1161s/iter; left time: 5811.7703s
	iters: 1300, epoch: 2 | loss: 0.0747418
	speed: 0.1162s/iter; left time: 5801.6492s
	iters: 1400, epoch: 2 | loss: 0.0687371
	speed: 0.1164s/iter; left time: 5799.8883s
	iters: 1500, epoch: 2 | loss: 0.0663108
	speed: 0.1131s/iter; left time: 5625.1032s
	iters: 1600, epoch: 2 | loss: 0.0538801
	speed: 0.1160s/iter; left time: 5757.7508s
	iters: 1700, epoch: 2 | loss: 0.0519770
	speed: 0.1161s/iter; left time: 5750.7496s
	iters: 1800, epoch: 2 | loss: 0.0473880
	speed: 0.1157s/iter; left time: 5720.8980s
	iters: 1900, epoch: 2 | loss: 0.0611360
	speed: 0.1091s/iter; left time: 5382.2693s
	iters: 2000, epoch: 2 | loss: 0.0615671
	speed: 0.1157s/iter; left time: 5697.1500s
	iters: 2100, epoch: 2 | loss: 0.0669719
	speed: 0.1144s/iter; left time: 5622.4151s
	iters: 2200, epoch: 2 | loss: 0.0486104
	speed: 0.1115s/iter; left time: 5466.5169s
	iters: 2300, epoch: 2 | loss: 0.0629132
	speed: 0.0996s/iter; left time: 4874.3981s
	iters: 2400, epoch: 2 | loss: 0.0576007
	speed: 0.1159s/iter; left time: 5658.8639s
	iters: 2500, epoch: 2 | loss: 0.0599707
	speed: 0.1151s/iter; left time: 5612.5594s
	iters: 2600, epoch: 2 | loss: 0.0471631
	speed: 0.1138s/iter; left time: 5536.1960s
Epoch: 2 cost time: 00h:05m:09.65s
Epoch: 2 | Train Loss: 0.0591769 Vali Loss: 0.0600467 Test Loss: 0.0646332
Validation loss decreased (0.061892 --> 0.060047).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0599396
	speed: 1.0017s/iter; left time: 48531.2763s
	iters: 200, epoch: 3 | loss: 0.0531570
	speed: 0.1156s/iter; left time: 5589.2050s
	iters: 300, epoch: 3 | loss: 0.0663147
	speed: 0.1158s/iter; left time: 5586.6661s
	iters: 400, epoch: 3 | loss: 0.0573017
	speed: 0.1159s/iter; left time: 5580.3935s
	iters: 500, epoch: 3 | loss: 0.0458791
	speed: 0.1154s/iter; left time: 5546.2894s
	iters: 600, epoch: 3 | loss: 0.0676508
	speed: 0.1149s/iter; left time: 5509.2006s
	iters: 700, epoch: 3 | loss: 0.0643910
	speed: 0.1139s/iter; left time: 5447.9562s
	iters: 800, epoch: 3 | loss: 0.0421067
	speed: 0.1138s/iter; left time: 5435.4103s
	iters: 900, epoch: 3 | loss: 0.0515741
	speed: 0.1167s/iter; left time: 5561.4390s
	iters: 1000, epoch: 3 | loss: 0.0688308
	speed: 0.1143s/iter; left time: 5432.7623s
	iters: 1100, epoch: 3 | loss: 0.0621392
	speed: 0.1157s/iter; left time: 5488.6243s
	iters: 1200, epoch: 3 | loss: 0.0543004
	speed: 0.1139s/iter; left time: 5393.9227s
	iters: 1300, epoch: 3 | loss: 0.0568760
	speed: 0.1123s/iter; left time: 5308.0440s
	iters: 1400, epoch: 3 | loss: 0.0596535
	speed: 0.1156s/iter; left time: 5449.7068s
	iters: 1500, epoch: 3 | loss: 0.0517118
	speed: 0.1175s/iter; left time: 5526.7793s
	iters: 1600, epoch: 3 | loss: 0.0598669
	speed: 0.1141s/iter; left time: 5355.7305s
	iters: 1700, epoch: 3 | loss: 0.0843264
	speed: 0.1161s/iter; left time: 5440.6865s
	iters: 1800, epoch: 3 | loss: 0.0665351
	speed: 0.1159s/iter; left time: 5417.3726s
	iters: 1900, epoch: 3 | loss: 0.0814799
	speed: 0.1170s/iter; left time: 5457.2950s
	iters: 2000, epoch: 3 | loss: 0.0534720
	speed: 0.1156s/iter; left time: 5381.8339s
	iters: 2100, epoch: 3 | loss: 0.0550123
	speed: 0.1146s/iter; left time: 5323.4283s
	iters: 2200, epoch: 3 | loss: 0.0583318
	speed: 0.1139s/iter; left time: 5279.1013s
	iters: 2300, epoch: 3 | loss: 0.0620737
	speed: 0.1148s/iter; left time: 5309.9709s
	iters: 2400, epoch: 3 | loss: 0.0487021
	speed: 0.1148s/iter; left time: 5295.7191s
	iters: 2500, epoch: 3 | loss: 0.0631454
	speed: 0.1149s/iter; left time: 5290.4083s
	iters: 2600, epoch: 3 | loss: 0.0609962
	speed: 0.1161s/iter; left time: 5334.7029s
Epoch: 3 cost time: 00h:05m:11.05s
Epoch: 3 | Train Loss: 0.0568341 Vali Loss: 0.0582712 Test Loss: 0.0628686
Validation loss decreased (0.060047 --> 0.058271).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0608920
	speed: 0.9958s/iter; left time: 45557.7186s
	iters: 200, epoch: 4 | loss: 0.0551032
	speed: 0.1162s/iter; left time: 5303.4218s
	iters: 300, epoch: 4 | loss: 0.0613622
	speed: 0.1152s/iter; left time: 5247.1252s
	iters: 400, epoch: 4 | loss: 0.0487876
	speed: 0.1171s/iter; left time: 5320.0904s
	iters: 500, epoch: 4 | loss: 0.0552078
	speed: 0.1154s/iter; left time: 5235.0554s
	iters: 600, epoch: 4 | loss: 0.0562445
	speed: 0.1146s/iter; left time: 5183.8728s
	iters: 700, epoch: 4 | loss: 0.0495130
	speed: 0.1151s/iter; left time: 5198.9802s
	iters: 800, epoch: 4 | loss: 0.0537369
	speed: 0.1157s/iter; left time: 5212.9689s
	iters: 900, epoch: 4 | loss: 0.0510692
	speed: 0.1087s/iter; left time: 4886.4472s
	iters: 1000, epoch: 4 | loss: 0.0544674
	speed: 0.1074s/iter; left time: 4815.6019s
	iters: 1100, epoch: 4 | loss: 0.0422624
	speed: 0.1168s/iter; left time: 5226.3263s
	iters: 1200, epoch: 4 | loss: 0.0601855
	speed: 0.1161s/iter; left time: 5184.8261s
	iters: 1300, epoch: 4 | loss: 0.0548600
	speed: 0.1165s/iter; left time: 5188.9580s
	iters: 1400, epoch: 4 | loss: 0.0726929
	speed: 0.1159s/iter; left time: 5149.5405s
	iters: 1500, epoch: 4 | loss: 0.0452244
	speed: 0.1088s/iter; left time: 4826.8430s
	iters: 1600, epoch: 4 | loss: 0.0690438
	speed: 0.0972s/iter; left time: 4302.4621s
	iters: 1700, epoch: 4 | loss: 0.0575143
	speed: 0.1068s/iter; left time: 4713.2015s
	iters: 1800, epoch: 4 | loss: 0.0486670
	speed: 0.1148s/iter; left time: 5057.0657s
	iters: 1900, epoch: 4 | loss: 0.0498352
	speed: 0.1158s/iter; left time: 5091.6035s
	iters: 2000, epoch: 4 | loss: 0.0595263
	speed: 0.1151s/iter; left time: 5046.4383s
	iters: 2100, epoch: 4 | loss: 0.0519087
	speed: 0.1161s/iter; left time: 5077.3423s
	iters: 2200, epoch: 4 | loss: 0.0471623
	speed: 0.1157s/iter; left time: 5050.6021s
	iters: 2300, epoch: 4 | loss: 0.0451208
	speed: 0.1147s/iter; left time: 4993.9801s
	iters: 2400, epoch: 4 | loss: 0.0595563
	speed: 0.1163s/iter; left time: 5053.4402s
	iters: 2500, epoch: 4 | loss: 0.0549772
	speed: 0.1171s/iter; left time: 5077.2092s
	iters: 2600, epoch: 4 | loss: 0.0421879
	speed: 0.1182s/iter; left time: 5111.2165s
Epoch: 4 cost time: 00h:05m:07.48s
Epoch: 4 | Train Loss: 0.0554718 Vali Loss: 0.0564575 Test Loss: 0.0613898
Validation loss decreased (0.058271 --> 0.056457).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0640360
	speed: 1.0044s/iter; left time: 43243.4201s
	iters: 200, epoch: 5 | loss: 0.0555768
	speed: 0.1147s/iter; left time: 4925.9657s
	iters: 300, epoch: 5 | loss: 0.0411871
	speed: 0.1165s/iter; left time: 4991.0211s
	iters: 400, epoch: 5 | loss: 0.0514965
	speed: 0.1150s/iter; left time: 4918.4055s
	iters: 500, epoch: 5 | loss: 0.0501315
	speed: 0.1163s/iter; left time: 4960.9477s
	iters: 600, epoch: 5 | loss: 0.0461096
	speed: 0.1147s/iter; left time: 4880.6477s
	iters: 700, epoch: 5 | loss: 0.0579179
	speed: 0.1136s/iter; left time: 4820.8346s
	iters: 800, epoch: 5 | loss: 0.0609003
	speed: 0.1150s/iter; left time: 4869.3633s
	iters: 900, epoch: 5 | loss: 0.0671605
	speed: 0.1151s/iter; left time: 4861.7235s
	iters: 1000, epoch: 5 | loss: 0.0632332
	speed: 0.1173s/iter; left time: 4944.0046s
	iters: 1100, epoch: 5 | loss: 0.0637036
	speed: 0.1190s/iter; left time: 5004.7178s
	iters: 1200, epoch: 5 | loss: 0.0558049
	speed: 0.1176s/iter; left time: 4932.2707s
	iters: 1300, epoch: 5 | loss: 0.0510187
	speed: 0.1163s/iter; left time: 4866.3413s
	iters: 1400, epoch: 5 | loss: 0.0609071
	speed: 0.1148s/iter; left time: 4792.6565s
	iters: 1500, epoch: 5 | loss: 0.0545633
	speed: 0.1153s/iter; left time: 4803.1647s
	iters: 1600, epoch: 5 | loss: 0.0504324
	speed: 0.1138s/iter; left time: 4729.1776s
	iters: 1700, epoch: 5 | loss: 0.0481021
	speed: 0.1145s/iter; left time: 4745.4862s
	iters: 1800, epoch: 5 | loss: 0.0610766
	speed: 0.1147s/iter; left time: 4741.8071s
	iters: 1900, epoch: 5 | loss: 0.0627400
	speed: 0.1153s/iter; left time: 4756.0239s
	iters: 2000, epoch: 5 | loss: 0.0500407
	speed: 0.1143s/iter; left time: 4703.0922s
	iters: 2100, epoch: 5 | loss: 0.0583279
	speed: 0.1172s/iter; left time: 4811.2763s
	iters: 2200, epoch: 5 | loss: 0.0541765
	speed: 0.1158s/iter; left time: 4743.4718s
	iters: 2300, epoch: 5 | loss: 0.0596457
	speed: 0.1148s/iter; left time: 4689.5396s
	iters: 2400, epoch: 5 | loss: 0.0590647
	speed: 0.1144s/iter; left time: 4663.7620s
	iters: 2500, epoch: 5 | loss: 0.0656443
	speed: 0.1169s/iter; left time: 4751.0732s
	iters: 2600, epoch: 5 | loss: 0.0455275
	speed: 0.1183s/iter; left time: 4797.2323s
Epoch: 5 cost time: 00h:05m:12.21s
Epoch: 5 | Train Loss: 0.0542485 Vali Loss: 0.0564108 Test Loss: 0.0613056
Validation loss decreased (0.056457 --> 0.056411).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0637889
	speed: 0.9923s/iter; left time: 40045.1374s
	iters: 200, epoch: 6 | loss: 0.0451849
	speed: 0.1147s/iter; left time: 4618.4988s
	iters: 300, epoch: 6 | loss: 0.0558336
	speed: 0.1178s/iter; left time: 4731.3767s
	iters: 400, epoch: 6 | loss: 0.0449031
	speed: 0.1143s/iter; left time: 4579.4036s
	iters: 500, epoch: 6 | loss: 0.0486762
	speed: 0.1138s/iter; left time: 4548.7897s
	iters: 600, epoch: 6 | loss: 0.0463912
	speed: 0.1045s/iter; left time: 4163.3650s
	iters: 700, epoch: 6 | loss: 0.0641680
	speed: 0.1140s/iter; left time: 4531.3681s
	iters: 800, epoch: 6 | loss: 0.0503087
	speed: 0.1131s/iter; left time: 4486.3651s
	iters: 900, epoch: 6 | loss: 0.0475201
	speed: 0.1131s/iter; left time: 4472.9158s
	iters: 1000, epoch: 6 | loss: 0.0430374
	speed: 0.1087s/iter; left time: 4289.6954s
	iters: 1100, epoch: 6 | loss: 0.0464682
	speed: 0.1172s/iter; left time: 4612.2652s
	iters: 1200, epoch: 6 | loss: 0.0538542
	speed: 0.1124s/iter; left time: 4413.5484s
	iters: 1300, epoch: 6 | loss: 0.0497831
	speed: 0.1154s/iter; left time: 4516.9435s
	iters: 1400, epoch: 6 | loss: 0.0475077
	speed: 0.1203s/iter; left time: 4696.5876s
	iters: 1500, epoch: 6 | loss: 0.0516047
	speed: 0.1202s/iter; left time: 4684.0462s
	iters: 1600, epoch: 6 | loss: 0.0589632
	speed: 0.1198s/iter; left time: 4654.5062s
	iters: 1700, epoch: 6 | loss: 0.0611102
	speed: 0.1087s/iter; left time: 4214.3618s
	iters: 1800, epoch: 6 | loss: 0.0457706
	speed: 0.1011s/iter; left time: 3907.6123s
	iters: 1900, epoch: 6 | loss: 0.0506376
	speed: 0.1035s/iter; left time: 3989.7789s
	iters: 2000, epoch: 6 | loss: 0.0497848
	speed: 0.1010s/iter; left time: 3884.6604s
	iters: 2100, epoch: 6 | loss: 0.0544278
	speed: 0.1170s/iter; left time: 4486.9950s
	iters: 2200, epoch: 6 | loss: 0.0567052
	speed: 0.1170s/iter; left time: 4475.3916s
	iters: 2300, epoch: 6 | loss: 0.0539384
	speed: 0.1164s/iter; left time: 4440.4460s
	iters: 2400, epoch: 6 | loss: 0.0443573
	speed: 0.1149s/iter; left time: 4372.0053s
	iters: 2500, epoch: 6 | loss: 0.0481149
	speed: 0.1163s/iter; left time: 4415.3780s
	iters: 2600, epoch: 6 | loss: 0.0425841
	speed: 0.1157s/iter; left time: 4379.4275s
Epoch: 6 cost time: 00h:05m:06.57s
Epoch: 6 | Train Loss: 0.0533678 Vali Loss: 0.0547401 Test Loss: 0.0591254
Validation loss decreased (0.056411 --> 0.054740).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0502016
	speed: 1.0296s/iter; left time: 38773.3304s
	iters: 200, epoch: 7 | loss: 0.0561645
	speed: 0.1150s/iter; left time: 4319.0582s
	iters: 300, epoch: 7 | loss: 0.0592544
	speed: 0.1166s/iter; left time: 4368.5747s
	iters: 400, epoch: 7 | loss: 0.0523131
	speed: 0.1152s/iter; left time: 4302.4687s
	iters: 500, epoch: 7 | loss: 0.0502636
	speed: 0.1170s/iter; left time: 4358.5172s
	iters: 600, epoch: 7 | loss: 0.0607144
	speed: 0.1150s/iter; left time: 4271.4519s
	iters: 700, epoch: 7 | loss: 0.0567622
	speed: 0.1152s/iter; left time: 4267.8602s
	iters: 800, epoch: 7 | loss: 0.0611483
	speed: 0.1139s/iter; left time: 4207.9981s
	iters: 900, epoch: 7 | loss: 0.0641236
	speed: 0.1155s/iter; left time: 4257.5038s
	iters: 1000, epoch: 7 | loss: 0.0467553
	speed: 0.1152s/iter; left time: 4235.1825s
	iters: 1100, epoch: 7 | loss: 0.0538213
	speed: 0.1148s/iter; left time: 4209.1981s
	iters: 1200, epoch: 7 | loss: 0.0498144
	speed: 0.1148s/iter; left time: 4198.4598s
	iters: 1300, epoch: 7 | loss: 0.0496599
	speed: 0.1161s/iter; left time: 4231.8114s
	iters: 1400, epoch: 7 | loss: 0.0542373
	speed: 0.1173s/iter; left time: 4263.3834s
	iters: 1500, epoch: 7 | loss: 0.0536195
	speed: 0.1177s/iter; left time: 4266.0222s
	iters: 1600, epoch: 7 | loss: 0.0534565
	speed: 0.1186s/iter; left time: 4288.0050s
	iters: 1700, epoch: 7 | loss: 0.0545159
	speed: 0.1170s/iter; left time: 4218.4950s
	iters: 1800, epoch: 7 | loss: 0.0453232
	speed: 0.1156s/iter; left time: 4158.2451s
	iters: 1900, epoch: 7 | loss: 0.0651416
	speed: 0.1162s/iter; left time: 4166.1893s
	iters: 2000, epoch: 7 | loss: 0.0515023
	speed: 0.1163s/iter; left time: 4159.4492s
	iters: 2100, epoch: 7 | loss: 0.0462779
	speed: 0.1159s/iter; left time: 4134.0760s
	iters: 2200, epoch: 7 | loss: 0.0499391
	speed: 0.1149s/iter; left time: 4086.8695s
	iters: 2300, epoch: 7 | loss: 0.0656782
	speed: 0.1120s/iter; left time: 3973.0698s
	iters: 2400, epoch: 7 | loss: 0.0466200
	speed: 0.1168s/iter; left time: 4128.5093s
	iters: 2500, epoch: 7 | loss: 0.0558347
	speed: 0.1064s/iter; left time: 3751.7386s
	iters: 2600, epoch: 7 | loss: 0.0696534
	speed: 0.1163s/iter; left time: 4087.9350s
Epoch: 7 cost time: 00h:05m:11.90s
Epoch: 7 | Train Loss: 0.0528111 Vali Loss: 0.0540425 Test Loss: 0.0587007
Validation loss decreased (0.054740 --> 0.054043).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0460588
	speed: 0.9988s/iter; left time: 34918.3940s
	iters: 200, epoch: 8 | loss: 0.0622025
	speed: 0.1157s/iter; left time: 4032.4403s
	iters: 300, epoch: 8 | loss: 0.0519913
	speed: 0.1162s/iter; left time: 4038.4653s
	iters: 400, epoch: 8 | loss: 0.0406249
	speed: 0.1150s/iter; left time: 3987.5934s
	iters: 500, epoch: 8 | loss: 0.0526539
	speed: 0.1142s/iter; left time: 3945.7237s
	iters: 600, epoch: 8 | loss: 0.0560093
	speed: 0.1175s/iter; left time: 4048.8991s
	iters: 700, epoch: 8 | loss: 0.0679693
	speed: 0.1141s/iter; left time: 3922.2742s
	iters: 800, epoch: 8 | loss: 0.0448523
	speed: 0.1151s/iter; left time: 3944.3258s
	iters: 900, epoch: 8 | loss: 0.0458734
	speed: 0.1150s/iter; left time: 3927.7100s
	iters: 1000, epoch: 8 | loss: 0.0651497
	speed: 0.1132s/iter; left time: 3854.4789s
	iters: 1100, epoch: 8 | loss: 0.0496319
	speed: 0.1132s/iter; left time: 3843.3400s
	iters: 1200, epoch: 8 | loss: 0.0648924
	speed: 0.1132s/iter; left time: 3832.8576s
	iters: 1300, epoch: 8 | loss: 0.0607049
	speed: 0.1129s/iter; left time: 3811.3001s
	iters: 1400, epoch: 8 | loss: 0.0580690
	speed: 0.1145s/iter; left time: 3852.7940s
	iters: 1500, epoch: 8 | loss: 0.0442169
	speed: 0.1133s/iter; left time: 3801.9133s
	iters: 1600, epoch: 8 | loss: 0.0520920
	speed: 0.1161s/iter; left time: 3884.0944s
	iters: 1700, epoch: 8 | loss: 0.0542979
	speed: 0.1164s/iter; left time: 3883.1795s
	iters: 1800, epoch: 8 | loss: 0.0425588
	speed: 0.1149s/iter; left time: 3820.4780s
	iters: 1900, epoch: 8 | loss: 0.0418803
	speed: 0.1177s/iter; left time: 3902.8595s
	iters: 2000, epoch: 8 | loss: 0.0463494
	speed: 0.1135s/iter; left time: 3752.5452s
	iters: 2100, epoch: 8 | loss: 0.0457020
	speed: 0.1149s/iter; left time: 3788.0254s
	iters: 2200, epoch: 8 | loss: 0.0524447
	speed: 0.1151s/iter; left time: 3783.4499s
	iters: 2300, epoch: 8 | loss: 0.0519675
	speed: 0.1137s/iter; left time: 3726.6258s
	iters: 2400, epoch: 8 | loss: 0.0533954
	speed: 0.1140s/iter; left time: 3723.8943s
	iters: 2500, epoch: 8 | loss: 0.0505847
	speed: 0.1151s/iter; left time: 3746.7302s
	iters: 2600, epoch: 8 | loss: 0.0587134
	speed: 0.1112s/iter; left time: 3611.1521s
Epoch: 8 cost time: 00h:05m:09.82s
Epoch: 8 | Train Loss: 0.0522896 Vali Loss: 0.0555167 Test Loss: 0.0603411
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.0553223
	speed: 0.9867s/iter; left time: 31835.2533s
	iters: 200, epoch: 9 | loss: 0.0466191
	speed: 0.1148s/iter; left time: 3691.0295s
	iters: 300, epoch: 9 | loss: 0.0613746
	speed: 0.1182s/iter; left time: 3791.6792s
	iters: 400, epoch: 9 | loss: 0.0450902
	speed: 0.1144s/iter; left time: 3656.6553s
	iters: 500, epoch: 9 | loss: 0.0554611
	speed: 0.1145s/iter; left time: 3649.9308s
	iters: 600, epoch: 9 | loss: 0.0576737
	speed: 0.1145s/iter; left time: 3638.1291s
	iters: 700, epoch: 9 | loss: 0.0529940
	speed: 0.1136s/iter; left time: 3598.6982s
	iters: 800, epoch: 9 | loss: 0.0483810
	speed: 0.1137s/iter; left time: 3590.0342s
	iters: 900, epoch: 9 | loss: 0.0450235
	speed: 0.1146s/iter; left time: 3607.4244s
	iters: 1000, epoch: 9 | loss: 0.0433518
	speed: 0.1136s/iter; left time: 3561.6420s
	iters: 1100, epoch: 9 | loss: 0.0480308
	speed: 0.1146s/iter; left time: 3583.4718s
	iters: 1200, epoch: 9 | loss: 0.0439340
	speed: 0.1164s/iter; left time: 3626.4656s
	iters: 1300, epoch: 9 | loss: 0.0469765
	speed: 0.1178s/iter; left time: 3660.5851s
	iters: 1400, epoch: 9 | loss: 0.0589630
	speed: 0.1170s/iter; left time: 3622.9203s
	iters: 1500, epoch: 9 | loss: 0.0431547
	speed: 0.1166s/iter; left time: 3599.4052s
	iters: 1600, epoch: 9 | loss: 0.0477735
	speed: 0.1174s/iter; left time: 3610.7391s
	iters: 1700, epoch: 9 | loss: 0.0572250
	speed: 0.1168s/iter; left time: 3581.7098s
	iters: 1800, epoch: 9 | loss: 0.0460013
	speed: 0.1160s/iter; left time: 3546.0751s
	iters: 1900, epoch: 9 | loss: 0.0480974
	speed: 0.1157s/iter; left time: 3523.3599s
	iters: 2000, epoch: 9 | loss: 0.0449856
	speed: 0.1150s/iter; left time: 3492.2872s
	iters: 2100, epoch: 9 | loss: 0.0463317
	speed: 0.1146s/iter; left time: 3468.2989s
	iters: 2200, epoch: 9 | loss: 0.0446014
	speed: 0.1154s/iter; left time: 3481.5565s
	iters: 2300, epoch: 9 | loss: 0.0504780
	speed: 0.1150s/iter; left time: 3457.8265s
	iters: 2400, epoch: 9 | loss: 0.0436172
	speed: 0.1044s/iter; left time: 3129.5063s
	iters: 2500, epoch: 9 | loss: 0.0481363
	speed: 0.1109s/iter; left time: 3312.7002s
	iters: 2600, epoch: 9 | loss: 0.0430334
	speed: 0.1163s/iter; left time: 3462.6061s
Epoch: 9 cost time: 00h:05m:10.44s
Epoch: 9 | Train Loss: 0.0518848 Vali Loss: 0.0543241 Test Loss: 0.0591126
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 10 | loss: 0.0361740
	speed: 0.9902s/iter; left time: 29278.6451s
	iters: 200, epoch: 10 | loss: 0.0424532
	speed: 0.1171s/iter; left time: 3451.9981s
	iters: 300, epoch: 10 | loss: 0.0439460
	speed: 0.1168s/iter; left time: 3430.5602s
	iters: 400, epoch: 10 | loss: 0.0425408
	speed: 0.1149s/iter; left time: 3363.0818s
	iters: 500, epoch: 10 | loss: 0.0446251
	speed: 0.1083s/iter; left time: 3159.9032s
	iters: 600, epoch: 10 | loss: 0.0730994
	speed: 0.0978s/iter; left time: 2842.7083s
	iters: 700, epoch: 10 | loss: 0.0452029
	speed: 0.1071s/iter; left time: 3102.6407s
	iters: 800, epoch: 10 | loss: 0.0518145
	speed: 0.1168s/iter; left time: 3371.1007s
	iters: 900, epoch: 10 | loss: 0.0441767
	speed: 0.1157s/iter; left time: 3329.4667s
	iters: 1000, epoch: 10 | loss: 0.0625665
	speed: 0.1147s/iter; left time: 3287.9282s
	iters: 1100, epoch: 10 | loss: 0.0505257
	speed: 0.1168s/iter; left time: 3335.7106s
	iters: 1200, epoch: 10 | loss: 0.0455996
	speed: 0.1160s/iter; left time: 3301.2877s
	iters: 1300, epoch: 10 | loss: 0.0378268
	speed: 0.1171s/iter; left time: 3322.3388s
	iters: 1400, epoch: 10 | loss: 0.0600771
	speed: 0.1090s/iter; left time: 3081.8802s
	iters: 1500, epoch: 10 | loss: 0.0465586
	speed: 0.1049s/iter; left time: 2955.8424s
	iters: 1600, epoch: 10 | loss: 0.0524688
	speed: 0.1152s/iter; left time: 3233.3545s
	iters: 1700, epoch: 10 | loss: 0.0475789
	speed: 0.1150s/iter; left time: 3217.2197s
	iters: 1800, epoch: 10 | loss: 0.0450688
	speed: 0.1152s/iter; left time: 3209.4761s
	iters: 1900, epoch: 10 | loss: 0.0655913
	speed: 0.1140s/iter; left time: 3166.8476s
	iters: 2000, epoch: 10 | loss: 0.0443577
	speed: 0.1162s/iter; left time: 3215.0263s
	iters: 2100, epoch: 10 | loss: 0.0562413
	speed: 0.1150s/iter; left time: 3170.1847s
	iters: 2200, epoch: 10 | loss: 0.0390418
	speed: 0.1138s/iter; left time: 3126.7674s
	iters: 2300, epoch: 10 | loss: 0.0545616
	speed: 0.1150s/iter; left time: 3147.1205s
	iters: 2400, epoch: 10 | loss: 0.0571885
	speed: 0.1142s/iter; left time: 3113.9495s
	iters: 2500, epoch: 10 | loss: 0.0536950
	speed: 0.1161s/iter; left time: 3155.2774s
	iters: 2600, epoch: 10 | loss: 0.0660274
	speed: 0.1142s/iter; left time: 3090.6736s
Epoch: 10 cost time: 00h:05m:06.98s
Epoch: 10 | Train Loss: 0.0514509 Vali Loss: 0.0540158 Test Loss: 0.0590907
Validation loss decreased (0.054043 --> 0.054016).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 11 | loss: 0.0486004
	speed: 1.0021s/iter; left time: 26928.6929s
	iters: 200, epoch: 11 | loss: 0.0427696
	speed: 0.1153s/iter; left time: 3085.9052s
	iters: 300, epoch: 11 | loss: 0.0502599
	speed: 0.1149s/iter; left time: 3065.5980s
	iters: 400, epoch: 11 | loss: 0.0545642
	speed: 0.1134s/iter; left time: 3012.5267s
	iters: 500, epoch: 11 | loss: 0.0415499
	speed: 0.1138s/iter; left time: 3011.8174s
	iters: 600, epoch: 11 | loss: 0.0503596
	speed: 0.1146s/iter; left time: 3023.1896s
	iters: 700, epoch: 11 | loss: 0.0587240
	speed: 0.1135s/iter; left time: 2982.7512s
	iters: 800, epoch: 11 | loss: 0.0542230
	speed: 0.1123s/iter; left time: 2938.1676s
	iters: 900, epoch: 11 | loss: 0.0419671
	speed: 0.1148s/iter; left time: 2992.4918s
	iters: 1000, epoch: 11 | loss: 0.0539247
	speed: 0.1124s/iter; left time: 2920.3983s
	iters: 1100, epoch: 11 | loss: 0.0388036
	speed: 0.1146s/iter; left time: 2964.1080s
	iters: 1200, epoch: 11 | loss: 0.0615964
	speed: 0.1143s/iter; left time: 2944.4680s
	iters: 1300, epoch: 11 | loss: 0.0468018
	speed: 0.1168s/iter; left time: 2997.5277s
	iters: 1400, epoch: 11 | loss: 0.0443031
	speed: 0.1158s/iter; left time: 2960.0505s
	iters: 1500, epoch: 11 | loss: 0.0490965
	speed: 0.1151s/iter; left time: 2931.7566s
	iters: 1600, epoch: 11 | loss: 0.0545864
	speed: 0.1154s/iter; left time: 2927.6585s
	iters: 1700, epoch: 11 | loss: 0.0517874
	speed: 0.1152s/iter; left time: 2910.0282s
	iters: 1800, epoch: 11 | loss: 0.0556483
	speed: 0.1133s/iter; left time: 2852.6975s
	iters: 1900, epoch: 11 | loss: 0.0528931
	speed: 0.1132s/iter; left time: 2836.9183s
	iters: 2000, epoch: 11 | loss: 0.0465289
	speed: 0.1157s/iter; left time: 2890.0792s
	iters: 2100, epoch: 11 | loss: 0.0451324
	speed: 0.1154s/iter; left time: 2869.9303s
	iters: 2200, epoch: 11 | loss: 0.0447210
	speed: 0.1166s/iter; left time: 2887.1053s
	iters: 2300, epoch: 11 | loss: 0.0517201
	speed: 0.1175s/iter; left time: 2899.2541s
	iters: 2400, epoch: 11 | loss: 0.0628082
	speed: 0.1169s/iter; left time: 2871.3439s
	iters: 2500, epoch: 11 | loss: 0.0555514
	speed: 0.1130s/iter; left time: 2765.3817s
	iters: 2600, epoch: 11 | loss: 0.0564730
	speed: 0.1166s/iter; left time: 2842.0555s
Epoch: 11 cost time: 00h:05m:10.13s
Epoch: 11 | Train Loss: 0.0511123 Vali Loss: 0.0542110 Test Loss: 0.0589370
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 12 | loss: 0.0413404
	speed: 0.9823s/iter; left time: 23745.4161s
	iters: 200, epoch: 12 | loss: 0.0456423
	speed: 0.1154s/iter; left time: 2779.3363s
	iters: 300, epoch: 12 | loss: 0.0599975
	speed: 0.1153s/iter; left time: 2763.6161s
	iters: 400, epoch: 12 | loss: 0.0393989
	speed: 0.1138s/iter; left time: 2715.9943s
	iters: 500, epoch: 12 | loss: 0.0631208
	speed: 0.1157s/iter; left time: 2751.6474s
	iters: 600, epoch: 12 | loss: 0.0394312
	speed: 0.1140s/iter; left time: 2698.6083s
	iters: 700, epoch: 12 | loss: 0.0610043
	speed: 0.1135s/iter; left time: 2675.2827s
	iters: 800, epoch: 12 | loss: 0.0467539
	speed: 0.1157s/iter; left time: 2715.7502s
	iters: 900, epoch: 12 | loss: 0.0553005
	speed: 0.1154s/iter; left time: 2697.5072s
	iters: 1000, epoch: 12 | loss: 0.0448402
	speed: 0.1136s/iter; left time: 2644.6336s
	iters: 1100, epoch: 12 | loss: 0.0574175
	speed: 0.1139s/iter; left time: 2638.3887s
	iters: 1200, epoch: 12 | loss: 0.0437614
	speed: 0.1162s/iter; left time: 2680.1898s
	iters: 1300, epoch: 12 | loss: 0.0455631
	speed: 0.1155s/iter; left time: 2653.7600s
	iters: 1400, epoch: 12 | loss: 0.0532934
	speed: 0.1164s/iter; left time: 2663.1238s
	iters: 1500, epoch: 12 | loss: 0.0407963
	speed: 0.1150s/iter; left time: 2618.6813s
	iters: 1600, epoch: 12 | loss: 0.0568854
	speed: 0.1145s/iter; left time: 2596.8789s
	iters: 1700, epoch: 12 | loss: 0.0648938
	speed: 0.1142s/iter; left time: 2577.4574s
	iters: 1800, epoch: 12 | loss: 0.0681437
	speed: 0.1140s/iter; left time: 2562.1909s
	iters: 1900, epoch: 12 | loss: 0.0537705
	speed: 0.1157s/iter; left time: 2588.1640s
	iters: 2000, epoch: 12 | loss: 0.0641221
	speed: 0.1151s/iter; left time: 2564.6658s
	iters: 2100, epoch: 12 | loss: 0.0408601
	speed: 0.1162s/iter; left time: 2576.4156s
	iters: 2200, epoch: 12 | loss: 0.0592678
	speed: 0.1166s/iter; left time: 2573.9433s
	iters: 2300, epoch: 12 | loss: 0.0429511
	speed: 0.1151s/iter; left time: 2528.9800s
	iters: 2400, epoch: 12 | loss: 0.0535271
	speed: 0.1165s/iter; left time: 2548.6800s
	iters: 2500, epoch: 12 | loss: 0.0569462
	speed: 0.1157s/iter; left time: 2518.9259s
	iters: 2600, epoch: 12 | loss: 0.0574420
	speed: 0.1157s/iter; left time: 2508.4919s
Epoch: 12 cost time: 00h:05m:11.04s
Epoch: 12 | Train Loss: 0.0506596 Vali Loss: 0.0538890 Test Loss: 0.0585830
Validation loss decreased (0.054016 --> 0.053889).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 13 | loss: 0.0584482
	speed: 1.0053s/iter; left time: 21590.2078s
	iters: 200, epoch: 13 | loss: 0.0413951
	speed: 0.1161s/iter; left time: 2480.8565s
	iters: 300, epoch: 13 | loss: 0.0452191
	speed: 0.1165s/iter; left time: 2478.1191s
	iters: 400, epoch: 13 | loss: 0.0583766
	speed: 0.1098s/iter; left time: 2324.9653s
	iters: 500, epoch: 13 | loss: 0.0591615
	speed: 0.1100s/iter; left time: 2318.2569s
	iters: 600, epoch: 13 | loss: 0.0405239
	speed: 0.1142s/iter; left time: 2395.0054s
	iters: 700, epoch: 13 | loss: 0.0362805
	speed: 0.1175s/iter; left time: 2452.6224s
	iters: 800, epoch: 13 | loss: 0.0517154
	speed: 0.1177s/iter; left time: 2444.6048s
	iters: 900, epoch: 13 | loss: 0.0501910
	speed: 0.1155s/iter; left time: 2387.9347s
	iters: 1000, epoch: 13 | loss: 0.0493395
	speed: 0.1146s/iter; left time: 2357.9690s
	iters: 1100, epoch: 13 | loss: 0.0423344
	speed: 0.1135s/iter; left time: 2324.5108s
	iters: 1200, epoch: 13 | loss: 0.0497453
	speed: 0.1068s/iter; left time: 2177.0310s
	iters: 1300, epoch: 13 | loss: 0.0577142
	speed: 0.1165s/iter; left time: 2361.4740s
	iters: 1400, epoch: 13 | loss: 0.0529139
	speed: 0.1156s/iter; left time: 2332.8182s
	iters: 1500, epoch: 13 | loss: 0.0540026
	speed: 0.1148s/iter; left time: 2304.2520s
	iters: 1600, epoch: 13 | loss: 0.0617525
	speed: 0.1158s/iter; left time: 2312.6715s
	iters: 1700, epoch: 13 | loss: 0.0441613
	speed: 0.1173s/iter; left time: 2332.2387s
	iters: 1800, epoch: 13 | loss: 0.0492811
	speed: 0.1146s/iter; left time: 2265.5691s
	iters: 1900, epoch: 13 | loss: 0.0474770
	speed: 0.1157s/iter; left time: 2276.9391s
	iters: 2000, epoch: 13 | loss: 0.0442020
	speed: 0.1147s/iter; left time: 2245.0456s
	iters: 2100, epoch: 13 | loss: 0.0425807
	speed: 0.1154s/iter; left time: 2248.2726s
	iters: 2200, epoch: 13 | loss: 0.0565319
	speed: 0.1149s/iter; left time: 2226.1965s
	iters: 2300, epoch: 13 | loss: 0.0483340
	speed: 0.1142s/iter; left time: 2201.1308s
	iters: 2400, epoch: 13 | loss: 0.0448032
	speed: 0.1157s/iter; left time: 2219.2562s
	iters: 2500, epoch: 13 | loss: 0.0564242
	speed: 0.1155s/iter; left time: 2204.1146s
	iters: 2600, epoch: 13 | loss: 0.0571262
	speed: 0.1146s/iter; left time: 2174.3821s
Epoch: 13 cost time: 00h:05m:10.22s
Epoch: 13 | Train Loss: 0.0503306 Vali Loss: 0.0541599 Test Loss: 0.0587250
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 14 | loss: 0.0493650
	speed: 0.9792s/iter; left time: 18389.0411s
	iters: 200, epoch: 14 | loss: 0.0601776
	speed: 0.1034s/iter; left time: 1930.8380s
	iters: 300, epoch: 14 | loss: 0.0522846
	speed: 0.1021s/iter; left time: 1896.8407s
	iters: 400, epoch: 14 | loss: 0.0502198
	speed: 0.1145s/iter; left time: 2115.8220s
	iters: 500, epoch: 14 | loss: 0.0539697
	speed: 0.1164s/iter; left time: 2140.3343s
	iters: 600, epoch: 14 | loss: 0.0492951
	speed: 0.1176s/iter; left time: 2150.5131s
	iters: 700, epoch: 14 | loss: 0.0499482
	speed: 0.1150s/iter; left time: 2090.1754s
	iters: 800, epoch: 14 | loss: 0.0521548
	speed: 0.1161s/iter; left time: 2099.8732s
	iters: 900, epoch: 14 | loss: 0.0697306
	speed: 0.1148s/iter; left time: 2063.9074s
	iters: 1000, epoch: 14 | loss: 0.0585489
	speed: 0.1154s/iter; left time: 2063.1400s
	iters: 1100, epoch: 14 | loss: 0.0513945
	speed: 0.1099s/iter; left time: 1953.2543s
	iters: 1200, epoch: 14 | loss: 0.0772938
	speed: 0.0962s/iter; left time: 1700.8666s
	iters: 1300, epoch: 14 | loss: 0.0545680
	speed: 0.1087s/iter; left time: 1911.1805s
	iters: 1400, epoch: 14 | loss: 0.0644709
	speed: 0.1148s/iter; left time: 2006.5881s
	iters: 1500, epoch: 14 | loss: 0.0620324
	speed: 0.1151s/iter; left time: 2000.9906s
	iters: 1600, epoch: 14 | loss: 0.0397591
	speed: 0.1161s/iter; left time: 2007.0436s
	iters: 1700, epoch: 14 | loss: 0.0408592
	speed: 0.1163s/iter; left time: 1998.8850s
	iters: 1800, epoch: 14 | loss: 0.0460187
	speed: 0.1155s/iter; left time: 1973.5367s
	iters: 1900, epoch: 14 | loss: 0.0569062
	speed: 0.1158s/iter; left time: 1966.1250s
	iters: 2000, epoch: 14 | loss: 0.0487930
	speed: 0.1182s/iter; left time: 1995.7385s
	iters: 2100, epoch: 14 | loss: 0.0453887
	speed: 0.1157s/iter; left time: 1942.2739s
	iters: 2200, epoch: 14 | loss: 0.0463870
	speed: 0.1146s/iter; left time: 1910.9998s
	iters: 2300, epoch: 14 | loss: 0.0511975
	speed: 0.1136s/iter; left time: 1882.9192s
	iters: 2400, epoch: 14 | loss: 0.0511051
	speed: 0.1133s/iter; left time: 1867.1957s
	iters: 2500, epoch: 14 | loss: 0.0467189
	speed: 0.1142s/iter; left time: 1871.1775s
	iters: 2600, epoch: 14 | loss: 0.0436856
	speed: 0.1135s/iter; left time: 1847.0458s
Epoch: 14 cost time: 00h:05m:04.65s
Epoch: 14 | Train Loss: 0.0499867 Vali Loss: 0.0545931 Test Loss: 0.0590969
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 15 | loss: 0.0640254
	speed: 0.9585s/iter; left time: 15414.8101s
	iters: 200, epoch: 15 | loss: 0.0394662
	speed: 0.1147s/iter; left time: 1832.6257s
	iters: 300, epoch: 15 | loss: 0.0387993
	speed: 0.1114s/iter; left time: 1768.7440s
	iters: 400, epoch: 15 | loss: 0.0437090
	speed: 0.1139s/iter; left time: 1798.2244s
	iters: 500, epoch: 15 | loss: 0.0550465
	speed: 0.1150s/iter; left time: 1803.8693s
	iters: 600, epoch: 15 | loss: 0.0468511
	speed: 0.1146s/iter; left time: 1786.1690s
	iters: 700, epoch: 15 | loss: 0.0450512
	speed: 0.1049s/iter; left time: 1624.8732s
	iters: 800, epoch: 15 | loss: 0.0656973
	speed: 0.1028s/iter; left time: 1580.9335s
	iters: 900, epoch: 15 | loss: 0.0515748
	speed: 0.1146s/iter; left time: 1751.6202s
	iters: 1000, epoch: 15 | loss: 0.0481743
	speed: 0.1146s/iter; left time: 1740.0851s
	iters: 1100, epoch: 15 | loss: 0.0463150
	speed: 0.1153s/iter; left time: 1738.8196s
	iters: 1200, epoch: 15 | loss: 0.0436716
	speed: 0.1163s/iter; left time: 1742.8213s
	iters: 1300, epoch: 15 | loss: 0.0492802
	speed: 0.1154s/iter; left time: 1717.0990s
	iters: 1400, epoch: 15 | loss: 0.0472708
	speed: 0.1164s/iter; left time: 1721.1618s
	iters: 1500, epoch: 15 | loss: 0.0623606
	speed: 0.1149s/iter; left time: 1686.7182s
	iters: 1600, epoch: 15 | loss: 0.0426730
	speed: 0.1020s/iter; left time: 1487.0946s
	iters: 1700, epoch: 15 | loss: 0.0558270
	speed: 0.1052s/iter; left time: 1523.4790s
	iters: 1800, epoch: 15 | loss: 0.0486433
	speed: 0.1157s/iter; left time: 1664.4138s
	iters: 1900, epoch: 15 | loss: 0.0478737
	speed: 0.1145s/iter; left time: 1634.9584s
	iters: 2000, epoch: 15 | loss: 0.0472583
	speed: 0.1154s/iter; left time: 1636.2746s
	iters: 2100, epoch: 15 | loss: 0.0523396
	speed: 0.1153s/iter; left time: 1624.4740s
	iters: 2200, epoch: 15 | loss: 0.0442008
	speed: 0.1147s/iter; left time: 1604.0077s
	iters: 2300, epoch: 15 | loss: 0.0422843
	speed: 0.1151s/iter; left time: 1598.2178s
	iters: 2400, epoch: 15 | loss: 0.0520833
	speed: 0.1162s/iter; left time: 1601.3281s
	iters: 2500, epoch: 15 | loss: 0.0416124
	speed: 0.1169s/iter; left time: 1599.4313s
	iters: 2600, epoch: 15 | loss: 0.0408221
	speed: 0.1160s/iter; left time: 1575.6306s
Epoch: 15 cost time: 00h:05m:05.30s
Epoch: 15 | Train Loss: 0.0497556 Vali Loss: 0.0541359 Test Loss: 0.0592553
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 16 | loss: 0.0512954
	speed: 0.9859s/iter; left time: 13197.7336s
	iters: 200, epoch: 16 | loss: 0.0593351
	speed: 0.1170s/iter; left time: 1555.0710s
	iters: 300, epoch: 16 | loss: 0.0391670
	speed: 0.1167s/iter; left time: 1538.5807s
	iters: 400, epoch: 16 | loss: 0.0442540
	speed: 0.1148s/iter; left time: 1502.5334s
	iters: 500, epoch: 16 | loss: 0.0314678
	speed: 0.1151s/iter; left time: 1494.0879s
	iters: 600, epoch: 16 | loss: 0.0491887
	speed: 0.1163s/iter; left time: 1498.0406s
	iters: 700, epoch: 16 | loss: 0.0406393
	speed: 0.1175s/iter; left time: 1502.7032s
	iters: 800, epoch: 16 | loss: 0.0444243
	speed: 0.1161s/iter; left time: 1473.1850s
	iters: 900, epoch: 16 | loss: 0.0567451
	speed: 0.1157s/iter; left time: 1456.0354s
	iters: 1000, epoch: 16 | loss: 0.0386371
	speed: 0.1164s/iter; left time: 1452.9967s
	iters: 1100, epoch: 16 | loss: 0.0542442
	speed: 0.1157s/iter; left time: 1433.5309s
	iters: 1200, epoch: 16 | loss: 0.0485616
	speed: 0.1151s/iter; left time: 1413.9901s
	iters: 1300, epoch: 16 | loss: 0.0415913
	speed: 0.1157s/iter; left time: 1409.7789s
	iters: 1400, epoch: 16 | loss: 0.0443841
	speed: 0.1154s/iter; left time: 1395.2161s
	iters: 1500, epoch: 16 | loss: 0.0549853
	speed: 0.1153s/iter; left time: 1381.9400s
	iters: 1600, epoch: 16 | loss: 0.0475429
	speed: 0.1159s/iter; left time: 1377.5505s
	iters: 1700, epoch: 16 | loss: 0.0519379
	speed: 0.1164s/iter; left time: 1372.1601s
	iters: 1800, epoch: 16 | loss: 0.0507676
	speed: 0.1171s/iter; left time: 1368.3624s
	iters: 1900, epoch: 16 | loss: 0.0471109
	speed: 0.1154s/iter; left time: 1337.5959s
	iters: 2000, epoch: 16 | loss: 0.0422025
	speed: 0.1085s/iter; left time: 1245.6917s
	iters: 2100, epoch: 16 | loss: 0.0510330
	speed: 0.1127s/iter; left time: 1283.7618s
	iters: 2200, epoch: 16 | loss: 0.0449592
	speed: 0.1148s/iter; left time: 1296.1556s
	iters: 2300, epoch: 16 | loss: 0.0611455
	speed: 0.1136s/iter; left time: 1271.2093s
	iters: 2400, epoch: 16 | loss: 0.0596026
	speed: 0.1161s/iter; left time: 1286.6216s
	iters: 2500, epoch: 16 | loss: 0.0501522
	speed: 0.1142s/iter; left time: 1254.3166s
	iters: 2600, epoch: 16 | loss: 0.0497214
	speed: 0.1132s/iter; left time: 1231.9641s
Epoch: 16 cost time: 00h:05m:11.56s
Epoch: 16 | Train Loss: 0.0493574 Vali Loss: 0.0541783 Test Loss: 0.0598210
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 17 | loss: 0.0487838
	speed: 0.9838s/iter; left time: 10515.7423s
	iters: 200, epoch: 17 | loss: 0.0512044
	speed: 0.1157s/iter; left time: 1225.1472s
	iters: 300, epoch: 17 | loss: 0.0408817
	speed: 0.1164s/iter; left time: 1220.6455s
	iters: 400, epoch: 17 | loss: 0.0356466
	speed: 0.1136s/iter; left time: 1180.0588s
	iters: 500, epoch: 17 | loss: 0.0510470
	speed: 0.1157s/iter; left time: 1190.0262s
	iters: 600, epoch: 17 | loss: 0.0428915
	speed: 0.1165s/iter; left time: 1186.6402s
	iters: 700, epoch: 17 | loss: 0.0436458
	speed: 0.1149s/iter; left time: 1159.5412s
	iters: 800, epoch: 17 | loss: 0.0422825
	speed: 0.1146s/iter; left time: 1144.9722s
	iters: 900, epoch: 17 | loss: 0.0605514
	speed: 0.1144s/iter; left time: 1131.1799s
	iters: 1000, epoch: 17 | loss: 0.0491973
	speed: 0.1141s/iter; left time: 1117.0568s
	iters: 1100, epoch: 17 | loss: 0.0428665
	speed: 0.1137s/iter; left time: 1102.1115s
	iters: 1200, epoch: 17 | loss: 0.0562080
	speed: 0.1141s/iter; left time: 1093.6470s
	iters: 1300, epoch: 17 | loss: 0.0395262
	speed: 0.1141s/iter; left time: 1082.2386s
	iters: 1400, epoch: 17 | loss: 0.0628368
	speed: 0.1163s/iter; left time: 1091.7784s
	iters: 1500, epoch: 17 | loss: 0.0415979
	speed: 0.1177s/iter; left time: 1093.3501s
	iters: 1600, epoch: 17 | loss: 0.0425477
	speed: 0.1169s/iter; left time: 1073.9668s
	iters: 1700, epoch: 17 | loss: 0.0511805
	speed: 0.1170s/iter; left time: 1062.9802s
	iters: 1800, epoch: 17 | loss: 0.0501039
	speed: 0.1162s/iter; left time: 1044.8256s
	iters: 1900, epoch: 17 | loss: 0.0420724
	speed: 0.1165s/iter; left time: 1035.7642s
	iters: 2000, epoch: 17 | loss: 0.0464478
	speed: 0.1044s/iter; left time: 917.5155s
	iters: 2100, epoch: 17 | loss: 0.0633934
	speed: 0.1143s/iter; left time: 993.4731s
	iters: 2200, epoch: 17 | loss: 0.0512717
	speed: 0.1152s/iter; left time: 989.2179s
	iters: 2300, epoch: 17 | loss: 0.0531858
	speed: 0.1137s/iter; left time: 965.5545s
	iters: 2400, epoch: 17 | loss: 0.0680438
	speed: 0.1137s/iter; left time: 953.4365s
	iters: 2500, epoch: 17 | loss: 0.0617753
	speed: 0.1152s/iter; left time: 955.2259s
	iters: 2600, epoch: 17 | loss: 0.0388164
	speed: 0.1147s/iter; left time: 939.5783s
Epoch: 17 cost time: 00h:05m:10.41s
Epoch: 17 | Train Loss: 0.0491620 Vali Loss: 0.0546305 Test Loss: 0.0602432
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.010352413170039654, rmse:0.1017468124628067, mae:0.058582987636327744, rse:0.392534464597702
success delete checkpoints
Intermediate time for FR and pred_len 24: 01h:50m:52.56s

=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
train 86115
val 18435
test 18435
[2024-11-02 19:03:17,061] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-02 19:03:18,263] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-02 19:03:18,263] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-02 19:03:18,263] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-02 19:03:18,367] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-02 19:03:18,367] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-02 19:03:19,052] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-02 19:03:19,054] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-02 19:03:19,054] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-02 19:03:19,056] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-02 19:03:19,056] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-02 19:03:19,056] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-02 19:03:19,056] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-02 19:03:19,056] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-02 19:03:19,056] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-02 19:03:19,056] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-02 19:03:19,385] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-02 19:03:19,386] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-02 19:03:19,386] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 75.09 GB, percent = 10.0%
[2024-11-02 19:03:19,503] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-02 19:03:19,504] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-02 19:03:19,504] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 75.09 GB, percent = 10.0%
[2024-11-02 19:03:19,504] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-02 19:03:19,616] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-02 19:03:19,617] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-02 19:03:19,617] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 75.09 GB, percent = 10.0%
[2024-11-02 19:03:19,618] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-02 19:03:19,618] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-02 19:03:19,618] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-02 19:03:19,618] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-02 19:03:19,619] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-02 19:03:19,619] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fdb688760d0>
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-02 19:03:19,620] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-02 19:03:19,621] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-02 19:03:19,622] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-02 19:03:19,622] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-02 19:03:19,622] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-02 19:03:19,622] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-02 19:03:19,622] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-02 19:03:19,622] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-02 19:03:19,622] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-02 19:03:19,622] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-02 19:03:19,622] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1399898
	speed: 0.1710s/iter; left time: 9185.5004s
	iters: 200, epoch: 1 | loss: 0.1168020
	speed: 0.1273s/iter; left time: 6823.3374s
	iters: 300, epoch: 1 | loss: 0.1196281
	speed: 0.1278s/iter; left time: 6837.3337s
	iters: 400, epoch: 1 | loss: 0.1010908
	speed: 0.1129s/iter; left time: 6032.9864s
	iters: 500, epoch: 1 | loss: 0.0785264
	speed: 0.1178s/iter; left time: 6282.5744s
	iters: 600, epoch: 1 | loss: 0.0839203
	speed: 0.1142s/iter; left time: 6079.7280s
	iters: 700, epoch: 1 | loss: 0.0833786
	speed: 0.1114s/iter; left time: 5918.1044s
	iters: 800, epoch: 1 | loss: 0.0887009
	speed: 0.1250s/iter; left time: 6629.4213s
	iters: 900, epoch: 1 | loss: 0.0852673
	speed: 0.1264s/iter; left time: 6689.9738s
	iters: 1000, epoch: 1 | loss: 0.0693184
	speed: 0.1111s/iter; left time: 5867.2965s
	iters: 1100, epoch: 1 | loss: 0.0696165
	speed: 0.1177s/iter; left time: 6203.3647s
	iters: 1200, epoch: 1 | loss: 0.0693079
	speed: 0.1249s/iter; left time: 6572.6196s
	iters: 1300, epoch: 1 | loss: 0.0922560
	speed: 0.1254s/iter; left time: 6584.3957s
	iters: 1400, epoch: 1 | loss: 0.0846009
	speed: 0.1255s/iter; left time: 6580.5273s
	iters: 1500, epoch: 1 | loss: 0.0679483
	speed: 0.1245s/iter; left time: 6513.0298s
	iters: 1600, epoch: 1 | loss: 0.0670433
	speed: 0.1239s/iter; left time: 6472.0220s
	iters: 1700, epoch: 1 | loss: 0.0842042
	speed: 0.1255s/iter; left time: 6543.4722s
	iters: 1800, epoch: 1 | loss: 0.0703235
	speed: 0.1258s/iter; left time: 6544.0364s
	iters: 1900, epoch: 1 | loss: 0.0694279
	speed: 0.1259s/iter; left time: 6537.2713s
	iters: 2000, epoch: 1 | loss: 0.0827992
	speed: 0.1147s/iter; left time: 5942.9665s
	iters: 2100, epoch: 1 | loss: 0.0705764
	speed: 0.1218s/iter; left time: 6298.3915s
	iters: 2200, epoch: 1 | loss: 0.0862902
	speed: 0.1244s/iter; left time: 6421.4284s
	iters: 2300, epoch: 1 | loss: 0.0764715
	speed: 0.1241s/iter; left time: 6396.1412s
	iters: 2400, epoch: 1 | loss: 0.0649146
	speed: 0.1239s/iter; left time: 6369.6821s
	iters: 2500, epoch: 1 | loss: 0.0675585
	speed: 0.1242s/iter; left time: 6372.0066s
	iters: 2600, epoch: 1 | loss: 0.0922287
	speed: 0.1273s/iter; left time: 6522.9023s
Epoch: 1 cost time: 00h:05m:31.02s
Epoch: 1 | Train Loss: 0.0871358 Vali Loss: 0.0761358 Test Loss: 0.0846921
Validation loss decreased (inf --> 0.076136).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0748160
	speed: 1.1148s/iter; left time: 56889.9772s
	iters: 200, epoch: 2 | loss: 0.0666597
	speed: 0.1153s/iter; left time: 5870.0649s
	iters: 300, epoch: 2 | loss: 0.0733586
	speed: 0.1155s/iter; left time: 5871.3775s
	iters: 400, epoch: 2 | loss: 0.0713845
	speed: 0.1182s/iter; left time: 5998.5678s
	iters: 500, epoch: 2 | loss: 0.0738021
	speed: 0.1163s/iter; left time: 5887.6479s
	iters: 600, epoch: 2 | loss: 0.0705914
	speed: 0.1166s/iter; left time: 5889.3509s
	iters: 700, epoch: 2 | loss: 0.0696770
	speed: 0.1146s/iter; left time: 5778.8295s
	iters: 800, epoch: 2 | loss: 0.0733058
	speed: 0.1152s/iter; left time: 5800.3344s
	iters: 900, epoch: 2 | loss: 0.0828630
	speed: 0.1149s/iter; left time: 5771.4858s
	iters: 1000, epoch: 2 | loss: 0.0755392
	speed: 0.1149s/iter; left time: 5757.6629s
	iters: 1100, epoch: 2 | loss: 0.0760631
	speed: 0.1146s/iter; left time: 5731.0691s
	iters: 1200, epoch: 2 | loss: 0.0672225
	speed: 0.1143s/iter; left time: 5705.2586s
	iters: 1300, epoch: 2 | loss: 0.0847869
	speed: 0.1149s/iter; left time: 5724.5213s
	iters: 1400, epoch: 2 | loss: 0.0584152
	speed: 0.1133s/iter; left time: 5636.7114s
	iters: 1500, epoch: 2 | loss: 0.0725951
	speed: 0.1136s/iter; left time: 5637.1066s
	iters: 1600, epoch: 2 | loss: 0.0695227
	speed: 0.1145s/iter; left time: 5672.3644s
	iters: 1700, epoch: 2 | loss: 0.0701093
	speed: 0.1135s/iter; left time: 5608.9226s
	iters: 1800, epoch: 2 | loss: 0.0907094
	speed: 0.1151s/iter; left time: 5679.9633s
	iters: 1900, epoch: 2 | loss: 0.0744436
	speed: 0.1156s/iter; left time: 5688.6276s
	iters: 2000, epoch: 2 | loss: 0.0658760
	speed: 0.1141s/iter; left time: 5606.2591s
	iters: 2100, epoch: 2 | loss: 0.0895933
	speed: 0.1143s/iter; left time: 5604.1308s
	iters: 2200, epoch: 2 | loss: 0.0795399
	speed: 0.1144s/iter; left time: 5595.9551s
	iters: 2300, epoch: 2 | loss: 0.0616416
	speed: 0.1144s/iter; left time: 5588.0029s
	iters: 2400, epoch: 2 | loss: 0.0696839
	speed: 0.1149s/iter; left time: 5601.2856s
	iters: 2500, epoch: 2 | loss: 0.0602486
	speed: 0.1139s/iter; left time: 5538.9357s
	iters: 2600, epoch: 2 | loss: 0.0719646
	speed: 0.1147s/iter; left time: 5566.5009s
Epoch: 2 cost time: 00h:05m:09.51s
Epoch: 2 | Train Loss: 0.0721934 Vali Loss: 0.0745545 Test Loss: 0.0839525
Validation loss decreased (0.076136 --> 0.074555).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0690167
	speed: 0.9829s/iter; left time: 47513.1729s
	iters: 200, epoch: 3 | loss: 0.0873170
	speed: 0.1153s/iter; left time: 5560.8989s
	iters: 300, epoch: 3 | loss: 0.0652578
	speed: 0.1151s/iter; left time: 5542.9431s
	iters: 400, epoch: 3 | loss: 0.0529526
	speed: 0.1165s/iter; left time: 5597.0160s
	iters: 500, epoch: 3 | loss: 0.0714227
	speed: 0.1152s/iter; left time: 5524.0865s
	iters: 600, epoch: 3 | loss: 0.0688608
	speed: 0.1155s/iter; left time: 5524.1627s
	iters: 700, epoch: 3 | loss: 0.0620311
	speed: 0.1143s/iter; left time: 5456.6919s
	iters: 800, epoch: 3 | loss: 0.0708930
	speed: 0.1151s/iter; left time: 5482.7212s
	iters: 900, epoch: 3 | loss: 0.0866079
	speed: 0.1146s/iter; left time: 5446.4498s
	iters: 1000, epoch: 3 | loss: 0.0677101
	speed: 0.1144s/iter; left time: 5429.1977s
	iters: 1100, epoch: 3 | loss: 0.0758670
	speed: 0.1149s/iter; left time: 5437.1999s
	iters: 1200, epoch: 3 | loss: 0.0556624
	speed: 0.1144s/iter; left time: 5402.1315s
	iters: 1300, epoch: 3 | loss: 0.0775621
	speed: 0.1155s/iter; left time: 5442.7883s
	iters: 1400, epoch: 3 | loss: 0.0611256
	speed: 0.1147s/iter; left time: 5394.3616s
	iters: 1500, epoch: 3 | loss: 0.0686625
	speed: 0.1144s/iter; left time: 5368.4786s
	iters: 1600, epoch: 3 | loss: 0.0653413
	speed: 0.1144s/iter; left time: 5358.8470s
	iters: 1700, epoch: 3 | loss: 0.0682989
	speed: 0.1141s/iter; left time: 5335.2256s
	iters: 1800, epoch: 3 | loss: 0.0813247
	speed: 0.1143s/iter; left time: 5329.0297s
	iters: 1900, epoch: 3 | loss: 0.0699451
	speed: 0.1141s/iter; left time: 5310.2608s
	iters: 2000, epoch: 3 | loss: 0.0698264
	speed: 0.1151s/iter; left time: 5347.3520s
	iters: 2100, epoch: 3 | loss: 0.0730097
	speed: 0.1152s/iter; left time: 5338.2925s
	iters: 2200, epoch: 3 | loss: 0.0531443
	speed: 0.1158s/iter; left time: 5355.9318s
	iters: 2300, epoch: 3 | loss: 0.0865950
	speed: 0.1090s/iter; left time: 5029.5136s
	iters: 2400, epoch: 3 | loss: 0.0673362
	speed: 0.1011s/iter; left time: 4654.7382s
	iters: 2500, epoch: 3 | loss: 0.0694377
	speed: 0.1161s/iter; left time: 5335.0049s
	iters: 2600, epoch: 3 | loss: 0.0681323
	speed: 0.1161s/iter; left time: 5321.2158s
Epoch: 3 cost time: 00h:05m:07.51s
Epoch: 3 | Train Loss: 0.0699143 Vali Loss: 0.0731580 Test Loss: 0.0823368
Validation loss decreased (0.074555 --> 0.073158).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0732795
	speed: 0.9948s/iter; left time: 45411.7549s
	iters: 200, epoch: 4 | loss: 0.0683801
	speed: 0.1161s/iter; left time: 5288.1880s
	iters: 300, epoch: 4 | loss: 0.0746370
	speed: 0.1159s/iter; left time: 5265.9576s
	iters: 400, epoch: 4 | loss: 0.0614159
	speed: 0.1162s/iter; left time: 5270.5503s
	iters: 500, epoch: 4 | loss: 0.0871528
	speed: 0.1066s/iter; left time: 4822.4420s
	iters: 600, epoch: 4 | loss: 0.0667713
	speed: 0.1041s/iter; left time: 4698.7239s
	iters: 700, epoch: 4 | loss: 0.0765538
	speed: 0.1160s/iter; left time: 5225.1456s
	iters: 800, epoch: 4 | loss: 0.0732877
	speed: 0.1163s/iter; left time: 5225.4239s
	iters: 900, epoch: 4 | loss: 0.0660509
	speed: 0.1156s/iter; left time: 5183.2518s
	iters: 1000, epoch: 4 | loss: 0.0636234
	speed: 0.1159s/iter; left time: 5184.5016s
	iters: 1100, epoch: 4 | loss: 0.0860807
	speed: 0.1158s/iter; left time: 5171.6883s
	iters: 1200, epoch: 4 | loss: 0.0955131
	speed: 0.1154s/iter; left time: 5140.2352s
	iters: 1300, epoch: 4 | loss: 0.0609814
	speed: 0.1156s/iter; left time: 5137.8842s
	iters: 1400, epoch: 4 | loss: 0.0679537
	speed: 0.1161s/iter; left time: 5149.3415s
	iters: 1500, epoch: 4 | loss: 0.0625240
	speed: 0.1164s/iter; left time: 5150.7455s
	iters: 1600, epoch: 4 | loss: 0.0702323
	speed: 0.1138s/iter; left time: 5025.1369s
	iters: 1700, epoch: 4 | loss: 0.0583599
	speed: 0.1120s/iter; left time: 4934.0505s
	iters: 1800, epoch: 4 | loss: 0.0770510
	speed: 0.1162s/iter; left time: 5104.6844s
	iters: 1900, epoch: 4 | loss: 0.0586945
	speed: 0.1156s/iter; left time: 5070.5662s
	iters: 2000, epoch: 4 | loss: 0.0661756
	speed: 0.1150s/iter; left time: 5030.8945s
	iters: 2100, epoch: 4 | loss: 0.0605308
	speed: 0.1143s/iter; left time: 4990.1155s
	iters: 2200, epoch: 4 | loss: 0.0575532
	speed: 0.1147s/iter; left time: 4993.7352s
	iters: 2300, epoch: 4 | loss: 0.0731880
	speed: 0.1102s/iter; left time: 4787.6022s
	iters: 2400, epoch: 4 | loss: 0.0779390
	speed: 0.1149s/iter; left time: 4979.2589s
	iters: 2500, epoch: 4 | loss: 0.0875420
	speed: 0.1159s/iter; left time: 5013.2793s
	iters: 2600, epoch: 4 | loss: 0.0610501
	speed: 0.1139s/iter; left time: 4914.4886s
Epoch: 4 cost time: 00h:05m:07.85s
Epoch: 4 | Train Loss: 0.0683495 Vali Loss: 0.0731372 Test Loss: 0.0824272
Validation loss decreased (0.073158 --> 0.073137).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0724338
	speed: 0.9850s/iter; left time: 42312.7008s
	iters: 200, epoch: 5 | loss: 0.0606321
	speed: 0.1163s/iter; left time: 4984.2519s
	iters: 300, epoch: 5 | loss: 0.0696154
	speed: 0.1152s/iter; left time: 4927.5901s
	iters: 400, epoch: 5 | loss: 0.0509575
	speed: 0.1163s/iter; left time: 4960.8790s
	iters: 500, epoch: 5 | loss: 0.0617031
	speed: 0.1151s/iter; left time: 4898.9553s
	iters: 600, epoch: 5 | loss: 0.0621447
	speed: 0.1153s/iter; left time: 4896.5531s
	iters: 700, epoch: 5 | loss: 0.0803559
	speed: 0.1160s/iter; left time: 4913.9575s
	iters: 800, epoch: 5 | loss: 0.0754673
	speed: 0.1135s/iter; left time: 4798.2497s
	iters: 900, epoch: 5 | loss: 0.0662868
	speed: 0.1113s/iter; left time: 4692.1219s
	iters: 1000, epoch: 5 | loss: 0.0548034
	speed: 0.1160s/iter; left time: 4879.1030s
	iters: 1100, epoch: 5 | loss: 0.0607634
	speed: 0.1158s/iter; left time: 4860.3527s
	iters: 1200, epoch: 5 | loss: 0.0584400
	speed: 0.1155s/iter; left time: 4833.9256s
	iters: 1300, epoch: 5 | loss: 0.0783436
	speed: 0.1142s/iter; left time: 4768.1298s
	iters: 1400, epoch: 5 | loss: 0.0662102
	speed: 0.1146s/iter; left time: 4773.3554s
	iters: 1500, epoch: 5 | loss: 0.0863430
	speed: 0.1157s/iter; left time: 4808.5477s
	iters: 1600, epoch: 5 | loss: 0.0737604
	speed: 0.1166s/iter; left time: 4834.0150s
	iters: 1700, epoch: 5 | loss: 0.0550957
	speed: 0.1155s/iter; left time: 4777.7990s
	iters: 1800, epoch: 5 | loss: 0.0731752
	speed: 0.1155s/iter; left time: 4766.7627s
	iters: 1900, epoch: 5 | loss: 0.0629882
	speed: 0.1151s/iter; left time: 4735.7323s
	iters: 2000, epoch: 5 | loss: 0.0697896
	speed: 0.1153s/iter; left time: 4734.1007s
	iters: 2100, epoch: 5 | loss: 0.0609421
	speed: 0.1154s/iter; left time: 4727.8986s
	iters: 2200, epoch: 5 | loss: 0.0741776
	speed: 0.1156s/iter; left time: 4724.3142s
	iters: 2300, epoch: 5 | loss: 0.0553646
	speed: 0.1154s/iter; left time: 4704.0377s
	iters: 2400, epoch: 5 | loss: 0.0486240
	speed: 0.1153s/iter; left time: 4686.0936s
	iters: 2500, epoch: 5 | loss: 0.0761278
	speed: 0.1151s/iter; left time: 4668.5441s
	iters: 2600, epoch: 5 | loss: 0.0535641
	speed: 0.1158s/iter; left time: 4684.5321s
Epoch: 5 cost time: 00h:05m:10.77s
Epoch: 5 | Train Loss: 0.0669839 Vali Loss: 0.0734747 Test Loss: 0.0828658
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0774265
	speed: 0.9689s/iter; left time: 39014.1841s
	iters: 200, epoch: 6 | loss: 0.0675554
	speed: 0.1162s/iter; left time: 4667.5723s
	iters: 300, epoch: 6 | loss: 0.0765251
	speed: 0.1162s/iter; left time: 4654.4439s
	iters: 400, epoch: 6 | loss: 0.0700064
	speed: 0.1149s/iter; left time: 4592.5471s
	iters: 500, epoch: 6 | loss: 0.0766230
	speed: 0.1147s/iter; left time: 4572.6966s
	iters: 600, epoch: 6 | loss: 0.0631887
	speed: 0.1137s/iter; left time: 4522.0342s
	iters: 700, epoch: 6 | loss: 0.0506507
	speed: 0.1151s/iter; left time: 4565.3027s
	iters: 800, epoch: 6 | loss: 0.0790317
	speed: 0.0993s/iter; left time: 3929.9614s
	iters: 900, epoch: 6 | loss: 0.0650835
	speed: 0.1154s/iter; left time: 4556.2520s
	iters: 1000, epoch: 6 | loss: 0.0651186
	speed: 0.1161s/iter; left time: 4568.5685s
	iters: 1100, epoch: 6 | loss: 0.0657033
	speed: 0.1155s/iter; left time: 4534.0281s
	iters: 1200, epoch: 6 | loss: 0.0679954
	speed: 0.1150s/iter; left time: 4504.6713s
	iters: 1300, epoch: 6 | loss: 0.0765673
	speed: 0.1143s/iter; left time: 4464.3442s
	iters: 1400, epoch: 6 | loss: 0.0846173
	speed: 0.1152s/iter; left time: 4488.0074s
	iters: 1500, epoch: 6 | loss: 0.0672733
	speed: 0.1143s/iter; left time: 4444.2281s
	iters: 1600, epoch: 6 | loss: 0.0670121
	speed: 0.1143s/iter; left time: 4430.9147s
	iters: 1700, epoch: 6 | loss: 0.0699374
	speed: 0.0974s/iter; left time: 3766.6272s
	iters: 1800, epoch: 6 | loss: 0.0562305
	speed: 0.1068s/iter; left time: 4118.4166s
	iters: 1900, epoch: 6 | loss: 0.0630337
	speed: 0.1155s/iter; left time: 4443.1980s
	iters: 2000, epoch: 6 | loss: 0.0607302
	speed: 0.1163s/iter; left time: 4460.5016s
	iters: 2100, epoch: 6 | loss: 0.0773381
	speed: 0.1163s/iter; left time: 4448.4792s
	iters: 2200, epoch: 6 | loss: 0.0546207
	speed: 0.1052s/iter; left time: 4016.9093s
	iters: 2300, epoch: 6 | loss: 0.0630324
	speed: 0.1025s/iter; left time: 3902.9421s
	iters: 2400, epoch: 6 | loss: 0.0660211
	speed: 0.1168s/iter; left time: 4432.5906s
	iters: 2500, epoch: 6 | loss: 0.0584088
	speed: 0.1152s/iter; left time: 4361.7531s
	iters: 2600, epoch: 6 | loss: 0.0677779
	speed: 0.1154s/iter; left time: 4356.9488s
Epoch: 6 cost time: 00h:05m:04.28s
Epoch: 6 | Train Loss: 0.0654514 Vali Loss: 0.0743005 Test Loss: 0.0836774
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0600294
	speed: 0.9650s/iter; left time: 36260.1494s
	iters: 200, epoch: 7 | loss: 0.0696560
	speed: 0.1152s/iter; left time: 4316.2745s
	iters: 300, epoch: 7 | loss: 0.0572565
	speed: 0.1141s/iter; left time: 4266.3479s
	iters: 400, epoch: 7 | loss: 0.0701152
	speed: 0.1122s/iter; left time: 4180.6558s
	iters: 500, epoch: 7 | loss: 0.0556676
	speed: 0.1147s/iter; left time: 4263.4882s
	iters: 600, epoch: 7 | loss: 0.0589390
	speed: 0.1154s/iter; left time: 4276.9752s
	iters: 700, epoch: 7 | loss: 0.0610996
	speed: 0.1163s/iter; left time: 4301.8181s
	iters: 800, epoch: 7 | loss: 0.0592947
	speed: 0.1160s/iter; left time: 4277.1571s
	iters: 900, epoch: 7 | loss: 0.0576262
	speed: 0.1150s/iter; left time: 4227.6204s
	iters: 1000, epoch: 7 | loss: 0.0561066
	speed: 0.1167s/iter; left time: 4279.2954s
	iters: 1100, epoch: 7 | loss: 0.0795155
	speed: 0.1170s/iter; left time: 4278.0027s
	iters: 1200, epoch: 7 | loss: 0.0570814
	speed: 0.1154s/iter; left time: 4209.8739s
	iters: 1300, epoch: 7 | loss: 0.0598396
	speed: 0.1157s/iter; left time: 4207.7197s
	iters: 1400, epoch: 7 | loss: 0.0586431
	speed: 0.1158s/iter; left time: 4199.2408s
	iters: 1500, epoch: 7 | loss: 0.0660124
	speed: 0.1152s/iter; left time: 4167.1480s
	iters: 1600, epoch: 7 | loss: 0.0677008
	speed: 0.1155s/iter; left time: 4165.6651s
	iters: 1700, epoch: 7 | loss: 0.0773932
	speed: 0.1156s/iter; left time: 4157.4724s
	iters: 1800, epoch: 7 | loss: 0.0536487
	speed: 0.1158s/iter; left time: 4153.7954s
	iters: 1900, epoch: 7 | loss: 0.0755399
	speed: 0.1153s/iter; left time: 4123.6078s
	iters: 2000, epoch: 7 | loss: 0.0546124
	speed: 0.1160s/iter; left time: 4136.9054s
	iters: 2100, epoch: 7 | loss: 0.0669152
	speed: 0.1186s/iter; left time: 4218.3129s
	iters: 2200, epoch: 7 | loss: 0.0607164
	speed: 0.1161s/iter; left time: 4117.7144s
	iters: 2300, epoch: 7 | loss: 0.0624044
	speed: 0.1165s/iter; left time: 4119.8844s
	iters: 2400, epoch: 7 | loss: 0.0629992
	speed: 0.1165s/iter; left time: 4108.9138s
	iters: 2500, epoch: 7 | loss: 0.0556533
	speed: 0.1157s/iter; left time: 4069.1627s
	iters: 2600, epoch: 7 | loss: 0.0562715
	speed: 0.1158s/iter; left time: 4061.0523s
Epoch: 7 cost time: 00h:05m:11.57s
Epoch: 7 | Train Loss: 0.0641364 Vali Loss: 0.0751676 Test Loss: 0.0842783
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0720103
	speed: 0.9617s/iter; left time: 33548.6899s
	iters: 200, epoch: 8 | loss: 0.0527454
	speed: 0.1150s/iter; left time: 3998.8838s
	iters: 300, epoch: 8 | loss: 0.0710557
	speed: 0.1152s/iter; left time: 3995.5348s
	iters: 400, epoch: 8 | loss: 0.0677130
	speed: 0.1159s/iter; left time: 4009.8367s
	iters: 500, epoch: 8 | loss: 0.0566254
	speed: 0.1158s/iter; left time: 3992.6592s
	iters: 600, epoch: 8 | loss: 0.0638889
	speed: 0.1157s/iter; left time: 3977.3375s
	iters: 700, epoch: 8 | loss: 0.0468303
	speed: 0.1154s/iter; left time: 3956.4133s
	iters: 800, epoch: 8 | loss: 0.0620303
	speed: 0.1149s/iter; left time: 3926.0927s
	iters: 900, epoch: 8 | loss: 0.0692302
	speed: 0.1164s/iter; left time: 3968.8507s
	iters: 1000, epoch: 8 | loss: 0.0656562
	speed: 0.1169s/iter; left time: 3971.7812s
	iters: 1100, epoch: 8 | loss: 0.0716746
	speed: 0.1156s/iter; left time: 3915.3131s
	iters: 1200, epoch: 8 | loss: 0.0694502
	speed: 0.1167s/iter; left time: 3943.7956s
	iters: 1300, epoch: 8 | loss: 0.0552431
	speed: 0.0993s/iter; left time: 3346.0671s
	iters: 1400, epoch: 8 | loss: 0.0707242
	speed: 0.1162s/iter; left time: 3903.1975s
	iters: 1500, epoch: 8 | loss: 0.0593503
	speed: 0.1173s/iter; left time: 3928.6450s
	iters: 1600, epoch: 8 | loss: 0.0829420
	speed: 0.1163s/iter; left time: 3882.3280s
	iters: 1700, epoch: 8 | loss: 0.0603914
	speed: 0.1167s/iter; left time: 3883.2801s
	iters: 1800, epoch: 8 | loss: 0.0663493
	speed: 0.1126s/iter; left time: 3736.0594s
	iters: 1900, epoch: 8 | loss: 0.0599436
	speed: 0.1153s/iter; left time: 3815.3478s
	iters: 2000, epoch: 8 | loss: 0.0584302
	speed: 0.1163s/iter; left time: 3836.6561s
	iters: 2100, epoch: 8 | loss: 0.0497975
	speed: 0.1155s/iter; left time: 3797.8727s
	iters: 2200, epoch: 8 | loss: 0.0631689
	speed: 0.1159s/iter; left time: 3798.3438s
	iters: 2300, epoch: 8 | loss: 0.0653137
	speed: 0.1156s/iter; left time: 3778.1265s
	iters: 2400, epoch: 8 | loss: 0.0661211
	speed: 0.1162s/iter; left time: 3787.1340s
	iters: 2500, epoch: 8 | loss: 0.0540105
	speed: 0.1158s/iter; left time: 3761.9368s
	iters: 2600, epoch: 8 | loss: 0.0650571
	speed: 0.1157s/iter; left time: 3747.3296s
Epoch: 8 cost time: 00h:05m:10.26s
Epoch: 8 | Train Loss: 0.0627744 Vali Loss: 0.0746843 Test Loss: 0.0836141
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.0615777
	speed: 0.9610s/iter; left time: 30936.0040s
	iters: 200, epoch: 9 | loss: 0.0627441
	speed: 0.1142s/iter; left time: 3665.9066s
	iters: 300, epoch: 9 | loss: 0.0565763
	speed: 0.1150s/iter; left time: 3679.9970s
	iters: 400, epoch: 9 | loss: 0.0663073
	speed: 0.1141s/iter; left time: 3639.1125s
	iters: 500, epoch: 9 | loss: 0.0709065
	speed: 0.1152s/iter; left time: 3662.8615s
	iters: 600, epoch: 9 | loss: 0.0613810
	speed: 0.1146s/iter; left time: 3631.0668s
	iters: 700, epoch: 9 | loss: 0.0465641
	speed: 0.1144s/iter; left time: 3613.6552s
	iters: 800, epoch: 9 | loss: 0.0625643
	speed: 0.1141s/iter; left time: 3592.9230s
	iters: 900, epoch: 9 | loss: 0.0633669
	speed: 0.1130s/iter; left time: 3547.3924s
	iters: 1000, epoch: 9 | loss: 0.0585374
	speed: 0.1156s/iter; left time: 3617.3397s
	iters: 1100, epoch: 9 | loss: 0.0481584
	speed: 0.0971s/iter; left time: 3029.7911s
	iters: 1200, epoch: 9 | loss: 0.0595765
	speed: 0.0963s/iter; left time: 2992.9819s
	iters: 1300, epoch: 9 | loss: 0.0813546
	speed: 0.0964s/iter; left time: 2986.8064s
	iters: 1400, epoch: 9 | loss: 0.0566317
	speed: 0.1011s/iter; left time: 3124.6510s
	iters: 1500, epoch: 9 | loss: 0.0461254
	speed: 0.1145s/iter; left time: 3526.9878s
	iters: 1600, epoch: 9 | loss: 0.0633289
	speed: 0.1148s/iter; left time: 3524.0822s
	iters: 1700, epoch: 9 | loss: 0.0650627
	speed: 0.1126s/iter; left time: 3445.7080s
	iters: 1800, epoch: 9 | loss: 0.0545909
	speed: 0.0963s/iter; left time: 2935.1904s
	iters: 1900, epoch: 9 | loss: 0.0653074
	speed: 0.0962s/iter; left time: 2923.3665s
	iters: 2000, epoch: 9 | loss: 0.0694104
	speed: 0.1085s/iter; left time: 3288.0460s
	iters: 2100, epoch: 9 | loss: 0.0491853
	speed: 0.1142s/iter; left time: 3447.3465s
	iters: 2200, epoch: 9 | loss: 0.0691575
	speed: 0.1148s/iter; left time: 3453.3035s
	iters: 2300, epoch: 9 | loss: 0.0568749
	speed: 0.1152s/iter; left time: 3456.2157s
	iters: 2400, epoch: 9 | loss: 0.0560714
	speed: 0.1096s/iter; left time: 3277.5473s
	iters: 2500, epoch: 9 | loss: 0.0608205
	speed: 0.1150s/iter; left time: 3425.9624s
	iters: 2600, epoch: 9 | loss: 0.0655743
	speed: 0.1154s/iter; left time: 3427.3964s
Epoch: 9 cost time: 00h:04m:57.27s
Epoch: 9 | Train Loss: 0.0615349 Vali Loss: 0.0750233 Test Loss: 0.0850513
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.018618784844875336, rmse:0.1364506632089615, mae:0.08242722600698471, rse:0.5278697609901428
success delete checkpoints
Intermediate time for FR and pred_len 96: 00h:59m:01.27s

=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
train 85899
val 18219
test 18219
[2024-11-02 20:02:18,258] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-02 20:02:19,468] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-02 20:02:19,468] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-02 20:02:19,469] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-02 20:02:19,572] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-02 20:02:19,572] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-02 20:02:20,241] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-02 20:02:20,243] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-02 20:02:20,243] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-02 20:02:20,244] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-02 20:02:20,244] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-02 20:02:20,244] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-02 20:02:20,245] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-02 20:02:20,245] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-02 20:02:20,245] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-02 20:02:20,245] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-02 20:02:20,518] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-02 20:02:20,519] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-02 20:02:20,519] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 75.6 GB, percent = 10.0%
[2024-11-02 20:02:20,646] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-02 20:02:20,647] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 20:02:20,647] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 75.6 GB, percent = 10.0%
[2024-11-02 20:02:20,647] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-02 20:02:20,765] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-02 20:02:20,766] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 20:02:20,766] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 75.6 GB, percent = 10.0%
[2024-11-02 20:02:20,767] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-02 20:02:20,767] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-02 20:02:20,767] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-02 20:02:20,767] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-02 20:02:20,767] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-02 20:02:20,768] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-02 20:02:20,768] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-02 20:02:20,768] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-02 20:02:20,768] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-02 20:02:20,768] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-02 20:02:20,768] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-02 20:02:20,768] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-02 20:02:20,768] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-02 20:02:20,768] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-02 20:02:20,768] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-02 20:02:20,768] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fa6999be090>
[2024-11-02 20:02:20,768] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-02 20:02:20,768] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-02 20:02:20,768] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-02 20:02:20,768] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-02 20:02:20,769] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-02 20:02:20,770] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-02 20:02:20,770] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1351442
	speed: 0.1699s/iter; left time: 9105.9032s
	iters: 200, epoch: 1 | loss: 0.1291015
	speed: 0.1269s/iter; left time: 6784.2178s
	iters: 300, epoch: 1 | loss: 0.1202403
	speed: 0.1260s/iter; left time: 6727.0647s
	iters: 400, epoch: 1 | loss: 0.0905234
	speed: 0.1254s/iter; left time: 6679.5488s
	iters: 500, epoch: 1 | loss: 0.0911944
	speed: 0.1245s/iter; left time: 6618.7318s
	iters: 600, epoch: 1 | loss: 0.0763717
	speed: 0.1253s/iter; left time: 6651.2209s
	iters: 700, epoch: 1 | loss: 0.0910461
	speed: 0.1256s/iter; left time: 6653.2511s
	iters: 800, epoch: 1 | loss: 0.0693435
	speed: 0.1256s/iter; left time: 6639.6599s
	iters: 900, epoch: 1 | loss: 0.0690839
	speed: 0.1255s/iter; left time: 6622.4819s
	iters: 1000, epoch: 1 | loss: 0.0823524
	speed: 0.1253s/iter; left time: 6602.2213s
	iters: 1100, epoch: 1 | loss: 0.0720417
	speed: 0.1193s/iter; left time: 6273.7521s
	iters: 1200, epoch: 1 | loss: 0.0871387
	speed: 0.1091s/iter; left time: 5725.1725s
	iters: 1300, epoch: 1 | loss: 0.0793843
	speed: 0.1258s/iter; left time: 6587.3256s
	iters: 1400, epoch: 1 | loss: 0.0777027
	speed: 0.1255s/iter; left time: 6560.8929s
	iters: 1500, epoch: 1 | loss: 0.0669637
	speed: 0.1244s/iter; left time: 6493.7056s
	iters: 1600, epoch: 1 | loss: 0.0711201
	speed: 0.1090s/iter; left time: 5679.2976s
	iters: 1700, epoch: 1 | loss: 0.0681182
	speed: 0.1205s/iter; left time: 6266.1622s
	iters: 1800, epoch: 1 | loss: 0.0701449
	speed: 0.1236s/iter; left time: 6414.7803s
	iters: 1900, epoch: 1 | loss: 0.0895861
	speed: 0.1240s/iter; left time: 6422.2342s
	iters: 2000, epoch: 1 | loss: 0.0716423
	speed: 0.1242s/iter; left time: 6420.4835s
	iters: 2100, epoch: 1 | loss: 0.0750876
	speed: 0.1240s/iter; left time: 6396.4932s
	iters: 2200, epoch: 1 | loss: 0.0838144
	speed: 0.1231s/iter; left time: 6339.3436s
	iters: 2300, epoch: 1 | loss: 0.0789797
	speed: 0.1241s/iter; left time: 6376.1942s
	iters: 2400, epoch: 1 | loss: 0.0668762
	speed: 0.1235s/iter; left time: 6334.2670s
	iters: 2500, epoch: 1 | loss: 0.0662106
	speed: 0.1233s/iter; left time: 6311.9263s
	iters: 2600, epoch: 1 | loss: 0.0773352
	speed: 0.1238s/iter; left time: 6326.0240s
Epoch: 1 cost time: 00h:05m:32.23s
Epoch: 1 | Train Loss: 0.0896614 Vali Loss: 0.0796900 Test Loss: 0.0892447
Validation loss decreased (inf --> 0.079690).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0728463
	speed: 1.0958s/iter; left time: 55774.3952s
	iters: 200, epoch: 2 | loss: 0.0773688
	speed: 0.1164s/iter; left time: 5910.8337s
	iters: 300, epoch: 2 | loss: 0.0769546
	speed: 0.1010s/iter; left time: 5121.3912s
	iters: 400, epoch: 2 | loss: 0.0773306
	speed: 0.1160s/iter; left time: 5867.6510s
	iters: 500, epoch: 2 | loss: 0.0708913
	speed: 0.1173s/iter; left time: 5923.1477s
	iters: 600, epoch: 2 | loss: 0.0599826
	speed: 0.1166s/iter; left time: 5874.3144s
	iters: 700, epoch: 2 | loss: 0.0657055
	speed: 0.1155s/iter; left time: 5808.7773s
	iters: 800, epoch: 2 | loss: 0.0677629
	speed: 0.1116s/iter; left time: 5600.0752s
	iters: 900, epoch: 2 | loss: 0.0905147
	speed: 0.1160s/iter; left time: 5809.5678s
	iters: 1000, epoch: 2 | loss: 0.0794925
	speed: 0.1163s/iter; left time: 5816.0759s
	iters: 1100, epoch: 2 | loss: 0.0824175
	speed: 0.1157s/iter; left time: 5771.1075s
	iters: 1200, epoch: 2 | loss: 0.0622338
	speed: 0.1155s/iter; left time: 5750.7121s
	iters: 1300, epoch: 2 | loss: 0.0587609
	speed: 0.1158s/iter; left time: 5756.7713s
	iters: 1400, epoch: 2 | loss: 0.0815516
	speed: 0.1061s/iter; left time: 5264.1255s
	iters: 1500, epoch: 2 | loss: 0.0769047
	speed: 0.1152s/iter; left time: 5702.1312s
	iters: 1600, epoch: 2 | loss: 0.0706145
	speed: 0.1171s/iter; left time: 5784.1223s
	iters: 1700, epoch: 2 | loss: 0.0698010
	speed: 0.1177s/iter; left time: 5803.1343s
	iters: 1800, epoch: 2 | loss: 0.0721849
	speed: 0.1164s/iter; left time: 5724.9817s
	iters: 1900, epoch: 2 | loss: 0.0779953
	speed: 0.1141s/iter; left time: 5599.8956s
	iters: 2000, epoch: 2 | loss: 0.0784639
	speed: 0.1146s/iter; left time: 5613.2696s
	iters: 2100, epoch: 2 | loss: 0.0783538
	speed: 0.1032s/iter; left time: 5047.3688s
	iters: 2200, epoch: 2 | loss: 0.0755614
	speed: 0.0966s/iter; left time: 4714.5547s
	iters: 2300, epoch: 2 | loss: 0.0806916
	speed: 0.0969s/iter; left time: 4716.6625s
	iters: 2400, epoch: 2 | loss: 0.0772925
	speed: 0.0968s/iter; left time: 4703.1712s
	iters: 2500, epoch: 2 | loss: 0.0781110
	speed: 0.1082s/iter; left time: 5249.4811s
	iters: 2600, epoch: 2 | loss: 0.0692590
	speed: 0.1173s/iter; left time: 5676.5547s
Epoch: 2 cost time: 00h:05m:01.36s
Epoch: 2 | Train Loss: 0.0755227 Vali Loss: 0.0783544 Test Loss: 0.0887550
Validation loss decreased (0.079690 --> 0.078354).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0933752
	speed: 0.9840s/iter; left time: 47443.7926s
	iters: 200, epoch: 3 | loss: 0.0752771
	speed: 0.1178s/iter; left time: 5667.5518s
	iters: 300, epoch: 3 | loss: 0.0674665
	speed: 0.1180s/iter; left time: 5664.5428s
	iters: 400, epoch: 3 | loss: 0.0666938
	speed: 0.1172s/iter; left time: 5616.0198s
	iters: 500, epoch: 3 | loss: 0.0829887
	speed: 0.1172s/iter; left time: 5602.3442s
	iters: 600, epoch: 3 | loss: 0.0702578
	speed: 0.1176s/iter; left time: 5609.7557s
	iters: 700, epoch: 3 | loss: 0.0772638
	speed: 0.1186s/iter; left time: 5644.9005s
	iters: 800, epoch: 3 | loss: 0.0794854
	speed: 0.1171s/iter; left time: 5566.0472s
	iters: 900, epoch: 3 | loss: 0.0809638
	speed: 0.1166s/iter; left time: 5529.4685s
	iters: 1000, epoch: 3 | loss: 0.0592312
	speed: 0.1179s/iter; left time: 5578.2232s
	iters: 1100, epoch: 3 | loss: 0.0774051
	speed: 0.1166s/iter; left time: 5504.3563s
	iters: 1200, epoch: 3 | loss: 0.0845707
	speed: 0.1157s/iter; left time: 5449.2912s
	iters: 1300, epoch: 3 | loss: 0.0741284
	speed: 0.1033s/iter; left time: 4857.6912s
	iters: 1400, epoch: 3 | loss: 0.0733542
	speed: 0.1050s/iter; left time: 4927.1836s
	iters: 1500, epoch: 3 | loss: 0.0812433
	speed: 0.1170s/iter; left time: 5476.8757s
	iters: 1600, epoch: 3 | loss: 0.0667646
	speed: 0.1167s/iter; left time: 5452.4898s
	iters: 1700, epoch: 3 | loss: 0.0619555
	speed: 0.1165s/iter; left time: 5429.4795s
	iters: 1800, epoch: 3 | loss: 0.0823658
	speed: 0.1170s/iter; left time: 5442.6550s
	iters: 1900, epoch: 3 | loss: 0.0658753
	speed: 0.1163s/iter; left time: 5397.0997s
	iters: 2000, epoch: 3 | loss: 0.0627456
	speed: 0.1153s/iter; left time: 5341.7067s
	iters: 2100, epoch: 3 | loss: 0.0761323
	speed: 0.1153s/iter; left time: 5326.9113s
	iters: 2200, epoch: 3 | loss: 0.0735498
	speed: 0.1153s/iter; left time: 5318.7964s
	iters: 2300, epoch: 3 | loss: 0.0608646
	speed: 0.1022s/iter; left time: 4700.6453s
	iters: 2400, epoch: 3 | loss: 0.0716532
	speed: 0.1103s/iter; left time: 5063.1770s
	iters: 2500, epoch: 3 | loss: 0.0780609
	speed: 0.1170s/iter; left time: 5361.0799s
	iters: 2600, epoch: 3 | loss: 0.0768194
	speed: 0.1170s/iter; left time: 5349.9745s
Epoch: 3 cost time: 00h:05m:09.45s
Epoch: 3 | Train Loss: 0.0732791 Vali Loss: 0.0775053 Test Loss: 0.0882827
Validation loss decreased (0.078354 --> 0.077505).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0618128
	speed: 0.9854s/iter; left time: 44863.6708s
	iters: 200, epoch: 4 | loss: 0.0684583
	speed: 0.1171s/iter; left time: 5319.3668s
	iters: 300, epoch: 4 | loss: 0.0878761
	speed: 0.1120s/iter; left time: 5077.5005s
	iters: 400, epoch: 4 | loss: 0.0614962
	speed: 0.1100s/iter; left time: 4973.6896s
	iters: 500, epoch: 4 | loss: 0.0650298
	speed: 0.1076s/iter; left time: 4854.9516s
	iters: 600, epoch: 4 | loss: 0.0691537
	speed: 0.1162s/iter; left time: 5231.9482s
	iters: 700, epoch: 4 | loss: 0.0632137
	speed: 0.1153s/iter; left time: 5182.1700s
	iters: 800, epoch: 4 | loss: 0.0605262
	speed: 0.1166s/iter; left time: 5227.5753s
	iters: 900, epoch: 4 | loss: 0.0776869
	speed: 0.1161s/iter; left time: 5192.7091s
	iters: 1000, epoch: 4 | loss: 0.0974346
	speed: 0.1165s/iter; left time: 5198.8521s
	iters: 1100, epoch: 4 | loss: 0.0625406
	speed: 0.1159s/iter; left time: 5160.0367s
	iters: 1200, epoch: 4 | loss: 0.0563061
	speed: 0.1129s/iter; left time: 5015.2611s
	iters: 1300, epoch: 4 | loss: 0.0730062
	speed: 0.1165s/iter; left time: 5162.6243s
	iters: 1400, epoch: 4 | loss: 0.0758484
	speed: 0.1157s/iter; left time: 5118.4553s
	iters: 1500, epoch: 4 | loss: 0.0684197
	speed: 0.1156s/iter; left time: 5100.2411s
	iters: 1600, epoch: 4 | loss: 0.0800384
	speed: 0.1124s/iter; left time: 4948.6238s
	iters: 1700, epoch: 4 | loss: 0.1039231
	speed: 0.1055s/iter; left time: 4634.5882s
	iters: 1800, epoch: 4 | loss: 0.0638697
	speed: 0.0970s/iter; left time: 4253.5934s
	iters: 1900, epoch: 4 | loss: 0.0696328
	speed: 0.0969s/iter; left time: 4236.3141s
	iters: 2000, epoch: 4 | loss: 0.0607886
	speed: 0.1163s/iter; left time: 5074.3592s
	iters: 2100, epoch: 4 | loss: 0.0725573
	speed: 0.1157s/iter; left time: 5034.8533s
	iters: 2200, epoch: 4 | loss: 0.0679766
	speed: 0.1156s/iter; left time: 5018.6808s
	iters: 2300, epoch: 4 | loss: 0.0680952
	speed: 0.1166s/iter; left time: 5053.9386s
	iters: 2400, epoch: 4 | loss: 0.0643962
	speed: 0.1166s/iter; left time: 5041.6817s
	iters: 2500, epoch: 4 | loss: 0.0806731
	speed: 0.1170s/iter; left time: 5047.9906s
	iters: 2600, epoch: 4 | loss: 0.0733256
	speed: 0.1160s/iter; left time: 4991.8655s
Epoch: 4 cost time: 00h:05m:05.10s
Epoch: 4 | Train Loss: 0.0717433 Vali Loss: 0.0767714 Test Loss: 0.0877820
Validation loss decreased (0.077505 --> 0.076771).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0772906
	speed: 0.9804s/iter; left time: 42004.9112s
	iters: 200, epoch: 5 | loss: 0.0602556
	speed: 0.1152s/iter; left time: 4924.2128s
	iters: 300, epoch: 5 | loss: 0.0761829
	speed: 0.1156s/iter; left time: 4931.3701s
	iters: 400, epoch: 5 | loss: 0.0785191
	speed: 0.1158s/iter; left time: 4928.3237s
	iters: 500, epoch: 5 | loss: 0.0726331
	speed: 0.1176s/iter; left time: 4990.9619s
	iters: 600, epoch: 5 | loss: 0.0628080
	speed: 0.1190s/iter; left time: 5040.7194s
	iters: 700, epoch: 5 | loss: 0.0705963
	speed: 0.1208s/iter; left time: 5104.8287s
	iters: 800, epoch: 5 | loss: 0.0640927
	speed: 0.1170s/iter; left time: 4929.9057s
	iters: 900, epoch: 5 | loss: 0.0642261
	speed: 0.1168s/iter; left time: 4909.6580s
	iters: 1000, epoch: 5 | loss: 0.0796294
	speed: 0.1165s/iter; left time: 4886.9596s
	iters: 1100, epoch: 5 | loss: 0.0674907
	speed: 0.1161s/iter; left time: 4857.7713s
	iters: 1200, epoch: 5 | loss: 0.0745679
	speed: 0.1176s/iter; left time: 4909.6260s
	iters: 1300, epoch: 5 | loss: 0.0665957
	speed: 0.1170s/iter; left time: 4871.9910s
	iters: 1400, epoch: 5 | loss: 0.0686471
	speed: 0.1155s/iter; left time: 4799.7413s
	iters: 1500, epoch: 5 | loss: 0.0801993
	speed: 0.1171s/iter; left time: 4851.6019s
	iters: 1600, epoch: 5 | loss: 0.0743748
	speed: 0.1161s/iter; left time: 4800.7026s
	iters: 1700, epoch: 5 | loss: 0.0830029
	speed: 0.1153s/iter; left time: 4756.4299s
	iters: 1800, epoch: 5 | loss: 0.0718037
	speed: 0.1164s/iter; left time: 4789.2782s
	iters: 1900, epoch: 5 | loss: 0.0723873
	speed: 0.1169s/iter; left time: 4797.9684s
	iters: 2000, epoch: 5 | loss: 0.0700455
	speed: 0.1187s/iter; left time: 4861.5283s
	iters: 2100, epoch: 5 | loss: 0.0692627
	speed: 0.1159s/iter; left time: 4734.9627s
	iters: 2200, epoch: 5 | loss: 0.0740308
	speed: 0.1189s/iter; left time: 4842.9737s
	iters: 2300, epoch: 5 | loss: 0.0640778
	speed: 0.1175s/iter; left time: 4774.9139s
	iters: 2400, epoch: 5 | loss: 0.0611654
	speed: 0.1158s/iter; left time: 4693.2176s
	iters: 2500, epoch: 5 | loss: 0.0829783
	speed: 0.1152s/iter; left time: 4660.5101s
	iters: 2600, epoch: 5 | loss: 0.0644178
	speed: 0.1072s/iter; left time: 4322.9743s
Epoch: 5 cost time: 00h:05m:13.02s
Epoch: 5 | Train Loss: 0.0704540 Vali Loss: 0.0779003 Test Loss: 0.0883271
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0766604
	speed: 0.9490s/iter; left time: 38111.2026s
	iters: 200, epoch: 6 | loss: 0.0602073
	speed: 0.1150s/iter; left time: 4606.6883s
	iters: 300, epoch: 6 | loss: 0.0693253
	speed: 0.1157s/iter; left time: 4624.1599s
	iters: 400, epoch: 6 | loss: 0.0750857
	speed: 0.1155s/iter; left time: 4602.2455s
	iters: 500, epoch: 6 | loss: 0.0740420
	speed: 0.1162s/iter; left time: 4620.1758s
	iters: 600, epoch: 6 | loss: 0.0870911
	speed: 0.1158s/iter; left time: 4594.5795s
	iters: 700, epoch: 6 | loss: 0.0626083
	speed: 0.1151s/iter; left time: 4552.2886s
	iters: 800, epoch: 6 | loss: 0.0737172
	speed: 0.1159s/iter; left time: 4572.6820s
	iters: 900, epoch: 6 | loss: 0.0666808
	speed: 0.1152s/iter; left time: 4532.8060s
	iters: 1000, epoch: 6 | loss: 0.0632041
	speed: 0.1152s/iter; left time: 4522.9705s
	iters: 1100, epoch: 6 | loss: 0.0679926
	speed: 0.1149s/iter; left time: 4497.6465s
	iters: 1200, epoch: 6 | loss: 0.0704225
	speed: 0.1138s/iter; left time: 4444.8616s
	iters: 1300, epoch: 6 | loss: 0.0641174
	speed: 0.1144s/iter; left time: 4458.7806s
	iters: 1400, epoch: 6 | loss: 0.0752409
	speed: 0.0969s/iter; left time: 3766.7865s
	iters: 1500, epoch: 6 | loss: 0.0732217
	speed: 0.1159s/iter; left time: 4490.7261s
	iters: 1600, epoch: 6 | loss: 0.0692174
	speed: 0.1169s/iter; left time: 4518.5567s
	iters: 1700, epoch: 6 | loss: 0.0633075
	speed: 0.1160s/iter; left time: 4473.1074s
	iters: 1800, epoch: 6 | loss: 0.0659616
	speed: 0.1154s/iter; left time: 4438.9299s
	iters: 1900, epoch: 6 | loss: 0.0701341
	speed: 0.1159s/iter; left time: 4445.0044s
	iters: 2000, epoch: 6 | loss: 0.0799484
	speed: 0.1162s/iter; left time: 4445.5652s
	iters: 2100, epoch: 6 | loss: 0.0665025
	speed: 0.1153s/iter; left time: 4401.8152s
	iters: 2200, epoch: 6 | loss: 0.0605779
	speed: 0.1154s/iter; left time: 4390.6827s
	iters: 2300, epoch: 6 | loss: 0.0754763
	speed: 0.1155s/iter; left time: 4382.7074s
	iters: 2400, epoch: 6 | loss: 0.0764293
	speed: 0.1146s/iter; left time: 4338.9996s
	iters: 2500, epoch: 6 | loss: 0.0653570
	speed: 0.1148s/iter; left time: 4333.6815s
	iters: 2600, epoch: 6 | loss: 0.0497287
	speed: 0.1147s/iter; left time: 4318.6174s
Epoch: 6 cost time: 00h:05m:08.43s
Epoch: 6 | Train Loss: 0.0689933 Vali Loss: 0.0801865 Test Loss: 0.0887019
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0567738
	speed: 0.9551s/iter; left time: 35796.1148s
	iters: 200, epoch: 7 | loss: 0.0698603
	speed: 0.1164s/iter; left time: 4351.4329s
	iters: 300, epoch: 7 | loss: 0.0627555
	speed: 0.1164s/iter; left time: 4337.1812s
	iters: 400, epoch: 7 | loss: 0.0711131
	speed: 0.1148s/iter; left time: 4266.3924s
	iters: 500, epoch: 7 | loss: 0.0619935
	speed: 0.1056s/iter; left time: 3914.1867s
	iters: 600, epoch: 7 | loss: 0.0684474
	speed: 0.0993s/iter; left time: 3670.1069s
	iters: 700, epoch: 7 | loss: 0.0584849
	speed: 0.0964s/iter; left time: 3556.7805s
	iters: 800, epoch: 7 | loss: 0.0825376
	speed: 0.1175s/iter; left time: 4322.6650s
	iters: 900, epoch: 7 | loss: 0.0589024
	speed: 0.1162s/iter; left time: 4260.5552s
	iters: 1000, epoch: 7 | loss: 0.0760413
	speed: 0.1181s/iter; left time: 4321.4916s
	iters: 1100, epoch: 7 | loss: 0.0752413
	speed: 0.1166s/iter; left time: 4251.7001s
	iters: 1200, epoch: 7 | loss: 0.0719468
	speed: 0.1162s/iter; left time: 4228.4449s
	iters: 1300, epoch: 7 | loss: 0.0687664
	speed: 0.1178s/iter; left time: 4271.6289s
	iters: 1400, epoch: 7 | loss: 0.0635155
	speed: 0.1170s/iter; left time: 4234.4860s
	iters: 1500, epoch: 7 | loss: 0.0563175
	speed: 0.1154s/iter; left time: 4163.9422s
	iters: 1600, epoch: 7 | loss: 0.0767602
	speed: 0.1161s/iter; left time: 4177.0578s
	iters: 1700, epoch: 7 | loss: 0.0655388
	speed: 0.1168s/iter; left time: 4188.8851s
	iters: 1800, epoch: 7 | loss: 0.0644029
	speed: 0.1167s/iter; left time: 4175.4584s
	iters: 1900, epoch: 7 | loss: 0.0621075
	speed: 0.1163s/iter; left time: 4150.9808s
	iters: 2000, epoch: 7 | loss: 0.0698945
	speed: 0.1183s/iter; left time: 4208.0165s
	iters: 2100, epoch: 7 | loss: 0.0594934
	speed: 0.1169s/iter; left time: 4147.5437s
	iters: 2200, epoch: 7 | loss: 0.0764240
	speed: 0.1169s/iter; left time: 4134.8430s
	iters: 2300, epoch: 7 | loss: 0.0701658
	speed: 0.1163s/iter; left time: 4101.5739s
	iters: 2400, epoch: 7 | loss: 0.0640838
	speed: 0.1173s/iter; left time: 4126.3804s
	iters: 2500, epoch: 7 | loss: 0.0787112
	speed: 0.1165s/iter; left time: 4086.9096s
	iters: 2600, epoch: 7 | loss: 0.0690667
	speed: 0.1156s/iter; left time: 4042.4559s
Epoch: 7 cost time: 00h:05m:08.77s
Epoch: 7 | Train Loss: 0.0675281 Vali Loss: 0.0804067 Test Loss: 0.0894281
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0717882
	speed: 0.9574s/iter; left time: 33309.8724s
	iters: 200, epoch: 8 | loss: 0.0605006
	speed: 0.1160s/iter; left time: 4024.5968s
	iters: 300, epoch: 8 | loss: 0.0679652
	speed: 0.1162s/iter; left time: 4019.0646s
	iters: 400, epoch: 8 | loss: 0.0670836
	speed: 0.1138s/iter; left time: 3924.8729s
	iters: 500, epoch: 8 | loss: 0.0609015
	speed: 0.1095s/iter; left time: 3766.6694s
	iters: 600, epoch: 8 | loss: 0.0691020
	speed: 0.1154s/iter; left time: 3957.7316s
	iters: 700, epoch: 8 | loss: 0.0870408
	speed: 0.1170s/iter; left time: 4000.6373s
	iters: 800, epoch: 8 | loss: 0.0670967
	speed: 0.1153s/iter; left time: 3929.4964s
	iters: 900, epoch: 8 | loss: 0.0613804
	speed: 0.1153s/iter; left time: 3917.7232s
	iters: 1000, epoch: 8 | loss: 0.0556819
	speed: 0.1169s/iter; left time: 3960.6988s
	iters: 1100, epoch: 8 | loss: 0.0724371
	speed: 0.1152s/iter; left time: 3891.3479s
	iters: 1200, epoch: 8 | loss: 0.0520738
	speed: 0.1176s/iter; left time: 3961.8690s
	iters: 1300, epoch: 8 | loss: 0.0637756
	speed: 0.1162s/iter; left time: 3902.5430s
	iters: 1400, epoch: 8 | loss: 0.0791539
	speed: 0.1144s/iter; left time: 3830.5374s
	iters: 1500, epoch: 8 | loss: 0.0764657
	speed: 0.1085s/iter; left time: 3622.4277s
	iters: 1600, epoch: 8 | loss: 0.0693158
	speed: 0.1170s/iter; left time: 3894.0243s
	iters: 1700, epoch: 8 | loss: 0.0667949
	speed: 0.1159s/iter; left time: 3847.0470s
	iters: 1800, epoch: 8 | loss: 0.0755049
	speed: 0.1168s/iter; left time: 3864.3251s
	iters: 1900, epoch: 8 | loss: 0.0684051
	speed: 0.1168s/iter; left time: 3853.6416s
	iters: 2000, epoch: 8 | loss: 0.0655407
	speed: 0.1169s/iter; left time: 3845.7445s
	iters: 2100, epoch: 8 | loss: 0.0763611
	speed: 0.1165s/iter; left time: 3819.8486s
	iters: 2200, epoch: 8 | loss: 0.0691977
	speed: 0.1162s/iter; left time: 3800.4033s
	iters: 2300, epoch: 8 | loss: 0.0659143
	speed: 0.1161s/iter; left time: 3784.8566s
	iters: 2400, epoch: 8 | loss: 0.0583210
	speed: 0.0995s/iter; left time: 3233.6551s
	iters: 2500, epoch: 8 | loss: 0.0685454
	speed: 0.1171s/iter; left time: 3794.1018s
	iters: 2600, epoch: 8 | loss: 0.0590881
	speed: 0.1169s/iter; left time: 3773.8764s
Epoch: 8 cost time: 00h:05m:09.16s
Epoch: 8 | Train Loss: 0.0660281 Vali Loss: 0.0795411 Test Loss: 0.0886591
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.0612876
	speed: 0.9596s/iter; left time: 30810.7018s
	iters: 200, epoch: 9 | loss: 0.0573643
	speed: 0.1176s/iter; left time: 3764.3037s
	iters: 300, epoch: 9 | loss: 0.0823771
	speed: 0.1178s/iter; left time: 3757.7956s
	iters: 400, epoch: 9 | loss: 0.0628237
	speed: 0.1158s/iter; left time: 3683.7614s
	iters: 500, epoch: 9 | loss: 0.0592355
	speed: 0.1159s/iter; left time: 3674.8911s
	iters: 600, epoch: 9 | loss: 0.0575299
	speed: 0.1155s/iter; left time: 3649.7265s
	iters: 700, epoch: 9 | loss: 0.0713902
	speed: 0.1150s/iter; left time: 3623.1765s
	iters: 800, epoch: 9 | loss: 0.0673367
	speed: 0.1168s/iter; left time: 3669.7089s
	iters: 900, epoch: 9 | loss: 0.0654938
	speed: 0.1144s/iter; left time: 3582.6519s
	iters: 1000, epoch: 9 | loss: 0.0654262
	speed: 0.1163s/iter; left time: 3629.7195s
	iters: 1100, epoch: 9 | loss: 0.0678178
	speed: 0.1165s/iter; left time: 3623.6421s
	iters: 1200, epoch: 9 | loss: 0.0703463
	speed: 0.1161s/iter; left time: 3598.7283s
	iters: 1300, epoch: 9 | loss: 0.0616599
	speed: 0.1175s/iter; left time: 3632.7587s
	iters: 1400, epoch: 9 | loss: 0.0652685
	speed: 0.1133s/iter; left time: 3491.6282s
	iters: 1500, epoch: 9 | loss: 0.0672777
	speed: 0.1177s/iter; left time: 3614.9463s
	iters: 1600, epoch: 9 | loss: 0.0607611
	speed: 0.1159s/iter; left time: 3546.3244s
	iters: 1700, epoch: 9 | loss: 0.0589829
	speed: 0.1155s/iter; left time: 3522.8006s
	iters: 1800, epoch: 9 | loss: 0.0738688
	speed: 0.1164s/iter; left time: 3538.8598s
	iters: 1900, epoch: 9 | loss: 0.0663319
	speed: 0.1154s/iter; left time: 3498.4936s
	iters: 2000, epoch: 9 | loss: 0.0749816
	speed: 0.1156s/iter; left time: 3492.0085s
	iters: 2100, epoch: 9 | loss: 0.0585454
	speed: 0.1163s/iter; left time: 3501.9838s
	iters: 2200, epoch: 9 | loss: 0.0625599
	speed: 0.1175s/iter; left time: 3525.3204s
	iters: 2300, epoch: 9 | loss: 0.0571969
	speed: 0.1177s/iter; left time: 3519.8619s
	iters: 2400, epoch: 9 | loss: 0.0624960
	speed: 0.1170s/iter; left time: 3486.2738s
	iters: 2500, epoch: 9 | loss: 0.0616413
	speed: 0.1165s/iter; left time: 3459.9627s
	iters: 2600, epoch: 9 | loss: 0.0632547
	speed: 0.1166s/iter; left time: 3451.8509s
Epoch: 9 cost time: 00h:05m:12.61s
Epoch: 9 | Train Loss: 0.0648369 Vali Loss: 0.0807261 Test Loss: 0.0902847
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.020460350438952446, rmse:0.14303968846797943, mae:0.08778193593025208, rse:0.5541521310806274
success delete checkpoints
Intermediate time for FR and pred_len 168: 00h:59m:08.07s
Intermediate time for FR: 03h:49m:01.90s

=== Starting experiments for country: IT ===

=== Starting experiments for pred_len: 24 ===

--- Running model for IT, pred_len=24 ---
train 86331
val 18651
test 18651
[2024-11-02 21:01:26,670] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-02 21:01:27,921] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-02 21:01:27,921] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-02 21:01:27,921] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-02 21:01:28,030] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-02 21:01:28,030] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-02 21:01:28,698] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-02 21:01:28,700] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-02 21:01:28,700] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-02 21:01:28,702] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-02 21:01:28,702] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-02 21:01:28,702] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-02 21:01:28,703] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-02 21:01:28,703] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-02 21:01:28,703] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-02 21:01:28,703] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-02 21:01:29,038] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-02 21:01:29,039] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-02 21:01:29,039] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 75.4 GB, percent = 10.0%
[2024-11-02 21:01:29,160] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-02 21:01:29,161] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 21:01:29,161] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 75.4 GB, percent = 10.0%
[2024-11-02 21:01:29,161] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-02 21:01:29,274] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-02 21:01:29,275] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 21:01:29,276] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 75.4 GB, percent = 10.0%
[2024-11-02 21:01:29,276] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-02 21:01:29,276] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-02 21:01:29,276] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-02 21:01:29,277] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-02 21:01:29,277] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f888c84bc50>
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-02 21:01:29,278] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-02 21:01:29,279] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-02 21:01:29,280] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-02 21:01:29,280] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1616891
	speed: 0.1710s/iter; left time: 9204.6952s
	iters: 200, epoch: 1 | loss: 0.1988888
	speed: 0.1278s/iter; left time: 6870.6330s
	iters: 300, epoch: 1 | loss: 0.1653045
	speed: 0.1282s/iter; left time: 6874.5522s
	iters: 400, epoch: 1 | loss: 0.1196822
	speed: 0.1257s/iter; left time: 6731.4162s
	iters: 500, epoch: 1 | loss: 0.1014044
	speed: 0.1252s/iter; left time: 6691.8765s
	iters: 600, epoch: 1 | loss: 0.0925063
	speed: 0.1268s/iter; left time: 6763.2208s
	iters: 700, epoch: 1 | loss: 0.0790739
	speed: 0.1249s/iter; left time: 6651.4008s
	iters: 800, epoch: 1 | loss: 0.0929413
	speed: 0.1247s/iter; left time: 6625.0595s
	iters: 900, epoch: 1 | loss: 0.0834920
	speed: 0.1238s/iter; left time: 6567.8658s
	iters: 1000, epoch: 1 | loss: 0.0941050
	speed: 0.1239s/iter; left time: 6557.5897s
	iters: 1100, epoch: 1 | loss: 0.0919473
	speed: 0.1250s/iter; left time: 6605.1167s
	iters: 1200, epoch: 1 | loss: 0.0990285
	speed: 0.1270s/iter; left time: 6699.1351s
	iters: 1300, epoch: 1 | loss: 0.0970086
	speed: 0.1124s/iter; left time: 5916.7375s
	iters: 1400, epoch: 1 | loss: 0.0915016
	speed: 0.1241s/iter; left time: 6521.7872s
	iters: 1500, epoch: 1 | loss: 0.1036599
	speed: 0.1248s/iter; left time: 6546.6892s
	iters: 1600, epoch: 1 | loss: 0.0895585
	speed: 0.1241s/iter; left time: 6496.2484s
	iters: 1700, epoch: 1 | loss: 0.0857308
	speed: 0.1225s/iter; left time: 6400.2457s
	iters: 1800, epoch: 1 | loss: 0.1034492
	speed: 0.1259s/iter; left time: 6562.3418s
	iters: 1900, epoch: 1 | loss: 0.0879421
	speed: 0.1243s/iter; left time: 6467.3579s
	iters: 2000, epoch: 1 | loss: 0.0744498
	speed: 0.1255s/iter; left time: 6520.3883s
	iters: 2100, epoch: 1 | loss: 0.0770138
	speed: 0.1273s/iter; left time: 6598.1901s
	iters: 2200, epoch: 1 | loss: 0.0825696
	speed: 0.1246s/iter; left time: 6447.8373s
	iters: 2300, epoch: 1 | loss: 0.0842841
	speed: 0.1255s/iter; left time: 6478.9438s
	iters: 2400, epoch: 1 | loss: 0.0767634
	speed: 0.1241s/iter; left time: 6397.2387s
	iters: 2500, epoch: 1 | loss: 0.0836823
	speed: 0.1252s/iter; left time: 6441.0390s
	iters: 2600, epoch: 1 | loss: 0.0827758
	speed: 0.1258s/iter; left time: 6459.8688s
Epoch: 1 cost time: 00h:05m:38.23s
Epoch: 1 | Train Loss: 0.1062889 Vali Loss: 0.0663070 Test Loss: 0.0692037
Validation loss decreased (inf --> 0.066307).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0920735
	speed: 1.1417s/iter; left time: 58390.2894s
	iters: 200, epoch: 2 | loss: 0.0877688
	speed: 0.1157s/iter; left time: 5905.6337s
	iters: 300, epoch: 2 | loss: 0.0842819
	speed: 0.1162s/iter; left time: 5920.0065s
	iters: 400, epoch: 2 | loss: 0.0832414
	speed: 0.1161s/iter; left time: 5900.5147s
	iters: 500, epoch: 2 | loss: 0.0781539
	speed: 0.1150s/iter; left time: 5835.2356s
	iters: 600, epoch: 2 | loss: 0.0809719
	speed: 0.1158s/iter; left time: 5862.3119s
	iters: 700, epoch: 2 | loss: 0.0726647
	speed: 0.1163s/iter; left time: 5877.7406s
	iters: 800, epoch: 2 | loss: 0.0951623
	speed: 0.1123s/iter; left time: 5664.2424s
	iters: 900, epoch: 2 | loss: 0.0855009
	speed: 0.1155s/iter; left time: 5813.5665s
	iters: 1000, epoch: 2 | loss: 0.0684977
	speed: 0.1161s/iter; left time: 5835.6063s
	iters: 1100, epoch: 2 | loss: 0.0749037
	speed: 0.1147s/iter; left time: 5751.6981s
	iters: 1200, epoch: 2 | loss: 0.0930617
	speed: 0.1146s/iter; left time: 5735.1883s
	iters: 1300, epoch: 2 | loss: 0.0960172
	speed: 0.1165s/iter; left time: 5819.0670s
	iters: 1400, epoch: 2 | loss: 0.0739193
	speed: 0.1167s/iter; left time: 5819.0180s
	iters: 1500, epoch: 2 | loss: 0.0809535
	speed: 0.1167s/iter; left time: 5803.7011s
	iters: 1600, epoch: 2 | loss: 0.0809979
	speed: 0.1146s/iter; left time: 5689.8242s
	iters: 1700, epoch: 2 | loss: 0.0809475
	speed: 0.1144s/iter; left time: 5666.4364s
	iters: 1800, epoch: 2 | loss: 0.0921727
	speed: 0.1093s/iter; left time: 5404.8987s
	iters: 1900, epoch: 2 | loss: 0.0837119
	speed: 0.1000s/iter; left time: 4935.9752s
	iters: 2000, epoch: 2 | loss: 0.0755220
	speed: 0.1160s/iter; left time: 5711.7831s
	iters: 2100, epoch: 2 | loss: 0.0859457
	speed: 0.1161s/iter; left time: 5703.6259s
	iters: 2200, epoch: 2 | loss: 0.0785623
	speed: 0.1155s/iter; left time: 5662.6971s
	iters: 2300, epoch: 2 | loss: 0.0885806
	speed: 0.1166s/iter; left time: 5707.1235s
	iters: 2400, epoch: 2 | loss: 0.0720094
	speed: 0.1148s/iter; left time: 5606.4342s
	iters: 2500, epoch: 2 | loss: 0.0886370
	speed: 0.1121s/iter; left time: 5462.7781s
	iters: 2600, epoch: 2 | loss: 0.0621730
	speed: 0.1173s/iter; left time: 5705.9170s
Epoch: 2 cost time: 00h:05m:09.66s
Epoch: 2 | Train Loss: 0.0804989 Vali Loss: 0.0635860 Test Loss: 0.0664676
Validation loss decreased (0.066307 --> 0.063586).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0694548
	speed: 0.9960s/iter; left time: 48251.9254s
	iters: 200, epoch: 3 | loss: 0.0808334
	speed: 0.1149s/iter; left time: 5554.1130s
	iters: 300, epoch: 3 | loss: 0.0840988
	speed: 0.1169s/iter; left time: 5641.2641s
	iters: 400, epoch: 3 | loss: 0.0842470
	speed: 0.1125s/iter; left time: 5417.6274s
	iters: 500, epoch: 3 | loss: 0.0646141
	speed: 0.1144s/iter; left time: 5495.3484s
	iters: 600, epoch: 3 | loss: 0.0703670
	speed: 0.1158s/iter; left time: 5551.9364s
	iters: 700, epoch: 3 | loss: 0.1009109
	speed: 0.1150s/iter; left time: 5502.4580s
	iters: 800, epoch: 3 | loss: 0.0748487
	speed: 0.1155s/iter; left time: 5516.2524s
	iters: 900, epoch: 3 | loss: 0.0886928
	speed: 0.1145s/iter; left time: 5457.6055s
	iters: 1000, epoch: 3 | loss: 0.0754743
	speed: 0.1160s/iter; left time: 5516.3033s
	iters: 1100, epoch: 3 | loss: 0.0920176
	speed: 0.1142s/iter; left time: 5417.5835s
	iters: 1200, epoch: 3 | loss: 0.0903100
	speed: 0.1093s/iter; left time: 5174.3028s
	iters: 1300, epoch: 3 | loss: 0.0697832
	speed: 0.1165s/iter; left time: 5504.6654s
	iters: 1400, epoch: 3 | loss: 0.0736806
	speed: 0.1159s/iter; left time: 5462.9624s
	iters: 1500, epoch: 3 | loss: 0.0663067
	speed: 0.1161s/iter; left time: 5463.4055s
	iters: 1600, epoch: 3 | loss: 0.0637103
	speed: 0.1162s/iter; left time: 5455.8326s
	iters: 1700, epoch: 3 | loss: 0.0779963
	speed: 0.1161s/iter; left time: 5441.1227s
	iters: 1800, epoch: 3 | loss: 0.0827028
	speed: 0.1179s/iter; left time: 5512.7869s
	iters: 1900, epoch: 3 | loss: 0.1057388
	speed: 0.1165s/iter; left time: 5433.2936s
	iters: 2000, epoch: 3 | loss: 0.0641804
	speed: 0.1168s/iter; left time: 5436.3407s
	iters: 2100, epoch: 3 | loss: 0.0772232
	speed: 0.1172s/iter; left time: 5444.7137s
	iters: 2200, epoch: 3 | loss: 0.0680376
	speed: 0.1185s/iter; left time: 5490.3259s
	iters: 2300, epoch: 3 | loss: 0.0713496
	speed: 0.1163s/iter; left time: 5376.3683s
	iters: 2400, epoch: 3 | loss: 0.0559037
	speed: 0.1159s/iter; left time: 5349.9769s
	iters: 2500, epoch: 3 | loss: 0.0826620
	speed: 0.1179s/iter; left time: 5427.1389s
	iters: 2600, epoch: 3 | loss: 0.0766963
	speed: 0.1165s/iter; left time: 5351.9525s
Epoch: 3 cost time: 00h:05m:12.54s
Epoch: 3 | Train Loss: 0.0764710 Vali Loss: 0.0630326 Test Loss: 0.0662999
Validation loss decreased (0.063586 --> 0.063033).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0755529
	speed: 1.0027s/iter; left time: 45872.9982s
	iters: 200, epoch: 4 | loss: 0.0685682
	speed: 0.1149s/iter; left time: 5243.1481s
	iters: 300, epoch: 4 | loss: 0.0985739
	speed: 0.1156s/iter; left time: 5266.3793s
	iters: 400, epoch: 4 | loss: 0.0769638
	speed: 0.1143s/iter; left time: 5194.2122s
	iters: 500, epoch: 4 | loss: 0.0797975
	speed: 0.1152s/iter; left time: 5224.8052s
	iters: 600, epoch: 4 | loss: 0.0556481
	speed: 0.1143s/iter; left time: 5171.0541s
	iters: 700, epoch: 4 | loss: 0.0617126
	speed: 0.1145s/iter; left time: 5170.3960s
	iters: 800, epoch: 4 | loss: 0.0742233
	speed: 0.1145s/iter; left time: 5157.4712s
	iters: 900, epoch: 4 | loss: 0.0639015
	speed: 0.1143s/iter; left time: 5135.6826s
	iters: 1000, epoch: 4 | loss: 0.1003068
	speed: 0.1155s/iter; left time: 5180.0391s
	iters: 1100, epoch: 4 | loss: 0.0659704
	speed: 0.1157s/iter; left time: 5176.3203s
	iters: 1200, epoch: 4 | loss: 0.0864620
	speed: 0.1156s/iter; left time: 5162.7542s
	iters: 1300, epoch: 4 | loss: 0.0829317
	speed: 0.1178s/iter; left time: 5249.3917s
	iters: 1400, epoch: 4 | loss: 0.0683253
	speed: 0.1154s/iter; left time: 5129.9348s
	iters: 1500, epoch: 4 | loss: 0.0755579
	speed: 0.1159s/iter; left time: 5142.2098s
	iters: 1600, epoch: 4 | loss: 0.0791848
	speed: 0.1155s/iter; left time: 5112.1593s
	iters: 1700, epoch: 4 | loss: 0.0764505
	speed: 0.1153s/iter; left time: 5089.1324s
	iters: 1800, epoch: 4 | loss: 0.0608163
	speed: 0.1147s/iter; left time: 5050.6747s
	iters: 1900, epoch: 4 | loss: 0.0749248
	speed: 0.1144s/iter; left time: 5028.3983s
	iters: 2000, epoch: 4 | loss: 0.0778898
	speed: 0.1146s/iter; left time: 5025.2626s
	iters: 2100, epoch: 4 | loss: 0.0662812
	speed: 0.1173s/iter; left time: 5131.2864s
	iters: 2200, epoch: 4 | loss: 0.0748827
	speed: 0.1107s/iter; left time: 4833.3044s
	iters: 2300, epoch: 4 | loss: 0.0675273
	speed: 0.0966s/iter; left time: 4208.4745s
	iters: 2400, epoch: 4 | loss: 0.0791746
	speed: 0.1056s/iter; left time: 4589.5804s
	iters: 2500, epoch: 4 | loss: 0.0636560
	speed: 0.1145s/iter; left time: 4965.6911s
	iters: 2600, epoch: 4 | loss: 0.0793808
	speed: 0.1169s/iter; left time: 5055.9000s
Epoch: 4 cost time: 00h:05m:08.24s
Epoch: 4 | Train Loss: 0.0742877 Vali Loss: 0.0603242 Test Loss: 0.0631236
Validation loss decreased (0.063033 --> 0.060324).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0666447
	speed: 1.0072s/iter; left time: 43364.4964s
	iters: 200, epoch: 5 | loss: 0.0850932
	speed: 0.1146s/iter; left time: 4921.1163s
	iters: 300, epoch: 5 | loss: 0.0762963
	speed: 0.1154s/iter; left time: 4945.3224s
	iters: 400, epoch: 5 | loss: 0.0729807
	speed: 0.1155s/iter; left time: 4938.5099s
	iters: 500, epoch: 5 | loss: 0.0696062
	speed: 0.1161s/iter; left time: 4951.8754s
	iters: 600, epoch: 5 | loss: 0.0712013
	speed: 0.1155s/iter; left time: 4915.4375s
	iters: 700, epoch: 5 | loss: 0.0854386
	speed: 0.1150s/iter; left time: 4882.3641s
	iters: 800, epoch: 5 | loss: 0.0720558
	speed: 0.1146s/iter; left time: 4853.2534s
	iters: 900, epoch: 5 | loss: 0.0693585
	speed: 0.1140s/iter; left time: 4815.9188s
	iters: 1000, epoch: 5 | loss: 0.0752329
	speed: 0.1149s/iter; left time: 4842.3688s
	iters: 1100, epoch: 5 | loss: 0.0633822
	speed: 0.1150s/iter; left time: 4834.9946s
	iters: 1200, epoch: 5 | loss: 0.0723745
	speed: 0.1152s/iter; left time: 4834.8618s
	iters: 1300, epoch: 5 | loss: 0.0627828
	speed: 0.1158s/iter; left time: 4847.3634s
	iters: 1400, epoch: 5 | loss: 0.0818627
	speed: 0.1171s/iter; left time: 4887.8201s
	iters: 1500, epoch: 5 | loss: 0.0792903
	speed: 0.1173s/iter; left time: 4885.9770s
	iters: 1600, epoch: 5 | loss: 0.0754565
	speed: 0.1153s/iter; left time: 4792.2546s
	iters: 1700, epoch: 5 | loss: 0.0597070
	speed: 0.1140s/iter; left time: 4723.8120s
	iters: 1800, epoch: 5 | loss: 0.0933210
	speed: 0.1154s/iter; left time: 4770.6114s
	iters: 1900, epoch: 5 | loss: 0.0578079
	speed: 0.1153s/iter; left time: 4757.5930s
	iters: 2000, epoch: 5 | loss: 0.0638854
	speed: 0.1153s/iter; left time: 4746.6100s
	iters: 2100, epoch: 5 | loss: 0.0707066
	speed: 0.1152s/iter; left time: 4729.5655s
	iters: 2200, epoch: 5 | loss: 0.0822564
	speed: 0.1157s/iter; left time: 4737.3070s
	iters: 2300, epoch: 5 | loss: 0.0747746
	speed: 0.1167s/iter; left time: 4767.0517s
	iters: 2400, epoch: 5 | loss: 0.0669004
	speed: 0.1163s/iter; left time: 4738.6961s
	iters: 2500, epoch: 5 | loss: 0.0690131
	speed: 0.1156s/iter; left time: 4698.4356s
	iters: 2600, epoch: 5 | loss: 0.0732940
	speed: 0.1160s/iter; left time: 4702.6721s
Epoch: 5 cost time: 00h:05m:11.60s
Epoch: 5 | Train Loss: 0.0726861 Vali Loss: 0.0594335 Test Loss: 0.0628666
Validation loss decreased (0.060324 --> 0.059433).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0712747
	speed: 1.0098s/iter; left time: 40751.4645s
	iters: 200, epoch: 6 | loss: 0.0677786
	speed: 0.1160s/iter; left time: 4669.5459s
	iters: 300, epoch: 6 | loss: 0.0659821
	speed: 0.1129s/iter; left time: 4531.9930s
	iters: 400, epoch: 6 | loss: 0.0641622
	speed: 0.0966s/iter; left time: 3869.5682s
	iters: 500, epoch: 6 | loss: 0.0645634
	speed: 0.1138s/iter; left time: 4546.2729s
	iters: 600, epoch: 6 | loss: 0.0953365
	speed: 0.1147s/iter; left time: 4570.0293s
	iters: 700, epoch: 6 | loss: 0.0762194
	speed: 0.1156s/iter; left time: 4594.3468s
	iters: 800, epoch: 6 | loss: 0.0763267
	speed: 0.1150s/iter; left time: 4558.6683s
	iters: 900, epoch: 6 | loss: 0.0695393
	speed: 0.1166s/iter; left time: 4611.9340s
	iters: 1000, epoch: 6 | loss: 0.0557512
	speed: 0.1150s/iter; left time: 4536.4202s
	iters: 1100, epoch: 6 | loss: 0.0601773
	speed: 0.1157s/iter; left time: 4553.5366s
	iters: 1200, epoch: 6 | loss: 0.0580391
	speed: 0.1148s/iter; left time: 4507.3691s
	iters: 1300, epoch: 6 | loss: 0.0789730
	speed: 0.1146s/iter; left time: 4488.8459s
	iters: 1400, epoch: 6 | loss: 0.0700168
	speed: 0.1151s/iter; left time: 4494.8010s
	iters: 1500, epoch: 6 | loss: 0.0772208
	speed: 0.1163s/iter; left time: 4528.7595s
	iters: 1600, epoch: 6 | loss: 0.0704373
	speed: 0.1179s/iter; left time: 4581.1736s
	iters: 1700, epoch: 6 | loss: 0.0689978
	speed: 0.1154s/iter; left time: 4473.1068s
	iters: 1800, epoch: 6 | loss: 0.0662989
	speed: 0.1172s/iter; left time: 4529.5006s
	iters: 1900, epoch: 6 | loss: 0.0793340
	speed: 0.1157s/iter; left time: 4459.1564s
	iters: 2000, epoch: 6 | loss: 0.0628580
	speed: 0.1159s/iter; left time: 4458.5505s
	iters: 2100, epoch: 6 | loss: 0.0749498
	speed: 0.1148s/iter; left time: 4402.8768s
	iters: 2200, epoch: 6 | loss: 0.0798656
	speed: 0.1170s/iter; left time: 4474.1263s
	iters: 2300, epoch: 6 | loss: 0.0600675
	speed: 0.1153s/iter; left time: 4398.9489s
	iters: 2400, epoch: 6 | loss: 0.0627799
	speed: 0.1141s/iter; left time: 4343.0951s
	iters: 2500, epoch: 6 | loss: 0.0818583
	speed: 0.1154s/iter; left time: 4378.3304s
	iters: 2600, epoch: 6 | loss: 0.0600302
	speed: 0.1018s/iter; left time: 3852.0382s
Epoch: 6 cost time: 00h:05m:06.58s
Epoch: 6 | Train Loss: 0.0715059 Vali Loss: 0.0587914 Test Loss: 0.0618361
Validation loss decreased (0.059433 --> 0.058791).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0741726
	speed: 0.9898s/iter; left time: 37275.9424s
	iters: 200, epoch: 7 | loss: 0.0748587
	speed: 0.1156s/iter; left time: 4340.0231s
	iters: 300, epoch: 7 | loss: 0.0780735
	speed: 0.1167s/iter; left time: 4372.8185s
	iters: 400, epoch: 7 | loss: 0.0651705
	speed: 0.1146s/iter; left time: 4280.4686s
	iters: 500, epoch: 7 | loss: 0.0722456
	speed: 0.1109s/iter; left time: 4132.7038s
	iters: 600, epoch: 7 | loss: 0.0781499
	speed: 0.1054s/iter; left time: 3915.9669s
	iters: 700, epoch: 7 | loss: 0.0795180
	speed: 0.0999s/iter; left time: 3702.2645s
	iters: 800, epoch: 7 | loss: 0.0717324
	speed: 0.1112s/iter; left time: 4108.1203s
	iters: 900, epoch: 7 | loss: 0.0713158
	speed: 0.1148s/iter; left time: 4230.6673s
	iters: 1000, epoch: 7 | loss: 0.0723086
	speed: 0.1154s/iter; left time: 4243.1740s
	iters: 1100, epoch: 7 | loss: 0.0738894
	speed: 0.1151s/iter; left time: 4219.7402s
	iters: 1200, epoch: 7 | loss: 0.0729173
	speed: 0.1155s/iter; left time: 4222.6904s
	iters: 1300, epoch: 7 | loss: 0.0678999
	speed: 0.1167s/iter; left time: 4256.3744s
	iters: 1400, epoch: 7 | loss: 0.0747445
	speed: 0.1152s/iter; left time: 4187.8987s
	iters: 1500, epoch: 7 | loss: 0.0734894
	speed: 0.1132s/iter; left time: 4106.2845s
	iters: 1600, epoch: 7 | loss: 0.0665492
	speed: 0.1158s/iter; left time: 4188.5237s
	iters: 1700, epoch: 7 | loss: 0.0577601
	speed: 0.1139s/iter; left time: 4106.2015s
	iters: 1800, epoch: 7 | loss: 0.0670582
	speed: 0.1161s/iter; left time: 4174.8886s
	iters: 1900, epoch: 7 | loss: 0.0767235
	speed: 0.1158s/iter; left time: 4152.4629s
	iters: 2000, epoch: 7 | loss: 0.0678485
	speed: 0.1166s/iter; left time: 4168.5701s
	iters: 2100, epoch: 7 | loss: 0.0605740
	speed: 0.1173s/iter; left time: 4181.9423s
	iters: 2200, epoch: 7 | loss: 0.0644402
	speed: 0.1171s/iter; left time: 4162.1812s
	iters: 2300, epoch: 7 | loss: 0.0643342
	speed: 0.1157s/iter; left time: 4101.2533s
	iters: 2400, epoch: 7 | loss: 0.0800190
	speed: 0.1146s/iter; left time: 4051.4881s
	iters: 2500, epoch: 7 | loss: 0.0799797
	speed: 0.1153s/iter; left time: 4064.3580s
	iters: 2600, epoch: 7 | loss: 0.0731578
	speed: 0.1155s/iter; left time: 4060.5084s
Epoch: 7 cost time: 00h:05m:08.92s
Epoch: 7 | Train Loss: 0.0705104 Vali Loss: 0.0588274 Test Loss: 0.0623315
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0723313
	speed: 0.9858s/iter; left time: 34464.8020s
	iters: 200, epoch: 8 | loss: 0.0710911
	speed: 0.1143s/iter; left time: 3983.3980s
	iters: 300, epoch: 8 | loss: 0.0671540
	speed: 0.1150s/iter; left time: 3998.1304s
	iters: 400, epoch: 8 | loss: 0.0813148
	speed: 0.1145s/iter; left time: 3969.5058s
	iters: 500, epoch: 8 | loss: 0.0627014
	speed: 0.1151s/iter; left time: 3978.6193s
	iters: 600, epoch: 8 | loss: 0.0611403
	speed: 0.1141s/iter; left time: 3931.4380s
	iters: 700, epoch: 8 | loss: 0.0833048
	speed: 0.1146s/iter; left time: 3939.2204s
	iters: 800, epoch: 8 | loss: 0.0658636
	speed: 0.1141s/iter; left time: 3908.3466s
	iters: 900, epoch: 8 | loss: 0.0716917
	speed: 0.1140s/iter; left time: 3895.7594s
	iters: 1000, epoch: 8 | loss: 0.0793457
	speed: 0.1154s/iter; left time: 3929.5973s
	iters: 1100, epoch: 8 | loss: 0.0693654
	speed: 0.1138s/iter; left time: 3863.4662s
	iters: 1200, epoch: 8 | loss: 0.0896589
	speed: 0.1143s/iter; left time: 3869.8106s
	iters: 1300, epoch: 8 | loss: 0.0923285
	speed: 0.1043s/iter; left time: 3520.1031s
	iters: 1400, epoch: 8 | loss: 0.0691433
	speed: 0.1152s/iter; left time: 3876.5073s
	iters: 1500, epoch: 8 | loss: 0.0635347
	speed: 0.1170s/iter; left time: 3926.9469s
	iters: 1600, epoch: 8 | loss: 0.0756910
	speed: 0.1167s/iter; left time: 3903.9346s
	iters: 1700, epoch: 8 | loss: 0.0683165
	speed: 0.1173s/iter; left time: 3912.8210s
	iters: 1800, epoch: 8 | loss: 0.0640305
	speed: 0.1116s/iter; left time: 3713.2979s
	iters: 1900, epoch: 8 | loss: 0.0605875
	speed: 0.1162s/iter; left time: 3853.8823s
	iters: 2000, epoch: 8 | loss: 0.0707027
	speed: 0.1100s/iter; left time: 3637.5042s
	iters: 2100, epoch: 8 | loss: 0.0703436
	speed: 0.1113s/iter; left time: 3668.6883s
	iters: 2200, epoch: 8 | loss: 0.0644438
	speed: 0.1153s/iter; left time: 3788.0077s
	iters: 2300, epoch: 8 | loss: 0.0740883
	speed: 0.1120s/iter; left time: 3668.1759s
	iters: 2400, epoch: 8 | loss: 0.0688714
	speed: 0.1159s/iter; left time: 3786.6674s
	iters: 2500, epoch: 8 | loss: 0.0841499
	speed: 0.1163s/iter; left time: 3787.9676s
	iters: 2600, epoch: 8 | loss: 0.0752901
	speed: 0.1151s/iter; left time: 3736.7459s
Epoch: 8 cost time: 00h:05m:08.57s
Epoch: 8 | Train Loss: 0.0698472 Vali Loss: 0.0581357 Test Loss: 0.0614739
Validation loss decreased (0.058791 --> 0.058136).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.0787969
	speed: 1.0198s/iter; left time: 32905.3798s
	iters: 200, epoch: 9 | loss: 0.0585354
	speed: 0.1158s/iter; left time: 3726.0159s
	iters: 300, epoch: 9 | loss: 0.0858474
	speed: 0.1160s/iter; left time: 3720.9209s
	iters: 400, epoch: 9 | loss: 0.0597564
	speed: 0.1168s/iter; left time: 3732.4743s
	iters: 500, epoch: 9 | loss: 0.0880816
	speed: 0.1147s/iter; left time: 3656.4618s
	iters: 600, epoch: 9 | loss: 0.0697973
	speed: 0.1143s/iter; left time: 3629.9317s
	iters: 700, epoch: 9 | loss: 0.0531395
	speed: 0.1137s/iter; left time: 3601.7995s
	iters: 800, epoch: 9 | loss: 0.0829247
	speed: 0.1131s/iter; left time: 3571.4335s
	iters: 900, epoch: 9 | loss: 0.0627392
	speed: 0.1139s/iter; left time: 3583.4731s
	iters: 1000, epoch: 9 | loss: 0.0607399
	speed: 0.1139s/iter; left time: 3573.6254s
	iters: 1100, epoch: 9 | loss: 0.0579930
	speed: 0.1143s/iter; left time: 3573.2211s
	iters: 1200, epoch: 9 | loss: 0.0707458
	speed: 0.1140s/iter; left time: 3551.6134s
	iters: 1300, epoch: 9 | loss: 0.0769623
	speed: 0.0971s/iter; left time: 3015.7709s
	iters: 1400, epoch: 9 | loss: 0.0854174
	speed: 0.0980s/iter; left time: 3033.3488s
	iters: 1500, epoch: 9 | loss: 0.0642810
	speed: 0.1155s/iter; left time: 3565.7086s
	iters: 1600, epoch: 9 | loss: 0.0589194
	speed: 0.1082s/iter; left time: 3329.5130s
	iters: 1700, epoch: 9 | loss: 0.0693697
	speed: 0.1096s/iter; left time: 3360.7651s
	iters: 1800, epoch: 9 | loss: 0.0666921
	speed: 0.1132s/iter; left time: 3459.6487s
	iters: 1900, epoch: 9 | loss: 0.0715291
	speed: 0.1159s/iter; left time: 3529.5364s
	iters: 2000, epoch: 9 | loss: 0.0702265
	speed: 0.1149s/iter; left time: 3490.3398s
	iters: 2100, epoch: 9 | loss: 0.0707251
	speed: 0.1154s/iter; left time: 3493.2598s
	iters: 2200, epoch: 9 | loss: 0.0606815
	speed: 0.1157s/iter; left time: 3490.7647s
	iters: 2300, epoch: 9 | loss: 0.0693892
	speed: 0.1145s/iter; left time: 3441.3629s
	iters: 2400, epoch: 9 | loss: 0.0803939
	speed: 0.1162s/iter; left time: 3481.7337s
	iters: 2500, epoch: 9 | loss: 0.0663976
	speed: 0.1151s/iter; left time: 3438.7551s
	iters: 2600, epoch: 9 | loss: 0.0611548
	speed: 0.1135s/iter; left time: 3377.7964s
Epoch: 9 cost time: 00h:05m:05.59s
Epoch: 9 | Train Loss: 0.0691710 Vali Loss: 0.0575196 Test Loss: 0.0609406
Validation loss decreased (0.058136 --> 0.057520).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 10 | loss: 0.0594188
	speed: 0.9952s/iter; left time: 29425.7740s
	iters: 200, epoch: 10 | loss: 0.0590801
	speed: 0.1014s/iter; left time: 2989.4648s
	iters: 300, epoch: 10 | loss: 0.0680371
	speed: 0.1140s/iter; left time: 3347.5216s
	iters: 400, epoch: 10 | loss: 0.0673472
	speed: 0.1087s/iter; left time: 3181.0288s
	iters: 500, epoch: 10 | loss: 0.0599458
	speed: 0.1069s/iter; left time: 3117.6651s
	iters: 600, epoch: 10 | loss: 0.0861257
	speed: 0.1146s/iter; left time: 3330.4469s
	iters: 700, epoch: 10 | loss: 0.0876099
	speed: 0.1142s/iter; left time: 3309.2607s
	iters: 800, epoch: 10 | loss: 0.0699282
	speed: 0.1138s/iter; left time: 3285.3269s
	iters: 900, epoch: 10 | loss: 0.0586489
	speed: 0.1147s/iter; left time: 3300.8723s
	iters: 1000, epoch: 10 | loss: 0.0759529
	speed: 0.1148s/iter; left time: 3290.2202s
	iters: 1100, epoch: 10 | loss: 0.0668376
	speed: 0.1092s/iter; left time: 3119.7124s
	iters: 1200, epoch: 10 | loss: 0.0535884
	speed: 0.1031s/iter; left time: 2934.3964s
	iters: 1300, epoch: 10 | loss: 0.0582658
	speed: 0.1138s/iter; left time: 3227.0837s
	iters: 1400, epoch: 10 | loss: 0.0513382
	speed: 0.1130s/iter; left time: 3193.3981s
	iters: 1500, epoch: 10 | loss: 0.0559071
	speed: 0.1137s/iter; left time: 3202.5214s
	iters: 1600, epoch: 10 | loss: 0.0776514
	speed: 0.1151s/iter; left time: 3229.5595s
	iters: 1700, epoch: 10 | loss: 0.0712357
	speed: 0.1041s/iter; left time: 2912.5204s
	iters: 1800, epoch: 10 | loss: 0.0629981
	speed: 0.1156s/iter; left time: 3220.4616s
	iters: 1900, epoch: 10 | loss: 0.0640645
	speed: 0.1089s/iter; left time: 3024.4091s
	iters: 2000, epoch: 10 | loss: 0.0740883
	speed: 0.1007s/iter; left time: 2785.6687s
	iters: 2100, epoch: 10 | loss: 0.0667572
	speed: 0.1143s/iter; left time: 3150.6125s
	iters: 2200, epoch: 10 | loss: 0.0742129
	speed: 0.1027s/iter; left time: 2820.5033s
	iters: 2300, epoch: 10 | loss: 0.0638777
	speed: 0.1020s/iter; left time: 2791.8738s
	iters: 2400, epoch: 10 | loss: 0.0583167
	speed: 0.1136s/iter; left time: 3098.3799s
	iters: 2500, epoch: 10 | loss: 0.0623477
	speed: 0.1136s/iter; left time: 3085.3174s
	iters: 2600, epoch: 10 | loss: 0.0761587
	speed: 0.1009s/iter; left time: 2731.3328s
Epoch: 10 cost time: 00h:04m:55.09s
Epoch: 10 | Train Loss: 0.0686641 Vali Loss: 0.0578670 Test Loss: 0.0614497
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 11 | loss: 0.0688605
	speed: 0.9634s/iter; left time: 25886.5138s
	iters: 200, epoch: 11 | loss: 0.0643643
	speed: 0.1157s/iter; left time: 3096.3717s
	iters: 300, epoch: 11 | loss: 0.0519321
	speed: 0.1139s/iter; left time: 3038.8410s
	iters: 400, epoch: 11 | loss: 0.0803871
	speed: 0.1149s/iter; left time: 3052.1080s
	iters: 500, epoch: 11 | loss: 0.0732333
	speed: 0.1146s/iter; left time: 3033.9379s
	iters: 600, epoch: 11 | loss: 0.0699096
	speed: 0.1143s/iter; left time: 3015.4589s
	iters: 700, epoch: 11 | loss: 0.0627109
	speed: 0.1135s/iter; left time: 2981.7984s
	iters: 800, epoch: 11 | loss: 0.0755273
	speed: 0.1133s/iter; left time: 2965.6401s
	iters: 900, epoch: 11 | loss: 0.0590502
	speed: 0.1141s/iter; left time: 2974.0376s
	iters: 1000, epoch: 11 | loss: 0.0684834
	speed: 0.0993s/iter; left time: 2578.6103s
	iters: 1100, epoch: 11 | loss: 0.0669859
	speed: 0.1155s/iter; left time: 2988.3733s
	iters: 1200, epoch: 11 | loss: 0.0700008
	speed: 0.1077s/iter; left time: 2775.5692s
	iters: 1300, epoch: 11 | loss: 0.0586604
	speed: 0.1146s/iter; left time: 2941.7344s
	iters: 1400, epoch: 11 | loss: 0.0698778
	speed: 0.1154s/iter; left time: 2951.8426s
	iters: 1500, epoch: 11 | loss: 0.0758755
	speed: 0.1156s/iter; left time: 2944.7544s
	iters: 1600, epoch: 11 | loss: 0.0635368
	speed: 0.1119s/iter; left time: 2837.8673s
	iters: 1700, epoch: 11 | loss: 0.0804984
	speed: 0.1100s/iter; left time: 2778.9005s
	iters: 1800, epoch: 11 | loss: 0.0605070
	speed: 0.1144s/iter; left time: 2878.6505s
	iters: 1900, epoch: 11 | loss: 0.0770305
	speed: 0.1148s/iter; left time: 2877.3141s
	iters: 2000, epoch: 11 | loss: 0.0658592
	speed: 0.1150s/iter; left time: 2870.8323s
	iters: 2100, epoch: 11 | loss: 0.0650982
	speed: 0.1151s/iter; left time: 2863.3911s
	iters: 2200, epoch: 11 | loss: 0.0749165
	speed: 0.1144s/iter; left time: 2832.8202s
	iters: 2300, epoch: 11 | loss: 0.0622882
	speed: 0.1140s/iter; left time: 2812.4483s
	iters: 2400, epoch: 11 | loss: 0.0714804
	speed: 0.1148s/iter; left time: 2820.8064s
	iters: 2500, epoch: 11 | loss: 0.0614139
	speed: 0.1150s/iter; left time: 2814.2477s
	iters: 2600, epoch: 11 | loss: 0.0660085
	speed: 0.1137s/iter; left time: 2769.7957s
Epoch: 11 cost time: 00h:05m:06.71s
Epoch: 11 | Train Loss: 0.0681724 Vali Loss: 0.0571862 Test Loss: 0.0607081
Validation loss decreased (0.057520 --> 0.057186).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 12 | loss: 0.0519414
	speed: 1.0039s/iter; left time: 24267.3512s
	iters: 200, epoch: 12 | loss: 0.0603286
	speed: 0.1136s/iter; left time: 2735.6495s
	iters: 300, epoch: 12 | loss: 0.0825475
	speed: 0.1147s/iter; left time: 2749.4585s
	iters: 400, epoch: 12 | loss: 0.0733654
	speed: 0.1163s/iter; left time: 2775.5488s
	iters: 500, epoch: 12 | loss: 0.0657127
	speed: 0.1162s/iter; left time: 2761.8917s
	iters: 600, epoch: 12 | loss: 0.0646338
	speed: 0.1151s/iter; left time: 2723.8446s
	iters: 700, epoch: 12 | loss: 0.0897408
	speed: 0.1142s/iter; left time: 2690.9921s
	iters: 800, epoch: 12 | loss: 0.0609364
	speed: 0.1145s/iter; left time: 2687.2109s
	iters: 900, epoch: 12 | loss: 0.0622800
	speed: 0.1146s/iter; left time: 2678.0021s
	iters: 1000, epoch: 12 | loss: 0.0894761
	speed: 0.1137s/iter; left time: 2645.4986s
	iters: 1100, epoch: 12 | loss: 0.0589442
	speed: 0.1055s/iter; left time: 2443.9838s
	iters: 1200, epoch: 12 | loss: 0.0551907
	speed: 0.0961s/iter; left time: 2216.2643s
	iters: 1300, epoch: 12 | loss: 0.0603157
	speed: 0.1038s/iter; left time: 2384.6036s
	iters: 1400, epoch: 12 | loss: 0.0810170
	speed: 0.1144s/iter; left time: 2617.3443s
	iters: 1500, epoch: 12 | loss: 0.0754087
	speed: 0.1142s/iter; left time: 2600.1290s
	iters: 1600, epoch: 12 | loss: 0.0668139
	speed: 0.1132s/iter; left time: 2567.3034s
	iters: 1700, epoch: 12 | loss: 0.0780367
	speed: 0.1115s/iter; left time: 2515.9899s
	iters: 1800, epoch: 12 | loss: 0.0738580
	speed: 0.1070s/iter; left time: 2405.6110s
	iters: 1900, epoch: 12 | loss: 0.0685480
	speed: 0.1146s/iter; left time: 2564.0579s
	iters: 2000, epoch: 12 | loss: 0.0631595
	speed: 0.1140s/iter; left time: 2539.9188s
	iters: 2100, epoch: 12 | loss: 0.0612001
	speed: 0.1143s/iter; left time: 2535.3791s
	iters: 2200, epoch: 12 | loss: 0.0731911
	speed: 0.1143s/iter; left time: 2523.8004s
	iters: 2300, epoch: 12 | loss: 0.0563691
	speed: 0.1154s/iter; left time: 2536.1860s
	iters: 2400, epoch: 12 | loss: 0.0569280
	speed: 0.1144s/iter; left time: 2503.0689s
	iters: 2500, epoch: 12 | loss: 0.0736074
	speed: 0.0999s/iter; left time: 2174.2873s
	iters: 2600, epoch: 12 | loss: 0.0686894
	speed: 0.1084s/iter; left time: 2348.5141s
Epoch: 12 cost time: 00h:05m:02.47s
Epoch: 12 | Train Loss: 0.0676054 Vali Loss: 0.0583766 Test Loss: 0.0617521
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 13 | loss: 0.0610672
	speed: 0.9819s/iter; left time: 21088.5091s
	iters: 200, epoch: 13 | loss: 0.0567970
	speed: 0.1160s/iter; left time: 2479.0005s
	iters: 300, epoch: 13 | loss: 0.0503390
	speed: 0.1150s/iter; left time: 2447.6480s
	iters: 400, epoch: 13 | loss: 0.0588858
	speed: 0.1144s/iter; left time: 2422.5092s
	iters: 500, epoch: 13 | loss: 0.0866880
	speed: 0.1142s/iter; left time: 2407.5235s
	iters: 600, epoch: 13 | loss: 0.0590931
	speed: 0.1146s/iter; left time: 2403.5746s
	iters: 700, epoch: 13 | loss: 0.0699925
	speed: 0.1131s/iter; left time: 2362.1300s
	iters: 800, epoch: 13 | loss: 0.0752468
	speed: 0.1143s/iter; left time: 2373.9407s
	iters: 900, epoch: 13 | loss: 0.0647457
	speed: 0.1146s/iter; left time: 2369.8364s
	iters: 1000, epoch: 13 | loss: 0.0609347
	speed: 0.1144s/iter; left time: 2354.7522s
	iters: 1100, epoch: 13 | loss: 0.0517241
	speed: 0.1137s/iter; left time: 2328.9166s
	iters: 1200, epoch: 13 | loss: 0.0599805
	speed: 0.1142s/iter; left time: 2327.9382s
	iters: 1300, epoch: 13 | loss: 0.0654597
	speed: 0.1142s/iter; left time: 2314.9592s
	iters: 1400, epoch: 13 | loss: 0.0604756
	speed: 0.1142s/iter; left time: 2303.4778s
	iters: 1500, epoch: 13 | loss: 0.0713967
	speed: 0.1155s/iter; left time: 2319.1291s
	iters: 1600, epoch: 13 | loss: 0.0787557
	speed: 0.1158s/iter; left time: 2313.8345s
	iters: 1700, epoch: 13 | loss: 0.0548762
	speed: 0.1150s/iter; left time: 2285.9566s
	iters: 1800, epoch: 13 | loss: 0.0690363
	speed: 0.1153s/iter; left time: 2279.3040s
	iters: 1900, epoch: 13 | loss: 0.0558236
	speed: 0.1152s/iter; left time: 2265.9576s
	iters: 2000, epoch: 13 | loss: 0.0533169
	speed: 0.1135s/iter; left time: 2221.9672s
	iters: 2100, epoch: 13 | loss: 0.0763264
	speed: 0.1144s/iter; left time: 2228.5516s
	iters: 2200, epoch: 13 | loss: 0.0767449
	speed: 0.1153s/iter; left time: 2234.6715s
	iters: 2300, epoch: 13 | loss: 0.0773105
	speed: 0.1139s/iter; left time: 2195.0481s
	iters: 2400, epoch: 13 | loss: 0.0802446
	speed: 0.1137s/iter; left time: 2180.0878s
	iters: 2500, epoch: 13 | loss: 0.0897281
	speed: 0.1136s/iter; left time: 2166.2115s
	iters: 2600, epoch: 13 | loss: 0.0587957
	speed: 0.1148s/iter; left time: 2178.5897s
Epoch: 13 cost time: 00h:05m:09.56s
Epoch: 13 | Train Loss: 0.0671900 Vali Loss: 0.0578623 Test Loss: 0.0615834
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 14 | loss: 0.0538025
	speed: 0.9785s/iter; left time: 18377.0368s
	iters: 200, epoch: 14 | loss: 0.0614343
	speed: 0.1136s/iter; left time: 2121.2640s
	iters: 300, epoch: 14 | loss: 0.0657694
	speed: 0.1144s/iter; left time: 2126.3909s
	iters: 400, epoch: 14 | loss: 0.0752635
	speed: 0.1155s/iter; left time: 2134.0448s
	iters: 500, epoch: 14 | loss: 0.0564194
	speed: 0.1159s/iter; left time: 2129.7759s
	iters: 600, epoch: 14 | loss: 0.0707608
	speed: 0.1155s/iter; left time: 2110.6360s
	iters: 700, epoch: 14 | loss: 0.0544968
	speed: 0.1148s/iter; left time: 2086.5129s
	iters: 800, epoch: 14 | loss: 0.0735052
	speed: 0.1150s/iter; left time: 2079.5721s
	iters: 900, epoch: 14 | loss: 0.0844271
	speed: 0.1140s/iter; left time: 2050.4539s
	iters: 1000, epoch: 14 | loss: 0.0708888
	speed: 0.1129s/iter; left time: 2019.2231s
	iters: 1100, epoch: 14 | loss: 0.0629603
	speed: 0.1145s/iter; left time: 2035.5142s
	iters: 1200, epoch: 14 | loss: 0.0756200
	speed: 0.1146s/iter; left time: 2026.9095s
	iters: 1300, epoch: 14 | loss: 0.0599315
	speed: 0.1149s/iter; left time: 2019.8470s
	iters: 1400, epoch: 14 | loss: 0.0612757
	speed: 0.1146s/iter; left time: 2003.0199s
	iters: 1500, epoch: 14 | loss: 0.0702794
	speed: 0.1139s/iter; left time: 1979.1056s
	iters: 1600, epoch: 14 | loss: 0.0578222
	speed: 0.1139s/iter; left time: 1968.7100s
	iters: 1700, epoch: 14 | loss: 0.0617748
	speed: 0.1166s/iter; left time: 2002.9887s
	iters: 1800, epoch: 14 | loss: 0.0585543
	speed: 0.1154s/iter; left time: 1971.6422s
	iters: 1900, epoch: 14 | loss: 0.0675614
	speed: 0.1146s/iter; left time: 1946.0450s
	iters: 2000, epoch: 14 | loss: 0.0662966
	speed: 0.1155s/iter; left time: 1949.4416s
	iters: 2100, epoch: 14 | loss: 0.0603743
	speed: 0.1146s/iter; left time: 1923.5369s
	iters: 2200, epoch: 14 | loss: 0.0601280
	speed: 0.1140s/iter; left time: 1902.0830s
	iters: 2300, epoch: 14 | loss: 0.0591565
	speed: 0.1167s/iter; left time: 1935.6409s
	iters: 2400, epoch: 14 | loss: 0.0908771
	speed: 0.1146s/iter; left time: 1888.3587s
	iters: 2500, epoch: 14 | loss: 0.0688252
	speed: 0.1142s/iter; left time: 1871.1532s
	iters: 2600, epoch: 14 | loss: 0.0583719
	speed: 0.1147s/iter; left time: 1867.9632s
Epoch: 14 cost time: 00h:05m:10.11s
Epoch: 14 | Train Loss: 0.0668031 Vali Loss: 0.0573795 Test Loss: 0.0608568
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 15 | loss: 0.0688373
	speed: 0.9843s/iter; left time: 15830.7326s
	iters: 200, epoch: 15 | loss: 0.0569479
	speed: 0.0966s/iter; left time: 1544.1532s
	iters: 300, epoch: 15 | loss: 0.0754607
	speed: 0.1126s/iter; left time: 1787.9768s
	iters: 400, epoch: 15 | loss: 0.0596411
	speed: 0.1138s/iter; left time: 1795.5628s
	iters: 500, epoch: 15 | loss: 0.0809594
	speed: 0.1149s/iter; left time: 1801.2614s
	iters: 600, epoch: 15 | loss: 0.0602640
	speed: 0.1147s/iter; left time: 1787.3242s
	iters: 700, epoch: 15 | loss: 0.0620752
	speed: 0.1161s/iter; left time: 1796.8484s
	iters: 800, epoch: 15 | loss: 0.0750819
	speed: 0.1136s/iter; left time: 1747.5055s
	iters: 900, epoch: 15 | loss: 0.0663498
	speed: 0.1142s/iter; left time: 1745.0218s
	iters: 1000, epoch: 15 | loss: 0.0724144
	speed: 0.1118s/iter; left time: 1696.9032s
	iters: 1100, epoch: 15 | loss: 0.0621678
	speed: 0.1136s/iter; left time: 1714.0208s
	iters: 1200, epoch: 15 | loss: 0.0722131
	speed: 0.1131s/iter; left time: 1694.7276s
	iters: 1300, epoch: 15 | loss: 0.0759164
	speed: 0.1176s/iter; left time: 1749.5838s
	iters: 1400, epoch: 15 | loss: 0.0824906
	speed: 0.1154s/iter; left time: 1706.6226s
	iters: 1500, epoch: 15 | loss: 0.0806423
	speed: 0.1166s/iter; left time: 1712.4875s
	iters: 1600, epoch: 15 | loss: 0.0617313
	speed: 0.1157s/iter; left time: 1686.5711s
	iters: 1700, epoch: 15 | loss: 0.0703903
	speed: 0.1147s/iter; left time: 1661.7245s
	iters: 1800, epoch: 15 | loss: 0.0691926
	speed: 0.1157s/iter; left time: 1664.3588s
	iters: 1900, epoch: 15 | loss: 0.0609231
	speed: 0.1138s/iter; left time: 1625.7338s
	iters: 2000, epoch: 15 | loss: 0.0674969
	speed: 0.1137s/iter; left time: 1612.7425s
	iters: 2100, epoch: 15 | loss: 0.0743056
	speed: 0.1155s/iter; left time: 1626.9866s
	iters: 2200, epoch: 15 | loss: 0.0678914
	speed: 0.1144s/iter; left time: 1599.4736s
	iters: 2300, epoch: 15 | loss: 0.0633814
	speed: 0.1143s/iter; left time: 1587.3052s
	iters: 2400, epoch: 15 | loss: 0.0677302
	speed: 0.1159s/iter; left time: 1597.2985s
	iters: 2500, epoch: 15 | loss: 0.0633345
	speed: 0.1145s/iter; left time: 1567.1010s
	iters: 2600, epoch: 15 | loss: 0.0611144
	speed: 0.1171s/iter; left time: 1590.4667s
Epoch: 15 cost time: 00h:05m:08.48s
Epoch: 15 | Train Loss: 0.0663890 Vali Loss: 0.0575977 Test Loss: 0.0608814
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 16 | loss: 0.0731103
	speed: 0.9861s/iter; left time: 13200.5695s
	iters: 200, epoch: 16 | loss: 0.0706104
	speed: 0.1138s/iter; left time: 1512.1604s
	iters: 300, epoch: 16 | loss: 0.0581224
	speed: 0.1156s/iter; left time: 1523.6973s
	iters: 400, epoch: 16 | loss: 0.0628917
	speed: 0.1159s/iter; left time: 1517.1239s
	iters: 500, epoch: 16 | loss: 0.0536247
	speed: 0.1051s/iter; left time: 1364.6688s
	iters: 600, epoch: 16 | loss: 0.0669830
	speed: 0.0966s/iter; left time: 1245.1209s
	iters: 700, epoch: 16 | loss: 0.0593961
	speed: 0.0966s/iter; left time: 1235.0858s
	iters: 800, epoch: 16 | loss: 0.0518044
	speed: 0.0966s/iter; left time: 1225.9406s
	iters: 900, epoch: 16 | loss: 0.0667260
	speed: 0.0963s/iter; left time: 1212.3648s
	iters: 1000, epoch: 16 | loss: 0.0675460
	speed: 0.1111s/iter; left time: 1387.4215s
	iters: 1100, epoch: 16 | loss: 0.0571950
	speed: 0.1155s/iter; left time: 1430.7804s
	iters: 1200, epoch: 16 | loss: 0.0801374
	speed: 0.1140s/iter; left time: 1400.3314s
	iters: 1300, epoch: 16 | loss: 0.0643721
	speed: 0.1145s/iter; left time: 1395.2823s
	iters: 1400, epoch: 16 | loss: 0.0662640
	speed: 0.1159s/iter; left time: 1400.8208s
	iters: 1500, epoch: 16 | loss: 0.0630720
	speed: 0.1149s/iter; left time: 1377.4275s
	iters: 1600, epoch: 16 | loss: 0.0607125
	speed: 0.1125s/iter; left time: 1337.7461s
	iters: 1700, epoch: 16 | loss: 0.0707747
	speed: 0.1155s/iter; left time: 1361.0946s
	iters: 1800, epoch: 16 | loss: 0.0875769
	speed: 0.1150s/iter; left time: 1343.7932s
	iters: 1900, epoch: 16 | loss: 0.0685269
	speed: 0.1181s/iter; left time: 1368.3147s
	iters: 2000, epoch: 16 | loss: 0.0532361
	speed: 0.1156s/iter; left time: 1327.9820s
	iters: 2100, epoch: 16 | loss: 0.0648946
	speed: 0.1152s/iter; left time: 1311.1761s
	iters: 2200, epoch: 16 | loss: 0.0554299
	speed: 0.1138s/iter; left time: 1284.7339s
	iters: 2300, epoch: 16 | loss: 0.0634180
	speed: 0.1142s/iter; left time: 1276.9366s
	iters: 2400, epoch: 16 | loss: 0.0690501
	speed: 0.1145s/iter; left time: 1269.7447s
	iters: 2500, epoch: 16 | loss: 0.0580355
	speed: 0.1141s/iter; left time: 1253.0987s
	iters: 2600, epoch: 16 | loss: 0.0707478
	speed: 0.1141s/iter; left time: 1241.5975s
Epoch: 16 cost time: 00h:05m:01.80s
Epoch: 16 | Train Loss: 0.0658955 Vali Loss: 0.0577615 Test Loss: 0.0611815
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.010438021272420883, rmse:0.10216663777828217, mae:0.060708094388246536, rse:0.3860151767730713
success delete checkpoints
Intermediate time for IT and pred_len 24: 01h:44m:02.92s

=== Starting experiments for pred_len: 96 ===

--- Running model for IT, pred_len=96 ---
train 86115
val 18435
test 18435
[2024-11-02 22:45:29,624] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-02 22:45:30,848] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-02 22:45:30,848] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-02 22:45:30,849] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-02 22:45:30,950] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-02 22:45:30,950] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-02 22:45:31,618] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-02 22:45:31,619] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-02 22:45:31,619] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-02 22:45:31,621] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-02 22:45:31,621] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-02 22:45:31,621] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-02 22:45:31,621] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-02 22:45:31,621] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-02 22:45:31,621] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-02 22:45:31,622] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-02 22:45:31,951] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-02 22:45:31,952] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-02 22:45:31,952] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 76.14 GB, percent = 10.1%
[2024-11-02 22:45:32,068] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-02 22:45:32,069] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-02 22:45:32,069] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 76.14 GB, percent = 10.1%
[2024-11-02 22:45:32,069] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-02 22:45:32,182] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-02 22:45:32,183] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.85 GB         Max_CA 1 GB 
[2024-11-02 22:45:32,183] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 76.14 GB, percent = 10.1%
[2024-11-02 22:45:32,184] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-02 22:45:32,184] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-02 22:45:32,184] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-02 22:45:32,184] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-02 22:45:32,185] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-02 22:45:32,185] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-02 22:45:32,185] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fa370d9f1d0>
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-02 22:45:32,186] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-02 22:45:32,187] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-02 22:45:32,188] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-02 22:45:32,188] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-02 22:45:32,188] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-02 22:45:32,188] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-02 22:45:32,188] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-02 22:45:32,188] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-02 22:45:32,188] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-02 22:45:32,188] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.1934633
	speed: 0.1713s/iter; left time: 9200.5937s
	iters: 200, epoch: 1 | loss: 0.1763859
	speed: 0.1289s/iter; left time: 6911.9084s
	iters: 300, epoch: 1 | loss: 0.1493364
	speed: 0.1278s/iter; left time: 6839.0948s
	iters: 400, epoch: 1 | loss: 0.1262816
	speed: 0.1280s/iter; left time: 6839.0464s
	iters: 500, epoch: 1 | loss: 0.1171123
	speed: 0.1287s/iter; left time: 6863.6276s
	iters: 600, epoch: 1 | loss: 0.1207857
	speed: 0.1256s/iter; left time: 6686.9004s
	iters: 700, epoch: 1 | loss: 0.1195831
	speed: 0.1267s/iter; left time: 6732.0809s
	iters: 800, epoch: 1 | loss: 0.1091291
	speed: 0.1166s/iter; left time: 6181.7215s
	iters: 900, epoch: 1 | loss: 0.1172049
	speed: 0.1168s/iter; left time: 6182.9086s
	iters: 1000, epoch: 1 | loss: 0.0856876
	speed: 0.1073s/iter; left time: 5668.7135s
	iters: 1100, epoch: 1 | loss: 0.1010989
	speed: 0.1078s/iter; left time: 5682.7896s
	iters: 1200, epoch: 1 | loss: 0.1015837
	speed: 0.1073s/iter; left time: 5645.8179s
	iters: 1300, epoch: 1 | loss: 0.1383912
	speed: 0.1071s/iter; left time: 5625.1548s
	iters: 1400, epoch: 1 | loss: 0.1047541
	speed: 0.1073s/iter; left time: 5626.4303s
	iters: 1500, epoch: 1 | loss: 0.1040020
	speed: 0.1260s/iter; left time: 6590.7064s
	iters: 1600, epoch: 1 | loss: 0.0965157
	speed: 0.1259s/iter; left time: 6576.2054s
	iters: 1700, epoch: 1 | loss: 0.1022582
	speed: 0.1265s/iter; left time: 6592.7620s
	iters: 1800, epoch: 1 | loss: 0.1087027
	speed: 0.1243s/iter; left time: 6467.8052s
	iters: 1900, epoch: 1 | loss: 0.1015980
	speed: 0.1261s/iter; left time: 6546.8714s
	iters: 2000, epoch: 1 | loss: 0.0960999
	speed: 0.1262s/iter; left time: 6537.8271s
	iters: 2100, epoch: 1 | loss: 0.0915355
	speed: 0.1257s/iter; left time: 6502.1847s
	iters: 2200, epoch: 1 | loss: 0.1123403
	speed: 0.1250s/iter; left time: 6453.1353s
	iters: 2300, epoch: 1 | loss: 0.1265393
	speed: 0.1274s/iter; left time: 6563.0584s
	iters: 2400, epoch: 1 | loss: 0.0845973
	speed: 0.1267s/iter; left time: 6514.9429s
	iters: 2500, epoch: 1 | loss: 0.0974592
	speed: 0.1262s/iter; left time: 6478.6545s
	iters: 2600, epoch: 1 | loss: 0.1181518
	speed: 0.1261s/iter; left time: 6457.0195s
Epoch: 1 cost time: 00h:05m:30.32s
Epoch: 1 | Train Loss: 0.1179917 Vali Loss: 0.0848198 Test Loss: 0.0898159
Validation loss decreased (inf --> 0.084820).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.1002837
	speed: 1.0899s/iter; left time: 55615.3095s
	iters: 200, epoch: 2 | loss: 0.0906165
	speed: 0.0962s/iter; left time: 4900.1911s
	iters: 300, epoch: 2 | loss: 0.0938583
	speed: 0.1143s/iter; left time: 5811.7729s
	iters: 400, epoch: 2 | loss: 0.0962128
	speed: 0.1157s/iter; left time: 5871.3165s
	iters: 500, epoch: 2 | loss: 0.0942962
	speed: 0.1150s/iter; left time: 5821.1903s
	iters: 600, epoch: 2 | loss: 0.1065316
	speed: 0.1148s/iter; left time: 5802.8616s
	iters: 700, epoch: 2 | loss: 0.0971361
	speed: 0.1161s/iter; left time: 5856.9167s
	iters: 800, epoch: 2 | loss: 0.1060096
	speed: 0.1163s/iter; left time: 5852.4864s
	iters: 900, epoch: 2 | loss: 0.1037547
	speed: 0.1165s/iter; left time: 5853.7284s
	iters: 1000, epoch: 2 | loss: 0.1060831
	speed: 0.1159s/iter; left time: 5812.3636s
	iters: 1100, epoch: 2 | loss: 0.1103433
	speed: 0.1150s/iter; left time: 5753.1402s
	iters: 1200, epoch: 2 | loss: 0.1000298
	speed: 0.1163s/iter; left time: 5809.2005s
	iters: 1300, epoch: 2 | loss: 0.1118626
	speed: 0.1156s/iter; left time: 5758.9532s
	iters: 1400, epoch: 2 | loss: 0.0781817
	speed: 0.1153s/iter; left time: 5734.5130s
	iters: 1500, epoch: 2 | loss: 0.0979162
	speed: 0.1160s/iter; left time: 5758.2457s
	iters: 1600, epoch: 2 | loss: 0.0903831
	speed: 0.1141s/iter; left time: 5649.7216s
	iters: 1700, epoch: 2 | loss: 0.0924969
	speed: 0.1141s/iter; left time: 5639.3169s
	iters: 1800, epoch: 2 | loss: 0.1178317
	speed: 0.1146s/iter; left time: 5653.3441s
	iters: 1900, epoch: 2 | loss: 0.0728766
	speed: 0.1094s/iter; left time: 5385.8710s
	iters: 2000, epoch: 2 | loss: 0.0894050
	speed: 0.1046s/iter; left time: 5139.9066s
	iters: 2100, epoch: 2 | loss: 0.1005967
	speed: 0.1115s/iter; left time: 5467.9781s
	iters: 2200, epoch: 2 | loss: 0.0853283
	speed: 0.1141s/iter; left time: 5581.4293s
	iters: 2300, epoch: 2 | loss: 0.0847278
	speed: 0.1139s/iter; left time: 5559.7386s
	iters: 2400, epoch: 2 | loss: 0.1019449
	speed: 0.1153s/iter; left time: 5620.5961s
	iters: 2500, epoch: 2 | loss: 0.0932351
	speed: 0.1152s/iter; left time: 5600.7076s
	iters: 2600, epoch: 2 | loss: 0.0873921
	speed: 0.1167s/iter; left time: 5663.7633s
Epoch: 2 cost time: 00h:05m:04.86s
Epoch: 2 | Train Loss: 0.0962975 Vali Loss: 0.0798545 Test Loss: 0.0858662
Validation loss decreased (0.084820 --> 0.079855).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.0884367
	speed: 0.9828s/iter; left time: 47505.5496s
	iters: 200, epoch: 3 | loss: 0.1001280
	speed: 0.1150s/iter; left time: 5549.5756s
	iters: 300, epoch: 3 | loss: 0.1046731
	speed: 0.1074s/iter; left time: 5171.4595s
	iters: 400, epoch: 3 | loss: 0.0806120
	speed: 0.0970s/iter; left time: 4660.2030s
	iters: 500, epoch: 3 | loss: 0.0833375
	speed: 0.0965s/iter; left time: 4624.8956s
	iters: 600, epoch: 3 | loss: 0.0915050
	speed: 0.1107s/iter; left time: 5293.4542s
	iters: 700, epoch: 3 | loss: 0.0814567
	speed: 0.1144s/iter; left time: 5462.7055s
	iters: 800, epoch: 3 | loss: 0.0916979
	speed: 0.1150s/iter; left time: 5477.3659s
	iters: 900, epoch: 3 | loss: 0.1094405
	speed: 0.1170s/iter; left time: 5561.3051s
	iters: 1000, epoch: 3 | loss: 0.1011684
	speed: 0.1181s/iter; left time: 5603.5740s
	iters: 1100, epoch: 3 | loss: 0.0865153
	speed: 0.1163s/iter; left time: 5503.3759s
	iters: 1200, epoch: 3 | loss: 0.0769959
	speed: 0.1185s/iter; left time: 5596.0877s
	iters: 1300, epoch: 3 | loss: 0.0918234
	speed: 0.1152s/iter; left time: 5429.9668s
	iters: 1400, epoch: 3 | loss: 0.0899273
	speed: 0.1158s/iter; left time: 5447.0141s
	iters: 1500, epoch: 3 | loss: 0.1062002
	speed: 0.1168s/iter; left time: 5483.4192s
	iters: 1600, epoch: 3 | loss: 0.0708728
	speed: 0.1159s/iter; left time: 5429.9981s
	iters: 1700, epoch: 3 | loss: 0.1091485
	speed: 0.1166s/iter; left time: 5451.7992s
	iters: 1800, epoch: 3 | loss: 0.1023156
	speed: 0.1149s/iter; left time: 5359.9744s
	iters: 1900, epoch: 3 | loss: 0.0731412
	speed: 0.1085s/iter; left time: 5050.1919s
	iters: 2000, epoch: 3 | loss: 0.1124088
	speed: 0.1142s/iter; left time: 5303.9769s
	iters: 2100, epoch: 3 | loss: 0.1252687
	speed: 0.1169s/iter; left time: 5416.1146s
	iters: 2200, epoch: 3 | loss: 0.0836434
	speed: 0.1153s/iter; left time: 5333.4217s
	iters: 2300, epoch: 3 | loss: 0.1059322
	speed: 0.1165s/iter; left time: 5373.8691s
	iters: 2400, epoch: 3 | loss: 0.0889617
	speed: 0.1159s/iter; left time: 5335.2100s
	iters: 2500, epoch: 3 | loss: 0.0884438
	speed: 0.1146s/iter; left time: 5262.9297s
	iters: 2600, epoch: 3 | loss: 0.0789040
	speed: 0.1152s/iter; left time: 5278.6567s
Epoch: 3 cost time: 00h:05m:06.51s
Epoch: 3 | Train Loss: 0.0925695 Vali Loss: 0.0794393 Test Loss: 0.0851859
Validation loss decreased (0.079855 --> 0.079439).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0944193
	speed: 0.9894s/iter; left time: 45165.9990s
	iters: 200, epoch: 4 | loss: 0.1009860
	speed: 0.1164s/iter; left time: 5300.7634s
	iters: 300, epoch: 4 | loss: 0.1014991
	speed: 0.1175s/iter; left time: 5338.4891s
	iters: 400, epoch: 4 | loss: 0.0945554
	speed: 0.1069s/iter; left time: 4848.2545s
	iters: 500, epoch: 4 | loss: 0.0920349
	speed: 0.1099s/iter; left time: 4973.2031s
	iters: 600, epoch: 4 | loss: 0.0887014
	speed: 0.1151s/iter; left time: 5194.5193s
	iters: 700, epoch: 4 | loss: 0.0846027
	speed: 0.1151s/iter; left time: 5183.7344s
	iters: 800, epoch: 4 | loss: 0.0905010
	speed: 0.1151s/iter; left time: 5174.5785s
	iters: 900, epoch: 4 | loss: 0.0935379
	speed: 0.1148s/iter; left time: 5148.6376s
	iters: 1000, epoch: 4 | loss: 0.0826019
	speed: 0.1158s/iter; left time: 5181.6581s
	iters: 1100, epoch: 4 | loss: 0.1028748
	speed: 0.1149s/iter; left time: 5131.9953s
	iters: 1200, epoch: 4 | loss: 0.1137985
	speed: 0.1143s/iter; left time: 5090.8303s
	iters: 1300, epoch: 4 | loss: 0.0763816
	speed: 0.1143s/iter; left time: 5078.2930s
	iters: 1400, epoch: 4 | loss: 0.0880500
	speed: 0.1147s/iter; left time: 5085.6903s
	iters: 1500, epoch: 4 | loss: 0.0818828
	speed: 0.1151s/iter; left time: 5093.7656s
	iters: 1600, epoch: 4 | loss: 0.0753789
	speed: 0.1153s/iter; left time: 5089.6542s
	iters: 1700, epoch: 4 | loss: 0.0667379
	speed: 0.1164s/iter; left time: 5126.1695s
	iters: 1800, epoch: 4 | loss: 0.0773144
	speed: 0.1149s/iter; left time: 5048.0574s
	iters: 1900, epoch: 4 | loss: 0.0894531
	speed: 0.1153s/iter; left time: 5057.1730s
	iters: 2000, epoch: 4 | loss: 0.0876464
	speed: 0.1143s/iter; left time: 5000.3282s
	iters: 2100, epoch: 4 | loss: 0.0817939
	speed: 0.1148s/iter; left time: 5010.6727s
	iters: 2200, epoch: 4 | loss: 0.0817806
	speed: 0.1145s/iter; left time: 4988.0128s
	iters: 2300, epoch: 4 | loss: 0.1111523
	speed: 0.1145s/iter; left time: 4974.3493s
	iters: 2400, epoch: 4 | loss: 0.1141342
	speed: 0.1150s/iter; left time: 4986.0679s
	iters: 2500, epoch: 4 | loss: 0.1129447
	speed: 0.1145s/iter; left time: 4952.6372s
	iters: 2600, epoch: 4 | loss: 0.0830951
	speed: 0.1113s/iter; left time: 4803.8555s
Epoch: 4 cost time: 00h:05m:08.73s
Epoch: 4 | Train Loss: 0.0904820 Vali Loss: 0.0780338 Test Loss: 0.0831292
Validation loss decreased (0.079439 --> 0.078034).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0972390
	speed: 0.9804s/iter; left time: 42113.7149s
	iters: 200, epoch: 5 | loss: 0.0866233
	speed: 0.1155s/iter; left time: 4948.1146s
	iters: 300, epoch: 5 | loss: 0.0958727
	speed: 0.1177s/iter; left time: 5032.4006s
	iters: 400, epoch: 5 | loss: 0.0693469
	speed: 0.1165s/iter; left time: 4968.6235s
	iters: 500, epoch: 5 | loss: 0.0849624
	speed: 0.1164s/iter; left time: 4953.0272s
	iters: 600, epoch: 5 | loss: 0.1001985
	speed: 0.1186s/iter; left time: 5034.6916s
	iters: 700, epoch: 5 | loss: 0.1063398
	speed: 0.1176s/iter; left time: 4980.0291s
	iters: 800, epoch: 5 | loss: 0.0999221
	speed: 0.1158s/iter; left time: 4892.5268s
	iters: 900, epoch: 5 | loss: 0.0816023
	speed: 0.1173s/iter; left time: 4944.0625s
	iters: 1000, epoch: 5 | loss: 0.0799536
	speed: 0.1156s/iter; left time: 4863.7731s
	iters: 1100, epoch: 5 | loss: 0.0782519
	speed: 0.1180s/iter; left time: 4951.3473s
	iters: 1200, epoch: 5 | loss: 0.0764363
	speed: 0.1154s/iter; left time: 4829.2510s
	iters: 1300, epoch: 5 | loss: 0.0967658
	speed: 0.1170s/iter; left time: 4886.6172s
	iters: 1400, epoch: 5 | loss: 0.0868528
	speed: 0.1162s/iter; left time: 4838.9733s
	iters: 1500, epoch: 5 | loss: 0.0770575
	speed: 0.1179s/iter; left time: 4900.6489s
	iters: 1600, epoch: 5 | loss: 0.0936656
	speed: 0.1191s/iter; left time: 4938.2399s
	iters: 1700, epoch: 5 | loss: 0.0781666
	speed: 0.1202s/iter; left time: 4973.1603s
	iters: 1800, epoch: 5 | loss: 0.0932333
	speed: 0.1178s/iter; left time: 4860.0693s
	iters: 1900, epoch: 5 | loss: 0.1001875
	speed: 0.1168s/iter; left time: 4809.1613s
	iters: 2000, epoch: 5 | loss: 0.1147297
	speed: 0.1168s/iter; left time: 4796.2472s
	iters: 2100, epoch: 5 | loss: 0.0869296
	speed: 0.1206s/iter; left time: 4938.1741s
	iters: 2200, epoch: 5 | loss: 0.0745400
	speed: 0.1186s/iter; left time: 4844.6170s
	iters: 2300, epoch: 5 | loss: 0.0715365
	speed: 0.1161s/iter; left time: 4731.8313s
	iters: 2400, epoch: 5 | loss: 0.0643543
	speed: 0.1185s/iter; left time: 4816.8680s
	iters: 2500, epoch: 5 | loss: 0.0852049
	speed: 0.1155s/iter; left time: 4685.3851s
	iters: 2600, epoch: 5 | loss: 0.0833014
	speed: 0.1183s/iter; left time: 4787.8768s
Epoch: 5 cost time: 00h:05m:15.74s
Epoch: 5 | Train Loss: 0.0887613 Vali Loss: 0.0775704 Test Loss: 0.0839218
Validation loss decreased (0.078034 --> 0.077570).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.0947636
	speed: 0.9904s/iter; left time: 39880.4076s
	iters: 200, epoch: 6 | loss: 0.0871146
	speed: 0.1148s/iter; left time: 4609.5723s
	iters: 300, epoch: 6 | loss: 0.1186312
	speed: 0.1145s/iter; left time: 4588.0703s
	iters: 400, epoch: 6 | loss: 0.1023487
	speed: 0.1146s/iter; left time: 4581.3191s
	iters: 500, epoch: 6 | loss: 0.0941400
	speed: 0.1160s/iter; left time: 4623.0951s
	iters: 600, epoch: 6 | loss: 0.0893563
	speed: 0.1142s/iter; left time: 4541.1525s
	iters: 700, epoch: 6 | loss: 0.0804608
	speed: 0.1157s/iter; left time: 4587.4114s
	iters: 800, epoch: 6 | loss: 0.0967790
	speed: 0.1140s/iter; left time: 4510.0502s
	iters: 900, epoch: 6 | loss: 0.0773378
	speed: 0.1147s/iter; left time: 4527.2170s
	iters: 1000, epoch: 6 | loss: 0.0813385
	speed: 0.1153s/iter; left time: 4538.8424s
	iters: 1100, epoch: 6 | loss: 0.0976809
	speed: 0.1153s/iter; left time: 4528.6515s
	iters: 1200, epoch: 6 | loss: 0.0809603
	speed: 0.1159s/iter; left time: 4538.5710s
	iters: 1300, epoch: 6 | loss: 0.0903448
	speed: 0.1150s/iter; left time: 4493.0150s
	iters: 1400, epoch: 6 | loss: 0.0978441
	speed: 0.1152s/iter; left time: 4489.8987s
	iters: 1500, epoch: 6 | loss: 0.0846561
	speed: 0.1174s/iter; left time: 4563.0950s
	iters: 1600, epoch: 6 | loss: 0.1038152
	speed: 0.1135s/iter; left time: 4400.6125s
	iters: 1700, epoch: 6 | loss: 0.0767741
	speed: 0.1166s/iter; left time: 4508.1000s
	iters: 1800, epoch: 6 | loss: 0.0908609
	speed: 0.1169s/iter; left time: 4510.1077s
	iters: 1900, epoch: 6 | loss: 0.0820962
	speed: 0.1176s/iter; left time: 4522.2339s
	iters: 2000, epoch: 6 | loss: 0.0735893
	speed: 0.1173s/iter; left time: 4500.7639s
	iters: 2100, epoch: 6 | loss: 0.0998428
	speed: 0.1150s/iter; left time: 4399.5530s
	iters: 2200, epoch: 6 | loss: 0.0660093
	speed: 0.1152s/iter; left time: 4398.4991s
	iters: 2300, epoch: 6 | loss: 0.0850836
	speed: 0.1113s/iter; left time: 4234.8741s
	iters: 2400, epoch: 6 | loss: 0.0883901
	speed: 0.1006s/iter; left time: 3820.2006s
	iters: 2500, epoch: 6 | loss: 0.0745388
	speed: 0.1022s/iter; left time: 3868.0306s
	iters: 2600, epoch: 6 | loss: 0.0925138
	speed: 0.1153s/iter; left time: 4355.8140s
Epoch: 6 cost time: 00h:05m:08.02s
Epoch: 6 | Train Loss: 0.0873064 Vali Loss: 0.0791609 Test Loss: 0.0851259
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0738214
	speed: 0.9711s/iter; left time: 36489.8400s
	iters: 200, epoch: 7 | loss: 0.0840051
	speed: 0.1161s/iter; left time: 4352.2370s
	iters: 300, epoch: 7 | loss: 0.0792297
	speed: 0.1152s/iter; left time: 4305.8477s
	iters: 400, epoch: 7 | loss: 0.1042238
	speed: 0.1162s/iter; left time: 4333.1863s
	iters: 500, epoch: 7 | loss: 0.0820721
	speed: 0.1171s/iter; left time: 4352.7926s
	iters: 600, epoch: 7 | loss: 0.0845355
	speed: 0.1178s/iter; left time: 4366.5657s
	iters: 700, epoch: 7 | loss: 0.0905107
	speed: 0.1159s/iter; left time: 4285.8246s
	iters: 800, epoch: 7 | loss: 0.0772271
	speed: 0.1149s/iter; left time: 4236.7052s
	iters: 900, epoch: 7 | loss: 0.0770174
	speed: 0.1168s/iter; left time: 4294.1460s
	iters: 1000, epoch: 7 | loss: 0.0694755
	speed: 0.1169s/iter; left time: 4287.4194s
	iters: 1100, epoch: 7 | loss: 0.1038114
	speed: 0.1172s/iter; left time: 4287.6980s
	iters: 1200, epoch: 7 | loss: 0.0788102
	speed: 0.1171s/iter; left time: 4270.7940s
	iters: 1300, epoch: 7 | loss: 0.0758535
	speed: 0.1167s/iter; left time: 4246.4545s
	iters: 1400, epoch: 7 | loss: 0.0813657
	speed: 0.1152s/iter; left time: 4177.8630s
	iters: 1500, epoch: 7 | loss: 0.0944329
	speed: 0.1164s/iter; left time: 4211.2387s
	iters: 1600, epoch: 7 | loss: 0.1017237
	speed: 0.1156s/iter; left time: 4171.1375s
	iters: 1700, epoch: 7 | loss: 0.1062258
	speed: 0.1157s/iter; left time: 4162.8680s
	iters: 1800, epoch: 7 | loss: 0.1014802
	speed: 0.1167s/iter; left time: 4187.8144s
	iters: 1900, epoch: 7 | loss: 0.1010558
	speed: 0.1167s/iter; left time: 4174.3972s
	iters: 2000, epoch: 7 | loss: 0.0732227
	speed: 0.1169s/iter; left time: 4169.7044s
	iters: 2100, epoch: 7 | loss: 0.0915565
	speed: 0.1173s/iter; left time: 4174.4953s
	iters: 2200, epoch: 7 | loss: 0.0892187
	speed: 0.1153s/iter; left time: 4090.8475s
	iters: 2300, epoch: 7 | loss: 0.0861450
	speed: 0.1153s/iter; left time: 4077.3121s
	iters: 2400, epoch: 7 | loss: 0.0746982
	speed: 0.1160s/iter; left time: 4093.0898s
	iters: 2500, epoch: 7 | loss: 0.0731142
	speed: 0.1162s/iter; left time: 4088.0478s
	iters: 2600, epoch: 7 | loss: 0.0744261
	speed: 0.1155s/iter; left time: 4049.5048s
Epoch: 7 cost time: 00h:05m:13.39s
Epoch: 7 | Train Loss: 0.0857488 Vali Loss: 0.0787276 Test Loss: 0.0848344
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0803231
	speed: 0.9810s/iter; left time: 34221.1282s
	iters: 200, epoch: 8 | loss: 0.0757215
	speed: 0.1165s/iter; left time: 4050.9094s
	iters: 300, epoch: 8 | loss: 0.0945297
	speed: 0.1174s/iter; left time: 4071.7276s
	iters: 400, epoch: 8 | loss: 0.0887359
	speed: 0.1170s/iter; left time: 4046.3619s
	iters: 500, epoch: 8 | loss: 0.0828975
	speed: 0.1153s/iter; left time: 3975.1436s
	iters: 600, epoch: 8 | loss: 0.0813282
	speed: 0.1162s/iter; left time: 3995.7034s
	iters: 700, epoch: 8 | loss: 0.0668938
	speed: 0.1176s/iter; left time: 4032.2929s
	iters: 800, epoch: 8 | loss: 0.0837017
	speed: 0.1063s/iter; left time: 3633.6560s
	iters: 900, epoch: 8 | loss: 0.0803642
	speed: 0.1150s/iter; left time: 3918.1419s
	iters: 1000, epoch: 8 | loss: 0.0760200
	speed: 0.1106s/iter; left time: 3759.4089s
	iters: 1100, epoch: 8 | loss: 0.0895748
	speed: 0.1079s/iter; left time: 3655.4745s
	iters: 1200, epoch: 8 | loss: 0.0938020
	speed: 0.1076s/iter; left time: 3636.5085s
	iters: 1300, epoch: 8 | loss: 0.0925988
	speed: 0.1089s/iter; left time: 3669.5521s
	iters: 1400, epoch: 8 | loss: 0.0767561
	speed: 0.1087s/iter; left time: 3651.4342s
	iters: 1500, epoch: 8 | loss: 0.0654879
	speed: 0.1088s/iter; left time: 3642.3707s
	iters: 1600, epoch: 8 | loss: 0.0950684
	speed: 0.1099s/iter; left time: 3669.1597s
	iters: 1700, epoch: 8 | loss: 0.0819798
	speed: 0.1085s/iter; left time: 3610.1746s
	iters: 1800, epoch: 8 | loss: 0.1015619
	speed: 0.1104s/iter; left time: 3662.4440s
	iters: 1900, epoch: 8 | loss: 0.0803827
	speed: 0.1075s/iter; left time: 3555.6806s
	iters: 2000, epoch: 8 | loss: 0.0669943
	speed: 0.1076s/iter; left time: 3548.2569s
	iters: 2100, epoch: 8 | loss: 0.0584329
	speed: 0.1100s/iter; left time: 3617.0933s
	iters: 2200, epoch: 8 | loss: 0.0806590
	speed: 0.1085s/iter; left time: 3556.5976s
	iters: 2300, epoch: 8 | loss: 0.0929671
	speed: 0.1069s/iter; left time: 3493.5199s
	iters: 2400, epoch: 8 | loss: 0.0913270
	speed: 0.1105s/iter; left time: 3600.6363s
	iters: 2500, epoch: 8 | loss: 0.0718101
	speed: 0.1065s/iter; left time: 3459.0762s
	iters: 2600, epoch: 8 | loss: 0.0859066
	speed: 0.1086s/iter; left time: 3518.3297s
Epoch: 8 cost time: 00h:04m:58.79s
Epoch: 8 | Train Loss: 0.0842752 Vali Loss: 0.0798619 Test Loss: 0.0841101
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.0922106
	speed: 0.9995s/iter; left time: 32176.1556s
	iters: 200, epoch: 9 | loss: 0.0897571
	speed: 0.1089s/iter; left time: 3495.7113s
	iters: 300, epoch: 9 | loss: 0.0623380
	speed: 0.1080s/iter; left time: 3456.0926s
	iters: 400, epoch: 9 | loss: 0.0733511
	speed: 0.1100s/iter; left time: 3509.7160s
	iters: 500, epoch: 9 | loss: 0.0863153
	speed: 0.1096s/iter; left time: 3485.3193s
	iters: 600, epoch: 9 | loss: 0.0784250
	speed: 0.1099s/iter; left time: 3482.5028s
	iters: 700, epoch: 9 | loss: 0.0621964
	speed: 0.1095s/iter; left time: 3460.7887s
	iters: 800, epoch: 9 | loss: 0.0698314
	speed: 0.1091s/iter; left time: 3436.6810s
	iters: 900, epoch: 9 | loss: 0.0820047
	speed: 0.1083s/iter; left time: 3401.3189s
	iters: 1000, epoch: 9 | loss: 0.0763479
	speed: 0.1087s/iter; left time: 3400.6183s
	iters: 1100, epoch: 9 | loss: 0.0723443
	speed: 0.1089s/iter; left time: 3398.3996s
	iters: 1200, epoch: 9 | loss: 0.0933339
	speed: 0.1107s/iter; left time: 3440.4772s
	iters: 1300, epoch: 9 | loss: 0.0803285
	speed: 0.1108s/iter; left time: 3433.4594s
	iters: 1400, epoch: 9 | loss: 0.0697617
	speed: 0.1117s/iter; left time: 3451.2412s
	iters: 1500, epoch: 9 | loss: 0.0668261
	speed: 0.1106s/iter; left time: 3404.3545s
	iters: 1600, epoch: 9 | loss: 0.0736176
	speed: 0.1111s/iter; left time: 3409.7163s
	iters: 1700, epoch: 9 | loss: 0.0924216
	speed: 0.1106s/iter; left time: 3384.7932s
	iters: 1800, epoch: 9 | loss: 0.0700373
	speed: 0.1110s/iter; left time: 3386.1760s
	iters: 1900, epoch: 9 | loss: 0.0905273
	speed: 0.1121s/iter; left time: 3407.0341s
	iters: 2000, epoch: 9 | loss: 0.0873711
	speed: 0.1104s/iter; left time: 3343.4414s
	iters: 2100, epoch: 9 | loss: 0.0690359
	speed: 0.1115s/iter; left time: 3365.0326s
	iters: 2200, epoch: 9 | loss: 0.0764138
	speed: 0.1107s/iter; left time: 3330.2051s
	iters: 2300, epoch: 9 | loss: 0.0736902
	speed: 0.1111s/iter; left time: 3331.5544s
	iters: 2400, epoch: 9 | loss: 0.0738030
	speed: 0.1109s/iter; left time: 3314.5451s
	iters: 2500, epoch: 9 | loss: 0.0723926
	speed: 0.1106s/iter; left time: 3295.7242s
	iters: 2600, epoch: 9 | loss: 0.0774040
	speed: 0.1127s/iter; left time: 3345.2743s
Epoch: 9 cost time: 00h:04m:57.58s
Epoch: 9 | Train Loss: 0.0826723 Vali Loss: 0.0802053 Test Loss: 0.0843679
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 10 | loss: 0.0718719
	speed: 1.0037s/iter; left time: 29611.6652s
	iters: 200, epoch: 10 | loss: 0.0820134
	speed: 0.1085s/iter; left time: 3191.3399s
	iters: 300, epoch: 10 | loss: 0.0871429
	speed: 0.1121s/iter; left time: 3285.7988s
	iters: 400, epoch: 10 | loss: 0.0750499
	speed: 0.1103s/iter; left time: 3221.5376s
	iters: 500, epoch: 10 | loss: 0.0743526
	speed: 0.1100s/iter; left time: 3202.5129s
	iters: 600, epoch: 10 | loss: 0.0716704
	speed: 0.1070s/iter; left time: 3103.4502s
	iters: 700, epoch: 10 | loss: 0.0730481
	speed: 0.1096s/iter; left time: 3166.3384s
	iters: 800, epoch: 10 | loss: 0.0884776
	speed: 0.1093s/iter; left time: 3148.1204s
	iters: 900, epoch: 10 | loss: 0.0730145
	speed: 0.1098s/iter; left time: 3150.3721s
	iters: 1000, epoch: 10 | loss: 0.0823452
	speed: 0.1074s/iter; left time: 3072.0429s
	iters: 1100, epoch: 10 | loss: 0.0792662
	speed: 0.1076s/iter; left time: 3067.9559s
	iters: 1200, epoch: 10 | loss: 0.0772781
	speed: 0.1071s/iter; left time: 3041.7340s
	iters: 1300, epoch: 10 | loss: 0.0990755
	speed: 0.1093s/iter; left time: 3093.3337s
	iters: 1400, epoch: 10 | loss: 0.0935434
	speed: 0.1111s/iter; left time: 3132.4183s
	iters: 1500, epoch: 10 | loss: 0.0814993
	speed: 0.1073s/iter; left time: 3016.1721s
	iters: 1600, epoch: 10 | loss: 0.0930371
	speed: 0.1092s/iter; left time: 3057.1117s
	iters: 1700, epoch: 10 | loss: 0.0896463
	speed: 0.1093s/iter; left time: 3049.7165s
	iters: 1800, epoch: 10 | loss: 0.0843857
	speed: 0.1118s/iter; left time: 3109.5160s
	iters: 1900, epoch: 10 | loss: 0.0857551
	speed: 0.1115s/iter; left time: 3088.6796s
	iters: 2000, epoch: 10 | loss: 0.0770558
	speed: 0.1127s/iter; left time: 3110.4487s
	iters: 2100, epoch: 10 | loss: 0.0894686
	speed: 0.1135s/iter; left time: 3121.6679s
	iters: 2200, epoch: 10 | loss: 0.0692895
	speed: 0.1125s/iter; left time: 3082.0599s
	iters: 2300, epoch: 10 | loss: 0.0728806
	speed: 0.1132s/iter; left time: 3090.6093s
	iters: 2400, epoch: 10 | loss: 0.0917956
	speed: 0.1126s/iter; left time: 3064.0648s
	iters: 2500, epoch: 10 | loss: 0.0742273
	speed: 0.1116s/iter; left time: 3025.0136s
	iters: 2600, epoch: 10 | loss: 0.0754556
	speed: 0.1127s/iter; left time: 3044.0736s
Epoch: 10 cost time: 00h:04m:57.45s
Epoch: 10 | Train Loss: 0.0813775 Vali Loss: 0.0823561 Test Loss: 0.0861748
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.01877460442483425, rmse:0.13702045381069183, mae:0.08392173796892166, rse:0.5181057453155518
success delete checkpoints
Intermediate time for IT and pred_len 96: 01h:05m:25.55s

=== Starting experiments for pred_len: 168 ===

--- Running model for IT, pred_len=168 ---
train 85899
val 18219
test 18219
[2024-11-02 23:50:53,647] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-02 23:50:54,668] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-11-02 23:50:54,668] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-02 23:50:54,668] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-11-02 23:50:54,764] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=141.20.21.43, master_port=29500
[2024-11-02 23:50:54,764] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-02 23:50:55,477] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-11-02 23:50:55,479] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-11-02 23:50:55,479] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-02 23:50:55,480] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = Adam
[2024-11-02 23:50:55,480] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=Adam type=<class 'torch.optim.adam.Adam'>
[2024-11-02 23:50:55,480] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-11-02 23:50:55,480] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 200000000
[2024-11-02 23:50:55,480] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 200000000
[2024-11-02 23:50:55,480] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-11-02 23:50:55,481] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-11-02 23:50:55,878] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-11-02 23:50:55,879] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.64 GB         CA 0.65 GB         Max_CA 1 GB 
[2024-11-02 23:50:55,879] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 77.54 GB, percent = 10.3%
[2024-11-02 23:50:56,065] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
[2024-11-02 23:50:56,066] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.73 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 23:50:56,066] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 77.69 GB, percent = 10.3%
[2024-11-02 23:50:56,066] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-11-02 23:50:56,224] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-11-02 23:50:56,225] [INFO] [utils.py:801:see_memory_usage] MA 0.54 GB         Max_MA 0.54 GB         CA 0.84 GB         Max_CA 1 GB 
[2024-11-02 23:50:56,225] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 77.72 GB, percent = 10.3%
[2024-11-02 23:50:56,226] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
[2024-11-02 23:50:56,227] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-11-02 23:50:56,227] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-11-02 23:50:56,227] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[3.9999999999999996e-05], mom=[(0.95, 0.999)]
[2024-11-02 23:50:56,228] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-11-02 23:50:56,228] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-02 23:50:56,228] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-02 23:50:56,228] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-11-02 23:50:56,229] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-11-02 23:50:56,229] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-02 23:50:56,229] [INFO] [config.py:1000:print]   bfloat16_enabled ............. True
[2024-11-02 23:50:56,229] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-11-02 23:50:56,229] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-11-02 23:50:56,229] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-11-02 23:50:56,229] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-11-02 23:50:56,229] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7efc80676d90>
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-11-02 23:50:56,230] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-11-02 23:50:56,231] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-11-02 23:50:56,231] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-11-02 23:50:56,231] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-11-02 23:50:56,231] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-11-02 23:50:56,231] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-11-02 23:50:56,231] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-11-02 23:50:56,231] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-02 23:50:56,231] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 1
[2024-11-02 23:50:56,231] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-11-02 23:50:56,231] [INFO] [config.py:1000:print]   loss_scale ................... 1.0
[2024-11-02 23:50:56,231] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-11-02 23:50:56,231] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-11-02 23:50:56,231] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-11-02 23:50:56,231] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-02 23:50:56,231] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   optimizer_name ............... None
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   optimizer_params ............. None
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   scheduler_name ............... None
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   scheduler_params ............. None
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   steps_per_print .............. inf
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   train_batch_size ............. 32
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  32
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-11-02 23:50:56,232] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-11-02 23:50:56,233] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-11-02 23:50:56,233] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  True
[2024-11-02 23:50:56,233] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-02 23:50:56,233] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-11-02 23:50:56,233] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-02 23:50:56,233] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-11-02 23:50:56,233] [INFO] [config.py:986:print_user_config]   json = {
    "bf16": {
        "enabled": true, 
        "auto_cast": true
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09
    }, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 32, 
    "steps_per_print": inf, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
	iters: 100, epoch: 1 | loss: 0.2029339
	speed: 0.1679s/iter; left time: 8995.0314s
	iters: 200, epoch: 1 | loss: 0.1965789
	speed: 0.1201s/iter; left time: 6421.9761s
	iters: 300, epoch: 1 | loss: 0.1898626
	speed: 0.1198s/iter; left time: 6392.5897s
	iters: 400, epoch: 1 | loss: 0.1325201
	speed: 0.1219s/iter; left time: 6497.6080s
	iters: 500, epoch: 1 | loss: 0.1311700
	speed: 0.1221s/iter; left time: 6492.0127s
	iters: 600, epoch: 1 | loss: 0.1017136
	speed: 0.1197s/iter; left time: 6353.0440s
	iters: 700, epoch: 1 | loss: 0.1076386
	speed: 0.1220s/iter; left time: 6462.5694s
	iters: 800, epoch: 1 | loss: 0.0973543
	speed: 0.1208s/iter; left time: 6389.9462s
	iters: 900, epoch: 1 | loss: 0.1088642
	speed: 0.1220s/iter; left time: 6437.7781s
	iters: 1000, epoch: 1 | loss: 0.1006573
	speed: 0.1170s/iter; left time: 6163.3873s
	iters: 1100, epoch: 1 | loss: 0.1109908
	speed: 0.1200s/iter; left time: 6309.1371s
	iters: 1200, epoch: 1 | loss: 0.1184647
	speed: 0.1189s/iter; left time: 6240.6206s
	iters: 1300, epoch: 1 | loss: 0.1054379
	speed: 0.1211s/iter; left time: 6343.0842s
	iters: 1400, epoch: 1 | loss: 0.0932986
	speed: 0.1217s/iter; left time: 6362.1241s
	iters: 1500, epoch: 1 | loss: 0.0875861
	speed: 0.1198s/iter; left time: 6252.8626s
	iters: 1600, epoch: 1 | loss: 0.0992577
	speed: 0.1198s/iter; left time: 6240.0593s
	iters: 1700, epoch: 1 | loss: 0.0822084
	speed: 0.1217s/iter; left time: 6327.8348s
	iters: 1800, epoch: 1 | loss: 0.0944820
	speed: 0.1208s/iter; left time: 6268.0620s
	iters: 1900, epoch: 1 | loss: 0.1164758
	speed: 0.1205s/iter; left time: 6241.0843s
	iters: 2000, epoch: 1 | loss: 0.0924384
	speed: 0.1191s/iter; left time: 6155.0111s
	iters: 2100, epoch: 1 | loss: 0.1107640
	speed: 0.1185s/iter; left time: 6110.7540s
	iters: 2200, epoch: 1 | loss: 0.0971796
	speed: 0.1189s/iter; left time: 6122.0563s
	iters: 2300, epoch: 1 | loss: 0.1212062
	speed: 0.1190s/iter; left time: 6114.2571s
	iters: 2400, epoch: 1 | loss: 0.0958548
	speed: 0.1187s/iter; left time: 6088.0092s
	iters: 2500, epoch: 1 | loss: 0.0936789
	speed: 0.1194s/iter; left time: 6108.7054s
	iters: 2600, epoch: 1 | loss: 0.1049049
	speed: 0.1187s/iter; left time: 6061.0823s
Epoch: 1 cost time: 00h:05m:23.87s
Epoch: 1 | Train Loss: 0.1210713 Vali Loss: 0.0890277 Test Loss: 0.0935509
Validation loss decreased (inf --> 0.089028).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 2 | loss: 0.0989368
	speed: 1.1391s/iter; left time: 57975.4121s
	iters: 200, epoch: 2 | loss: 0.1063188
	speed: 0.1097s/iter; left time: 5572.4976s
	iters: 300, epoch: 2 | loss: 0.0887055
	speed: 0.1095s/iter; left time: 5550.5036s
	iters: 400, epoch: 2 | loss: 0.1021468
	speed: 0.1079s/iter; left time: 5457.7022s
	iters: 500, epoch: 2 | loss: 0.1028672
	speed: 0.1096s/iter; left time: 5532.1899s
	iters: 600, epoch: 2 | loss: 0.0918319
	speed: 0.1079s/iter; left time: 5439.5561s
	iters: 700, epoch: 2 | loss: 0.0951936
	speed: 0.1054s/iter; left time: 5299.3630s
	iters: 800, epoch: 2 | loss: 0.1038750
	speed: 0.1104s/iter; left time: 5544.2517s
	iters: 900, epoch: 2 | loss: 0.1151560
	speed: 0.1108s/iter; left time: 5550.2593s
	iters: 1000, epoch: 2 | loss: 0.1127429
	speed: 0.1094s/iter; left time: 5469.5303s
	iters: 1100, epoch: 2 | loss: 0.0969984
	speed: 0.1083s/iter; left time: 5403.1301s
	iters: 1200, epoch: 2 | loss: 0.0921559
	speed: 0.1101s/iter; left time: 5484.1706s
	iters: 1300, epoch: 2 | loss: 0.0809502
	speed: 0.1082s/iter; left time: 5376.5853s
	iters: 1400, epoch: 2 | loss: 0.1063600
	speed: 0.1123s/iter; left time: 5570.1085s
	iters: 1500, epoch: 2 | loss: 0.1049415
	speed: 0.1081s/iter; left time: 5350.1810s
	iters: 1600, epoch: 2 | loss: 0.0913269
	speed: 0.1085s/iter; left time: 5358.6075s
	iters: 1700, epoch: 2 | loss: 0.0902280
	speed: 0.1107s/iter; left time: 5457.1329s
	iters: 1800, epoch: 2 | loss: 0.1115005
	speed: 0.1093s/iter; left time: 5377.3792s
	iters: 1900, epoch: 2 | loss: 0.1071176
	speed: 0.1084s/iter; left time: 5323.9618s
	iters: 2000, epoch: 2 | loss: 0.1019441
	speed: 0.1092s/iter; left time: 5348.9450s
	iters: 2100, epoch: 2 | loss: 0.1077473
	speed: 0.1128s/iter; left time: 5513.3037s
	iters: 2200, epoch: 2 | loss: 0.1180863
	speed: 0.1093s/iter; left time: 5335.5151s
	iters: 2300, epoch: 2 | loss: 0.0979958
	speed: 0.1077s/iter; left time: 5242.6888s
	iters: 2400, epoch: 2 | loss: 0.1100279
	speed: 0.1086s/iter; left time: 5277.2700s
	iters: 2500, epoch: 2 | loss: 0.1068703
	speed: 0.1106s/iter; left time: 5366.0161s
	iters: 2600, epoch: 2 | loss: 0.0836630
	speed: 0.1099s/iter; left time: 5316.6257s
Epoch: 2 cost time: 00h:04m:53.91s
Epoch: 2 | Train Loss: 0.0996675 Vali Loss: 0.0841658 Test Loss: 0.0895244
Validation loss decreased (0.089028 --> 0.084166).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 3 | loss: 0.1142319
	speed: 1.0354s/iter; left time: 49920.7792s
	iters: 200, epoch: 3 | loss: 0.0889279
	speed: 0.1108s/iter; left time: 5332.4357s
	iters: 300, epoch: 3 | loss: 0.0985157
	speed: 0.1093s/iter; left time: 5245.7327s
	iters: 400, epoch: 3 | loss: 0.0925059
	speed: 0.1078s/iter; left time: 5166.7550s
	iters: 500, epoch: 3 | loss: 0.0979997
	speed: 0.1105s/iter; left time: 5284.2447s
	iters: 600, epoch: 3 | loss: 0.1002590
	speed: 0.1085s/iter; left time: 5176.8450s
	iters: 700, epoch: 3 | loss: 0.0918859
	speed: 0.1088s/iter; left time: 5181.8800s
	iters: 800, epoch: 3 | loss: 0.0898818
	speed: 0.1092s/iter; left time: 5186.8335s
	iters: 900, epoch: 3 | loss: 0.1080294
	speed: 0.1077s/iter; left time: 5107.2974s
	iters: 1000, epoch: 3 | loss: 0.0840585
	speed: 0.1109s/iter; left time: 5248.6033s
	iters: 1100, epoch: 3 | loss: 0.1036685
	speed: 0.1080s/iter; left time: 5099.2819s
	iters: 1200, epoch: 3 | loss: 0.0952610
	speed: 0.1097s/iter; left time: 5170.3811s
	iters: 1300, epoch: 3 | loss: 0.0965679
	speed: 0.1097s/iter; left time: 5157.9908s
	iters: 1400, epoch: 3 | loss: 0.0959029
	speed: 0.1093s/iter; left time: 5128.9773s
	iters: 1500, epoch: 3 | loss: 0.1035789
	speed: 0.1090s/iter; left time: 5103.8582s
	iters: 1600, epoch: 3 | loss: 0.1028642
	speed: 0.1100s/iter; left time: 5137.9338s
	iters: 1700, epoch: 3 | loss: 0.0882429
	speed: 0.1096s/iter; left time: 5110.8954s
	iters: 1800, epoch: 3 | loss: 0.0945800
	speed: 0.1099s/iter; left time: 5112.2348s
	iters: 1900, epoch: 3 | loss: 0.0928347
	speed: 0.1104s/iter; left time: 5124.0375s
	iters: 2000, epoch: 3 | loss: 0.1003603
	speed: 0.1096s/iter; left time: 5077.2074s
	iters: 2100, epoch: 3 | loss: 0.0984533
	speed: 0.1095s/iter; left time: 5062.3104s
	iters: 2200, epoch: 3 | loss: 0.1025412
	speed: 0.1075s/iter; left time: 4955.1975s
	iters: 2300, epoch: 3 | loss: 0.0893745
	speed: 0.1096s/iter; left time: 5041.8927s
	iters: 2400, epoch: 3 | loss: 0.0895675
	speed: 0.1104s/iter; left time: 5068.4222s
	iters: 2500, epoch: 3 | loss: 0.1030405
	speed: 0.1123s/iter; left time: 5143.2645s
	iters: 2600, epoch: 3 | loss: 0.0951473
	speed: 0.1126s/iter; left time: 5145.1640s
Epoch: 3 cost time: 00h:04m:54.67s
Epoch: 3 | Train Loss: 0.0963206 Vali Loss: 0.0841027 Test Loss: 0.0897672
Validation loss decreased (0.084166 --> 0.084103).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 4 | loss: 0.0876906
	speed: 1.0156s/iter; left time: 46239.8347s
	iters: 200, epoch: 4 | loss: 0.0991883
	speed: 0.1097s/iter; left time: 4984.6479s
	iters: 300, epoch: 4 | loss: 0.1039904
	speed: 0.1111s/iter; left time: 5037.4476s
	iters: 400, epoch: 4 | loss: 0.0816384
	speed: 0.1112s/iter; left time: 5029.5138s
	iters: 500, epoch: 4 | loss: 0.0884582
	speed: 0.1091s/iter; left time: 4923.2094s
	iters: 600, epoch: 4 | loss: 0.0939277
	speed: 0.1102s/iter; left time: 4961.8169s
	iters: 700, epoch: 4 | loss: 0.0897342
	speed: 0.1086s/iter; left time: 4879.0680s
	iters: 800, epoch: 4 | loss: 0.0904002
	speed: 0.1136s/iter; left time: 5092.9051s
	iters: 900, epoch: 4 | loss: 0.1019345
	speed: 0.1094s/iter; left time: 4895.5678s
	iters: 1000, epoch: 4 | loss: 0.1152800
	speed: 0.1103s/iter; left time: 4923.4616s
	iters: 1100, epoch: 4 | loss: 0.0801582
	speed: 0.1103s/iter; left time: 4912.7238s
	iters: 1200, epoch: 4 | loss: 0.0705594
	speed: 0.1108s/iter; left time: 4922.2872s
	iters: 1300, epoch: 4 | loss: 0.1035900
	speed: 0.1114s/iter; left time: 4938.2054s
	iters: 1400, epoch: 4 | loss: 0.1084320
	speed: 0.1099s/iter; left time: 4858.8270s
	iters: 1500, epoch: 4 | loss: 0.1027107
	speed: 0.1103s/iter; left time: 4868.2863s
	iters: 1600, epoch: 4 | loss: 0.1098636
	speed: 0.1125s/iter; left time: 4953.1752s
	iters: 1700, epoch: 4 | loss: 0.1155795
	speed: 0.1101s/iter; left time: 4836.7290s
	iters: 1800, epoch: 4 | loss: 0.0852332
	speed: 0.1088s/iter; left time: 4766.7043s
	iters: 1900, epoch: 4 | loss: 0.0975535
	speed: 0.1080s/iter; left time: 4722.3323s
	iters: 2000, epoch: 4 | loss: 0.0907878
	speed: 0.1094s/iter; left time: 4774.2535s
	iters: 2100, epoch: 4 | loss: 0.1058796
	speed: 0.1083s/iter; left time: 4714.2260s
	iters: 2200, epoch: 4 | loss: 0.0916528
	speed: 0.1085s/iter; left time: 4713.9516s
	iters: 2300, epoch: 4 | loss: 0.0722211
	speed: 0.1091s/iter; left time: 4726.8356s
	iters: 2400, epoch: 4 | loss: 0.0976648
	speed: 0.1091s/iter; left time: 4717.7498s
	iters: 2500, epoch: 4 | loss: 0.0973345
	speed: 0.1098s/iter; left time: 4734.1440s
	iters: 2600, epoch: 4 | loss: 0.1003160
	speed: 0.1075s/iter; left time: 4626.5454s
Epoch: 4 cost time: 00h:04m:55.51s
Epoch: 4 | Train Loss: 0.0942669 Vali Loss: 0.0841781 Test Loss: 0.0898632
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 5 | loss: 0.0956298
	speed: 0.9791s/iter; left time: 41947.9687s
	iters: 200, epoch: 5 | loss: 0.0926843
	speed: 0.1115s/iter; left time: 4768.1909s
	iters: 300, epoch: 5 | loss: 0.0960669
	speed: 0.1119s/iter; left time: 4771.1583s
	iters: 400, epoch: 5 | loss: 0.1028672
	speed: 0.1133s/iter; left time: 4818.9602s
	iters: 500, epoch: 5 | loss: 0.0889630
	speed: 0.1136s/iter; left time: 4822.7283s
	iters: 600, epoch: 5 | loss: 0.0886828
	speed: 0.1118s/iter; left time: 4734.4450s
	iters: 700, epoch: 5 | loss: 0.0865297
	speed: 0.1123s/iter; left time: 4742.8606s
	iters: 800, epoch: 5 | loss: 0.0793266
	speed: 0.1123s/iter; left time: 4732.9254s
	iters: 900, epoch: 5 | loss: 0.0875158
	speed: 0.1100s/iter; left time: 4626.6067s
	iters: 1000, epoch: 5 | loss: 0.1002013
	speed: 0.1128s/iter; left time: 4730.8102s
	iters: 1100, epoch: 5 | loss: 0.0797455
	speed: 0.1109s/iter; left time: 4640.6352s
	iters: 1200, epoch: 5 | loss: 0.1008162
	speed: 0.1114s/iter; left time: 4650.6303s
	iters: 1300, epoch: 5 | loss: 0.0942667
	speed: 0.1117s/iter; left time: 4651.4745s
	iters: 1400, epoch: 5 | loss: 0.0891483
	speed: 0.1108s/iter; left time: 4602.0999s
	iters: 1500, epoch: 5 | loss: 0.0945314
	speed: 0.1104s/iter; left time: 4574.6913s
	iters: 1600, epoch: 5 | loss: 0.0918318
	speed: 0.1082s/iter; left time: 4474.3307s
	iters: 1700, epoch: 5 | loss: 0.0960498
	speed: 0.1101s/iter; left time: 4539.8121s
	iters: 1800, epoch: 5 | loss: 0.0857012
	speed: 0.1114s/iter; left time: 4585.0055s
	iters: 1900, epoch: 5 | loss: 0.1000285
	speed: 0.1093s/iter; left time: 4484.9406s
	iters: 2000, epoch: 5 | loss: 0.0954931
	speed: 0.1111s/iter; left time: 4549.3282s
	iters: 2100, epoch: 5 | loss: 0.0967594
	speed: 0.1115s/iter; left time: 4555.8473s
	iters: 2200, epoch: 5 | loss: 0.0867127
	speed: 0.1100s/iter; left time: 4483.8720s
	iters: 2300, epoch: 5 | loss: 0.0886693
	speed: 0.1081s/iter; left time: 4391.9438s
	iters: 2400, epoch: 5 | loss: 0.0934356
	speed: 0.1099s/iter; left time: 4455.3731s
	iters: 2500, epoch: 5 | loss: 0.1050704
	speed: 0.1047s/iter; left time: 4235.5352s
	iters: 2600, epoch: 5 | loss: 0.0817107
	speed: 0.1089s/iter; left time: 4394.9630s
Epoch: 5 cost time: 00h:04m:57.74s
Epoch: 5 | Train Loss: 0.0925586 Vali Loss: 0.0840413 Test Loss: 0.0891893
Validation loss decreased (0.084103 --> 0.084041).  Saving model ...
lr = 0.0000400000
	iters: 100, epoch: 6 | loss: 0.1023156
	speed: 0.9987s/iter; left time: 40109.5961s
	iters: 200, epoch: 6 | loss: 0.0814353
	speed: 0.1091s/iter; left time: 4372.3853s
	iters: 300, epoch: 6 | loss: 0.0786190
	speed: 0.1127s/iter; left time: 4505.0348s
	iters: 400, epoch: 6 | loss: 0.0850952
	speed: 0.1095s/iter; left time: 4364.9110s
	iters: 500, epoch: 6 | loss: 0.0954753
	speed: 0.1084s/iter; left time: 4310.2970s
	iters: 600, epoch: 6 | loss: 0.0951714
	speed: 0.1075s/iter; left time: 4263.4483s
	iters: 700, epoch: 6 | loss: 0.0956363
	speed: 0.1088s/iter; left time: 4304.6142s
	iters: 800, epoch: 6 | loss: 0.0957980
	speed: 0.1116s/iter; left time: 4403.2993s
	iters: 900, epoch: 6 | loss: 0.0858036
	speed: 0.1084s/iter; left time: 4266.2953s
	iters: 1000, epoch: 6 | loss: 0.0840625
	speed: 0.1095s/iter; left time: 4299.1964s
	iters: 1100, epoch: 6 | loss: 0.1052077
	speed: 0.1113s/iter; left time: 4360.4634s
	iters: 1200, epoch: 6 | loss: 0.0996516
	speed: 0.1107s/iter; left time: 4323.7721s
	iters: 1300, epoch: 6 | loss: 0.0890602
	speed: 0.1103s/iter; left time: 4299.3119s
	iters: 1400, epoch: 6 | loss: 0.0871324
	speed: 0.1134s/iter; left time: 4405.4610s
	iters: 1500, epoch: 6 | loss: 0.1050522
	speed: 0.1097s/iter; left time: 4251.4229s
	iters: 1600, epoch: 6 | loss: 0.0922716
	speed: 0.1076s/iter; left time: 4160.7940s
	iters: 1700, epoch: 6 | loss: 0.0856184
	speed: 0.1090s/iter; left time: 4201.4655s
	iters: 1800, epoch: 6 | loss: 0.0855285
	speed: 0.1098s/iter; left time: 4223.7127s
	iters: 1900, epoch: 6 | loss: 0.0947269
	speed: 0.1088s/iter; left time: 4174.5388s
	iters: 2000, epoch: 6 | loss: 0.0936098
	speed: 0.1098s/iter; left time: 4200.9011s
	iters: 2100, epoch: 6 | loss: 0.0826341
	speed: 0.1077s/iter; left time: 4111.5602s
	iters: 2200, epoch: 6 | loss: 0.0854143
	speed: 0.1091s/iter; left time: 4153.8185s
	iters: 2300, epoch: 6 | loss: 0.1005903
	speed: 0.1087s/iter; left time: 4125.2825s
	iters: 2400, epoch: 6 | loss: 0.1012520
	speed: 0.1090s/iter; left time: 4125.6942s
	iters: 2500, epoch: 6 | loss: 0.0836399
	speed: 0.1077s/iter; left time: 4068.0019s
	iters: 2600, epoch: 6 | loss: 0.0693969
	speed: 0.1071s/iter; left time: 4033.4910s
Epoch: 6 cost time: 00h:04m:54.35s
Epoch: 6 | Train Loss: 0.0908017 Vali Loss: 0.0846587 Test Loss: 0.0896558
EarlyStopping counter: 1 out of 5
lr = 0.0000400000
	iters: 100, epoch: 7 | loss: 0.0822827
	speed: 0.9899s/iter; left time: 37100.0563s
	iters: 200, epoch: 7 | loss: 0.0926162
	speed: 0.1114s/iter; left time: 4164.7326s
	iters: 300, epoch: 7 | loss: 0.0814312
	speed: 0.1117s/iter; left time: 4164.3827s
	iters: 400, epoch: 7 | loss: 0.0927256
	speed: 0.1096s/iter; left time: 4074.4149s
	iters: 500, epoch: 7 | loss: 0.0889228
	speed: 0.1091s/iter; left time: 4045.6678s
	iters: 600, epoch: 7 | loss: 0.1010134
	speed: 0.1092s/iter; left time: 4039.2271s
	iters: 700, epoch: 7 | loss: 0.0931574
	speed: 0.1082s/iter; left time: 3988.9460s
	iters: 800, epoch: 7 | loss: 0.1155873
	speed: 0.1110s/iter; left time: 4080.5043s
	iters: 900, epoch: 7 | loss: 0.0780460
	speed: 0.1100s/iter; left time: 4035.3996s
	iters: 1000, epoch: 7 | loss: 0.0952020
	speed: 0.1084s/iter; left time: 3963.3575s
	iters: 1100, epoch: 7 | loss: 0.0811136
	speed: 0.1111s/iter; left time: 4052.5775s
	iters: 1200, epoch: 7 | loss: 0.0879815
	speed: 0.1089s/iter; left time: 3961.4461s
	iters: 1300, epoch: 7 | loss: 0.0844414
	speed: 0.1090s/iter; left time: 3956.0002s
	iters: 1400, epoch: 7 | loss: 0.0822187
	speed: 0.1082s/iter; left time: 3915.6191s
	iters: 1500, epoch: 7 | loss: 0.0836276
	speed: 0.1106s/iter; left time: 3991.4405s
	iters: 1600, epoch: 7 | loss: 0.0950310
	speed: 0.1099s/iter; left time: 3952.8517s
	iters: 1700, epoch: 7 | loss: 0.0898525
	speed: 0.1119s/iter; left time: 4015.9486s
	iters: 1800, epoch: 7 | loss: 0.1007908
	speed: 0.1098s/iter; left time: 3928.4173s
	iters: 1900, epoch: 7 | loss: 0.0798731
	speed: 0.1129s/iter; left time: 4028.6812s
	iters: 2000, epoch: 7 | loss: 0.1034588
	speed: 0.1093s/iter; left time: 3887.3728s
	iters: 2100, epoch: 7 | loss: 0.0921248
	speed: 0.1107s/iter; left time: 3926.8929s
	iters: 2200, epoch: 7 | loss: 0.1086720
	speed: 0.1100s/iter; left time: 3890.3396s
	iters: 2300, epoch: 7 | loss: 0.0822674
	speed: 0.1113s/iter; left time: 3926.1189s
	iters: 2400, epoch: 7 | loss: 0.0884877
	speed: 0.1077s/iter; left time: 3790.1335s
	iters: 2500, epoch: 7 | loss: 0.1050238
	speed: 0.1150s/iter; left time: 4034.0993s
	iters: 2600, epoch: 7 | loss: 0.0835463
	speed: 0.1124s/iter; left time: 3930.4840s
Epoch: 7 cost time: 00h:04m:56.70s
Epoch: 7 | Train Loss: 0.0888387 Vali Loss: 0.0842900 Test Loss: 0.0893077
EarlyStopping counter: 2 out of 5
lr = 0.0000400000
	iters: 100, epoch: 8 | loss: 0.0919155
	speed: 0.9824s/iter; left time: 34179.8800s
	iters: 200, epoch: 8 | loss: 0.0877724
	speed: 0.1100s/iter; left time: 3816.5570s
	iters: 300, epoch: 8 | loss: 0.0862236
	speed: 0.1089s/iter; left time: 3768.4950s
	iters: 400, epoch: 8 | loss: 0.0993591
	speed: 0.1077s/iter; left time: 3716.4490s
	iters: 500, epoch: 8 | loss: 0.1030686
	speed: 0.1112s/iter; left time: 3823.2374s
	iters: 600, epoch: 8 | loss: 0.0945140
	speed: 0.1119s/iter; left time: 3838.9451s
	iters: 700, epoch: 8 | loss: 0.1027590
	speed: 0.1092s/iter; left time: 3732.5127s
	iters: 800, epoch: 8 | loss: 0.1001980
	speed: 0.1121s/iter; left time: 3822.6252s
	iters: 900, epoch: 8 | loss: 0.0884102
	speed: 0.1090s/iter; left time: 3705.9591s
	iters: 1000, epoch: 8 | loss: 0.0649632
	speed: 0.1099s/iter; left time: 3723.3871s
	iters: 1100, epoch: 8 | loss: 0.0900450
	speed: 0.1090s/iter; left time: 3683.1089s
	iters: 1200, epoch: 8 | loss: 0.0741200
	speed: 0.1112s/iter; left time: 3746.8564s
	iters: 1300, epoch: 8 | loss: 0.0829209
	speed: 0.1088s/iter; left time: 3654.2949s
	iters: 1400, epoch: 8 | loss: 0.1002313
	speed: 0.1093s/iter; left time: 3661.3948s
	iters: 1500, epoch: 8 | loss: 0.0962400
	speed: 0.1087s/iter; left time: 3629.8484s
	iters: 1600, epoch: 8 | loss: 0.0859644
	speed: 0.1107s/iter; left time: 3684.4940s
	iters: 1700, epoch: 8 | loss: 0.0893864
	speed: 0.1133s/iter; left time: 3761.5151s
	iters: 1800, epoch: 8 | loss: 0.0875129
	speed: 0.1101s/iter; left time: 3643.0258s
	iters: 1900, epoch: 8 | loss: 0.0895706
	speed: 0.1103s/iter; left time: 3637.8111s
	iters: 2000, epoch: 8 | loss: 0.0810007
	speed: 0.1099s/iter; left time: 3615.4657s
	iters: 2100, epoch: 8 | loss: 0.0934768
	speed: 0.1105s/iter; left time: 3624.0294s
	iters: 2200, epoch: 8 | loss: 0.1046799
	speed: 0.1108s/iter; left time: 3623.2802s
	iters: 2300, epoch: 8 | loss: 0.0742580
	speed: 0.1118s/iter; left time: 3643.2920s
	iters: 2400, epoch: 8 | loss: 0.0805892
	speed: 0.1101s/iter; left time: 3575.9694s
	iters: 2500, epoch: 8 | loss: 0.0943531
	speed: 0.1133s/iter; left time: 3669.6143s
	iters: 2600, epoch: 8 | loss: 0.0835769
	speed: 0.1103s/iter; left time: 3563.4025s
Epoch: 8 cost time: 00h:04m:56.76s
Epoch: 8 | Train Loss: 0.0870042 Vali Loss: 0.0843130 Test Loss: 0.0891844
EarlyStopping counter: 3 out of 5
lr = 0.0000400000
	iters: 100, epoch: 9 | loss: 0.0846436
	speed: 0.9931s/iter; left time: 31886.2504s
	iters: 200, epoch: 9 | loss: 0.0627204
	speed: 0.1136s/iter; left time: 3635.0689s
	iters: 300, epoch: 9 | loss: 0.0839949
	speed: 0.1118s/iter; left time: 3566.4207s
	iters: 400, epoch: 9 | loss: 0.0899176
	speed: 0.1117s/iter; left time: 3554.0239s
	iters: 500, epoch: 9 | loss: 0.0827703
	speed: 0.1087s/iter; left time: 3448.3166s
	iters: 600, epoch: 9 | loss: 0.0757234
	speed: 0.1079s/iter; left time: 3410.3451s
	iters: 700, epoch: 9 | loss: 0.0842483
	speed: 0.1056s/iter; left time: 3328.5301s
	iters: 800, epoch: 9 | loss: 0.0728695
	speed: 0.1088s/iter; left time: 3417.5830s
	iters: 900, epoch: 9 | loss: 0.0946383
	speed: 0.1088s/iter; left time: 3407.5581s
	iters: 1000, epoch: 9 | loss: 0.0801099
	speed: 0.1090s/iter; left time: 3403.3083s
	iters: 1100, epoch: 9 | loss: 0.0760204
	speed: 0.1110s/iter; left time: 3452.1874s
	iters: 1200, epoch: 9 | loss: 0.0898418
	speed: 0.1095s/iter; left time: 3395.2446s
	iters: 1300, epoch: 9 | loss: 0.0854249
	speed: 0.1069s/iter; left time: 3304.6754s
	iters: 1400, epoch: 9 | loss: 0.0841468
	speed: 0.1094s/iter; left time: 3371.7299s
	iters: 1500, epoch: 9 | loss: 0.0759359
	speed: 0.1100s/iter; left time: 3376.7436s
	iters: 1600, epoch: 9 | loss: 0.0933973
	speed: 0.1102s/iter; left time: 3374.0485s
	iters: 1700, epoch: 9 | loss: 0.0746514
	speed: 0.1120s/iter; left time: 3416.6345s
	iters: 1800, epoch: 9 | loss: 0.0891489
	speed: 0.1091s/iter; left time: 3316.1871s
	iters: 1900, epoch: 9 | loss: 0.0825078
	speed: 0.1085s/iter; left time: 3289.5723s
	iters: 2000, epoch: 9 | loss: 0.0846198
	speed: 0.1104s/iter; left time: 3335.3857s
	iters: 2100, epoch: 9 | loss: 0.0837791
	speed: 0.1095s/iter; left time: 3296.0821s
	iters: 2200, epoch: 9 | loss: 0.0860811
	speed: 0.1096s/iter; left time: 3287.7848s
	iters: 2300, epoch: 9 | loss: 0.0792212
	speed: 0.1103s/iter; left time: 3298.4558s
	iters: 2400, epoch: 9 | loss: 0.0837938
	speed: 0.1080s/iter; left time: 3219.4986s
	iters: 2500, epoch: 9 | loss: 0.0834742
	speed: 0.1098s/iter; left time: 3263.2591s
	iters: 2600, epoch: 9 | loss: 0.0836421
	speed: 0.1088s/iter; left time: 3220.5760s
Epoch: 9 cost time: 00h:04m:54.56s
Epoch: 9 | Train Loss: 0.0853277 Vali Loss: 0.0862787 Test Loss: 0.0900003
EarlyStopping counter: 4 out of 5
lr = 0.0000400000
	iters: 100, epoch: 10 | loss: 0.0887046
	speed: 0.9788s/iter; left time: 28801.2164s
	iters: 200, epoch: 10 | loss: 0.0646053
	speed: 0.1075s/iter; left time: 3152.2188s
	iters: 300, epoch: 10 | loss: 0.0941833
	speed: 0.1090s/iter; left time: 3186.2389s
	iters: 400, epoch: 10 | loss: 0.0726987
	speed: 0.1123s/iter; left time: 3271.5557s
	iters: 500, epoch: 10 | loss: 0.0876720
	speed: 0.1126s/iter; left time: 3269.1611s
	iters: 600, epoch: 10 | loss: 0.0904420
	speed: 0.1142s/iter; left time: 3303.6465s
	iters: 700, epoch: 10 | loss: 0.0787993
	speed: 0.1109s/iter; left time: 3197.0932s
	iters: 800, epoch: 10 | loss: 0.0708453
	speed: 0.1118s/iter; left time: 3211.4367s
	iters: 900, epoch: 10 | loss: 0.0839387
	speed: 0.1111s/iter; left time: 3180.7091s
	iters: 1000, epoch: 10 | loss: 0.0783891
	speed: 0.1096s/iter; left time: 3127.5211s
	iters: 1100, epoch: 10 | loss: 0.0766438
	speed: 0.1103s/iter; left time: 3134.5486s
	iters: 1200, epoch: 10 | loss: 0.0895397
	speed: 0.1103s/iter; left time: 3123.7572s
	iters: 1300, epoch: 10 | loss: 0.0842266
	speed: 0.1087s/iter; left time: 3068.8769s
	iters: 1400, epoch: 10 | loss: 0.0860861
	speed: 0.1102s/iter; left time: 3098.9001s
	iters: 1500, epoch: 10 | loss: 0.0650968
	speed: 0.1095s/iter; left time: 3068.1646s
	iters: 1600, epoch: 10 | loss: 0.1023239
	speed: 0.1092s/iter; left time: 3048.2008s
	iters: 1700, epoch: 10 | loss: 0.0784739
	speed: 0.1103s/iter; left time: 3069.1363s
	iters: 1800, epoch: 10 | loss: 0.0877584
	speed: 0.1096s/iter; left time: 3038.4388s
	iters: 1900, epoch: 10 | loss: 0.0746399
	speed: 0.1106s/iter; left time: 3056.2888s
	iters: 2000, epoch: 10 | loss: 0.0881622
	speed: 0.1076s/iter; left time: 2962.8424s
	iters: 2100, epoch: 10 | loss: 0.0905812
	speed: 0.1096s/iter; left time: 3006.3810s
	iters: 2200, epoch: 10 | loss: 0.0936635
	speed: 0.1130s/iter; left time: 3087.8383s
	iters: 2300, epoch: 10 | loss: 0.0850890
	speed: 0.1102s/iter; left time: 2999.2200s
	iters: 2400, epoch: 10 | loss: 0.0925531
	speed: 0.1115s/iter; left time: 3025.3495s
	iters: 2500, epoch: 10 | loss: 0.0950423
	speed: 0.1093s/iter; left time: 2952.7029s
	iters: 2600, epoch: 10 | loss: 0.0860755
	speed: 0.1111s/iter; left time: 2992.5685s
Epoch: 10 cost time: 00h:04m:56.60s
Epoch: 10 | Train Loss: 0.0836082 Vali Loss: 0.0852293 Test Loss: 0.0903601
EarlyStopping counter: 5 out of 5
Early stopping
loading model...
Scaled mse:0.02039830945432186, rmse:0.14282265305519104, mae:0.0891893059015274, rse:0.5403580069541931
success delete checkpoints
Intermediate time for IT and pred_len 168: 01h:04m:11.86s
Intermediate time for IT: 03h:53m:40.34s
Total time: 20h:49m:25.28s
