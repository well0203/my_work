
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_24_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=True, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=32, stride=16, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0413237
	speed: 0.0276s/iter; left time: 493.3919s
	iters: 200, epoch: 1 | loss: 0.0414541
	speed: 0.0085s/iter; left time: 150.4297s
	iters: 300, epoch: 1 | loss: 0.0285089
	speed: 0.0084s/iter; left time: 148.5445s
	iters: 400, epoch: 1 | loss: 0.0265078
	speed: 0.0092s/iter; left time: 161.0160s
	iters: 500, epoch: 1 | loss: 0.0218464
	speed: 0.0090s/iter; left time: 156.5956s
	iters: 600, epoch: 1 | loss: 0.0222217
	speed: 0.0093s/iter; left time: 162.1676s
	iters: 700, epoch: 1 | loss: 0.0154518
	speed: 0.0088s/iter; left time: 152.6253s
	iters: 800, epoch: 1 | loss: 0.0177985
	speed: 0.0087s/iter; left time: 149.6681s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.39s
Steps: 899 | Train Loss: 0.0290097 Vali Loss: 0.0152752 Test Loss: 0.0163119
Validation loss decreased (inf --> 0.015275).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0136534
	speed: 0.0425s/iter; left time: 721.3045s
	iters: 200, epoch: 2 | loss: 0.0114735
	speed: 0.0091s/iter; left time: 153.3956s
	iters: 300, epoch: 2 | loss: 0.0111327
	speed: 0.0089s/iter; left time: 148.9291s
	iters: 400, epoch: 2 | loss: 0.0120504
	speed: 0.0089s/iter; left time: 148.5904s
	iters: 500, epoch: 2 | loss: 0.0108678
	speed: 0.0088s/iter; left time: 146.7289s
	iters: 600, epoch: 2 | loss: 0.0103024
	speed: 0.0089s/iter; left time: 145.9708s
	iters: 700, epoch: 2 | loss: 0.0141001
	speed: 0.0089s/iter; left time: 145.2946s
	iters: 800, epoch: 2 | loss: 0.0117266
	speed: 0.0089s/iter; left time: 144.4587s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.31s
Steps: 899 | Train Loss: 0.0120037 Vali Loss: 0.0097826 Test Loss: 0.0110079
Validation loss decreased (0.015275 --> 0.009783).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0098456
	speed: 0.0416s/iter; left time: 668.6402s
	iters: 200, epoch: 3 | loss: 0.0075604
	speed: 0.0095s/iter; left time: 151.3982s
	iters: 300, epoch: 3 | loss: 0.0114860
	speed: 0.0094s/iter; left time: 149.6419s
	iters: 400, epoch: 3 | loss: 0.0099784
	speed: 0.0094s/iter; left time: 147.6390s
	iters: 500, epoch: 3 | loss: 0.0119271
	speed: 0.0091s/iter; left time: 143.3371s
	iters: 600, epoch: 3 | loss: 0.0117871
	speed: 0.0091s/iter; left time: 142.2485s
	iters: 700, epoch: 3 | loss: 0.0101010
	speed: 0.0091s/iter; left time: 141.3762s
	iters: 800, epoch: 3 | loss: 0.0133711
	speed: 0.0091s/iter; left time: 140.6210s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.60s
Steps: 899 | Train Loss: 0.0101975 Vali Loss: 0.0093790 Test Loss: 0.0105155
Validation loss decreased (0.009783 --> 0.009379).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0073917
	speed: 0.0422s/iter; left time: 640.9111s
	iters: 200, epoch: 4 | loss: 0.0073908
	speed: 0.0094s/iter; left time: 142.0920s
	iters: 300, epoch: 4 | loss: 0.0091413
	speed: 0.0092s/iter; left time: 137.9772s
	iters: 400, epoch: 4 | loss: 0.0086968
	speed: 0.0092s/iter; left time: 136.6427s
	iters: 500, epoch: 4 | loss: 0.0107999
	speed: 0.0092s/iter; left time: 135.5690s
	iters: 600, epoch: 4 | loss: 0.0097379
	speed: 0.0092s/iter; left time: 135.0998s
	iters: 700, epoch: 4 | loss: 0.0107894
	speed: 0.0090s/iter; left time: 131.9590s
	iters: 800, epoch: 4 | loss: 0.0073125
	speed: 0.0089s/iter; left time: 129.4746s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.53s
Steps: 899 | Train Loss: 0.0096880 Vali Loss: 0.0092516 Test Loss: 0.0103331
Validation loss decreased (0.009379 --> 0.009252).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0096844
	speed: 0.0415s/iter; left time: 593.1690s
	iters: 200, epoch: 5 | loss: 0.0078026
	speed: 0.0095s/iter; left time: 134.6578s
	iters: 300, epoch: 5 | loss: 0.0086012
	speed: 0.0093s/iter; left time: 131.5254s
	iters: 400, epoch: 5 | loss: 0.0126800
	speed: 0.0092s/iter; left time: 128.3189s
	iters: 500, epoch: 5 | loss: 0.0090665
	speed: 0.0090s/iter; left time: 125.4942s
	iters: 600, epoch: 5 | loss: 0.0123089
	speed: 0.0090s/iter; left time: 124.1171s
	iters: 700, epoch: 5 | loss: 0.0082816
	speed: 0.0089s/iter; left time: 122.3315s
	iters: 800, epoch: 5 | loss: 0.0101382
	speed: 0.0090s/iter; left time: 121.6168s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.46s
Steps: 899 | Train Loss: 0.0093300 Vali Loss: 0.0091703 Test Loss: 0.0104352
Validation loss decreased (0.009252 --> 0.009170).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0072891
	speed: 0.0429s/iter; left time: 574.8042s
	iters: 200, epoch: 6 | loss: 0.0090648
	speed: 0.0090s/iter; left time: 120.0340s
	iters: 300, epoch: 6 | loss: 0.0072006
	speed: 0.0090s/iter; left time: 119.1711s
	iters: 400, epoch: 6 | loss: 0.0072824
	speed: 0.0089s/iter; left time: 115.8278s
	iters: 500, epoch: 6 | loss: 0.0076218
	speed: 0.0087s/iter; left time: 113.1597s
	iters: 600, epoch: 6 | loss: 0.0096684
	speed: 0.0087s/iter; left time: 112.3384s
	iters: 700, epoch: 6 | loss: 0.0085068
	speed: 0.0087s/iter; left time: 111.2732s
	iters: 800, epoch: 6 | loss: 0.0084411
	speed: 0.0087s/iter; left time: 110.4844s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.27s
Steps: 899 | Train Loss: 0.0090898 Vali Loss: 0.0088536 Test Loss: 0.0100814
Validation loss decreased (0.009170 --> 0.008854).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0080898
	speed: 0.0468s/iter; left time: 584.0147s
	iters: 200, epoch: 7 | loss: 0.0062180
	speed: 0.0093s/iter; left time: 114.6533s
	iters: 300, epoch: 7 | loss: 0.0102000
	speed: 0.0092s/iter; left time: 113.6140s
	iters: 400, epoch: 7 | loss: 0.0071945
	speed: 0.0092s/iter; left time: 112.5650s
	iters: 500, epoch: 7 | loss: 0.0104952
	speed: 0.0093s/iter; left time: 112.0681s
	iters: 600, epoch: 7 | loss: 0.0089398
	speed: 0.0092s/iter; left time: 110.6133s
	iters: 700, epoch: 7 | loss: 0.0074714
	speed: 0.0092s/iter; left time: 109.6183s
	iters: 800, epoch: 7 | loss: 0.0082831
	speed: 0.0092s/iter; left time: 108.7039s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.55s
Steps: 899 | Train Loss: 0.0088810 Vali Loss: 0.0088497 Test Loss: 0.0100632
Validation loss decreased (0.008854 --> 0.008850).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0094553
	speed: 0.0411s/iter; left time: 476.5607s
	iters: 200, epoch: 8 | loss: 0.0093104
	speed: 0.0095s/iter; left time: 109.4518s
	iters: 300, epoch: 8 | loss: 0.0083308
	speed: 0.0095s/iter; left time: 108.3439s
	iters: 400, epoch: 8 | loss: 0.0087013
	speed: 0.0096s/iter; left time: 108.0634s
	iters: 500, epoch: 8 | loss: 0.0098523
	speed: 0.0101s/iter; left time: 113.1528s
	iters: 600, epoch: 8 | loss: 0.0096529
	speed: 0.0101s/iter; left time: 112.1443s
	iters: 700, epoch: 8 | loss: 0.0089142
	speed: 0.0101s/iter; left time: 110.9870s
	iters: 800, epoch: 8 | loss: 0.0084799
	speed: 0.0101s/iter; left time: 110.0826s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.11s
Steps: 899 | Train Loss: 0.0087289 Vali Loss: 0.0086975 Test Loss: 0.0099730
Validation loss decreased (0.008850 --> 0.008698).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0081330
	speed: 0.0430s/iter; left time: 459.6534s
	iters: 200, epoch: 9 | loss: 0.0101716
	speed: 0.0092s/iter; left time: 97.1949s
	iters: 300, epoch: 9 | loss: 0.0093692
	speed: 0.0092s/iter; left time: 96.4265s
	iters: 400, epoch: 9 | loss: 0.0091461
	speed: 0.0091s/iter; left time: 94.6873s
	iters: 500, epoch: 9 | loss: 0.0086185
	speed: 0.0099s/iter; left time: 102.1393s
	iters: 600, epoch: 9 | loss: 0.0096975
	speed: 0.0101s/iter; left time: 102.9243s
	iters: 700, epoch: 9 | loss: 0.0075101
	speed: 0.0101s/iter; left time: 102.0009s
	iters: 800, epoch: 9 | loss: 0.0120186
	speed: 0.0101s/iter; left time: 101.1261s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.93s
Steps: 899 | Train Loss: 0.0085823 Vali Loss: 0.0088245 Test Loss: 0.0100443
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0062453
	speed: 0.0428s/iter; left time: 419.0432s
	iters: 200, epoch: 10 | loss: 0.0094335
	speed: 0.0091s/iter; left time: 88.2953s
	iters: 300, epoch: 10 | loss: 0.0088109
	speed: 0.0091s/iter; left time: 87.7309s
	iters: 400, epoch: 10 | loss: 0.0098260
	speed: 0.0091s/iter; left time: 86.7761s
	iters: 500, epoch: 10 | loss: 0.0095931
	speed: 0.0091s/iter; left time: 85.7518s
	iters: 600, epoch: 10 | loss: 0.0066524
	speed: 0.0091s/iter; left time: 84.8640s
	iters: 700, epoch: 10 | loss: 0.0085678
	speed: 0.0091s/iter; left time: 83.9501s
	iters: 800, epoch: 10 | loss: 0.0091673
	speed: 0.0091s/iter; left time: 83.1701s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.53s
Steps: 899 | Train Loss: 0.0084647 Vali Loss: 0.0087832 Test Loss: 0.0100974
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0070756
	speed: 0.0399s/iter; left time: 354.3147s
	iters: 200, epoch: 11 | loss: 0.0079320
	speed: 0.0091s/iter; left time: 79.9625s
	iters: 300, epoch: 11 | loss: 0.0066546
	speed: 0.0091s/iter; left time: 79.0327s
	iters: 400, epoch: 11 | loss: 0.0093616
	speed: 0.0091s/iter; left time: 78.1313s
	iters: 500, epoch: 11 | loss: 0.0078648
	speed: 0.0087s/iter; left time: 74.0565s
	iters: 600, epoch: 11 | loss: 0.0069537
	speed: 0.0088s/iter; left time: 73.6524s
	iters: 700, epoch: 11 | loss: 0.0077616
	speed: 0.0091s/iter; left time: 75.2913s
	iters: 800, epoch: 11 | loss: 0.0083379
	speed: 0.0091s/iter; left time: 74.8692s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.37s
Steps: 899 | Train Loss: 0.0083475 Vali Loss: 0.0087222 Test Loss: 0.0100768
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0091521
	speed: 0.0406s/iter; left time: 324.2523s
	iters: 200, epoch: 12 | loss: 0.0088016
	speed: 0.0092s/iter; left time: 72.9015s
	iters: 300, epoch: 12 | loss: 0.0093956
	speed: 0.0092s/iter; left time: 72.0480s
	iters: 400, epoch: 12 | loss: 0.0077337
	speed: 0.0092s/iter; left time: 71.1224s
	iters: 500, epoch: 12 | loss: 0.0097963
	speed: 0.0092s/iter; left time: 70.1374s
	iters: 600, epoch: 12 | loss: 0.0104249
	speed: 0.0093s/iter; left time: 69.3223s
	iters: 700, epoch: 12 | loss: 0.0088897
	speed: 0.0092s/iter; left time: 68.2935s
	iters: 800, epoch: 12 | loss: 0.0087337
	speed: 0.0092s/iter; left time: 67.3747s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.57s
Steps: 899 | Train Loss: 0.0082537 Vali Loss: 0.0086827 Test Loss: 0.0100157
Validation loss decreased (0.008698 --> 0.008683).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0087175
	speed: 0.0401s/iter; left time: 284.7488s
	iters: 200, epoch: 13 | loss: 0.0090104
	speed: 0.0093s/iter; left time: 65.0953s
	iters: 300, epoch: 13 | loss: 0.0064992
	speed: 0.0092s/iter; left time: 63.5576s
	iters: 400, epoch: 13 | loss: 0.0084727
	speed: 0.0092s/iter; left time: 62.7125s
	iters: 500, epoch: 13 | loss: 0.0116350
	speed: 0.0092s/iter; left time: 61.7100s
	iters: 600, epoch: 13 | loss: 0.0067212
	speed: 0.0092s/iter; left time: 60.9334s
	iters: 700, epoch: 13 | loss: 0.0095413
	speed: 0.0095s/iter; left time: 61.6002s
	iters: 800, epoch: 13 | loss: 0.0113080
	speed: 0.0095s/iter; left time: 60.5332s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.60s
Steps: 899 | Train Loss: 0.0081539 Vali Loss: 0.0086791 Test Loss: 0.0101022
Validation loss decreased (0.008683 --> 0.008679).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0121584
	speed: 0.0405s/iter; left time: 250.8368s
	iters: 200, epoch: 14 | loss: 0.0076806
	speed: 0.0091s/iter; left time: 55.6462s
	iters: 300, epoch: 14 | loss: 0.0081299
	speed: 0.0091s/iter; left time: 54.7270s
	iters: 400, epoch: 14 | loss: 0.0088007
	speed: 0.0091s/iter; left time: 53.7907s
	iters: 500, epoch: 14 | loss: 0.0091158
	speed: 0.0091s/iter; left time: 52.9929s
	iters: 600, epoch: 14 | loss: 0.0119706
	speed: 0.0091s/iter; left time: 51.9350s
	iters: 700, epoch: 14 | loss: 0.0083168
	speed: 0.0093s/iter; left time: 51.7935s
	iters: 800, epoch: 14 | loss: 0.0091508
	speed: 0.0094s/iter; left time: 51.6489s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.50s
Steps: 899 | Train Loss: 0.0080760 Vali Loss: 0.0087160 Test Loss: 0.0101824
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0092121
	speed: 0.0418s/iter; left time: 221.1039s
	iters: 200, epoch: 15 | loss: 0.0080515
	speed: 0.0102s/iter; left time: 52.8171s
	iters: 300, epoch: 15 | loss: 0.0059927
	speed: 0.0101s/iter; left time: 51.5542s
	iters: 400, epoch: 15 | loss: 0.0074688
	speed: 0.0101s/iter; left time: 50.5271s
	iters: 500, epoch: 15 | loss: 0.0062001
	speed: 0.0101s/iter; left time: 49.5644s
	iters: 600, epoch: 15 | loss: 0.0080330
	speed: 0.0101s/iter; left time: 48.5602s
	iters: 700, epoch: 15 | loss: 0.0090243
	speed: 0.0095s/iter; left time: 44.7847s
	iters: 800, epoch: 15 | loss: 0.0060183
	speed: 0.0092s/iter; left time: 42.3591s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.12s
Steps: 899 | Train Loss: 0.0079891 Vali Loss: 0.0087264 Test Loss: 0.0102271
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0111088
	speed: 0.0415s/iter; left time: 182.3943s
	iters: 200, epoch: 16 | loss: 0.0085510
	speed: 0.0103s/iter; left time: 44.0369s
	iters: 300, epoch: 16 | loss: 0.0071232
	speed: 0.0102s/iter; left time: 42.9789s
	iters: 400, epoch: 16 | loss: 0.0085175
	speed: 0.0102s/iter; left time: 41.9794s
	iters: 500, epoch: 16 | loss: 0.0081388
	speed: 0.0102s/iter; left time: 40.8142s
	iters: 600, epoch: 16 | loss: 0.0060266
	speed: 0.0103s/iter; left time: 40.1013s
	iters: 700, epoch: 16 | loss: 0.0076079
	speed: 0.0102s/iter; left time: 38.6101s
	iters: 800, epoch: 16 | loss: 0.0086670
	speed: 0.0102s/iter; left time: 37.6509s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.47s
Steps: 899 | Train Loss: 0.0079399 Vali Loss: 0.0087578 Test Loss: 0.0101511
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0088305
	speed: 0.0423s/iter; left time: 148.0085s
	iters: 200, epoch: 17 | loss: 0.0079235
	speed: 0.0095s/iter; left time: 32.1669s
	iters: 300, epoch: 17 | loss: 0.0065094
	speed: 0.0095s/iter; left time: 31.1996s
	iters: 400, epoch: 17 | loss: 0.0106381
	speed: 0.0095s/iter; left time: 30.2750s
	iters: 500, epoch: 17 | loss: 0.0084176
	speed: 0.0095s/iter; left time: 29.3107s
	iters: 600, epoch: 17 | loss: 0.0118364
	speed: 0.0095s/iter; left time: 28.3723s
	iters: 700, epoch: 17 | loss: 0.0051764
	speed: 0.0092s/iter; left time: 26.6506s
	iters: 800, epoch: 17 | loss: 0.0083824
	speed: 0.0091s/iter; left time: 25.5806s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.65s
Steps: 899 | Train Loss: 0.0078595 Vali Loss: 0.0087325 Test Loss: 0.0101260
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0075427
	speed: 0.0405s/iter; left time: 105.1964s
	iters: 200, epoch: 18 | loss: 0.0101333
	speed: 0.0093s/iter; left time: 23.1611s
	iters: 300, epoch: 18 | loss: 0.0083734
	speed: 0.0093s/iter; left time: 22.2297s
	iters: 400, epoch: 18 | loss: 0.0057559
	speed: 0.0093s/iter; left time: 21.2999s
	iters: 500, epoch: 18 | loss: 0.0062597
	speed: 0.0095s/iter; left time: 20.8109s
	iters: 600, epoch: 18 | loss: 0.0088781
	speed: 0.0095s/iter; left time: 19.8689s
	iters: 700, epoch: 18 | loss: 0.0090721
	speed: 0.0095s/iter; left time: 18.9094s
	iters: 800, epoch: 18 | loss: 0.0083109
	speed: 0.0095s/iter; left time: 17.9549s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.74s
Steps: 899 | Train Loss: 0.0078222 Vali Loss: 0.0087182 Test Loss: 0.0101631
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010102159343659878, rmse:0.10050950199365616, mae:0.058577075600624084, rse:0.3798324465751648
Original data scale mse:1228456.75, rmse:1108.357666015625, mae:708.9411010742188, rse:0.0778869092464447
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0415009
	speed: 0.0117s/iter; left time: 209.8297s
	iters: 200, epoch: 1 | loss: 0.0344580
	speed: 0.0092s/iter; left time: 163.3153s
	iters: 300, epoch: 1 | loss: 0.0247920
	speed: 0.0092s/iter; left time: 162.2558s
	iters: 400, epoch: 1 | loss: 0.0305651
	speed: 0.0092s/iter; left time: 161.3182s
	iters: 500, epoch: 1 | loss: 0.0234488
	speed: 0.0092s/iter; left time: 160.1950s
	iters: 600, epoch: 1 | loss: 0.0222586
	speed: 0.0092s/iter; left time: 159.5163s
	iters: 700, epoch: 1 | loss: 0.0220230
	speed: 0.0092s/iter; left time: 158.6204s
	iters: 800, epoch: 1 | loss: 0.0168002
	speed: 0.0092s/iter; left time: 157.5216s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.56s
Steps: 899 | Train Loss: 0.0272510 Vali Loss: 0.0147291 Test Loss: 0.0158004
Validation loss decreased (inf --> 0.014729).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0146216
	speed: 0.0416s/iter; left time: 706.6760s
	iters: 200, epoch: 2 | loss: 0.0145285
	speed: 0.0102s/iter; left time: 172.9955s
	iters: 300, epoch: 2 | loss: 0.0133755
	speed: 0.0102s/iter; left time: 172.0013s
	iters: 400, epoch: 2 | loss: 0.0155739
	speed: 0.0103s/iter; left time: 171.3744s
	iters: 500, epoch: 2 | loss: 0.0136027
	speed: 0.0102s/iter; left time: 169.2956s
	iters: 600, epoch: 2 | loss: 0.0109570
	speed: 0.0103s/iter; left time: 169.0518s
	iters: 700, epoch: 2 | loss: 0.0105813
	speed: 0.0102s/iter; left time: 167.6814s
	iters: 800, epoch: 2 | loss: 0.0133829
	speed: 0.0102s/iter; left time: 166.6730s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.41s
Steps: 899 | Train Loss: 0.0119088 Vali Loss: 0.0096034 Test Loss: 0.0108491
Validation loss decreased (0.014729 --> 0.009603).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0151471
	speed: 0.0419s/iter; left time: 673.7946s
	iters: 200, epoch: 3 | loss: 0.0111740
	speed: 0.0094s/iter; left time: 150.5970s
	iters: 300, epoch: 3 | loss: 0.0096942
	speed: 0.0094s/iter; left time: 149.3601s
	iters: 400, epoch: 3 | loss: 0.0102352
	speed: 0.0095s/iter; left time: 149.1990s
	iters: 500, epoch: 3 | loss: 0.0100074
	speed: 0.0094s/iter; left time: 147.7901s
	iters: 600, epoch: 3 | loss: 0.0110882
	speed: 0.0094s/iter; left time: 146.6421s
	iters: 700, epoch: 3 | loss: 0.0099761
	speed: 0.0094s/iter; left time: 145.9698s
	iters: 800, epoch: 3 | loss: 0.0114810
	speed: 0.0094s/iter; left time: 144.8150s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.70s
Steps: 899 | Train Loss: 0.0101256 Vali Loss: 0.0093043 Test Loss: 0.0105520
Validation loss decreased (0.009603 --> 0.009304).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0126124
	speed: 0.0423s/iter; left time: 642.0890s
	iters: 200, epoch: 4 | loss: 0.0092959
	speed: 0.0095s/iter; left time: 143.0038s
	iters: 300, epoch: 4 | loss: 0.0110300
	speed: 0.0095s/iter; left time: 141.9473s
	iters: 400, epoch: 4 | loss: 0.0075942
	speed: 0.0095s/iter; left time: 140.7349s
	iters: 500, epoch: 4 | loss: 0.0087605
	speed: 0.0095s/iter; left time: 139.8263s
	iters: 600, epoch: 4 | loss: 0.0119146
	speed: 0.0095s/iter; left time: 138.9141s
	iters: 700, epoch: 4 | loss: 0.0090441
	speed: 0.0095s/iter; left time: 137.8215s
	iters: 800, epoch: 4 | loss: 0.0100713
	speed: 0.0095s/iter; left time: 137.2768s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.80s
Steps: 899 | Train Loss: 0.0096276 Vali Loss: 0.0091371 Test Loss: 0.0103543
Validation loss decreased (0.009304 --> 0.009137).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0092584
	speed: 0.0416s/iter; left time: 594.3077s
	iters: 200, epoch: 5 | loss: 0.0076918
	speed: 0.0095s/iter; left time: 135.3035s
	iters: 300, epoch: 5 | loss: 0.0086921
	speed: 0.0094s/iter; left time: 132.6245s
	iters: 400, epoch: 5 | loss: 0.0075587
	speed: 0.0093s/iter; left time: 129.5732s
	iters: 500, epoch: 5 | loss: 0.0071826
	speed: 0.0093s/iter; left time: 128.5606s
	iters: 600, epoch: 5 | loss: 0.0092770
	speed: 0.0092s/iter; left time: 127.3279s
	iters: 700, epoch: 5 | loss: 0.0105744
	speed: 0.0094s/iter; left time: 129.2282s
	iters: 800, epoch: 5 | loss: 0.0088191
	speed: 0.0095s/iter; left time: 129.4043s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.70s
Steps: 899 | Train Loss: 0.0092682 Vali Loss: 0.0091192 Test Loss: 0.0103921
Validation loss decreased (0.009137 --> 0.009119).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0091213
	speed: 0.0422s/iter; left time: 565.1184s
	iters: 200, epoch: 6 | loss: 0.0089234
	speed: 0.0089s/iter; left time: 117.7008s
	iters: 300, epoch: 6 | loss: 0.0063323
	speed: 0.0088s/iter; left time: 116.4698s
	iters: 400, epoch: 6 | loss: 0.0086634
	speed: 0.0088s/iter; left time: 115.3737s
	iters: 500, epoch: 6 | loss: 0.0094096
	speed: 0.0088s/iter; left time: 114.4562s
	iters: 600, epoch: 6 | loss: 0.0072102
	speed: 0.0088s/iter; left time: 113.6146s
	iters: 700, epoch: 6 | loss: 0.0092353
	speed: 0.0088s/iter; left time: 113.0175s
	iters: 800, epoch: 6 | loss: 0.0080888
	speed: 0.0088s/iter; left time: 111.6651s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.23s
Steps: 899 | Train Loss: 0.0090314 Vali Loss: 0.0090171 Test Loss: 0.0101453
Validation loss decreased (0.009119 --> 0.009017).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0085121
	speed: 0.0421s/iter; left time: 525.6054s
	iters: 200, epoch: 7 | loss: 0.0089289
	speed: 0.0096s/iter; left time: 118.3099s
	iters: 300, epoch: 7 | loss: 0.0113468
	speed: 0.0095s/iter; left time: 117.3024s
	iters: 400, epoch: 7 | loss: 0.0106317
	speed: 0.0104s/iter; left time: 126.3214s
	iters: 500, epoch: 7 | loss: 0.0092540
	speed: 0.0105s/iter; left time: 126.4195s
	iters: 600, epoch: 7 | loss: 0.0110762
	speed: 0.0102s/iter; left time: 121.8603s
	iters: 700, epoch: 7 | loss: 0.0102775
	speed: 0.0105s/iter; left time: 125.3057s
	iters: 800, epoch: 7 | loss: 0.0087572
	speed: 0.0105s/iter; left time: 124.3000s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.34s
Steps: 899 | Train Loss: 0.0088528 Vali Loss: 0.0089632 Test Loss: 0.0101337
Validation loss decreased (0.009017 --> 0.008963).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0093254
	speed: 0.0424s/iter; left time: 490.9805s
	iters: 200, epoch: 8 | loss: 0.0068411
	speed: 0.0095s/iter; left time: 109.4577s
	iters: 300, epoch: 8 | loss: 0.0097055
	speed: 0.0094s/iter; left time: 106.7430s
	iters: 400, epoch: 8 | loss: 0.0128793
	speed: 0.0093s/iter; left time: 104.6036s
	iters: 500, epoch: 8 | loss: 0.0060271
	speed: 0.0099s/iter; left time: 110.8160s
	iters: 600, epoch: 8 | loss: 0.0104464
	speed: 0.0103s/iter; left time: 114.2917s
	iters: 700, epoch: 8 | loss: 0.0105392
	speed: 0.0092s/iter; left time: 101.6011s
	iters: 800, epoch: 8 | loss: 0.0105891
	speed: 0.0094s/iter; left time: 102.4786s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.87s
Steps: 899 | Train Loss: 0.0086577 Vali Loss: 0.0088969 Test Loss: 0.0102191
Validation loss decreased (0.008963 --> 0.008897).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0088366
	speed: 0.0423s/iter; left time: 451.7896s
	iters: 200, epoch: 9 | loss: 0.0075752
	speed: 0.0093s/iter; left time: 98.0714s
	iters: 300, epoch: 9 | loss: 0.0084537
	speed: 0.0093s/iter; left time: 97.5993s
	iters: 400, epoch: 9 | loss: 0.0092094
	speed: 0.0096s/iter; left time: 99.3772s
	iters: 500, epoch: 9 | loss: 0.0077626
	speed: 0.0096s/iter; left time: 98.8048s
	iters: 600, epoch: 9 | loss: 0.0064675
	speed: 0.0094s/iter; left time: 95.5858s
	iters: 700, epoch: 9 | loss: 0.0082963
	speed: 0.0092s/iter; left time: 93.2542s
	iters: 800, epoch: 9 | loss: 0.0077893
	speed: 0.0098s/iter; left time: 98.0966s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.68s
Steps: 899 | Train Loss: 0.0085119 Vali Loss: 0.0087606 Test Loss: 0.0101671
Validation loss decreased (0.008897 --> 0.008761).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0135799
	speed: 0.0416s/iter; left time: 407.0635s
	iters: 200, epoch: 10 | loss: 0.0058949
	speed: 0.0094s/iter; left time: 91.5534s
	iters: 300, epoch: 10 | loss: 0.0082264
	speed: 0.0094s/iter; left time: 90.5568s
	iters: 400, epoch: 10 | loss: 0.0071504
	speed: 0.0095s/iter; left time: 90.2198s
	iters: 500, epoch: 10 | loss: 0.0081966
	speed: 0.0095s/iter; left time: 89.1718s
	iters: 600, epoch: 10 | loss: 0.0093315
	speed: 0.0095s/iter; left time: 88.2847s
	iters: 700, epoch: 10 | loss: 0.0092644
	speed: 0.0095s/iter; left time: 87.5660s
	iters: 800, epoch: 10 | loss: 0.0059195
	speed: 0.0095s/iter; left time: 86.4486s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.78s
Steps: 899 | Train Loss: 0.0083808 Vali Loss: 0.0089173 Test Loss: 0.0100723
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0088349
	speed: 0.0417s/iter; left time: 370.4746s
	iters: 200, epoch: 11 | loss: 0.0063182
	speed: 0.0095s/iter; left time: 83.6608s
	iters: 300, epoch: 11 | loss: 0.0054283
	speed: 0.0095s/iter; left time: 82.5382s
	iters: 400, epoch: 11 | loss: 0.0071630
	speed: 0.0095s/iter; left time: 81.5287s
	iters: 500, epoch: 11 | loss: 0.0082714
	speed: 0.0095s/iter; left time: 80.5742s
	iters: 600, epoch: 11 | loss: 0.0093781
	speed: 0.0095s/iter; left time: 79.5577s
	iters: 700, epoch: 11 | loss: 0.0057505
	speed: 0.0095s/iter; left time: 79.0762s
	iters: 800, epoch: 11 | loss: 0.0074048
	speed: 0.0095s/iter; left time: 78.0777s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.78s
Steps: 899 | Train Loss: 0.0082523 Vali Loss: 0.0086974 Test Loss: 0.0101020
Validation loss decreased (0.008761 --> 0.008697).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0086718
	speed: 0.0415s/iter; left time: 331.7807s
	iters: 200, epoch: 12 | loss: 0.0062837
	speed: 0.0092s/iter; left time: 72.6445s
	iters: 300, epoch: 12 | loss: 0.0078317
	speed: 0.0092s/iter; left time: 71.7810s
	iters: 400, epoch: 12 | loss: 0.0099886
	speed: 0.0092s/iter; left time: 71.1287s
	iters: 500, epoch: 12 | loss: 0.0094134
	speed: 0.0092s/iter; left time: 69.9108s
	iters: 600, epoch: 12 | loss: 0.0063468
	speed: 0.0092s/iter; left time: 69.0611s
	iters: 700, epoch: 12 | loss: 0.0057591
	speed: 0.0092s/iter; left time: 68.0285s
	iters: 800, epoch: 12 | loss: 0.0092164
	speed: 0.0092s/iter; left time: 67.1196s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.51s
Steps: 899 | Train Loss: 0.0081688 Vali Loss: 0.0087948 Test Loss: 0.0101655
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0079934
	speed: 0.0421s/iter; left time: 298.6353s
	iters: 200, epoch: 13 | loss: 0.0071650
	speed: 0.0091s/iter; left time: 63.9298s
	iters: 300, epoch: 13 | loss: 0.0113882
	speed: 0.0091s/iter; left time: 62.9708s
	iters: 400, epoch: 13 | loss: 0.0083338
	speed: 0.0092s/iter; left time: 62.1578s
	iters: 500, epoch: 13 | loss: 0.0077826
	speed: 0.0091s/iter; left time: 61.2011s
	iters: 600, epoch: 13 | loss: 0.0079092
	speed: 0.0090s/iter; left time: 59.0495s
	iters: 700, epoch: 13 | loss: 0.0059979
	speed: 0.0089s/iter; left time: 58.0410s
	iters: 800, epoch: 13 | loss: 0.0081334
	speed: 0.0090s/iter; left time: 57.6630s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.42s
Steps: 899 | Train Loss: 0.0080797 Vali Loss: 0.0087895 Test Loss: 0.0101927
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0075320
	speed: 0.0424s/iter; left time: 262.9084s
	iters: 200, epoch: 14 | loss: 0.0061758
	speed: 0.0096s/iter; left time: 58.4884s
	iters: 300, epoch: 14 | loss: 0.0058848
	speed: 0.0098s/iter; left time: 58.5921s
	iters: 400, epoch: 14 | loss: 0.0056462
	speed: 0.0106s/iter; left time: 62.4435s
	iters: 500, epoch: 14 | loss: 0.0067110
	speed: 0.0105s/iter; left time: 60.8955s
	iters: 600, epoch: 14 | loss: 0.0097151
	speed: 0.0106s/iter; left time: 60.1175s
	iters: 700, epoch: 14 | loss: 0.0060353
	speed: 0.0104s/iter; left time: 58.3260s
	iters: 800, epoch: 14 | loss: 0.0074301
	speed: 0.0105s/iter; left time: 57.8346s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.49s
Steps: 899 | Train Loss: 0.0079805 Vali Loss: 0.0087329 Test Loss: 0.0101960
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0104310
	speed: 0.0435s/iter; left time: 230.1353s
	iters: 200, epoch: 15 | loss: 0.0087383
	speed: 0.0093s/iter; left time: 48.1885s
	iters: 300, epoch: 15 | loss: 0.0066411
	speed: 0.0093s/iter; left time: 47.5159s
	iters: 400, epoch: 15 | loss: 0.0062273
	speed: 0.0093s/iter; left time: 46.5449s
	iters: 500, epoch: 15 | loss: 0.0096768
	speed: 0.0093s/iter; left time: 45.3646s
	iters: 600, epoch: 15 | loss: 0.0085998
	speed: 0.0093s/iter; left time: 44.6399s
	iters: 700, epoch: 15 | loss: 0.0105915
	speed: 0.0093s/iter; left time: 43.4849s
	iters: 800, epoch: 15 | loss: 0.0076461
	speed: 0.0092s/iter; left time: 42.3814s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.58s
Steps: 899 | Train Loss: 0.0079334 Vali Loss: 0.0086786 Test Loss: 0.0101763
Validation loss decreased (0.008697 --> 0.008679).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0065256
	speed: 0.0426s/iter; left time: 187.3496s
	iters: 200, epoch: 16 | loss: 0.0079687
	speed: 0.0093s/iter; left time: 39.8431s
	iters: 300, epoch: 16 | loss: 0.0054691
	speed: 0.0093s/iter; left time: 39.0659s
	iters: 400, epoch: 16 | loss: 0.0058038
	speed: 0.0093s/iter; left time: 38.0946s
	iters: 500, epoch: 16 | loss: 0.0071522
	speed: 0.0093s/iter; left time: 37.1665s
	iters: 600, epoch: 16 | loss: 0.0065418
	speed: 0.0092s/iter; left time: 35.9231s
	iters: 700, epoch: 16 | loss: 0.0083437
	speed: 0.0093s/iter; left time: 35.1711s
	iters: 800, epoch: 16 | loss: 0.0060881
	speed: 0.0092s/iter; left time: 34.1633s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.66s
Steps: 899 | Train Loss: 0.0078319 Vali Loss: 0.0087790 Test Loss: 0.0102591
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0072123
	speed: 0.0416s/iter; left time: 145.3579s
	iters: 200, epoch: 17 | loss: 0.0093641
	speed: 0.0105s/iter; left time: 35.7865s
	iters: 300, epoch: 17 | loss: 0.0082678
	speed: 0.0105s/iter; left time: 34.7188s
	iters: 400, epoch: 17 | loss: 0.0073109
	speed: 0.0105s/iter; left time: 33.6737s
	iters: 500, epoch: 17 | loss: 0.0078265
	speed: 0.0105s/iter; left time: 32.6053s
	iters: 600, epoch: 17 | loss: 0.0062618
	speed: 0.0105s/iter; left time: 31.5704s
	iters: 700, epoch: 17 | loss: 0.0087713
	speed: 0.0105s/iter; left time: 30.4986s
	iters: 800, epoch: 17 | loss: 0.0082345
	speed: 0.0105s/iter; left time: 29.4619s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.72s
Steps: 899 | Train Loss: 0.0078189 Vali Loss: 0.0087418 Test Loss: 0.0102824
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0078857
	speed: 0.0426s/iter; left time: 110.7062s
	iters: 200, epoch: 18 | loss: 0.0081035
	speed: 0.0093s/iter; left time: 23.1671s
	iters: 300, epoch: 18 | loss: 0.0105089
	speed: 0.0093s/iter; left time: 22.2439s
	iters: 400, epoch: 18 | loss: 0.0091981
	speed: 0.0093s/iter; left time: 21.4298s
	iters: 500, epoch: 18 | loss: 0.0057106
	speed: 0.0093s/iter; left time: 20.3601s
	iters: 600, epoch: 18 | loss: 0.0059395
	speed: 0.0093s/iter; left time: 19.4442s
	iters: 700, epoch: 18 | loss: 0.0074403
	speed: 0.0093s/iter; left time: 18.5157s
	iters: 800, epoch: 18 | loss: 0.0073986
	speed: 0.0093s/iter; left time: 17.5853s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.57s
Steps: 899 | Train Loss: 0.0077683 Vali Loss: 0.0087517 Test Loss: 0.0102656
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0072900
	speed: 0.0410s/iter; left time: 69.6651s
	iters: 200, epoch: 19 | loss: 0.0064446
	speed: 0.0095s/iter; left time: 15.1297s
	iters: 300, epoch: 19 | loss: 0.0083038
	speed: 0.0095s/iter; left time: 14.2668s
	iters: 400, epoch: 19 | loss: 0.0090917
	speed: 0.0092s/iter; left time: 12.8647s
	iters: 500, epoch: 19 | loss: 0.0085713
	speed: 0.0092s/iter; left time: 11.9350s
	iters: 600, epoch: 19 | loss: 0.0081188
	speed: 0.0092s/iter; left time: 11.0090s
	iters: 700, epoch: 19 | loss: 0.0062718
	speed: 0.0091s/iter; left time: 10.0543s
	iters: 800, epoch: 19 | loss: 0.0058901
	speed: 0.0092s/iter; left time: 9.1435s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.59s
Steps: 899 | Train Loss: 0.0076955 Vali Loss: 0.0087305 Test Loss: 0.0102221
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0086147
	speed: 0.0409s/iter; left time: 32.7323s
	iters: 200, epoch: 20 | loss: 0.0081086
	speed: 0.0106s/iter; left time: 7.4145s
	iters: 300, epoch: 20 | loss: 0.0093738
	speed: 0.0106s/iter; left time: 6.3507s
	iters: 400, epoch: 20 | loss: 0.0053410
	speed: 0.0106s/iter; left time: 5.2944s
	iters: 500, epoch: 20 | loss: 0.0083254
	speed: 0.0106s/iter; left time: 4.2328s
	iters: 600, epoch: 20 | loss: 0.0076163
	speed: 0.0107s/iter; left time: 3.1954s
	iters: 700, epoch: 20 | loss: 0.0060676
	speed: 0.0105s/iter; left time: 2.1053s
	iters: 800, epoch: 20 | loss: 0.0058397
	speed: 0.0105s/iter; left time: 1.0539s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.69s
Steps: 899 | Train Loss: 0.0076554 Vali Loss: 0.0087764 Test Loss: 0.0102847
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010176287963986397, rmse:0.10087759047746658, mae:0.05809824913740158, rse:0.3812234401702881
Original data scale mse:1194382.0, rmse:1092.8778076171875, mae:695.2028198242188, rse:0.07679910212755203

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.010102159343659878, RMSE: 0.10050950199365616, MAE: 0.058577075600624084, RSE: 0.3798324465751648
Unscaled Metrics - MSE: 1228456.75, RMSE: 1108.357666015625, MAE: 708.9411010742188, RSE: 0.0778869092464447

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.010176287963986397, RMSE: 0.10087759047746658, MAE: 0.05809824913740158, RSE: 0.3812234401702881
Unscaled Metrics - MSE: 1194382.0, RMSE: 1092.8778076171875, MAE: 695.2028198242188, RSE: 0.07679910212755203

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_96_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=True, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=32, stride=16, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0480819
	speed: 0.0275s/iter; left time: 491.3573s
	iters: 200, epoch: 1 | loss: 0.0362830
	speed: 0.0103s/iter; left time: 182.9322s
	iters: 300, epoch: 1 | loss: 0.0315535
	speed: 0.0089s/iter; left time: 156.2572s
	iters: 400, epoch: 1 | loss: 0.0292785
	speed: 0.0087s/iter; left time: 152.9962s
	iters: 500, epoch: 1 | loss: 0.0285411
	speed: 0.0087s/iter; left time: 151.5378s
	iters: 600, epoch: 1 | loss: 0.0276110
	speed: 0.0087s/iter; left time: 151.6371s
	iters: 700, epoch: 1 | loss: 0.0258704
	speed: 0.0088s/iter; left time: 152.4710s
	iters: 800, epoch: 1 | loss: 0.0305075
	speed: 0.0088s/iter; left time: 151.5683s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.61s
Steps: 897 | Train Loss: 0.0331523 Vali Loss: 0.0207013 Test Loss: 0.0222523
Validation loss decreased (inf --> 0.020701).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0217432
	speed: 0.0414s/iter; left time: 701.9945s
	iters: 200, epoch: 2 | loss: 0.0179301
	speed: 0.0088s/iter; left time: 148.8399s
	iters: 300, epoch: 2 | loss: 0.0170268
	speed: 0.0088s/iter; left time: 147.6362s
	iters: 400, epoch: 2 | loss: 0.0191909
	speed: 0.0088s/iter; left time: 147.2785s
	iters: 500, epoch: 2 | loss: 0.0192400
	speed: 0.0088s/iter; left time: 145.7273s
	iters: 600, epoch: 2 | loss: 0.0160726
	speed: 0.0088s/iter; left time: 144.3248s
	iters: 700, epoch: 2 | loss: 0.0145650
	speed: 0.0088s/iter; left time: 143.5858s
	iters: 800, epoch: 2 | loss: 0.0174475
	speed: 0.0088s/iter; left time: 142.3306s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.15s
Steps: 897 | Train Loss: 0.0190503 Vali Loss: 0.0162434 Test Loss: 0.0181442
Validation loss decreased (0.020701 --> 0.016243).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0161745
	speed: 0.0427s/iter; left time: 685.1543s
	iters: 200, epoch: 3 | loss: 0.0176367
	speed: 0.0092s/iter; left time: 146.9499s
	iters: 300, epoch: 3 | loss: 0.0138046
	speed: 0.0091s/iter; left time: 144.7703s
	iters: 400, epoch: 3 | loss: 0.0173073
	speed: 0.0091s/iter; left time: 143.8204s
	iters: 500, epoch: 3 | loss: 0.0119053
	speed: 0.0091s/iter; left time: 142.6656s
	iters: 600, epoch: 3 | loss: 0.0220667
	speed: 0.0091s/iter; left time: 141.7377s
	iters: 700, epoch: 3 | loss: 0.0158816
	speed: 0.0090s/iter; left time: 139.1940s
	iters: 800, epoch: 3 | loss: 0.0164586
	speed: 0.0118s/iter; left time: 180.9855s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.80s
Steps: 897 | Train Loss: 0.0170688 Vali Loss: 0.0159528 Test Loss: 0.0180039
Validation loss decreased (0.016243 --> 0.015953).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0171233
	speed: 0.0900s/iter; left time: 1363.0327s
	iters: 200, epoch: 4 | loss: 0.0156178
	speed: 0.0498s/iter; left time: 749.7392s
	iters: 300, epoch: 4 | loss: 0.0169409
	speed: 0.0521s/iter; left time: 779.1950s
	iters: 400, epoch: 4 | loss: 0.0171706
	speed: 0.0542s/iter; left time: 804.9297s
	iters: 500, epoch: 4 | loss: 0.0143780
	speed: 0.0497s/iter; left time: 732.9856s
	iters: 600, epoch: 4 | loss: 0.0135960
	speed: 0.0538s/iter; left time: 788.2197s
	iters: 700, epoch: 4 | loss: 0.0199836
	speed: 0.0525s/iter; left time: 763.8794s
	iters: 800, epoch: 4 | loss: 0.0150730
	speed: 0.0544s/iter; left time: 786.6078s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:46.12s
Steps: 897 | Train Loss: 0.0163408 Vali Loss: 0.0158492 Test Loss: 0.0179081
Validation loss decreased (0.015953 --> 0.015849).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0148393
	speed: 0.2760s/iter; left time: 3933.2043s
	iters: 200, epoch: 5 | loss: 0.0134675
	speed: 0.0558s/iter; left time: 790.0952s
	iters: 300, epoch: 5 | loss: 0.0152228
	speed: 0.0371s/iter; left time: 521.6268s
	iters: 400, epoch: 5 | loss: 0.0186174
	speed: 0.0516s/iter; left time: 720.3276s
	iters: 500, epoch: 5 | loss: 0.0195296
	speed: 0.0213s/iter; left time: 294.4399s
	iters: 600, epoch: 5 | loss: 0.0132725
	speed: 0.0087s/iter; left time: 119.4261s
	iters: 700, epoch: 5 | loss: 0.0149563
	speed: 0.0087s/iter; left time: 118.3480s
	iters: 800, epoch: 5 | loss: 0.0227999
	speed: 0.0091s/iter; left time: 123.2519s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:29.44s
Steps: 897 | Train Loss: 0.0157050 Vali Loss: 0.0158709 Test Loss: 0.0176919
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0130483
	speed: 0.1645s/iter; left time: 2197.4457s
	iters: 200, epoch: 6 | loss: 0.0117471
	speed: 0.0152s/iter; left time: 200.9914s
	iters: 300, epoch: 6 | loss: 0.0142716
	speed: 0.0109s/iter; left time: 143.9957s
	iters: 400, epoch: 6 | loss: 0.0145453
	speed: 0.0109s/iter; left time: 142.6237s
	iters: 500, epoch: 6 | loss: 0.0137561
	speed: 0.0109s/iter; left time: 141.1981s
	iters: 600, epoch: 6 | loss: 0.0124844
	speed: 0.0108s/iter; left time: 138.6243s
	iters: 700, epoch: 6 | loss: 0.0170365
	speed: 0.0125s/iter; left time: 159.1142s
	iters: 800, epoch: 6 | loss: 0.0130612
	speed: 0.0110s/iter; left time: 139.5591s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:11.48s
Steps: 897 | Train Loss: 0.0151079 Vali Loss: 0.0157032 Test Loss: 0.0179839
Validation loss decreased (0.015849 --> 0.015703).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0160668
	speed: 0.0463s/iter; left time: 576.9540s
	iters: 200, epoch: 7 | loss: 0.0119003
	speed: 0.0098s/iter; left time: 120.7440s
	iters: 300, epoch: 7 | loss: 0.0127965
	speed: 0.0098s/iter; left time: 120.0372s
	iters: 400, epoch: 7 | loss: 0.0126611
	speed: 0.0098s/iter; left time: 118.5860s
	iters: 500, epoch: 7 | loss: 0.0116660
	speed: 0.0097s/iter; left time: 116.6078s
	iters: 600, epoch: 7 | loss: 0.0182375
	speed: 0.0096s/iter; left time: 115.3975s
	iters: 700, epoch: 7 | loss: 0.0159407
	speed: 0.0094s/iter; left time: 111.7545s
	iters: 800, epoch: 7 | loss: 0.0157776
	speed: 0.0105s/iter; left time: 123.5468s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.05s
Steps: 897 | Train Loss: 0.0145564 Vali Loss: 0.0159253 Test Loss: 0.0179471
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0121298
	speed: 0.0458s/iter; left time: 529.9480s
	iters: 200, epoch: 8 | loss: 0.0162395
	speed: 0.0093s/iter; left time: 106.5606s
	iters: 300, epoch: 8 | loss: 0.0159666
	speed: 0.0093s/iter; left time: 106.1706s
	iters: 400, epoch: 8 | loss: 0.0134115
	speed: 0.0093s/iter; left time: 105.2225s
	iters: 500, epoch: 8 | loss: 0.0114040
	speed: 0.0093s/iter; left time: 104.2379s
	iters: 600, epoch: 8 | loss: 0.0137805
	speed: 0.0093s/iter; left time: 103.2415s
	iters: 700, epoch: 8 | loss: 0.0127767
	speed: 0.0092s/iter; left time: 100.9049s
	iters: 800, epoch: 8 | loss: 0.0152400
	speed: 0.0090s/iter; left time: 97.9142s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.69s
Steps: 897 | Train Loss: 0.0140345 Vali Loss: 0.0160987 Test Loss: 0.0181461
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0173715
	speed: 0.0431s/iter; left time: 459.6796s
	iters: 200, epoch: 9 | loss: 0.0149977
	speed: 0.0089s/iter; left time: 93.7019s
	iters: 300, epoch: 9 | loss: 0.0160420
	speed: 0.0090s/iter; left time: 94.2017s
	iters: 400, epoch: 9 | loss: 0.0146751
	speed: 0.0089s/iter; left time: 91.9588s
	iters: 500, epoch: 9 | loss: 0.0129151
	speed: 0.0091s/iter; left time: 93.0507s
	iters: 600, epoch: 9 | loss: 0.0131759
	speed: 0.0089s/iter; left time: 90.1702s
	iters: 700, epoch: 9 | loss: 0.0143019
	speed: 0.0088s/iter; left time: 88.7496s
	iters: 800, epoch: 9 | loss: 0.0119004
	speed: 0.0089s/iter; left time: 88.6637s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.28s
Steps: 897 | Train Loss: 0.0135878 Vali Loss: 0.0161945 Test Loss: 0.0181078
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0092926
	speed: 0.0423s/iter; left time: 413.3110s
	iters: 200, epoch: 10 | loss: 0.0131013
	speed: 0.0090s/iter; left time: 86.7615s
	iters: 300, epoch: 10 | loss: 0.0118378
	speed: 0.0089s/iter; left time: 85.4108s
	iters: 400, epoch: 10 | loss: 0.0158355
	speed: 0.0089s/iter; left time: 84.5768s
	iters: 500, epoch: 10 | loss: 0.0167850
	speed: 0.0089s/iter; left time: 83.0322s
	iters: 600, epoch: 10 | loss: 0.0136658
	speed: 0.0088s/iter; left time: 81.5060s
	iters: 700, epoch: 10 | loss: 0.0122833
	speed: 0.0088s/iter; left time: 80.6243s
	iters: 800, epoch: 10 | loss: 0.0133440
	speed: 0.0089s/iter; left time: 81.1103s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.23s
Steps: 897 | Train Loss: 0.0132292 Vali Loss: 0.0161405 Test Loss: 0.0185001
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0129231
	speed: 0.0418s/iter; left time: 371.1035s
	iters: 200, epoch: 11 | loss: 0.0146973
	speed: 0.0089s/iter; left time: 77.6717s
	iters: 300, epoch: 11 | loss: 0.0131006
	speed: 0.0089s/iter; left time: 76.8547s
	iters: 400, epoch: 11 | loss: 0.0115173
	speed: 0.0088s/iter; left time: 75.7968s
	iters: 500, epoch: 11 | loss: 0.0137676
	speed: 0.0088s/iter; left time: 74.7928s
	iters: 600, epoch: 11 | loss: 0.0102560
	speed: 0.0088s/iter; left time: 73.8745s
	iters: 700, epoch: 11 | loss: 0.0157796
	speed: 0.0088s/iter; left time: 72.9592s
	iters: 800, epoch: 11 | loss: 0.0110692
	speed: 0.0089s/iter; left time: 72.4153s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.19s
Steps: 897 | Train Loss: 0.0128675 Vali Loss: 0.0162930 Test Loss: 0.0184875
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.017983945086598396, rmse:0.13410423696041107, mae:0.08237696439027786, rse:0.507062554359436
Original data scale mse:2541549.75, rmse:1594.223876953125, mae:1034.8856201171875, rse:0.11219204217195511
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0450891
	speed: 0.0117s/iter; left time: 209.1547s
	iters: 200, epoch: 1 | loss: 0.0345827
	speed: 0.0087s/iter; left time: 155.0492s
	iters: 300, epoch: 1 | loss: 0.0323829
	speed: 0.0088s/iter; left time: 155.0005s
	iters: 400, epoch: 1 | loss: 0.0277660
	speed: 0.0089s/iter; left time: 156.5261s
	iters: 500, epoch: 1 | loss: 0.0283018
	speed: 0.0089s/iter; left time: 155.6148s
	iters: 600, epoch: 1 | loss: 0.0254839
	speed: 0.0090s/iter; left time: 156.4678s
	iters: 700, epoch: 1 | loss: 0.0243137
	speed: 0.0090s/iter; left time: 154.8210s
	iters: 800, epoch: 1 | loss: 0.0281626
	speed: 0.0090s/iter; left time: 153.8388s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.32s
Steps: 897 | Train Loss: 0.0329252 Vali Loss: 0.0206755 Test Loss: 0.0222118
Validation loss decreased (inf --> 0.020675).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0226247
	speed: 0.0419s/iter; left time: 710.3888s
	iters: 200, epoch: 2 | loss: 0.0199644
	speed: 0.0108s/iter; left time: 181.3387s
	iters: 300, epoch: 2 | loss: 0.0184773
	speed: 0.0092s/iter; left time: 153.2777s
	iters: 400, epoch: 2 | loss: 0.0166526
	speed: 0.0086s/iter; left time: 143.1417s
	iters: 500, epoch: 2 | loss: 0.0183695
	speed: 0.0086s/iter; left time: 142.0752s
	iters: 600, epoch: 2 | loss: 0.0179139
	speed: 0.0086s/iter; left time: 142.0700s
	iters: 700, epoch: 2 | loss: 0.0193893
	speed: 0.0087s/iter; left time: 142.4137s
	iters: 800, epoch: 2 | loss: 0.0173843
	speed: 0.0088s/iter; left time: 143.1046s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.33s
Steps: 897 | Train Loss: 0.0190774 Vali Loss: 0.0161624 Test Loss: 0.0180929
Validation loss decreased (0.020675 --> 0.016162).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0147038
	speed: 0.0411s/iter; left time: 659.2189s
	iters: 200, epoch: 3 | loss: 0.0169889
	speed: 0.0087s/iter; left time: 139.1169s
	iters: 300, epoch: 3 | loss: 0.0175021
	speed: 0.0088s/iter; left time: 139.0862s
	iters: 400, epoch: 3 | loss: 0.0194638
	speed: 0.0088s/iter; left time: 138.0947s
	iters: 500, epoch: 3 | loss: 0.0162734
	speed: 0.0087s/iter; left time: 136.7661s
	iters: 600, epoch: 3 | loss: 0.0163567
	speed: 0.0087s/iter; left time: 135.7765s
	iters: 700, epoch: 3 | loss: 0.0152641
	speed: 0.0087s/iter; left time: 134.6201s
	iters: 800, epoch: 3 | loss: 0.0171647
	speed: 0.0094s/iter; left time: 144.1947s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.23s
Steps: 897 | Train Loss: 0.0170700 Vali Loss: 0.0159039 Test Loss: 0.0179473
Validation loss decreased (0.016162 --> 0.015904).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0159425
	speed: 0.0437s/iter; left time: 662.5970s
	iters: 200, epoch: 4 | loss: 0.0142012
	speed: 0.0096s/iter; left time: 144.9094s
	iters: 300, epoch: 4 | loss: 0.0152940
	speed: 0.0096s/iter; left time: 144.0841s
	iters: 400, epoch: 4 | loss: 0.0212515
	speed: 0.0097s/iter; left time: 143.9973s
	iters: 500, epoch: 4 | loss: 0.0170630
	speed: 0.0096s/iter; left time: 141.6995s
	iters: 600, epoch: 4 | loss: 0.0173444
	speed: 0.0096s/iter; left time: 140.9463s
	iters: 700, epoch: 4 | loss: 0.0146621
	speed: 0.0096s/iter; left time: 139.9088s
	iters: 800, epoch: 4 | loss: 0.0157213
	speed: 0.0096s/iter; left time: 139.0594s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.91s
Steps: 897 | Train Loss: 0.0163680 Vali Loss: 0.0160033 Test Loss: 0.0179127
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0172270
	speed: 0.0433s/iter; left time: 616.5495s
	iters: 200, epoch: 5 | loss: 0.0168974
	speed: 0.0093s/iter; left time: 131.0331s
	iters: 300, epoch: 5 | loss: 0.0129067
	speed: 0.0087s/iter; left time: 121.9842s
	iters: 400, epoch: 5 | loss: 0.0159158
	speed: 0.0085s/iter; left time: 119.1770s
	iters: 500, epoch: 5 | loss: 0.0138109
	speed: 0.0086s/iter; left time: 118.6105s
	iters: 600, epoch: 5 | loss: 0.0163441
	speed: 0.0085s/iter; left time: 117.2657s
	iters: 700, epoch: 5 | loss: 0.0148638
	speed: 0.0085s/iter; left time: 116.2694s
	iters: 800, epoch: 5 | loss: 0.0188415
	speed: 0.0085s/iter; left time: 115.7168s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.11s
Steps: 897 | Train Loss: 0.0157356 Vali Loss: 0.0160282 Test Loss: 0.0178841
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0200365
	speed: 0.0420s/iter; left time: 560.2914s
	iters: 200, epoch: 6 | loss: 0.0158138
	speed: 0.0089s/iter; left time: 117.7498s
	iters: 300, epoch: 6 | loss: 0.0148582
	speed: 0.0089s/iter; left time: 117.4083s
	iters: 400, epoch: 6 | loss: 0.0158861
	speed: 0.0090s/iter; left time: 117.2901s
	iters: 500, epoch: 6 | loss: 0.0149286
	speed: 0.0090s/iter; left time: 116.1792s
	iters: 600, epoch: 6 | loss: 0.0137950
	speed: 0.0090s/iter; left time: 115.4496s
	iters: 700, epoch: 6 | loss: 0.0143760
	speed: 0.0090s/iter; left time: 114.4833s
	iters: 800, epoch: 6 | loss: 0.0142915
	speed: 0.0088s/iter; left time: 111.6458s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.32s
Steps: 897 | Train Loss: 0.0151137 Vali Loss: 0.0160323 Test Loss: 0.0180576
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0172263
	speed: 0.0404s/iter; left time: 503.4448s
	iters: 200, epoch: 7 | loss: 0.0168404
	speed: 0.0089s/iter; left time: 110.5886s
	iters: 300, epoch: 7 | loss: 0.0121220
	speed: 0.0087s/iter; left time: 106.7836s
	iters: 400, epoch: 7 | loss: 0.0139303
	speed: 0.0087s/iter; left time: 105.5661s
	iters: 500, epoch: 7 | loss: 0.0164427
	speed: 0.0087s/iter; left time: 105.1906s
	iters: 600, epoch: 7 | loss: 0.0134344
	speed: 0.0088s/iter; left time: 105.6475s
	iters: 700, epoch: 7 | loss: 0.0161934
	speed: 0.0088s/iter; left time: 104.2741s
	iters: 800, epoch: 7 | loss: 0.0131848
	speed: 0.0085s/iter; left time: 100.1178s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.06s
Steps: 897 | Train Loss: 0.0145334 Vali Loss: 0.0160245 Test Loss: 0.0183425
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0133886
	speed: 0.0426s/iter; left time: 493.0859s
	iters: 200, epoch: 8 | loss: 0.0135026
	speed: 0.0086s/iter; left time: 98.1945s
	iters: 300, epoch: 8 | loss: 0.0135307
	speed: 0.0086s/iter; left time: 97.8003s
	iters: 400, epoch: 8 | loss: 0.0137472
	speed: 0.0086s/iter; left time: 96.5089s
	iters: 500, epoch: 8 | loss: 0.0135483
	speed: 0.0086s/iter; left time: 95.5556s
	iters: 600, epoch: 8 | loss: 0.0133925
	speed: 0.0086s/iter; left time: 95.0921s
	iters: 700, epoch: 8 | loss: 0.0126067
	speed: 0.0085s/iter; left time: 93.6967s
	iters: 800, epoch: 8 | loss: 0.0152205
	speed: 0.0086s/iter; left time: 93.0619s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.15s
Steps: 897 | Train Loss: 0.0139899 Vali Loss: 0.0162143 Test Loss: 0.0183185
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.017947325482964516, rmse:0.13396762311458588, mae:0.08385661989450455, rse:0.5065460205078125
Original data scale mse:2719271.75, rmse:1649.021484375, mae:1078.899658203125, rse:0.11604836583137512

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.017983945086598396, RMSE: 0.13410423696041107, MAE: 0.08237696439027786, RSE: 0.507062554359436
Unscaled Metrics - MSE: 2541549.75, RMSE: 1594.223876953125, MAE: 1034.8856201171875, RSE: 0.11219204217195511

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.017947325482964516, RMSE: 0.13396762311458588, MAE: 0.08385661989450455, RSE: 0.5065460205078125
Unscaled Metrics - MSE: 2719271.75, RMSE: 1649.021484375, MAE: 1078.899658203125, RSE: 0.11604836583137512

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_168_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=True, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=32, stride=16, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0464109
	speed: 0.0277s/iter; left time: 492.7364s
	iters: 200, epoch: 1 | loss: 0.0361887
	speed: 0.0089s/iter; left time: 156.7800s
	iters: 300, epoch: 1 | loss: 0.0343387
	speed: 0.0088s/iter; left time: 155.2361s
	iters: 400, epoch: 1 | loss: 0.0295457
	speed: 0.0087s/iter; left time: 152.7960s
	iters: 500, epoch: 1 | loss: 0.0309987
	speed: 0.0088s/iter; left time: 152.7815s
	iters: 600, epoch: 1 | loss: 0.0257509
	speed: 0.0087s/iter; left time: 149.9417s
	iters: 700, epoch: 1 | loss: 0.0252158
	speed: 0.0086s/iter; left time: 147.5200s
	iters: 800, epoch: 1 | loss: 0.0247644
	speed: 0.0087s/iter; left time: 148.0845s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.36s
Steps: 894 | Train Loss: 0.0341034 Vali Loss: 0.0218626 Test Loss: 0.0231702
Validation loss decreased (inf --> 0.021863).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0213781
	speed: 0.0403s/iter; left time: 681.1238s
	iters: 200, epoch: 2 | loss: 0.0229823
	speed: 0.0089s/iter; left time: 150.1208s
	iters: 300, epoch: 2 | loss: 0.0217995
	speed: 0.0089s/iter; left time: 148.0204s
	iters: 400, epoch: 2 | loss: 0.0241468
	speed: 0.0089s/iter; left time: 147.1776s
	iters: 500, epoch: 2 | loss: 0.0215835
	speed: 0.0089s/iter; left time: 146.0444s
	iters: 600, epoch: 2 | loss: 0.0231235
	speed: 0.0089s/iter; left time: 146.2252s
	iters: 700, epoch: 2 | loss: 0.0215747
	speed: 0.0089s/iter; left time: 144.8765s
	iters: 800, epoch: 2 | loss: 0.0203265
	speed: 0.0089s/iter; left time: 144.5782s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.19s
Steps: 894 | Train Loss: 0.0204705 Vali Loss: 0.0177452 Test Loss: 0.0193972
Validation loss decreased (0.021863 --> 0.017745).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0217652
	speed: 0.0424s/iter; left time: 677.4394s
	iters: 200, epoch: 3 | loss: 0.0194095
	speed: 0.0090s/iter; left time: 143.1674s
	iters: 300, epoch: 3 | loss: 0.0175746
	speed: 0.0089s/iter; left time: 140.8764s
	iters: 400, epoch: 3 | loss: 0.0207958
	speed: 0.0090s/iter; left time: 140.8579s
	iters: 500, epoch: 3 | loss: 0.0155851
	speed: 0.0088s/iter; left time: 137.1843s
	iters: 600, epoch: 3 | loss: 0.0203213
	speed: 0.0087s/iter; left time: 135.5339s
	iters: 700, epoch: 3 | loss: 0.0200264
	speed: 0.0087s/iter; left time: 134.6821s
	iters: 800, epoch: 3 | loss: 0.0200003
	speed: 0.0087s/iter; left time: 133.5265s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.20s
Steps: 894 | Train Loss: 0.0183968 Vali Loss: 0.0177684 Test Loss: 0.0196724
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0200898
	speed: 0.0403s/iter; left time: 608.6204s
	iters: 200, epoch: 4 | loss: 0.0161771
	speed: 0.0089s/iter; left time: 133.6013s
	iters: 300, epoch: 4 | loss: 0.0173720
	speed: 0.0090s/iter; left time: 133.7451s
	iters: 400, epoch: 4 | loss: 0.0169685
	speed: 0.0090s/iter; left time: 133.0459s
	iters: 500, epoch: 4 | loss: 0.0172904
	speed: 0.0089s/iter; left time: 131.4530s
	iters: 600, epoch: 4 | loss: 0.0161756
	speed: 0.0089s/iter; left time: 129.9651s
	iters: 700, epoch: 4 | loss: 0.0185437
	speed: 0.0089s/iter; left time: 128.8177s
	iters: 800, epoch: 4 | loss: 0.0146089
	speed: 0.0089s/iter; left time: 127.7051s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.19s
Steps: 894 | Train Loss: 0.0176809 Vali Loss: 0.0178539 Test Loss: 0.0198191
EarlyStopping counter: 2 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0156661
	speed: 0.0415s/iter; left time: 589.1632s
	iters: 200, epoch: 5 | loss: 0.0163235
	speed: 0.0092s/iter; left time: 129.7623s
	iters: 300, epoch: 5 | loss: 0.0193586
	speed: 0.0088s/iter; left time: 122.6863s
	iters: 400, epoch: 5 | loss: 0.0187044
	speed: 0.0087s/iter; left time: 120.8750s
	iters: 500, epoch: 5 | loss: 0.0162523
	speed: 0.0087s/iter; left time: 120.1062s
	iters: 600, epoch: 5 | loss: 0.0182531
	speed: 0.0087s/iter; left time: 118.5810s
	iters: 700, epoch: 5 | loss: 0.0155543
	speed: 0.0087s/iter; left time: 118.6178s
	iters: 800, epoch: 5 | loss: 0.0175914
	speed: 0.0089s/iter; left time: 120.3742s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.13s
Steps: 894 | Train Loss: 0.0169059 Vali Loss: 0.0176183 Test Loss: 0.0199724
Validation loss decreased (0.017745 --> 0.017618).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0175742
	speed: 0.0411s/iter; left time: 546.8505s
	iters: 200, epoch: 6 | loss: 0.0142634
	speed: 0.0089s/iter; left time: 117.2011s
	iters: 300, epoch: 6 | loss: 0.0165513
	speed: 0.0087s/iter; left time: 113.5848s
	iters: 400, epoch: 6 | loss: 0.0173183
	speed: 0.0086s/iter; left time: 112.5204s
	iters: 500, epoch: 6 | loss: 0.0160514
	speed: 0.0087s/iter; left time: 112.7438s
	iters: 600, epoch: 6 | loss: 0.0165171
	speed: 0.0089s/iter; left time: 114.5812s
	iters: 700, epoch: 6 | loss: 0.0193715
	speed: 0.0090s/iter; left time: 114.1268s
	iters: 800, epoch: 6 | loss: 0.0140052
	speed: 0.0089s/iter; left time: 112.6558s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.12s
Steps: 894 | Train Loss: 0.0160879 Vali Loss: 0.0178874 Test Loss: 0.0198355
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0160109
	speed: 0.0409s/iter; left time: 508.2394s
	iters: 200, epoch: 7 | loss: 0.0138987
	speed: 0.0089s/iter; left time: 109.0519s
	iters: 300, epoch: 7 | loss: 0.0149317
	speed: 0.0088s/iter; left time: 107.3534s
	iters: 400, epoch: 7 | loss: 0.0161886
	speed: 0.0089s/iter; left time: 107.3796s
	iters: 500, epoch: 7 | loss: 0.0162232
	speed: 0.0089s/iter; left time: 106.4874s
	iters: 600, epoch: 7 | loss: 0.0153939
	speed: 0.0088s/iter; left time: 105.4355s
	iters: 700, epoch: 7 | loss: 0.0146930
	speed: 0.0088s/iter; left time: 104.2483s
	iters: 800, epoch: 7 | loss: 0.0138359
	speed: 0.0088s/iter; left time: 103.4005s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.16s
Steps: 894 | Train Loss: 0.0154088 Vali Loss: 0.0183227 Test Loss: 0.0203692
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0133051
	speed: 0.0413s/iter; left time: 475.7703s
	iters: 200, epoch: 8 | loss: 0.0129502
	speed: 0.0089s/iter; left time: 101.9713s
	iters: 300, epoch: 8 | loss: 0.0146181
	speed: 0.0091s/iter; left time: 103.0711s
	iters: 400, epoch: 8 | loss: 0.0130213
	speed: 0.0091s/iter; left time: 101.9775s
	iters: 500, epoch: 8 | loss: 0.0128742
	speed: 0.0091s/iter; left time: 101.4418s
	iters: 600, epoch: 8 | loss: 0.0118887
	speed: 0.0088s/iter; left time: 97.2824s
	iters: 700, epoch: 8 | loss: 0.0175533
	speed: 0.0088s/iter; left time: 96.1720s
	iters: 800, epoch: 8 | loss: 0.0144295
	speed: 0.0088s/iter; left time: 95.6671s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.26s
Steps: 894 | Train Loss: 0.0147680 Vali Loss: 0.0181558 Test Loss: 0.0203611
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0139277
	speed: 0.0409s/iter; left time: 434.4147s
	iters: 200, epoch: 9 | loss: 0.0155986
	speed: 0.0088s/iter; left time: 92.8762s
	iters: 300, epoch: 9 | loss: 0.0143357
	speed: 0.0089s/iter; left time: 92.5098s
	iters: 400, epoch: 9 | loss: 0.0142286
	speed: 0.0089s/iter; left time: 91.5763s
	iters: 500, epoch: 9 | loss: 0.0147045
	speed: 0.0089s/iter; left time: 90.6954s
	iters: 600, epoch: 9 | loss: 0.0139572
	speed: 0.0089s/iter; left time: 89.9991s
	iters: 700, epoch: 9 | loss: 0.0132338
	speed: 0.0089s/iter; left time: 88.8330s
	iters: 800, epoch: 9 | loss: 0.0156314
	speed: 0.0088s/iter; left time: 87.3719s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.16s
Steps: 894 | Train Loss: 0.0142309 Vali Loss: 0.0181225 Test Loss: 0.0205804
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0135922
	speed: 0.0404s/iter; left time: 392.8107s
	iters: 200, epoch: 10 | loss: 0.0134005
	speed: 0.0093s/iter; left time: 89.9166s
	iters: 300, epoch: 10 | loss: 0.0134395
	speed: 0.0089s/iter; left time: 84.8716s
	iters: 400, epoch: 10 | loss: 0.0139479
	speed: 0.0089s/iter; left time: 84.0119s
	iters: 500, epoch: 10 | loss: 0.0152775
	speed: 0.0088s/iter; left time: 81.6837s
	iters: 600, epoch: 10 | loss: 0.0158018
	speed: 0.0087s/iter; left time: 80.5087s
	iters: 700, epoch: 10 | loss: 0.0131601
	speed: 0.0087s/iter; left time: 79.6992s
	iters: 800, epoch: 10 | loss: 0.0124908
	speed: 0.0087s/iter; left time: 79.0553s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.21s
Steps: 894 | Train Loss: 0.0138248 Vali Loss: 0.0181022 Test Loss: 0.0208994
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.019972413778305054, rmse:0.14132378995418549, mae:0.08907762914896011, rse:0.5347296595573425
Original data scale mse:3073615.0, rmse:1753.1728515625, mae:1146.7259521484375, rse:0.12349379807710648
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0476475
	speed: 0.0112s/iter; left time: 199.4457s
	iters: 200, epoch: 1 | loss: 0.0353168
	speed: 0.0088s/iter; left time: 154.9746s
	iters: 300, epoch: 1 | loss: 0.0336166
	speed: 0.0088s/iter; left time: 155.4199s
	iters: 400, epoch: 1 | loss: 0.0286101
	speed: 0.0088s/iter; left time: 154.4248s
	iters: 500, epoch: 1 | loss: 0.0287010
	speed: 0.0088s/iter; left time: 153.1217s
	iters: 600, epoch: 1 | loss: 0.0234822
	speed: 0.0088s/iter; left time: 152.0421s
	iters: 700, epoch: 1 | loss: 0.0252475
	speed: 0.0088s/iter; left time: 151.5435s
	iters: 800, epoch: 1 | loss: 0.0278688
	speed: 0.0088s/iter; left time: 150.7334s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.15s
Steps: 894 | Train Loss: 0.0341514 Vali Loss: 0.0218443 Test Loss: 0.0231164
Validation loss decreased (inf --> 0.021844).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0196658
	speed: 0.0417s/iter; left time: 703.6035s
	iters: 200, epoch: 2 | loss: 0.0216820
	speed: 0.0086s/iter; left time: 143.8045s
	iters: 300, epoch: 2 | loss: 0.0186834
	speed: 0.0086s/iter; left time: 143.0306s
	iters: 400, epoch: 2 | loss: 0.0186434
	speed: 0.0086s/iter; left time: 142.2665s
	iters: 500, epoch: 2 | loss: 0.0198819
	speed: 0.0086s/iter; left time: 141.4285s
	iters: 600, epoch: 2 | loss: 0.0180211
	speed: 0.0085s/iter; left time: 139.7137s
	iters: 700, epoch: 2 | loss: 0.0177283
	speed: 0.0085s/iter; left time: 138.8582s
	iters: 800, epoch: 2 | loss: 0.0199662
	speed: 0.0085s/iter; left time: 137.8482s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.93s
Steps: 894 | Train Loss: 0.0204194 Vali Loss: 0.0177787 Test Loss: 0.0194635
Validation loss decreased (0.021844 --> 0.017779).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0180503
	speed: 0.0407s/iter; left time: 651.1203s
	iters: 200, epoch: 3 | loss: 0.0183010
	speed: 0.0086s/iter; left time: 137.1963s
	iters: 300, epoch: 3 | loss: 0.0161728
	speed: 0.0086s/iter; left time: 135.9308s
	iters: 400, epoch: 3 | loss: 0.0186620
	speed: 0.0086s/iter; left time: 134.9564s
	iters: 500, epoch: 3 | loss: 0.0207137
	speed: 0.0086s/iter; left time: 134.3688s
	iters: 600, epoch: 3 | loss: 0.0160185
	speed: 0.0086s/iter; left time: 133.3823s
	iters: 700, epoch: 3 | loss: 0.0187472
	speed: 0.0086s/iter; left time: 132.4836s
	iters: 800, epoch: 3 | loss: 0.0167963
	speed: 0.0086s/iter; left time: 131.6041s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.94s
Steps: 894 | Train Loss: 0.0184302 Vali Loss: 0.0175141 Test Loss: 0.0192542
Validation loss decreased (0.017779 --> 0.017514).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0167841
	speed: 0.0409s/iter; left time: 617.3275s
	iters: 200, epoch: 4 | loss: 0.0157090
	speed: 0.0087s/iter; left time: 130.8159s
	iters: 300, epoch: 4 | loss: 0.0174456
	speed: 0.0087s/iter; left time: 129.9569s
	iters: 400, epoch: 4 | loss: 0.0184882
	speed: 0.0087s/iter; left time: 129.1310s
	iters: 500, epoch: 4 | loss: 0.0190038
	speed: 0.0087s/iter; left time: 128.1782s
	iters: 600, epoch: 4 | loss: 0.0170864
	speed: 0.0087s/iter; left time: 127.2865s
	iters: 700, epoch: 4 | loss: 0.0181732
	speed: 0.0087s/iter; left time: 126.3618s
	iters: 800, epoch: 4 | loss: 0.0186235
	speed: 0.0087s/iter; left time: 125.5868s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.05s
Steps: 894 | Train Loss: 0.0176733 Vali Loss: 0.0176610 Test Loss: 0.0194707
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0163475
	speed: 0.0414s/iter; left time: 587.9654s
	iters: 200, epoch: 5 | loss: 0.0189672
	speed: 0.0107s/iter; left time: 151.5236s
	iters: 300, epoch: 5 | loss: 0.0149858
	speed: 0.0107s/iter; left time: 150.2011s
	iters: 400, epoch: 5 | loss: 0.0175440
	speed: 0.0117s/iter; left time: 162.0772s
	iters: 500, epoch: 5 | loss: 0.0170268
	speed: 0.0110s/iter; left time: 151.9509s
	iters: 600, epoch: 5 | loss: 0.0163057
	speed: 0.0104s/iter; left time: 142.9159s
	iters: 700, epoch: 5 | loss: 0.0194585
	speed: 0.0088s/iter; left time: 119.3028s
	iters: 800, epoch: 5 | loss: 0.0160460
	speed: 0.0086s/iter; left time: 116.0473s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.23s
Steps: 894 | Train Loss: 0.0169103 Vali Loss: 0.0177129 Test Loss: 0.0197661
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0141891
	speed: 0.3007s/iter; left time: 4002.3865s
	iters: 200, epoch: 6 | loss: 0.0162251
	speed: 0.0564s/iter; left time: 745.0309s
	iters: 300, epoch: 6 | loss: 0.0157704
	speed: 0.0607s/iter; left time: 795.2126s
	iters: 400, epoch: 6 | loss: 0.0151298
	speed: 0.0641s/iter; left time: 834.4598s
	iters: 500, epoch: 6 | loss: 0.0187187
	speed: 0.0562s/iter; left time: 725.5061s
	iters: 600, epoch: 6 | loss: 0.0162756
	speed: 0.0564s/iter; left time: 723.0110s
	iters: 700, epoch: 6 | loss: 0.0141140
	speed: 0.0610s/iter; left time: 774.9239s
	iters: 800, epoch: 6 | loss: 0.0155050
	speed: 0.0592s/iter; left time: 746.9615s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:53.76s
Steps: 894 | Train Loss: 0.0161332 Vali Loss: 0.0178571 Test Loss: 0.0200594
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0206745
	speed: 0.3705s/iter; left time: 4600.3529s
	iters: 200, epoch: 7 | loss: 0.0140124
	speed: 0.0251s/iter; left time: 308.5993s
	iters: 300, epoch: 7 | loss: 0.0165640
	speed: 0.0241s/iter; left time: 294.3329s
	iters: 400, epoch: 7 | loss: 0.0169174
	speed: 0.0174s/iter; left time: 211.2021s
	iters: 500, epoch: 7 | loss: 0.0178628
	speed: 0.0130s/iter; left time: 156.1049s
	iters: 600, epoch: 7 | loss: 0.0161473
	speed: 0.0140s/iter; left time: 166.9741s
	iters: 700, epoch: 7 | loss: 0.0153554
	speed: 0.0124s/iter; left time: 147.0322s
	iters: 800, epoch: 7 | loss: 0.0145232
	speed: 0.0119s/iter; left time: 138.8858s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:20.16s
Steps: 894 | Train Loss: 0.0154271 Vali Loss: 0.0179674 Test Loss: 0.0200687
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0151093
	speed: 0.0491s/iter; left time: 566.1019s
	iters: 200, epoch: 8 | loss: 0.0158965
	speed: 0.0111s/iter; left time: 126.8270s
	iters: 300, epoch: 8 | loss: 0.0125743
	speed: 0.0105s/iter; left time: 119.4308s
	iters: 400, epoch: 8 | loss: 0.0132885
	speed: 0.0106s/iter; left time: 119.2348s
	iters: 500, epoch: 8 | loss: 0.0135163
	speed: 0.0111s/iter; left time: 123.4719s
	iters: 600, epoch: 8 | loss: 0.0144448
	speed: 0.0105s/iter; left time: 115.8526s
	iters: 700, epoch: 8 | loss: 0.0142335
	speed: 0.0103s/iter; left time: 112.6054s
	iters: 800, epoch: 8 | loss: 0.0141695
	speed: 0.0101s/iter; left time: 108.7945s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.71s
Steps: 894 | Train Loss: 0.0148187 Vali Loss: 0.0176302 Test Loss: 0.0206967
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.019254181534051895, rmse:0.13875943422317505, mae:0.08878102153539658, rse:0.5250269174575806
Original data scale mse:3200891.75, rmse:1789.1036376953125, mae:1168.5704345703125, rse:0.1260247677564621

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.019972413778305054, RMSE: 0.14132378995418549, MAE: 0.08907762914896011, RSE: 0.5347296595573425
Unscaled Metrics - MSE: 3073615.0, RMSE: 1753.1728515625, MAE: 1146.7259521484375, RSE: 0.12349379807710648

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.019254181534051895, RMSE: 0.13875943422317505, MAE: 0.08878102153539658, RSE: 0.5250269174575806
Unscaled Metrics - MSE: 3200891.75, RMSE: 1789.1036376953125, MAE: 1168.5704345703125, RSE: 0.1260247677564621

=== Starting experiments for loss function: MAE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_24_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=True, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=32, stride=16, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1596882
	speed: 0.0276s/iter; left time: 492.9573s
	iters: 200, epoch: 1 | loss: 0.1480528
	speed: 0.0095s/iter; left time: 169.2743s
	iters: 300, epoch: 1 | loss: 0.1244475
	speed: 0.0095s/iter; left time: 167.5301s
	iters: 400, epoch: 1 | loss: 0.1153396
	speed: 0.0095s/iter; left time: 166.2342s
	iters: 500, epoch: 1 | loss: 0.1062054
	speed: 0.0095s/iter; left time: 165.7057s
	iters: 600, epoch: 1 | loss: 0.1072750
	speed: 0.0095s/iter; left time: 164.6815s
	iters: 700, epoch: 1 | loss: 0.0895273
	speed: 0.0098s/iter; left time: 169.2425s
	iters: 800, epoch: 1 | loss: 0.0949725
	speed: 0.0096s/iter; left time: 165.6397s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.15s
Steps: 899 | Train Loss: 0.1228012 Vali Loss: 0.0835051 Test Loss: 0.0854919
Validation loss decreased (inf --> 0.083505).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0771087
	speed: 0.0439s/iter; left time: 745.1576s
	iters: 200, epoch: 2 | loss: 0.0724524
	speed: 0.0094s/iter; left time: 159.2037s
	iters: 300, epoch: 2 | loss: 0.0695473
	speed: 0.0094s/iter; left time: 158.2605s
	iters: 400, epoch: 2 | loss: 0.0678229
	speed: 0.0094s/iter; left time: 157.2702s
	iters: 500, epoch: 2 | loss: 0.0671075
	speed: 0.0094s/iter; left time: 155.4060s
	iters: 600, epoch: 2 | loss: 0.0624708
	speed: 0.0094s/iter; left time: 154.7599s
	iters: 700, epoch: 2 | loss: 0.0720696
	speed: 0.0092s/iter; left time: 150.6038s
	iters: 800, epoch: 2 | loss: 0.0668519
	speed: 0.0091s/iter; left time: 148.7252s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.64s
Steps: 899 | Train Loss: 0.0700868 Vali Loss: 0.0602332 Test Loss: 0.0632078
Validation loss decreased (0.083505 --> 0.060233).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0632783
	speed: 0.0420s/iter; left time: 676.1068s
	iters: 200, epoch: 3 | loss: 0.0543382
	speed: 0.0091s/iter; left time: 146.2396s
	iters: 300, epoch: 3 | loss: 0.0682738
	speed: 0.0091s/iter; left time: 144.8194s
	iters: 400, epoch: 3 | loss: 0.0608454
	speed: 0.0091s/iter; left time: 144.0051s
	iters: 500, epoch: 3 | loss: 0.0632823
	speed: 0.0091s/iter; left time: 143.2296s
	iters: 600, epoch: 3 | loss: 0.0650469
	speed: 0.0091s/iter; left time: 142.2985s
	iters: 700, epoch: 3 | loss: 0.0604427
	speed: 0.0091s/iter; left time: 140.9777s
	iters: 800, epoch: 3 | loss: 0.0713355
	speed: 0.0091s/iter; left time: 140.0901s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.43s
Steps: 899 | Train Loss: 0.0623138 Vali Loss: 0.0578068 Test Loss: 0.0607190
Validation loss decreased (0.060233 --> 0.057807).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0542518
	speed: 0.0408s/iter; left time: 619.1890s
	iters: 200, epoch: 4 | loss: 0.0539534
	speed: 0.0090s/iter; left time: 135.1951s
	iters: 300, epoch: 4 | loss: 0.0597318
	speed: 0.0093s/iter; left time: 138.7751s
	iters: 400, epoch: 4 | loss: 0.0583438
	speed: 0.0092s/iter; left time: 136.7228s
	iters: 500, epoch: 4 | loss: 0.0622107
	speed: 0.0092s/iter; left time: 135.6295s
	iters: 600, epoch: 4 | loss: 0.0584910
	speed: 0.0092s/iter; left time: 134.6604s
	iters: 700, epoch: 4 | loss: 0.0629396
	speed: 0.0092s/iter; left time: 134.1790s
	iters: 800, epoch: 4 | loss: 0.0507901
	speed: 0.0092s/iter; left time: 133.4931s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.44s
Steps: 899 | Train Loss: 0.0599338 Vali Loss: 0.0571941 Test Loss: 0.0600071
Validation loss decreased (0.057807 --> 0.057194).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0577396
	speed: 0.0408s/iter; left time: 582.4813s
	iters: 200, epoch: 5 | loss: 0.0526518
	speed: 0.0091s/iter; left time: 128.8447s
	iters: 300, epoch: 5 | loss: 0.0575566
	speed: 0.0091s/iter; left time: 127.7334s
	iters: 400, epoch: 5 | loss: 0.0648565
	speed: 0.0091s/iter; left time: 126.9642s
	iters: 500, epoch: 5 | loss: 0.0580186
	speed: 0.0091s/iter; left time: 126.2247s
	iters: 600, epoch: 5 | loss: 0.0636809
	speed: 0.0091s/iter; left time: 125.2010s
	iters: 700, epoch: 5 | loss: 0.0545535
	speed: 0.0091s/iter; left time: 124.1300s
	iters: 800, epoch: 5 | loss: 0.0576502
	speed: 0.0091s/iter; left time: 123.1877s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.36s
Steps: 899 | Train Loss: 0.0582501 Vali Loss: 0.0563178 Test Loss: 0.0594213
Validation loss decreased (0.057194 --> 0.056318).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0516586
	speed: 0.0405s/iter; left time: 542.4418s
	iters: 200, epoch: 6 | loss: 0.0592145
	speed: 0.0090s/iter; left time: 119.3966s
	iters: 300, epoch: 6 | loss: 0.0515455
	speed: 0.0090s/iter; left time: 118.8146s
	iters: 400, epoch: 6 | loss: 0.0557425
	speed: 0.0090s/iter; left time: 118.1610s
	iters: 500, epoch: 6 | loss: 0.0512938
	speed: 0.0091s/iter; left time: 117.5367s
	iters: 600, epoch: 6 | loss: 0.0554240
	speed: 0.0090s/iter; left time: 116.5467s
	iters: 700, epoch: 6 | loss: 0.0582196
	speed: 0.0091s/iter; left time: 116.8762s
	iters: 800, epoch: 6 | loss: 0.0544360
	speed: 0.0092s/iter; left time: 116.8144s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.39s
Steps: 899 | Train Loss: 0.0570848 Vali Loss: 0.0556235 Test Loss: 0.0586439
Validation loss decreased (0.056318 --> 0.055623).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0557189
	speed: 0.0411s/iter; left time: 512.8450s
	iters: 200, epoch: 7 | loss: 0.0487706
	speed: 0.0092s/iter; left time: 114.2747s
	iters: 300, epoch: 7 | loss: 0.0639746
	speed: 0.0092s/iter; left time: 112.8013s
	iters: 400, epoch: 7 | loss: 0.0511835
	speed: 0.0092s/iter; left time: 111.6856s
	iters: 500, epoch: 7 | loss: 0.0612859
	speed: 0.0091s/iter; left time: 110.5635s
	iters: 600, epoch: 7 | loss: 0.0594616
	speed: 0.0092s/iter; left time: 110.4732s
	iters: 700, epoch: 7 | loss: 0.0516715
	speed: 0.0092s/iter; left time: 109.7257s
	iters: 800, epoch: 7 | loss: 0.0551329
	speed: 0.0092s/iter; left time: 108.4535s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.50s
Steps: 899 | Train Loss: 0.0562256 Vali Loss: 0.0549759 Test Loss: 0.0576836
Validation loss decreased (0.055623 --> 0.054976).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0570538
	speed: 0.0419s/iter; left time: 486.0159s
	iters: 200, epoch: 8 | loss: 0.0581737
	speed: 0.0089s/iter; left time: 102.6024s
	iters: 300, epoch: 8 | loss: 0.0517250
	speed: 0.0089s/iter; left time: 101.8206s
	iters: 400, epoch: 8 | loss: 0.0550893
	speed: 0.0090s/iter; left time: 101.2041s
	iters: 500, epoch: 8 | loss: 0.0625874
	speed: 0.0089s/iter; left time: 100.0856s
	iters: 600, epoch: 8 | loss: 0.0555443
	speed: 0.0089s/iter; left time: 98.4324s
	iters: 700, epoch: 8 | loss: 0.0589106
	speed: 0.0088s/iter; left time: 97.0487s
	iters: 800, epoch: 8 | loss: 0.0575689
	speed: 0.0089s/iter; left time: 96.8035s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.36s
Steps: 899 | Train Loss: 0.0555218 Vali Loss: 0.0547100 Test Loss: 0.0574701
Validation loss decreased (0.054976 --> 0.054710).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0523969
	speed: 0.0412s/iter; left time: 440.1248s
	iters: 200, epoch: 9 | loss: 0.0563124
	speed: 0.0092s/iter; left time: 97.2979s
	iters: 300, epoch: 9 | loss: 0.0594130
	speed: 0.0089s/iter; left time: 93.3048s
	iters: 400, epoch: 9 | loss: 0.0585686
	speed: 0.0089s/iter; left time: 92.1816s
	iters: 500, epoch: 9 | loss: 0.0552204
	speed: 0.0089s/iter; left time: 91.4541s
	iters: 600, epoch: 9 | loss: 0.0577851
	speed: 0.0089s/iter; left time: 90.8949s
	iters: 700, epoch: 9 | loss: 0.0509638
	speed: 0.0089s/iter; left time: 90.1516s
	iters: 800, epoch: 9 | loss: 0.0646937
	speed: 0.0089s/iter; left time: 88.8270s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.27s
Steps: 899 | Train Loss: 0.0549944 Vali Loss: 0.0545730 Test Loss: 0.0571759
Validation loss decreased (0.054710 --> 0.054573).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0479186
	speed: 0.0406s/iter; left time: 397.4154s
	iters: 200, epoch: 10 | loss: 0.0584009
	speed: 0.0090s/iter; left time: 87.6546s
	iters: 300, epoch: 10 | loss: 0.0547627
	speed: 0.0091s/iter; left time: 87.2875s
	iters: 400, epoch: 10 | loss: 0.0581041
	speed: 0.0091s/iter; left time: 86.3198s
	iters: 500, epoch: 10 | loss: 0.0571440
	speed: 0.0099s/iter; left time: 92.8669s
	iters: 600, epoch: 10 | loss: 0.0494682
	speed: 0.0086s/iter; left time: 79.4435s
	iters: 700, epoch: 10 | loss: 0.0559517
	speed: 0.0085s/iter; left time: 78.5543s
	iters: 800, epoch: 10 | loss: 0.0546077
	speed: 0.0086s/iter; left time: 78.0304s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.28s
Steps: 899 | Train Loss: 0.0544858 Vali Loss: 0.0544532 Test Loss: 0.0572022
Validation loss decreased (0.054573 --> 0.054453).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0519248
	speed: 0.0388s/iter; left time: 345.3507s
	iters: 200, epoch: 11 | loss: 0.0537792
	speed: 0.0084s/iter; left time: 73.4146s
	iters: 300, epoch: 11 | loss: 0.0478312
	speed: 0.0083s/iter; left time: 72.4946s
	iters: 400, epoch: 11 | loss: 0.0571694
	speed: 0.0083s/iter; left time: 71.6980s
	iters: 500, epoch: 11 | loss: 0.0507893
	speed: 0.0085s/iter; left time: 71.7657s
	iters: 600, epoch: 11 | loss: 0.0504851
	speed: 0.0085s/iter; left time: 71.5089s
	iters: 700, epoch: 11 | loss: 0.0511787
	speed: 0.0085s/iter; left time: 70.8066s
	iters: 800, epoch: 11 | loss: 0.0534274
	speed: 0.0087s/iter; left time: 70.9198s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.88s
Steps: 899 | Train Loss: 0.0541340 Vali Loss: 0.0541357 Test Loss: 0.0571457
Validation loss decreased (0.054453 --> 0.054136).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0574521
	speed: 0.0388s/iter; left time: 309.9598s
	iters: 200, epoch: 12 | loss: 0.0558659
	speed: 0.0084s/iter; left time: 66.4518s
	iters: 300, epoch: 12 | loss: 0.0573510
	speed: 0.0084s/iter; left time: 65.1104s
	iters: 400, epoch: 12 | loss: 0.0516572
	speed: 0.0084s/iter; left time: 64.8034s
	iters: 500, epoch: 12 | loss: 0.0567859
	speed: 0.0084s/iter; left time: 63.5369s
	iters: 600, epoch: 12 | loss: 0.0591141
	speed: 0.0084s/iter; left time: 63.2798s
	iters: 700, epoch: 12 | loss: 0.0558623
	speed: 0.0084s/iter; left time: 62.3837s
	iters: 800, epoch: 12 | loss: 0.0543269
	speed: 0.0085s/iter; left time: 61.9603s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.81s
Steps: 899 | Train Loss: 0.0538796 Vali Loss: 0.0541165 Test Loss: 0.0571606
Validation loss decreased (0.054136 --> 0.054117).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0542878
	speed: 0.0382s/iter; left time: 270.8705s
	iters: 200, epoch: 13 | loss: 0.0577589
	speed: 0.0085s/iter; left time: 59.3456s
	iters: 300, epoch: 13 | loss: 0.0486305
	speed: 0.0083s/iter; left time: 57.4891s
	iters: 400, epoch: 13 | loss: 0.0558641
	speed: 0.0083s/iter; left time: 56.6083s
	iters: 500, epoch: 13 | loss: 0.0629549
	speed: 0.0084s/iter; left time: 55.9629s
	iters: 600, epoch: 13 | loss: 0.0490997
	speed: 0.0084s/iter; left time: 55.1776s
	iters: 700, epoch: 13 | loss: 0.0580531
	speed: 0.0084s/iter; left time: 54.3333s
	iters: 800, epoch: 13 | loss: 0.0676423
	speed: 0.0084s/iter; left time: 53.4920s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.76s
Steps: 899 | Train Loss: 0.0535000 Vali Loss: 0.0537869 Test Loss: 0.0567287
Validation loss decreased (0.054117 --> 0.053787).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0645191
	speed: 0.0378s/iter; left time: 234.1666s
	iters: 200, epoch: 14 | loss: 0.0520353
	speed: 0.0086s/iter; left time: 52.2270s
	iters: 300, epoch: 14 | loss: 0.0545467
	speed: 0.0085s/iter; left time: 51.2452s
	iters: 400, epoch: 14 | loss: 0.0575039
	speed: 0.0084s/iter; left time: 49.4045s
	iters: 500, epoch: 14 | loss: 0.0579991
	speed: 0.0083s/iter; left time: 47.9887s
	iters: 600, epoch: 14 | loss: 0.0688793
	speed: 0.0083s/iter; left time: 47.2213s
	iters: 700, epoch: 14 | loss: 0.0530366
	speed: 0.0083s/iter; left time: 46.3348s
	iters: 800, epoch: 14 | loss: 0.0523812
	speed: 0.0083s/iter; left time: 45.4926s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.75s
Steps: 899 | Train Loss: 0.0532519 Vali Loss: 0.0537448 Test Loss: 0.0571274
Validation loss decreased (0.053787 --> 0.053745).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0584337
	speed: 0.0370s/iter; left time: 195.7275s
	iters: 200, epoch: 15 | loss: 0.0513506
	speed: 0.0084s/iter; left time: 43.6632s
	iters: 300, epoch: 15 | loss: 0.0491538
	speed: 0.0086s/iter; left time: 43.7975s
	iters: 400, epoch: 15 | loss: 0.0567566
	speed: 0.0086s/iter; left time: 42.9963s
	iters: 500, epoch: 15 | loss: 0.0473421
	speed: 0.0086s/iter; left time: 41.8857s
	iters: 600, epoch: 15 | loss: 0.0538072
	speed: 0.0084s/iter; left time: 40.1678s
	iters: 700, epoch: 15 | loss: 0.0546977
	speed: 0.0084s/iter; left time: 39.3129s
	iters: 800, epoch: 15 | loss: 0.0462549
	speed: 0.0083s/iter; left time: 38.2639s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.78s
Steps: 899 | Train Loss: 0.0530578 Vali Loss: 0.0537195 Test Loss: 0.0568474
Validation loss decreased (0.053745 --> 0.053719).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0617786
	speed: 0.0385s/iter; left time: 169.2370s
	iters: 200, epoch: 16 | loss: 0.0557882
	speed: 0.0087s/iter; left time: 37.1897s
	iters: 300, epoch: 16 | loss: 0.0473020
	speed: 0.0086s/iter; left time: 36.2524s
	iters: 400, epoch: 16 | loss: 0.0536726
	speed: 0.0085s/iter; left time: 34.7356s
	iters: 500, epoch: 16 | loss: 0.0541505
	speed: 0.0085s/iter; left time: 33.7783s
	iters: 600, epoch: 16 | loss: 0.0463154
	speed: 0.0085s/iter; left time: 33.1462s
	iters: 700, epoch: 16 | loss: 0.0553716
	speed: 0.0087s/iter; left time: 32.9031s
	iters: 800, epoch: 16 | loss: 0.0584276
	speed: 0.0086s/iter; left time: 31.9155s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.94s
Steps: 899 | Train Loss: 0.0529189 Vali Loss: 0.0536368 Test Loss: 0.0566040
Validation loss decreased (0.053719 --> 0.053637).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0547384
	speed: 0.0383s/iter; left time: 133.9173s
	iters: 200, epoch: 17 | loss: 0.0576708
	speed: 0.0084s/iter; left time: 28.6310s
	iters: 300, epoch: 17 | loss: 0.0505483
	speed: 0.0084s/iter; left time: 27.7938s
	iters: 400, epoch: 17 | loss: 0.0616068
	speed: 0.0084s/iter; left time: 26.9025s
	iters: 500, epoch: 17 | loss: 0.0569936
	speed: 0.0084s/iter; left time: 26.0552s
	iters: 600, epoch: 17 | loss: 0.0641668
	speed: 0.0084s/iter; left time: 25.2723s
	iters: 700, epoch: 17 | loss: 0.0420515
	speed: 0.0084s/iter; left time: 24.3700s
	iters: 800, epoch: 17 | loss: 0.0535091
	speed: 0.0084s/iter; left time: 23.6212s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.80s
Steps: 899 | Train Loss: 0.0527151 Vali Loss: 0.0536366 Test Loss: 0.0564831
Validation loss decreased (0.053637 --> 0.053637).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0530321
	speed: 0.0377s/iter; left time: 97.9678s
	iters: 200, epoch: 18 | loss: 0.0623911
	speed: 0.0084s/iter; left time: 20.9154s
	iters: 300, epoch: 18 | loss: 0.0529954
	speed: 0.0084s/iter; left time: 20.0763s
	iters: 400, epoch: 18 | loss: 0.0495064
	speed: 0.0083s/iter; left time: 19.1764s
	iters: 500, epoch: 18 | loss: 0.0456642
	speed: 0.0083s/iter; left time: 18.1863s
	iters: 600, epoch: 18 | loss: 0.0582533
	speed: 0.0083s/iter; left time: 17.4002s
	iters: 700, epoch: 18 | loss: 0.0561704
	speed: 0.0084s/iter; left time: 16.7265s
	iters: 800, epoch: 18 | loss: 0.0557511
	speed: 0.0084s/iter; left time: 15.8612s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.73s
Steps: 899 | Train Loss: 0.0526160 Vali Loss: 0.0534474 Test Loss: 0.0565230
Validation loss decreased (0.053637 --> 0.053447).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0524720
	speed: 0.0384s/iter; left time: 65.2654s
	iters: 200, epoch: 19 | loss: 0.0431766
	speed: 0.0084s/iter; left time: 13.3995s
	iters: 300, epoch: 19 | loss: 0.0505582
	speed: 0.0084s/iter; left time: 12.5901s
	iters: 400, epoch: 19 | loss: 0.0463088
	speed: 0.0084s/iter; left time: 11.7201s
	iters: 500, epoch: 19 | loss: 0.0525645
	speed: 0.0084s/iter; left time: 10.8957s
	iters: 600, epoch: 19 | loss: 0.0438015
	speed: 0.0084s/iter; left time: 10.0373s
	iters: 700, epoch: 19 | loss: 0.0544649
	speed: 0.0084s/iter; left time: 9.1983s
	iters: 800, epoch: 19 | loss: 0.0455427
	speed: 0.0084s/iter; left time: 8.3569s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.72s
Steps: 899 | Train Loss: 0.0523823 Vali Loss: 0.0534442 Test Loss: 0.0564228
Validation loss decreased (0.053447 --> 0.053444).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0484122
	speed: 0.0382s/iter; left time: 30.5348s
	iters: 200, epoch: 20 | loss: 0.0524424
	speed: 0.0084s/iter; left time: 5.8468s
	iters: 300, epoch: 20 | loss: 0.0511368
	speed: 0.0083s/iter; left time: 5.0031s
	iters: 400, epoch: 20 | loss: 0.0497488
	speed: 0.0085s/iter; left time: 4.2684s
	iters: 500, epoch: 20 | loss: 0.0522895
	speed: 0.0100s/iter; left time: 3.9884s
	iters: 600, epoch: 20 | loss: 0.0440005
	speed: 0.0087s/iter; left time: 2.6050s
	iters: 700, epoch: 20 | loss: 0.0503353
	speed: 0.0086s/iter; left time: 1.7149s
	iters: 800, epoch: 20 | loss: 0.0477799
	speed: 0.0087s/iter; left time: 0.8726s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.03s
Steps: 899 | Train Loss: 0.0522676 Vali Loss: 0.0532872 Test Loss: 0.0564348
Validation loss decreased (0.053444 --> 0.053287).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010154441930353642, rmse:0.10076925158500671, mae:0.05643478408455849, rse:0.3808140456676483
Original data scale mse:1136971.75, rmse:1066.288818359375, mae:656.8383178710938, rse:0.07493062317371368
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1745970
	speed: 0.0104s/iter; left time: 186.4351s
	iters: 200, epoch: 1 | loss: 0.1362362
	speed: 0.0084s/iter; left time: 148.5118s
	iters: 300, epoch: 1 | loss: 0.1243619
	speed: 0.0084s/iter; left time: 147.8588s
	iters: 400, epoch: 1 | loss: 0.1100698
	speed: 0.0084s/iter; left time: 147.4566s
	iters: 500, epoch: 1 | loss: 0.1008721
	speed: 0.0084s/iter; left time: 146.0869s
	iters: 600, epoch: 1 | loss: 0.1135284
	speed: 0.0084s/iter; left time: 145.3980s
	iters: 700, epoch: 1 | loss: 0.1039621
	speed: 0.0084s/iter; left time: 144.7048s
	iters: 800, epoch: 1 | loss: 0.1017329
	speed: 0.0084s/iter; left time: 143.6238s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.75s
Steps: 899 | Train Loss: 0.1233603 Vali Loss: 0.0836807 Test Loss: 0.0860414
Validation loss decreased (inf --> 0.083681).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0868273
	speed: 0.0408s/iter; left time: 692.8041s
	iters: 200, epoch: 2 | loss: 0.0712103
	speed: 0.0091s/iter; left time: 153.7168s
	iters: 300, epoch: 2 | loss: 0.0712725
	speed: 0.0093s/iter; left time: 156.2240s
	iters: 400, epoch: 2 | loss: 0.0675616
	speed: 0.0092s/iter; left time: 152.7202s
	iters: 500, epoch: 2 | loss: 0.0643040
	speed: 0.0110s/iter; left time: 182.3521s
	iters: 600, epoch: 2 | loss: 0.0745573
	speed: 0.0098s/iter; left time: 161.0711s
	iters: 700, epoch: 2 | loss: 0.0648972
	speed: 0.0091s/iter; left time: 148.4574s
	iters: 800, epoch: 2 | loss: 0.0661041
	speed: 0.0087s/iter; left time: 141.1002s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.66s
Steps: 899 | Train Loss: 0.0698801 Vali Loss: 0.0597775 Test Loss: 0.0622853
Validation loss decreased (0.083681 --> 0.059777).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0607562
	speed: 0.0438s/iter; left time: 703.6558s
	iters: 200, epoch: 3 | loss: 0.0573382
	speed: 0.0086s/iter; left time: 138.1900s
	iters: 300, epoch: 3 | loss: 0.0584049
	speed: 0.0108s/iter; left time: 171.7731s
	iters: 400, epoch: 3 | loss: 0.0591877
	speed: 0.0089s/iter; left time: 139.9777s
	iters: 500, epoch: 3 | loss: 0.0543827
	speed: 0.0088s/iter; left time: 137.5784s
	iters: 600, epoch: 3 | loss: 0.0601249
	speed: 0.0087s/iter; left time: 135.5947s
	iters: 700, epoch: 3 | loss: 0.0627699
	speed: 0.0087s/iter; left time: 134.3587s
	iters: 800, epoch: 3 | loss: 0.0568044
	speed: 0.0086s/iter; left time: 133.0123s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.52s
Steps: 899 | Train Loss: 0.0620550 Vali Loss: 0.0578717 Test Loss: 0.0602620
Validation loss decreased (0.059777 --> 0.057872).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0641706
	speed: 0.0412s/iter; left time: 625.9534s
	iters: 200, epoch: 4 | loss: 0.0586254
	speed: 0.0093s/iter; left time: 139.5757s
	iters: 300, epoch: 4 | loss: 0.0489829
	speed: 0.0094s/iter; left time: 140.1822s
	iters: 400, epoch: 4 | loss: 0.0579348
	speed: 0.0091s/iter; left time: 135.0908s
	iters: 500, epoch: 4 | loss: 0.0610140
	speed: 0.0095s/iter; left time: 140.4025s
	iters: 600, epoch: 4 | loss: 0.0539877
	speed: 0.0090s/iter; left time: 132.4561s
	iters: 700, epoch: 4 | loss: 0.0545742
	speed: 0.0098s/iter; left time: 142.8837s
	iters: 800, epoch: 4 | loss: 0.0555878
	speed: 0.0090s/iter; left time: 130.2680s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.66s
Steps: 899 | Train Loss: 0.0596278 Vali Loss: 0.0571546 Test Loss: 0.0598173
Validation loss decreased (0.057872 --> 0.057155).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0564064
	speed: 0.0411s/iter; left time: 586.7144s
	iters: 200, epoch: 5 | loss: 0.0553008
	speed: 0.0089s/iter; left time: 126.1006s
	iters: 300, epoch: 5 | loss: 0.0659276
	speed: 0.0084s/iter; left time: 118.9034s
	iters: 400, epoch: 5 | loss: 0.0601190
	speed: 0.0085s/iter; left time: 118.4001s
	iters: 500, epoch: 5 | loss: 0.0584490
	speed: 0.0085s/iter; left time: 118.1191s
	iters: 600, epoch: 5 | loss: 0.0600764
	speed: 0.0085s/iter; left time: 117.1912s
	iters: 700, epoch: 5 | loss: 0.0576137
	speed: 0.0088s/iter; left time: 120.0677s
	iters: 800, epoch: 5 | loss: 0.0565569
	speed: 0.0094s/iter; left time: 127.8133s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.17s
Steps: 899 | Train Loss: 0.0580023 Vali Loss: 0.0559461 Test Loss: 0.0585377
Validation loss decreased (0.057155 --> 0.055946).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0562517
	speed: 0.0405s/iter; left time: 541.6449s
	iters: 200, epoch: 6 | loss: 0.0498216
	speed: 0.0088s/iter; left time: 116.3510s
	iters: 300, epoch: 6 | loss: 0.0574807
	speed: 0.0088s/iter; left time: 116.1985s
	iters: 400, epoch: 6 | loss: 0.0638005
	speed: 0.0087s/iter; left time: 113.5635s
	iters: 500, epoch: 6 | loss: 0.0499901
	speed: 0.0087s/iter; left time: 112.5767s
	iters: 600, epoch: 6 | loss: 0.0641989
	speed: 0.0087s/iter; left time: 111.8037s
	iters: 700, epoch: 6 | loss: 0.0626553
	speed: 0.0088s/iter; left time: 112.8708s
	iters: 800, epoch: 6 | loss: 0.0624837
	speed: 0.0094s/iter; left time: 119.3812s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.15s
Steps: 899 | Train Loss: 0.0568271 Vali Loss: 0.0555891 Test Loss: 0.0586004
Validation loss decreased (0.055946 --> 0.055589).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0601121
	speed: 0.0403s/iter; left time: 503.4359s
	iters: 200, epoch: 7 | loss: 0.0570995
	speed: 0.0088s/iter; left time: 109.4838s
	iters: 300, epoch: 7 | loss: 0.0614301
	speed: 0.0090s/iter; left time: 110.4370s
	iters: 400, epoch: 7 | loss: 0.0584103
	speed: 0.0089s/iter; left time: 108.5102s
	iters: 500, epoch: 7 | loss: 0.0564767
	speed: 0.0088s/iter; left time: 106.8386s
	iters: 600, epoch: 7 | loss: 0.0495751
	speed: 0.0089s/iter; left time: 106.4244s
	iters: 700, epoch: 7 | loss: 0.0525894
	speed: 0.0087s/iter; left time: 102.8907s
	iters: 800, epoch: 7 | loss: 0.0567591
	speed: 0.0086s/iter; left time: 101.1191s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.13s
Steps: 899 | Train Loss: 0.0560630 Vali Loss: 0.0547386 Test Loss: 0.0575288
Validation loss decreased (0.055589 --> 0.054739).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0680977
	speed: 0.0400s/iter; left time: 463.1704s
	iters: 200, epoch: 8 | loss: 0.0493637
	speed: 0.0088s/iter; left time: 100.6398s
	iters: 300, epoch: 8 | loss: 0.0544681
	speed: 0.0088s/iter; left time: 99.7568s
	iters: 400, epoch: 8 | loss: 0.0527861
	speed: 0.0084s/iter; left time: 94.9367s
	iters: 500, epoch: 8 | loss: 0.0531571
	speed: 0.0087s/iter; left time: 97.6051s
	iters: 600, epoch: 8 | loss: 0.0526033
	speed: 0.0089s/iter; left time: 98.8484s
	iters: 700, epoch: 8 | loss: 0.0581967
	speed: 0.0089s/iter; left time: 97.4796s
	iters: 800, epoch: 8 | loss: 0.0510311
	speed: 0.0088s/iter; left time: 95.9610s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.10s
Steps: 899 | Train Loss: 0.0554074 Vali Loss: 0.0549750 Test Loss: 0.0576825
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0563632
	speed: 0.0394s/iter; left time: 421.5725s
	iters: 200, epoch: 9 | loss: 0.0524686
	speed: 0.0086s/iter; left time: 91.5816s
	iters: 300, epoch: 9 | loss: 0.0457147
	speed: 0.0085s/iter; left time: 89.5753s
	iters: 400, epoch: 9 | loss: 0.0526936
	speed: 0.0085s/iter; left time: 87.8622s
	iters: 500, epoch: 9 | loss: 0.0509271
	speed: 0.0090s/iter; left time: 92.6031s
	iters: 600, epoch: 9 | loss: 0.0567733
	speed: 0.0087s/iter; left time: 88.5409s
	iters: 700, epoch: 9 | loss: 0.0473347
	speed: 0.0085s/iter; left time: 85.4429s
	iters: 800, epoch: 9 | loss: 0.0538500
	speed: 0.0085s/iter; left time: 84.7845s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.28s
Steps: 899 | Train Loss: 0.0548278 Vali Loss: 0.0545451 Test Loss: 0.0572658
Validation loss decreased (0.054739 --> 0.054545).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0553836
	speed: 0.0455s/iter; left time: 445.5684s
	iters: 200, epoch: 10 | loss: 0.0484717
	speed: 0.0093s/iter; left time: 90.1236s
	iters: 300, epoch: 10 | loss: 0.0535518
	speed: 0.0103s/iter; left time: 98.4076s
	iters: 400, epoch: 10 | loss: 0.0618981
	speed: 0.0086s/iter; left time: 81.7802s
	iters: 500, epoch: 10 | loss: 0.0558849
	speed: 0.0108s/iter; left time: 100.9597s
	iters: 600, epoch: 10 | loss: 0.0494470
	speed: 0.0086s/iter; left time: 80.3477s
	iters: 700, epoch: 10 | loss: 0.0487612
	speed: 0.0087s/iter; left time: 79.5363s
	iters: 800, epoch: 10 | loss: 0.0580632
	speed: 0.0087s/iter; left time: 79.0321s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.71s
Steps: 899 | Train Loss: 0.0543593 Vali Loss: 0.0543796 Test Loss: 0.0576214
Validation loss decreased (0.054545 --> 0.054380).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0594514
	speed: 0.0393s/iter; left time: 349.5727s
	iters: 200, epoch: 11 | loss: 0.0537957
	speed: 0.0083s/iter; left time: 73.0458s
	iters: 300, epoch: 11 | loss: 0.0633883
	speed: 0.0084s/iter; left time: 73.4260s
	iters: 400, epoch: 11 | loss: 0.0528174
	speed: 0.0087s/iter; left time: 74.5780s
	iters: 500, epoch: 11 | loss: 0.0551074
	speed: 0.0087s/iter; left time: 73.6186s
	iters: 600, epoch: 11 | loss: 0.0560416
	speed: 0.0087s/iter; left time: 72.6660s
	iters: 700, epoch: 11 | loss: 0.0510706
	speed: 0.0087s/iter; left time: 71.9005s
	iters: 800, epoch: 11 | loss: 0.0528166
	speed: 0.0086s/iter; left time: 70.7197s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.93s
Steps: 899 | Train Loss: 0.0540606 Vali Loss: 0.0542038 Test Loss: 0.0569707
Validation loss decreased (0.054380 --> 0.054204).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0515615
	speed: 0.0419s/iter; left time: 335.0793s
	iters: 200, epoch: 12 | loss: 0.0491547
	speed: 0.0085s/iter; left time: 67.1967s
	iters: 300, epoch: 12 | loss: 0.0483418
	speed: 0.0085s/iter; left time: 66.5531s
	iters: 400, epoch: 12 | loss: 0.0459311
	speed: 0.0086s/iter; left time: 65.8890s
	iters: 500, epoch: 12 | loss: 0.0446333
	speed: 0.0086s/iter; left time: 65.1344s
	iters: 600, epoch: 12 | loss: 0.0596376
	speed: 0.0086s/iter; left time: 64.4990s
	iters: 700, epoch: 12 | loss: 0.0518609
	speed: 0.0086s/iter; left time: 63.5691s
	iters: 800, epoch: 12 | loss: 0.0545710
	speed: 0.0086s/iter; left time: 62.7750s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.03s
Steps: 899 | Train Loss: 0.0536925 Vali Loss: 0.0539636 Test Loss: 0.0570455
Validation loss decreased (0.054204 --> 0.053964).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0629774
	speed: 0.0389s/iter; left time: 276.0461s
	iters: 200, epoch: 13 | loss: 0.0536872
	speed: 0.0085s/iter; left time: 59.6970s
	iters: 300, epoch: 13 | loss: 0.0480245
	speed: 0.0085s/iter; left time: 58.7094s
	iters: 400, epoch: 13 | loss: 0.0471891
	speed: 0.0085s/iter; left time: 57.8796s
	iters: 500, epoch: 13 | loss: 0.0607830
	speed: 0.0085s/iter; left time: 56.9866s
	iters: 600, epoch: 13 | loss: 0.0528974
	speed: 0.0085s/iter; left time: 56.1648s
	iters: 700, epoch: 13 | loss: 0.0625108
	speed: 0.0085s/iter; left time: 55.3245s
	iters: 800, epoch: 13 | loss: 0.0497113
	speed: 0.0086s/iter; left time: 55.1878s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.88s
Steps: 899 | Train Loss: 0.0534536 Vali Loss: 0.0537022 Test Loss: 0.0564996
Validation loss decreased (0.053964 --> 0.053702).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0470890
	speed: 0.0386s/iter; left time: 238.9356s
	iters: 200, epoch: 14 | loss: 0.0498632
	speed: 0.0084s/iter; left time: 51.3460s
	iters: 300, epoch: 14 | loss: 0.0435860
	speed: 0.0084s/iter; left time: 50.6240s
	iters: 400, epoch: 14 | loss: 0.0405126
	speed: 0.0084s/iter; left time: 49.7304s
	iters: 500, epoch: 14 | loss: 0.0552683
	speed: 0.0084s/iter; left time: 48.7615s
	iters: 600, epoch: 14 | loss: 0.0532328
	speed: 0.0084s/iter; left time: 48.0301s
	iters: 700, epoch: 14 | loss: 0.0534556
	speed: 0.0086s/iter; left time: 48.0319s
	iters: 800, epoch: 14 | loss: 0.0495995
	speed: 0.0085s/iter; left time: 46.5366s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.84s
Steps: 899 | Train Loss: 0.0531598 Vali Loss: 0.0537457 Test Loss: 0.0566733
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0521199
	speed: 0.0391s/iter; left time: 207.0364s
	iters: 200, epoch: 15 | loss: 0.0575236
	speed: 0.0087s/iter; left time: 45.1542s
	iters: 300, epoch: 15 | loss: 0.0532496
	speed: 0.0086s/iter; left time: 44.0459s
	iters: 400, epoch: 15 | loss: 0.0483925
	speed: 0.0087s/iter; left time: 43.2465s
	iters: 500, epoch: 15 | loss: 0.0554117
	speed: 0.0087s/iter; left time: 42.3991s
	iters: 600, epoch: 15 | loss: 0.0514534
	speed: 0.0087s/iter; left time: 41.6077s
	iters: 700, epoch: 15 | loss: 0.0533527
	speed: 0.0086s/iter; left time: 40.3459s
	iters: 800, epoch: 15 | loss: 0.0547238
	speed: 0.0086s/iter; left time: 39.4435s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.95s
Steps: 899 | Train Loss: 0.0529861 Vali Loss: 0.0535848 Test Loss: 0.0565886
Validation loss decreased (0.053702 --> 0.053585).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0491242
	speed: 0.0397s/iter; left time: 174.6016s
	iters: 200, epoch: 16 | loss: 0.0519159
	speed: 0.0086s/iter; left time: 36.8331s
	iters: 300, epoch: 16 | loss: 0.0619587
	speed: 0.0086s/iter; left time: 36.0585s
	iters: 400, epoch: 16 | loss: 0.0556353
	speed: 0.0085s/iter; left time: 34.9784s
	iters: 500, epoch: 16 | loss: 0.0447307
	speed: 0.0085s/iter; left time: 34.1173s
	iters: 600, epoch: 16 | loss: 0.0478722
	speed: 0.0093s/iter; left time: 36.2389s
	iters: 700, epoch: 16 | loss: 0.0510559
	speed: 0.0085s/iter; left time: 32.3538s
	iters: 800, epoch: 16 | loss: 0.0529573
	speed: 0.0087s/iter; left time: 32.0985s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.03s
Steps: 899 | Train Loss: 0.0527103 Vali Loss: 0.0535088 Test Loss: 0.0565740
Validation loss decreased (0.053585 --> 0.053509).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0478330
	speed: 0.0434s/iter; left time: 151.7949s
	iters: 200, epoch: 17 | loss: 0.0523026
	speed: 0.0084s/iter; left time: 28.4961s
	iters: 300, epoch: 17 | loss: 0.0554195
	speed: 0.0085s/iter; left time: 28.0899s
	iters: 400, epoch: 17 | loss: 0.0575015
	speed: 0.0087s/iter; left time: 27.8535s
	iters: 500, epoch: 17 | loss: 0.0580324
	speed: 0.0087s/iter; left time: 26.8988s
	iters: 600, epoch: 17 | loss: 0.0510341
	speed: 0.0085s/iter; left time: 25.6013s
	iters: 700, epoch: 17 | loss: 0.0482460
	speed: 0.0085s/iter; left time: 24.6555s
	iters: 800, epoch: 17 | loss: 0.0458487
	speed: 0.0084s/iter; left time: 23.4847s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.06s
Steps: 899 | Train Loss: 0.0525888 Vali Loss: 0.0534194 Test Loss: 0.0565442
Validation loss decreased (0.053509 --> 0.053419).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0605156
	speed: 0.0412s/iter; left time: 107.1137s
	iters: 200, epoch: 18 | loss: 0.0549867
	speed: 0.0111s/iter; left time: 27.6157s
	iters: 300, epoch: 18 | loss: 0.0577672
	speed: 0.0107s/iter; left time: 25.5585s
	iters: 400, epoch: 18 | loss: 0.0466577
	speed: 0.0110s/iter; left time: 25.2958s
	iters: 500, epoch: 18 | loss: 0.0546953
	speed: 0.0117s/iter; left time: 25.7493s
	iters: 600, epoch: 18 | loss: 0.0489425
	speed: 0.0105s/iter; left time: 21.9387s
	iters: 700, epoch: 18 | loss: 0.0431009
	speed: 0.0107s/iter; left time: 21.4146s
	iters: 800, epoch: 18 | loss: 0.0475174
	speed: 0.0089s/iter; left time: 16.9832s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.58s
Steps: 899 | Train Loss: 0.0524367 Vali Loss: 0.0534199 Test Loss: 0.0564503
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0488207
	speed: 0.0390s/iter; left time: 66.2528s
	iters: 200, epoch: 19 | loss: 0.0470749
	speed: 0.0086s/iter; left time: 13.7607s
	iters: 300, epoch: 19 | loss: 0.0521912
	speed: 0.0086s/iter; left time: 12.8990s
	iters: 400, epoch: 19 | loss: 0.0456030
	speed: 0.0086s/iter; left time: 11.9957s
	iters: 500, epoch: 19 | loss: 0.0558893
	speed: 0.0086s/iter; left time: 11.1760s
	iters: 600, epoch: 19 | loss: 0.0514244
	speed: 0.0087s/iter; left time: 10.3772s
	iters: 700, epoch: 19 | loss: 0.0561091
	speed: 0.0087s/iter; left time: 9.5127s
	iters: 800, epoch: 19 | loss: 0.0482208
	speed: 0.0084s/iter; left time: 8.4339s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.91s
Steps: 899 | Train Loss: 0.0522364 Vali Loss: 0.0532984 Test Loss: 0.0565264
Validation loss decreased (0.053419 --> 0.053298).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0518415
	speed: 0.0391s/iter; left time: 31.2600s
	iters: 200, epoch: 20 | loss: 0.0518799
	speed: 0.0087s/iter; left time: 6.0809s
	iters: 300, epoch: 20 | loss: 0.0542073
	speed: 0.0087s/iter; left time: 5.2176s
	iters: 400, epoch: 20 | loss: 0.0500053
	speed: 0.0087s/iter; left time: 4.3497s
	iters: 500, epoch: 20 | loss: 0.0501625
	speed: 0.0087s/iter; left time: 3.4745s
	iters: 600, epoch: 20 | loss: 0.0498641
	speed: 0.0087s/iter; left time: 2.6067s
	iters: 700, epoch: 20 | loss: 0.0519767
	speed: 0.0087s/iter; left time: 1.7375s
	iters: 800, epoch: 20 | loss: 0.0552066
	speed: 0.0087s/iter; left time: 0.8702s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.03s
Steps: 899 | Train Loss: 0.0521951 Vali Loss: 0.0532630 Test Loss: 0.0564517
Validation loss decreased (0.053298 --> 0.053263).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010180042125284672, rmse:0.1008961945772171, mae:0.056451667100191116, rse:0.38129374384880066
Original data scale mse:1138836.625, rmse:1067.162841796875, mae:654.0407104492188, rse:0.07499205321073532

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.010154441930353642, RMSE: 0.10076925158500671, MAE: 0.05643478408455849, RSE: 0.3808140456676483
Unscaled Metrics - MSE: 1136971.75, RMSE: 1066.288818359375, MAE: 656.8383178710938, RSE: 0.07493062317371368

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.010180042125284672, RMSE: 0.1008961945772171, MAE: 0.056451667100191116, RSE: 0.38129374384880066
Unscaled Metrics - MSE: 1138836.625, RMSE: 1067.162841796875, MAE: 654.0407104492188, RSE: 0.07499205321073532

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_96_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=True, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=32, stride=16, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1708805
	speed: 0.0303s/iter; left time: 540.2952s
	iters: 200, epoch: 1 | loss: 0.1412551
	speed: 0.0094s/iter; left time: 165.9142s
	iters: 300, epoch: 1 | loss: 0.1277216
	speed: 0.0087s/iter; left time: 153.6471s
	iters: 400, epoch: 1 | loss: 0.1194239
	speed: 0.0085s/iter; left time: 149.9722s
	iters: 500, epoch: 1 | loss: 0.1203251
	speed: 0.0086s/iter; left time: 150.3329s
	iters: 600, epoch: 1 | loss: 0.1157655
	speed: 0.0085s/iter; left time: 147.4755s
	iters: 700, epoch: 1 | loss: 0.1135600
	speed: 0.0085s/iter; left time: 146.8484s
	iters: 800, epoch: 1 | loss: 0.1210854
	speed: 0.0085s/iter; left time: 146.3164s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.30s
Steps: 897 | Train Loss: 0.1318972 Vali Loss: 0.0978718 Test Loss: 0.1008648
Validation loss decreased (inf --> 0.097872).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0989415
	speed: 0.0420s/iter; left time: 711.9801s
	iters: 200, epoch: 2 | loss: 0.0891925
	speed: 0.0085s/iter; left time: 142.7567s
	iters: 300, epoch: 2 | loss: 0.0866433
	speed: 0.0085s/iter; left time: 141.8987s
	iters: 400, epoch: 2 | loss: 0.0883691
	speed: 0.0086s/iter; left time: 142.6979s
	iters: 500, epoch: 2 | loss: 0.0885621
	speed: 0.0085s/iter; left time: 140.0466s
	iters: 600, epoch: 2 | loss: 0.0794182
	speed: 0.0118s/iter; left time: 194.7315s
	iters: 700, epoch: 2 | loss: 0.0763809
	speed: 0.0087s/iter; left time: 142.5059s
	iters: 800, epoch: 2 | loss: 0.0849773
	speed: 0.0085s/iter; left time: 138.8476s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.41s
Steps: 897 | Train Loss: 0.0888911 Vali Loss: 0.0794706 Test Loss: 0.0841773
Validation loss decreased (0.097872 --> 0.079471).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0824038
	speed: 0.0434s/iter; left time: 697.2337s
	iters: 200, epoch: 3 | loss: 0.0864248
	speed: 0.0103s/iter; left time: 163.5872s
	iters: 300, epoch: 3 | loss: 0.0736913
	speed: 0.0087s/iter; left time: 137.2521s
	iters: 400, epoch: 3 | loss: 0.0795692
	speed: 0.0086s/iter; left time: 135.3179s
	iters: 500, epoch: 3 | loss: 0.0687195
	speed: 0.0095s/iter; left time: 148.4006s
	iters: 600, epoch: 3 | loss: 0.0893032
	speed: 0.0086s/iter; left time: 133.3548s
	iters: 700, epoch: 3 | loss: 0.0771745
	speed: 0.0086s/iter; left time: 133.5073s
	iters: 800, epoch: 3 | loss: 0.0800088
	speed: 0.0087s/iter; left time: 132.9731s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.36s
Steps: 897 | Train Loss: 0.0816509 Vali Loss: 0.0779648 Test Loss: 0.0830527
Validation loss decreased (0.079471 --> 0.077965).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0836727
	speed: 0.0395s/iter; left time: 598.2395s
	iters: 200, epoch: 4 | loss: 0.0755323
	speed: 0.0088s/iter; left time: 133.0544s
	iters: 300, epoch: 4 | loss: 0.0811564
	speed: 0.0088s/iter; left time: 131.7867s
	iters: 400, epoch: 4 | loss: 0.0791053
	speed: 0.0088s/iter; left time: 131.0683s
	iters: 500, epoch: 4 | loss: 0.0747812
	speed: 0.0086s/iter; left time: 126.8418s
	iters: 600, epoch: 4 | loss: 0.0741449
	speed: 0.0086s/iter; left time: 126.4561s
	iters: 700, epoch: 4 | loss: 0.0899509
	speed: 0.0086s/iter; left time: 125.8096s
	iters: 800, epoch: 4 | loss: 0.0751809
	speed: 0.0088s/iter; left time: 126.8555s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.04s
Steps: 897 | Train Loss: 0.0792859 Vali Loss: 0.0775702 Test Loss: 0.0828155
Validation loss decreased (0.077965 --> 0.077570).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0770186
	speed: 0.0413s/iter; left time: 588.6752s
	iters: 200, epoch: 5 | loss: 0.0705070
	speed: 0.0086s/iter; left time: 121.8826s
	iters: 300, epoch: 5 | loss: 0.0759331
	speed: 0.0086s/iter; left time: 121.0894s
	iters: 400, epoch: 5 | loss: 0.0821801
	speed: 0.0086s/iter; left time: 120.1174s
	iters: 500, epoch: 5 | loss: 0.0862341
	speed: 0.0086s/iter; left time: 119.6678s
	iters: 600, epoch: 5 | loss: 0.0733199
	speed: 0.0086s/iter; left time: 118.7817s
	iters: 700, epoch: 5 | loss: 0.0787596
	speed: 0.0087s/iter; left time: 118.2187s
	iters: 800, epoch: 5 | loss: 0.0949860
	speed: 0.0087s/iter; left time: 118.2075s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.02s
Steps: 897 | Train Loss: 0.0775383 Vali Loss: 0.0768286 Test Loss: 0.0818250
Validation loss decreased (0.077570 --> 0.076829).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0711937
	speed: 0.0412s/iter; left time: 550.6872s
	iters: 200, epoch: 6 | loss: 0.0683018
	speed: 0.0086s/iter; left time: 114.2008s
	iters: 300, epoch: 6 | loss: 0.0738117
	speed: 0.0087s/iter; left time: 114.4811s
	iters: 400, epoch: 6 | loss: 0.0758951
	speed: 0.0086s/iter; left time: 112.7524s
	iters: 500, epoch: 6 | loss: 0.0753310
	speed: 0.0086s/iter; left time: 111.4614s
	iters: 600, epoch: 6 | loss: 0.0704748
	speed: 0.0086s/iter; left time: 110.6215s
	iters: 700, epoch: 6 | loss: 0.0818257
	speed: 0.0086s/iter; left time: 110.0031s
	iters: 800, epoch: 6 | loss: 0.0677308
	speed: 0.0087s/iter; left time: 110.0673s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.09s
Steps: 897 | Train Loss: 0.0761277 Vali Loss: 0.0769486 Test Loss: 0.0817598
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0822666
	speed: 0.0393s/iter; left time: 489.7354s
	iters: 200, epoch: 7 | loss: 0.0733081
	speed: 0.0087s/iter; left time: 106.9205s
	iters: 300, epoch: 7 | loss: 0.0692510
	speed: 0.0086s/iter; left time: 105.7385s
	iters: 400, epoch: 7 | loss: 0.0709503
	speed: 0.0086s/iter; left time: 104.8506s
	iters: 500, epoch: 7 | loss: 0.0659880
	speed: 0.0086s/iter; left time: 103.9736s
	iters: 600, epoch: 7 | loss: 0.0822174
	speed: 0.0086s/iter; left time: 103.0621s
	iters: 700, epoch: 7 | loss: 0.0794314
	speed: 0.0086s/iter; left time: 102.1710s
	iters: 800, epoch: 7 | loss: 0.0757879
	speed: 0.0086s/iter; left time: 101.5003s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.98s
Steps: 897 | Train Loss: 0.0749485 Vali Loss: 0.0767103 Test Loss: 0.0814315
Validation loss decreased (0.076829 --> 0.076710).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0702958
	speed: 0.0394s/iter; left time: 455.8742s
	iters: 200, epoch: 8 | loss: 0.0790633
	speed: 0.0085s/iter; left time: 97.4325s
	iters: 300, epoch: 8 | loss: 0.0794195
	speed: 0.0085s/iter; left time: 97.0366s
	iters: 400, epoch: 8 | loss: 0.0718726
	speed: 0.0086s/iter; left time: 96.3192s
	iters: 500, epoch: 8 | loss: 0.0628259
	speed: 0.0085s/iter; left time: 95.3142s
	iters: 600, epoch: 8 | loss: 0.0689449
	speed: 0.0085s/iter; left time: 94.3832s
	iters: 700, epoch: 8 | loss: 0.0713064
	speed: 0.0096s/iter; left time: 104.6896s
	iters: 800, epoch: 8 | loss: 0.0747390
	speed: 0.0085s/iter; left time: 91.9182s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.96s
Steps: 897 | Train Loss: 0.0737772 Vali Loss: 0.0766239 Test Loss: 0.0809693
Validation loss decreased (0.076710 --> 0.076624).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0829301
	speed: 0.0412s/iter; left time: 439.4095s
	iters: 200, epoch: 9 | loss: 0.0750943
	speed: 0.0089s/iter; left time: 94.3969s
	iters: 300, epoch: 9 | loss: 0.0820963
	speed: 0.0104s/iter; left time: 108.9049s
	iters: 400, epoch: 9 | loss: 0.0745441
	speed: 0.0088s/iter; left time: 91.0573s
	iters: 500, epoch: 9 | loss: 0.0705703
	speed: 0.0086s/iter; left time: 88.3863s
	iters: 600, epoch: 9 | loss: 0.0681622
	speed: 0.0086s/iter; left time: 87.2774s
	iters: 700, epoch: 9 | loss: 0.0779018
	speed: 0.0086s/iter; left time: 86.1848s
	iters: 800, epoch: 9 | loss: 0.0691212
	speed: 0.0085s/iter; left time: 85.1504s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.23s
Steps: 897 | Train Loss: 0.0728261 Vali Loss: 0.0766890 Test Loss: 0.0808661
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0603640
	speed: 0.0381s/iter; left time: 372.5591s
	iters: 200, epoch: 10 | loss: 0.0730878
	speed: 0.0087s/iter; left time: 83.9394s
	iters: 300, epoch: 10 | loss: 0.0681768
	speed: 0.0087s/iter; left time: 83.1590s
	iters: 400, epoch: 10 | loss: 0.0759636
	speed: 0.0087s/iter; left time: 82.0909s
	iters: 500, epoch: 10 | loss: 0.0830688
	speed: 0.0087s/iter; left time: 81.1502s
	iters: 600, epoch: 10 | loss: 0.0742471
	speed: 0.0089s/iter; left time: 82.4307s
	iters: 700, epoch: 10 | loss: 0.0710265
	speed: 0.0087s/iter; left time: 79.8300s
	iters: 800, epoch: 10 | loss: 0.0788138
	speed: 0.0088s/iter; left time: 79.3676s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.17s
Steps: 897 | Train Loss: 0.0720068 Vali Loss: 0.0764157 Test Loss: 0.0810015
Validation loss decreased (0.076624 --> 0.076416).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0736144
	speed: 0.0421s/iter; left time: 373.5382s
	iters: 200, epoch: 11 | loss: 0.0762086
	speed: 0.0084s/iter; left time: 74.1067s
	iters: 300, epoch: 11 | loss: 0.0734797
	speed: 0.0084s/iter; left time: 72.6924s
	iters: 400, epoch: 11 | loss: 0.0693691
	speed: 0.0084s/iter; left time: 71.7495s
	iters: 500, epoch: 11 | loss: 0.0711025
	speed: 0.0084s/iter; left time: 71.2415s
	iters: 600, epoch: 11 | loss: 0.0702377
	speed: 0.0084s/iter; left time: 70.2898s
	iters: 700, epoch: 11 | loss: 0.0788250
	speed: 0.0084s/iter; left time: 69.4932s
	iters: 800, epoch: 11 | loss: 0.0683402
	speed: 0.0084s/iter; left time: 68.8001s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.78s
Steps: 897 | Train Loss: 0.0712321 Vali Loss: 0.0762997 Test Loss: 0.0807599
Validation loss decreased (0.076416 --> 0.076300).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0681119
	speed: 0.0382s/iter; left time: 304.6272s
	iters: 200, epoch: 12 | loss: 0.0711084
	speed: 0.0085s/iter; left time: 66.6270s
	iters: 300, epoch: 12 | loss: 0.0702774
	speed: 0.0083s/iter; left time: 64.8131s
	iters: 400, epoch: 12 | loss: 0.0712768
	speed: 0.0083s/iter; left time: 64.0674s
	iters: 500, epoch: 12 | loss: 0.0716618
	speed: 0.0084s/iter; left time: 63.8656s
	iters: 600, epoch: 12 | loss: 0.0686688
	speed: 0.0084s/iter; left time: 63.0841s
	iters: 700, epoch: 12 | loss: 0.0669762
	speed: 0.0086s/iter; left time: 63.1718s
	iters: 800, epoch: 12 | loss: 0.0668795
	speed: 0.0086s/iter; left time: 62.3032s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.82s
Steps: 897 | Train Loss: 0.0705363 Vali Loss: 0.0763480 Test Loss: 0.0805624
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0721765
	speed: 0.0388s/iter; left time: 274.4926s
	iters: 200, epoch: 13 | loss: 0.0699496
	speed: 0.0086s/iter; left time: 59.7388s
	iters: 300, epoch: 13 | loss: 0.0722701
	speed: 0.0086s/iter; left time: 58.9363s
	iters: 400, epoch: 13 | loss: 0.0710783
	speed: 0.0086s/iter; left time: 58.4742s
	iters: 500, epoch: 13 | loss: 0.0646761
	speed: 0.0086s/iter; left time: 57.1575s
	iters: 600, epoch: 13 | loss: 0.0718390
	speed: 0.0085s/iter; left time: 56.1090s
	iters: 700, epoch: 13 | loss: 0.0646675
	speed: 0.0085s/iter; left time: 55.2157s
	iters: 800, epoch: 13 | loss: 0.0706903
	speed: 0.0085s/iter; left time: 54.2612s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.90s
Steps: 897 | Train Loss: 0.0700386 Vali Loss: 0.0759667 Test Loss: 0.0807816
Validation loss decreased (0.076300 --> 0.075967).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0668437
	speed: 0.0390s/iter; left time: 241.2377s
	iters: 200, epoch: 14 | loss: 0.0623921
	speed: 0.0095s/iter; left time: 57.5499s
	iters: 300, epoch: 14 | loss: 0.0624417
	speed: 0.0086s/iter; left time: 51.2171s
	iters: 400, epoch: 14 | loss: 0.0628362
	speed: 0.0086s/iter; left time: 50.5705s
	iters: 500, epoch: 14 | loss: 0.0706031
	speed: 0.0088s/iter; left time: 50.6635s
	iters: 600, epoch: 14 | loss: 0.0777184
	speed: 0.0102s/iter; left time: 57.6569s
	iters: 700, epoch: 14 | loss: 0.0684290
	speed: 0.0089s/iter; left time: 49.9184s
	iters: 800, epoch: 14 | loss: 0.0715321
	speed: 0.0101s/iter; left time: 55.2158s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.37s
Steps: 897 | Train Loss: 0.0695033 Vali Loss: 0.0762393 Test Loss: 0.0805957
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0693248
	speed: 0.0413s/iter; left time: 218.1715s
	iters: 200, epoch: 15 | loss: 0.0626536
	speed: 0.0085s/iter; left time: 43.8627s
	iters: 300, epoch: 15 | loss: 0.0680994
	speed: 0.0084s/iter; left time: 42.6802s
	iters: 400, epoch: 15 | loss: 0.0716880
	speed: 0.0084s/iter; left time: 41.7974s
	iters: 500, epoch: 15 | loss: 0.0690726
	speed: 0.0085s/iter; left time: 41.7221s
	iters: 600, epoch: 15 | loss: 0.0691273
	speed: 0.0087s/iter; left time: 41.7486s
	iters: 700, epoch: 15 | loss: 0.0622856
	speed: 0.0087s/iter; left time: 40.6803s
	iters: 800, epoch: 15 | loss: 0.0633826
	speed: 0.0086s/iter; left time: 39.4336s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.91s
Steps: 897 | Train Loss: 0.0690579 Vali Loss: 0.0759859 Test Loss: 0.0806678
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0686625
	speed: 0.0388s/iter; left time: 170.2880s
	iters: 200, epoch: 16 | loss: 0.0666124
	speed: 0.0087s/iter; left time: 37.3130s
	iters: 300, epoch: 16 | loss: 0.0751578
	speed: 0.0086s/iter; left time: 35.8662s
	iters: 400, epoch: 16 | loss: 0.0715827
	speed: 0.0108s/iter; left time: 44.0044s
	iters: 500, epoch: 16 | loss: 0.0637077
	speed: 0.0088s/iter; left time: 34.8959s
	iters: 600, epoch: 16 | loss: 0.0741029
	speed: 0.0094s/iter; left time: 36.7117s
	iters: 700, epoch: 16 | loss: 0.0697047
	speed: 0.0097s/iter; left time: 36.8544s
	iters: 800, epoch: 16 | loss: 0.0746869
	speed: 0.0092s/iter; left time: 33.7936s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.44s
Steps: 897 | Train Loss: 0.0687106 Vali Loss: 0.0763052 Test Loss: 0.0804712
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0705440
	speed: 0.0381s/iter; left time: 132.9031s
	iters: 200, epoch: 17 | loss: 0.0635481
	speed: 0.0085s/iter; left time: 28.9110s
	iters: 300, epoch: 17 | loss: 0.0739564
	speed: 0.0085s/iter; left time: 28.1020s
	iters: 400, epoch: 17 | loss: 0.0816909
	speed: 0.0085s/iter; left time: 27.1234s
	iters: 500, epoch: 17 | loss: 0.0659272
	speed: 0.0085s/iter; left time: 26.2913s
	iters: 600, epoch: 17 | loss: 0.0693205
	speed: 0.0083s/iter; left time: 24.9239s
	iters: 700, epoch: 17 | loss: 0.0663598
	speed: 0.0083s/iter; left time: 23.8779s
	iters: 800, epoch: 17 | loss: 0.0659669
	speed: 0.0083s/iter; left time: 23.0580s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.76s
Steps: 897 | Train Loss: 0.0682975 Vali Loss: 0.0760981 Test Loss: 0.0805807
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0626941
	speed: 0.0385s/iter; left time: 99.8989s
	iters: 200, epoch: 18 | loss: 0.0657801
	speed: 0.0085s/iter; left time: 21.1912s
	iters: 300, epoch: 18 | loss: 0.0693399
	speed: 0.0085s/iter; left time: 20.3454s
	iters: 400, epoch: 18 | loss: 0.0693728
	speed: 0.0085s/iter; left time: 19.5307s
	iters: 500, epoch: 18 | loss: 0.0563471
	speed: 0.0085s/iter; left time: 18.5819s
	iters: 600, epoch: 18 | loss: 0.0734187
	speed: 0.0085s/iter; left time: 17.6993s
	iters: 700, epoch: 18 | loss: 0.0661468
	speed: 0.0085s/iter; left time: 16.8779s
	iters: 800, epoch: 18 | loss: 0.0646449
	speed: 0.0085s/iter; left time: 16.0726s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.84s
Steps: 897 | Train Loss: 0.0679788 Vali Loss: 0.0758671 Test Loss: 0.0808429
Validation loss decreased (0.075967 --> 0.075867).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0711051
	speed: 0.0391s/iter; left time: 66.2946s
	iters: 200, epoch: 19 | loss: 0.0709902
	speed: 0.0085s/iter; left time: 13.6244s
	iters: 300, epoch: 19 | loss: 0.0745760
	speed: 0.0085s/iter; left time: 12.7689s
	iters: 400, epoch: 19 | loss: 0.0647195
	speed: 0.0085s/iter; left time: 11.9094s
	iters: 500, epoch: 19 | loss: 0.0622132
	speed: 0.0085s/iter; left time: 11.0350s
	iters: 600, epoch: 19 | loss: 0.0612881
	speed: 0.0085s/iter; left time: 10.1686s
	iters: 700, epoch: 19 | loss: 0.0661993
	speed: 0.0085s/iter; left time: 9.3173s
	iters: 800, epoch: 19 | loss: 0.0669945
	speed: 0.0085s/iter; left time: 8.4516s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.85s
Steps: 897 | Train Loss: 0.0677087 Vali Loss: 0.0761142 Test Loss: 0.0805917
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0749392
	speed: 0.0400s/iter; left time: 31.9265s
	iters: 200, epoch: 20 | loss: 0.0650681
	speed: 0.0100s/iter; left time: 6.9991s
	iters: 300, epoch: 20 | loss: 0.0674877
	speed: 0.0086s/iter; left time: 5.1684s
	iters: 400, epoch: 20 | loss: 0.0653007
	speed: 0.0092s/iter; left time: 4.6031s
	iters: 500, epoch: 20 | loss: 0.0725830
	speed: 0.0101s/iter; left time: 4.0378s
	iters: 600, epoch: 20 | loss: 0.0652029
	speed: 0.0089s/iter; left time: 2.6467s
	iters: 700, epoch: 20 | loss: 0.0685860
	speed: 0.0088s/iter; left time: 1.7343s
	iters: 800, epoch: 20 | loss: 0.0717030
	speed: 0.0087s/iter; left time: 0.8521s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.35s
Steps: 897 | Train Loss: 0.0675701 Vali Loss: 0.0759812 Test Loss: 0.0806642
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01871649920940399, rmse:0.13680826127529144, mae:0.08084283769130707, rse:0.5172867178916931
Original data scale mse:2374954.25, rmse:1541.088623046875, mae:972.7523803710938, rse:0.108452707529068
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1764216
	speed: 0.0109s/iter; left time: 193.6869s
	iters: 200, epoch: 1 | loss: 0.1487204
	speed: 0.0083s/iter; left time: 147.9258s
	iters: 300, epoch: 1 | loss: 0.1316128
	speed: 0.0085s/iter; left time: 149.3688s
	iters: 400, epoch: 1 | loss: 0.1300153
	speed: 0.0086s/iter; left time: 150.5979s
	iters: 500, epoch: 1 | loss: 0.1162089
	speed: 0.0088s/iter; left time: 153.7345s
	iters: 600, epoch: 1 | loss: 0.1210243
	speed: 0.0086s/iter; left time: 149.4851s
	iters: 700, epoch: 1 | loss: 0.1078550
	speed: 0.0086s/iter; left time: 149.1344s
	iters: 800, epoch: 1 | loss: 0.1064629
	speed: 0.0088s/iter; left time: 150.4122s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.98s
Steps: 897 | Train Loss: 0.1310837 Vali Loss: 0.0974577 Test Loss: 0.1004544
Validation loss decreased (inf --> 0.097458).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0962409
	speed: 0.0437s/iter; left time: 741.1833s
	iters: 200, epoch: 2 | loss: 0.0924856
	speed: 0.0086s/iter; left time: 144.9975s
	iters: 300, epoch: 2 | loss: 0.0862916
	speed: 0.0086s/iter; left time: 143.7997s
	iters: 400, epoch: 2 | loss: 0.0957766
	speed: 0.0086s/iter; left time: 143.2387s
	iters: 500, epoch: 2 | loss: 0.0826875
	speed: 0.0086s/iter; left time: 142.5334s
	iters: 600, epoch: 2 | loss: 0.0768120
	speed: 0.0086s/iter; left time: 141.1984s
	iters: 700, epoch: 2 | loss: 0.0802395
	speed: 0.0086s/iter; left time: 140.1031s
	iters: 800, epoch: 2 | loss: 0.0809717
	speed: 0.0086s/iter; left time: 139.2011s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.00s
Steps: 897 | Train Loss: 0.0888422 Vali Loss: 0.0791979 Test Loss: 0.0838224
Validation loss decreased (0.097458 --> 0.079198).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0795708
	speed: 0.0393s/iter; left time: 631.0180s
	iters: 200, epoch: 3 | loss: 0.0866132
	speed: 0.0086s/iter; left time: 136.5722s
	iters: 300, epoch: 3 | loss: 0.0798445
	speed: 0.0086s/iter; left time: 137.0224s
	iters: 400, epoch: 3 | loss: 0.0835910
	speed: 0.0086s/iter; left time: 135.6434s
	iters: 500, epoch: 3 | loss: 0.0859751
	speed: 0.0086s/iter; left time: 135.0135s
	iters: 600, epoch: 3 | loss: 0.0732036
	speed: 0.0086s/iter; left time: 133.8404s
	iters: 700, epoch: 3 | loss: 0.0794780
	speed: 0.0086s/iter; left time: 133.0623s
	iters: 800, epoch: 3 | loss: 0.0839007
	speed: 0.0086s/iter; left time: 131.8881s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.94s
Steps: 897 | Train Loss: 0.0816037 Vali Loss: 0.0785294 Test Loss: 0.0829009
Validation loss decreased (0.079198 --> 0.078529).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0768041
	speed: 0.0407s/iter; left time: 616.2648s
	iters: 200, epoch: 4 | loss: 0.0811102
	speed: 0.0086s/iter; left time: 128.8714s
	iters: 300, epoch: 4 | loss: 0.0769751
	speed: 0.0086s/iter; left time: 127.9866s
	iters: 400, epoch: 4 | loss: 0.0795978
	speed: 0.0086s/iter; left time: 126.9822s
	iters: 500, epoch: 4 | loss: 0.0745579
	speed: 0.0086s/iter; left time: 126.7658s
	iters: 600, epoch: 4 | loss: 0.0729626
	speed: 0.0086s/iter; left time: 125.3713s
	iters: 700, epoch: 4 | loss: 0.0806928
	speed: 0.0085s/iter; left time: 124.1527s
	iters: 800, epoch: 4 | loss: 0.0738188
	speed: 0.0085s/iter; left time: 123.3757s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.93s
Steps: 897 | Train Loss: 0.0793524 Vali Loss: 0.0780493 Test Loss: 0.0824024
Validation loss decreased (0.078529 --> 0.078049).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0828017
	speed: 0.0396s/iter; left time: 564.7795s
	iters: 200, epoch: 5 | loss: 0.0784330
	speed: 0.0086s/iter; left time: 122.1928s
	iters: 300, epoch: 5 | loss: 0.0827423
	speed: 0.0087s/iter; left time: 121.7371s
	iters: 400, epoch: 5 | loss: 0.0788836
	speed: 0.0086s/iter; left time: 120.6678s
	iters: 500, epoch: 5 | loss: 0.0868732
	speed: 0.0086s/iter; left time: 119.6909s
	iters: 600, epoch: 5 | loss: 0.0787728
	speed: 0.0085s/iter; left time: 117.5050s
	iters: 700, epoch: 5 | loss: 0.0776858
	speed: 0.0084s/iter; left time: 114.5671s
	iters: 800, epoch: 5 | loss: 0.0802494
	speed: 0.0084s/iter; left time: 113.8665s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.99s
Steps: 897 | Train Loss: 0.0775413 Vali Loss: 0.0772784 Test Loss: 0.0815480
Validation loss decreased (0.078049 --> 0.077278).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0769298
	speed: 0.0428s/iter; left time: 572.2755s
	iters: 200, epoch: 6 | loss: 0.0782943
	speed: 0.0087s/iter; left time: 114.9494s
	iters: 300, epoch: 6 | loss: 0.0730536
	speed: 0.0089s/iter; left time: 117.4473s
	iters: 400, epoch: 6 | loss: 0.0744902
	speed: 0.0094s/iter; left time: 122.6591s
	iters: 500, epoch: 6 | loss: 0.0734538
	speed: 0.0089s/iter; left time: 115.1884s
	iters: 600, epoch: 6 | loss: 0.0819343
	speed: 0.0088s/iter; left time: 113.6252s
	iters: 700, epoch: 6 | loss: 0.0666599
	speed: 0.0087s/iter; left time: 110.9734s
	iters: 800, epoch: 6 | loss: 0.0720203
	speed: 0.0086s/iter; left time: 108.5813s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.30s
Steps: 897 | Train Loss: 0.0761613 Vali Loss: 0.0775140 Test Loss: 0.0809974
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0730525
	speed: 0.0405s/iter; left time: 504.6091s
	iters: 200, epoch: 7 | loss: 0.0679854
	speed: 0.0086s/iter; left time: 106.2758s
	iters: 300, epoch: 7 | loss: 0.0720927
	speed: 0.0086s/iter; left time: 105.2850s
	iters: 400, epoch: 7 | loss: 0.0770753
	speed: 0.0087s/iter; left time: 105.1861s
	iters: 500, epoch: 7 | loss: 0.0744169
	speed: 0.0086s/iter; left time: 104.2015s
	iters: 600, epoch: 7 | loss: 0.0692931
	speed: 0.0086s/iter; left time: 102.5345s
	iters: 700, epoch: 7 | loss: 0.0691958
	speed: 0.0085s/iter; left time: 101.2925s
	iters: 800, epoch: 7 | loss: 0.0754674
	speed: 0.0103s/iter; left time: 120.7188s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.19s
Steps: 897 | Train Loss: 0.0748851 Vali Loss: 0.0767040 Test Loss: 0.0812463
Validation loss decreased (0.077278 --> 0.076704).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0696710
	speed: 0.0437s/iter; left time: 505.1748s
	iters: 200, epoch: 8 | loss: 0.0763672
	speed: 0.0101s/iter; left time: 115.6795s
	iters: 300, epoch: 8 | loss: 0.0615931
	speed: 0.0098s/iter; left time: 111.2286s
	iters: 400, epoch: 8 | loss: 0.0795314
	speed: 0.0102s/iter; left time: 115.0334s
	iters: 500, epoch: 8 | loss: 0.0752174
	speed: 0.0135s/iter; left time: 151.0009s
	iters: 600, epoch: 8 | loss: 0.0693099
	speed: 0.0104s/iter; left time: 115.2217s
	iters: 700, epoch: 8 | loss: 0.0736928
	speed: 0.0107s/iter; left time: 117.8044s
	iters: 800, epoch: 8 | loss: 0.0776321
	speed: 0.0101s/iter; left time: 109.5497s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.75s
Steps: 897 | Train Loss: 0.0738498 Vali Loss: 0.0769178 Test Loss: 0.0811158
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0747849
	speed: 0.0406s/iter; left time: 433.3969s
	iters: 200, epoch: 9 | loss: 0.0706521
	speed: 0.0086s/iter; left time: 90.5200s
	iters: 300, epoch: 9 | loss: 0.0681434
	speed: 0.0086s/iter; left time: 89.6816s
	iters: 400, epoch: 9 | loss: 0.0739066
	speed: 0.0086s/iter; left time: 88.6923s
	iters: 500, epoch: 9 | loss: 0.0668490
	speed: 0.0084s/iter; left time: 86.5556s
	iters: 600, epoch: 9 | loss: 0.0771326
	speed: 0.0086s/iter; left time: 87.4968s
	iters: 700, epoch: 9 | loss: 0.0793742
	speed: 0.0086s/iter; left time: 86.8295s
	iters: 800, epoch: 9 | loss: 0.0704737
	speed: 0.0086s/iter; left time: 85.9922s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.91s
Steps: 897 | Train Loss: 0.0728780 Vali Loss: 0.0770575 Test Loss: 0.0802230
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0663449
	speed: 0.0395s/iter; left time: 385.6729s
	iters: 200, epoch: 10 | loss: 0.0704834
	speed: 0.0086s/iter; left time: 83.5862s
	iters: 300, epoch: 10 | loss: 0.0739264
	speed: 0.0086s/iter; left time: 82.6638s
	iters: 400, epoch: 10 | loss: 0.0738486
	speed: 0.0086s/iter; left time: 81.6708s
	iters: 500, epoch: 10 | loss: 0.0781138
	speed: 0.0086s/iter; left time: 80.8343s
	iters: 600, epoch: 10 | loss: 0.0861478
	speed: 0.0086s/iter; left time: 80.0966s
	iters: 700, epoch: 10 | loss: 0.0757280
	speed: 0.0086s/iter; left time: 78.6466s
	iters: 800, epoch: 10 | loss: 0.0663526
	speed: 0.0085s/iter; left time: 77.4138s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.96s
Steps: 897 | Train Loss: 0.0718697 Vali Loss: 0.0767785 Test Loss: 0.0803980
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0653223
	speed: 0.0384s/iter; left time: 340.4937s
	iters: 200, epoch: 11 | loss: 0.0676055
	speed: 0.0086s/iter; left time: 75.4292s
	iters: 300, epoch: 11 | loss: 0.0676592
	speed: 0.0086s/iter; left time: 74.4311s
	iters: 400, epoch: 11 | loss: 0.0797908
	speed: 0.0086s/iter; left time: 73.5419s
	iters: 500, epoch: 11 | loss: 0.0686739
	speed: 0.0086s/iter; left time: 72.6361s
	iters: 600, epoch: 11 | loss: 0.0686589
	speed: 0.0086s/iter; left time: 71.8569s
	iters: 700, epoch: 11 | loss: 0.0720364
	speed: 0.0120s/iter; left time: 99.2309s
	iters: 800, epoch: 11 | loss: 0.0808564
	speed: 0.0086s/iter; left time: 70.2262s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.25s
Steps: 897 | Train Loss: 0.0710960 Vali Loss: 0.0768533 Test Loss: 0.0804145
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0704030
	speed: 0.0416s/iter; left time: 331.6508s
	iters: 200, epoch: 12 | loss: 0.0684930
	speed: 0.0094s/iter; left time: 73.7131s
	iters: 300, epoch: 12 | loss: 0.0671661
	speed: 0.0087s/iter; left time: 67.7221s
	iters: 400, epoch: 12 | loss: 0.0812063
	speed: 0.0092s/iter; left time: 70.7615s
	iters: 500, epoch: 12 | loss: 0.0716422
	speed: 0.0091s/iter; left time: 69.2850s
	iters: 600, epoch: 12 | loss: 0.0710999
	speed: 0.0088s/iter; left time: 66.1401s
	iters: 700, epoch: 12 | loss: 0.0734499
	speed: 0.0087s/iter; left time: 64.3284s
	iters: 800, epoch: 12 | loss: 0.0592436
	speed: 0.0094s/iter; left time: 68.6675s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.28s
Steps: 897 | Train Loss: 0.0704140 Vali Loss: 0.0765855 Test Loss: 0.0803188
Validation loss decreased (0.076704 --> 0.076586).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0663913
	speed: 0.0421s/iter; left time: 297.9054s
	iters: 200, epoch: 13 | loss: 0.0746842
	speed: 0.0094s/iter; left time: 65.7575s
	iters: 300, epoch: 13 | loss: 0.0699914
	speed: 0.0110s/iter; left time: 75.6489s
	iters: 400, epoch: 13 | loss: 0.0771514
	speed: 0.0113s/iter; left time: 76.7489s
	iters: 500, epoch: 13 | loss: 0.0785270
	speed: 0.0088s/iter; left time: 58.8734s
	iters: 600, epoch: 13 | loss: 0.0636684
	speed: 0.0090s/iter; left time: 59.3747s
	iters: 700, epoch: 13 | loss: 0.0790440
	speed: 0.0089s/iter; left time: 57.6293s
	iters: 800, epoch: 13 | loss: 0.0638074
	speed: 0.0092s/iter; left time: 58.6555s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.92s
Steps: 897 | Train Loss: 0.0697692 Vali Loss: 0.0769554 Test Loss: 0.0810162
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0673871
	speed: 0.0440s/iter; left time: 271.9582s
	iters: 200, epoch: 14 | loss: 0.0670344
	speed: 0.0085s/iter; left time: 51.9136s
	iters: 300, epoch: 14 | loss: 0.0685085
	speed: 0.0086s/iter; left time: 51.3412s
	iters: 400, epoch: 14 | loss: 0.0641380
	speed: 0.0085s/iter; left time: 50.1899s
	iters: 500, epoch: 14 | loss: 0.0685883
	speed: 0.0085s/iter; left time: 49.2860s
	iters: 600, epoch: 14 | loss: 0.0726631
	speed: 0.0086s/iter; left time: 48.9521s
	iters: 700, epoch: 14 | loss: 0.0716188
	speed: 0.0086s/iter; left time: 48.2327s
	iters: 800, epoch: 14 | loss: 0.0754714
	speed: 0.0086s/iter; left time: 47.3502s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.01s
Steps: 897 | Train Loss: 0.0691436 Vali Loss: 0.0766860 Test Loss: 0.0807832
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0666481
	speed: 0.0430s/iter; left time: 227.0413s
	iters: 200, epoch: 15 | loss: 0.0691985
	speed: 0.0095s/iter; left time: 49.4911s
	iters: 300, epoch: 15 | loss: 0.0721074
	speed: 0.0097s/iter; left time: 49.3114s
	iters: 400, epoch: 15 | loss: 0.0710379
	speed: 0.0086s/iter; left time: 42.9606s
	iters: 500, epoch: 15 | loss: 0.0731740
	speed: 0.0087s/iter; left time: 42.3047s
	iters: 600, epoch: 15 | loss: 0.0665691
	speed: 0.0086s/iter; left time: 41.3477s
	iters: 700, epoch: 15 | loss: 0.0650770
	speed: 0.0086s/iter; left time: 40.2315s
	iters: 800, epoch: 15 | loss: 0.0698803
	speed: 0.0086s/iter; left time: 39.4785s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.38s
Steps: 897 | Train Loss: 0.0687823 Vali Loss: 0.0767938 Test Loss: 0.0809827
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0716217
	speed: 0.0405s/iter; left time: 177.4396s
	iters: 200, epoch: 16 | loss: 0.0714265
	speed: 0.0086s/iter; left time: 37.0025s
	iters: 300, epoch: 16 | loss: 0.0637786
	speed: 0.0085s/iter; left time: 35.7799s
	iters: 400, epoch: 16 | loss: 0.0717098
	speed: 0.0085s/iter; left time: 34.9117s
	iters: 500, epoch: 16 | loss: 0.0691444
	speed: 0.0085s/iter; left time: 34.0384s
	iters: 600, epoch: 16 | loss: 0.0692955
	speed: 0.0085s/iter; left time: 33.0026s
	iters: 700, epoch: 16 | loss: 0.0649698
	speed: 0.0085s/iter; left time: 32.1448s
	iters: 800, epoch: 16 | loss: 0.0679418
	speed: 0.0085s/iter; left time: 31.3014s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.92s
Steps: 897 | Train Loss: 0.0683519 Vali Loss: 0.0763213 Test Loss: 0.0808516
Validation loss decreased (0.076586 --> 0.076321).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0616460
	speed: 0.0393s/iter; left time: 137.1488s
	iters: 200, epoch: 17 | loss: 0.0662839
	speed: 0.0086s/iter; left time: 29.0614s
	iters: 300, epoch: 17 | loss: 0.0638993
	speed: 0.0099s/iter; left time: 32.6334s
	iters: 400, epoch: 17 | loss: 0.0719500
	speed: 0.0110s/iter; left time: 35.1636s
	iters: 500, epoch: 17 | loss: 0.0607939
	speed: 0.0093s/iter; left time: 28.7798s
	iters: 600, epoch: 17 | loss: 0.0735797
	speed: 0.0087s/iter; left time: 25.9640s
	iters: 700, epoch: 17 | loss: 0.0713516
	speed: 0.0101s/iter; left time: 29.1163s
	iters: 800, epoch: 17 | loss: 0.0736077
	speed: 0.0095s/iter; left time: 26.4230s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.65s
Steps: 897 | Train Loss: 0.0679667 Vali Loss: 0.0764359 Test Loss: 0.0809963
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0729668
	speed: 0.0400s/iter; left time: 103.7100s
	iters: 200, epoch: 18 | loss: 0.0691720
	speed: 0.0085s/iter; left time: 21.1808s
	iters: 300, epoch: 18 | loss: 0.0707033
	speed: 0.0085s/iter; left time: 20.3629s
	iters: 400, epoch: 18 | loss: 0.0603812
	speed: 0.0086s/iter; left time: 19.6394s
	iters: 500, epoch: 18 | loss: 0.0691694
	speed: 0.0086s/iter; left time: 18.8184s
	iters: 600, epoch: 18 | loss: 0.0634946
	speed: 0.0086s/iter; left time: 18.0836s
	iters: 700, epoch: 18 | loss: 0.0642861
	speed: 0.0091s/iter; left time: 18.1793s
	iters: 800, epoch: 18 | loss: 0.0624955
	speed: 0.0105s/iter; left time: 19.9456s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.41s
Steps: 897 | Train Loss: 0.0676646 Vali Loss: 0.0766452 Test Loss: 0.0805800
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0671453
	speed: 0.0450s/iter; left time: 76.3330s
	iters: 200, epoch: 19 | loss: 0.0759159
	speed: 0.0085s/iter; left time: 13.5904s
	iters: 300, epoch: 19 | loss: 0.0658691
	speed: 0.0085s/iter; left time: 12.7616s
	iters: 400, epoch: 19 | loss: 0.0673757
	speed: 0.0085s/iter; left time: 11.8619s
	iters: 500, epoch: 19 | loss: 0.0623002
	speed: 0.0085s/iter; left time: 11.0164s
	iters: 600, epoch: 19 | loss: 0.0681596
	speed: 0.0085s/iter; left time: 10.1604s
	iters: 700, epoch: 19 | loss: 0.0676891
	speed: 0.0085s/iter; left time: 9.3061s
	iters: 800, epoch: 19 | loss: 0.0644339
	speed: 0.0086s/iter; left time: 8.5284s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.88s
Steps: 897 | Train Loss: 0.0673641 Vali Loss: 0.0757408 Test Loss: 0.0810490
Validation loss decreased (0.076321 --> 0.075741).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0634677
	speed: 0.0400s/iter; left time: 31.8883s
	iters: 200, epoch: 20 | loss: 0.0610706
	speed: 0.0086s/iter; left time: 6.0335s
	iters: 300, epoch: 20 | loss: 0.0690134
	speed: 0.0087s/iter; left time: 5.1966s
	iters: 400, epoch: 20 | loss: 0.0658732
	speed: 0.0086s/iter; left time: 4.3071s
	iters: 500, epoch: 20 | loss: 0.0684351
	speed: 0.0086s/iter; left time: 3.4128s
	iters: 600, epoch: 20 | loss: 0.0673174
	speed: 0.0086s/iter; left time: 2.5686s
	iters: 700, epoch: 20 | loss: 0.0653443
	speed: 0.0086s/iter; left time: 1.6952s
	iters: 800, epoch: 20 | loss: 0.0696531
	speed: 0.0086s/iter; left time: 0.8397s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.99s
Steps: 897 | Train Loss: 0.0670726 Vali Loss: 0.0760162 Test Loss: 0.0809968
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018979672342538834, rmse:0.1377667337656021, mae:0.08104903250932693, rse:0.5209108591079712
Original data scale mse:2350334.25, rmse:1533.0799560546875, mae:967.2764282226562, rse:0.1078891009092331

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.01871649920940399, RMSE: 0.13680826127529144, MAE: 0.08084283769130707, RSE: 0.5172867178916931
Unscaled Metrics - MSE: 2374954.25, RMSE: 1541.088623046875, MAE: 972.7523803710938, RSE: 0.108452707529068

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.018979672342538834, RMSE: 0.1377667337656021, MAE: 0.08104903250932693, RSE: 0.5209108591079712
Unscaled Metrics - MSE: 2350334.25, RMSE: 1533.0799560546875, MAE: 967.2764282226562, RSE: 0.1078891009092331

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_168_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=True, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=32, stride=16, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1676631
	speed: 0.0313s/iter; left time: 555.6772s
	iters: 200, epoch: 1 | loss: 0.1426097
	speed: 0.0095s/iter; left time: 168.4008s
	iters: 300, epoch: 1 | loss: 0.1332137
	speed: 0.0094s/iter; left time: 165.4124s
	iters: 400, epoch: 1 | loss: 0.1236079
	speed: 0.0094s/iter; left time: 163.8150s
	iters: 500, epoch: 1 | loss: 0.1263428
	speed: 0.0095s/iter; left time: 164.4593s
	iters: 600, epoch: 1 | loss: 0.1137364
	speed: 0.0095s/iter; left time: 163.6606s
	iters: 700, epoch: 1 | loss: 0.1145076
	speed: 0.0108s/iter; left time: 184.7690s
	iters: 800, epoch: 1 | loss: 0.1114139
	speed: 0.0097s/iter; left time: 165.7455s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.06s
Steps: 894 | Train Loss: 0.1339725 Vali Loss: 0.1008623 Test Loss: 0.1035258
Validation loss decreased (inf --> 0.100862).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0982762
	speed: 0.0451s/iter; left time: 762.1636s
	iters: 200, epoch: 2 | loss: 0.0982117
	speed: 0.0096s/iter; left time: 160.9527s
	iters: 300, epoch: 2 | loss: 0.0964627
	speed: 0.0089s/iter; left time: 148.0447s
	iters: 400, epoch: 2 | loss: 0.1007937
	speed: 0.0088s/iter; left time: 145.6398s
	iters: 500, epoch: 2 | loss: 0.0936966
	speed: 0.0088s/iter; left time: 144.7295s
	iters: 600, epoch: 2 | loss: 0.0998424
	speed: 0.0087s/iter; left time: 143.2005s
	iters: 700, epoch: 2 | loss: 0.0937382
	speed: 0.0087s/iter; left time: 142.1151s
	iters: 800, epoch: 2 | loss: 0.0903431
	speed: 0.0088s/iter; left time: 141.6891s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.28s
Steps: 894 | Train Loss: 0.0928284 Vali Loss: 0.0836631 Test Loss: 0.0887228
Validation loss decreased (0.100862 --> 0.083663).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0925581
	speed: 0.0424s/iter; left time: 678.0362s
	iters: 200, epoch: 3 | loss: 0.0904151
	speed: 0.0094s/iter; left time: 149.7629s
	iters: 300, epoch: 3 | loss: 0.0869564
	speed: 0.0091s/iter; left time: 144.2474s
	iters: 400, epoch: 3 | loss: 0.0921788
	speed: 0.0097s/iter; left time: 152.4749s
	iters: 500, epoch: 3 | loss: 0.0759394
	speed: 0.0112s/iter; left time: 174.3693s
	iters: 600, epoch: 3 | loss: 0.0892078
	speed: 0.0087s/iter; left time: 134.6486s
	iters: 700, epoch: 3 | loss: 0.0894642
	speed: 0.0086s/iter; left time: 132.1573s
	iters: 800, epoch: 3 | loss: 0.0865110
	speed: 0.0086s/iter; left time: 132.0672s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.50s
Steps: 894 | Train Loss: 0.0855744 Vali Loss: 0.0825992 Test Loss: 0.0881007
Validation loss decreased (0.083663 --> 0.082599).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0898065
	speed: 0.0395s/iter; left time: 596.4653s
	iters: 200, epoch: 4 | loss: 0.0821942
	speed: 0.0085s/iter; left time: 128.1823s
	iters: 300, epoch: 4 | loss: 0.0802417
	speed: 0.0086s/iter; left time: 127.9736s
	iters: 400, epoch: 4 | loss: 0.0808136
	speed: 0.0086s/iter; left time: 127.5612s
	iters: 500, epoch: 4 | loss: 0.0811172
	speed: 0.0086s/iter; left time: 126.5603s
	iters: 600, epoch: 4 | loss: 0.0781578
	speed: 0.0086s/iter; left time: 126.0943s
	iters: 700, epoch: 4 | loss: 0.0823004
	speed: 0.0086s/iter; left time: 125.2546s
	iters: 800, epoch: 4 | loss: 0.0757930
	speed: 0.0086s/iter; left time: 124.5236s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.93s
Steps: 894 | Train Loss: 0.0832663 Vali Loss: 0.0830262 Test Loss: 0.0879437
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0763075
	speed: 0.0383s/iter; left time: 543.4063s
	iters: 200, epoch: 5 | loss: 0.0829726
	speed: 0.0087s/iter; left time: 122.7348s
	iters: 300, epoch: 5 | loss: 0.0848208
	speed: 0.0087s/iter; left time: 121.6044s
	iters: 400, epoch: 5 | loss: 0.0856856
	speed: 0.0087s/iter; left time: 120.7089s
	iters: 500, epoch: 5 | loss: 0.0807456
	speed: 0.0087s/iter; left time: 119.7975s
	iters: 600, epoch: 5 | loss: 0.0865609
	speed: 0.0087s/iter; left time: 119.0172s
	iters: 700, epoch: 5 | loss: 0.0772804
	speed: 0.0087s/iter; left time: 118.0897s
	iters: 800, epoch: 5 | loss: 0.0858641
	speed: 0.0087s/iter; left time: 117.2202s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.96s
Steps: 894 | Train Loss: 0.0815560 Vali Loss: 0.0821677 Test Loss: 0.0880615
Validation loss decreased (0.082599 --> 0.082168).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0868327
	speed: 0.0391s/iter; left time: 521.1232s
	iters: 200, epoch: 6 | loss: 0.0766530
	speed: 0.0086s/iter; left time: 113.6616s
	iters: 300, epoch: 6 | loss: 0.0826215
	speed: 0.0086s/iter; left time: 112.8916s
	iters: 400, epoch: 6 | loss: 0.0824801
	speed: 0.0086s/iter; left time: 112.3559s
	iters: 500, epoch: 6 | loss: 0.0768832
	speed: 0.0086s/iter; left time: 111.6109s
	iters: 600, epoch: 6 | loss: 0.0811780
	speed: 0.0087s/iter; left time: 111.0682s
	iters: 700, epoch: 6 | loss: 0.0854350
	speed: 0.0097s/iter; left time: 123.3770s
	iters: 800, epoch: 6 | loss: 0.0775294
	speed: 0.0086s/iter; left time: 108.5098s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.03s
Steps: 894 | Train Loss: 0.0799344 Vali Loss: 0.0819523 Test Loss: 0.0872872
Validation loss decreased (0.082168 --> 0.081952).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0801979
	speed: 0.0426s/iter; left time: 528.6491s
	iters: 200, epoch: 7 | loss: 0.0729250
	speed: 0.0086s/iter; left time: 106.1962s
	iters: 300, epoch: 7 | loss: 0.0777908
	speed: 0.0086s/iter; left time: 105.4108s
	iters: 400, epoch: 7 | loss: 0.0833218
	speed: 0.0087s/iter; left time: 105.4459s
	iters: 500, epoch: 7 | loss: 0.0819925
	speed: 0.0087s/iter; left time: 104.6211s
	iters: 600, epoch: 7 | loss: 0.0787476
	speed: 0.0087s/iter; left time: 103.7703s
	iters: 700, epoch: 7 | loss: 0.0750095
	speed: 0.0087s/iter; left time: 102.8657s
	iters: 800, epoch: 7 | loss: 0.0765415
	speed: 0.0087s/iter; left time: 102.1939s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.04s
Steps: 894 | Train Loss: 0.0786356 Vali Loss: 0.0820361 Test Loss: 0.0873266
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0721518
	speed: 0.0384s/iter; left time: 442.5912s
	iters: 200, epoch: 8 | loss: 0.0730626
	speed: 0.0085s/iter; left time: 97.3032s
	iters: 300, epoch: 8 | loss: 0.0763769
	speed: 0.0084s/iter; left time: 95.3592s
	iters: 400, epoch: 8 | loss: 0.0730331
	speed: 0.0084s/iter; left time: 94.4954s
	iters: 500, epoch: 8 | loss: 0.0753745
	speed: 0.0084s/iter; left time: 93.6753s
	iters: 600, epoch: 8 | loss: 0.0688097
	speed: 0.0084s/iter; left time: 92.8642s
	iters: 700, epoch: 8 | loss: 0.0881403
	speed: 0.0084s/iter; left time: 92.0582s
	iters: 800, epoch: 8 | loss: 0.0767288
	speed: 0.0084s/iter; left time: 91.0494s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.76s
Steps: 894 | Train Loss: 0.0774420 Vali Loss: 0.0823787 Test Loss: 0.0874536
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0776979
	speed: 0.0406s/iter; left time: 431.9726s
	iters: 200, epoch: 9 | loss: 0.0788525
	speed: 0.0092s/iter; left time: 96.6976s
	iters: 300, epoch: 9 | loss: 0.0779241
	speed: 0.0092s/iter; left time: 95.7452s
	iters: 400, epoch: 9 | loss: 0.0774643
	speed: 0.0089s/iter; left time: 92.3183s
	iters: 500, epoch: 9 | loss: 0.0747745
	speed: 0.0088s/iter; left time: 89.7518s
	iters: 600, epoch: 9 | loss: 0.0706947
	speed: 0.0088s/iter; left time: 88.9815s
	iters: 700, epoch: 9 | loss: 0.0729236
	speed: 0.0088s/iter; left time: 88.5578s
	iters: 800, epoch: 9 | loss: 0.0786334
	speed: 0.0089s/iter; left time: 87.8822s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.33s
Steps: 894 | Train Loss: 0.0764264 Vali Loss: 0.0816443 Test Loss: 0.0871328
Validation loss decreased (0.081952 --> 0.081644).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0718096
	speed: 0.0395s/iter; left time: 384.8013s
	iters: 200, epoch: 10 | loss: 0.0721445
	speed: 0.0084s/iter; left time: 80.8253s
	iters: 300, epoch: 10 | loss: 0.0754400
	speed: 0.0084s/iter; left time: 79.8511s
	iters: 400, epoch: 10 | loss: 0.0761036
	speed: 0.0087s/iter; left time: 81.8436s
	iters: 500, epoch: 10 | loss: 0.0790467
	speed: 0.0088s/iter; left time: 81.6918s
	iters: 600, epoch: 10 | loss: 0.0805561
	speed: 0.0085s/iter; left time: 78.8034s
	iters: 700, epoch: 10 | loss: 0.0742743
	speed: 0.0086s/iter; left time: 78.2663s
	iters: 800, epoch: 10 | loss: 0.0775000
	speed: 0.0085s/iter; left time: 77.0053s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.84s
Steps: 894 | Train Loss: 0.0754924 Vali Loss: 0.0817005 Test Loss: 0.0872950
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0764734
	speed: 0.0401s/iter; left time: 354.5838s
	iters: 200, epoch: 11 | loss: 0.0814360
	speed: 0.0096s/iter; left time: 83.5295s
	iters: 300, epoch: 11 | loss: 0.0730188
	speed: 0.0094s/iter; left time: 81.4207s
	iters: 400, epoch: 11 | loss: 0.0731893
	speed: 0.0095s/iter; left time: 81.4889s
	iters: 500, epoch: 11 | loss: 0.0727932
	speed: 0.0105s/iter; left time: 88.9098s
	iters: 600, epoch: 11 | loss: 0.0774737
	speed: 0.0106s/iter; left time: 88.2973s
	iters: 700, epoch: 11 | loss: 0.0802900
	speed: 0.0109s/iter; left time: 89.6873s
	iters: 800, epoch: 11 | loss: 0.0745332
	speed: 0.0096s/iter; left time: 77.8268s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.10s
Steps: 894 | Train Loss: 0.0746826 Vali Loss: 0.0817863 Test Loss: 0.0873130
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0772094
	speed: 0.0433s/iter; left time: 343.8789s
	iters: 200, epoch: 12 | loss: 0.0750696
	speed: 0.0107s/iter; left time: 84.1450s
	iters: 300, epoch: 12 | loss: 0.0763485
	speed: 0.0107s/iter; left time: 82.7162s
	iters: 400, epoch: 12 | loss: 0.0799676
	speed: 0.0106s/iter; left time: 81.0617s
	iters: 500, epoch: 12 | loss: 0.0768250
	speed: 0.0085s/iter; left time: 64.4265s
	iters: 600, epoch: 12 | loss: 0.0715757
	speed: 0.0085s/iter; left time: 63.4764s
	iters: 700, epoch: 12 | loss: 0.0714161
	speed: 0.0086s/iter; left time: 63.1434s
	iters: 800, epoch: 12 | loss: 0.0807038
	speed: 0.0086s/iter; left time: 62.5636s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.80s
Steps: 894 | Train Loss: 0.0740122 Vali Loss: 0.0816479 Test Loss: 0.0869386
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0786668
	speed: 0.0396s/iter; left time: 279.4159s
	iters: 200, epoch: 13 | loss: 0.0710765
	speed: 0.0086s/iter; left time: 59.7310s
	iters: 300, epoch: 13 | loss: 0.0727081
	speed: 0.0085s/iter; left time: 58.4726s
	iters: 400, epoch: 13 | loss: 0.0799780
	speed: 0.0085s/iter; left time: 57.2262s
	iters: 500, epoch: 13 | loss: 0.0762860
	speed: 0.0085s/iter; left time: 56.3686s
	iters: 600, epoch: 13 | loss: 0.0777735
	speed: 0.0085s/iter; left time: 55.4880s
	iters: 700, epoch: 13 | loss: 0.0718263
	speed: 0.0085s/iter; left time: 54.6734s
	iters: 800, epoch: 13 | loss: 0.0661025
	speed: 0.0085s/iter; left time: 54.0388s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.84s
Steps: 894 | Train Loss: 0.0733053 Vali Loss: 0.0815843 Test Loss: 0.0868065
Validation loss decreased (0.081644 --> 0.081584).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0764800
	speed: 0.0389s/iter; left time: 239.3180s
	iters: 200, epoch: 14 | loss: 0.0753890
	speed: 0.0085s/iter; left time: 51.5924s
	iters: 300, epoch: 14 | loss: 0.0797547
	speed: 0.0085s/iter; left time: 50.7213s
	iters: 400, epoch: 14 | loss: 0.0775461
	speed: 0.0085s/iter; left time: 49.8680s
	iters: 500, epoch: 14 | loss: 0.0755035
	speed: 0.0085s/iter; left time: 49.0136s
	iters: 600, epoch: 14 | loss: 0.0697026
	speed: 0.0085s/iter; left time: 48.1510s
	iters: 700, epoch: 14 | loss: 0.0762542
	speed: 0.0085s/iter; left time: 47.2796s
	iters: 800, epoch: 14 | loss: 0.0669765
	speed: 0.0085s/iter; left time: 46.5510s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.86s
Steps: 894 | Train Loss: 0.0728547 Vali Loss: 0.0816916 Test Loss: 0.0874153
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0698596
	speed: 0.0383s/iter; left time: 201.4324s
	iters: 200, epoch: 15 | loss: 0.0679832
	speed: 0.0085s/iter; left time: 44.0594s
	iters: 300, epoch: 15 | loss: 0.0669634
	speed: 0.0084s/iter; left time: 42.7077s
	iters: 400, epoch: 15 | loss: 0.0765448
	speed: 0.0084s/iter; left time: 41.8339s
	iters: 500, epoch: 15 | loss: 0.0608581
	speed: 0.0084s/iter; left time: 41.0555s
	iters: 600, epoch: 15 | loss: 0.0735885
	speed: 0.0084s/iter; left time: 40.2213s
	iters: 700, epoch: 15 | loss: 0.0737299
	speed: 0.0084s/iter; left time: 39.3176s
	iters: 800, epoch: 15 | loss: 0.0745507
	speed: 0.0084s/iter; left time: 38.4675s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.78s
Steps: 894 | Train Loss: 0.0723528 Vali Loss: 0.0813551 Test Loss: 0.0870353
Validation loss decreased (0.081584 --> 0.081355).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0692273
	speed: 0.0434s/iter; left time: 189.5008s
	iters: 200, epoch: 16 | loss: 0.0773633
	speed: 0.0107s/iter; left time: 45.6697s
	iters: 300, epoch: 16 | loss: 0.0752365
	speed: 0.0106s/iter; left time: 44.1018s
	iters: 400, epoch: 16 | loss: 0.0726915
	speed: 0.0097s/iter; left time: 39.3895s
	iters: 500, epoch: 16 | loss: 0.0753377
	speed: 0.0086s/iter; left time: 34.0029s
	iters: 600, epoch: 16 | loss: 0.0680992
	speed: 0.0086s/iter; left time: 33.1694s
	iters: 700, epoch: 16 | loss: 0.0749957
	speed: 0.0086s/iter; left time: 32.2951s
	iters: 800, epoch: 16 | loss: 0.0682190
	speed: 0.0086s/iter; left time: 31.4479s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.65s
Steps: 894 | Train Loss: 0.0719654 Vali Loss: 0.0812389 Test Loss: 0.0872389
Validation loss decreased (0.081355 --> 0.081239).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0736102
	speed: 0.0413s/iter; left time: 143.4493s
	iters: 200, epoch: 17 | loss: 0.0727421
	speed: 0.0106s/iter; left time: 35.7644s
	iters: 300, epoch: 17 | loss: 0.0798749
	speed: 0.0105s/iter; left time: 34.5375s
	iters: 400, epoch: 17 | loss: 0.0678909
	speed: 0.0106s/iter; left time: 33.7241s
	iters: 500, epoch: 17 | loss: 0.0697635
	speed: 0.0106s/iter; left time: 32.7186s
	iters: 600, epoch: 17 | loss: 0.0730367
	speed: 0.0106s/iter; left time: 31.6043s
	iters: 700, epoch: 17 | loss: 0.0739769
	speed: 0.0107s/iter; left time: 30.7749s
	iters: 800, epoch: 17 | loss: 0.0720364
	speed: 0.0108s/iter; left time: 29.9021s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.70s
Steps: 894 | Train Loss: 0.0714891 Vali Loss: 0.0816015 Test Loss: 0.0875076
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0738157
	speed: 0.0432s/iter; left time: 111.6655s
	iters: 200, epoch: 18 | loss: 0.0666296
	speed: 0.0094s/iter; left time: 23.3501s
	iters: 300, epoch: 18 | loss: 0.0681162
	speed: 0.0093s/iter; left time: 22.2641s
	iters: 400, epoch: 18 | loss: 0.0746048
	speed: 0.0093s/iter; left time: 21.2845s
	iters: 500, epoch: 18 | loss: 0.0731742
	speed: 0.0093s/iter; left time: 20.3379s
	iters: 600, epoch: 18 | loss: 0.0686330
	speed: 0.0093s/iter; left time: 19.3778s
	iters: 700, epoch: 18 | loss: 0.0772570
	speed: 0.0093s/iter; left time: 18.4536s
	iters: 800, epoch: 18 | loss: 0.0734346
	speed: 0.0093s/iter; left time: 17.6058s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.60s
Steps: 894 | Train Loss: 0.0713043 Vali Loss: 0.0812010 Test Loss: 0.0872498
Validation loss decreased (0.081239 --> 0.081201).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0780274
	speed: 0.0399s/iter; left time: 67.3932s
	iters: 200, epoch: 19 | loss: 0.0720917
	speed: 0.0087s/iter; left time: 13.8060s
	iters: 300, epoch: 19 | loss: 0.0756924
	speed: 0.0087s/iter; left time: 12.8893s
	iters: 400, epoch: 19 | loss: 0.0794804
	speed: 0.0086s/iter; left time: 12.0127s
	iters: 500, epoch: 19 | loss: 0.0738623
	speed: 0.0086s/iter; left time: 11.1391s
	iters: 600, epoch: 19 | loss: 0.0832400
	speed: 0.0085s/iter; left time: 10.0487s
	iters: 700, epoch: 19 | loss: 0.0738254
	speed: 0.0085s/iter; left time: 9.2129s
	iters: 800, epoch: 19 | loss: 0.0652518
	speed: 0.0084s/iter; left time: 8.3385s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.91s
Steps: 894 | Train Loss: 0.0709535 Vali Loss: 0.0810140 Test Loss: 0.0873328
Validation loss decreased (0.081201 --> 0.081014).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0775646
	speed: 0.0387s/iter; left time: 30.7890s
	iters: 200, epoch: 20 | loss: 0.0727784
	speed: 0.0085s/iter; left time: 5.8984s
	iters: 300, epoch: 20 | loss: 0.0710121
	speed: 0.0085s/iter; left time: 5.0459s
	iters: 400, epoch: 20 | loss: 0.0746401
	speed: 0.0085s/iter; left time: 4.1998s
	iters: 500, epoch: 20 | loss: 0.0682924
	speed: 0.0085s/iter; left time: 3.3717s
	iters: 600, epoch: 20 | loss: 0.0671866
	speed: 0.0087s/iter; left time: 2.5678s
	iters: 700, epoch: 20 | loss: 0.0769067
	speed: 0.0086s/iter; left time: 1.6769s
	iters: 800, epoch: 20 | loss: 0.0756626
	speed: 0.0085s/iter; left time: 0.8050s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.88s
Steps: 894 | Train Loss: 0.0706790 Vali Loss: 0.0810555 Test Loss: 0.0877031
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02112378552556038, rmse:0.145340234041214, mae:0.0873328149318695, rse:0.5499268174171448
Original data scale mse:2851058.5, rmse:1688.5078125, mae:1070.8997802734375, rse:0.11893877387046814
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1761340
	speed: 0.0110s/iter; left time: 195.1450s
	iters: 200, epoch: 1 | loss: 0.1442881
	speed: 0.0088s/iter; left time: 155.1859s
	iters: 300, epoch: 1 | loss: 0.1350050
	speed: 0.0088s/iter; left time: 154.0862s
	iters: 400, epoch: 1 | loss: 0.1279581
	speed: 0.0088s/iter; left time: 153.2417s
	iters: 500, epoch: 1 | loss: 0.1265344
	speed: 0.0088s/iter; left time: 152.1527s
	iters: 600, epoch: 1 | loss: 0.1189172
	speed: 0.0088s/iter; left time: 151.2547s
	iters: 700, epoch: 1 | loss: 0.1214259
	speed: 0.0087s/iter; left time: 150.3119s
	iters: 800, epoch: 1 | loss: 0.1136109
	speed: 0.0088s/iter; left time: 149.5119s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.08s
Steps: 894 | Train Loss: 0.1343771 Vali Loss: 0.1009048 Test Loss: 0.1035921
Validation loss decreased (inf --> 0.100905).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1085248
	speed: 0.0386s/iter; left time: 651.5003s
	iters: 200, epoch: 2 | loss: 0.0885387
	speed: 0.0085s/iter; left time: 142.0698s
	iters: 300, epoch: 2 | loss: 0.0964822
	speed: 0.0084s/iter; left time: 140.8283s
	iters: 400, epoch: 2 | loss: 0.0883560
	speed: 0.0084s/iter; left time: 139.8419s
	iters: 500, epoch: 2 | loss: 0.0825061
	speed: 0.0084s/iter; left time: 139.0946s
	iters: 600, epoch: 2 | loss: 0.0917150
	speed: 0.0084s/iter; left time: 138.0226s
	iters: 700, epoch: 2 | loss: 0.0800588
	speed: 0.0084s/iter; left time: 137.2597s
	iters: 800, epoch: 2 | loss: 0.0874557
	speed: 0.0084s/iter; left time: 136.3221s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.77s
Steps: 894 | Train Loss: 0.0928199 Vali Loss: 0.0841567 Test Loss: 0.0889222
Validation loss decreased (0.100905 --> 0.084157).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0892415
	speed: 0.0387s/iter; left time: 619.4884s
	iters: 200, epoch: 3 | loss: 0.0877660
	speed: 0.0087s/iter; left time: 138.4053s
	iters: 300, epoch: 3 | loss: 0.0936635
	speed: 0.0087s/iter; left time: 136.8345s
	iters: 400, epoch: 3 | loss: 0.0829858
	speed: 0.0085s/iter; left time: 132.7153s
	iters: 500, epoch: 3 | loss: 0.0800809
	speed: 0.0085s/iter; left time: 132.3058s
	iters: 600, epoch: 3 | loss: 0.0909075
	speed: 0.0085s/iter; left time: 131.1698s
	iters: 700, epoch: 3 | loss: 0.0901069
	speed: 0.0085s/iter; left time: 130.1334s
	iters: 800, epoch: 3 | loss: 0.0852634
	speed: 0.0085s/iter; left time: 129.8926s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.88s
Steps: 894 | Train Loss: 0.0857337 Vali Loss: 0.0828018 Test Loss: 0.0882786
Validation loss decreased (0.084157 --> 0.082802).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0836834
	speed: 0.0391s/iter; left time: 590.1731s
	iters: 200, epoch: 4 | loss: 0.0813850
	speed: 0.0084s/iter; left time: 126.4213s
	iters: 300, epoch: 4 | loss: 0.0831876
	speed: 0.0084s/iter; left time: 125.5469s
	iters: 400, epoch: 4 | loss: 0.0879111
	speed: 0.0084s/iter; left time: 124.9641s
	iters: 500, epoch: 4 | loss: 0.0850285
	speed: 0.0084s/iter; left time: 123.8057s
	iters: 600, epoch: 4 | loss: 0.0882107
	speed: 0.0085s/iter; left time: 124.7204s
	iters: 700, epoch: 4 | loss: 0.0826036
	speed: 0.0085s/iter; left time: 123.9265s
	iters: 800, epoch: 4 | loss: 0.0855715
	speed: 0.0085s/iter; left time: 122.9371s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.83s
Steps: 894 | Train Loss: 0.0832201 Vali Loss: 0.0822921 Test Loss: 0.0877924
Validation loss decreased (0.082802 --> 0.082292).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0745312
	speed: 0.0386s/iter; left time: 548.7240s
	iters: 200, epoch: 5 | loss: 0.0795702
	speed: 0.0085s/iter; left time: 119.8894s
	iters: 300, epoch: 5 | loss: 0.0846348
	speed: 0.0085s/iter; left time: 119.0214s
	iters: 400, epoch: 5 | loss: 0.0798955
	speed: 0.0085s/iter; left time: 118.0787s
	iters: 500, epoch: 5 | loss: 0.0791318
	speed: 0.0085s/iter; left time: 117.2715s
	iters: 600, epoch: 5 | loss: 0.0956186
	speed: 0.0085s/iter; left time: 116.4224s
	iters: 700, epoch: 5 | loss: 0.0846813
	speed: 0.0085s/iter; left time: 115.6041s
	iters: 800, epoch: 5 | loss: 0.0840697
	speed: 0.0085s/iter; left time: 114.8186s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.84s
Steps: 894 | Train Loss: 0.0814269 Vali Loss: 0.0824545 Test Loss: 0.0881976
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0802825
	speed: 0.0383s/iter; left time: 509.4798s
	iters: 200, epoch: 6 | loss: 0.0769161
	speed: 0.0085s/iter; left time: 112.0695s
	iters: 300, epoch: 6 | loss: 0.0843926
	speed: 0.0085s/iter; left time: 111.0928s
	iters: 400, epoch: 6 | loss: 0.0746516
	speed: 0.0085s/iter; left time: 110.2323s
	iters: 500, epoch: 6 | loss: 0.0739571
	speed: 0.0085s/iter; left time: 109.2796s
	iters: 600, epoch: 6 | loss: 0.0802201
	speed: 0.0085s/iter; left time: 108.3531s
	iters: 700, epoch: 6 | loss: 0.0757018
	speed: 0.0085s/iter; left time: 107.5032s
	iters: 800, epoch: 6 | loss: 0.0745845
	speed: 0.0085s/iter; left time: 106.6953s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.78s
Steps: 894 | Train Loss: 0.0797208 Vali Loss: 0.0831764 Test Loss: 0.0882166
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0820937
	speed: 0.0389s/iter; left time: 483.2372s
	iters: 200, epoch: 7 | loss: 0.0803651
	speed: 0.0087s/iter; left time: 107.1268s
	iters: 300, epoch: 7 | loss: 0.0732215
	speed: 0.0087s/iter; left time: 105.9536s
	iters: 400, epoch: 7 | loss: 0.0832034
	speed: 0.0087s/iter; left time: 104.9958s
	iters: 500, epoch: 7 | loss: 0.0772675
	speed: 0.0087s/iter; left time: 104.3846s
	iters: 600, epoch: 7 | loss: 0.0788731
	speed: 0.0087s/iter; left time: 103.4921s
	iters: 700, epoch: 7 | loss: 0.0798795
	speed: 0.0087s/iter; left time: 102.5813s
	iters: 800, epoch: 7 | loss: 0.0746496
	speed: 0.0087s/iter; left time: 101.7914s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.01s
Steps: 894 | Train Loss: 0.0783500 Vali Loss: 0.0829139 Test Loss: 0.0881045
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0841243
	speed: 0.0384s/iter; left time: 442.5803s
	iters: 200, epoch: 8 | loss: 0.0746083
	speed: 0.0085s/iter; left time: 97.0057s
	iters: 300, epoch: 8 | loss: 0.0762716
	speed: 0.0085s/iter; left time: 96.1197s
	iters: 400, epoch: 8 | loss: 0.0853525
	speed: 0.0085s/iter; left time: 95.2706s
	iters: 500, epoch: 8 | loss: 0.0830853
	speed: 0.0085s/iter; left time: 94.3464s
	iters: 600, epoch: 8 | loss: 0.0775082
	speed: 0.0085s/iter; left time: 93.4883s
	iters: 700, epoch: 8 | loss: 0.0733569
	speed: 0.0085s/iter; left time: 92.5330s
	iters: 800, epoch: 8 | loss: 0.0782840
	speed: 0.0085s/iter; left time: 91.7348s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.81s
Steps: 894 | Train Loss: 0.0771774 Vali Loss: 0.0826734 Test Loss: 0.0882902
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0766850
	speed: 0.0385s/iter; left time: 409.3904s
	iters: 200, epoch: 9 | loss: 0.0723158
	speed: 0.0086s/iter; left time: 90.0922s
	iters: 300, epoch: 9 | loss: 0.0761673
	speed: 0.0084s/iter; left time: 87.5056s
	iters: 400, epoch: 9 | loss: 0.0676531
	speed: 0.0084s/iter; left time: 86.5689s
	iters: 500, epoch: 9 | loss: 0.0745027
	speed: 0.0085s/iter; left time: 87.3335s
	iters: 600, epoch: 9 | loss: 0.0709937
	speed: 0.0086s/iter; left time: 87.3190s
	iters: 700, epoch: 9 | loss: 0.0757448
	speed: 0.0086s/iter; left time: 86.5379s
	iters: 800, epoch: 9 | loss: 0.0844225
	speed: 0.0086s/iter; left time: 85.6037s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.87s
Steps: 894 | Train Loss: 0.0760660 Vali Loss: 0.0828981 Test Loss: 0.0891567
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020908666774630547, rmse:0.14459829032421112, mae:0.08779238164424896, rse:0.5471194982528687
Original data scale mse:3054074.25, rmse:1747.5909423828125, mae:1107.2745361328125, rse:0.12310060858726501

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.02112378552556038, RMSE: 0.145340234041214, MAE: 0.0873328149318695, RSE: 0.5499268174171448
Unscaled Metrics - MSE: 2851058.5, RMSE: 1688.5078125, MAE: 1070.8997802734375, RSE: 0.11893877387046814

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.020908666774630547, RMSE: 0.14459829032421112, MAE: 0.08779238164424896, RSE: 0.5471194982528687
Unscaled Metrics - MSE: 3054074.25, RMSE: 1747.5909423828125, MAE: 1107.2745361328125, RSE: 0.12310060858726501
