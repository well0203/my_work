
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_24_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', if_relu=False, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=True, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=32, stride=16, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.7835768
	speed: 0.0278s/iter; left time: 496.7842s
	iters: 200, epoch: 1 | loss: 0.8247158
	speed: 0.0083s/iter; left time: 148.4237s
	iters: 300, epoch: 1 | loss: 0.5668569
	speed: 0.0083s/iter; left time: 147.1950s
	iters: 400, epoch: 1 | loss: 0.5366505
	speed: 0.0089s/iter; left time: 156.5683s
	iters: 500, epoch: 1 | loss: 0.4378085
	speed: 0.0095s/iter; left time: 165.9866s
	iters: 600, epoch: 1 | loss: 0.4385815
	speed: 0.0094s/iter; left time: 163.4744s
	iters: 700, epoch: 1 | loss: 0.3150007
	speed: 0.0093s/iter; left time: 160.5376s
	iters: 800, epoch: 1 | loss: 0.3513808
	speed: 0.0092s/iter; left time: 158.5484s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.56s
Steps: 899 | Train Loss: 0.5657614 Vali Loss: 0.3030852 Test Loss: 0.3195856
Validation loss decreased (inf --> 0.303085).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2811377
	speed: 0.0416s/iter; left time: 706.2950s
	iters: 200, epoch: 2 | loss: 0.2245053
	speed: 0.0094s/iter; left time: 159.4483s
	iters: 300, epoch: 2 | loss: 0.2280752
	speed: 0.0093s/iter; left time: 155.5515s
	iters: 400, epoch: 2 | loss: 0.2516705
	speed: 0.0089s/iter; left time: 148.5306s
	iters: 500, epoch: 2 | loss: 0.2207813
	speed: 0.0084s/iter; left time: 139.1800s
	iters: 600, epoch: 2 | loss: 0.1988525
	speed: 0.0084s/iter; left time: 138.3000s
	iters: 700, epoch: 2 | loss: 0.2861122
	speed: 0.0084s/iter; left time: 138.1030s
	iters: 800, epoch: 2 | loss: 0.2351522
	speed: 0.0084s/iter; left time: 137.2752s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.21s
Steps: 899 | Train Loss: 0.2414951 Vali Loss: 0.1957187 Test Loss: 0.2181529
Validation loss decreased (0.303085 --> 0.195719).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1944644
	speed: 0.0391s/iter; left time: 629.2548s
	iters: 200, epoch: 3 | loss: 0.1543076
	speed: 0.0083s/iter; left time: 132.7732s
	iters: 300, epoch: 3 | loss: 0.2332987
	speed: 0.0085s/iter; left time: 134.4245s
	iters: 400, epoch: 3 | loss: 0.1939734
	speed: 0.0083s/iter; left time: 131.6022s
	iters: 500, epoch: 3 | loss: 0.2383235
	speed: 0.0083s/iter; left time: 130.0864s
	iters: 600, epoch: 3 | loss: 0.2310721
	speed: 0.0083s/iter; left time: 129.0243s
	iters: 700, epoch: 3 | loss: 0.2077278
	speed: 0.0083s/iter; left time: 128.0568s
	iters: 800, epoch: 3 | loss: 0.2553486
	speed: 0.0083s/iter; left time: 127.9581s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.73s
Steps: 899 | Train Loss: 0.2042339 Vali Loss: 0.1872622 Test Loss: 0.2086066
Validation loss decreased (0.195719 --> 0.187262).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1480566
	speed: 0.0395s/iter; left time: 600.1554s
	iters: 200, epoch: 4 | loss: 0.1447536
	speed: 0.0115s/iter; left time: 172.9255s
	iters: 300, epoch: 4 | loss: 0.1823268
	speed: 0.0085s/iter; left time: 127.4606s
	iters: 400, epoch: 4 | loss: 0.1727345
	speed: 0.0085s/iter; left time: 127.0449s
	iters: 500, epoch: 4 | loss: 0.2184692
	speed: 0.0085s/iter; left time: 125.1010s
	iters: 600, epoch: 4 | loss: 0.1834781
	speed: 0.0328s/iter; left time: 482.1626s
	iters: 700, epoch: 4 | loss: 0.2177958
	speed: 0.0345s/iter; left time: 502.8820s
	iters: 800, epoch: 4 | loss: 0.1443295
	speed: 0.0257s/iter; left time: 371.5439s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:16.47s
Steps: 899 | Train Loss: 0.1937971 Vali Loss: 0.1854279 Test Loss: 0.2061511
Validation loss decreased (0.187262 --> 0.185428).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1993442
	speed: 0.1050s/iter; left time: 1500.5725s
	iters: 200, epoch: 5 | loss: 0.1535800
	speed: 0.0189s/iter; left time: 268.1962s
	iters: 300, epoch: 5 | loss: 0.1693922
	speed: 0.0303s/iter; left time: 427.2405s
	iters: 400, epoch: 5 | loss: 0.2449587
	speed: 0.0531s/iter; left time: 741.9841s
	iters: 500, epoch: 5 | loss: 0.1867730
	speed: 0.0522s/iter; left time: 725.4142s
	iters: 600, epoch: 5 | loss: 0.2548683
	speed: 0.0589s/iter; left time: 811.5928s
	iters: 700, epoch: 5 | loss: 0.1702230
	speed: 0.0539s/iter; left time: 737.7262s
	iters: 800, epoch: 5 | loss: 0.2071832
	speed: 0.0555s/iter; left time: 753.3285s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:40.19s
Steps: 899 | Train Loss: 0.1860370 Vali Loss: 0.1832404 Test Loss: 0.2085929
Validation loss decreased (0.185428 --> 0.183240).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1399768
	speed: 0.3109s/iter; left time: 4161.1398s
	iters: 200, epoch: 6 | loss: 0.1780338
	speed: 0.0507s/iter; left time: 674.0914s
	iters: 300, epoch: 6 | loss: 0.1449556
	speed: 0.0558s/iter; left time: 735.4998s
	iters: 400, epoch: 6 | loss: 0.1494177
	speed: 0.0501s/iter; left time: 655.9032s
	iters: 500, epoch: 6 | loss: 0.1471770
	speed: 0.0527s/iter; left time: 684.3773s
	iters: 600, epoch: 6 | loss: 0.1971005
	speed: 0.0567s/iter; left time: 730.8950s
	iters: 700, epoch: 6 | loss: 0.1737435
	speed: 0.0608s/iter; left time: 776.9017s
	iters: 800, epoch: 6 | loss: 0.1661763
	speed: 0.0495s/iter; left time: 628.5138s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:49.23s
Steps: 899 | Train Loss: 0.1809803 Vali Loss: 0.1768590 Test Loss: 0.2005989
Validation loss decreased (0.183240 --> 0.176859).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1630883
	speed: 0.2961s/iter; left time: 3697.4934s
	iters: 200, epoch: 7 | loss: 0.1172076
	speed: 0.0584s/iter; left time: 723.9225s
	iters: 300, epoch: 7 | loss: 0.2078372
	speed: 0.0527s/iter; left time: 648.0797s
	iters: 400, epoch: 7 | loss: 0.1424408
	speed: 0.0634s/iter; left time: 772.6041s
	iters: 500, epoch: 7 | loss: 0.2104602
	speed: 0.0532s/iter; left time: 642.8058s
	iters: 600, epoch: 7 | loss: 0.1793768
	speed: 0.0545s/iter; left time: 653.0571s
	iters: 700, epoch: 7 | loss: 0.1528571
	speed: 0.0557s/iter; left time: 661.7821s
	iters: 800, epoch: 7 | loss: 0.1644259
	speed: 0.0522s/iter; left time: 615.2578s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:50.44s
Steps: 899 | Train Loss: 0.1764016 Vali Loss: 0.1763669 Test Loss: 0.2002481
Validation loss decreased (0.176859 --> 0.176367).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1853698
	speed: 0.3151s/iter; left time: 3650.9301s
	iters: 200, epoch: 8 | loss: 0.1907266
	speed: 0.0559s/iter; left time: 641.7120s
	iters: 300, epoch: 8 | loss: 0.1670296
	speed: 0.0535s/iter; left time: 609.2343s
	iters: 400, epoch: 8 | loss: 0.1700782
	speed: 0.0554s/iter; left time: 625.7145s
	iters: 500, epoch: 8 | loss: 0.2030462
	speed: 0.0561s/iter; left time: 627.1916s
	iters: 600, epoch: 8 | loss: 0.1936078
	speed: 0.0655s/iter; left time: 726.1061s
	iters: 700, epoch: 8 | loss: 0.1747425
	speed: 0.0499s/iter; left time: 548.5171s
	iters: 800, epoch: 8 | loss: 0.1744118
	speed: 0.0520s/iter; left time: 566.6822s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:50.38s
Steps: 899 | Train Loss: 0.1729777 Vali Loss: 0.1740513 Test Loss: 0.1998474
Validation loss decreased (0.176367 --> 0.174051).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1632505
	speed: 0.3141s/iter; left time: 3357.3884s
	iters: 200, epoch: 9 | loss: 0.2057525
	speed: 0.0572s/iter; left time: 605.7902s
	iters: 300, epoch: 9 | loss: 0.1876450
	speed: 0.0555s/iter; left time: 581.6318s
	iters: 400, epoch: 9 | loss: 0.1695710
	speed: 0.0529s/iter; left time: 549.5782s
	iters: 500, epoch: 9 | loss: 0.1715747
	speed: 0.0542s/iter; left time: 557.8436s
	iters: 600, epoch: 9 | loss: 0.1842579
	speed: 0.0486s/iter; left time: 495.4311s
	iters: 700, epoch: 9 | loss: 0.1539045
	speed: 0.0551s/iter; left time: 556.1390s
	iters: 800, epoch: 9 | loss: 0.2464554
	speed: 0.0532s/iter; left time: 531.7365s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:49.79s
Steps: 899 | Train Loss: 0.1696618 Vali Loss: 0.1752442 Test Loss: 0.2006885
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1284842
	speed: 0.3220s/iter; left time: 3152.7751s
	iters: 200, epoch: 10 | loss: 0.1929909
	speed: 0.0581s/iter; left time: 563.2926s
	iters: 300, epoch: 10 | loss: 0.1720825
	speed: 0.0522s/iter; left time: 500.7769s
	iters: 400, epoch: 10 | loss: 0.1903719
	speed: 0.0539s/iter; left time: 511.1767s
	iters: 500, epoch: 10 | loss: 0.1997257
	speed: 0.0498s/iter; left time: 467.4013s
	iters: 600, epoch: 10 | loss: 0.1246307
	speed: 0.0568s/iter; left time: 527.4383s
	iters: 700, epoch: 10 | loss: 0.1725681
	speed: 0.0574s/iter; left time: 527.8164s
	iters: 800, epoch: 10 | loss: 0.1906681
	speed: 0.0523s/iter; left time: 475.5131s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:51.07s
Steps: 899 | Train Loss: 0.1669421 Vali Loss: 0.1744406 Test Loss: 0.2016439
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1477170
	speed: 0.3253s/iter; left time: 2892.5006s
	iters: 200, epoch: 11 | loss: 0.1646312
	speed: 0.0521s/iter; left time: 458.1431s
	iters: 300, epoch: 11 | loss: 0.1340601
	speed: 0.0581s/iter; left time: 504.7293s
	iters: 400, epoch: 11 | loss: 0.1878843
	speed: 0.0570s/iter; left time: 489.5221s
	iters: 500, epoch: 11 | loss: 0.1579571
	speed: 0.0550s/iter; left time: 466.7581s
	iters: 600, epoch: 11 | loss: 0.1387180
	speed: 0.0505s/iter; left time: 423.7220s
	iters: 700, epoch: 11 | loss: 0.1574380
	speed: 0.0555s/iter; left time: 460.4920s
	iters: 800, epoch: 11 | loss: 0.1558878
	speed: 0.0522s/iter; left time: 427.4812s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:50.68s
Steps: 899 | Train Loss: 0.1644945 Vali Loss: 0.1733127 Test Loss: 0.2025027
Validation loss decreased (0.174051 --> 0.173313).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1747763
	speed: 0.3034s/iter; left time: 2424.9867s
	iters: 200, epoch: 12 | loss: 0.1798991
	speed: 0.0501s/iter; left time: 395.7514s
	iters: 300, epoch: 12 | loss: 0.1872625
	speed: 0.0559s/iter; left time: 435.3132s
	iters: 400, epoch: 12 | loss: 0.1446878
	speed: 0.0551s/iter; left time: 423.9105s
	iters: 500, epoch: 12 | loss: 0.1905347
	speed: 0.0561s/iter; left time: 426.0344s
	iters: 600, epoch: 12 | loss: 0.2089496
	speed: 0.0580s/iter; left time: 434.6529s
	iters: 700, epoch: 12 | loss: 0.1779407
	speed: 0.0492s/iter; left time: 363.3320s
	iters: 800, epoch: 12 | loss: 0.1710578
	speed: 0.0518s/iter; left time: 377.4933s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:49.50s
Steps: 899 | Train Loss: 0.1622358 Vali Loss: 0.1716515 Test Loss: 0.2008850
Validation loss decreased (0.173313 --> 0.171651).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1689993
	speed: 0.2992s/iter; left time: 2122.3671s
	iters: 200, epoch: 13 | loss: 0.1818331
	speed: 0.0542s/iter; left time: 379.2669s
	iters: 300, epoch: 13 | loss: 0.1252291
	speed: 0.0549s/iter; left time: 378.7050s
	iters: 400, epoch: 13 | loss: 0.1777937
	speed: 0.0541s/iter; left time: 367.4810s
	iters: 500, epoch: 13 | loss: 0.2506722
	speed: 0.0551s/iter; left time: 369.1177s
	iters: 600, epoch: 13 | loss: 0.1345320
	speed: 0.0505s/iter; left time: 332.9466s
	iters: 700, epoch: 13 | loss: 0.1778658
	speed: 0.0595s/iter; left time: 386.1021s
	iters: 800, epoch: 13 | loss: 0.2238196
	speed: 0.0558s/iter; left time: 356.8904s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:50.18s
Steps: 899 | Train Loss: 0.1602487 Vali Loss: 0.1712440 Test Loss: 0.2016205
Validation loss decreased (0.171651 --> 0.171244).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.2442018
	speed: 0.3063s/iter; left time: 1897.1468s
	iters: 200, epoch: 14 | loss: 0.1464531
	speed: 0.0558s/iter; left time: 339.7807s
	iters: 300, epoch: 14 | loss: 0.1778194
	speed: 0.0513s/iter; left time: 307.3956s
	iters: 400, epoch: 14 | loss: 0.1627585
	speed: 0.0642s/iter; left time: 378.1539s
	iters: 500, epoch: 14 | loss: 0.1943819
	speed: 0.0509s/iter; left time: 294.9219s
	iters: 600, epoch: 14 | loss: 0.2355634
	speed: 0.0537s/iter; left time: 305.5374s
	iters: 700, epoch: 14 | loss: 0.1658423
	speed: 0.0582s/iter; left time: 325.4646s
	iters: 800, epoch: 14 | loss: 0.1710691
	speed: 0.0578s/iter; left time: 317.8133s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:51.39s
Steps: 899 | Train Loss: 0.1583827 Vali Loss: 0.1719172 Test Loss: 0.2036489
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1797957
	speed: 0.3105s/iter; left time: 1644.0760s
	iters: 200, epoch: 15 | loss: 0.1562801
	speed: 0.0532s/iter; left time: 276.3456s
	iters: 300, epoch: 15 | loss: 0.1201042
	speed: 0.0533s/iter; left time: 271.4683s
	iters: 400, epoch: 15 | loss: 0.1427457
	speed: 0.0499s/iter; left time: 249.3056s
	iters: 500, epoch: 15 | loss: 0.1213190
	speed: 0.0540s/iter; left time: 264.3482s
	iters: 600, epoch: 15 | loss: 0.1619885
	speed: 0.0520s/iter; left time: 249.5020s
	iters: 700, epoch: 15 | loss: 0.1667436
	speed: 0.0534s/iter; left time: 250.6369s
	iters: 800, epoch: 15 | loss: 0.1192563
	speed: 0.0583s/iter; left time: 267.9409s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:48.86s
Steps: 899 | Train Loss: 0.1565270 Vali Loss: 0.1728543 Test Loss: 0.2048685
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.2316392
	speed: 0.3076s/iter; left time: 1352.1606s
	iters: 200, epoch: 16 | loss: 0.1556645
	speed: 0.0607s/iter; left time: 260.6348s
	iters: 300, epoch: 16 | loss: 0.1374122
	speed: 0.0512s/iter; left time: 214.7937s
	iters: 400, epoch: 16 | loss: 0.1514346
	speed: 0.0511s/iter; left time: 209.4569s
	iters: 500, epoch: 16 | loss: 0.1509137
	speed: 0.0581s/iter; left time: 232.3450s
	iters: 600, epoch: 16 | loss: 0.1117469
	speed: 0.0570s/iter; left time: 222.2365s
	iters: 700, epoch: 16 | loss: 0.1502796
	speed: 0.0509s/iter; left time: 193.0514s
	iters: 800, epoch: 16 | loss: 0.1709494
	speed: 0.0488s/iter; left time: 180.5421s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:48.95s
Steps: 899 | Train Loss: 0.1554063 Vali Loss: 0.1732487 Test Loss: 0.2034004
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1779117
	speed: 0.3098s/iter; left time: 1083.2228s
	iters: 200, epoch: 17 | loss: 0.1515591
	speed: 0.0505s/iter; left time: 171.6725s
	iters: 300, epoch: 17 | loss: 0.1311705
	speed: 0.0537s/iter; left time: 177.0764s
	iters: 400, epoch: 17 | loss: 0.1984616
	speed: 0.0539s/iter; left time: 172.4779s
	iters: 500, epoch: 17 | loss: 0.1769482
	speed: 0.0585s/iter; left time: 181.3148s
	iters: 600, epoch: 17 | loss: 0.2197677
	speed: 0.0534s/iter; left time: 159.9323s
	iters: 700, epoch: 17 | loss: 0.0951977
	speed: 0.0486s/iter; left time: 140.6496s
	iters: 800, epoch: 17 | loss: 0.1690862
	speed: 0.0509s/iter; left time: 142.4933s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:48.52s
Steps: 899 | Train Loss: 0.1536552 Vali Loss: 0.1726733 Test Loss: 0.2033207
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1568015
	speed: 0.3023s/iter; left time: 785.3435s
	iters: 200, epoch: 18 | loss: 0.2056298
	speed: 0.0505s/iter; left time: 126.0983s
	iters: 300, epoch: 18 | loss: 0.1615719
	speed: 0.0482s/iter; left time: 115.5681s
	iters: 400, epoch: 18 | loss: 0.1186625
	speed: 0.0470s/iter; left time: 107.9541s
	iters: 500, epoch: 18 | loss: 0.1271502
	speed: 0.0539s/iter; left time: 118.3638s
	iters: 600, epoch: 18 | loss: 0.1760904
	speed: 0.0548s/iter; left time: 114.9969s
	iters: 700, epoch: 18 | loss: 0.1818802
	speed: 0.0530s/iter; left time: 105.8034s
	iters: 800, epoch: 18 | loss: 0.1591147
	speed: 0.0591s/iter; left time: 112.1642s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:47.89s
Steps: 899 | Train Loss: 0.1525800 Vali Loss: 0.1729590 Test Loss: 0.2042684
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.20162047445774078, rmse:0.44902169704437256, mae:0.2636471688747406, rse:0.4112309217453003
Original data scale mse:1205259.875, rmse:1097.84326171875, mae:717.048095703125, rse:0.07714803516864777
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.7725865
	speed: 0.0603s/iter; left time: 1077.9925s
	iters: 200, epoch: 1 | loss: 0.6833057
	speed: 0.0618s/iter; left time: 1098.3127s
	iters: 300, epoch: 1 | loss: 0.4966044
	speed: 0.0552s/iter; left time: 975.2339s
	iters: 400, epoch: 1 | loss: 0.6127493
	speed: 0.0484s/iter; left time: 850.1665s
	iters: 500, epoch: 1 | loss: 0.4756226
	speed: 0.0528s/iter; left time: 923.8076s
	iters: 600, epoch: 1 | loss: 0.4483727
	speed: 0.0528s/iter; left time: 917.3721s
	iters: 700, epoch: 1 | loss: 0.4262236
	speed: 0.0522s/iter; left time: 902.3904s
	iters: 800, epoch: 1 | loss: 0.3367139
	speed: 0.0539s/iter; left time: 925.7519s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:49.34s
Steps: 899 | Train Loss: 0.5326795 Vali Loss: 0.2936419 Test Loss: 0.3113503
Validation loss decreased (inf --> 0.293642).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2904617
	speed: 0.3113s/iter; left time: 5286.9655s
	iters: 200, epoch: 2 | loss: 0.3001018
	speed: 0.0574s/iter; left time: 969.1165s
	iters: 300, epoch: 2 | loss: 0.2747088
	speed: 0.0599s/iter; left time: 1004.6355s
	iters: 400, epoch: 2 | loss: 0.3097885
	speed: 0.0574s/iter; left time: 957.4899s
	iters: 500, epoch: 2 | loss: 0.2737598
	speed: 0.0487s/iter; left time: 807.9825s
	iters: 600, epoch: 2 | loss: 0.2177521
	speed: 0.0543s/iter; left time: 895.1412s
	iters: 700, epoch: 2 | loss: 0.2075630
	speed: 0.0527s/iter; left time: 863.1028s
	iters: 800, epoch: 2 | loss: 0.2651642
	speed: 0.0460s/iter; left time: 749.5319s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:49.44s
Steps: 899 | Train Loss: 0.2395176 Vali Loss: 0.1925280 Test Loss: 0.2147795
Validation loss decreased (0.293642 --> 0.192528).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3059070
	speed: 0.3048s/iter; left time: 4902.3750s
	iters: 200, epoch: 3 | loss: 0.2246386
	speed: 0.0517s/iter; left time: 826.8915s
	iters: 300, epoch: 3 | loss: 0.1968952
	speed: 0.0519s/iter; left time: 824.7796s
	iters: 400, epoch: 3 | loss: 0.2077367
	speed: 0.0520s/iter; left time: 820.5465s
	iters: 500, epoch: 3 | loss: 0.1968109
	speed: 0.0493s/iter; left time: 773.8015s
	iters: 600, epoch: 3 | loss: 0.2248035
	speed: 0.0533s/iter; left time: 830.7991s
	iters: 700, epoch: 3 | loss: 0.1950904
	speed: 0.0564s/iter; left time: 872.6111s
	iters: 800, epoch: 3 | loss: 0.2330257
	speed: 0.0495s/iter; left time: 761.5411s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:47.91s
Steps: 899 | Train Loss: 0.2025505 Vali Loss: 0.1877191 Test Loss: 0.2111579
Validation loss decreased (0.192528 --> 0.187719).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2537986
	speed: 0.2992s/iter; left time: 4542.7640s
	iters: 200, epoch: 4 | loss: 0.1772013
	speed: 0.0519s/iter; left time: 783.1615s
	iters: 300, epoch: 4 | loss: 0.2245910
	speed: 0.0559s/iter; left time: 837.5834s
	iters: 400, epoch: 4 | loss: 0.1456292
	speed: 0.0544s/iter; left time: 809.7152s
	iters: 500, epoch: 4 | loss: 0.1757441
	speed: 0.0519s/iter; left time: 767.7354s
	iters: 600, epoch: 4 | loss: 0.2402209
	speed: 0.0504s/iter; left time: 739.7435s
	iters: 700, epoch: 4 | loss: 0.1843475
	speed: 0.0526s/iter; left time: 767.6778s
	iters: 800, epoch: 4 | loss: 0.2044414
	speed: 0.0529s/iter; left time: 766.3739s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:47.86s
Steps: 899 | Train Loss: 0.1920715 Vali Loss: 0.1826302 Test Loss: 0.2061761
Validation loss decreased (0.187719 --> 0.182630).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1853246
	speed: 0.3095s/iter; left time: 4421.4282s
	iters: 200, epoch: 5 | loss: 0.1525272
	speed: 0.0606s/iter; left time: 860.1354s
	iters: 300, epoch: 5 | loss: 0.1735278
	speed: 0.0504s/iter; left time: 709.3274s
	iters: 400, epoch: 5 | loss: 0.1450142
	speed: 0.0537s/iter; left time: 751.1680s
	iters: 500, epoch: 5 | loss: 0.1375235
	speed: 0.0465s/iter; left time: 645.6727s
	iters: 600, epoch: 5 | loss: 0.1848067
	speed: 0.0523s/iter; left time: 721.0078s
	iters: 700, epoch: 5 | loss: 0.2138237
	speed: 0.0465s/iter; left time: 636.6096s
	iters: 800, epoch: 5 | loss: 0.1744363
	speed: 0.0455s/iter; left time: 617.7827s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:47.46s
Steps: 899 | Train Loss: 0.1847066 Vali Loss: 0.1820181 Test Loss: 0.2065089
Validation loss decreased (0.182630 --> 0.182018).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1777489
	speed: 0.2952s/iter; left time: 3951.7078s
	iters: 200, epoch: 6 | loss: 0.1778791
	speed: 0.0523s/iter; left time: 694.2345s
	iters: 300, epoch: 6 | loss: 0.1232323
	speed: 0.0587s/iter; left time: 773.9486s
	iters: 400, epoch: 6 | loss: 0.1789007
	speed: 0.0626s/iter; left time: 818.6075s
	iters: 500, epoch: 6 | loss: 0.1866260
	speed: 0.0446s/iter; left time: 578.6724s
	iters: 600, epoch: 6 | loss: 0.1396412
	speed: 0.0189s/iter; left time: 243.9072s
	iters: 700, epoch: 6 | loss: 0.1856884
	speed: 0.0401s/iter; left time: 512.7419s
	iters: 800, epoch: 6 | loss: 0.1585015
	speed: 0.0531s/iter; left time: 673.4595s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:44.14s
Steps: 899 | Train Loss: 0.1794414 Vali Loss: 0.1797417 Test Loss: 0.2012473
Validation loss decreased (0.182018 --> 0.179742).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1680326
	speed: 0.2963s/iter; left time: 3700.1886s
	iters: 200, epoch: 7 | loss: 0.1770180
	speed: 0.0535s/iter; left time: 662.4665s
	iters: 300, epoch: 7 | loss: 0.2275322
	speed: 0.0508s/iter; left time: 624.2051s
	iters: 400, epoch: 7 | loss: 0.2171821
	speed: 0.0499s/iter; left time: 607.5432s
	iters: 500, epoch: 7 | loss: 0.1867231
	speed: 0.0523s/iter; left time: 632.3544s
	iters: 600, epoch: 7 | loss: 0.2203903
	speed: 0.0539s/iter; left time: 646.1548s
	iters: 700, epoch: 7 | loss: 0.2059330
	speed: 0.0558s/iter; left time: 662.9720s
	iters: 800, epoch: 7 | loss: 0.1694414
	speed: 0.0573s/iter; left time: 675.9332s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:48.94s
Steps: 899 | Train Loss: 0.1755654 Vali Loss: 0.1794925 Test Loss: 0.2016378
Validation loss decreased (0.179742 --> 0.179493).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1808263
	speed: 0.3059s/iter; left time: 3544.3540s
	iters: 200, epoch: 8 | loss: 0.1297457
	speed: 0.0503s/iter; left time: 578.0863s
	iters: 300, epoch: 8 | loss: 0.1868977
	speed: 0.0486s/iter; left time: 553.2957s
	iters: 400, epoch: 8 | loss: 0.2619369
	speed: 0.0497s/iter; left time: 561.1470s
	iters: 500, epoch: 8 | loss: 0.1199670
	speed: 0.0595s/iter; left time: 665.1861s
	iters: 600, epoch: 8 | loss: 0.2039896
	speed: 0.0474s/iter; left time: 525.0726s
	iters: 700, epoch: 8 | loss: 0.2157608
	speed: 0.0525s/iter; left time: 577.1936s
	iters: 800, epoch: 8 | loss: 0.2136256
	speed: 0.0545s/iter; left time: 593.4917s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:48.30s
Steps: 899 | Train Loss: 0.1717362 Vali Loss: 0.1780235 Test Loss: 0.2035691
Validation loss decreased (0.179493 --> 0.178023).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1750274
	speed: 0.3005s/iter; left time: 3212.4146s
	iters: 200, epoch: 9 | loss: 0.1530153
	speed: 0.0582s/iter; left time: 616.3047s
	iters: 300, epoch: 9 | loss: 0.1595897
	speed: 0.0515s/iter; left time: 540.2457s
	iters: 400, epoch: 9 | loss: 0.1842402
	speed: 0.0495s/iter; left time: 513.9621s
	iters: 500, epoch: 9 | loss: 0.1553181
	speed: 0.0504s/iter; left time: 519.0779s
	iters: 600, epoch: 9 | loss: 0.1271841
	speed: 0.0544s/iter; left time: 554.3092s
	iters: 700, epoch: 9 | loss: 0.1570895
	speed: 0.0540s/iter; left time: 544.4484s
	iters: 800, epoch: 9 | loss: 0.1590267
	speed: 0.0503s/iter; left time: 502.7740s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:49.08s
Steps: 899 | Train Loss: 0.1683953 Vali Loss: 0.1743404 Test Loss: 0.2021225
Validation loss decreased (0.178023 --> 0.174340).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.2743678
	speed: 0.3304s/iter; left time: 3234.7025s
	iters: 200, epoch: 10 | loss: 0.1181822
	speed: 0.0512s/iter; left time: 495.8382s
	iters: 300, epoch: 10 | loss: 0.1561307
	speed: 0.0499s/iter; left time: 478.4133s
	iters: 400, epoch: 10 | loss: 0.1397250
	speed: 0.0520s/iter; left time: 493.7157s
	iters: 500, epoch: 10 | loss: 0.1683225
	speed: 0.0518s/iter; left time: 486.7879s
	iters: 600, epoch: 10 | loss: 0.1768161
	speed: 0.0481s/iter; left time: 447.1699s
	iters: 700, epoch: 10 | loss: 0.1857192
	speed: 0.0453s/iter; left time: 416.6517s
	iters: 800, epoch: 10 | loss: 0.1156062
	speed: 0.0522s/iter; left time: 474.6728s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:46.70s
Steps: 899 | Train Loss: 0.1657122 Vali Loss: 0.1773219 Test Loss: 0.2007642
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1770701
	speed: 0.3065s/iter; left time: 2725.1018s
	iters: 200, epoch: 11 | loss: 0.1241990
	speed: 0.0580s/iter; left time: 510.0181s
	iters: 300, epoch: 11 | loss: 0.1098084
	speed: 0.0520s/iter; left time: 452.2027s
	iters: 400, epoch: 11 | loss: 0.1386573
	speed: 0.0548s/iter; left time: 470.4621s
	iters: 500, epoch: 11 | loss: 0.1621366
	speed: 0.0595s/iter; left time: 504.9681s
	iters: 600, epoch: 11 | loss: 0.1835429
	speed: 0.0587s/iter; left time: 492.2419s
	iters: 700, epoch: 11 | loss: 0.1095438
	speed: 0.0609s/iter; left time: 504.9944s
	iters: 800, epoch: 11 | loss: 0.1446120
	speed: 0.0559s/iter; left time: 457.9225s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:51.13s
Steps: 899 | Train Loss: 0.1624647 Vali Loss: 0.1740125 Test Loss: 0.2016218
Validation loss decreased (0.174340 --> 0.174013).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1762031
	speed: 0.3181s/iter; left time: 2542.4072s
	iters: 200, epoch: 12 | loss: 0.1270645
	speed: 0.0524s/iter; left time: 413.6664s
	iters: 300, epoch: 12 | loss: 0.1512506
	speed: 0.0580s/iter; left time: 452.3183s
	iters: 400, epoch: 12 | loss: 0.2055338
	speed: 0.0527s/iter; left time: 405.1143s
	iters: 500, epoch: 12 | loss: 0.2040396
	speed: 0.0550s/iter; left time: 417.5014s
	iters: 600, epoch: 12 | loss: 0.1265583
	speed: 0.0565s/iter; left time: 423.4282s
	iters: 700, epoch: 12 | loss: 0.1134985
	speed: 0.0553s/iter; left time: 408.6930s
	iters: 800, epoch: 12 | loss: 0.1905216
	speed: 0.0523s/iter; left time: 381.1772s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:50.12s
Steps: 899 | Train Loss: 0.1611636 Vali Loss: 0.1747293 Test Loss: 0.2021780
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1508626
	speed: 0.3057s/iter; left time: 2168.3729s
	iters: 200, epoch: 13 | loss: 0.1480462
	speed: 0.0500s/iter; left time: 349.6396s
	iters: 300, epoch: 13 | loss: 0.2254022
	speed: 0.0551s/iter; left time: 379.9810s
	iters: 400, epoch: 13 | loss: 0.1629598
	speed: 0.0543s/iter; left time: 368.5373s
	iters: 500, epoch: 13 | loss: 0.1601937
	speed: 0.0489s/iter; left time: 327.5868s
	iters: 600, epoch: 13 | loss: 0.1615871
	speed: 0.0506s/iter; left time: 333.3392s
	iters: 700, epoch: 13 | loss: 0.1202649
	speed: 0.0491s/iter; left time: 318.8951s
	iters: 800, epoch: 13 | loss: 0.1575193
	speed: 0.0471s/iter; left time: 300.8640s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:47.24s
Steps: 899 | Train Loss: 0.1591607 Vali Loss: 0.1755999 Test Loss: 0.2019623
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1517907
	speed: 0.2850s/iter; left time: 1765.3141s
	iters: 200, epoch: 14 | loss: 0.1203807
	speed: 0.0290s/iter; left time: 176.5248s
	iters: 300, epoch: 14 | loss: 0.1182542
	speed: 0.0574s/iter; left time: 343.7788s
	iters: 400, epoch: 14 | loss: 0.1122303
	speed: 0.0594s/iter; left time: 350.3612s
	iters: 500, epoch: 14 | loss: 0.1240817
	speed: 0.0499s/iter; left time: 289.1801s
	iters: 600, epoch: 14 | loss: 0.1866452
	speed: 0.0546s/iter; left time: 310.6556s
	iters: 700, epoch: 14 | loss: 0.1255808
	speed: 0.0481s/iter; left time: 269.3304s
	iters: 800, epoch: 14 | loss: 0.1513176
	speed: 0.0486s/iter; left time: 267.1667s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:43.97s
Steps: 899 | Train Loss: 0.1571160 Vali Loss: 0.1737460 Test Loss: 0.2021376
Validation loss decreased (0.174013 --> 0.173746).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.2035314
	speed: 0.3007s/iter; left time: 1591.9579s
	iters: 200, epoch: 15 | loss: 0.1704706
	speed: 0.0565s/iter; left time: 293.5217s
	iters: 300, epoch: 15 | loss: 0.1309569
	speed: 0.0481s/iter; left time: 245.0545s
	iters: 400, epoch: 15 | loss: 0.1219474
	speed: 0.0471s/iter; left time: 235.2226s
	iters: 500, epoch: 15 | loss: 0.2026114
	speed: 0.0491s/iter; left time: 240.3929s
	iters: 600, epoch: 15 | loss: 0.1685250
	speed: 0.0486s/iter; left time: 232.9041s
	iters: 700, epoch: 15 | loss: 0.2032798
	speed: 0.0527s/iter; left time: 247.2526s
	iters: 800, epoch: 15 | loss: 0.1484709
	speed: 0.0525s/iter; left time: 241.3813s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:46.24s
Steps: 899 | Train Loss: 0.1559366 Vali Loss: 0.1734128 Test Loss: 0.2025272
Validation loss decreased (0.173746 --> 0.173413).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1326342
	speed: 0.3155s/iter; left time: 1386.7721s
	iters: 200, epoch: 16 | loss: 0.1496808
	speed: 0.0481s/iter; left time: 206.4489s
	iters: 300, epoch: 16 | loss: 0.1100202
	speed: 0.0395s/iter; left time: 165.7936s
	iters: 400, epoch: 16 | loss: 0.1080719
	speed: 0.0334s/iter; left time: 136.7696s
	iters: 500, epoch: 16 | loss: 0.1434888
	speed: 0.0292s/iter; left time: 116.6839s
	iters: 600, epoch: 16 | loss: 0.1269533
	speed: 0.0301s/iter; left time: 117.3100s
	iters: 700, epoch: 16 | loss: 0.1689320
	speed: 0.0218s/iter; left time: 82.8143s
	iters: 800, epoch: 16 | loss: 0.1111811
	speed: 0.0198s/iter; left time: 73.1205s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:30.71s
Steps: 899 | Train Loss: 0.1539463 Vali Loss: 0.1757859 Test Loss: 0.2043217
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1447350
	speed: 0.0944s/iter; left time: 330.0668s
	iters: 200, epoch: 17 | loss: 0.1815556
	speed: 0.0185s/iter; left time: 62.9181s
	iters: 300, epoch: 17 | loss: 0.1619833
	speed: 0.0180s/iter; left time: 59.3501s
	iters: 400, epoch: 17 | loss: 0.1515302
	speed: 0.0179s/iter; left time: 57.0907s
	iters: 500, epoch: 17 | loss: 0.1541683
	speed: 0.0169s/iter; left time: 52.2694s
	iters: 600, epoch: 17 | loss: 0.1192075
	speed: 0.0142s/iter; left time: 42.5976s
	iters: 700, epoch: 17 | loss: 0.1629592
	speed: 0.0116s/iter; left time: 33.6153s
	iters: 800, epoch: 17 | loss: 0.1591187
	speed: 0.0118s/iter; left time: 32.9425s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:14.38s
Steps: 899 | Train Loss: 0.1531382 Vali Loss: 0.1745626 Test Loss: 0.2040336
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1607784
	speed: 0.0519s/iter; left time: 134.8362s
	iters: 200, epoch: 18 | loss: 0.1634651
	speed: 0.0108s/iter; left time: 26.9739s
	iters: 300, epoch: 18 | loss: 0.2124223
	speed: 0.0105s/iter; left time: 25.1023s
	iters: 400, epoch: 18 | loss: 0.1667200
	speed: 0.0104s/iter; left time: 23.9760s
	iters: 500, epoch: 18 | loss: 0.1123230
	speed: 0.0122s/iter; left time: 26.7297s
	iters: 600, epoch: 18 | loss: 0.1122164
	speed: 0.0108s/iter; left time: 22.6566s
	iters: 700, epoch: 18 | loss: 0.1468484
	speed: 0.0105s/iter; left time: 21.0742s
	iters: 800, epoch: 18 | loss: 0.1418234
	speed: 0.0101s/iter; left time: 19.1412s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:10.00s
Steps: 899 | Train Loss: 0.1519652 Vali Loss: 0.1756739 Test Loss: 0.2048890
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1506396
	speed: 0.0502s/iter; left time: 85.3547s
	iters: 200, epoch: 19 | loss: 0.1325819
	speed: 0.0106s/iter; left time: 16.9049s
	iters: 300, epoch: 19 | loss: 0.1626580
	speed: 0.0108s/iter; left time: 16.1192s
	iters: 400, epoch: 19 | loss: 0.1799445
	speed: 0.0112s/iter; left time: 15.6656s
	iters: 500, epoch: 19 | loss: 0.1741313
	speed: 0.0107s/iter; left time: 13.8682s
	iters: 600, epoch: 19 | loss: 0.1584232
	speed: 0.0107s/iter; left time: 12.8221s
	iters: 700, epoch: 19 | loss: 0.1279612
	speed: 0.0107s/iter; left time: 11.7531s
	iters: 800, epoch: 19 | loss: 0.1158247
	speed: 0.0102s/iter; left time: 10.1883s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:10.01s
Steps: 899 | Train Loss: 0.1508698 Vali Loss: 0.1745520 Test Loss: 0.2032585
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1795754
	speed: 0.0483s/iter; left time: 38.6735s
	iters: 200, epoch: 20 | loss: 0.1521554
	speed: 0.0095s/iter; left time: 6.6735s
	iters: 300, epoch: 20 | loss: 0.1934522
	speed: 0.0099s/iter; left time: 5.9298s
	iters: 400, epoch: 20 | loss: 0.1108449
	speed: 0.0098s/iter; left time: 4.8878s
	iters: 500, epoch: 20 | loss: 0.1611713
	speed: 0.0098s/iter; left time: 3.9324s
	iters: 600, epoch: 20 | loss: 0.1532575
	speed: 0.0102s/iter; left time: 3.0487s
	iters: 700, epoch: 20 | loss: 0.1145113
	speed: 0.0096s/iter; left time: 1.9152s
	iters: 800, epoch: 20 | loss: 0.1155148
	speed: 0.0095s/iter; left time: 0.9524s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.09s
Steps: 899 | Train Loss: 0.1498911 Vali Loss: 0.1750316 Test Loss: 0.2044495
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.20252715051174164, rmse:0.4500301778316498, mae:0.26186490058898926, rse:0.41215452551841736
Original data scale mse:1178370.25, rmse:1085.527587890625, mae:706.22900390625, rse:0.07628258317708969

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.20162047445774078, RMSE: 0.44902169704437256, MAE: 0.2636471688747406, RSE: 0.4112309217453003
Unscaled Metrics - MSE: 1205259.875, RMSE: 1097.84326171875, MAE: 717.048095703125, RSE: 0.07714803516864777

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.20252715051174164, RMSE: 0.4500301778316498, MAE: 0.26186490058898926, RSE: 0.41215452551841736
Unscaled Metrics - MSE: 1178370.25, RMSE: 1085.527587890625, MAE: 706.22900390625, RSE: 0.07628258317708969

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_96_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', if_relu=False, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=True, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=32, stride=16, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.9023709
	speed: 0.0282s/iter; left time: 503.1490s
	iters: 200, epoch: 1 | loss: 0.7118683
	speed: 0.0098s/iter; left time: 173.5451s
	iters: 300, epoch: 1 | loss: 0.6303343
	speed: 0.0098s/iter; left time: 172.5990s
	iters: 400, epoch: 1 | loss: 0.5885646
	speed: 0.0098s/iter; left time: 171.9060s
	iters: 500, epoch: 1 | loss: 0.5786479
	speed: 0.0097s/iter; left time: 168.3732s
	iters: 600, epoch: 1 | loss: 0.5647266
	speed: 0.0092s/iter; left time: 159.4035s
	iters: 700, epoch: 1 | loss: 0.5192021
	speed: 0.0092s/iter; left time: 157.9376s
	iters: 800, epoch: 1 | loss: 0.6190587
	speed: 0.0089s/iter; left time: 152.2742s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.99s
Steps: 897 | Train Loss: 0.6541967 Vali Loss: 0.4185980 Test Loss: 0.4427737
Validation loss decreased (inf --> 0.418598).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4385380
	speed: 0.0439s/iter; left time: 744.0321s
	iters: 200, epoch: 2 | loss: 0.3624427
	speed: 0.0091s/iter; left time: 152.8820s
	iters: 300, epoch: 2 | loss: 0.3435023
	speed: 0.0088s/iter; left time: 147.9554s
	iters: 400, epoch: 2 | loss: 0.3864345
	speed: 0.0088s/iter; left time: 146.6755s
	iters: 500, epoch: 2 | loss: 0.3963156
	speed: 0.0088s/iter; left time: 146.1709s
	iters: 600, epoch: 2 | loss: 0.3259863
	speed: 0.0090s/iter; left time: 147.6111s
	iters: 700, epoch: 2 | loss: 0.2913958
	speed: 0.0091s/iter; left time: 148.1030s
	iters: 800, epoch: 2 | loss: 0.3540556
	speed: 0.0091s/iter; left time: 147.4698s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.30s
Steps: 897 | Train Loss: 0.3849244 Vali Loss: 0.3303383 Test Loss: 0.3639398
Validation loss decreased (0.418598 --> 0.330338).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3262998
	speed: 0.0440s/iter; left time: 706.1828s
	iters: 200, epoch: 3 | loss: 0.3514427
	speed: 0.0112s/iter; left time: 177.9090s
	iters: 300, epoch: 3 | loss: 0.2741455
	speed: 0.0112s/iter; left time: 177.1670s
	iters: 400, epoch: 3 | loss: 0.3516659
	speed: 0.0111s/iter; left time: 174.2606s
	iters: 500, epoch: 3 | loss: 0.2425122
	speed: 0.0111s/iter; left time: 174.2947s
	iters: 600, epoch: 3 | loss: 0.4527805
	speed: 0.0111s/iter; left time: 172.4975s
	iters: 700, epoch: 3 | loss: 0.3176483
	speed: 0.0111s/iter; left time: 171.5747s
	iters: 800, epoch: 3 | loss: 0.3269887
	speed: 0.0111s/iter; left time: 170.9929s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.22s
Steps: 897 | Train Loss: 0.3451432 Vali Loss: 0.3255730 Test Loss: 0.3585122
Validation loss decreased (0.330338 --> 0.325573).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3540097
	speed: 0.0461s/iter; left time: 698.8238s
	iters: 200, epoch: 4 | loss: 0.3148625
	speed: 0.0099s/iter; left time: 149.0388s
	iters: 300, epoch: 4 | loss: 0.3411119
	speed: 0.0099s/iter; left time: 147.7772s
	iters: 400, epoch: 4 | loss: 0.3427646
	speed: 0.0099s/iter; left time: 147.1675s
	iters: 500, epoch: 4 | loss: 0.2876420
	speed: 0.0098s/iter; left time: 145.0203s
	iters: 600, epoch: 4 | loss: 0.2727350
	speed: 0.0095s/iter; left time: 138.7818s
	iters: 700, epoch: 4 | loss: 0.4078430
	speed: 0.0087s/iter; left time: 126.9253s
	iters: 800, epoch: 4 | loss: 0.3040746
	speed: 0.0087s/iter; left time: 125.4491s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.75s
Steps: 897 | Train Loss: 0.3291367 Vali Loss: 0.3248031 Test Loss: 0.3559823
Validation loss decreased (0.325573 --> 0.324803).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2959689
	speed: 0.0434s/iter; left time: 619.2751s
	iters: 200, epoch: 5 | loss: 0.2718244
	speed: 0.0096s/iter; left time: 135.7537s
	iters: 300, epoch: 5 | loss: 0.3076138
	speed: 0.0098s/iter; left time: 137.2085s
	iters: 400, epoch: 5 | loss: 0.3788649
	speed: 0.0104s/iter; left time: 145.0328s
	iters: 500, epoch: 5 | loss: 0.3968827
	speed: 0.0107s/iter; left time: 147.8127s
	iters: 600, epoch: 5 | loss: 0.2708218
	speed: 0.0108s/iter; left time: 148.6984s
	iters: 700, epoch: 5 | loss: 0.3091637
	speed: 0.0110s/iter; left time: 149.5799s
	iters: 800, epoch: 5 | loss: 0.4585109
	speed: 0.0106s/iter; left time: 143.9607s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.66s
Steps: 897 | Train Loss: 0.3149863 Vali Loss: 0.3256806 Test Loss: 0.3516513
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2811923
	speed: 0.0441s/iter; left time: 589.4835s
	iters: 200, epoch: 6 | loss: 0.2290090
	speed: 0.0099s/iter; left time: 131.7363s
	iters: 300, epoch: 6 | loss: 0.2880462
	speed: 0.0099s/iter; left time: 130.5700s
	iters: 400, epoch: 6 | loss: 0.2915324
	speed: 0.0100s/iter; left time: 129.9936s
	iters: 500, epoch: 6 | loss: 0.2910326
	speed: 0.0099s/iter; left time: 128.3905s
	iters: 600, epoch: 6 | loss: 0.2661616
	speed: 0.0099s/iter; left time: 127.3850s
	iters: 700, epoch: 6 | loss: 0.3336972
	speed: 0.0099s/iter; left time: 126.3451s
	iters: 800, epoch: 6 | loss: 0.2644136
	speed: 0.0099s/iter; left time: 125.4576s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.12s
Steps: 897 | Train Loss: 0.3013755 Vali Loss: 0.3219759 Test Loss: 0.3569717
Validation loss decreased (0.324803 --> 0.321976).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3189336
	speed: 0.0439s/iter; left time: 547.4992s
	iters: 200, epoch: 7 | loss: 0.2478523
	speed: 0.0099s/iter; left time: 122.6009s
	iters: 300, epoch: 7 | loss: 0.2523442
	speed: 0.0100s/iter; left time: 122.4377s
	iters: 400, epoch: 7 | loss: 0.2517710
	speed: 0.0098s/iter; left time: 119.6278s
	iters: 500, epoch: 7 | loss: 0.2363069
	speed: 0.0097s/iter; left time: 116.8907s
	iters: 600, epoch: 7 | loss: 0.3667543
	speed: 0.0097s/iter; left time: 115.8728s
	iters: 700, epoch: 7 | loss: 0.3155922
	speed: 0.0096s/iter; left time: 114.4098s
	iters: 800, epoch: 7 | loss: 0.3187827
	speed: 0.0097s/iter; left time: 113.5488s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.01s
Steps: 897 | Train Loss: 0.2899064 Vali Loss: 0.3252428 Test Loss: 0.3613099
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2368941
	speed: 0.0410s/iter; left time: 474.5322s
	iters: 200, epoch: 8 | loss: 0.3146277
	speed: 0.0088s/iter; left time: 100.3525s
	iters: 300, epoch: 8 | loss: 0.3341261
	speed: 0.0088s/iter; left time: 99.5307s
	iters: 400, epoch: 8 | loss: 0.2582113
	speed: 0.0087s/iter; left time: 97.8464s
	iters: 500, epoch: 8 | loss: 0.2317291
	speed: 0.0086s/iter; left time: 96.2395s
	iters: 600, epoch: 8 | loss: 0.2649657
	speed: 0.0085s/iter; left time: 94.4907s
	iters: 700, epoch: 8 | loss: 0.2541209
	speed: 0.0085s/iter; left time: 92.7784s
	iters: 800, epoch: 8 | loss: 0.3090145
	speed: 0.0085s/iter; left time: 92.3328s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.97s
Steps: 897 | Train Loss: 0.2788857 Vali Loss: 0.3274610 Test Loss: 0.3629384
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.3449124
	speed: 0.0419s/iter; left time: 447.3623s
	iters: 200, epoch: 9 | loss: 0.2904998
	speed: 0.0094s/iter; left time: 99.7299s
	iters: 300, epoch: 9 | loss: 0.3058091
	speed: 0.0086s/iter; left time: 89.7378s
	iters: 400, epoch: 9 | loss: 0.2911087
	speed: 0.0086s/iter; left time: 88.7701s
	iters: 500, epoch: 9 | loss: 0.2553002
	speed: 0.0085s/iter; left time: 87.6438s
	iters: 600, epoch: 9 | loss: 0.2559891
	speed: 0.0085s/iter; left time: 86.6768s
	iters: 700, epoch: 9 | loss: 0.2762527
	speed: 0.0085s/iter; left time: 85.7415s
	iters: 800, epoch: 9 | loss: 0.2218111
	speed: 0.0085s/iter; left time: 84.9152s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.18s
Steps: 897 | Train Loss: 0.2698051 Vali Loss: 0.3284274 Test Loss: 0.3625137
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1887778
	speed: 0.0401s/iter; left time: 391.3520s
	iters: 200, epoch: 10 | loss: 0.2676644
	speed: 0.0086s/iter; left time: 83.6129s
	iters: 300, epoch: 10 | loss: 0.2241254
	speed: 0.0088s/iter; left time: 84.1405s
	iters: 400, epoch: 10 | loss: 0.3112211
	speed: 0.0088s/iter; left time: 83.3881s
	iters: 500, epoch: 10 | loss: 0.3208842
	speed: 0.0088s/iter; left time: 82.3660s
	iters: 600, epoch: 10 | loss: 0.2711429
	speed: 0.0089s/iter; left time: 82.7702s
	iters: 700, epoch: 10 | loss: 0.2398466
	speed: 0.0090s/iter; left time: 82.7740s
	iters: 800, epoch: 10 | loss: 0.2387672
	speed: 0.0095s/iter; left time: 86.2786s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.22s
Steps: 897 | Train Loss: 0.2630368 Vali Loss: 0.3263260 Test Loss: 0.3640893
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.2824947
	speed: 0.0412s/iter; left time: 365.3706s
	iters: 200, epoch: 11 | loss: 0.3002585
	speed: 0.0093s/iter; left time: 82.0047s
	iters: 300, epoch: 11 | loss: 0.2524710
	speed: 0.0097s/iter; left time: 83.7694s
	iters: 400, epoch: 11 | loss: 0.2440666
	speed: 0.0096s/iter; left time: 82.1302s
	iters: 500, epoch: 11 | loss: 0.2958998
	speed: 0.0087s/iter; left time: 73.3834s
	iters: 600, epoch: 11 | loss: 0.2014191
	speed: 0.0086s/iter; left time: 71.7001s
	iters: 700, epoch: 11 | loss: 0.3180931
	speed: 0.0087s/iter; left time: 71.7007s
	iters: 800, epoch: 11 | loss: 0.2397275
	speed: 0.0088s/iter; left time: 71.5266s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.33s
Steps: 897 | Train Loss: 0.2553044 Vali Loss: 0.3318979 Test Loss: 0.3675163
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.3569716811180115, rmse:0.5974710583686829, mae:0.3740488588809967, rse:0.5470473170280457
Original data scale mse:2492006.0, rmse:1578.60888671875, mae:1051.84912109375, rse:0.11109315603971481
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.8629879
	speed: 0.0113s/iter; left time: 201.8682s
	iters: 200, epoch: 1 | loss: 0.6752549
	speed: 0.0087s/iter; left time: 154.4018s
	iters: 300, epoch: 1 | loss: 0.6488466
	speed: 0.0087s/iter; left time: 153.5738s
	iters: 400, epoch: 1 | loss: 0.5567740
	speed: 0.0087s/iter; left time: 152.7643s
	iters: 500, epoch: 1 | loss: 0.5716978
	speed: 0.0087s/iter; left time: 151.5409s
	iters: 600, epoch: 1 | loss: 0.5107291
	speed: 0.0085s/iter; left time: 147.4614s
	iters: 700, epoch: 1 | loss: 0.4878373
	speed: 0.0085s/iter; left time: 146.9255s
	iters: 800, epoch: 1 | loss: 0.5672198
	speed: 0.0085s/iter; left time: 145.7925s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.02s
Steps: 897 | Train Loss: 0.6482735 Vali Loss: 0.4182647 Test Loss: 0.4421777
Validation loss decreased (inf --> 0.418265).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4571468
	speed: 0.0409s/iter; left time: 692.8786s
	iters: 200, epoch: 2 | loss: 0.3971057
	speed: 0.0088s/iter; left time: 148.8949s
	iters: 300, epoch: 2 | loss: 0.3772953
	speed: 0.0090s/iter; left time: 150.2652s
	iters: 400, epoch: 2 | loss: 0.3412876
	speed: 0.0087s/iter; left time: 145.1766s
	iters: 500, epoch: 2 | loss: 0.3738047
	speed: 0.0087s/iter; left time: 144.1822s
	iters: 600, epoch: 2 | loss: 0.3636101
	speed: 0.0087s/iter; left time: 143.6296s
	iters: 700, epoch: 2 | loss: 0.3916110
	speed: 0.0087s/iter; left time: 142.9536s
	iters: 800, epoch: 2 | loss: 0.3499900
	speed: 0.0088s/iter; left time: 142.3915s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.16s
Steps: 897 | Train Loss: 0.3853006 Vali Loss: 0.3266637 Test Loss: 0.3616928
Validation loss decreased (0.418265 --> 0.326664).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2935314
	speed: 0.0413s/iter; left time: 662.3994s
	iters: 200, epoch: 3 | loss: 0.3492098
	speed: 0.0087s/iter; left time: 139.2570s
	iters: 300, epoch: 3 | loss: 0.3493505
	speed: 0.0087s/iter; left time: 138.0737s
	iters: 400, epoch: 3 | loss: 0.3928383
	speed: 0.0087s/iter; left time: 137.3829s
	iters: 500, epoch: 3 | loss: 0.3266641
	speed: 0.0087s/iter; left time: 136.5291s
	iters: 600, epoch: 3 | loss: 0.3293491
	speed: 0.0087s/iter; left time: 135.3267s
	iters: 700, epoch: 3 | loss: 0.3059039
	speed: 0.0087s/iter; left time: 134.8201s
	iters: 800, epoch: 3 | loss: 0.3485625
	speed: 0.0087s/iter; left time: 133.3259s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.10s
Steps: 897 | Train Loss: 0.3450314 Vali Loss: 0.3225645 Test Loss: 0.3597109
Validation loss decreased (0.326664 --> 0.322564).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3226652
	speed: 0.0412s/iter; left time: 623.8748s
	iters: 200, epoch: 4 | loss: 0.2863240
	speed: 0.0085s/iter; left time: 128.2373s
	iters: 300, epoch: 4 | loss: 0.3070149
	speed: 0.0085s/iter; left time: 127.3782s
	iters: 400, epoch: 4 | loss: 0.4306839
	speed: 0.0085s/iter; left time: 126.5066s
	iters: 500, epoch: 4 | loss: 0.3510099
	speed: 0.0085s/iter; left time: 126.0857s
	iters: 600, epoch: 4 | loss: 0.3462639
	speed: 0.0085s/iter; left time: 124.6492s
	iters: 700, epoch: 4 | loss: 0.2953328
	speed: 0.0085s/iter; left time: 123.5705s
	iters: 800, epoch: 4 | loss: 0.3172990
	speed: 0.0085s/iter; left time: 122.8154s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.90s
Steps: 897 | Train Loss: 0.3306733 Vali Loss: 0.3261314 Test Loss: 0.3599828
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3422692
	speed: 0.0415s/iter; left time: 592.0276s
	iters: 200, epoch: 5 | loss: 0.3456689
	speed: 0.0094s/iter; left time: 133.6041s
	iters: 300, epoch: 5 | loss: 0.2650091
	speed: 0.0094s/iter; left time: 132.7772s
	iters: 400, epoch: 5 | loss: 0.3323134
	speed: 0.0095s/iter; left time: 132.0405s
	iters: 500, epoch: 5 | loss: 0.2816601
	speed: 0.0095s/iter; left time: 131.7769s
	iters: 600, epoch: 5 | loss: 0.3381370
	speed: 0.0093s/iter; left time: 127.7407s
	iters: 700, epoch: 5 | loss: 0.2926513
	speed: 0.0089s/iter; left time: 121.7503s
	iters: 800, epoch: 5 | loss: 0.3868202
	speed: 0.0089s/iter; left time: 120.9035s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.60s
Steps: 897 | Train Loss: 0.3180861 Vali Loss: 0.3273807 Test Loss: 0.3581979
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3938394
	speed: 0.0409s/iter; left time: 546.4599s
	iters: 200, epoch: 6 | loss: 0.3244178
	speed: 0.0086s/iter; left time: 114.4280s
	iters: 300, epoch: 6 | loss: 0.2895657
	speed: 0.0086s/iter; left time: 113.5985s
	iters: 400, epoch: 6 | loss: 0.3295440
	speed: 0.0087s/iter; left time: 113.1087s
	iters: 500, epoch: 6 | loss: 0.3089418
	speed: 0.0087s/iter; left time: 112.0812s
	iters: 600, epoch: 6 | loss: 0.2791779
	speed: 0.0086s/iter; left time: 110.7398s
	iters: 700, epoch: 6 | loss: 0.2838320
	speed: 0.0086s/iter; left time: 110.0153s
	iters: 800, epoch: 6 | loss: 0.2849742
	speed: 0.0086s/iter; left time: 109.4151s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.01s
Steps: 897 | Train Loss: 0.3049860 Vali Loss: 0.3268445 Test Loss: 0.3606200
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3585132
	speed: 0.0397s/iter; left time: 494.5472s
	iters: 200, epoch: 7 | loss: 0.3335386
	speed: 0.0086s/iter; left time: 105.8707s
	iters: 300, epoch: 7 | loss: 0.2367492
	speed: 0.0085s/iter; left time: 103.9122s
	iters: 400, epoch: 7 | loss: 0.2773902
	speed: 0.0085s/iter; left time: 102.8646s
	iters: 500, epoch: 7 | loss: 0.3344440
	speed: 0.0085s/iter; left time: 102.0768s
	iters: 600, epoch: 7 | loss: 0.2715367
	speed: 0.0084s/iter; left time: 100.9791s
	iters: 700, epoch: 7 | loss: 0.3438804
	speed: 0.0084s/iter; left time: 100.1994s
	iters: 800, epoch: 7 | loss: 0.2747950
	speed: 0.0085s/iter; left time: 99.4910s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.89s
Steps: 897 | Train Loss: 0.2923166 Vali Loss: 0.3298374 Test Loss: 0.3664121
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2708820
	speed: 0.0397s/iter; left time: 458.8616s
	iters: 200, epoch: 8 | loss: 0.2638570
	speed: 0.0088s/iter; left time: 101.0449s
	iters: 300, epoch: 8 | loss: 0.2747504
	speed: 0.0088s/iter; left time: 100.2951s
	iters: 400, epoch: 8 | loss: 0.2798580
	speed: 0.0088s/iter; left time: 99.4373s
	iters: 500, epoch: 8 | loss: 0.2573391
	speed: 0.0088s/iter; left time: 98.5950s
	iters: 600, epoch: 8 | loss: 0.2728603
	speed: 0.0088s/iter; left time: 97.4456s
	iters: 700, epoch: 8 | loss: 0.2540934
	speed: 0.0087s/iter; left time: 95.6914s
	iters: 800, epoch: 8 | loss: 0.3003016
	speed: 0.0085s/iter; left time: 92.4053s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.05s
Steps: 897 | Train Loss: 0.2811039 Vali Loss: 0.3277870 Test Loss: 0.3645265
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.35971105098724365, rmse:0.5997591614723206, mae:0.38184961676597595, rse:0.5491423010826111
Original data scale mse:2693139.25, rmse:1641.0787353515625, mae:1101.3221435546875, rse:0.1154894083738327

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.3569716811180115, RMSE: 0.5974710583686829, MAE: 0.3740488588809967, RSE: 0.5470473170280457
Unscaled Metrics - MSE: 2492006.0, RMSE: 1578.60888671875, MAE: 1051.84912109375, RSE: 0.11109315603971481

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.35971105098724365, RMSE: 0.5997591614723206, MAE: 0.38184961676597595, RSE: 0.5491423010826111
Unscaled Metrics - MSE: 2693139.25, RMSE: 1641.0787353515625, MAE: 1101.3221435546875, RSE: 0.1154894083738327

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_168_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', if_relu=False, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=True, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=32, stride=16, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.8650291
	speed: 0.0279s/iter; left time: 496.9369s
	iters: 200, epoch: 1 | loss: 0.7120326
	speed: 0.0099s/iter; left time: 175.3667s
	iters: 300, epoch: 1 | loss: 0.6896478
	speed: 0.0099s/iter; left time: 174.1692s
	iters: 400, epoch: 1 | loss: 0.5948638
	speed: 0.0098s/iter; left time: 171.5536s
	iters: 500, epoch: 1 | loss: 0.6314639
	speed: 0.0095s/iter; left time: 165.4157s
	iters: 600, epoch: 1 | loss: 0.5181844
	speed: 0.0095s/iter; left time: 163.7991s
	iters: 700, epoch: 1 | loss: 0.5106045
	speed: 0.0097s/iter; left time: 166.4458s
	iters: 800, epoch: 1 | loss: 0.4941662
	speed: 0.0098s/iter; left time: 168.0926s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.17s
Steps: 894 | Train Loss: 0.6732572 Vali Loss: 0.4426865 Test Loss: 0.4611520
Validation loss decreased (inf --> 0.442687).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4362513
	speed: 0.0529s/iter; left time: 893.6151s
	iters: 200, epoch: 2 | loss: 0.4604670
	speed: 0.0098s/iter; left time: 164.6085s
	iters: 300, epoch: 2 | loss: 0.4379824
	speed: 0.0097s/iter; left time: 161.3915s
	iters: 400, epoch: 2 | loss: 0.4900250
	speed: 0.0087s/iter; left time: 145.1321s
	iters: 500, epoch: 2 | loss: 0.4331226
	speed: 0.0087s/iter; left time: 143.8991s
	iters: 600, epoch: 2 | loss: 0.4699836
	speed: 0.0087s/iter; left time: 142.9936s
	iters: 700, epoch: 2 | loss: 0.4339241
	speed: 0.0087s/iter; left time: 142.0913s
	iters: 800, epoch: 2 | loss: 0.4113488
	speed: 0.0087s/iter; left time: 141.4005s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.33s
Steps: 894 | Train Loss: 0.4139376 Vali Loss: 0.3605645 Test Loss: 0.3889714
Validation loss decreased (0.442687 --> 0.360565).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4390221
	speed: 0.0419s/iter; left time: 669.9696s
	iters: 200, epoch: 3 | loss: 0.3950980
	speed: 0.0095s/iter; left time: 151.2390s
	iters: 300, epoch: 3 | loss: 0.3587230
	speed: 0.0094s/iter; left time: 149.0659s
	iters: 400, epoch: 3 | loss: 0.4357815
	speed: 0.0095s/iter; left time: 148.5139s
	iters: 500, epoch: 3 | loss: 0.3138253
	speed: 0.0095s/iter; left time: 147.5424s
	iters: 600, epoch: 3 | loss: 0.4150011
	speed: 0.0094s/iter; left time: 146.2974s
	iters: 700, epoch: 3 | loss: 0.4086972
	speed: 0.0094s/iter; left time: 145.4562s
	iters: 800, epoch: 3 | loss: 0.4099678
	speed: 0.0095s/iter; left time: 145.6648s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.58s
Steps: 894 | Train Loss: 0.3723422 Vali Loss: 0.3634326 Test Loss: 0.3940627
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4114258
	speed: 0.1169s/iter; left time: 1765.4316s
	iters: 200, epoch: 4 | loss: 0.3320698
	speed: 0.0101s/iter; left time: 151.7917s
	iters: 300, epoch: 4 | loss: 0.3516684
	speed: 0.0099s/iter; left time: 148.1813s
	iters: 400, epoch: 4 | loss: 0.3376744
	speed: 0.0101s/iter; left time: 149.2491s
	iters: 500, epoch: 4 | loss: 0.3431910
	speed: 0.0101s/iter; left time: 148.5560s
	iters: 600, epoch: 4 | loss: 0.3279227
	speed: 0.0092s/iter; left time: 134.3854s
	iters: 700, epoch: 4 | loss: 0.3676272
	speed: 0.0089s/iter; left time: 129.2975s
	iters: 800, epoch: 4 | loss: 0.3017296
	speed: 0.0090s/iter; left time: 130.2814s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.69s
Steps: 894 | Train Loss: 0.3569012 Vali Loss: 0.3639124 Test Loss: 0.3991316
EarlyStopping counter: 2 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3147646
	speed: 0.0430s/iter; left time: 610.5645s
	iters: 200, epoch: 5 | loss: 0.3286140
	speed: 0.0090s/iter; left time: 126.9229s
	iters: 300, epoch: 5 | loss: 0.3863384
	speed: 0.0090s/iter; left time: 126.2358s
	iters: 400, epoch: 5 | loss: 0.3734428
	speed: 0.0089s/iter; left time: 124.1230s
	iters: 500, epoch: 5 | loss: 0.3287988
	speed: 0.0089s/iter; left time: 122.8669s
	iters: 600, epoch: 5 | loss: 0.3638388
	speed: 0.0089s/iter; left time: 122.0865s
	iters: 700, epoch: 5 | loss: 0.3051259
	speed: 0.0089s/iter; left time: 121.3409s
	iters: 800, epoch: 5 | loss: 0.3753051
	speed: 0.0089s/iter; left time: 120.0531s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.26s
Steps: 894 | Train Loss: 0.3395032 Vali Loss: 0.3558247 Test Loss: 0.3989559
Validation loss decreased (0.360565 --> 0.355825).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3599760
	speed: 0.0426s/iter; left time: 567.1500s
	iters: 200, epoch: 6 | loss: 0.2798906
	speed: 0.0089s/iter; left time: 117.8680s
	iters: 300, epoch: 6 | loss: 0.3275054
	speed: 0.0088s/iter; left time: 115.1580s
	iters: 400, epoch: 6 | loss: 0.3468530
	speed: 0.0087s/iter; left time: 113.3045s
	iters: 500, epoch: 6 | loss: 0.3237377
	speed: 0.0087s/iter; left time: 112.5037s
	iters: 600, epoch: 6 | loss: 0.3374587
	speed: 0.0087s/iter; left time: 111.6039s
	iters: 700, epoch: 6 | loss: 0.3852836
	speed: 0.0087s/iter; left time: 110.6774s
	iters: 800, epoch: 6 | loss: 0.2672887
	speed: 0.0087s/iter; left time: 109.9727s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.10s
Steps: 894 | Train Loss: 0.3226182 Vali Loss: 0.3672323 Test Loss: 0.3909459
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3234253
	speed: 0.0403s/iter; left time: 500.4227s
	iters: 200, epoch: 7 | loss: 0.2744628
	speed: 0.0085s/iter; left time: 105.0953s
	iters: 300, epoch: 7 | loss: 0.3141358
	speed: 0.0085s/iter; left time: 104.3614s
	iters: 400, epoch: 7 | loss: 0.3097932
	speed: 0.0086s/iter; left time: 103.8241s
	iters: 500, epoch: 7 | loss: 0.3496243
	speed: 0.0086s/iter; left time: 102.7672s
	iters: 600, epoch: 7 | loss: 0.3043375
	speed: 0.0089s/iter; left time: 105.7182s
	iters: 700, epoch: 7 | loss: 0.2879458
	speed: 0.0087s/iter; left time: 103.3687s
	iters: 800, epoch: 7 | loss: 0.2752822
	speed: 0.0087s/iter; left time: 101.5866s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.93s
Steps: 894 | Train Loss: 0.3074871 Vali Loss: 0.3651821 Test Loss: 0.4005122
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2724565
	speed: 0.0399s/iter; left time: 459.7613s
	iters: 200, epoch: 8 | loss: 0.2505352
	speed: 0.0087s/iter; left time: 99.5239s
	iters: 300, epoch: 8 | loss: 0.2884567
	speed: 0.0087s/iter; left time: 98.6576s
	iters: 400, epoch: 8 | loss: 0.2649095
	speed: 0.0087s/iter; left time: 98.0513s
	iters: 500, epoch: 8 | loss: 0.2546944
	speed: 0.0092s/iter; left time: 102.6023s
	iters: 600, epoch: 8 | loss: 0.2343189
	speed: 0.0118s/iter; left time: 130.5350s
	iters: 700, epoch: 8 | loss: 0.3500673
	speed: 0.0094s/iter; left time: 103.1629s
	iters: 800, epoch: 8 | loss: 0.2790954
	speed: 0.0097s/iter; left time: 104.7403s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.67s
Steps: 894 | Train Loss: 0.2940368 Vali Loss: 0.3688686 Test Loss: 0.4052595
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.2922402
	speed: 0.0717s/iter; left time: 761.6287s
	iters: 200, epoch: 9 | loss: 0.3136761
	speed: 0.0574s/iter; left time: 604.4345s
	iters: 300, epoch: 9 | loss: 0.2904491
	speed: 0.0577s/iter; left time: 602.2715s
	iters: 400, epoch: 9 | loss: 0.2847520
	speed: 0.0591s/iter; left time: 610.3531s
	iters: 500, epoch: 9 | loss: 0.2848399
	speed: 0.0656s/iter; left time: 670.5793s
	iters: 600, epoch: 9 | loss: 0.2818712
	speed: 0.0578s/iter; left time: 585.5562s
	iters: 700, epoch: 9 | loss: 0.2508163
	speed: 0.0539s/iter; left time: 540.8591s
	iters: 800, epoch: 9 | loss: 0.3206994
	speed: 0.0600s/iter; left time: 595.3051s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:50.64s
Steps: 894 | Train Loss: 0.2835710 Vali Loss: 0.3636105 Test Loss: 0.4030739
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.2489856
	speed: 0.3131s/iter; left time: 3048.4808s
	iters: 200, epoch: 10 | loss: 0.2740938
	speed: 0.0643s/iter; left time: 619.8657s
	iters: 300, epoch: 10 | loss: 0.2727333
	speed: 0.0468s/iter; left time: 446.6015s
	iters: 400, epoch: 10 | loss: 0.2735113
	speed: 0.0230s/iter; left time: 216.6768s
	iters: 500, epoch: 10 | loss: 0.2991241
	speed: 0.0209s/iter; left time: 195.3285s
	iters: 600, epoch: 10 | loss: 0.2883359
	speed: 0.0131s/iter; left time: 121.0787s
	iters: 700, epoch: 10 | loss: 0.2580786
	speed: 0.0111s/iter; left time: 101.1842s
	iters: 800, epoch: 10 | loss: 0.2442745
	speed: 0.0108s/iter; left time: 97.5173s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:26.66s
Steps: 894 | Train Loss: 0.2748904 Vali Loss: 0.3624854 Test Loss: 0.4079892
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.39895567297935486, rmse:0.6316294074058533, mae:0.40674835443496704, rse:0.5784950852394104
Original data scale mse:3082198.25, rmse:1755.6190185546875, mae:1179.6866455078125, rse:0.12366610765457153
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.8846574
	speed: 0.0117s/iter; left time: 208.5651s
	iters: 200, epoch: 1 | loss: 0.6947731
	speed: 0.0093s/iter; left time: 164.9085s
	iters: 300, epoch: 1 | loss: 0.6757308
	speed: 0.0093s/iter; left time: 164.3083s
	iters: 400, epoch: 1 | loss: 0.5790245
	speed: 0.0093s/iter; left time: 162.7282s
	iters: 500, epoch: 1 | loss: 0.5771477
	speed: 0.0093s/iter; left time: 162.3445s
	iters: 600, epoch: 1 | loss: 0.4772144
	speed: 0.0093s/iter; left time: 161.4430s
	iters: 700, epoch: 1 | loss: 0.5087042
	speed: 0.0093s/iter; left time: 160.2462s
	iters: 800, epoch: 1 | loss: 0.5628862
	speed: 0.0093s/iter; left time: 159.2894s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.61s
Steps: 894 | Train Loss: 0.6736087 Vali Loss: 0.4425660 Test Loss: 0.4604475
Validation loss decreased (inf --> 0.442566).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3914026
	speed: 0.0428s/iter; left time: 723.0734s
	iters: 200, epoch: 2 | loss: 0.4341299
	speed: 0.0088s/iter; left time: 147.5977s
	iters: 300, epoch: 2 | loss: 0.3785777
	speed: 0.0092s/iter; left time: 154.3034s
	iters: 400, epoch: 2 | loss: 0.3786357
	speed: 0.0093s/iter; left time: 154.6911s
	iters: 500, epoch: 2 | loss: 0.4005822
	speed: 0.0093s/iter; left time: 153.2813s
	iters: 600, epoch: 2 | loss: 0.3660025
	speed: 0.0093s/iter; left time: 152.8009s
	iters: 700, epoch: 2 | loss: 0.3596464
	speed: 0.0093s/iter; left time: 152.2501s
	iters: 800, epoch: 2 | loss: 0.4002900
	speed: 0.0093s/iter; left time: 150.9421s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.50s
Steps: 894 | Train Loss: 0.4136689 Vali Loss: 0.3602259 Test Loss: 0.3907548
Validation loss decreased (0.442566 --> 0.360226).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3682706
	speed: 0.0425s/iter; left time: 680.1460s
	iters: 200, epoch: 3 | loss: 0.3699563
	speed: 0.0086s/iter; left time: 137.2417s
	iters: 300, epoch: 3 | loss: 0.3253953
	speed: 0.0086s/iter; left time: 136.5476s
	iters: 400, epoch: 3 | loss: 0.3792088
	speed: 0.0086s/iter; left time: 135.4630s
	iters: 500, epoch: 3 | loss: 0.4250415
	speed: 0.0085s/iter; left time: 132.4088s
	iters: 600, epoch: 3 | loss: 0.3295353
	speed: 0.0085s/iter; left time: 132.2107s
	iters: 700, epoch: 3 | loss: 0.3875653
	speed: 0.0086s/iter; left time: 132.5009s
	iters: 800, epoch: 3 | loss: 0.3400064
	speed: 0.0086s/iter; left time: 131.7800s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.91s
Steps: 894 | Train Loss: 0.3731053 Vali Loss: 0.3556686 Test Loss: 0.3850469
Validation loss decreased (0.360226 --> 0.355669).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3374731
	speed: 0.0408s/iter; left time: 616.4966s
	iters: 200, epoch: 4 | loss: 0.3161117
	speed: 0.0090s/iter; left time: 134.2695s
	iters: 300, epoch: 4 | loss: 0.3617721
	speed: 0.0090s/iter; left time: 133.4156s
	iters: 400, epoch: 4 | loss: 0.3677353
	speed: 0.0090s/iter; left time: 132.5247s
	iters: 500, epoch: 4 | loss: 0.3795101
	speed: 0.0090s/iter; left time: 131.8898s
	iters: 600, epoch: 4 | loss: 0.3474153
	speed: 0.0090s/iter; left time: 132.0017s
	iters: 700, epoch: 4 | loss: 0.3643577
	speed: 0.0089s/iter; left time: 129.7599s
	iters: 800, epoch: 4 | loss: 0.3665947
	speed: 0.0088s/iter; left time: 126.6475s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.23s
Steps: 894 | Train Loss: 0.3567274 Vali Loss: 0.3588086 Test Loss: 0.3878742
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3281340
	speed: 0.0421s/iter; left time: 597.3398s
	iters: 200, epoch: 5 | loss: 0.3816561
	speed: 0.0100s/iter; left time: 141.0653s
	iters: 300, epoch: 5 | loss: 0.3013256
	speed: 0.0100s/iter; left time: 139.4497s
	iters: 400, epoch: 5 | loss: 0.3661686
	speed: 0.0100s/iter; left time: 138.5766s
	iters: 500, epoch: 5 | loss: 0.3384695
	speed: 0.0100s/iter; left time: 137.6568s
	iters: 600, epoch: 5 | loss: 0.3144844
	speed: 0.0100s/iter; left time: 136.6418s
	iters: 700, epoch: 5 | loss: 0.3790110
	speed: 0.0099s/iter; left time: 135.3358s
	iters: 800, epoch: 5 | loss: 0.3176265
	speed: 0.0100s/iter; left time: 134.4245s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.14s
Steps: 894 | Train Loss: 0.3395184 Vali Loss: 0.3624209 Test Loss: 0.4011379
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2693781
	speed: 0.0416s/iter; left time: 553.6599s
	iters: 200, epoch: 6 | loss: 0.3325165
	speed: 0.0087s/iter; left time: 115.2449s
	iters: 300, epoch: 6 | loss: 0.3099601
	speed: 0.0088s/iter; left time: 114.7558s
	iters: 400, epoch: 6 | loss: 0.2975692
	speed: 0.0088s/iter; left time: 114.1780s
	iters: 500, epoch: 6 | loss: 0.3659286
	speed: 0.0087s/iter; left time: 112.2327s
	iters: 600, epoch: 6 | loss: 0.3293519
	speed: 0.0116s/iter; left time: 149.1788s
	iters: 700, epoch: 6 | loss: 0.2891266
	speed: 0.0088s/iter; left time: 112.3737s
	iters: 800, epoch: 6 | loss: 0.2944975
	speed: 0.0095s/iter; left time: 120.3586s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.61s
Steps: 894 | Train Loss: 0.3228436 Vali Loss: 0.3646999 Test Loss: 0.4026258
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.4004287
	speed: 0.2563s/iter; left time: 3182.4027s
	iters: 200, epoch: 7 | loss: 0.2570741
	speed: 0.0594s/iter; left time: 731.8568s
	iters: 300, epoch: 7 | loss: 0.3329300
	speed: 0.0569s/iter; left time: 695.7519s
	iters: 400, epoch: 7 | loss: 0.3312670
	speed: 0.0548s/iter; left time: 663.7514s
	iters: 500, epoch: 7 | loss: 0.3504340
	speed: 0.0562s/iter; left time: 675.9112s
	iters: 600, epoch: 7 | loss: 0.3200604
	speed: 0.0579s/iter; left time: 690.1701s
	iters: 700, epoch: 7 | loss: 0.3151236
	speed: 0.0524s/iter; left time: 619.1796s
	iters: 800, epoch: 7 | loss: 0.2665381
	speed: 0.0582s/iter; left time: 681.4503s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:51.38s
Steps: 894 | Train Loss: 0.3080992 Vali Loss: 0.3690492 Test Loss: 0.4084581
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2982433
	speed: 0.2918s/iter; left time: 3362.3717s
	iters: 200, epoch: 8 | loss: 0.3278830
	speed: 0.0514s/iter; left time: 586.8805s
	iters: 300, epoch: 8 | loss: 0.2621333
	speed: 0.0522s/iter; left time: 591.4328s
	iters: 400, epoch: 8 | loss: 0.2531180
	speed: 0.0526s/iter; left time: 590.1098s
	iters: 500, epoch: 8 | loss: 0.2748438
	speed: 0.0498s/iter; left time: 553.7580s
	iters: 600, epoch: 8 | loss: 0.2857252
	speed: 0.0499s/iter; left time: 549.5881s
	iters: 700, epoch: 8 | loss: 0.3164103
	speed: 0.0533s/iter; left time: 582.6702s
	iters: 800, epoch: 8 | loss: 0.2866903
	speed: 0.0571s/iter; left time: 617.7716s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:47.50s
Steps: 894 | Train Loss: 0.2947745 Vali Loss: 0.3644419 Test Loss: 0.4173954
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.38504692912101746, rmse:0.6205214858055115, mae:0.4034557640552521, rse:0.5683216452598572
Original data scale mse:3154101.0, rmse:1775.9788818359375, mae:1187.391357421875, rse:0.1251002550125122

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.39895567297935486, RMSE: 0.6316294074058533, MAE: 0.40674835443496704, RSE: 0.5784950852394104
Unscaled Metrics - MSE: 3082198.25, RMSE: 1755.6190185546875, MAE: 1179.6866455078125, RSE: 0.12366610765457153

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.38504692912101746, RMSE: 0.6205214858055115, MAE: 0.4034557640552521, RSE: 0.5683216452598572
Unscaled Metrics - MSE: 3154101.0, RMSE: 1775.9788818359375, MAE: 1187.391357421875, RSE: 0.1251002550125122

=== Starting experiments for loss function: MAE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_24_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', if_relu=False, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=True, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=32, stride=16, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.7039745
	speed: 0.0832s/iter; left time: 1487.4620s
	iters: 200, epoch: 1 | loss: 0.6760503
	speed: 0.0518s/iter; left time: 920.8366s
	iters: 300, epoch: 1 | loss: 0.5769762
	speed: 0.0564s/iter; left time: 997.8336s
	iters: 400, epoch: 1 | loss: 0.5438560
	speed: 0.0553s/iter; left time: 972.9675s
	iters: 500, epoch: 1 | loss: 0.4997446
	speed: 0.0580s/iter; left time: 1013.0469s
	iters: 600, epoch: 1 | loss: 0.5052770
	speed: 0.0556s/iter; left time: 966.6429s
	iters: 700, epoch: 1 | loss: 0.4249678
	speed: 0.0609s/iter; left time: 1052.1609s
	iters: 800, epoch: 1 | loss: 0.4422143
	speed: 0.0619s/iter; left time: 1063.7415s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:52.70s
Steps: 899 | Train Loss: 0.5623283 Vali Loss: 0.3817038 Test Loss: 0.3911321
Validation loss decreased (inf --> 0.381704).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3715000
	speed: 0.3186s/iter; left time: 5411.0518s
	iters: 200, epoch: 2 | loss: 0.3361026
	speed: 0.0556s/iter; left time: 938.7104s
	iters: 300, epoch: 2 | loss: 0.3275023
	speed: 0.0549s/iter; left time: 921.3412s
	iters: 400, epoch: 2 | loss: 0.3223957
	speed: 0.0514s/iter; left time: 857.2075s
	iters: 500, epoch: 2 | loss: 0.3182891
	speed: 0.0596s/iter; left time: 988.2517s
	iters: 600, epoch: 2 | loss: 0.2891975
	speed: 0.0415s/iter; left time: 683.4656s
	iters: 700, epoch: 2 | loss: 0.3300719
	speed: 0.0393s/iter; left time: 643.4247s
	iters: 800, epoch: 2 | loss: 0.3067408
	speed: 0.0392s/iter; left time: 639.0404s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:45.51s
Steps: 899 | Train Loss: 0.3281605 Vali Loss: 0.2781286 Test Loss: 0.2893726
Validation loss decreased (0.381704 --> 0.278129).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2958922
	speed: 0.2931s/iter; left time: 4713.2175s
	iters: 200, epoch: 3 | loss: 0.2573656
	speed: 0.0515s/iter; left time: 823.2169s
	iters: 300, epoch: 3 | loss: 0.3162041
	speed: 0.0561s/iter; left time: 890.9803s
	iters: 400, epoch: 3 | loss: 0.2730342
	speed: 0.0524s/iter; left time: 826.4021s
	iters: 500, epoch: 3 | loss: 0.2932071
	speed: 0.0531s/iter; left time: 832.9258s
	iters: 600, epoch: 3 | loss: 0.2931563
	speed: 0.0561s/iter; left time: 874.0437s
	iters: 700, epoch: 3 | loss: 0.2827891
	speed: 0.0503s/iter; left time: 778.7384s
	iters: 800, epoch: 3 | loss: 0.3198387
	speed: 0.0540s/iter; left time: 831.3998s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:49.21s
Steps: 899 | Train Loss: 0.2885656 Vali Loss: 0.2646529 Test Loss: 0.2770855
Validation loss decreased (0.278129 --> 0.264653).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2518093
	speed: 0.3143s/iter; left time: 4771.9809s
	iters: 200, epoch: 4 | loss: 0.2440773
	speed: 0.0534s/iter; left time: 804.9017s
	iters: 300, epoch: 4 | loss: 0.2706414
	speed: 0.0555s/iter; left time: 832.2840s
	iters: 400, epoch: 4 | loss: 0.2626098
	speed: 0.0582s/iter; left time: 866.7038s
	iters: 500, epoch: 4 | loss: 0.2882425
	speed: 0.0576s/iter; left time: 851.3685s
	iters: 600, epoch: 4 | loss: 0.2608938
	speed: 0.0558s/iter; left time: 819.0227s
	iters: 700, epoch: 4 | loss: 0.2896950
	speed: 0.0548s/iter; left time: 799.6327s
	iters: 800, epoch: 4 | loss: 0.2291579
	speed: 0.0598s/iter; left time: 866.5118s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:50.81s
Steps: 899 | Train Loss: 0.2760553 Vali Loss: 0.2617239 Test Loss: 0.2744921
Validation loss decreased (0.264653 --> 0.261724).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2716433
	speed: 0.3079s/iter; left time: 4398.4936s
	iters: 200, epoch: 5 | loss: 0.2439845
	speed: 0.0511s/iter; left time: 725.2242s
	iters: 300, epoch: 5 | loss: 0.2699315
	speed: 0.0547s/iter; left time: 770.7152s
	iters: 400, epoch: 5 | loss: 0.2958869
	speed: 0.0553s/iter; left time: 772.7156s
	iters: 500, epoch: 5 | loss: 0.2710647
	speed: 0.0583s/iter; left time: 809.0963s
	iters: 600, epoch: 5 | loss: 0.2964389
	speed: 0.0525s/iter; left time: 723.5575s
	iters: 700, epoch: 5 | loss: 0.2555974
	speed: 0.0562s/iter; left time: 769.2518s
	iters: 800, epoch: 5 | loss: 0.2672661
	speed: 0.0568s/iter; left time: 772.0431s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:50.04s
Steps: 899 | Train Loss: 0.2678480 Vali Loss: 0.2547817 Test Loss: 0.2689230
Validation loss decreased (0.261724 --> 0.254782).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2324864
	speed: 0.3294s/iter; left time: 4409.3813s
	iters: 200, epoch: 6 | loss: 0.2690727
	speed: 0.0546s/iter; left time: 725.0910s
	iters: 300, epoch: 6 | loss: 0.2388979
	speed: 0.0558s/iter; left time: 735.2739s
	iters: 400, epoch: 6 | loss: 0.2572960
	speed: 0.0547s/iter; left time: 715.5569s
	iters: 500, epoch: 6 | loss: 0.2363383
	speed: 0.0514s/iter; left time: 667.5804s
	iters: 600, epoch: 6 | loss: 0.2585189
	speed: 0.0515s/iter; left time: 663.4963s
	iters: 700, epoch: 6 | loss: 0.2663635
	speed: 0.0506s/iter; left time: 647.5243s
	iters: 800, epoch: 6 | loss: 0.2526423
	speed: 0.0509s/iter; left time: 646.1900s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:49.37s
Steps: 899 | Train Loss: 0.2620297 Vali Loss: 0.2523579 Test Loss: 0.2654966
Validation loss decreased (0.254782 --> 0.252358).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2589698
	speed: 0.3045s/iter; left time: 3802.1309s
	iters: 200, epoch: 7 | loss: 0.2202278
	speed: 0.0480s/iter; left time: 594.1232s
	iters: 300, epoch: 7 | loss: 0.2904449
	speed: 0.0509s/iter; left time: 625.2284s
	iters: 400, epoch: 7 | loss: 0.2422497
	speed: 0.0572s/iter; left time: 696.8539s
	iters: 500, epoch: 7 | loss: 0.2844310
	speed: 0.0498s/iter; left time: 601.4078s
	iters: 600, epoch: 7 | loss: 0.2758683
	speed: 0.0556s/iter; left time: 665.8903s
	iters: 700, epoch: 7 | loss: 0.2387815
	speed: 0.0519s/iter; left time: 617.2815s
	iters: 800, epoch: 7 | loss: 0.2530876
	speed: 0.0503s/iter; left time: 592.4161s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:47.49s
Steps: 899 | Train Loss: 0.2578069 Vali Loss: 0.2489519 Test Loss: 0.2606864
Validation loss decreased (0.252358 --> 0.248952).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2654280
	speed: 0.2987s/iter; left time: 3461.2272s
	iters: 200, epoch: 8 | loss: 0.2725436
	speed: 0.0543s/iter; left time: 623.5891s
	iters: 300, epoch: 8 | loss: 0.2371408
	speed: 0.0569s/iter; left time: 647.6335s
	iters: 400, epoch: 8 | loss: 0.2522988
	speed: 0.0546s/iter; left time: 616.1819s
	iters: 500, epoch: 8 | loss: 0.2867152
	speed: 0.0564s/iter; left time: 631.4783s
	iters: 600, epoch: 8 | loss: 0.2569876
	speed: 0.0546s/iter; left time: 605.9404s
	iters: 700, epoch: 8 | loss: 0.2657411
	speed: 0.0540s/iter; left time: 593.6516s
	iters: 800, epoch: 8 | loss: 0.2587411
	speed: 0.0586s/iter; left time: 638.0594s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:49.61s
Steps: 899 | Train Loss: 0.2543712 Vali Loss: 0.2478848 Test Loss: 0.2599342
Validation loss decreased (0.248952 --> 0.247885).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.2433625
	speed: 0.3086s/iter; left time: 3299.0074s
	iters: 200, epoch: 9 | loss: 0.2587861
	speed: 0.0580s/iter; left time: 613.6545s
	iters: 300, epoch: 9 | loss: 0.2762177
	speed: 0.0508s/iter; left time: 532.8836s
	iters: 400, epoch: 9 | loss: 0.2570926
	speed: 0.0535s/iter; left time: 556.2119s
	iters: 500, epoch: 9 | loss: 0.2503490
	speed: 0.0548s/iter; left time: 563.4998s
	iters: 600, epoch: 9 | loss: 0.2601032
	speed: 0.0567s/iter; left time: 577.6368s
	iters: 700, epoch: 9 | loss: 0.2266045
	speed: 0.0556s/iter; left time: 561.1535s
	iters: 800, epoch: 9 | loss: 0.2913128
	speed: 0.0523s/iter; left time: 522.5498s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:49.86s
Steps: 899 | Train Loss: 0.2516291 Vali Loss: 0.2472994 Test Loss: 0.2578833
Validation loss decreased (0.247885 --> 0.247299).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.2175469
	speed: 0.3064s/iter; left time: 2999.8594s
	iters: 200, epoch: 10 | loss: 0.2673032
	speed: 0.0574s/iter; left time: 556.6342s
	iters: 300, epoch: 10 | loss: 0.2496804
	speed: 0.0506s/iter; left time: 485.1354s
	iters: 400, epoch: 10 | loss: 0.2658059
	speed: 0.0484s/iter; left time: 459.3479s
	iters: 500, epoch: 10 | loss: 0.2663919
	speed: 0.0600s/iter; left time: 562.9408s
	iters: 600, epoch: 10 | loss: 0.2236724
	speed: 0.0634s/iter; left time: 588.9778s
	iters: 700, epoch: 10 | loss: 0.2661968
	speed: 0.0576s/iter; left time: 529.7167s
	iters: 800, epoch: 10 | loss: 0.2484617
	speed: 0.0580s/iter; left time: 527.6273s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:50.89s
Steps: 899 | Train Loss: 0.2492819 Vali Loss: 0.2465337 Test Loss: 0.2582311
Validation loss decreased (0.247299 --> 0.246534).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.2484395
	speed: 0.3055s/iter; left time: 2716.3297s
	iters: 200, epoch: 11 | loss: 0.2488783
	speed: 0.0521s/iter; left time: 458.3026s
	iters: 300, epoch: 11 | loss: 0.2190044
	speed: 0.0524s/iter; left time: 455.5706s
	iters: 400, epoch: 11 | loss: 0.2643448
	speed: 0.0584s/iter; left time: 501.7799s
	iters: 500, epoch: 11 | loss: 0.2366973
	speed: 0.0542s/iter; left time: 459.8852s
	iters: 600, epoch: 11 | loss: 0.2391401
	speed: 0.0476s/iter; left time: 399.8248s
	iters: 700, epoch: 11 | loss: 0.2348218
	speed: 0.0514s/iter; left time: 426.2374s
	iters: 800, epoch: 11 | loss: 0.2441367
	speed: 0.0496s/iter; left time: 405.9882s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:49.32s
Steps: 899 | Train Loss: 0.2475720 Vali Loss: 0.2438932 Test Loss: 0.2562939
Validation loss decreased (0.246534 --> 0.243893).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.2565231
	speed: 0.3114s/iter; left time: 2488.7156s
	iters: 200, epoch: 12 | loss: 0.2591335
	speed: 0.0539s/iter; left time: 425.5293s
	iters: 300, epoch: 12 | loss: 0.2625164
	speed: 0.0506s/iter; left time: 393.9181s
	iters: 400, epoch: 12 | loss: 0.2382481
	speed: 0.0556s/iter; left time: 427.6567s
	iters: 500, epoch: 12 | loss: 0.2594301
	speed: 0.0585s/iter; left time: 444.1620s
	iters: 600, epoch: 12 | loss: 0.2726392
	speed: 0.0498s/iter; left time: 372.8871s
	iters: 700, epoch: 12 | loss: 0.2561722
	speed: 0.0601s/iter; left time: 444.3559s
	iters: 800, epoch: 12 | loss: 0.2491858
	speed: 0.0576s/iter; left time: 420.0826s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:50.28s
Steps: 899 | Train Loss: 0.2459942 Vali Loss: 0.2437636 Test Loss: 0.2572545
Validation loss decreased (0.243893 --> 0.243764).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.2528438
	speed: 0.3124s/iter; left time: 2216.1901s
	iters: 200, epoch: 13 | loss: 0.2621691
	speed: 0.0536s/iter; left time: 374.5630s
	iters: 300, epoch: 13 | loss: 0.2199807
	speed: 0.0484s/iter; left time: 333.3708s
	iters: 400, epoch: 13 | loss: 0.2508169
	speed: 0.0562s/iter; left time: 381.4865s
	iters: 500, epoch: 13 | loss: 0.2908570
	speed: 0.0612s/iter; left time: 409.3473s
	iters: 600, epoch: 13 | loss: 0.2188197
	speed: 0.0587s/iter; left time: 386.9332s
	iters: 700, epoch: 13 | loss: 0.2633851
	speed: 0.0508s/iter; left time: 329.5953s
	iters: 800, epoch: 13 | loss: 0.3014452
	speed: 0.0543s/iter; left time: 347.1345s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:49.36s
Steps: 899 | Train Loss: 0.2440878 Vali Loss: 0.2420737 Test Loss: 0.2542738
Validation loss decreased (0.243764 --> 0.242074).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.2931103
	speed: 0.3350s/iter; left time: 2075.2989s
	iters: 200, epoch: 14 | loss: 0.2301111
	speed: 0.0536s/iter; left time: 326.3844s
	iters: 300, epoch: 14 | loss: 0.2495896
	speed: 0.0614s/iter; left time: 368.0986s
	iters: 400, epoch: 14 | loss: 0.2671365
	speed: 0.0531s/iter; left time: 313.1950s
	iters: 500, epoch: 14 | loss: 0.2615140
	speed: 0.0516s/iter; left time: 299.2462s
	iters: 600, epoch: 14 | loss: 0.3179057
	speed: 0.0528s/iter; left time: 300.8188s
	iters: 700, epoch: 14 | loss: 0.2397571
	speed: 0.0544s/iter; left time: 304.1881s
	iters: 800, epoch: 14 | loss: 0.2408224
	speed: 0.0511s/iter; left time: 280.8111s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:49.33s
Steps: 899 | Train Loss: 0.2432441 Vali Loss: 0.2419872 Test Loss: 0.2561926
Validation loss decreased (0.242074 --> 0.241987).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.2666880
	speed: 0.3029s/iter; left time: 1604.0541s
	iters: 200, epoch: 15 | loss: 0.2343545
	speed: 0.0617s/iter; left time: 320.6397s
	iters: 300, epoch: 15 | loss: 0.2208349
	speed: 0.0583s/iter; left time: 297.0753s
	iters: 400, epoch: 15 | loss: 0.2549978
	speed: 0.0516s/iter; left time: 257.6421s
	iters: 500, epoch: 15 | loss: 0.2127291
	speed: 0.0511s/iter; left time: 249.9736s
	iters: 600, epoch: 15 | loss: 0.2417456
	speed: 0.0610s/iter; left time: 292.6990s
	iters: 700, epoch: 15 | loss: 0.2520313
	speed: 0.0538s/iter; left time: 252.7433s
	iters: 800, epoch: 15 | loss: 0.2044262
	speed: 0.0560s/iter; left time: 257.5186s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:51.39s
Steps: 899 | Train Loss: 0.2419101 Vali Loss: 0.2417017 Test Loss: 0.2545722
Validation loss decreased (0.241987 --> 0.241702).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.2827860
	speed: 0.2830s/iter; left time: 1244.1841s
	iters: 200, epoch: 16 | loss: 0.2508551
	speed: 0.0536s/iter; left time: 230.2890s
	iters: 300, epoch: 16 | loss: 0.2235140
	speed: 0.0552s/iter; left time: 231.5139s
	iters: 400, epoch: 16 | loss: 0.2434855
	speed: 0.0590s/iter; left time: 241.4716s
	iters: 500, epoch: 16 | loss: 0.2448723
	speed: 0.0557s/iter; left time: 222.5879s
	iters: 600, epoch: 16 | loss: 0.2087096
	speed: 0.0541s/iter; left time: 210.9136s
	iters: 700, epoch: 16 | loss: 0.2504786
	speed: 0.0525s/iter; left time: 199.1834s
	iters: 800, epoch: 16 | loss: 0.2663001
	speed: 0.0575s/iter; left time: 212.5815s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:49.00s
Steps: 899 | Train Loss: 0.2411408 Vali Loss: 0.2413380 Test Loss: 0.2537194
Validation loss decreased (0.241702 --> 0.241338).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.2498361
	speed: 0.2985s/iter; left time: 1043.9995s
	iters: 200, epoch: 17 | loss: 0.2628345
	speed: 0.0595s/iter; left time: 202.2805s
	iters: 300, epoch: 17 | loss: 0.2241386
	speed: 0.0514s/iter; left time: 169.5865s
	iters: 400, epoch: 17 | loss: 0.2774626
	speed: 0.0633s/iter; left time: 202.4668s
	iters: 500, epoch: 17 | loss: 0.2663810
	speed: 0.0602s/iter; left time: 186.4425s
	iters: 600, epoch: 17 | loss: 0.2903131
	speed: 0.0545s/iter; left time: 163.4687s
	iters: 700, epoch: 17 | loss: 0.1915403
	speed: 0.0523s/iter; left time: 151.4081s
	iters: 800, epoch: 17 | loss: 0.2487668
	speed: 0.0522s/iter; left time: 145.9783s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:50.79s
Steps: 899 | Train Loss: 0.2402126 Vali Loss: 0.2411277 Test Loss: 0.2534418
Validation loss decreased (0.241338 --> 0.241128).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.2475858
	speed: 0.2960s/iter; left time: 768.9574s
	iters: 200, epoch: 18 | loss: 0.2816447
	speed: 0.0520s/iter; left time: 129.8088s
	iters: 300, epoch: 18 | loss: 0.2429577
	speed: 0.0567s/iter; left time: 136.0668s
	iters: 400, epoch: 18 | loss: 0.2282330
	speed: 0.0522s/iter; left time: 119.9760s
	iters: 500, epoch: 18 | loss: 0.2125258
	speed: 0.0512s/iter; left time: 112.5150s
	iters: 600, epoch: 18 | loss: 0.2753126
	speed: 0.0504s/iter; left time: 105.7516s
	iters: 700, epoch: 18 | loss: 0.2639644
	speed: 0.0504s/iter; left time: 100.6434s
	iters: 800, epoch: 18 | loss: 0.2580844
	speed: 0.0559s/iter; left time: 106.0368s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:47.87s
Steps: 899 | Train Loss: 0.2395852 Vali Loss: 0.2410072 Test Loss: 0.2535525
Validation loss decreased (0.241128 --> 0.241007).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.2312118
	speed: 0.3011s/iter; left time: 511.5980s
	iters: 200, epoch: 19 | loss: 0.1895283
	speed: 0.0470s/iter; left time: 75.1347s
	iters: 300, epoch: 19 | loss: 0.2298442
	speed: 0.0633s/iter; left time: 94.8747s
	iters: 400, epoch: 19 | loss: 0.2163697
	speed: 0.0511s/iter; left time: 71.5201s
	iters: 500, epoch: 19 | loss: 0.2415225
	speed: 0.0597s/iter; left time: 77.6132s
	iters: 600, epoch: 19 | loss: 0.2034143
	speed: 0.0540s/iter; left time: 64.7381s
	iters: 700, epoch: 19 | loss: 0.2468459
	speed: 0.0544s/iter; left time: 59.8353s
	iters: 800, epoch: 19 | loss: 0.2035747
	speed: 0.0546s/iter; left time: 54.5075s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:50.22s
Steps: 899 | Train Loss: 0.2385571 Vali Loss: 0.2405512 Test Loss: 0.2527005
Validation loss decreased (0.241007 --> 0.240551).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.2219398
	speed: 0.3212s/iter; left time: 256.9466s
	iters: 200, epoch: 20 | loss: 0.2426859
	speed: 0.0563s/iter; left time: 39.3921s
	iters: 300, epoch: 20 | loss: 0.2319082
	speed: 0.0509s/iter; left time: 30.5574s
	iters: 400, epoch: 20 | loss: 0.2286175
	speed: 0.0556s/iter; left time: 27.7840s
	iters: 500, epoch: 20 | loss: 0.2466527
	speed: 0.0516s/iter; left time: 20.6267s
	iters: 600, epoch: 20 | loss: 0.2026940
	speed: 0.0577s/iter; left time: 17.3135s
	iters: 700, epoch: 20 | loss: 0.2303760
	speed: 0.0593s/iter; left time: 11.8579s
	iters: 800, epoch: 20 | loss: 0.2209584
	speed: 0.0542s/iter; left time: 5.4198s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:50.53s
Steps: 899 | Train Loss: 0.2380950 Vali Loss: 0.2401634 Test Loss: 0.2528449
Validation loss decreased (0.240551 --> 0.240163).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.20293521881103516, rmse:0.4504833221435547, mae:0.2528449594974518, rse:0.412569522857666
Original data scale mse:1151100.125, rmse:1072.893310546875, mae:668.9365234375, rse:0.07539474219083786
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.7695546
	speed: 0.0665s/iter; left time: 1189.7432s
	iters: 200, epoch: 1 | loss: 0.6173800
	speed: 0.0513s/iter; left time: 912.5977s
	iters: 300, epoch: 1 | loss: 0.5729680
	speed: 0.0564s/iter; left time: 996.5921s
	iters: 400, epoch: 1 | loss: 0.5110341
	speed: 0.0536s/iter; left time: 942.7170s
	iters: 500, epoch: 1 | loss: 0.4687887
	speed: 0.0526s/iter; left time: 918.9515s
	iters: 600, epoch: 1 | loss: 0.5282834
	speed: 0.0540s/iter; left time: 938.7993s
	iters: 700, epoch: 1 | loss: 0.4832329
	speed: 0.0616s/iter; left time: 1064.2938s
	iters: 800, epoch: 1 | loss: 0.4751154
	speed: 0.0570s/iter; left time: 978.5235s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:50.57s
Steps: 899 | Train Loss: 0.5639134 Vali Loss: 0.3825430 Test Loss: 0.3933530
Validation loss decreased (inf --> 0.382543).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4115085
	speed: 0.3064s/iter; left time: 5203.2385s
	iters: 200, epoch: 2 | loss: 0.3328076
	speed: 0.0521s/iter; left time: 879.7801s
	iters: 300, epoch: 2 | loss: 0.3387829
	speed: 0.0544s/iter; left time: 912.3913s
	iters: 400, epoch: 2 | loss: 0.3111836
	speed: 0.0466s/iter; left time: 776.7179s
	iters: 500, epoch: 2 | loss: 0.3007427
	speed: 0.0448s/iter; left time: 742.4392s
	iters: 600, epoch: 2 | loss: 0.3454388
	speed: 0.0458s/iter; left time: 754.0946s
	iters: 700, epoch: 2 | loss: 0.3003039
	speed: 0.0545s/iter; left time: 892.8191s
	iters: 800, epoch: 2 | loss: 0.3082251
	speed: 0.0590s/iter; left time: 960.3843s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:47.69s
Steps: 899 | Train Loss: 0.3267071 Vali Loss: 0.2760861 Test Loss: 0.2855857
Validation loss decreased (0.382543 --> 0.276086).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2768325
	speed: 0.3096s/iter; left time: 4979.3225s
	iters: 200, epoch: 3 | loss: 0.2627148
	speed: 0.0512s/iter; left time: 817.9363s
	iters: 300, epoch: 3 | loss: 0.2710491
	speed: 0.0523s/iter; left time: 830.9561s
	iters: 400, epoch: 3 | loss: 0.2762404
	speed: 0.0533s/iter; left time: 840.7384s
	iters: 500, epoch: 3 | loss: 0.2499685
	speed: 0.0575s/iter; left time: 901.0959s
	iters: 600, epoch: 3 | loss: 0.2743557
	speed: 0.0619s/iter; left time: 964.9539s
	iters: 700, epoch: 3 | loss: 0.2905808
	speed: 0.0476s/iter; left time: 737.0628s
	iters: 800, epoch: 3 | loss: 0.2598731
	speed: 0.0537s/iter; left time: 825.3421s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:49.14s
Steps: 899 | Train Loss: 0.2870589 Vali Loss: 0.2637097 Test Loss: 0.2744557
Validation loss decreased (0.276086 --> 0.263710).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2905399
	speed: 0.3040s/iter; left time: 4616.5729s
	iters: 200, epoch: 4 | loss: 0.2709951
	speed: 0.0590s/iter; left time: 890.6044s
	iters: 300, epoch: 4 | loss: 0.2263854
	speed: 0.0510s/iter; left time: 763.5246s
	iters: 400, epoch: 4 | loss: 0.2686700
	speed: 0.0588s/iter; left time: 875.7250s
	iters: 500, epoch: 4 | loss: 0.2763354
	speed: 0.0508s/iter; left time: 750.8689s
	iters: 600, epoch: 4 | loss: 0.2507344
	speed: 0.0538s/iter; left time: 789.9536s
	iters: 700, epoch: 4 | loss: 0.2508259
	speed: 0.0519s/iter; left time: 757.2851s
	iters: 800, epoch: 4 | loss: 0.2569146
	speed: 0.0569s/iter; left time: 823.8102s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:51.09s
Steps: 899 | Train Loss: 0.2749023 Vali Loss: 0.2588912 Test Loss: 0.2707531
Validation loss decreased (0.263710 --> 0.258891).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2647319
	speed: 0.3247s/iter; left time: 4637.7188s
	iters: 200, epoch: 5 | loss: 0.2517526
	speed: 0.0564s/iter; left time: 799.5502s
	iters: 300, epoch: 5 | loss: 0.3000122
	speed: 0.0528s/iter; left time: 743.5370s
	iters: 400, epoch: 5 | loss: 0.2797507
	speed: 0.0541s/iter; left time: 757.0611s
	iters: 500, epoch: 5 | loss: 0.2727681
	speed: 0.0519s/iter; left time: 720.0065s
	iters: 600, epoch: 5 | loss: 0.2783136
	speed: 0.0594s/iter; left time: 819.4975s
	iters: 700, epoch: 5 | loss: 0.2718383
	speed: 0.0515s/iter; left time: 704.7716s
	iters: 800, epoch: 5 | loss: 0.2641280
	speed: 0.0527s/iter; left time: 716.4909s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:49.46s
Steps: 899 | Train Loss: 0.2666871 Vali Loss: 0.2546344 Test Loss: 0.2663664
Validation loss decreased (0.258891 --> 0.254634).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2592109
	speed: 0.3197s/iter; left time: 4279.9321s
	iters: 200, epoch: 6 | loss: 0.2300086
	speed: 0.0550s/iter; left time: 730.7754s
	iters: 300, epoch: 6 | loss: 0.2619140
	speed: 0.0538s/iter; left time: 708.8240s
	iters: 400, epoch: 6 | loss: 0.2975906
	speed: 0.0589s/iter; left time: 771.0054s
	iters: 500, epoch: 6 | loss: 0.2331565
	speed: 0.0541s/iter; left time: 703.0158s
	iters: 600, epoch: 6 | loss: 0.2936651
	speed: 0.0558s/iter; left time: 719.5026s
	iters: 700, epoch: 6 | loss: 0.2939557
	speed: 0.0554s/iter; left time: 708.9262s
	iters: 800, epoch: 6 | loss: 0.2886554
	speed: 0.0517s/iter; left time: 655.3514s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:49.70s
Steps: 899 | Train Loss: 0.2612756 Vali Loss: 0.2530807 Test Loss: 0.2669018
Validation loss decreased (0.254634 --> 0.253081).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2779230
	speed: 0.3090s/iter; left time: 3858.0315s
	iters: 200, epoch: 7 | loss: 0.2606280
	speed: 0.0512s/iter; left time: 634.0171s
	iters: 300, epoch: 7 | loss: 0.2804795
	speed: 0.0483s/iter; left time: 594.0696s
	iters: 400, epoch: 7 | loss: 0.2722861
	speed: 0.0566s/iter; left time: 689.3897s
	iters: 500, epoch: 7 | loss: 0.2615852
	speed: 0.0546s/iter; left time: 659.9825s
	iters: 600, epoch: 7 | loss: 0.2234846
	speed: 0.0507s/iter; left time: 607.8107s
	iters: 700, epoch: 7 | loss: 0.2435990
	speed: 0.0555s/iter; left time: 659.4379s
	iters: 800, epoch: 7 | loss: 0.2579395
	speed: 0.0542s/iter; left time: 638.3652s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:48.26s
Steps: 899 | Train Loss: 0.2573602 Vali Loss: 0.2490560 Test Loss: 0.2610407
Validation loss decreased (0.253081 --> 0.249056).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.3168053
	speed: 0.2993s/iter; left time: 3467.7268s
	iters: 200, epoch: 8 | loss: 0.2282544
	speed: 0.0539s/iter; left time: 619.5066s
	iters: 300, epoch: 8 | loss: 0.2484325
	speed: 0.0558s/iter; left time: 635.6144s
	iters: 400, epoch: 8 | loss: 0.2417875
	speed: 0.0549s/iter; left time: 619.8025s
	iters: 500, epoch: 8 | loss: 0.2530582
	speed: 0.0617s/iter; left time: 690.6332s
	iters: 600, epoch: 8 | loss: 0.2419396
	speed: 0.0578s/iter; left time: 640.7085s
	iters: 700, epoch: 8 | loss: 0.2653764
	speed: 0.0569s/iter; left time: 625.5578s
	iters: 800, epoch: 8 | loss: 0.2283738
	speed: 0.0589s/iter; left time: 641.2983s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:51.80s
Steps: 899 | Train Loss: 0.2540558 Vali Loss: 0.2494585 Test Loss: 0.2612973
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.2625990
	speed: 0.3120s/iter; left time: 3334.6768s
	iters: 200, epoch: 9 | loss: 0.2382317
	speed: 0.0509s/iter; left time: 538.5064s
	iters: 300, epoch: 9 | loss: 0.2081661
	speed: 0.0515s/iter; left time: 539.7889s
	iters: 400, epoch: 9 | loss: 0.2372584
	speed: 0.0536s/iter; left time: 557.2542s
	iters: 500, epoch: 9 | loss: 0.2297046
	speed: 0.0576s/iter; left time: 592.4200s
	iters: 600, epoch: 9 | loss: 0.2618764
	speed: 0.0553s/iter; left time: 563.9190s
	iters: 700, epoch: 9 | loss: 0.2229159
	speed: 0.0512s/iter; left time: 516.8152s
	iters: 800, epoch: 9 | loss: 0.2440861
	speed: 0.0527s/iter; left time: 526.3605s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:49.06s
Steps: 899 | Train Loss: 0.2512188 Vali Loss: 0.2466000 Test Loss: 0.2581016
Validation loss decreased (0.249056 --> 0.246600).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.2594198
	speed: 0.3091s/iter; left time: 3026.2553s
	iters: 200, epoch: 10 | loss: 0.2257122
	speed: 0.0558s/iter; left time: 540.6447s
	iters: 300, epoch: 10 | loss: 0.2494005
	speed: 0.0551s/iter; left time: 528.3111s
	iters: 400, epoch: 10 | loss: 0.2803823
	speed: 0.0553s/iter; left time: 524.5284s
	iters: 500, epoch: 10 | loss: 0.2545181
	speed: 0.0464s/iter; left time: 435.5846s
	iters: 600, epoch: 10 | loss: 0.2226262
	speed: 0.0549s/iter; left time: 510.0367s
	iters: 700, epoch: 10 | loss: 0.2197427
	speed: 0.0605s/iter; left time: 556.4241s
	iters: 800, epoch: 10 | loss: 0.2620440
	speed: 0.0513s/iter; left time: 466.4916s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:48.33s
Steps: 899 | Train Loss: 0.2486150 Vali Loss: 0.2449316 Test Loss: 0.2592227
Validation loss decreased (0.246600 --> 0.244932).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.2690663
	speed: 0.3095s/iter; left time: 2751.3670s
	iters: 200, epoch: 11 | loss: 0.2482770
	speed: 0.0505s/iter; left time: 443.7694s
	iters: 300, epoch: 11 | loss: 0.2890701
	speed: 0.0495s/iter; left time: 430.0119s
	iters: 400, epoch: 11 | loss: 0.2480481
	speed: 0.0544s/iter; left time: 466.9312s
	iters: 500, epoch: 11 | loss: 0.2518808
	speed: 0.0597s/iter; left time: 506.6677s
	iters: 600, epoch: 11 | loss: 0.2582714
	speed: 0.0573s/iter; left time: 480.8528s
	iters: 700, epoch: 11 | loss: 0.2243294
	speed: 0.0555s/iter; left time: 460.2830s
	iters: 800, epoch: 11 | loss: 0.2354104
	speed: 0.0572s/iter; left time: 468.6567s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:50.08s
Steps: 899 | Train Loss: 0.2470543 Vali Loss: 0.2458588 Test Loss: 0.2572478
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.2396748
	speed: 0.3067s/iter; left time: 2451.1463s
	iters: 200, epoch: 12 | loss: 0.2174704
	speed: 0.0636s/iter; left time: 501.9321s
	iters: 300, epoch: 12 | loss: 0.2202234
	speed: 0.0580s/iter; left time: 451.7507s
	iters: 400, epoch: 12 | loss: 0.2159050
	speed: 0.0518s/iter; left time: 398.6365s
	iters: 500, epoch: 12 | loss: 0.2007723
	speed: 0.0544s/iter; left time: 413.0023s
	iters: 600, epoch: 12 | loss: 0.2621424
	speed: 0.0557s/iter; left time: 416.9664s
	iters: 700, epoch: 12 | loss: 0.2339609
	speed: 0.0489s/iter; left time: 361.8165s
	iters: 800, epoch: 12 | loss: 0.2493118
	speed: 0.0504s/iter; left time: 367.3628s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:49.25s
Steps: 899 | Train Loss: 0.2452865 Vali Loss: 0.2430472 Test Loss: 0.2562780
Validation loss decreased (0.244932 --> 0.243047).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.2873349
	speed: 0.3006s/iter; left time: 2132.2343s
	iters: 200, epoch: 13 | loss: 0.2477559
	speed: 0.0557s/iter; left time: 389.8432s
	iters: 300, epoch: 13 | loss: 0.2233341
	speed: 0.0636s/iter; left time: 438.3448s
	iters: 400, epoch: 13 | loss: 0.2210337
	speed: 0.0613s/iter; left time: 416.6939s
	iters: 500, epoch: 13 | loss: 0.2760914
	speed: 0.0579s/iter; left time: 387.7201s
	iters: 600, epoch: 13 | loss: 0.2429633
	speed: 0.0537s/iter; left time: 354.0992s
	iters: 700, epoch: 13 | loss: 0.2801585
	speed: 0.0530s/iter; left time: 344.1308s
	iters: 800, epoch: 13 | loss: 0.2287291
	speed: 0.0535s/iter; left time: 341.8355s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:51.74s
Steps: 899 | Train Loss: 0.2441575 Vali Loss: 0.2418078 Test Loss: 0.2544689
Validation loss decreased (0.243047 --> 0.241808).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.2188501
	speed: 0.3220s/iter; left time: 1994.5373s
	iters: 200, epoch: 14 | loss: 0.2263617
	speed: 0.0600s/iter; left time: 365.8821s
	iters: 300, epoch: 14 | loss: 0.2007906
	speed: 0.0500s/iter; left time: 299.6531s
	iters: 400, epoch: 14 | loss: 0.1887975
	speed: 0.0503s/iter; left time: 296.3382s
	iters: 500, epoch: 14 | loss: 0.2439729
	speed: 0.0577s/iter; left time: 334.2265s
	iters: 600, epoch: 14 | loss: 0.2388373
	speed: 0.0500s/iter; left time: 284.9271s
	iters: 700, epoch: 14 | loss: 0.2451000
	speed: 0.0479s/iter; left time: 267.8944s
	iters: 800, epoch: 14 | loss: 0.2251633
	speed: 0.0529s/iter; left time: 290.8247s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:49.20s
Steps: 899 | Train Loss: 0.2426711 Vali Loss: 0.2423167 Test Loss: 0.2548592
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.2447065
	speed: 0.3018s/iter; left time: 1598.0754s
	iters: 200, epoch: 15 | loss: 0.2646659
	speed: 0.0562s/iter; left time: 292.1035s
	iters: 300, epoch: 15 | loss: 0.2499619
	speed: 0.0534s/iter; left time: 271.8548s
	iters: 400, epoch: 15 | loss: 0.2313849
	speed: 0.0499s/iter; left time: 249.4483s
	iters: 500, epoch: 15 | loss: 0.2541708
	speed: 0.0497s/iter; left time: 243.2347s
	iters: 600, epoch: 15 | loss: 0.2312117
	speed: 0.0578s/iter; left time: 277.0413s
	iters: 700, epoch: 15 | loss: 0.2434749
	speed: 0.0581s/iter; left time: 272.9546s
	iters: 800, epoch: 15 | loss: 0.2475857
	speed: 0.0550s/iter; left time: 252.9099s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:49.38s
Steps: 899 | Train Loss: 0.2416384 Vali Loss: 0.2414798 Test Loss: 0.2540885
Validation loss decreased (0.241808 --> 0.241480).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.2323370
	speed: 0.3013s/iter; left time: 1324.3781s
	iters: 200, epoch: 16 | loss: 0.2406537
	speed: 0.0529s/iter; left time: 227.2392s
	iters: 300, epoch: 16 | loss: 0.2699856
	speed: 0.0565s/iter; left time: 237.0349s
	iters: 400, epoch: 16 | loss: 0.2467942
	speed: 0.0565s/iter; left time: 231.5567s
	iters: 500, epoch: 16 | loss: 0.2004844
	speed: 0.0627s/iter; left time: 250.6433s
	iters: 600, epoch: 16 | loss: 0.2269980
	speed: 0.0512s/iter; left time: 199.6162s
	iters: 700, epoch: 16 | loss: 0.2346403
	speed: 0.0595s/iter; left time: 225.9235s
	iters: 800, epoch: 16 | loss: 0.2469147
	speed: 0.0526s/iter; left time: 194.3239s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:50.20s
Steps: 899 | Train Loss: 0.2405637 Vali Loss: 0.2413054 Test Loss: 0.2544088
Validation loss decreased (0.241480 --> 0.241305).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.2286191
	speed: 0.2959s/iter; left time: 1034.7256s
	iters: 200, epoch: 17 | loss: 0.2413256
	speed: 0.0583s/iter; left time: 197.9959s
	iters: 300, epoch: 17 | loss: 0.2487620
	speed: 0.0520s/iter; left time: 171.2959s
	iters: 400, epoch: 17 | loss: 0.2644491
	speed: 0.0541s/iter; left time: 172.9515s
	iters: 500, epoch: 17 | loss: 0.2627011
	speed: 0.0534s/iter; left time: 165.2623s
	iters: 600, epoch: 17 | loss: 0.2263647
	speed: 0.0539s/iter; left time: 161.5330s
	iters: 700, epoch: 17 | loss: 0.2168738
	speed: 0.0528s/iter; left time: 152.8305s
	iters: 800, epoch: 17 | loss: 0.2127385
	speed: 0.0477s/iter; left time: 133.4480s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:48.18s
Steps: 899 | Train Loss: 0.2395682 Vali Loss: 0.2404475 Test Loss: 0.2537790
Validation loss decreased (0.241305 --> 0.240447).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.2830552
	speed: 0.3057s/iter; left time: 794.2819s
	iters: 200, epoch: 18 | loss: 0.2464019
	speed: 0.0520s/iter; left time: 129.9988s
	iters: 300, epoch: 18 | loss: 0.2699743
	speed: 0.0520s/iter; left time: 124.8150s
	iters: 400, epoch: 18 | loss: 0.2159301
	speed: 0.0525s/iter; left time: 120.5714s
	iters: 500, epoch: 18 | loss: 0.2519426
	speed: 0.0491s/iter; left time: 107.9319s
	iters: 600, epoch: 18 | loss: 0.2290585
	speed: 0.0501s/iter; left time: 105.0643s
	iters: 700, epoch: 18 | loss: 0.1955789
	speed: 0.0499s/iter; left time: 99.7608s
	iters: 800, epoch: 18 | loss: 0.2166403
	speed: 0.0504s/iter; left time: 95.5905s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:48.24s
Steps: 899 | Train Loss: 0.2390967 Vali Loss: 0.2406219 Test Loss: 0.2532128
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.2140917
	speed: 0.3126s/iter; left time: 531.1680s
	iters: 200, epoch: 19 | loss: 0.2162102
	speed: 0.0573s/iter; left time: 91.5998s
	iters: 300, epoch: 19 | loss: 0.2284086
	speed: 0.0509s/iter; left time: 76.2489s
	iters: 400, epoch: 19 | loss: 0.2095131
	speed: 0.0566s/iter; left time: 79.2104s
	iters: 500, epoch: 19 | loss: 0.2517149
	speed: 0.0563s/iter; left time: 73.1663s
	iters: 600, epoch: 19 | loss: 0.2364316
	speed: 0.0516s/iter; left time: 61.8268s
	iters: 700, epoch: 19 | loss: 0.2604760
	speed: 0.0488s/iter; left time: 53.6163s
	iters: 800, epoch: 19 | loss: 0.2195623
	speed: 0.0532s/iter; left time: 53.1136s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:48.76s
Steps: 899 | Train Loss: 0.2380622 Vali Loss: 0.2401155 Test Loss: 0.2542644
Validation loss decreased (0.240447 --> 0.240115).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.2351923
	speed: 0.2963s/iter; left time: 237.0049s
	iters: 200, epoch: 20 | loss: 0.2383458
	speed: 0.0562s/iter; left time: 39.3253s
	iters: 300, epoch: 20 | loss: 0.2477112
	speed: 0.0517s/iter; left time: 31.0201s
	iters: 400, epoch: 20 | loss: 0.2344420
	speed: 0.0488s/iter; left time: 24.3998s
	iters: 500, epoch: 20 | loss: 0.2300706
	speed: 0.0555s/iter; left time: 22.2148s
	iters: 600, epoch: 20 | loss: 0.2268675
	speed: 0.0546s/iter; left time: 16.3808s
	iters: 700, epoch: 20 | loss: 0.2377623
	speed: 0.0561s/iter; left time: 11.2116s
	iters: 800, epoch: 20 | loss: 0.2470474
	speed: 0.0636s/iter; left time: 6.3649s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:50.58s
Steps: 899 | Train Loss: 0.2379700 Vali Loss: 0.2397006 Test Loss: 0.2532265
Validation loss decreased (0.240115 --> 0.239701).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.20464353263378143, rmse:0.4523754417896271, mae:0.2532264292240143, rse:0.41430240869522095
Original data scale mse:1154194.75, rmse:1074.3345947265625, mae:667.5917358398438, rse:0.07549601793289185

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.20293521881103516, RMSE: 0.4504833221435547, MAE: 0.2528449594974518, RSE: 0.412569522857666
Unscaled Metrics - MSE: 1151100.125, RMSE: 1072.893310546875, MAE: 668.9365234375, RSE: 0.07539474219083786

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.20464353263378143, RMSE: 0.4523754417896271, MAE: 0.2532264292240143, RSE: 0.41430240869522095
Unscaled Metrics - MSE: 1154194.75, RMSE: 1074.3345947265625, MAE: 667.5917358398438, RSE: 0.07549601793289185

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_96_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', if_relu=False, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=True, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=32, stride=16, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.7514175
	speed: 0.0452s/iter; left time: 806.6092s
	iters: 200, epoch: 1 | loss: 0.6401502
	speed: 0.0196s/iter; left time: 348.0579s
	iters: 300, epoch: 1 | loss: 0.5905042
	speed: 0.0202s/iter; left time: 356.2105s
	iters: 400, epoch: 1 | loss: 0.5559627
	speed: 0.0190s/iter; left time: 333.1042s
	iters: 500, epoch: 1 | loss: 0.5615612
	speed: 0.0198s/iter; left time: 346.1790s
	iters: 600, epoch: 1 | loss: 0.5411144
	speed: 0.0160s/iter; left time: 277.8781s
	iters: 700, epoch: 1 | loss: 0.5269336
	speed: 0.0163s/iter; left time: 280.3231s
	iters: 800, epoch: 1 | loss: 0.5610789
	speed: 0.0161s/iter; left time: 275.5844s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:16.80s
Steps: 897 | Train Loss: 0.6034338 Vali Loss: 0.4465244 Test Loss: 0.4596697
Validation loss decreased (inf --> 0.446524).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4574239
	speed: 0.0788s/iter; left time: 1334.5901s
	iters: 200, epoch: 2 | loss: 0.4118088
	speed: 0.0172s/iter; left time: 290.2751s
	iters: 300, epoch: 2 | loss: 0.4042118
	speed: 0.0172s/iter; left time: 287.5889s
	iters: 400, epoch: 2 | loss: 0.4054114
	speed: 0.0158s/iter; left time: 263.6779s
	iters: 500, epoch: 2 | loss: 0.4072154
	speed: 0.0130s/iter; left time: 215.1604s
	iters: 600, epoch: 2 | loss: 0.3628599
	speed: 0.0118s/iter; left time: 193.4663s
	iters: 700, epoch: 2 | loss: 0.3512259
	speed: 0.0116s/iter; left time: 189.4558s
	iters: 800, epoch: 2 | loss: 0.3882127
	speed: 0.0125s/iter; left time: 203.5334s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:13.02s
Steps: 897 | Train Loss: 0.4099922 Vali Loss: 0.3622923 Test Loss: 0.3820882
Validation loss decreased (0.446524 --> 0.362292).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3757448
	speed: 0.0508s/iter; left time: 815.8331s
	iters: 200, epoch: 3 | loss: 0.3952562
	speed: 0.0100s/iter; left time: 159.5964s
	iters: 300, epoch: 3 | loss: 0.3404945
	speed: 0.0096s/iter; left time: 152.4168s
	iters: 400, epoch: 3 | loss: 0.3633372
	speed: 0.0098s/iter; left time: 153.5336s
	iters: 500, epoch: 3 | loss: 0.3189395
	speed: 0.0096s/iter; left time: 149.8215s
	iters: 600, epoch: 3 | loss: 0.4049033
	speed: 0.0091s/iter; left time: 142.1546s
	iters: 700, epoch: 3 | loss: 0.3536741
	speed: 0.0093s/iter; left time: 144.1328s
	iters: 800, epoch: 3 | loss: 0.3637585
	speed: 0.0103s/iter; left time: 158.3444s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.08s
Steps: 897 | Train Loss: 0.3739315 Vali Loss: 0.3563556 Test Loss: 0.3764851
Validation loss decreased (0.362292 --> 0.356356).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3834462
	speed: 0.0446s/iter; left time: 674.9897s
	iters: 200, epoch: 4 | loss: 0.3449820
	speed: 0.0093s/iter; left time: 140.3516s
	iters: 300, epoch: 4 | loss: 0.3723511
	speed: 0.0091s/iter; left time: 136.5255s
	iters: 400, epoch: 4 | loss: 0.3590108
	speed: 0.0091s/iter; left time: 135.6298s
	iters: 500, epoch: 4 | loss: 0.3433250
	speed: 0.0091s/iter; left time: 134.7009s
	iters: 600, epoch: 4 | loss: 0.3422652
	speed: 0.0091s/iter; left time: 132.6052s
	iters: 700, epoch: 4 | loss: 0.4167950
	speed: 0.0091s/iter; left time: 131.8868s
	iters: 800, epoch: 4 | loss: 0.3455127
	speed: 0.0093s/iter; left time: 134.3304s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.47s
Steps: 897 | Train Loss: 0.3627636 Vali Loss: 0.3508383 Test Loss: 0.3732997
Validation loss decreased (0.356356 --> 0.350838).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3535787
	speed: 0.0444s/iter; left time: 632.3088s
	iters: 200, epoch: 5 | loss: 0.3268083
	speed: 0.0089s/iter; left time: 126.5845s
	iters: 300, epoch: 5 | loss: 0.3489236
	speed: 0.0089s/iter; left time: 125.0394s
	iters: 400, epoch: 5 | loss: 0.3800225
	speed: 0.0092s/iter; left time: 128.4283s
	iters: 500, epoch: 5 | loss: 0.3881747
	speed: 0.0089s/iter; left time: 123.3830s
	iters: 600, epoch: 5 | loss: 0.3358921
	speed: 0.0095s/iter; left time: 130.3837s
	iters: 700, epoch: 5 | loss: 0.3620409
	speed: 0.0089s/iter; left time: 121.9059s
	iters: 800, epoch: 5 | loss: 0.4375106
	speed: 0.0093s/iter; left time: 126.6240s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.43s
Steps: 897 | Train Loss: 0.3550606 Vali Loss: 0.3485056 Test Loss: 0.3680557
Validation loss decreased (0.350838 --> 0.348506).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3342156
	speed: 0.0448s/iter; left time: 598.1053s
	iters: 200, epoch: 6 | loss: 0.3105098
	speed: 0.0097s/iter; left time: 128.9364s
	iters: 300, epoch: 6 | loss: 0.3357395
	speed: 0.0089s/iter; left time: 117.0119s
	iters: 400, epoch: 6 | loss: 0.3474275
	speed: 0.0091s/iter; left time: 118.8607s
	iters: 500, epoch: 6 | loss: 0.3354019
	speed: 0.0090s/iter; left time: 116.0758s
	iters: 600, epoch: 6 | loss: 0.3262916
	speed: 0.0090s/iter; left time: 115.2409s
	iters: 700, epoch: 6 | loss: 0.3663172
	speed: 0.0090s/iter; left time: 114.5897s
	iters: 800, epoch: 6 | loss: 0.3063536
	speed: 0.0091s/iter; left time: 114.5623s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.50s
Steps: 897 | Train Loss: 0.3487589 Vali Loss: 0.3490477 Test Loss: 0.3676376
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3730701
	speed: 0.0415s/iter; left time: 516.6484s
	iters: 200, epoch: 7 | loss: 0.3361551
	speed: 0.0091s/iter; left time: 112.8106s
	iters: 300, epoch: 7 | loss: 0.3233663
	speed: 0.0088s/iter; left time: 108.2302s
	iters: 400, epoch: 7 | loss: 0.3257569
	speed: 0.0090s/iter; left time: 109.5441s
	iters: 500, epoch: 7 | loss: 0.2971471
	speed: 0.0088s/iter; left time: 106.3864s
	iters: 600, epoch: 7 | loss: 0.3719977
	speed: 0.0090s/iter; left time: 107.4315s
	iters: 700, epoch: 7 | loss: 0.3599455
	speed: 0.0089s/iter; left time: 105.3786s
	iters: 800, epoch: 7 | loss: 0.3505773
	speed: 0.0089s/iter; left time: 104.4008s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.28s
Steps: 897 | Train Loss: 0.3434304 Vali Loss: 0.3479084 Test Loss: 0.3659843
Validation loss decreased (0.348506 --> 0.347908).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.3142720
	speed: 0.0415s/iter; left time: 480.3257s
	iters: 200, epoch: 8 | loss: 0.3610570
	speed: 0.0093s/iter; left time: 106.8352s
	iters: 300, epoch: 8 | loss: 0.3545507
	speed: 0.0092s/iter; left time: 104.2339s
	iters: 400, epoch: 8 | loss: 0.3285860
	speed: 0.0094s/iter; left time: 106.1157s
	iters: 500, epoch: 8 | loss: 0.2896002
	speed: 0.0089s/iter; left time: 98.8633s
	iters: 600, epoch: 8 | loss: 0.3139996
	speed: 0.0093s/iter; left time: 102.4485s
	iters: 700, epoch: 8 | loss: 0.3298711
	speed: 0.0094s/iter; left time: 102.6222s
	iters: 800, epoch: 8 | loss: 0.3476716
	speed: 0.0089s/iter; left time: 96.6730s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.43s
Steps: 897 | Train Loss: 0.3384230 Vali Loss: 0.3481841 Test Loss: 0.3652087
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.3681039
	speed: 0.0413s/iter; left time: 440.7781s
	iters: 200, epoch: 9 | loss: 0.3442893
	speed: 0.0090s/iter; left time: 95.1116s
	iters: 300, epoch: 9 | loss: 0.3626364
	speed: 0.0090s/iter; left time: 94.4292s
	iters: 400, epoch: 9 | loss: 0.3456548
	speed: 0.0088s/iter; left time: 90.7303s
	iters: 500, epoch: 9 | loss: 0.3173474
	speed: 0.0085s/iter; left time: 87.7367s
	iters: 600, epoch: 9 | loss: 0.3172664
	speed: 0.0087s/iter; left time: 88.8360s
	iters: 700, epoch: 9 | loss: 0.3741704
	speed: 0.0088s/iter; left time: 88.3675s
	iters: 800, epoch: 9 | loss: 0.3217250
	speed: 0.0088s/iter; left time: 87.9456s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.17s
Steps: 897 | Train Loss: 0.3340488 Vali Loss: 0.3468455 Test Loss: 0.3638220
Validation loss decreased (0.347908 --> 0.346846).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.2824495
	speed: 0.0421s/iter; left time: 410.9004s
	iters: 200, epoch: 10 | loss: 0.3181238
	speed: 0.0088s/iter; left time: 85.2586s
	iters: 300, epoch: 10 | loss: 0.3088135
	speed: 0.0088s/iter; left time: 84.5118s
	iters: 400, epoch: 10 | loss: 0.3605276
	speed: 0.0090s/iter; left time: 84.8143s
	iters: 500, epoch: 10 | loss: 0.3768619
	speed: 0.0090s/iter; left time: 83.8918s
	iters: 600, epoch: 10 | loss: 0.3300643
	speed: 0.0090s/iter; left time: 83.2129s
	iters: 700, epoch: 10 | loss: 0.3152975
	speed: 0.0086s/iter; left time: 78.6755s
	iters: 800, epoch: 10 | loss: 0.3564855
	speed: 0.0086s/iter; left time: 77.7009s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.15s
Steps: 897 | Train Loss: 0.3310202 Vali Loss: 0.3446736 Test Loss: 0.3637165
Validation loss decreased (0.346846 --> 0.344674).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.3347583
	speed: 0.0414s/iter; left time: 367.6975s
	iters: 200, epoch: 11 | loss: 0.3564956
	speed: 0.0090s/iter; left time: 78.5530s
	iters: 300, epoch: 11 | loss: 0.3332903
	speed: 0.0088s/iter; left time: 76.0178s
	iters: 400, epoch: 11 | loss: 0.3258144
	speed: 0.0088s/iter; left time: 75.2374s
	iters: 500, epoch: 11 | loss: 0.3253122
	speed: 0.0088s/iter; left time: 74.1324s
	iters: 600, epoch: 11 | loss: 0.3212380
	speed: 0.0093s/iter; left time: 77.5979s
	iters: 700, epoch: 11 | loss: 0.3763788
	speed: 0.0088s/iter; left time: 72.7951s
	iters: 800, epoch: 11 | loss: 0.3060581
	speed: 0.0088s/iter; left time: 71.6499s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.21s
Steps: 897 | Train Loss: 0.3273775 Vali Loss: 0.3435466 Test Loss: 0.3630838
Validation loss decreased (0.344674 --> 0.343547).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.3171051
	speed: 0.0418s/iter; left time: 333.6558s
	iters: 200, epoch: 12 | loss: 0.3189286
	speed: 0.0088s/iter; left time: 69.6538s
	iters: 300, epoch: 12 | loss: 0.3306416
	speed: 0.0089s/iter; left time: 68.8071s
	iters: 400, epoch: 12 | loss: 0.3251909
	speed: 0.0089s/iter; left time: 67.9242s
	iters: 500, epoch: 12 | loss: 0.3294748
	speed: 0.0089s/iter; left time: 67.1065s
	iters: 600, epoch: 12 | loss: 0.3223368
	speed: 0.0089s/iter; left time: 66.1510s
	iters: 700, epoch: 12 | loss: 0.3156281
	speed: 0.0089s/iter; left time: 65.8049s
	iters: 800, epoch: 12 | loss: 0.3022338
	speed: 0.0089s/iter; left time: 64.7775s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.20s
Steps: 897 | Train Loss: 0.3243632 Vali Loss: 0.3459126 Test Loss: 0.3606473
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.3290944
	speed: 0.0410s/iter; left time: 289.8140s
	iters: 200, epoch: 13 | loss: 0.3176655
	speed: 0.0088s/iter; left time: 61.4024s
	iters: 300, epoch: 13 | loss: 0.3371607
	speed: 0.0089s/iter; left time: 61.0615s
	iters: 400, epoch: 13 | loss: 0.3279093
	speed: 0.0089s/iter; left time: 60.3391s
	iters: 500, epoch: 13 | loss: 0.2970512
	speed: 0.0089s/iter; left time: 59.3615s
	iters: 600, epoch: 13 | loss: 0.3378543
	speed: 0.0088s/iter; left time: 58.0869s
	iters: 700, epoch: 13 | loss: 0.2967855
	speed: 0.0088s/iter; left time: 57.2827s
	iters: 800, epoch: 13 | loss: 0.3148886
	speed: 0.0088s/iter; left time: 56.2134s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.19s
Steps: 897 | Train Loss: 0.3218812 Vali Loss: 0.3444730 Test Loss: 0.3629500
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.3281866
	speed: 0.0403s/iter; left time: 248.9851s
	iters: 200, epoch: 14 | loss: 0.2964166
	speed: 0.0086s/iter; left time: 52.2600s
	iters: 300, epoch: 14 | loss: 0.2841369
	speed: 0.0086s/iter; left time: 51.1559s
	iters: 400, epoch: 14 | loss: 0.3005539
	speed: 0.0086s/iter; left time: 50.3121s
	iters: 500, epoch: 14 | loss: 0.3279144
	speed: 0.0086s/iter; left time: 49.6982s
	iters: 600, epoch: 14 | loss: 0.3484330
	speed: 0.0088s/iter; left time: 50.1102s
	iters: 700, epoch: 14 | loss: 0.3004577
	speed: 0.0088s/iter; left time: 49.1323s
	iters: 800, epoch: 14 | loss: 0.3371571
	speed: 0.0085s/iter; left time: 46.8183s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.01s
Steps: 897 | Train Loss: 0.3199465 Vali Loss: 0.3430583 Test Loss: 0.3619661
Validation loss decreased (0.343547 --> 0.343058).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.3163303
	speed: 0.0399s/iter; left time: 210.9834s
	iters: 200, epoch: 15 | loss: 0.3020713
	speed: 0.0086s/iter; left time: 44.6910s
	iters: 300, epoch: 15 | loss: 0.3083589
	speed: 0.0086s/iter; left time: 43.7982s
	iters: 400, epoch: 15 | loss: 0.3411031
	speed: 0.0087s/iter; left time: 43.1537s
	iters: 500, epoch: 15 | loss: 0.3179394
	speed: 0.0086s/iter; left time: 42.2108s
	iters: 600, epoch: 15 | loss: 0.3116530
	speed: 0.0087s/iter; left time: 41.3813s
	iters: 700, epoch: 15 | loss: 0.2811683
	speed: 0.0087s/iter; left time: 40.5665s
	iters: 800, epoch: 15 | loss: 0.2827787
	speed: 0.0088s/iter; left time: 40.3814s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.02s
Steps: 897 | Train Loss: 0.3177625 Vali Loss: 0.3435780 Test Loss: 0.3616664
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.3255170
	speed: 0.0407s/iter; left time: 178.7257s
	iters: 200, epoch: 16 | loss: 0.3085119
	speed: 0.0087s/iter; left time: 37.3913s
	iters: 300, epoch: 16 | loss: 0.3413093
	speed: 0.0088s/iter; left time: 36.6313s
	iters: 400, epoch: 16 | loss: 0.3244358
	speed: 0.0087s/iter; left time: 35.7279s
	iters: 500, epoch: 16 | loss: 0.2900431
	speed: 0.0087s/iter; left time: 34.8560s
	iters: 600, epoch: 16 | loss: 0.3432093
	speed: 0.0087s/iter; left time: 33.8295s
	iters: 700, epoch: 16 | loss: 0.3215046
	speed: 0.0087s/iter; left time: 32.9995s
	iters: 800, epoch: 16 | loss: 0.3611600
	speed: 0.0087s/iter; left time: 32.0523s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.08s
Steps: 897 | Train Loss: 0.3159378 Vali Loss: 0.3446867 Test Loss: 0.3626323
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.3366415
	speed: 0.0400s/iter; left time: 139.4134s
	iters: 200, epoch: 17 | loss: 0.2753668
	speed: 0.0087s/iter; left time: 29.5371s
	iters: 300, epoch: 17 | loss: 0.3375722
	speed: 0.0087s/iter; left time: 28.7379s
	iters: 400, epoch: 17 | loss: 0.3544010
	speed: 0.0087s/iter; left time: 27.8411s
	iters: 500, epoch: 17 | loss: 0.3123714
	speed: 0.0087s/iter; left time: 26.9107s
	iters: 600, epoch: 17 | loss: 0.3189503
	speed: 0.0090s/iter; left time: 26.8347s
	iters: 700, epoch: 17 | loss: 0.3083826
	speed: 0.0087s/iter; left time: 25.1656s
	iters: 800, epoch: 17 | loss: 0.3014234
	speed: 0.0087s/iter; left time: 24.2995s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.07s
Steps: 897 | Train Loss: 0.3142884 Vali Loss: 0.3429579 Test Loss: 0.3614777
Validation loss decreased (0.343058 --> 0.342958).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.2661080
	speed: 0.0408s/iter; left time: 105.6640s
	iters: 200, epoch: 18 | loss: 0.2990568
	speed: 0.0086s/iter; left time: 21.4154s
	iters: 300, epoch: 18 | loss: 0.3222444
	speed: 0.0086s/iter; left time: 20.6688s
	iters: 400, epoch: 18 | loss: 0.3054195
	speed: 0.0086s/iter; left time: 19.8210s
	iters: 500, epoch: 18 | loss: 0.2665257
	speed: 0.0087s/iter; left time: 19.0488s
	iters: 600, epoch: 18 | loss: 0.3368691
	speed: 0.0087s/iter; left time: 18.1916s
	iters: 700, epoch: 18 | loss: 0.2991176
	speed: 0.0087s/iter; left time: 17.3025s
	iters: 800, epoch: 18 | loss: 0.2893756
	speed: 0.0087s/iter; left time: 16.4390s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.00s
Steps: 897 | Train Loss: 0.3129078 Vali Loss: 0.3435828 Test Loss: 0.3619969
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.3304125
	speed: 0.0384s/iter; left time: 65.1334s
	iters: 200, epoch: 19 | loss: 0.3260545
	speed: 0.0085s/iter; left time: 13.5040s
	iters: 300, epoch: 19 | loss: 0.3390594
	speed: 0.0093s/iter; left time: 13.9212s
	iters: 400, epoch: 19 | loss: 0.3017560
	speed: 0.0085s/iter; left time: 11.8849s
	iters: 500, epoch: 19 | loss: 0.2908346
	speed: 0.0085s/iter; left time: 10.9937s
	iters: 600, epoch: 19 | loss: 0.2753017
	speed: 0.0085s/iter; left time: 10.1717s
	iters: 700, epoch: 19 | loss: 0.2979496
	speed: 0.0086s/iter; left time: 9.4195s
	iters: 800, epoch: 19 | loss: 0.2968192
	speed: 0.0087s/iter; left time: 8.6173s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.91s
Steps: 897 | Train Loss: 0.3117750 Vali Loss: 0.3443417 Test Loss: 0.3627943
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.3307122
	speed: 0.0387s/iter; left time: 30.8705s
	iters: 200, epoch: 20 | loss: 0.3025938
	speed: 0.0087s/iter; left time: 6.0608s
	iters: 300, epoch: 20 | loss: 0.3137756
	speed: 0.0087s/iter; left time: 5.2092s
	iters: 400, epoch: 20 | loss: 0.2995884
	speed: 0.0087s/iter; left time: 4.3266s
	iters: 500, epoch: 20 | loss: 0.3448595
	speed: 0.0087s/iter; left time: 3.4595s
	iters: 600, epoch: 20 | loss: 0.3093475
	speed: 0.0087s/iter; left time: 2.5786s
	iters: 700, epoch: 20 | loss: 0.3201503
	speed: 0.0084s/iter; left time: 1.6656s
	iters: 800, epoch: 20 | loss: 0.3182980
	speed: 0.0084s/iter; left time: 0.8244s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.90s
Steps: 897 | Train Loss: 0.3106752 Vali Loss: 0.3423418 Test Loss: 0.3620897
Validation loss decreased (0.342958 --> 0.342342).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.38033607602119446, rmse:0.6167139410972595, mae:0.36208972334861755, rse:0.564666211605072
Original data scale mse:2383695.25, rmse:1543.9219970703125, mae:980.0679931640625, rse:0.10865209996700287
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.7774693
	speed: 0.0109s/iter; left time: 193.9124s
	iters: 200, epoch: 1 | loss: 0.6751431
	speed: 0.0088s/iter; left time: 155.8489s
	iters: 300, epoch: 1 | loss: 0.6087647
	speed: 0.0087s/iter; left time: 154.2075s
	iters: 400, epoch: 1 | loss: 0.6034860
	speed: 0.0087s/iter; left time: 152.8976s
	iters: 500, epoch: 1 | loss: 0.5404494
	speed: 0.0087s/iter; left time: 151.0358s
	iters: 600, epoch: 1 | loss: 0.5629245
	speed: 0.0086s/iter; left time: 149.9871s
	iters: 700, epoch: 1 | loss: 0.5052282
	speed: 0.0087s/iter; left time: 149.1689s
	iters: 800, epoch: 1 | loss: 0.4954823
	speed: 0.0087s/iter; left time: 148.6294s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.04s
Steps: 897 | Train Loss: 0.5995725 Vali Loss: 0.4458747 Test Loss: 0.4591461
Validation loss decreased (inf --> 0.445875).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4513046
	speed: 0.0396s/iter; left time: 670.3410s
	iters: 200, epoch: 2 | loss: 0.4292589
	speed: 0.0087s/iter; left time: 146.6718s
	iters: 300, epoch: 2 | loss: 0.4000707
	speed: 0.0087s/iter; left time: 144.9689s
	iters: 400, epoch: 2 | loss: 0.4411529
	speed: 0.0085s/iter; left time: 142.2559s
	iters: 500, epoch: 2 | loss: 0.3781196
	speed: 0.0085s/iter; left time: 141.0019s
	iters: 600, epoch: 2 | loss: 0.3513761
	speed: 0.0085s/iter; left time: 140.4830s
	iters: 700, epoch: 2 | loss: 0.3698645
	speed: 0.0085s/iter; left time: 139.6188s
	iters: 800, epoch: 2 | loss: 0.3681866
	speed: 0.0086s/iter; left time: 139.1506s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.00s
Steps: 897 | Train Loss: 0.4100288 Vali Loss: 0.3623971 Test Loss: 0.3808250
Validation loss decreased (0.445875 --> 0.362397).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3657054
	speed: 0.0405s/iter; left time: 649.9747s
	iters: 200, epoch: 3 | loss: 0.3968618
	speed: 0.0093s/iter; left time: 148.9041s
	iters: 300, epoch: 3 | loss: 0.3694086
	speed: 0.0086s/iter; left time: 136.2068s
	iters: 400, epoch: 3 | loss: 0.3849172
	speed: 0.0086s/iter; left time: 135.5283s
	iters: 500, epoch: 3 | loss: 0.3935122
	speed: 0.0086s/iter; left time: 134.7507s
	iters: 600, epoch: 3 | loss: 0.3381604
	speed: 0.0086s/iter; left time: 133.6106s
	iters: 700, epoch: 3 | loss: 0.3651076
	speed: 0.0086s/iter; left time: 133.2495s
	iters: 800, epoch: 3 | loss: 0.3790073
	speed: 0.0087s/iter; left time: 133.6907s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.18s
Steps: 897 | Train Loss: 0.3739169 Vali Loss: 0.3553885 Test Loss: 0.3725315
Validation loss decreased (0.362397 --> 0.355388).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3487389
	speed: 0.0412s/iter; left time: 624.3304s
	iters: 200, epoch: 4 | loss: 0.3676181
	speed: 0.0088s/iter; left time: 132.0581s
	iters: 300, epoch: 4 | loss: 0.3484921
	speed: 0.0088s/iter; left time: 131.1042s
	iters: 400, epoch: 4 | loss: 0.3627521
	speed: 0.0088s/iter; left time: 130.0990s
	iters: 500, epoch: 4 | loss: 0.3417716
	speed: 0.0087s/iter; left time: 128.2294s
	iters: 600, epoch: 4 | loss: 0.3378545
	speed: 0.0085s/iter; left time: 124.8311s
	iters: 700, epoch: 4 | loss: 0.3636090
	speed: 0.0086s/iter; left time: 124.7620s
	iters: 800, epoch: 4 | loss: 0.3373620
	speed: 0.0086s/iter; left time: 123.6660s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.04s
Steps: 897 | Train Loss: 0.3630475 Vali Loss: 0.3541304 Test Loss: 0.3710423
Validation loss decreased (0.355388 --> 0.354130).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3776742
	speed: 0.0412s/iter; left time: 587.7750s
	iters: 200, epoch: 5 | loss: 0.3508545
	speed: 0.0093s/iter; left time: 131.1768s
	iters: 300, epoch: 5 | loss: 0.3805312
	speed: 0.0093s/iter; left time: 130.5802s
	iters: 400, epoch: 5 | loss: 0.3610172
	speed: 0.0093s/iter; left time: 129.2326s
	iters: 500, epoch: 5 | loss: 0.3989326
	speed: 0.0093s/iter; left time: 128.5022s
	iters: 600, epoch: 5 | loss: 0.3641023
	speed: 0.0093s/iter; left time: 127.5333s
	iters: 700, epoch: 5 | loss: 0.3472407
	speed: 0.0093s/iter; left time: 126.7883s
	iters: 800, epoch: 5 | loss: 0.3726093
	speed: 0.0102s/iter; left time: 138.4576s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.83s
Steps: 897 | Train Loss: 0.3550299 Vali Loss: 0.3492062 Test Loss: 0.3663684
Validation loss decreased (0.354130 --> 0.349206).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3538367
	speed: 0.0450s/iter; left time: 601.1614s
	iters: 200, epoch: 6 | loss: 0.3570811
	speed: 0.0094s/iter; left time: 123.9892s
	iters: 300, epoch: 6 | loss: 0.3274531
	speed: 0.0092s/iter; left time: 120.7544s
	iters: 400, epoch: 6 | loss: 0.3467427
	speed: 0.0092s/iter; left time: 119.8991s
	iters: 500, epoch: 6 | loss: 0.3370582
	speed: 0.0092s/iter; left time: 119.0991s
	iters: 600, epoch: 6 | loss: 0.3740810
	speed: 0.0092s/iter; left time: 118.1604s
	iters: 700, epoch: 6 | loss: 0.3002090
	speed: 0.0091s/iter; left time: 116.3594s
	iters: 800, epoch: 6 | loss: 0.3368007
	speed: 0.0214s/iter; left time: 270.7885s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.76s
Steps: 897 | Train Loss: 0.3482373 Vali Loss: 0.3491279 Test Loss: 0.3641592
Validation loss decreased (0.349206 --> 0.349128).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3368134
	speed: 0.0394s/iter; left time: 490.5377s
	iters: 200, epoch: 7 | loss: 0.3164519
	speed: 0.0087s/iter; left time: 107.7075s
	iters: 300, epoch: 7 | loss: 0.3280363
	speed: 0.0087s/iter; left time: 106.7187s
	iters: 400, epoch: 7 | loss: 0.3481063
	speed: 0.0087s/iter; left time: 105.5107s
	iters: 500, epoch: 7 | loss: 0.3362916
	speed: 0.0087s/iter; left time: 104.6394s
	iters: 600, epoch: 7 | loss: 0.3141475
	speed: 0.0093s/iter; left time: 110.8440s
	iters: 700, epoch: 7 | loss: 0.3284840
	speed: 0.0096s/iter; left time: 114.2760s
	iters: 800, epoch: 7 | loss: 0.3428023
	speed: 0.0087s/iter; left time: 102.1788s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.16s
Steps: 897 | Train Loss: 0.3425291 Vali Loss: 0.3456379 Test Loss: 0.3627672
Validation loss decreased (0.349128 --> 0.345638).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.3183497
	speed: 0.0407s/iter; left time: 470.3665s
	iters: 200, epoch: 8 | loss: 0.3498324
	speed: 0.0093s/iter; left time: 106.1164s
	iters: 300, epoch: 8 | loss: 0.2768609
	speed: 0.0093s/iter; left time: 105.1972s
	iters: 400, epoch: 8 | loss: 0.3527438
	speed: 0.0093s/iter; left time: 104.3762s
	iters: 500, epoch: 8 | loss: 0.3375866
	speed: 0.0093s/iter; left time: 103.5365s
	iters: 600, epoch: 8 | loss: 0.3273603
	speed: 0.0093s/iter; left time: 102.4075s
	iters: 700, epoch: 8 | loss: 0.3372165
	speed: 0.0090s/iter; left time: 99.0186s
	iters: 800, epoch: 8 | loss: 0.3586134
	speed: 0.0091s/iter; left time: 98.4458s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:11.99s
Steps: 897 | Train Loss: 0.3375707 Vali Loss: 0.3490999 Test Loss: 0.3653992
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.3484027
	speed: 0.1185s/iter; left time: 1263.9611s
	iters: 200, epoch: 9 | loss: 0.3199206
	speed: 0.0096s/iter; left time: 101.9222s
	iters: 300, epoch: 9 | loss: 0.3186013
	speed: 0.0093s/iter; left time: 97.1855s
	iters: 400, epoch: 9 | loss: 0.3358135
	speed: 0.0091s/iter; left time: 94.4808s
	iters: 500, epoch: 9 | loss: 0.3053004
	speed: 0.0092s/iter; left time: 94.0211s
	iters: 600, epoch: 9 | loss: 0.3521647
	speed: 0.0093s/iter; left time: 94.4844s
	iters: 700, epoch: 9 | loss: 0.3570841
	speed: 0.0091s/iter; left time: 91.6465s
	iters: 800, epoch: 9 | loss: 0.3258080
	speed: 0.0091s/iter; left time: 90.6538s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.61s
Steps: 897 | Train Loss: 0.3334605 Vali Loss: 0.3464477 Test Loss: 0.3615061
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.3108127
	speed: 0.0407s/iter; left time: 397.7850s
	iters: 200, epoch: 10 | loss: 0.3208652
	speed: 0.0089s/iter; left time: 86.0799s
	iters: 300, epoch: 10 | loss: 0.3384416
	speed: 0.0089s/iter; left time: 84.8801s
	iters: 400, epoch: 10 | loss: 0.3429913
	speed: 0.0089s/iter; left time: 84.2386s
	iters: 500, epoch: 10 | loss: 0.3694143
	speed: 0.0088s/iter; left time: 82.2411s
	iters: 600, epoch: 10 | loss: 0.3883637
	speed: 0.0088s/iter; left time: 81.9743s
	iters: 700, epoch: 10 | loss: 0.3374763
	speed: 0.0088s/iter; left time: 80.7232s
	iters: 800, epoch: 10 | loss: 0.2939519
	speed: 0.0088s/iter; left time: 79.8781s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.19s
Steps: 897 | Train Loss: 0.3296852 Vali Loss: 0.3462023 Test Loss: 0.3615024
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.3120036
	speed: 0.0419s/iter; left time: 371.8070s
	iters: 200, epoch: 11 | loss: 0.3101943
	speed: 0.0094s/iter; left time: 82.1198s
	iters: 300, epoch: 11 | loss: 0.3080224
	speed: 0.0092s/iter; left time: 80.1846s
	iters: 400, epoch: 11 | loss: 0.3623957
	speed: 0.0093s/iter; left time: 80.0490s
	iters: 500, epoch: 11 | loss: 0.3192039
	speed: 0.0093s/iter; left time: 79.1166s
	iters: 600, epoch: 11 | loss: 0.3261977
	speed: 0.0093s/iter; left time: 78.1336s
	iters: 700, epoch: 11 | loss: 0.3347584
	speed: 0.0101s/iter; left time: 83.5663s
	iters: 800, epoch: 11 | loss: 0.3808204
	speed: 0.0105s/iter; left time: 85.9152s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.99s
Steps: 897 | Train Loss: 0.3264432 Vali Loss: 0.3459300 Test Loss: 0.3611685
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.3212530
	speed: 0.0406s/iter; left time: 323.8492s
	iters: 200, epoch: 12 | loss: 0.3205430
	speed: 0.0087s/iter; left time: 68.6105s
	iters: 300, epoch: 12 | loss: 0.3026505
	speed: 0.0087s/iter; left time: 67.5789s
	iters: 400, epoch: 12 | loss: 0.3757011
	speed: 0.0087s/iter; left time: 66.9012s
	iters: 500, epoch: 12 | loss: 0.3132679
	speed: 0.0087s/iter; left time: 65.5773s
	iters: 600, epoch: 12 | loss: 0.3185219
	speed: 0.0087s/iter; left time: 65.0478s
	iters: 700, epoch: 12 | loss: 0.3360890
	speed: 0.0087s/iter; left time: 63.9295s
	iters: 800, epoch: 12 | loss: 0.2704958
	speed: 0.0087s/iter; left time: 63.1913s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.06s
Steps: 897 | Train Loss: 0.3234286 Vali Loss: 0.3454515 Test Loss: 0.3619297
Validation loss decreased (0.345638 --> 0.345451).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.3203055
	speed: 0.0419s/iter; left time: 296.4703s
	iters: 200, epoch: 13 | loss: 0.3404705
	speed: 0.0088s/iter; left time: 61.3284s
	iters: 300, epoch: 13 | loss: 0.3308966
	speed: 0.0088s/iter; left time: 60.3983s
	iters: 400, epoch: 13 | loss: 0.3491787
	speed: 0.0089s/iter; left time: 60.2759s
	iters: 500, epoch: 13 | loss: 0.3531452
	speed: 0.0088s/iter; left time: 58.6032s
	iters: 600, epoch: 13 | loss: 0.2851906
	speed: 0.0088s/iter; left time: 57.9566s
	iters: 700, epoch: 13 | loss: 0.3489001
	speed: 0.0088s/iter; left time: 56.7725s
	iters: 800, epoch: 13 | loss: 0.2888371
	speed: 0.0088s/iter; left time: 55.9068s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.21s
Steps: 897 | Train Loss: 0.3206600 Vali Loss: 0.3454894 Test Loss: 0.3627238
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.3066975
	speed: 0.0391s/iter; left time: 241.9212s
	iters: 200, epoch: 14 | loss: 0.3062976
	speed: 0.0087s/iter; left time: 52.9511s
	iters: 300, epoch: 14 | loss: 0.3140700
	speed: 0.0087s/iter; left time: 52.2147s
	iters: 400, epoch: 14 | loss: 0.2907820
	speed: 0.0087s/iter; left time: 51.3365s
	iters: 500, epoch: 14 | loss: 0.3251272
	speed: 0.0087s/iter; left time: 50.5405s
	iters: 600, epoch: 14 | loss: 0.3207138
	speed: 0.0088s/iter; left time: 49.7227s
	iters: 700, epoch: 14 | loss: 0.3203254
	speed: 0.0088s/iter; left time: 49.2024s
	iters: 800, epoch: 14 | loss: 0.3507325
	speed: 0.0087s/iter; left time: 47.9299s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.10s
Steps: 897 | Train Loss: 0.3179228 Vali Loss: 0.3445534 Test Loss: 0.3622506
Validation loss decreased (0.345451 --> 0.344553).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.3122340
	speed: 0.0391s/iter; left time: 206.6113s
	iters: 200, epoch: 15 | loss: 0.3323838
	speed: 0.0087s/iter; left time: 45.1443s
	iters: 300, epoch: 15 | loss: 0.3290726
	speed: 0.0087s/iter; left time: 44.4201s
	iters: 400, epoch: 15 | loss: 0.3269479
	speed: 0.0086s/iter; left time: 43.0252s
	iters: 500, epoch: 15 | loss: 0.3353547
	speed: 0.0086s/iter; left time: 41.8876s
	iters: 600, epoch: 15 | loss: 0.3008175
	speed: 0.0086s/iter; left time: 41.2408s
	iters: 700, epoch: 15 | loss: 0.2934311
	speed: 0.0086s/iter; left time: 40.1816s
	iters: 800, epoch: 15 | loss: 0.3224671
	speed: 0.0086s/iter; left time: 39.2950s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.98s
Steps: 897 | Train Loss: 0.3166009 Vali Loss: 0.3448488 Test Loss: 0.3641814
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.3261005
	speed: 0.0380s/iter; left time: 166.7334s
	iters: 200, epoch: 16 | loss: 0.3258140
	speed: 0.0086s/iter; left time: 36.6696s
	iters: 300, epoch: 16 | loss: 0.2868002
	speed: 0.0085s/iter; left time: 35.7503s
	iters: 400, epoch: 16 | loss: 0.3291508
	speed: 0.0088s/iter; left time: 35.8734s
	iters: 500, epoch: 16 | loss: 0.3149005
	speed: 0.0087s/iter; left time: 34.6861s
	iters: 600, epoch: 16 | loss: 0.3096982
	speed: 0.0086s/iter; left time: 33.5787s
	iters: 700, epoch: 16 | loss: 0.2979588
	speed: 0.0087s/iter; left time: 32.8036s
	iters: 800, epoch: 16 | loss: 0.3243422
	speed: 0.0087s/iter; left time: 31.9140s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.00s
Steps: 897 | Train Loss: 0.3143067 Vali Loss: 0.3436262 Test Loss: 0.3638674
Validation loss decreased (0.344553 --> 0.343626).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.2882833
	speed: 0.0438s/iter; left time: 152.6981s
	iters: 200, epoch: 17 | loss: 0.3036416
	speed: 0.0086s/iter; left time: 29.1299s
	iters: 300, epoch: 17 | loss: 0.2904417
	speed: 0.0085s/iter; left time: 27.9451s
	iters: 400, epoch: 17 | loss: 0.3182327
	speed: 0.0095s/iter; left time: 30.3524s
	iters: 500, epoch: 17 | loss: 0.2774574
	speed: 0.0087s/iter; left time: 26.7435s
	iters: 600, epoch: 17 | loss: 0.3389721
	speed: 0.0087s/iter; left time: 25.9428s
	iters: 700, epoch: 17 | loss: 0.3461413
	speed: 0.0087s/iter; left time: 25.1112s
	iters: 800, epoch: 17 | loss: 0.3306652
	speed: 0.0087s/iter; left time: 24.2041s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.78s
Steps: 897 | Train Loss: 0.3125173 Vali Loss: 0.3433429 Test Loss: 0.3637203
Validation loss decreased (0.343626 --> 0.343343).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.3331275
	speed: 0.2806s/iter; left time: 727.3950s
	iters: 200, epoch: 18 | loss: 0.3216007
	speed: 0.0500s/iter; left time: 124.5692s
	iters: 300, epoch: 18 | loss: 0.3117593
	speed: 0.0522s/iter; left time: 124.9102s
	iters: 400, epoch: 18 | loss: 0.2743699
	speed: 0.0590s/iter; left time: 135.2962s
	iters: 500, epoch: 18 | loss: 0.3222850
	speed: 0.0553s/iter; left time: 121.1583s
	iters: 600, epoch: 18 | loss: 0.2771661
	speed: 0.0557s/iter; left time: 116.5510s
	iters: 700, epoch: 18 | loss: 0.3060183
	speed: 0.0558s/iter; left time: 111.0735s
	iters: 800, epoch: 18 | loss: 0.2818872
	speed: 0.0627s/iter; left time: 118.6483s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:51.03s
Steps: 897 | Train Loss: 0.3111976 Vali Loss: 0.3450217 Test Loss: 0.3640846
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.2994820
	speed: 0.2994s/iter; left time: 507.4847s
	iters: 200, epoch: 19 | loss: 0.3568630
	speed: 0.0496s/iter; left time: 79.0495s
	iters: 300, epoch: 19 | loss: 0.2891262
	speed: 0.0538s/iter; left time: 80.4939s
	iters: 400, epoch: 19 | loss: 0.3171934
	speed: 0.0421s/iter; left time: 58.6887s
	iters: 500, epoch: 19 | loss: 0.2793809
	speed: 0.0279s/iter; left time: 36.0870s
	iters: 600, epoch: 19 | loss: 0.3038394
	speed: 0.0213s/iter; left time: 25.4819s
	iters: 700, epoch: 19 | loss: 0.3113309
	speed: 0.0222s/iter; left time: 24.3365s
	iters: 800, epoch: 19 | loss: 0.3030738
	speed: 0.0221s/iter; left time: 21.9622s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:32.17s
Steps: 897 | Train Loss: 0.3101808 Vali Loss: 0.3425474 Test Loss: 0.3645630
Validation loss decreased (0.343343 --> 0.342547).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.2925731
	speed: 0.0859s/iter; left time: 68.5264s
	iters: 200, epoch: 20 | loss: 0.2654369
	speed: 0.0117s/iter; left time: 8.1498s
	iters: 300, epoch: 20 | loss: 0.2985319
	speed: 0.0116s/iter; left time: 6.9622s
	iters: 400, epoch: 20 | loss: 0.3121902
	speed: 0.0112s/iter; left time: 5.5769s
	iters: 500, epoch: 20 | loss: 0.3083813
	speed: 0.0113s/iter; left time: 4.5151s
	iters: 600, epoch: 20 | loss: 0.3238294
	speed: 0.0112s/iter; left time: 3.3467s
	iters: 700, epoch: 20 | loss: 0.3087211
	speed: 0.0112s/iter; left time: 2.2226s
	iters: 800, epoch: 20 | loss: 0.3275436
	speed: 0.0111s/iter; left time: 1.0878s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:10.93s
Steps: 897 | Train Loss: 0.3086473 Vali Loss: 0.3434329 Test Loss: 0.3636374
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.38670042157173157, rmse:0.6218523979187012, mae:0.3645629584789276, rse:0.5693709850311279
Original data scale mse:2395718.25, rmse:1547.810791015625, mae:982.5762329101562, rse:0.10892577469348907

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.38033607602119446, RMSE: 0.6167139410972595, MAE: 0.36208972334861755, RSE: 0.564666211605072
Unscaled Metrics - MSE: 2383695.25, RMSE: 1543.9219970703125, MAE: 980.0679931640625, RSE: 0.10865209996700287

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.38670042157173157, RMSE: 0.6218523979187012, MAE: 0.3645629584789276, RSE: 0.5693709850311279
Unscaled Metrics - MSE: 2395718.25, RMSE: 1547.810791015625, MAE: 982.5762329101562, RSE: 0.10892577469348907

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_168_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', if_relu=False, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=True, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=32, stride=16, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.7366505
	speed: 0.0327s/iter; left time: 581.5329s
	iters: 200, epoch: 1 | loss: 0.6479643
	speed: 0.0115s/iter; left time: 204.0290s
	iters: 300, epoch: 1 | loss: 0.6151385
	speed: 0.0112s/iter; left time: 197.3579s
	iters: 400, epoch: 1 | loss: 0.5734547
	speed: 0.0105s/iter; left time: 183.8238s
	iters: 500, epoch: 1 | loss: 0.5883787
	speed: 0.0102s/iter; left time: 176.9395s
	iters: 600, epoch: 1 | loss: 0.5283536
	speed: 0.0103s/iter; left time: 178.3983s
	iters: 700, epoch: 1 | loss: 0.5319592
	speed: 0.0101s/iter; left time: 173.3018s
	iters: 800, epoch: 1 | loss: 0.5144297
	speed: 0.0101s/iter; left time: 172.3098s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.08s
Steps: 894 | Train Loss: 0.6120612 Vali Loss: 0.4599707 Test Loss: 0.4716345
Validation loss decreased (inf --> 0.459971).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4572157
	speed: 0.0453s/iter; left time: 765.6249s
	iters: 200, epoch: 2 | loss: 0.4530738
	speed: 0.0097s/iter; left time: 162.1094s
	iters: 300, epoch: 2 | loss: 0.4448233
	speed: 0.0095s/iter; left time: 158.7635s
	iters: 400, epoch: 2 | loss: 0.4612013
	speed: 0.0096s/iter; left time: 159.6172s
	iters: 500, epoch: 2 | loss: 0.4307253
	speed: 0.0095s/iter; left time: 156.4601s
	iters: 600, epoch: 2 | loss: 0.4569948
	speed: 0.0097s/iter; left time: 159.0907s
	iters: 700, epoch: 2 | loss: 0.4278845
	speed: 0.0092s/iter; left time: 149.0397s
	iters: 800, epoch: 2 | loss: 0.4178460
	speed: 0.0094s/iter; left time: 152.9067s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.81s
Steps: 894 | Train Loss: 0.4272809 Vali Loss: 0.3834392 Test Loss: 0.4024604
Validation loss decreased (0.459971 --> 0.383439).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4186552
	speed: 0.0449s/iter; left time: 717.3901s
	iters: 200, epoch: 3 | loss: 0.4165560
	speed: 0.0098s/iter; left time: 156.4526s
	iters: 300, epoch: 3 | loss: 0.4020907
	speed: 0.0097s/iter; left time: 152.5224s
	iters: 400, epoch: 3 | loss: 0.4213612
	speed: 0.0097s/iter; left time: 152.0798s
	iters: 500, epoch: 3 | loss: 0.3421817
	speed: 0.0096s/iter; left time: 148.9909s
	iters: 600, epoch: 3 | loss: 0.4090547
	speed: 0.0095s/iter; left time: 146.7001s
	iters: 700, epoch: 3 | loss: 0.4059201
	speed: 0.0094s/iter; left time: 144.4110s
	iters: 800, epoch: 3 | loss: 0.4001186
	speed: 0.0104s/iter; left time: 158.7289s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.99s
Steps: 894 | Train Loss: 0.3910679 Vali Loss: 0.3768012 Test Loss: 0.3954803
Validation loss decreased (0.383439 --> 0.376801).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4120415
	speed: 0.0436s/iter; left time: 657.7917s
	iters: 200, epoch: 4 | loss: 0.3708228
	speed: 0.0095s/iter; left time: 142.0613s
	iters: 300, epoch: 4 | loss: 0.3700168
	speed: 0.0094s/iter; left time: 140.4544s
	iters: 400, epoch: 4 | loss: 0.3696789
	speed: 0.0095s/iter; left time: 140.6681s
	iters: 500, epoch: 4 | loss: 0.3704349
	speed: 0.0096s/iter; left time: 140.9836s
	iters: 600, epoch: 4 | loss: 0.3580534
	speed: 0.0095s/iter; left time: 138.2037s
	iters: 700, epoch: 4 | loss: 0.3707525
	speed: 0.0095s/iter; left time: 138.4131s
	iters: 800, epoch: 4 | loss: 0.3454503
	speed: 0.0095s/iter; left time: 137.1992s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.76s
Steps: 894 | Train Loss: 0.3802215 Vali Loss: 0.3784407 Test Loss: 0.3944877
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3508845
	speed: 0.0452s/iter; left time: 642.5983s
	iters: 200, epoch: 5 | loss: 0.3809310
	speed: 0.0110s/iter; left time: 154.8940s
	iters: 300, epoch: 5 | loss: 0.3944344
	speed: 0.0109s/iter; left time: 152.3712s
	iters: 400, epoch: 5 | loss: 0.3966805
	speed: 0.0097s/iter; left time: 134.1856s
	iters: 500, epoch: 5 | loss: 0.3770353
	speed: 0.0094s/iter; left time: 130.4553s
	iters: 600, epoch: 5 | loss: 0.3931713
	speed: 0.0091s/iter; left time: 124.5896s
	iters: 700, epoch: 5 | loss: 0.3493163
	speed: 0.0092s/iter; left time: 124.5244s
	iters: 800, epoch: 5 | loss: 0.3842440
	speed: 0.0091s/iter; left time: 122.7108s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.06s
Steps: 894 | Train Loss: 0.3724009 Vali Loss: 0.3734277 Test Loss: 0.3924864
Validation loss decreased (0.376801 --> 0.373428).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3966673
	speed: 0.0427s/iter; left time: 568.7187s
	iters: 200, epoch: 6 | loss: 0.3558659
	speed: 0.0091s/iter; left time: 120.6841s
	iters: 300, epoch: 6 | loss: 0.3744527
	speed: 0.0090s/iter; left time: 117.3665s
	iters: 400, epoch: 6 | loss: 0.3786902
	speed: 0.0089s/iter; left time: 116.2690s
	iters: 500, epoch: 6 | loss: 0.3561548
	speed: 0.0091s/iter; left time: 117.3542s
	iters: 600, epoch: 6 | loss: 0.3710408
	speed: 0.0093s/iter; left time: 119.6705s
	iters: 700, epoch: 6 | loss: 0.3952173
	speed: 0.0093s/iter; left time: 118.5046s
	iters: 800, epoch: 6 | loss: 0.3412501
	speed: 0.0093s/iter; left time: 117.3708s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.47s
Steps: 894 | Train Loss: 0.3650437 Vali Loss: 0.3734994 Test Loss: 0.3879066
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3746090
	speed: 0.0420s/iter; left time: 521.5554s
	iters: 200, epoch: 7 | loss: 0.3318700
	speed: 0.0091s/iter; left time: 111.5657s
	iters: 300, epoch: 7 | loss: 0.3692707
	speed: 0.0091s/iter; left time: 110.6423s
	iters: 400, epoch: 7 | loss: 0.3778376
	speed: 0.0090s/iter; left time: 109.1847s
	iters: 500, epoch: 7 | loss: 0.3813817
	speed: 0.0090s/iter; left time: 108.2427s
	iters: 600, epoch: 7 | loss: 0.3554855
	speed: 0.0090s/iter; left time: 107.6058s
	iters: 700, epoch: 7 | loss: 0.3382915
	speed: 0.0090s/iter; left time: 106.7217s
	iters: 800, epoch: 7 | loss: 0.3599035
	speed: 0.0090s/iter; left time: 105.9747s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.35s
Steps: 894 | Train Loss: 0.3594682 Vali Loss: 0.3736148 Test Loss: 0.3886037
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.3398907
	speed: 0.0429s/iter; left time: 494.5452s
	iters: 200, epoch: 8 | loss: 0.3347653
	speed: 0.0100s/iter; left time: 114.4621s
	iters: 300, epoch: 8 | loss: 0.3559730
	speed: 0.0095s/iter; left time: 107.0639s
	iters: 400, epoch: 8 | loss: 0.3314939
	speed: 0.0094s/iter; left time: 105.9741s
	iters: 500, epoch: 8 | loss: 0.3508800
	speed: 0.0094s/iter; left time: 104.8701s
	iters: 600, epoch: 8 | loss: 0.3124669
	speed: 0.0094s/iter; left time: 103.9574s
	iters: 700, epoch: 8 | loss: 0.3954764
	speed: 0.0095s/iter; left time: 103.2804s
	iters: 800, epoch: 8 | loss: 0.3534641
	speed: 0.0094s/iter; left time: 102.1550s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.82s
Steps: 894 | Train Loss: 0.3539570 Vali Loss: 0.3754734 Test Loss: 0.3887312
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.3465421
	speed: 0.0418s/iter; left time: 443.7969s
	iters: 200, epoch: 9 | loss: 0.3590814
	speed: 0.0093s/iter; left time: 97.6508s
	iters: 300, epoch: 9 | loss: 0.3541987
	speed: 0.0093s/iter; left time: 96.6384s
	iters: 400, epoch: 9 | loss: 0.3536294
	speed: 0.0093s/iter; left time: 95.7075s
	iters: 500, epoch: 9 | loss: 0.3403978
	speed: 0.0092s/iter; left time: 94.4582s
	iters: 600, epoch: 9 | loss: 0.3178267
	speed: 0.0091s/iter; left time: 91.9120s
	iters: 700, epoch: 9 | loss: 0.3399575
	speed: 0.0091s/iter; left time: 91.0874s
	iters: 800, epoch: 9 | loss: 0.3633573
	speed: 0.0091s/iter; left time: 90.2499s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.47s
Steps: 894 | Train Loss: 0.3495473 Vali Loss: 0.3739317 Test Loss: 0.3846523
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.3240972
	speed: 0.0419s/iter; left time: 407.4995s
	iters: 200, epoch: 10 | loss: 0.3292312
	speed: 0.0093s/iter; left time: 89.7207s
	iters: 300, epoch: 10 | loss: 0.3544411
	speed: 0.0096s/iter; left time: 91.1897s
	iters: 400, epoch: 10 | loss: 0.3440052
	speed: 0.0093s/iter; left time: 88.1940s
	iters: 500, epoch: 10 | loss: 0.3600684
	speed: 0.0094s/iter; left time: 88.0726s
	iters: 600, epoch: 10 | loss: 0.3635264
	speed: 0.0093s/iter; left time: 86.0916s
	iters: 700, epoch: 10 | loss: 0.3340632
	speed: 0.0093s/iter; left time: 85.4048s
	iters: 800, epoch: 10 | loss: 0.3328926
	speed: 0.0093s/iter; left time: 84.4281s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.61s
Steps: 894 | Train Loss: 0.3453247 Vali Loss: 0.3736304 Test Loss: 0.3850542
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.4169333279132843, rmse:0.6457037329673767, mae:0.39248672127723694, rse:0.591385543346405
Original data scale mse:3020437.25, rmse:1737.9405517578125, mae:1113.3966064453125, rse:0.12242083251476288
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.7474340
	speed: 0.0111s/iter; left time: 196.7295s
	iters: 200, epoch: 1 | loss: 0.6355537
	speed: 0.0088s/iter; left time: 155.7306s
	iters: 300, epoch: 1 | loss: 0.6089092
	speed: 0.0091s/iter; left time: 160.5104s
	iters: 400, epoch: 1 | loss: 0.5633525
	speed: 0.0091s/iter; left time: 158.9535s
	iters: 500, epoch: 1 | loss: 0.5566725
	speed: 0.0091s/iter; left time: 157.5360s
	iters: 600, epoch: 1 | loss: 0.5191299
	speed: 0.0091s/iter; left time: 157.3906s
	iters: 700, epoch: 1 | loss: 0.5209419
	speed: 0.0091s/iter; left time: 156.6177s
	iters: 800, epoch: 1 | loss: 0.5392749
	speed: 0.0091s/iter; left time: 156.0901s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.35s
Steps: 894 | Train Loss: 0.6113821 Vali Loss: 0.4600261 Test Loss: 0.4716002
Validation loss decreased (inf --> 0.460026).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4323377
	speed: 0.0418s/iter; left time: 706.4526s
	iters: 200, epoch: 2 | loss: 0.4380670
	speed: 0.0092s/iter; left time: 153.9955s
	iters: 300, epoch: 2 | loss: 0.4069262
	speed: 0.0090s/iter; left time: 150.5866s
	iters: 400, epoch: 2 | loss: 0.4060146
	speed: 0.0090s/iter; left time: 148.9496s
	iters: 500, epoch: 2 | loss: 0.4226371
	speed: 0.0089s/iter; left time: 146.2006s
	iters: 600, epoch: 2 | loss: 0.4023727
	speed: 0.0090s/iter; left time: 147.3338s
	iters: 700, epoch: 2 | loss: 0.3903765
	speed: 0.0090s/iter; left time: 146.5561s
	iters: 800, epoch: 2 | loss: 0.4049474
	speed: 0.0090s/iter; left time: 145.9849s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.34s
Steps: 894 | Train Loss: 0.4269410 Vali Loss: 0.3832490 Test Loss: 0.4040817
Validation loss decreased (0.460026 --> 0.383249).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3945546
	speed: 0.0403s/iter; left time: 643.8826s
	iters: 200, epoch: 3 | loss: 0.3931334
	speed: 0.0089s/iter; left time: 141.0509s
	iters: 300, epoch: 3 | loss: 0.3742604
	speed: 0.0089s/iter; left time: 139.8816s
	iters: 400, epoch: 3 | loss: 0.4025612
	speed: 0.0089s/iter; left time: 139.3773s
	iters: 500, epoch: 3 | loss: 0.4098895
	speed: 0.0088s/iter; left time: 137.2342s
	iters: 600, epoch: 3 | loss: 0.3673977
	speed: 0.0088s/iter; left time: 136.2540s
	iters: 700, epoch: 3 | loss: 0.4007058
	speed: 0.0088s/iter; left time: 135.1555s
	iters: 800, epoch: 3 | loss: 0.3716867
	speed: 0.0088s/iter; left time: 134.4379s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.12s
Steps: 894 | Train Loss: 0.3917959 Vali Loss: 0.3763416 Test Loss: 0.3974220
Validation loss decreased (0.383249 --> 0.376342).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3654645
	speed: 0.0413s/iter; left time: 623.6644s
	iters: 200, epoch: 4 | loss: 0.3597856
	speed: 0.0090s/iter; left time: 135.3053s
	iters: 300, epoch: 4 | loss: 0.3836107
	speed: 0.0087s/iter; left time: 129.7063s
	iters: 400, epoch: 4 | loss: 0.3846945
	speed: 0.0087s/iter; left time: 128.4635s
	iters: 500, epoch: 4 | loss: 0.3858984
	speed: 0.0087s/iter; left time: 127.5240s
	iters: 600, epoch: 4 | loss: 0.3641272
	speed: 0.0087s/iter; left time: 126.9189s
	iters: 700, epoch: 4 | loss: 0.3990811
	speed: 0.0087s/iter; left time: 126.3768s
	iters: 800, epoch: 4 | loss: 0.3865961
	speed: 0.0087s/iter; left time: 125.4131s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.13s
Steps: 894 | Train Loss: 0.3803333 Vali Loss: 0.3734543 Test Loss: 0.3938187
Validation loss decreased (0.376342 --> 0.373454).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3691791
	speed: 0.0411s/iter; left time: 583.2391s
	iters: 200, epoch: 5 | loss: 0.3875010
	speed: 0.0088s/iter; left time: 124.5999s
	iters: 300, epoch: 5 | loss: 0.3336984
	speed: 0.0088s/iter; left time: 123.4803s
	iters: 400, epoch: 5 | loss: 0.3949812
	speed: 0.0088s/iter; left time: 122.3998s
	iters: 500, epoch: 5 | loss: 0.3704691
	speed: 0.0088s/iter; left time: 121.6669s
	iters: 600, epoch: 5 | loss: 0.3623731
	speed: 0.0088s/iter; left time: 119.9231s
	iters: 700, epoch: 5 | loss: 0.3911361
	speed: 0.0088s/iter; left time: 119.6980s
	iters: 800, epoch: 5 | loss: 0.3673284
	speed: 0.0088s/iter; left time: 118.3356s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.11s
Steps: 894 | Train Loss: 0.3717504 Vali Loss: 0.3738165 Test Loss: 0.3954064
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3381485
	speed: 0.0404s/iter; left time: 538.3190s
	iters: 200, epoch: 6 | loss: 0.3637605
	speed: 0.0090s/iter; left time: 118.5763s
	iters: 300, epoch: 6 | loss: 0.3601425
	speed: 0.0090s/iter; left time: 117.6966s
	iters: 400, epoch: 6 | loss: 0.3537968
	speed: 0.0090s/iter; left time: 116.7605s
	iters: 500, epoch: 6 | loss: 0.4000482
	speed: 0.0090s/iter; left time: 115.7238s
	iters: 600, epoch: 6 | loss: 0.3715847
	speed: 0.0089s/iter; left time: 114.6480s
	iters: 700, epoch: 6 | loss: 0.3366649
	speed: 0.0089s/iter; left time: 113.6677s
	iters: 800, epoch: 6 | loss: 0.3589806
	speed: 0.0089s/iter; left time: 112.6991s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.29s
Steps: 894 | Train Loss: 0.3654986 Vali Loss: 0.3756456 Test Loss: 0.3945992
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.4201226
	speed: 0.0409s/iter; left time: 508.2981s
	iters: 200, epoch: 7 | loss: 0.3307817
	speed: 0.0091s/iter; left time: 112.0212s
	iters: 300, epoch: 7 | loss: 0.3864700
	speed: 0.0089s/iter; left time: 109.1924s
	iters: 400, epoch: 7 | loss: 0.3921708
	speed: 0.0089s/iter; left time: 107.4315s
	iters: 500, epoch: 7 | loss: 0.3847368
	speed: 0.0088s/iter; left time: 105.9924s
	iters: 600, epoch: 7 | loss: 0.3877086
	speed: 0.0089s/iter; left time: 105.9505s
	iters: 700, epoch: 7 | loss: 0.3741014
	speed: 0.0088s/iter; left time: 104.2638s
	iters: 800, epoch: 7 | loss: 0.3376850
	speed: 0.0089s/iter; left time: 103.8629s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.25s
Steps: 894 | Train Loss: 0.3597783 Vali Loss: 0.3750241 Test Loss: 0.3946863
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.3523608
	speed: 0.0404s/iter; left time: 465.0523s
	iters: 200, epoch: 8 | loss: 0.3677526
	speed: 0.0088s/iter; left time: 100.3805s
	iters: 300, epoch: 8 | loss: 0.3192852
	speed: 0.0088s/iter; left time: 99.1887s
	iters: 400, epoch: 8 | loss: 0.3398608
	speed: 0.0088s/iter; left time: 98.5892s
	iters: 500, epoch: 8 | loss: 0.3431868
	speed: 0.0088s/iter; left time: 97.5712s
	iters: 600, epoch: 8 | loss: 0.3579680
	speed: 0.0088s/iter; left time: 96.5813s
	iters: 700, epoch: 8 | loss: 0.3458340
	speed: 0.0088s/iter; left time: 95.6858s
	iters: 800, epoch: 8 | loss: 0.3483633
	speed: 0.0087s/iter; left time: 94.4307s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.10s
Steps: 894 | Train Loss: 0.3545344 Vali Loss: 0.3728617 Test Loss: 0.3932250
Validation loss decreased (0.373454 --> 0.372862).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.3401249
	speed: 0.0413s/iter; left time: 438.6164s
	iters: 200, epoch: 9 | loss: 0.3503364
	speed: 0.0089s/iter; left time: 93.8019s
	iters: 300, epoch: 9 | loss: 0.3165112
	speed: 0.0088s/iter; left time: 92.2882s
	iters: 400, epoch: 9 | loss: 0.3751268
	speed: 0.0089s/iter; left time: 91.5680s
	iters: 500, epoch: 9 | loss: 0.3713911
	speed: 0.0089s/iter; left time: 90.5464s
	iters: 600, epoch: 9 | loss: 0.3560998
	speed: 0.0089s/iter; left time: 90.1796s
	iters: 700, epoch: 9 | loss: 0.3369823
	speed: 0.0091s/iter; left time: 90.8655s
	iters: 800, epoch: 9 | loss: 0.3533979
	speed: 0.0091s/iter; left time: 89.9478s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.30s
Steps: 894 | Train Loss: 0.3500346 Vali Loss: 0.3748201 Test Loss: 0.3940451
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.3712398
	speed: 0.0433s/iter; left time: 421.7131s
	iters: 200, epoch: 10 | loss: 0.3531148
	speed: 0.0099s/iter; left time: 95.8227s
	iters: 300, epoch: 10 | loss: 0.3384618
	speed: 0.0099s/iter; left time: 94.6126s
	iters: 400, epoch: 10 | loss: 0.3184957
	speed: 0.0099s/iter; left time: 93.3217s
	iters: 500, epoch: 10 | loss: 0.3634504
	speed: 0.0095s/iter; left time: 89.1023s
	iters: 600, epoch: 10 | loss: 0.3326967
	speed: 0.0112s/iter; left time: 103.7021s
	iters: 700, epoch: 10 | loss: 0.3714318
	speed: 0.0103s/iter; left time: 93.9599s
	iters: 800, epoch: 10 | loss: 0.3395610
	speed: 0.0099s/iter; left time: 89.7838s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.29s
Steps: 894 | Train Loss: 0.3460949 Vali Loss: 0.3734435 Test Loss: 0.3912965
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.3257872
	speed: 0.0439s/iter; left time: 388.0401s
	iters: 200, epoch: 11 | loss: 0.3516488
	speed: 0.0103s/iter; left time: 90.0905s
	iters: 300, epoch: 11 | loss: 0.3352672
	speed: 0.0103s/iter; left time: 88.7695s
	iters: 400, epoch: 11 | loss: 0.3366731
	speed: 0.0090s/iter; left time: 76.4817s
	iters: 500, epoch: 11 | loss: 0.3452054
	speed: 0.0089s/iter; left time: 75.4997s
	iters: 600, epoch: 11 | loss: 0.3537838
	speed: 0.0091s/iter; left time: 75.5761s
	iters: 700, epoch: 11 | loss: 0.3662442
	speed: 0.0090s/iter; left time: 73.7979s
	iters: 800, epoch: 11 | loss: 0.3342824
	speed: 0.0090s/iter; left time: 73.4281s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.70s
Steps: 894 | Train Loss: 0.3423273 Vali Loss: 0.3739399 Test Loss: 0.3899401
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.3649893
	speed: 0.0413s/iter; left time: 328.0171s
	iters: 200, epoch: 12 | loss: 0.2991540
	speed: 0.0089s/iter; left time: 69.4554s
	iters: 300, epoch: 12 | loss: 0.3787786
	speed: 0.0088s/iter; left time: 68.4230s
	iters: 400, epoch: 12 | loss: 0.3304369
	speed: 0.0089s/iter; left time: 67.8232s
	iters: 500, epoch: 12 | loss: 0.3176028
	speed: 0.0088s/iter; left time: 66.7831s
	iters: 600, epoch: 12 | loss: 0.3396703
	speed: 0.0088s/iter; left time: 65.8183s
	iters: 700, epoch: 12 | loss: 0.3184816
	speed: 0.0088s/iter; left time: 64.9335s
	iters: 800, epoch: 12 | loss: 0.3279783
	speed: 0.0088s/iter; left time: 64.0099s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.16s
Steps: 894 | Train Loss: 0.3392230 Vali Loss: 0.3755046 Test Loss: 0.3898554
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.3355803
	speed: 0.0414s/iter; left time: 292.2530s
	iters: 200, epoch: 13 | loss: 0.3466175
	speed: 0.0090s/iter; left time: 62.8363s
	iters: 300, epoch: 13 | loss: 0.3597040
	speed: 0.0090s/iter; left time: 61.8836s
	iters: 400, epoch: 13 | loss: 0.3271321
	speed: 0.0091s/iter; left time: 61.3197s
	iters: 500, epoch: 13 | loss: 0.3291291
	speed: 0.0091s/iter; left time: 60.3260s
	iters: 600, epoch: 13 | loss: 0.3479301
	speed: 0.0091s/iter; left time: 59.4723s
	iters: 700, epoch: 13 | loss: 0.3613821
	speed: 0.0091s/iter; left time: 58.5050s
	iters: 800, epoch: 13 | loss: 0.3415374
	speed: 0.0091s/iter; left time: 57.7582s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.34s
Steps: 894 | Train Loss: 0.3367388 Vali Loss: 0.3721802 Test Loss: 0.3891556
Validation loss decreased (0.372862 --> 0.372180).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.3204671
	speed: 0.0413s/iter; left time: 254.6385s
	iters: 200, epoch: 14 | loss: 0.3388022
	speed: 0.0088s/iter; left time: 53.1291s
	iters: 300, epoch: 14 | loss: 0.3285611
	speed: 0.0088s/iter; left time: 52.2771s
	iters: 400, epoch: 14 | loss: 0.3368885
	speed: 0.0088s/iter; left time: 51.4463s
	iters: 500, epoch: 14 | loss: 0.3361987
	speed: 0.0088s/iter; left time: 50.6093s
	iters: 600, epoch: 14 | loss: 0.3519664
	speed: 0.0088s/iter; left time: 49.7673s
	iters: 700, epoch: 14 | loss: 0.3412981
	speed: 0.0088s/iter; left time: 48.8462s
	iters: 800, epoch: 14 | loss: 0.3354294
	speed: 0.0088s/iter; left time: 47.9389s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.14s
Steps: 894 | Train Loss: 0.3339849 Vali Loss: 0.3727413 Test Loss: 0.3878030
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.3016567
	speed: 0.0424s/iter; left time: 223.3360s
	iters: 200, epoch: 15 | loss: 0.3179742
	speed: 0.0092s/iter; left time: 47.4260s
	iters: 300, epoch: 15 | loss: 0.3379367
	speed: 0.0092s/iter; left time: 46.3917s
	iters: 400, epoch: 15 | loss: 0.3075408
	speed: 0.0091s/iter; left time: 45.4058s
	iters: 500, epoch: 15 | loss: 0.3251965
	speed: 0.0091s/iter; left time: 44.0641s
	iters: 600, epoch: 15 | loss: 0.4018779
	speed: 0.0090s/iter; left time: 43.1026s
	iters: 700, epoch: 15 | loss: 0.3394886
	speed: 0.0090s/iter; left time: 42.2054s
	iters: 800, epoch: 15 | loss: 0.3534757
	speed: 0.0090s/iter; left time: 41.1990s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.45s
Steps: 894 | Train Loss: 0.3318703 Vali Loss: 0.3738452 Test Loss: 0.3881492
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.3330279
	speed: 0.0407s/iter; left time: 177.9419s
	iters: 200, epoch: 16 | loss: 0.3218009
	speed: 0.0088s/iter; left time: 37.4700s
	iters: 300, epoch: 16 | loss: 0.3502965
	speed: 0.0088s/iter; left time: 36.5924s
	iters: 400, epoch: 16 | loss: 0.3117763
	speed: 0.0088s/iter; left time: 35.7349s
	iters: 500, epoch: 16 | loss: 0.3195502
	speed: 0.0088s/iter; left time: 34.8323s
	iters: 600, epoch: 16 | loss: 0.3242238
	speed: 0.0090s/iter; left time: 34.7163s
	iters: 700, epoch: 16 | loss: 0.3178045
	speed: 0.0091s/iter; left time: 34.2456s
	iters: 800, epoch: 16 | loss: 0.3057912
	speed: 0.0091s/iter; left time: 33.3602s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.20s
Steps: 894 | Train Loss: 0.3299339 Vali Loss: 0.3751233 Test Loss: 0.3876106
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.3498950
	speed: 0.0416s/iter; left time: 144.7779s
	iters: 200, epoch: 17 | loss: 0.3549408
	speed: 0.0091s/iter; left time: 30.8034s
	iters: 300, epoch: 17 | loss: 0.3097367
	speed: 0.0090s/iter; left time: 29.4993s
	iters: 400, epoch: 17 | loss: 0.3442809
	speed: 0.0089s/iter; left time: 28.3921s
	iters: 500, epoch: 17 | loss: 0.3221650
	speed: 0.0089s/iter; left time: 27.4620s
	iters: 600, epoch: 17 | loss: 0.3345749
	speed: 0.0089s/iter; left time: 26.5351s
	iters: 700, epoch: 17 | loss: 0.3390704
	speed: 0.0089s/iter; left time: 25.6171s
	iters: 800, epoch: 17 | loss: 0.3097121
	speed: 0.0089s/iter; left time: 24.7556s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.36s
Steps: 894 | Train Loss: 0.3283761 Vali Loss: 0.3761904 Test Loss: 0.3870439
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.3574530
	speed: 0.0422s/iter; left time: 109.0792s
	iters: 200, epoch: 18 | loss: 0.3139735
	speed: 0.0100s/iter; left time: 24.8034s
	iters: 300, epoch: 18 | loss: 0.3384395
	speed: 0.0100s/iter; left time: 23.7870s
	iters: 400, epoch: 18 | loss: 0.3604164
	speed: 0.0100s/iter; left time: 22.8013s
	iters: 500, epoch: 18 | loss: 0.3547573
	speed: 0.0100s/iter; left time: 21.8214s
	iters: 600, epoch: 18 | loss: 0.3237102
	speed: 0.0100s/iter; left time: 20.7809s
	iters: 700, epoch: 18 | loss: 0.3122691
	speed: 0.0100s/iter; left time: 19.8292s
	iters: 800, epoch: 18 | loss: 0.3373485
	speed: 0.0100s/iter; left time: 18.7772s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.19s
Steps: 894 | Train Loss: 0.3273500 Vali Loss: 0.3737465 Test Loss: 0.3868445
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_loss_choice_for_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.4200829565525055, rmse:0.6481380462646484, mae:0.38915538787841797, rse:0.5936150550842285
Original data scale mse:2837935.75, rmse:1684.617431640625, mae:1074.3492431640625, rse:0.11866474151611328

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.4169333279132843, RMSE: 0.6457037329673767, MAE: 0.39248672127723694, RSE: 0.591385543346405
Unscaled Metrics - MSE: 3020437.25, RMSE: 1737.9405517578125, MAE: 1113.3966064453125, RSE: 0.12242083251476288

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.4200829565525055, RMSE: 0.6481380462646484, MAE: 0.38915538787841797, RSE: 0.5936150550842285
Unscaled Metrics - MSE: 2837935.75, RMSE: 1684.617431640625, MAE: 1074.3492431640625, RSE: 0.11866474151611328
