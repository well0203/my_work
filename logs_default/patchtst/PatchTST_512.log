
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_DE_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1321916
	speed: 0.0728s/iter; left time: 1615.8326s
	iters: 200, epoch: 1 | loss: 0.1232382
	speed: 0.0406s/iter; left time: 897.6260s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.36s
Steps: 223 | Train Loss: 0.1358311 Vali Loss: 0.1260650 Test Loss: 0.1311714
Validation loss decreased (inf --> 0.126065).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0869880
	speed: 0.0734s/iter; left time: 1612.4742s
	iters: 200, epoch: 2 | loss: 0.0813422
	speed: 0.0409s/iter; left time: 895.8097s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.26s
Steps: 223 | Train Loss: 0.0881644 Vali Loss: 0.0929616 Test Loss: 0.0951003
Validation loss decreased (0.126065 --> 0.092962).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0751677
	speed: 0.0736s/iter; left time: 1600.3763s
	iters: 200, epoch: 3 | loss: 0.0759952
	speed: 0.0407s/iter; left time: 881.5273s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.28s
Steps: 223 | Train Loss: 0.0788886 Vali Loss: 0.0895641 Test Loss: 0.0921896
Validation loss decreased (0.092962 --> 0.089564).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0797120
	speed: 0.0735s/iter; left time: 1581.5937s
	iters: 200, epoch: 4 | loss: 0.0827803
	speed: 0.0406s/iter; left time: 870.9836s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0767860 Vali Loss: 0.0885940 Test Loss: 0.0909947
Validation loss decreased (0.089564 --> 0.088594).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0754906
	speed: 0.0734s/iter; left time: 1563.9432s
	iters: 200, epoch: 5 | loss: 0.0719414
	speed: 0.0407s/iter; left time: 862.5956s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0754300 Vali Loss: 0.0888515 Test Loss: 0.0910340
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0806468
	speed: 0.0728s/iter; left time: 1534.8053s
	iters: 200, epoch: 6 | loss: 0.0765860
	speed: 0.0419s/iter; left time: 879.5093s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.39s
Steps: 223 | Train Loss: 0.0744171 Vali Loss: 0.0882697 Test Loss: 0.0900209
Validation loss decreased (0.088594 --> 0.088270).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0731639
	speed: 0.0734s/iter; left time: 1530.8374s
	iters: 200, epoch: 7 | loss: 0.0712213
	speed: 0.0409s/iter; left time: 848.1831s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.27s
Steps: 223 | Train Loss: 0.0736002 Vali Loss: 0.0882780 Test Loss: 0.0900862
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0723158
	speed: 0.0753s/iter; left time: 1553.8959s
	iters: 200, epoch: 8 | loss: 0.0739186
	speed: 0.0408s/iter; left time: 838.5795s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.29s
Steps: 223 | Train Loss: 0.0730063 Vali Loss: 0.0872233 Test Loss: 0.0892780
Validation loss decreased (0.088270 --> 0.087223).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0720197
	speed: 0.0736s/iter; left time: 1502.4429s
	iters: 200, epoch: 9 | loss: 0.0719693
	speed: 0.0413s/iter; left time: 839.3055s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.36s
Steps: 223 | Train Loss: 0.0725142 Vali Loss: 0.0873214 Test Loss: 0.0893505
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0731357
	speed: 0.0740s/iter; left time: 1493.4336s
	iters: 200, epoch: 10 | loss: 0.0688657
	speed: 0.0408s/iter; left time: 819.8231s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.33s
Steps: 223 | Train Loss: 0.0721618 Vali Loss: 0.0870030 Test Loss: 0.0891919
Validation loss decreased (0.087223 --> 0.087003).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0748033
	speed: 0.0759s/iter; left time: 1515.2200s
	iters: 200, epoch: 11 | loss: 0.0748860
	speed: 0.0417s/iter; left time: 829.5120s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.59s
Steps: 223 | Train Loss: 0.0719345 Vali Loss: 0.0867141 Test Loss: 0.0886792
Validation loss decreased (0.087003 --> 0.086714).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0690829
	speed: 0.0745s/iter; left time: 1470.9406s
	iters: 200, epoch: 12 | loss: 0.0754002
	speed: 0.0429s/iter; left time: 842.0450s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.49s
Steps: 223 | Train Loss: 0.0716603 Vali Loss: 0.0863255 Test Loss: 0.0886338
Validation loss decreased (0.086714 --> 0.086325).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0659539
	speed: 0.0744s/iter; left time: 1452.1265s
	iters: 200, epoch: 13 | loss: 0.0692490
	speed: 0.0412s/iter; left time: 799.4277s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.50s
Steps: 223 | Train Loss: 0.0713583 Vali Loss: 0.0861463 Test Loss: 0.0882640
Validation loss decreased (0.086325 --> 0.086146).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0732110
	speed: 0.0779s/iter; left time: 1503.5926s
	iters: 200, epoch: 14 | loss: 0.0664269
	speed: 0.0411s/iter; left time: 788.6970s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.31s
Steps: 223 | Train Loss: 0.0712298 Vali Loss: 0.0862440 Test Loss: 0.0883915
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0712718
	speed: 0.0763s/iter; left time: 1455.3356s
	iters: 200, epoch: 15 | loss: 0.0668620
	speed: 0.0410s/iter; left time: 777.1939s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.59s
Steps: 223 | Train Loss: 0.0710672 Vali Loss: 0.0864471 Test Loss: 0.0887082
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0729668
	speed: 0.0740s/iter; left time: 1395.5402s
	iters: 200, epoch: 16 | loss: 0.0765959
	speed: 0.0422s/iter; left time: 792.2797s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.51s
Steps: 223 | Train Loss: 0.0708319 Vali Loss: 0.0861513 Test Loss: 0.0883979
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0704609
	speed: 0.0735s/iter; left time: 1369.5178s
	iters: 200, epoch: 17 | loss: 0.0766587
	speed: 0.0433s/iter; left time: 802.6713s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.65s
Steps: 223 | Train Loss: 0.0707372 Vali Loss: 0.0861647 Test Loss: 0.0883205
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0681143
	speed: 0.0750s/iter; left time: 1381.5339s
	iters: 200, epoch: 18 | loss: 0.0640077
	speed: 0.0409s/iter; left time: 749.4994s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.33s
Steps: 223 | Train Loss: 0.0706291 Vali Loss: 0.0860309 Test Loss: 0.0882354
Validation loss decreased (0.086146 --> 0.086031).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0720396
	speed: 0.0783s/iter; left time: 1423.7136s
	iters: 200, epoch: 19 | loss: 0.0769060
	speed: 0.0409s/iter; left time: 740.5781s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.40s
Steps: 223 | Train Loss: 0.0705093 Vali Loss: 0.0859334 Test Loss: 0.0882176
Validation loss decreased (0.086031 --> 0.085933).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0715498
	speed: 0.0772s/iter; left time: 1386.4974s
	iters: 200, epoch: 20 | loss: 0.0696223
	speed: 0.0410s/iter; left time: 732.4981s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.54s
Steps: 223 | Train Loss: 0.0704253 Vali Loss: 0.0860697 Test Loss: 0.0881779
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0699663
	speed: 0.0728s/iter; left time: 1291.4193s
	iters: 200, epoch: 21 | loss: 0.0732786
	speed: 0.0431s/iter; left time: 759.9429s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.47s
Steps: 223 | Train Loss: 0.0703514 Vali Loss: 0.0858988 Test Loss: 0.0881333
Validation loss decreased (0.085933 --> 0.085899).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0708477
	speed: 0.0742s/iter; left time: 1300.1863s
	iters: 200, epoch: 22 | loss: 0.0705403
	speed: 0.0415s/iter; left time: 722.6993s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.44s
Steps: 223 | Train Loss: 0.0702229 Vali Loss: 0.0858154 Test Loss: 0.0882537
Validation loss decreased (0.085899 --> 0.085815).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0727449
	speed: 0.0758s/iter; left time: 1310.7424s
	iters: 200, epoch: 23 | loss: 0.0709735
	speed: 0.0411s/iter; left time: 705.9142s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.33s
Steps: 223 | Train Loss: 0.0702576 Vali Loss: 0.0857304 Test Loss: 0.0880756
Validation loss decreased (0.085815 --> 0.085730).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0739099
	speed: 0.0758s/iter; left time: 1294.2116s
	iters: 200, epoch: 24 | loss: 0.0680970
	speed: 0.0412s/iter; left time: 699.9142s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.46s
Steps: 223 | Train Loss: 0.0701341 Vali Loss: 0.0857846 Test Loss: 0.0882640
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0694140
	speed: 0.0753s/iter; left time: 1268.9373s
	iters: 200, epoch: 25 | loss: 0.0655354
	speed: 0.0419s/iter; left time: 702.3440s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.56s
Steps: 223 | Train Loss: 0.0700403 Vali Loss: 0.0856874 Test Loss: 0.0880371
Validation loss decreased (0.085730 --> 0.085687).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0680513
	speed: 0.0729s/iter; left time: 1211.8735s
	iters: 200, epoch: 26 | loss: 0.0614008
	speed: 0.0422s/iter; left time: 697.8320s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.39s
Steps: 223 | Train Loss: 0.0699876 Vali Loss: 0.0857602 Test Loss: 0.0880605
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0681010
	speed: 0.0737s/iter; left time: 1209.0005s
	iters: 200, epoch: 27 | loss: 0.0719286
	speed: 0.0409s/iter; left time: 666.5536s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.38s
Steps: 223 | Train Loss: 0.0699794 Vali Loss: 0.0856203 Test Loss: 0.0880215
Validation loss decreased (0.085687 --> 0.085620).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0715455
	speed: 0.0777s/iter; left time: 1257.7111s
	iters: 200, epoch: 28 | loss: 0.0702468
	speed: 0.0411s/iter; left time: 661.5107s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.37s
Steps: 223 | Train Loss: 0.0698950 Vali Loss: 0.0855330 Test Loss: 0.0880139
Validation loss decreased (0.085620 --> 0.085533).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0714828
	speed: 0.0763s/iter; left time: 1217.9411s
	iters: 200, epoch: 29 | loss: 0.0706265
	speed: 0.0408s/iter; left time: 647.6904s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.46s
Steps: 223 | Train Loss: 0.0698917 Vali Loss: 0.0855195 Test Loss: 0.0880248
Validation loss decreased (0.085533 --> 0.085519).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0714619
	speed: 0.0742s/iter; left time: 1168.2092s
	iters: 200, epoch: 30 | loss: 0.0664505
	speed: 0.0418s/iter; left time: 654.1981s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.48s
Steps: 223 | Train Loss: 0.0698095 Vali Loss: 0.0856531 Test Loss: 0.0880330
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0732058
	speed: 0.0729s/iter; left time: 1130.9088s
	iters: 200, epoch: 31 | loss: 0.0680768
	speed: 0.0425s/iter; left time: 655.6742s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.49s
Steps: 223 | Train Loss: 0.0698472 Vali Loss: 0.0855296 Test Loss: 0.0879514
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0710819
	speed: 0.0745s/iter; left time: 1138.8016s
	iters: 200, epoch: 32 | loss: 0.0653720
	speed: 0.0412s/iter; left time: 625.7304s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.32s
Steps: 223 | Train Loss: 0.0697666 Vali Loss: 0.0855339 Test Loss: 0.0879451
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0689314
	speed: 0.0769s/iter; left time: 1158.4537s
	iters: 200, epoch: 33 | loss: 0.0689489
	speed: 0.0411s/iter; left time: 614.6421s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.43s
Steps: 223 | Train Loss: 0.0697218 Vali Loss: 0.0855810 Test Loss: 0.0879584
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0722149
	speed: 0.0771s/iter; left time: 1144.5327s
	iters: 200, epoch: 34 | loss: 0.0753755
	speed: 0.0413s/iter; left time: 609.0315s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.74s
Steps: 223 | Train Loss: 0.0697024 Vali Loss: 0.0854558 Test Loss: 0.0879442
Validation loss decreased (0.085519 --> 0.085456).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0695830
	speed: 0.0736s/iter; left time: 1075.5888s
	iters: 200, epoch: 35 | loss: 0.0714961
	speed: 0.0434s/iter; left time: 630.2549s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.52s
Steps: 223 | Train Loss: 0.0696798 Vali Loss: 0.0855717 Test Loss: 0.0879177
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0646781
	speed: 0.0730s/iter; left time: 1051.0720s
	iters: 200, epoch: 36 | loss: 0.0619496
	speed: 0.0418s/iter; left time: 597.5121s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.41s
Steps: 223 | Train Loss: 0.0697064 Vali Loss: 0.0855166 Test Loss: 0.0879396
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0669930
	speed: 0.0744s/iter; left time: 1054.2108s
	iters: 200, epoch: 37 | loss: 0.0625971
	speed: 0.0409s/iter; left time: 575.8288s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.27s
Steps: 223 | Train Loss: 0.0696672 Vali Loss: 0.0855014 Test Loss: 0.0879528
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0678924
	speed: 0.0749s/iter; left time: 1045.0660s
	iters: 200, epoch: 38 | loss: 0.0688178
	speed: 0.0409s/iter; left time: 566.8978s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.40s
Steps: 223 | Train Loss: 0.0696622 Vali Loss: 0.0855257 Test Loss: 0.0879750
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0701673
	speed: 0.0754s/iter; left time: 1034.4748s
	iters: 200, epoch: 39 | loss: 0.0690970
	speed: 0.0415s/iter; left time: 565.0612s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.58s
Steps: 223 | Train Loss: 0.0696282 Vali Loss: 0.0855480 Test Loss: 0.0879980
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0651396
	speed: 0.0732s/iter; left time: 988.9090s
	iters: 200, epoch: 40 | loss: 0.0684225
	speed: 0.0432s/iter; left time: 579.2278s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.53s
Steps: 223 | Train Loss: 0.0696272 Vali Loss: 0.0855301 Test Loss: 0.0879082
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0700838
	speed: 0.0731s/iter; left time: 971.4658s
	iters: 200, epoch: 41 | loss: 0.0650603
	speed: 0.0412s/iter; left time: 543.6538s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:09.40s
Steps: 223 | Train Loss: 0.0696333 Vali Loss: 0.0853576 Test Loss: 0.0879209
Validation loss decreased (0.085456 --> 0.085358).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0721609
	speed: 0.0791s/iter; left time: 1033.0047s
	iters: 200, epoch: 42 | loss: 0.0683571
	speed: 0.0411s/iter; left time: 532.2509s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:09.46s
Steps: 223 | Train Loss: 0.0696497 Vali Loss: 0.0856114 Test Loss: 0.0879269
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0659273
	speed: 0.0750s/iter; left time: 962.9138s
	iters: 200, epoch: 43 | loss: 0.0703276
	speed: 0.0411s/iter; left time: 523.3529s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:09.49s
Steps: 223 | Train Loss: 0.0696177 Vali Loss: 0.0855228 Test Loss: 0.0879306
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0707573
	speed: 0.0740s/iter; left time: 933.1694s
	iters: 200, epoch: 44 | loss: 0.0708191
	speed: 0.0429s/iter; left time: 536.9797s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:09.56s
Steps: 223 | Train Loss: 0.0695830 Vali Loss: 0.0854188 Test Loss: 0.0879598
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0725420
	speed: 0.0733s/iter; left time: 908.7304s
	iters: 200, epoch: 45 | loss: 0.0703637
	speed: 0.0423s/iter; left time: 519.3931s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:09.48s
Steps: 223 | Train Loss: 0.0696023 Vali Loss: 0.0854171 Test Loss: 0.0879375
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0657321
	speed: 0.0741s/iter; left time: 901.0396s
	iters: 200, epoch: 46 | loss: 0.0639107
	speed: 0.0410s/iter; left time: 495.0262s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:09.32s
Steps: 223 | Train Loss: 0.0695614 Vali Loss: 0.0854853 Test Loss: 0.0879773
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0717126
	speed: 0.0775s/iter; left time: 926.1534s
	iters: 200, epoch: 47 | loss: 0.0683041
	speed: 0.0410s/iter; left time: 485.7300s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:09.41s
Steps: 223 | Train Loss: 0.0695458 Vali Loss: 0.0855225 Test Loss: 0.0879506
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0647682
	speed: 0.0748s/iter; left time: 876.1091s
	iters: 200, epoch: 48 | loss: 0.0752877
	speed: 0.0412s/iter; left time: 479.0682s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:09.46s
Steps: 223 | Train Loss: 0.0695764 Vali Loss: 0.0855578 Test Loss: 0.0879192
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0669895
	speed: 0.0739s/iter; left time: 849.1132s
	iters: 200, epoch: 49 | loss: 0.0671645
	speed: 0.0441s/iter; left time: 502.1932s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:09.63s
Steps: 223 | Train Loss: 0.0695500 Vali Loss: 0.0854582 Test Loss: 0.0879122
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0681623
	speed: 0.0729s/iter; left time: 822.0261s
	iters: 200, epoch: 50 | loss: 0.0670224
	speed: 0.0411s/iter; left time: 459.1101s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:09.38s
Steps: 223 | Train Loss: 0.0695453 Vali Loss: 0.0854244 Test Loss: 0.0879608
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0734773
	speed: 0.0750s/iter; left time: 828.5580s
	iters: 200, epoch: 51 | loss: 0.0709416
	speed: 0.0409s/iter; left time: 447.7038s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:09.26s
Steps: 223 | Train Loss: 0.0694864 Vali Loss: 0.0854223 Test Loss: 0.0879430
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_DE_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02090967260301113, rmse:0.14460177719593048, mae:0.08792086690664291, rse:0.5103196501731873
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_DE_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1313960
	speed: 0.0426s/iter; left time: 946.2350s
	iters: 200, epoch: 1 | loss: 0.1188500
	speed: 0.0409s/iter; left time: 903.4980s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.34s
Steps: 223 | Train Loss: 0.1354943 Vali Loss: 0.1248697 Test Loss: 0.1301842
Validation loss decreased (inf --> 0.124870).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0870410
	speed: 0.0759s/iter; left time: 1669.0927s
	iters: 200, epoch: 2 | loss: 0.0790940
	speed: 0.0408s/iter; left time: 893.6806s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.49s
Steps: 223 | Train Loss: 0.0881939 Vali Loss: 0.0920127 Test Loss: 0.0943350
Validation loss decreased (0.124870 --> 0.092013).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0822242
	speed: 0.0751s/iter; left time: 1634.8448s
	iters: 200, epoch: 3 | loss: 0.0795212
	speed: 0.0421s/iter; left time: 912.6364s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.50s
Steps: 223 | Train Loss: 0.0792196 Vali Loss: 0.0897547 Test Loss: 0.0930960
Validation loss decreased (0.092013 --> 0.089755).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0744526
	speed: 0.0744s/iter; left time: 1602.0627s
	iters: 200, epoch: 4 | loss: 0.0765585
	speed: 0.0431s/iter; left time: 922.9071s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.54s
Steps: 223 | Train Loss: 0.0770492 Vali Loss: 0.0888159 Test Loss: 0.0912558
Validation loss decreased (0.089755 --> 0.088816).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0781723
	speed: 0.0752s/iter; left time: 1602.5429s
	iters: 200, epoch: 5 | loss: 0.0787505
	speed: 0.0411s/iter; left time: 872.3336s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.43s
Steps: 223 | Train Loss: 0.0755762 Vali Loss: 0.0882391 Test Loss: 0.0905145
Validation loss decreased (0.088816 --> 0.088239).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0734662
	speed: 0.0779s/iter; left time: 1642.4975s
	iters: 200, epoch: 6 | loss: 0.0701560
	speed: 0.0412s/iter; left time: 865.0143s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.36s
Steps: 223 | Train Loss: 0.0744702 Vali Loss: 0.0880928 Test Loss: 0.0901387
Validation loss decreased (0.088239 --> 0.088093).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0758411
	speed: 0.0762s/iter; left time: 1589.9836s
	iters: 200, epoch: 7 | loss: 0.0725631
	speed: 0.0411s/iter; left time: 853.3084s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.54s
Steps: 223 | Train Loss: 0.0737651 Vali Loss: 0.0871508 Test Loss: 0.0891528
Validation loss decreased (0.088093 --> 0.087151).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0738654
	speed: 0.0756s/iter; left time: 1561.2701s
	iters: 200, epoch: 8 | loss: 0.0790533
	speed: 0.0418s/iter; left time: 859.2039s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.53s
Steps: 223 | Train Loss: 0.0730526 Vali Loss: 0.0870921 Test Loss: 0.0889390
Validation loss decreased (0.087151 --> 0.087092).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0699977
	speed: 0.0750s/iter; left time: 1531.8871s
	iters: 200, epoch: 9 | loss: 0.0693552
	speed: 0.0424s/iter; left time: 862.0096s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.59s
Steps: 223 | Train Loss: 0.0725657 Vali Loss: 0.0867596 Test Loss: 0.0892174
Validation loss decreased (0.087092 --> 0.086760).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0688242
	speed: 0.0754s/iter; left time: 1522.1999s
	iters: 200, epoch: 10 | loss: 0.0768644
	speed: 0.0416s/iter; left time: 836.5693s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.46s
Steps: 223 | Train Loss: 0.0722564 Vali Loss: 0.0868287 Test Loss: 0.0888822
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0725663
	speed: 0.0791s/iter; left time: 1580.5377s
	iters: 200, epoch: 11 | loss: 0.0708728
	speed: 0.0410s/iter; left time: 814.2832s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.44s
Steps: 223 | Train Loss: 0.0719054 Vali Loss: 0.0862284 Test Loss: 0.0885692
Validation loss decreased (0.086760 --> 0.086228).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0754657
	speed: 0.0760s/iter; left time: 1500.0768s
	iters: 200, epoch: 12 | loss: 0.0690805
	speed: 0.0418s/iter; left time: 821.9923s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.59s
Steps: 223 | Train Loss: 0.0715601 Vali Loss: 0.0863634 Test Loss: 0.0886728
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0692426
	speed: 0.0739s/iter; left time: 1443.7657s
	iters: 200, epoch: 13 | loss: 0.0709148
	speed: 0.0431s/iter; left time: 836.6403s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.54s
Steps: 223 | Train Loss: 0.0713889 Vali Loss: 0.0865801 Test Loss: 0.0886077
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0719159
	speed: 0.0740s/iter; left time: 1427.5372s
	iters: 200, epoch: 14 | loss: 0.0689385
	speed: 0.0410s/iter; left time: 786.5298s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.35s
Steps: 223 | Train Loss: 0.0711120 Vali Loss: 0.0861776 Test Loss: 0.0885576
Validation loss decreased (0.086228 --> 0.086178).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0719024
	speed: 0.0813s/iter; left time: 1550.3733s
	iters: 200, epoch: 15 | loss: 0.0737916
	speed: 0.0410s/iter; left time: 777.3012s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.54s
Steps: 223 | Train Loss: 0.0709302 Vali Loss: 0.0860182 Test Loss: 0.0885886
Validation loss decreased (0.086178 --> 0.086018).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0717600
	speed: 0.0776s/iter; left time: 1464.1638s
	iters: 200, epoch: 16 | loss: 0.0704221
	speed: 0.0413s/iter; left time: 775.2639s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.65s
Steps: 223 | Train Loss: 0.0707807 Vali Loss: 0.0859530 Test Loss: 0.0883362
Validation loss decreased (0.086018 --> 0.085953).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0685674
	speed: 0.0748s/iter; left time: 1392.9540s
	iters: 200, epoch: 17 | loss: 0.0712534
	speed: 0.0428s/iter; left time: 793.5753s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.57s
Steps: 223 | Train Loss: 0.0706162 Vali Loss: 0.0860626 Test Loss: 0.0882613
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0664355
	speed: 0.0736s/iter; left time: 1355.5983s
	iters: 200, epoch: 18 | loss: 0.0718288
	speed: 0.0425s/iter; left time: 778.9355s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.55s
Steps: 223 | Train Loss: 0.0704577 Vali Loss: 0.0858960 Test Loss: 0.0883355
Validation loss decreased (0.085953 --> 0.085896).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0726624
	speed: 0.0749s/iter; left time: 1363.0548s
	iters: 200, epoch: 19 | loss: 0.0683349
	speed: 0.0410s/iter; left time: 741.9117s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.32s
Steps: 223 | Train Loss: 0.0703722 Vali Loss: 0.0862532 Test Loss: 0.0885259
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0739421
	speed: 0.0768s/iter; left time: 1378.8048s
	iters: 200, epoch: 20 | loss: 0.0741002
	speed: 0.0422s/iter; left time: 753.3976s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.50s
Steps: 223 | Train Loss: 0.0702616 Vali Loss: 0.0857343 Test Loss: 0.0880173
Validation loss decreased (0.085896 --> 0.085734).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0670575
	speed: 0.0768s/iter; left time: 1363.3505s
	iters: 200, epoch: 21 | loss: 0.0731600
	speed: 0.0413s/iter; left time: 728.3836s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0701356 Vali Loss: 0.0856524 Test Loss: 0.0883831
Validation loss decreased (0.085734 --> 0.085652).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0671976
	speed: 0.0771s/iter; left time: 1350.7183s
	iters: 200, epoch: 22 | loss: 0.0740734
	speed: 0.0431s/iter; left time: 751.5513s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.55s
Steps: 223 | Train Loss: 0.0701010 Vali Loss: 0.0857823 Test Loss: 0.0880972
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0758784
	speed: 0.0743s/iter; left time: 1285.6170s
	iters: 200, epoch: 23 | loss: 0.0709538
	speed: 0.0424s/iter; left time: 729.8309s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.58s
Steps: 223 | Train Loss: 0.0700068 Vali Loss: 0.0856148 Test Loss: 0.0881205
Validation loss decreased (0.085652 --> 0.085615).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0685787
	speed: 0.0758s/iter; left time: 1294.4500s
	iters: 200, epoch: 24 | loss: 0.0710734
	speed: 0.0412s/iter; left time: 699.8730s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.38s
Steps: 223 | Train Loss: 0.0699610 Vali Loss: 0.0856896 Test Loss: 0.0881782
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0676588
	speed: 0.0764s/iter; left time: 1288.0852s
	iters: 200, epoch: 25 | loss: 0.0711828
	speed: 0.0412s/iter; left time: 689.4982s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.42s
Steps: 223 | Train Loss: 0.0698800 Vali Loss: 0.0855946 Test Loss: 0.0882437
Validation loss decreased (0.085615 --> 0.085595).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0661857
	speed: 0.0764s/iter; left time: 1269.5660s
	iters: 200, epoch: 26 | loss: 0.0734557
	speed: 0.0415s/iter; left time: 685.0822s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.60s
Steps: 223 | Train Loss: 0.0698155 Vali Loss: 0.0855840 Test Loss: 0.0880812
Validation loss decreased (0.085595 --> 0.085584).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0697222
	speed: 0.0741s/iter; left time: 1215.0588s
	iters: 200, epoch: 27 | loss: 0.0661289
	speed: 0.0433s/iter; left time: 706.3962s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.57s
Steps: 223 | Train Loss: 0.0697875 Vali Loss: 0.0856633 Test Loss: 0.0882748
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0737358
	speed: 0.0768s/iter; left time: 1242.1764s
	iters: 200, epoch: 28 | loss: 0.0681898
	speed: 0.0414s/iter; left time: 665.1829s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.41s
Steps: 223 | Train Loss: 0.0696683 Vali Loss: 0.0855569 Test Loss: 0.0882192
Validation loss decreased (0.085584 --> 0.085557).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0692833
	speed: 0.0779s/iter; left time: 1243.7463s
	iters: 200, epoch: 29 | loss: 0.0726246
	speed: 0.0413s/iter; left time: 655.4001s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.41s
Steps: 223 | Train Loss: 0.0696357 Vali Loss: 0.0855218 Test Loss: 0.0881251
Validation loss decreased (0.085557 --> 0.085522).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0657860
	speed: 0.0770s/iter; left time: 1211.4838s
	iters: 200, epoch: 30 | loss: 0.0708374
	speed: 0.0408s/iter; left time: 638.5677s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.48s
Steps: 223 | Train Loss: 0.0696056 Vali Loss: 0.0855264 Test Loss: 0.0880535
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0701524
	speed: 0.0745s/iter; left time: 1155.6664s
	iters: 200, epoch: 31 | loss: 0.0725639
	speed: 0.0423s/iter; left time: 651.5392s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.53s
Steps: 223 | Train Loss: 0.0695799 Vali Loss: 0.0855524 Test Loss: 0.0881440
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0713260
	speed: 0.0742s/iter; left time: 1133.8718s
	iters: 200, epoch: 32 | loss: 0.0717980
	speed: 0.0442s/iter; left time: 671.0837s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0695398 Vali Loss: 0.0854926 Test Loss: 0.0880160
Validation loss decreased (0.085522 --> 0.085493).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0683134
	speed: 0.0759s/iter; left time: 1143.2825s
	iters: 200, epoch: 33 | loss: 0.0729751
	speed: 0.0419s/iter; left time: 626.3768s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.50s
Steps: 223 | Train Loss: 0.0695101 Vali Loss: 0.0854646 Test Loss: 0.0880804
Validation loss decreased (0.085493 --> 0.085465).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0691466
	speed: 0.0784s/iter; left time: 1164.2330s
	iters: 200, epoch: 34 | loss: 0.0703526
	speed: 0.0408s/iter; left time: 601.4045s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.29s
Steps: 223 | Train Loss: 0.0695376 Vali Loss: 0.0855198 Test Loss: 0.0880577
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0776221
	speed: 0.0764s/iter; left time: 1116.7155s
	iters: 200, epoch: 35 | loss: 0.0695363
	speed: 0.0417s/iter; left time: 605.0302s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.65s
Steps: 223 | Train Loss: 0.0694531 Vali Loss: 0.0854499 Test Loss: 0.0880845
Validation loss decreased (0.085465 --> 0.085450).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0697098
	speed: 0.0761s/iter; left time: 1094.8774s
	iters: 200, epoch: 36 | loss: 0.0732048
	speed: 0.0423s/iter; left time: 604.9613s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.56s
Steps: 223 | Train Loss: 0.0694773 Vali Loss: 0.0854531 Test Loss: 0.0880837
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0732422
	speed: 0.0739s/iter; left time: 1047.1660s
	iters: 200, epoch: 37 | loss: 0.0698277
	speed: 0.0425s/iter; left time: 597.4445s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.54s
Steps: 223 | Train Loss: 0.0695019 Vali Loss: 0.0854309 Test Loss: 0.0880640
Validation loss decreased (0.085450 --> 0.085431).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0662249
	speed: 0.0747s/iter; left time: 1042.3577s
	iters: 200, epoch: 38 | loss: 0.0669574
	speed: 0.0411s/iter; left time: 569.3437s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.32s
Steps: 223 | Train Loss: 0.0694807 Vali Loss: 0.0854503 Test Loss: 0.0881496
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0675080
	speed: 0.0781s/iter; left time: 1072.2160s
	iters: 200, epoch: 39 | loss: 0.0717927
	speed: 0.0413s/iter; left time: 562.4743s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.42s
Steps: 223 | Train Loss: 0.0694395 Vali Loss: 0.0855308 Test Loss: 0.0881241
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0681171
	speed: 0.0763s/iter; left time: 1030.3686s
	iters: 200, epoch: 40 | loss: 0.0687452
	speed: 0.0418s/iter; left time: 559.8876s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.59s
Steps: 223 | Train Loss: 0.0694168 Vali Loss: 0.0854836 Test Loss: 0.0881014
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0687454
	speed: 0.0746s/iter; left time: 991.3941s
	iters: 200, epoch: 41 | loss: 0.0672896
	speed: 0.0430s/iter; left time: 566.3157s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:09.60s
Steps: 223 | Train Loss: 0.0693724 Vali Loss: 0.0854263 Test Loss: 0.0880959
Validation loss decreased (0.085431 --> 0.085426).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0690397
	speed: 0.0747s/iter; left time: 975.1047s
	iters: 200, epoch: 42 | loss: 0.0734327
	speed: 0.0412s/iter; left time: 533.9633s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:09.38s
Steps: 223 | Train Loss: 0.0693399 Vali Loss: 0.0855006 Test Loss: 0.0881062
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0726071
	speed: 0.0752s/iter; left time: 965.0980s
	iters: 200, epoch: 43 | loss: 0.0722188
	speed: 0.0411s/iter; left time: 523.2523s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:09.35s
Steps: 223 | Train Loss: 0.0693658 Vali Loss: 0.0854671 Test Loss: 0.0881068
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0688466
	speed: 0.0761s/iter; left time: 960.0431s
	iters: 200, epoch: 44 | loss: 0.0752073
	speed: 0.0427s/iter; left time: 534.0069s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:09.55s
Steps: 223 | Train Loss: 0.0694005 Vali Loss: 0.0854169 Test Loss: 0.0880969
Validation loss decreased (0.085426 --> 0.085417).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0694189
	speed: 0.0771s/iter; left time: 955.1548s
	iters: 200, epoch: 45 | loss: 0.0663738
	speed: 0.0411s/iter; left time: 505.4507s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:09.53s
Steps: 223 | Train Loss: 0.0693401 Vali Loss: 0.0854222 Test Loss: 0.0881163
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0687163
	speed: 0.0740s/iter; left time: 900.7709s
	iters: 200, epoch: 46 | loss: 0.0681874
	speed: 0.0429s/iter; left time: 517.0619s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:09.50s
Steps: 223 | Train Loss: 0.0693499 Vali Loss: 0.0854475 Test Loss: 0.0880975
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0698357
	speed: 0.0733s/iter; left time: 875.7307s
	iters: 200, epoch: 47 | loss: 0.0708191
	speed: 0.0421s/iter; left time: 498.5767s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:09.50s
Steps: 223 | Train Loss: 0.0693365 Vali Loss: 0.0854302 Test Loss: 0.0880839
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0703154
	speed: 0.0770s/iter; left time: 902.2628s
	iters: 200, epoch: 48 | loss: 0.0697617
	speed: 0.0409s/iter; left time: 475.2551s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:09.32s
Steps: 223 | Train Loss: 0.0693081 Vali Loss: 0.0854606 Test Loss: 0.0881088
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0689715
	speed: 0.0781s/iter; left time: 898.0791s
	iters: 200, epoch: 49 | loss: 0.0643823
	speed: 0.0409s/iter; left time: 465.6737s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:09.45s
Steps: 223 | Train Loss: 0.0693539 Vali Loss: 0.0854463 Test Loss: 0.0881050
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0739108
	speed: 0.0755s/iter; left time: 851.3720s
	iters: 200, epoch: 50 | loss: 0.0687575
	speed: 0.0411s/iter; left time: 459.4108s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:09.53s
Steps: 223 | Train Loss: 0.0693257 Vali Loss: 0.0853803 Test Loss: 0.0880668
Validation loss decreased (0.085417 --> 0.085380).  Saving model ...
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0741657
	speed: 0.0741s/iter; left time: 819.4238s
	iters: 200, epoch: 51 | loss: 0.0745502
	speed: 0.0424s/iter; left time: 464.4901s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:09.46s
Steps: 223 | Train Loss: 0.0693099 Vali Loss: 0.0854465 Test Loss: 0.0880877
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0701798
	speed: 0.0752s/iter; left time: 814.4153s
	iters: 200, epoch: 52 | loss: 0.0675897
	speed: 0.0407s/iter; left time: 437.0012s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:09.43s
Steps: 223 | Train Loss: 0.0692942 Vali Loss: 0.0854767 Test Loss: 0.0881183
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0710436
	speed: 0.0766s/iter; left time: 812.8227s
	iters: 200, epoch: 53 | loss: 0.0713551
	speed: 0.0412s/iter; left time: 432.5785s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:09.33s
Steps: 223 | Train Loss: 0.0693223 Vali Loss: 0.0854564 Test Loss: 0.0880729
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0713452
	speed: 0.0751s/iter; left time: 779.1887s
	iters: 200, epoch: 54 | loss: 0.0682029
	speed: 0.0412s/iter; left time: 423.7271s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:09.44s
Steps: 223 | Train Loss: 0.0693280 Vali Loss: 0.0854152 Test Loss: 0.0881014
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0675052
	speed: 0.0767s/iter; left time: 779.4137s
	iters: 200, epoch: 55 | loss: 0.0720875
	speed: 0.0431s/iter; left time: 433.2442s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:09.73s
Steps: 223 | Train Loss: 0.0692830 Vali Loss: 0.0854154 Test Loss: 0.0880911
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0677626
	speed: 0.0738s/iter; left time: 732.9327s
	iters: 200, epoch: 56 | loss: 0.0691914
	speed: 0.0426s/iter; left time: 418.7587s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:09.55s
Steps: 223 | Train Loss: 0.0693142 Vali Loss: 0.0854138 Test Loss: 0.0881014
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0713836
	speed: 0.0741s/iter; left time: 719.9243s
	iters: 200, epoch: 57 | loss: 0.0689744
	speed: 0.0409s/iter; left time: 392.6979s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:09.32s
Steps: 223 | Train Loss: 0.0692971 Vali Loss: 0.0853321 Test Loss: 0.0880808
Validation loss decreased (0.085380 --> 0.085332).  Saving model ...
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0728526
	speed: 0.0785s/iter; left time: 744.8295s
	iters: 200, epoch: 58 | loss: 0.0730912
	speed: 0.0415s/iter; left time: 389.4610s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:09.44s
Steps: 223 | Train Loss: 0.0693028 Vali Loss: 0.0854990 Test Loss: 0.0880816
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0685177
	speed: 0.0763s/iter; left time: 706.6706s
	iters: 200, epoch: 59 | loss: 0.0764130
	speed: 0.0410s/iter; left time: 376.2398s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:09.57s
Steps: 223 | Train Loss: 0.0693449 Vali Loss: 0.0854073 Test Loss: 0.0880793
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0652238
	speed: 0.0748s/iter; left time: 676.4479s
	iters: 200, epoch: 60 | loss: 0.0730409
	speed: 0.0425s/iter; left time: 380.3159s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:09.55s
Steps: 223 | Train Loss: 0.0693224 Vali Loss: 0.0854565 Test Loss: 0.0880748
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0622156
	speed: 0.0740s/iter; left time: 652.8614s
	iters: 200, epoch: 61 | loss: 0.0695777
	speed: 0.0423s/iter; left time: 369.0931s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:09.56s
Steps: 223 | Train Loss: 0.0693130 Vali Loss: 0.0853348 Test Loss: 0.0880779
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0691958
	speed: 0.0746s/iter; left time: 641.5221s
	iters: 200, epoch: 62 | loss: 0.0696925
	speed: 0.0411s/iter; left time: 348.9914s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:09.34s
Steps: 223 | Train Loss: 0.0692719 Vali Loss: 0.0854249 Test Loss: 0.0880714
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0646419
	speed: 0.0767s/iter; left time: 642.4102s
	iters: 200, epoch: 63 | loss: 0.0696922
	speed: 0.0415s/iter; left time: 343.2637s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:09.42s
Steps: 223 | Train Loss: 0.0692963 Vali Loss: 0.0855429 Test Loss: 0.0881021
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0697859
	speed: 0.0767s/iter; left time: 625.5754s
	iters: 200, epoch: 64 | loss: 0.0695441
	speed: 0.0416s/iter; left time: 334.7927s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0693159 Vali Loss: 0.0854452 Test Loss: 0.0880868
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0718862
	speed: 0.0746s/iter; left time: 591.8343s
	iters: 200, epoch: 65 | loss: 0.0714731
	speed: 0.0427s/iter; left time: 334.3363s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:09.53s
Steps: 223 | Train Loss: 0.0692911 Vali Loss: 0.0855044 Test Loss: 0.0880898
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0747009
	speed: 0.0740s/iter; left time: 570.0327s
	iters: 200, epoch: 66 | loss: 0.0683450
	speed: 0.0414s/iter; left time: 315.1523s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:09.40s
Steps: 223 | Train Loss: 0.0692636 Vali Loss: 0.0854475 Test Loss: 0.0880977
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0644507
	speed: 0.0754s/iter; left time: 564.0547s
	iters: 200, epoch: 67 | loss: 0.0695106
	speed: 0.0409s/iter; left time: 301.6847s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:09.30s
Steps: 223 | Train Loss: 0.0692449 Vali Loss: 0.0854787 Test Loss: 0.0881008
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_DE_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021135743707418442, rmse:0.1453813761472702, mae:0.08808080106973648, rse:0.5130710005760193
Intermediate time for DE and pred_len 24: 00h:23m:13.92s
=== Starting experiments for pred_len: 96 ===

--- Running model for DE, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1385211
	speed: 0.0689s/iter; left time: 1523.7622s
	iters: 200, epoch: 1 | loss: 0.1272170
	speed: 0.0429s/iter; left time: 943.8872s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.92s
Steps: 222 | Train Loss: 0.1436296 Vali Loss: 0.1367209 Test Loss: 0.1443836
Validation loss decreased (inf --> 0.136721).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1119428
	speed: 0.0752s/iter; left time: 1645.3605s
	iters: 200, epoch: 2 | loss: 0.1102052
	speed: 0.0433s/iter; left time: 942.5108s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.64s
Steps: 222 | Train Loss: 0.1122322 Vali Loss: 0.1209552 Test Loss: 0.1276630
Validation loss decreased (0.136721 --> 0.120955).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1019009
	speed: 0.0775s/iter; left time: 1678.0483s
	iters: 200, epoch: 3 | loss: 0.1073653
	speed: 0.0414s/iter; left time: 893.1470s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.46s
Steps: 222 | Train Loss: 0.1050740 Vali Loss: 0.1188224 Test Loss: 0.1261629
Validation loss decreased (0.120955 --> 0.118822).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0991714
	speed: 0.0787s/iter; left time: 1687.2832s
	iters: 200, epoch: 4 | loss: 0.1060414
	speed: 0.0412s/iter; left time: 879.6291s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.37s
Steps: 222 | Train Loss: 0.1032394 Vali Loss: 0.1185098 Test Loss: 0.1264228
Validation loss decreased (0.118822 --> 0.118510).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1070811
	speed: 0.0785s/iter; left time: 1664.3113s
	iters: 200, epoch: 5 | loss: 0.1010344
	speed: 0.0413s/iter; left time: 872.7381s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.64s
Steps: 222 | Train Loss: 0.1018696 Vali Loss: 0.1173460 Test Loss: 0.1256864
Validation loss decreased (0.118510 --> 0.117346).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0988520
	speed: 0.0769s/iter; left time: 1613.7952s
	iters: 200, epoch: 6 | loss: 0.0993529
	speed: 0.0432s/iter; left time: 902.5764s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.65s
Steps: 222 | Train Loss: 0.1007471 Vali Loss: 0.1172743 Test Loss: 0.1250511
Validation loss decreased (0.117346 --> 0.117274).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0983264
	speed: 0.0767s/iter; left time: 1593.1289s
	iters: 200, epoch: 7 | loss: 0.1031795
	speed: 0.0416s/iter; left time: 860.2588s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.40s
Steps: 222 | Train Loss: 0.0996418 Vali Loss: 0.1161049 Test Loss: 0.1247776
Validation loss decreased (0.117274 --> 0.116105).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0968254
	speed: 0.0767s/iter; left time: 1576.2278s
	iters: 200, epoch: 8 | loss: 0.0976769
	speed: 0.0433s/iter; left time: 885.1755s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.63s
Steps: 222 | Train Loss: 0.0990161 Vali Loss: 0.1161650 Test Loss: 0.1246663
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0972535
	speed: 0.0757s/iter; left time: 1538.0982s
	iters: 200, epoch: 9 | loss: 0.0927693
	speed: 0.0424s/iter; left time: 856.6277s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.55s
Steps: 222 | Train Loss: 0.0982024 Vali Loss: 0.1159731 Test Loss: 0.1244971
Validation loss decreased (0.116105 --> 0.115973).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1004171
	speed: 0.0787s/iter; left time: 1581.5480s
	iters: 200, epoch: 10 | loss: 0.1019848
	speed: 0.0417s/iter; left time: 833.5341s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.46s
Steps: 222 | Train Loss: 0.0975692 Vali Loss: 0.1164706 Test Loss: 0.1259885
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0969026
	speed: 0.0806s/iter; left time: 1602.3917s
	iters: 200, epoch: 11 | loss: 0.0972415
	speed: 0.0417s/iter; left time: 825.0613s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.70s
Steps: 222 | Train Loss: 0.0970848 Vali Loss: 0.1161472 Test Loss: 0.1248178
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0945826
	speed: 0.0765s/iter; left time: 1502.9973s
	iters: 200, epoch: 12 | loss: 0.0900184
	speed: 0.0430s/iter; left time: 840.4229s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.65s
Steps: 222 | Train Loss: 0.0966333 Vali Loss: 0.1163193 Test Loss: 0.1255104
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0919880
	speed: 0.0762s/iter; left time: 1481.9078s
	iters: 200, epoch: 13 | loss: 0.0924623
	speed: 0.0448s/iter; left time: 866.8809s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.88s
Steps: 222 | Train Loss: 0.0962716 Vali Loss: 0.1166060 Test Loss: 0.1256381
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0920922
	speed: 0.0769s/iter; left time: 1478.2532s
	iters: 200, epoch: 14 | loss: 0.0965592
	speed: 0.0415s/iter; left time: 792.8364s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.57s
Steps: 222 | Train Loss: 0.0958053 Vali Loss: 0.1166250 Test Loss: 0.1259447
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0982206
	speed: 0.0792s/iter; left time: 1504.5394s
	iters: 200, epoch: 15 | loss: 0.0993863
	speed: 0.0412s/iter; left time: 777.5881s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.0955025 Vali Loss: 0.1164518 Test Loss: 0.1254893
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0987729
	speed: 0.0787s/iter; left time: 1477.8527s
	iters: 200, epoch: 16 | loss: 0.0852301
	speed: 0.0420s/iter; left time: 784.2218s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.69s
Steps: 222 | Train Loss: 0.0951404 Vali Loss: 0.1169241 Test Loss: 0.1264961
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0946120
	speed: 0.0763s/iter; left time: 1415.3852s
	iters: 200, epoch: 17 | loss: 0.0943329
	speed: 0.0438s/iter; left time: 808.1443s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.70s
Steps: 222 | Train Loss: 0.0948563 Vali Loss: 0.1167530 Test Loss: 0.1260772
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0961872
	speed: 0.0765s/iter; left time: 1402.3126s
	iters: 200, epoch: 18 | loss: 0.0899222
	speed: 0.0421s/iter; left time: 767.2217s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.57s
Steps: 222 | Train Loss: 0.0945491 Vali Loss: 0.1170323 Test Loss: 0.1264428
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0923800
	speed: 0.0759s/iter; left time: 1373.4559s
	iters: 200, epoch: 19 | loss: 0.0921431
	speed: 0.0416s/iter; left time: 749.2655s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.40s
Steps: 222 | Train Loss: 0.0942993 Vali Loss: 0.1170631 Test Loss: 0.1265067
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03561720997095108, rmse:0.18872521817684174, mae:0.12449711561203003, rse:0.6683141589164734
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1400388
	speed: 0.0437s/iter; left time: 964.9514s
	iters: 200, epoch: 1 | loss: 0.1282806
	speed: 0.0418s/iter; left time: 920.5589s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.50s
Steps: 222 | Train Loss: 0.1451481 Vali Loss: 0.1368056 Test Loss: 0.1443637
Validation loss decreased (inf --> 0.136806).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1109583
	speed: 0.0795s/iter; left time: 1738.7939s
	iters: 200, epoch: 2 | loss: 0.1087150
	speed: 0.0413s/iter; left time: 898.5449s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.54s
Steps: 222 | Train Loss: 0.1123508 Vali Loss: 0.1206324 Test Loss: 0.1275795
Validation loss decreased (0.136806 --> 0.120632).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1061414
	speed: 0.0774s/iter; left time: 1676.6510s
	iters: 200, epoch: 3 | loss: 0.1020828
	speed: 0.0427s/iter; left time: 921.5330s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.67s
Steps: 222 | Train Loss: 0.1054388 Vali Loss: 0.1195631 Test Loss: 0.1275751
Validation loss decreased (0.120632 --> 0.119563).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1002767
	speed: 0.0766s/iter; left time: 1640.9971s
	iters: 200, epoch: 4 | loss: 0.1011909
	speed: 0.0444s/iter; left time: 947.6288s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.79s
Steps: 222 | Train Loss: 0.1036856 Vali Loss: 0.1177835 Test Loss: 0.1259473
Validation loss decreased (0.119563 --> 0.117784).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1005678
	speed: 0.0804s/iter; left time: 1704.5139s
	iters: 200, epoch: 5 | loss: 0.1012293
	speed: 0.0422s/iter; left time: 892.0216s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.70s
Steps: 222 | Train Loss: 0.1022701 Vali Loss: 0.1182866 Test Loss: 0.1259687
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1041436
	speed: 0.0799s/iter; left time: 1677.0377s
	iters: 200, epoch: 6 | loss: 0.1036419
	speed: 0.0416s/iter; left time: 868.7620s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.46s
Steps: 222 | Train Loss: 0.1011227 Vali Loss: 0.1171968 Test Loss: 0.1266128
Validation loss decreased (0.117784 --> 0.117197).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0986257
	speed: 0.0798s/iter; left time: 1657.7720s
	iters: 200, epoch: 7 | loss: 0.0996775
	speed: 0.0414s/iter; left time: 856.3834s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.61s
Steps: 222 | Train Loss: 0.1001962 Vali Loss: 0.1165839 Test Loss: 0.1266569
Validation loss decreased (0.117197 --> 0.116584).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0976779
	speed: 0.0806s/iter; left time: 1656.7433s
	iters: 200, epoch: 8 | loss: 0.0970001
	speed: 0.0439s/iter; left time: 897.2351s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.97s
Steps: 222 | Train Loss: 0.0992992 Vali Loss: 0.1167001 Test Loss: 0.1258703
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1027840
	speed: 0.0771s/iter; left time: 1566.7971s
	iters: 200, epoch: 9 | loss: 0.1060535
	speed: 0.0430s/iter; left time: 869.1260s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.68s
Steps: 222 | Train Loss: 0.0985650 Vali Loss: 0.1167805 Test Loss: 0.1263607
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0944021
	speed: 0.0790s/iter; left time: 1588.0037s
	iters: 200, epoch: 10 | loss: 0.1016151
	speed: 0.0413s/iter; left time: 825.4616s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.41s
Steps: 222 | Train Loss: 0.0980308 Vali Loss: 0.1163658 Test Loss: 0.1254943
Validation loss decreased (0.116584 --> 0.116366).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0977273
	speed: 0.0795s/iter; left time: 1581.0516s
	iters: 200, epoch: 11 | loss: 0.0998444
	speed: 0.0419s/iter; left time: 829.3113s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.64s
Steps: 222 | Train Loss: 0.0972910 Vali Loss: 0.1168659 Test Loss: 0.1263906
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0961552
	speed: 0.0790s/iter; left time: 1552.8094s
	iters: 200, epoch: 12 | loss: 0.0945634
	speed: 0.0428s/iter; left time: 836.8937s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.85s
Steps: 222 | Train Loss: 0.0967934 Vali Loss: 0.1168394 Test Loss: 0.1271407
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0975530
	speed: 0.0768s/iter; left time: 1493.3065s
	iters: 200, epoch: 13 | loss: 0.0979478
	speed: 0.0447s/iter; left time: 864.3879s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.82s
Steps: 222 | Train Loss: 0.0963015 Vali Loss: 0.1170192 Test Loss: 0.1264434
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0950694
	speed: 0.0771s/iter; left time: 1481.7566s
	iters: 200, epoch: 14 | loss: 0.0953018
	speed: 0.0414s/iter; left time: 790.4982s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.48s
Steps: 222 | Train Loss: 0.0958852 Vali Loss: 0.1174900 Test Loss: 0.1265704
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0917451
	speed: 0.0798s/iter; left time: 1516.0533s
	iters: 200, epoch: 15 | loss: 0.0947973
	speed: 0.0414s/iter; left time: 781.8990s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.43s
Steps: 222 | Train Loss: 0.0954877 Vali Loss: 0.1173866 Test Loss: 0.1267025
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0963200
	speed: 0.0788s/iter; left time: 1478.6512s
	iters: 200, epoch: 16 | loss: 0.0930423
	speed: 0.0423s/iter; left time: 789.7573s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.80s
Steps: 222 | Train Loss: 0.0950855 Vali Loss: 0.1175980 Test Loss: 0.1277074
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0916373
	speed: 0.0815s/iter; left time: 1511.0478s
	iters: 200, epoch: 17 | loss: 0.0967468
	speed: 0.0506s/iter; left time: 933.3922s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:10.78s
Steps: 222 | Train Loss: 0.0947534 Vali Loss: 0.1174741 Test Loss: 0.1267105
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0973670
	speed: 0.0786s/iter; left time: 1440.3332s
	iters: 200, epoch: 18 | loss: 0.0952947
	speed: 0.0429s/iter; left time: 782.8464s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.81s
Steps: 222 | Train Loss: 0.0943828 Vali Loss: 0.1179385 Test Loss: 0.1270582
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0973220
	speed: 0.0781s/iter; left time: 1414.1248s
	iters: 200, epoch: 19 | loss: 0.0969161
	speed: 0.0420s/iter; left time: 756.1142s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.45s
Steps: 222 | Train Loss: 0.0941494 Vali Loss: 0.1176506 Test Loss: 0.1271805
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0945372
	speed: 0.0828s/iter; left time: 1481.0696s
	iters: 200, epoch: 20 | loss: 0.0925670
	speed: 0.0417s/iter; left time: 741.4809s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.69s
Steps: 222 | Train Loss: 0.0939146 Vali Loss: 0.1181242 Test Loss: 0.1272864
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.036110397428274155, rmse:0.1900273561477661, mae:0.12549425661563873, rse:0.6729252934455872
Intermediate time for DE and pred_len 96: 00h:08m:04.70s
=== Starting experiments for pred_len: 168 ===

--- Running model for DE, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1397623
	speed: 0.0685s/iter; left time: 1512.8747s
	iters: 200, epoch: 1 | loss: 0.1311453
	speed: 0.0443s/iter; left time: 975.2928s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.02s
Steps: 222 | Train Loss: 0.1455157 Vali Loss: 0.1382303 Test Loss: 0.1469418
Validation loss decreased (inf --> 0.138230).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1118676
	speed: 0.0769s/iter; left time: 1681.6863s
	iters: 200, epoch: 2 | loss: 0.1124648
	speed: 0.0422s/iter; left time: 918.4879s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.60s
Steps: 222 | Train Loss: 0.1173347 Vali Loss: 0.1244901 Test Loss: 0.1326688
Validation loss decreased (0.138230 --> 0.124490).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1142889
	speed: 0.0829s/iter; left time: 1795.9465s
	iters: 200, epoch: 3 | loss: 0.1112246
	speed: 0.0419s/iter; left time: 903.0144s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.62s
Steps: 222 | Train Loss: 0.1107566 Vali Loss: 0.1233068 Test Loss: 0.1331108
Validation loss decreased (0.124490 --> 0.123307).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1125001
	speed: 0.0796s/iter; left time: 1705.7956s
	iters: 200, epoch: 4 | loss: 0.1047679
	speed: 0.0422s/iter; left time: 900.1698s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.68s
Steps: 222 | Train Loss: 0.1088656 Vali Loss: 0.1225500 Test Loss: 0.1325692
Validation loss decreased (0.123307 --> 0.122550).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1045422
	speed: 0.0778s/iter; left time: 1651.2061s
	iters: 200, epoch: 5 | loss: 0.1108324
	speed: 0.0443s/iter; left time: 934.4993s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.88s
Steps: 222 | Train Loss: 0.1072662 Vali Loss: 0.1221504 Test Loss: 0.1329006
Validation loss decreased (0.122550 --> 0.122150).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1041857
	speed: 0.0778s/iter; left time: 1632.2456s
	iters: 200, epoch: 6 | loss: 0.1052786
	speed: 0.0448s/iter; left time: 936.7191s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.86s
Steps: 222 | Train Loss: 0.1058854 Vali Loss: 0.1215441 Test Loss: 0.1320615
Validation loss decreased (0.122150 --> 0.121544).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1038428
	speed: 0.0791s/iter; left time: 1641.9992s
	iters: 200, epoch: 7 | loss: 0.1040158
	speed: 0.0420s/iter; left time: 868.4266s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.56s
Steps: 222 | Train Loss: 0.1048011 Vali Loss: 0.1215408 Test Loss: 0.1310547
Validation loss decreased (0.121544 --> 0.121541).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1035512
	speed: 0.0793s/iter; left time: 1629.1195s
	iters: 200, epoch: 8 | loss: 0.1044740
	speed: 0.0429s/iter; left time: 877.8017s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.85s
Steps: 222 | Train Loss: 0.1037952 Vali Loss: 0.1215836 Test Loss: 0.1319724
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1043236
	speed: 0.0805s/iter; left time: 1636.7817s
	iters: 200, epoch: 9 | loss: 0.1052697
	speed: 0.0427s/iter; left time: 862.8355s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.69s
Steps: 222 | Train Loss: 0.1029094 Vali Loss: 0.1222514 Test Loss: 0.1315340
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0996455
	speed: 0.0792s/iter; left time: 1591.9196s
	iters: 200, epoch: 10 | loss: 0.1033757
	speed: 0.0422s/iter; left time: 843.8225s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.72s
Steps: 222 | Train Loss: 0.1021399 Vali Loss: 0.1226193 Test Loss: 0.1322068
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1056792
	speed: 0.0812s/iter; left time: 1613.7792s
	iters: 200, epoch: 11 | loss: 0.1029007
	speed: 0.0430s/iter; left time: 849.7322s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:10.08s
Steps: 222 | Train Loss: 0.1013839 Vali Loss: 0.1223948 Test Loss: 0.1326800
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1031876
	speed: 0.0785s/iter; left time: 1543.2386s
	iters: 200, epoch: 12 | loss: 0.1028955
	speed: 0.0448s/iter; left time: 876.2428s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.87s
Steps: 222 | Train Loss: 0.1008144 Vali Loss: 0.1228269 Test Loss: 0.1327951
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0969489
	speed: 0.0775s/iter; left time: 1506.6652s
	iters: 200, epoch: 13 | loss: 0.1018683
	speed: 0.0420s/iter; left time: 811.4023s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.67s
Steps: 222 | Train Loss: 0.1002138 Vali Loss: 0.1231768 Test Loss: 0.1335167
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0958620
	speed: 0.0823s/iter; left time: 1582.0268s
	iters: 200, epoch: 14 | loss: 0.0960994
	speed: 0.0425s/iter; left time: 812.2139s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.76s
Steps: 222 | Train Loss: 0.0996247 Vali Loss: 0.1232097 Test Loss: 0.1334005
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0970920
	speed: 0.0815s/iter; left time: 1547.0298s
	iters: 200, epoch: 15 | loss: 0.0992540
	speed: 0.0424s/iter; left time: 800.2279s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.94s
Steps: 222 | Train Loss: 0.0991395 Vali Loss: 0.1234243 Test Loss: 0.1337967
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0988758
	speed: 0.0778s/iter; left time: 1460.0914s
	iters: 200, epoch: 16 | loss: 0.1006009
	speed: 0.0429s/iter; left time: 801.1770s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.72s
Steps: 222 | Train Loss: 0.0986473 Vali Loss: 0.1236352 Test Loss: 0.1343386
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0987671
	speed: 0.0773s/iter; left time: 1434.3332s
	iters: 200, epoch: 17 | loss: 0.1016840
	speed: 0.0433s/iter; left time: 798.6553s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.69s
Steps: 222 | Train Loss: 0.0981912 Vali Loss: 0.1233611 Test Loss: 0.1350610
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.037683311849832535, rmse:0.19412189722061157, mae:0.13105474412441254, rse:0.6875953674316406
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1464187
	speed: 0.0438s/iter; left time: 969.1262s
	iters: 200, epoch: 1 | loss: 0.1341484
	speed: 0.0436s/iter; left time: 958.8354s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.71s
Steps: 222 | Train Loss: 0.1460951 Vali Loss: 0.1378723 Test Loss: 0.1467569
Validation loss decreased (inf --> 0.137872).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1244008
	speed: 0.0783s/iter; left time: 1714.2119s
	iters: 200, epoch: 2 | loss: 0.1136181
	speed: 0.0421s/iter; left time: 917.9451s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.60s
Steps: 222 | Train Loss: 0.1175792 Vali Loss: 0.1241931 Test Loss: 0.1332423
Validation loss decreased (0.137872 --> 0.124193).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1168221
	speed: 0.0842s/iter; left time: 1822.6471s
	iters: 200, epoch: 3 | loss: 0.1108454
	speed: 0.0422s/iter; left time: 908.8045s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.64s
Steps: 222 | Train Loss: 0.1109203 Vali Loss: 0.1232760 Test Loss: 0.1326479
Validation loss decreased (0.124193 --> 0.123276).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1095669
	speed: 0.0842s/iter; left time: 1805.3797s
	iters: 200, epoch: 4 | loss: 0.1056824
	speed: 0.0417s/iter; left time: 889.9108s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.61s
Steps: 222 | Train Loss: 0.1091623 Vali Loss: 0.1222856 Test Loss: 0.1327749
Validation loss decreased (0.123276 --> 0.122286).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1129397
	speed: 0.0839s/iter; left time: 1779.1501s
	iters: 200, epoch: 5 | loss: 0.1075838
	speed: 0.0417s/iter; left time: 880.7508s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.72s
Steps: 222 | Train Loss: 0.1076867 Vali Loss: 0.1218808 Test Loss: 0.1322782
Validation loss decreased (0.122286 --> 0.121881).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1021544
	speed: 0.0803s/iter; left time: 1684.8417s
	iters: 200, epoch: 6 | loss: 0.1099828
	speed: 0.0436s/iter; left time: 911.6491s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.78s
Steps: 222 | Train Loss: 0.1062730 Vali Loss: 0.1218795 Test Loss: 0.1329139
Validation loss decreased (0.121881 --> 0.121879).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1045288
	speed: 0.0787s/iter; left time: 1635.3227s
	iters: 200, epoch: 7 | loss: 0.1049782
	speed: 0.0442s/iter; left time: 912.7845s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.83s
Steps: 222 | Train Loss: 0.1051721 Vali Loss: 0.1218529 Test Loss: 0.1329821
Validation loss decreased (0.121879 --> 0.121853).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1054067
	speed: 0.0791s/iter; left time: 1625.8461s
	iters: 200, epoch: 8 | loss: 0.1061499
	speed: 0.0419s/iter; left time: 857.4815s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.63s
Steps: 222 | Train Loss: 0.1041193 Vali Loss: 0.1218142 Test Loss: 0.1342641
Validation loss decreased (0.121853 --> 0.121814).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1012625
	speed: 0.0818s/iter; left time: 1661.8316s
	iters: 200, epoch: 9 | loss: 0.1050227
	speed: 0.0420s/iter; left time: 848.8886s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.54s
Steps: 222 | Train Loss: 0.1032028 Vali Loss: 0.1221258 Test Loss: 0.1326769
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1042934
	speed: 0.0803s/iter; left time: 1613.4620s
	iters: 200, epoch: 10 | loss: 0.0979124
	speed: 0.0422s/iter; left time: 843.4786s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.82s
Steps: 222 | Train Loss: 0.1022348 Vali Loss: 0.1229397 Test Loss: 0.1328034
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0992723
	speed: 0.0782s/iter; left time: 1553.8170s
	iters: 200, epoch: 11 | loss: 0.1031113
	speed: 0.0429s/iter; left time: 848.0301s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.80s
Steps: 222 | Train Loss: 0.1014518 Vali Loss: 0.1221524 Test Loss: 0.1333573
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0981024
	speed: 0.0796s/iter; left time: 1564.1103s
	iters: 200, epoch: 12 | loss: 0.1039329
	speed: 0.0420s/iter; left time: 820.8737s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.54s
Steps: 222 | Train Loss: 0.1004923 Vali Loss: 0.1232195 Test Loss: 0.1345381
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0996970
	speed: 0.0800s/iter; left time: 1554.3746s
	iters: 200, epoch: 13 | loss: 0.1020393
	speed: 0.0420s/iter; left time: 812.6434s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.68s
Steps: 222 | Train Loss: 0.0998807 Vali Loss: 0.1230378 Test Loss: 0.1335723
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1020292
	speed: 0.0789s/iter; left time: 1515.2191s
	iters: 200, epoch: 14 | loss: 0.0983770
	speed: 0.0429s/iter; left time: 819.7774s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.77s
Steps: 222 | Train Loss: 0.0993128 Vali Loss: 0.1233723 Test Loss: 0.1334894
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1019369
	speed: 0.0786s/iter; left time: 1493.1534s
	iters: 200, epoch: 15 | loss: 0.1003085
	speed: 0.0438s/iter; left time: 827.4623s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.75s
Steps: 222 | Train Loss: 0.0986477 Vali Loss: 0.1239124 Test Loss: 0.1339220
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0990376
	speed: 0.0780s/iter; left time: 1463.5393s
	iters: 200, epoch: 16 | loss: 0.0996671
	speed: 0.0421s/iter; left time: 785.9176s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.59s
Steps: 222 | Train Loss: 0.0981405 Vali Loss: 0.1236752 Test Loss: 0.1338171
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0997125
	speed: 0.0809s/iter; left time: 1500.4029s
	iters: 200, epoch: 17 | loss: 0.0991643
	speed: 0.0419s/iter; left time: 773.8596s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.59s
Steps: 222 | Train Loss: 0.0977311 Vali Loss: 0.1242002 Test Loss: 0.1341292
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0960976
	speed: 0.0808s/iter; left time: 1481.3266s
	iters: 200, epoch: 18 | loss: 0.0957674
	speed: 0.0422s/iter; left time: 769.5621s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.73s
Steps: 222 | Train Loss: 0.0973472 Vali Loss: 0.1244612 Test Loss: 0.1344188
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03982341289520264, rmse:0.1995580494403839, mae:0.13426414132118225, rse:0.7068506479263306
Intermediate time for DE and pred_len 168: 00h:07m:24.55sIntermediate time for DE: 00h:38m:43.17s
=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_512_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1188304
	speed: 0.0652s/iter; left time: 1447.7247s
	iters: 200, epoch: 1 | loss: 0.1158463
	speed: 0.0436s/iter; left time: 964.1339s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.86s
Steps: 223 | Train Loss: 0.1253345 Vali Loss: 0.1194196 Test Loss: 0.1384884
Validation loss decreased (inf --> 0.119420).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0869500
	speed: 0.0763s/iter; left time: 1677.7030s
	iters: 200, epoch: 2 | loss: 0.0823559
	speed: 0.0412s/iter; left time: 901.8988s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.46s
Steps: 223 | Train Loss: 0.0858117 Vali Loss: 0.0921554 Test Loss: 0.1034357
Validation loss decreased (0.119420 --> 0.092155).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0806272
	speed: 0.0785s/iter; left time: 1708.0403s
	iters: 200, epoch: 3 | loss: 0.0780588
	speed: 0.0411s/iter; left time: 889.2124s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.37s
Steps: 223 | Train Loss: 0.0789248 Vali Loss: 0.0894574 Test Loss: 0.1027660
Validation loss decreased (0.092155 --> 0.089457).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0818409
	speed: 0.0777s/iter; left time: 1672.5881s
	iters: 200, epoch: 4 | loss: 0.0826696
	speed: 0.0420s/iter; left time: 900.2888s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.71s
Steps: 223 | Train Loss: 0.0773095 Vali Loss: 0.0896718 Test Loss: 0.1028447
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0730246
	speed: 0.0752s/iter; left time: 1601.9405s
	iters: 200, epoch: 5 | loss: 0.0735860
	speed: 0.0431s/iter; left time: 913.7536s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.62s
Steps: 223 | Train Loss: 0.0762145 Vali Loss: 0.0891013 Test Loss: 0.1017014
Validation loss decreased (0.089457 --> 0.089101).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0732028
	speed: 0.0745s/iter; left time: 1570.1271s
	iters: 200, epoch: 6 | loss: 0.0779525
	speed: 0.0428s/iter; left time: 898.4472s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.58s
Steps: 223 | Train Loss: 0.0755551 Vali Loss: 0.0885052 Test Loss: 0.1005966
Validation loss decreased (0.089101 --> 0.088505).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0749436
	speed: 0.0767s/iter; left time: 1599.9896s
	iters: 200, epoch: 7 | loss: 0.0747769
	speed: 0.0415s/iter; left time: 861.0585s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.46s
Steps: 223 | Train Loss: 0.0749858 Vali Loss: 0.0884487 Test Loss: 0.1012087
Validation loss decreased (0.088505 --> 0.088449).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0772606
	speed: 0.0781s/iter; left time: 1611.0026s
	iters: 200, epoch: 8 | loss: 0.0730566
	speed: 0.0413s/iter; left time: 847.4625s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.50s
Steps: 223 | Train Loss: 0.0745392 Vali Loss: 0.0878225 Test Loss: 0.1004115
Validation loss decreased (0.088449 --> 0.087823).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0728021
	speed: 0.0764s/iter; left time: 1560.4706s
	iters: 200, epoch: 9 | loss: 0.0704910
	speed: 0.0421s/iter; left time: 855.2597s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.61s
Steps: 223 | Train Loss: 0.0741072 Vali Loss: 0.0878454 Test Loss: 0.0995688
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0727380
	speed: 0.0741s/iter; left time: 1497.3165s
	iters: 200, epoch: 10 | loss: 0.0768265
	speed: 0.0429s/iter; left time: 862.5919s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0736922 Vali Loss: 0.0878476 Test Loss: 0.1003193
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0790198
	speed: 0.0768s/iter; left time: 1532.9696s
	iters: 200, epoch: 11 | loss: 0.0737132
	speed: 0.0415s/iter; left time: 823.9702s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.46s
Steps: 223 | Train Loss: 0.0733805 Vali Loss: 0.0875606 Test Loss: 0.1003940
Validation loss decreased (0.087823 --> 0.087561).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0658553
	speed: 0.0744s/iter; left time: 1469.1125s
	iters: 200, epoch: 12 | loss: 0.0785903
	speed: 0.0411s/iter; left time: 807.3380s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.36s
Steps: 223 | Train Loss: 0.0731744 Vali Loss: 0.0876214 Test Loss: 0.0995508
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0719233
	speed: 0.0767s/iter; left time: 1498.4702s
	iters: 200, epoch: 13 | loss: 0.0742535
	speed: 0.0416s/iter; left time: 808.2278s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.45s
Steps: 223 | Train Loss: 0.0729265 Vali Loss: 0.0874835 Test Loss: 0.0995281
Validation loss decreased (0.087561 --> 0.087484).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0725279
	speed: 0.0758s/iter; left time: 1464.0409s
	iters: 200, epoch: 14 | loss: 0.0729276
	speed: 0.0411s/iter; left time: 788.4623s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.45s
Steps: 223 | Train Loss: 0.0727757 Vali Loss: 0.0875945 Test Loss: 0.0995237
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0727914
	speed: 0.0749s/iter; left time: 1429.1084s
	iters: 200, epoch: 15 | loss: 0.0719108
	speed: 0.0424s/iter; left time: 804.5638s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.56s
Steps: 223 | Train Loss: 0.0725818 Vali Loss: 0.0873662 Test Loss: 0.0992842
Validation loss decreased (0.087484 --> 0.087366).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0703028
	speed: 0.0752s/iter; left time: 1418.1670s
	iters: 200, epoch: 16 | loss: 0.0679876
	speed: 0.0425s/iter; left time: 797.1647s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.62s
Steps: 223 | Train Loss: 0.0724623 Vali Loss: 0.0873758 Test Loss: 0.0991852
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0762972
	speed: 0.0754s/iter; left time: 1404.1466s
	iters: 200, epoch: 17 | loss: 0.0740745
	speed: 0.0412s/iter; left time: 763.4600s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.38s
Steps: 223 | Train Loss: 0.0722771 Vali Loss: 0.0871907 Test Loss: 0.0993153
Validation loss decreased (0.087366 --> 0.087191).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0713437
	speed: 0.0771s/iter; left time: 1419.2108s
	iters: 200, epoch: 18 | loss: 0.0711351
	speed: 0.0411s/iter; left time: 752.6492s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.37s
Steps: 223 | Train Loss: 0.0721830 Vali Loss: 0.0871974 Test Loss: 0.0992790
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0728786
	speed: 0.0752s/iter; left time: 1366.7758s
	iters: 200, epoch: 19 | loss: 0.0766083
	speed: 0.0418s/iter; left time: 756.3165s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.51s
Steps: 223 | Train Loss: 0.0720670 Vali Loss: 0.0873282 Test Loss: 0.0991362
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0707023
	speed: 0.0757s/iter; left time: 1360.3913s
	iters: 200, epoch: 20 | loss: 0.0659706
	speed: 0.0420s/iter; left time: 751.0556s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.54s
Steps: 223 | Train Loss: 0.0719200 Vali Loss: 0.0872897 Test Loss: 0.0990334
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0683376
	speed: 0.0744s/iter; left time: 1319.2726s
	iters: 200, epoch: 21 | loss: 0.0744315
	speed: 0.0418s/iter; left time: 738.0603s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.47s
Steps: 223 | Train Loss: 0.0718971 Vali Loss: 0.0872003 Test Loss: 0.0991050
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0723205
	speed: 0.0751s/iter; left time: 1315.7646s
	iters: 200, epoch: 22 | loss: 0.0718565
	speed: 0.0412s/iter; left time: 717.9955s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.39s
Steps: 223 | Train Loss: 0.0717617 Vali Loss: 0.0871217 Test Loss: 0.0991213
Validation loss decreased (0.087191 --> 0.087122).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0754515
	speed: 0.0776s/iter; left time: 1341.6347s
	iters: 200, epoch: 23 | loss: 0.0666656
	speed: 0.0417s/iter; left time: 716.6735s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.49s
Steps: 223 | Train Loss: 0.0717673 Vali Loss: 0.0870475 Test Loss: 0.0990244
Validation loss decreased (0.087122 --> 0.087047).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0736613
	speed: 0.0762s/iter; left time: 1300.7520s
	iters: 200, epoch: 24 | loss: 0.0732239
	speed: 0.0417s/iter; left time: 708.3741s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.58s
Steps: 223 | Train Loss: 0.0716505 Vali Loss: 0.0871460 Test Loss: 0.0991912
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0745001
	speed: 0.0744s/iter; left time: 1253.5139s
	iters: 200, epoch: 25 | loss: 0.0714629
	speed: 0.0430s/iter; left time: 719.9745s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.58s
Steps: 223 | Train Loss: 0.0716034 Vali Loss: 0.0873583 Test Loss: 0.0990945
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0680236
	speed: 0.0750s/iter; left time: 1246.2728s
	iters: 200, epoch: 26 | loss: 0.0676734
	speed: 0.0411s/iter; left time: 679.2821s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.46s
Steps: 223 | Train Loss: 0.0715778 Vali Loss: 0.0872454 Test Loss: 0.0990852
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0735137
	speed: 0.0766s/iter; left time: 1255.7564s
	iters: 200, epoch: 27 | loss: 0.0742956
	speed: 0.0412s/iter; left time: 671.4379s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.36s
Steps: 223 | Train Loss: 0.0714903 Vali Loss: 0.0869934 Test Loss: 0.0989545
Validation loss decreased (0.087047 --> 0.086993).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0663206
	speed: 0.0771s/iter; left time: 1247.1326s
	iters: 200, epoch: 28 | loss: 0.0772928
	speed: 0.0411s/iter; left time: 660.3537s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.58s
Steps: 223 | Train Loss: 0.0714377 Vali Loss: 0.0872516 Test Loss: 0.0991254
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0742304
	speed: 0.0751s/iter; left time: 1197.9225s
	iters: 200, epoch: 29 | loss: 0.0696663
	speed: 0.0418s/iter; left time: 663.4998s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.51s
Steps: 223 | Train Loss: 0.0714469 Vali Loss: 0.0871852 Test Loss: 0.0990446
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0752319
	speed: 0.0737s/iter; left time: 1160.2209s
	iters: 200, epoch: 30 | loss: 0.0767607
	speed: 0.0421s/iter; left time: 657.6439s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.51s
Steps: 223 | Train Loss: 0.0714359 Vali Loss: 0.0872758 Test Loss: 0.0990327
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0697839
	speed: 0.0761s/iter; left time: 1180.0293s
	iters: 200, epoch: 31 | loss: 0.0737064
	speed: 0.0418s/iter; left time: 644.8325s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.51s
Steps: 223 | Train Loss: 0.0713810 Vali Loss: 0.0870711 Test Loss: 0.0990327
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0747602
	speed: 0.0786s/iter; left time: 1201.8673s
	iters: 200, epoch: 32 | loss: 0.0749984
	speed: 0.0408s/iter; left time: 620.2149s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.34s
Steps: 223 | Train Loss: 0.0713382 Vali Loss: 0.0871204 Test Loss: 0.0990219
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0712683
	speed: 0.0751s/iter; left time: 1130.8837s
	iters: 200, epoch: 33 | loss: 0.0691796
	speed: 0.0413s/iter; left time: 618.4426s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.50s
Steps: 223 | Train Loss: 0.0713131 Vali Loss: 0.0871258 Test Loss: 0.0989417
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0684355
	speed: 0.0743s/iter; left time: 1103.0916s
	iters: 200, epoch: 34 | loss: 0.0734600
	speed: 0.0426s/iter; left time: 627.6817s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.62s
Steps: 223 | Train Loss: 0.0713078 Vali Loss: 0.0871348 Test Loss: 0.0989215
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0735072
	speed: 0.0742s/iter; left time: 1084.6726s
	iters: 200, epoch: 35 | loss: 0.0741483
	speed: 0.0473s/iter; left time: 686.8830s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:10.01s
Steps: 223 | Train Loss: 0.0713056 Vali Loss: 0.0871275 Test Loss: 0.0989961
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0728918
	speed: 0.0826s/iter; left time: 1188.9078s
	iters: 200, epoch: 36 | loss: 0.0666929
	speed: 0.0412s/iter; left time: 589.1977s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.44s
Steps: 223 | Train Loss: 0.0712683 Vali Loss: 0.0871395 Test Loss: 0.0990887
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0745390
	speed: 0.0750s/iter; left time: 1062.3159s
	iters: 200, epoch: 37 | loss: 0.0715760
	speed: 0.0411s/iter; left time: 578.9544s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.40s
Steps: 223 | Train Loss: 0.0712489 Vali Loss: 0.0871422 Test Loss: 0.0990047
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02461354248225689, rmse:0.15688703954219818, mae:0.09895447641611099, rse:0.5412158370018005
Use GPU: cuda:0
>>>>>>>start training : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1241236
	speed: 0.0443s/iter; left time: 984.5030s
	iters: 200, epoch: 1 | loss: 0.1141754
	speed: 0.0409s/iter; left time: 903.9796s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.50s
Steps: 223 | Train Loss: 0.1244885 Vali Loss: 0.1183953 Test Loss: 0.1381955
Validation loss decreased (inf --> 0.118395).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0812800
	speed: 0.0752s/iter; left time: 1651.8621s
	iters: 200, epoch: 2 | loss: 0.0813031
	speed: 0.0428s/iter; left time: 935.4663s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.54s
Steps: 223 | Train Loss: 0.0860217 Vali Loss: 0.0911778 Test Loss: 0.1037141
Validation loss decreased (0.118395 --> 0.091178).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0854152
	speed: 0.0753s/iter; left time: 1638.5817s
	iters: 200, epoch: 3 | loss: 0.0821180
	speed: 0.0424s/iter; left time: 918.0883s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.58s
Steps: 223 | Train Loss: 0.0792323 Vali Loss: 0.0901997 Test Loss: 0.1024127
Validation loss decreased (0.091178 --> 0.090200).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0771382
	speed: 0.0779s/iter; left time: 1677.9186s
	iters: 200, epoch: 4 | loss: 0.0748695
	speed: 0.0417s/iter; left time: 892.9221s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.56s
Steps: 223 | Train Loss: 0.0776143 Vali Loss: 0.0893536 Test Loss: 0.1021961
Validation loss decreased (0.090200 --> 0.089354).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0746484
	speed: 0.0788s/iter; left time: 1679.8393s
	iters: 200, epoch: 5 | loss: 0.0762351
	speed: 0.0423s/iter; left time: 897.6641s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.49s
Steps: 223 | Train Loss: 0.0765393 Vali Loss: 0.0895949 Test Loss: 0.1016256
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0704589
	speed: 0.0762s/iter; left time: 1607.5950s
	iters: 200, epoch: 6 | loss: 0.0779320
	speed: 0.0453s/iter; left time: 949.6393s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.96s
Steps: 223 | Train Loss: 0.0757048 Vali Loss: 0.0887313 Test Loss: 0.1005883
Validation loss decreased (0.089354 --> 0.088731).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0787142
	speed: 0.0764s/iter; left time: 1594.4792s
	iters: 200, epoch: 7 | loss: 0.0723651
	speed: 0.0421s/iter; left time: 874.9431s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.52s
Steps: 223 | Train Loss: 0.0752229 Vali Loss: 0.0888143 Test Loss: 0.1010623
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0749634
	speed: 0.0752s/iter; left time: 1552.5956s
	iters: 200, epoch: 8 | loss: 0.0779372
	speed: 0.0415s/iter; left time: 851.8358s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.51s
Steps: 223 | Train Loss: 0.0746250 Vali Loss: 0.0880766 Test Loss: 0.0999531
Validation loss decreased (0.088731 --> 0.088077).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0755208
	speed: 0.0779s/iter; left time: 1590.5388s
	iters: 200, epoch: 9 | loss: 0.0692909
	speed: 0.0418s/iter; left time: 848.9443s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0741197 Vali Loss: 0.0877385 Test Loss: 0.1002419
Validation loss decreased (0.088077 --> 0.087739).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0735870
	speed: 0.0833s/iter; left time: 1682.1019s
	iters: 200, epoch: 10 | loss: 0.0762803
	speed: 0.0456s/iter; left time: 915.9615s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:10.33s
Steps: 223 | Train Loss: 0.0737935 Vali Loss: 0.0875983 Test Loss: 0.0999065
Validation loss decreased (0.087739 --> 0.087598).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0739966
	speed: 0.0797s/iter; left time: 1590.8784s
	iters: 200, epoch: 11 | loss: 0.0750790
	speed: 0.0411s/iter; left time: 817.6321s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.75s
Steps: 223 | Train Loss: 0.0734880 Vali Loss: 0.0874614 Test Loss: 0.0996489
Validation loss decreased (0.087598 --> 0.087461).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0765056
	speed: 0.0749s/iter; left time: 1479.6047s
	iters: 200, epoch: 12 | loss: 0.0719574
	speed: 0.0430s/iter; left time: 844.7458s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.56s
Steps: 223 | Train Loss: 0.0731832 Vali Loss: 0.0875553 Test Loss: 0.0998995
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0682084
	speed: 0.0759s/iter; left time: 1482.3639s
	iters: 200, epoch: 13 | loss: 0.0720051
	speed: 0.0425s/iter; left time: 825.2627s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.58s
Steps: 223 | Train Loss: 0.0729966 Vali Loss: 0.0875060 Test Loss: 0.0998122
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0706566
	speed: 0.0761s/iter; left time: 1468.0225s
	iters: 200, epoch: 14 | loss: 0.0754816
	speed: 0.0429s/iter; left time: 823.9258s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.55s
Steps: 223 | Train Loss: 0.0728083 Vali Loss: 0.0875992 Test Loss: 0.0995544
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0706279
	speed: 0.0773s/iter; left time: 1475.5315s
	iters: 200, epoch: 15 | loss: 0.0750840
	speed: 0.0413s/iter; left time: 783.1734s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.50s
Steps: 223 | Train Loss: 0.0726432 Vali Loss: 0.0872414 Test Loss: 0.0996507
Validation loss decreased (0.087461 --> 0.087241).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0797694
	speed: 0.0765s/iter; left time: 1442.0772s
	iters: 200, epoch: 16 | loss: 0.0691095
	speed: 0.0415s/iter; left time: 778.3577s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.58s
Steps: 223 | Train Loss: 0.0724336 Vali Loss: 0.0874647 Test Loss: 0.0995680
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0743775
	speed: 0.0749s/iter; left time: 1394.9423s
	iters: 200, epoch: 17 | loss: 0.0741325
	speed: 0.0427s/iter; left time: 790.5807s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.52s
Steps: 223 | Train Loss: 0.0723469 Vali Loss: 0.0873769 Test Loss: 0.0993158
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0726027
	speed: 0.0748s/iter; left time: 1377.1837s
	iters: 200, epoch: 18 | loss: 0.0659239
	speed: 0.0414s/iter; left time: 757.7842s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.43s
Steps: 223 | Train Loss: 0.0721854 Vali Loss: 0.0872896 Test Loss: 0.0991555
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0711987
	speed: 0.0784s/iter; left time: 1426.3078s
	iters: 200, epoch: 19 | loss: 0.0673086
	speed: 0.0418s/iter; left time: 756.6949s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.49s
Steps: 223 | Train Loss: 0.0721364 Vali Loss: 0.0871735 Test Loss: 0.0992202
Validation loss decreased (0.087241 --> 0.087173).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0731464
	speed: 0.0767s/iter; left time: 1378.0725s
	iters: 200, epoch: 20 | loss: 0.0776331
	speed: 0.0412s/iter; left time: 736.2917s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.50s
Steps: 223 | Train Loss: 0.0720103 Vali Loss: 0.0872837 Test Loss: 0.0991743
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0711740
	speed: 0.0755s/iter; left time: 1339.7905s
	iters: 200, epoch: 21 | loss: 0.0753554
	speed: 0.0427s/iter; left time: 752.5130s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.60s
Steps: 223 | Train Loss: 0.0719040 Vali Loss: 0.0871968 Test Loss: 0.0992067
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0715744
	speed: 0.0759s/iter; left time: 1328.8578s
	iters: 200, epoch: 22 | loss: 0.0681315
	speed: 0.0428s/iter; left time: 744.8459s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0718549 Vali Loss: 0.0871228 Test Loss: 0.0991327
Validation loss decreased (0.087173 --> 0.087123).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0704514
	speed: 0.0766s/iter; left time: 1323.9731s
	iters: 200, epoch: 23 | loss: 0.0714713
	speed: 0.0415s/iter; left time: 713.6869s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.44s
Steps: 223 | Train Loss: 0.0717374 Vali Loss: 0.0870542 Test Loss: 0.0989956
Validation loss decreased (0.087123 --> 0.087054).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0751139
	speed: 0.0781s/iter; left time: 1332.4945s
	iters: 200, epoch: 24 | loss: 0.0752301
	speed: 0.0419s/iter; left time: 711.1909s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.47s
Steps: 223 | Train Loss: 0.0716789 Vali Loss: 0.0870215 Test Loss: 0.0990368
Validation loss decreased (0.087054 --> 0.087022).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0707601
	speed: 0.0786s/iter; left time: 1324.3908s
	iters: 200, epoch: 25 | loss: 0.0697482
	speed: 0.0426s/iter; left time: 713.0098s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.82s
Steps: 223 | Train Loss: 0.0716772 Vali Loss: 0.0870498 Test Loss: 0.0989855
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0707332
	speed: 0.0748s/iter; left time: 1242.8210s
	iters: 200, epoch: 26 | loss: 0.0765021
	speed: 0.0425s/iter; left time: 702.9114s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.53s
Steps: 223 | Train Loss: 0.0716127 Vali Loss: 0.0868681 Test Loss: 0.0989585
Validation loss decreased (0.087022 --> 0.086868).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0703442
	speed: 0.0753s/iter; left time: 1234.9448s
	iters: 200, epoch: 27 | loss: 0.0724373
	speed: 0.0416s/iter; left time: 677.8349s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.49s
Steps: 223 | Train Loss: 0.0715412 Vali Loss: 0.0870464 Test Loss: 0.0989664
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0742472
	speed: 0.0774s/iter; left time: 1252.0073s
	iters: 200, epoch: 28 | loss: 0.0691978
	speed: 0.0415s/iter; left time: 666.7333s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.46s
Steps: 223 | Train Loss: 0.0714920 Vali Loss: 0.0870631 Test Loss: 0.0991097
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0707679
	speed: 0.0762s/iter; left time: 1216.6364s
	iters: 200, epoch: 29 | loss: 0.0695740
	speed: 0.0421s/iter; left time: 667.9641s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.53s
Steps: 223 | Train Loss: 0.0714264 Vali Loss: 0.0870037 Test Loss: 0.0989200
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0688290
	speed: 0.0779s/iter; left time: 1225.5661s
	iters: 200, epoch: 30 | loss: 0.0660956
	speed: 0.0414s/iter; left time: 647.5465s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.71s
Steps: 223 | Train Loss: 0.0714084 Vali Loss: 0.0869053 Test Loss: 0.0989998
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0729475
	speed: 0.0776s/iter; left time: 1204.0116s
	iters: 200, epoch: 31 | loss: 0.0695744
	speed: 0.0431s/iter; left time: 664.9611s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.70s
Steps: 223 | Train Loss: 0.0713882 Vali Loss: 0.0870360 Test Loss: 0.0989691
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0672238
	speed: 0.0760s/iter; left time: 1162.2643s
	iters: 200, epoch: 32 | loss: 0.0767676
	speed: 0.0418s/iter; left time: 634.6739s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.61s
Steps: 223 | Train Loss: 0.0714459 Vali Loss: 0.0869485 Test Loss: 0.0989849
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0716598
	speed: 0.0799s/iter; left time: 1203.7757s
	iters: 200, epoch: 33 | loss: 0.0718821
	speed: 0.0415s/iter; left time: 621.6140s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.54s
Steps: 223 | Train Loss: 0.0713694 Vali Loss: 0.0869131 Test Loss: 0.0990300
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0780078
	speed: 0.0773s/iter; left time: 1147.5751s
	iters: 200, epoch: 34 | loss: 0.0725512
	speed: 0.0423s/iter; left time: 623.3525s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.72s
Steps: 223 | Train Loss: 0.0713690 Vali Loss: 0.0870174 Test Loss: 0.0990362
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0721319
	speed: 0.0758s/iter; left time: 1108.1308s
	iters: 200, epoch: 35 | loss: 0.0699476
	speed: 0.0417s/iter; left time: 605.3540s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.53s
Steps: 223 | Train Loss: 0.0713216 Vali Loss: 0.0868933 Test Loss: 0.0989647
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0715593
	speed: 0.0743s/iter; left time: 1068.9621s
	iters: 200, epoch: 36 | loss: 0.0704235
	speed: 0.0422s/iter; left time: 603.2097s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.56s
Steps: 223 | Train Loss: 0.0713195 Vali Loss: 0.0871119 Test Loss: 0.0989298
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.024664107710123062, rmse:0.15704810619354248, mae:0.09895854443311691, rse:0.5417714715003967
Intermediate time for GB and pred_len 24: 00h:14m:36.96s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_512_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1304873
	speed: 0.0668s/iter; left time: 1476.8440s
	iters: 200, epoch: 1 | loss: 0.1175975
	speed: 0.0416s/iter; left time: 914.2991s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.86s
Steps: 222 | Train Loss: 0.1310178 Vali Loss: 0.1288243 Test Loss: 0.1522491
Validation loss decreased (inf --> 0.128824).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1069379
	speed: 0.0775s/iter; left time: 1694.8193s
	iters: 200, epoch: 2 | loss: 0.1099608
	speed: 0.0416s/iter; left time: 905.7148s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.60s
Steps: 222 | Train Loss: 0.1079090 Vali Loss: 0.1167949 Test Loss: 0.1385253
Validation loss decreased (0.128824 --> 0.116795).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1021708
	speed: 0.0785s/iter; left time: 1699.0059s
	iters: 200, epoch: 3 | loss: 0.1059996
	speed: 0.0429s/iter; left time: 924.7170s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.63s
Steps: 222 | Train Loss: 0.1029873 Vali Loss: 0.1158553 Test Loss: 0.1394041
Validation loss decreased (0.116795 --> 0.115855).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0966939
	speed: 0.0764s/iter; left time: 1638.0518s
	iters: 200, epoch: 4 | loss: 0.1026029
	speed: 0.0422s/iter; left time: 900.1555s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.60s
Steps: 222 | Train Loss: 0.1014688 Vali Loss: 0.1153081 Test Loss: 0.1391761
Validation loss decreased (0.115855 --> 0.115308).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1027995
	speed: 0.0787s/iter; left time: 1669.7876s
	iters: 200, epoch: 5 | loss: 0.1021266
	speed: 0.0419s/iter; left time: 885.4373s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.47s
Steps: 222 | Train Loss: 0.1004789 Vali Loss: 0.1146756 Test Loss: 0.1379868
Validation loss decreased (0.115308 --> 0.114676).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0975265
	speed: 0.0800s/iter; left time: 1679.8588s
	iters: 200, epoch: 6 | loss: 0.0993915
	speed: 0.0419s/iter; left time: 875.9623s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.78s
Steps: 222 | Train Loss: 0.0995412 Vali Loss: 0.1150273 Test Loss: 0.1383243
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0968614
	speed: 0.0781s/iter; left time: 1622.8290s
	iters: 200, epoch: 7 | loss: 0.0959852
	speed: 0.0430s/iter; left time: 888.5696s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.75s
Steps: 222 | Train Loss: 0.0986773 Vali Loss: 0.1150765 Test Loss: 0.1379591
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0994884
	speed: 0.0775s/iter; left time: 1591.3927s
	iters: 200, epoch: 8 | loss: 0.0979322
	speed: 0.0417s/iter; left time: 852.2716s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.46s
Steps: 222 | Train Loss: 0.0979208 Vali Loss: 0.1156444 Test Loss: 0.1380379
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0953856
	speed: 0.0769s/iter; left time: 1563.0344s
	iters: 200, epoch: 9 | loss: 0.0962101
	speed: 0.0413s/iter; left time: 836.1973s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.46s
Steps: 222 | Train Loss: 0.0971903 Vali Loss: 0.1157434 Test Loss: 0.1375536
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0941000
	speed: 0.0782s/iter; left time: 1573.0348s
	iters: 200, epoch: 10 | loss: 0.0939218
	speed: 0.0415s/iter; left time: 829.7266s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.53s
Steps: 222 | Train Loss: 0.0965265 Vali Loss: 0.1158402 Test Loss: 0.1391500
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0948607
	speed: 0.0780s/iter; left time: 1551.6565s
	iters: 200, epoch: 11 | loss: 0.0935992
	speed: 0.0417s/iter; left time: 824.7298s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.70s
Steps: 222 | Train Loss: 0.0959107 Vali Loss: 0.1162248 Test Loss: 0.1396610
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0920896
	speed: 0.0750s/iter; left time: 1474.6129s
	iters: 200, epoch: 12 | loss: 0.0940504
	speed: 0.0425s/iter; left time: 830.8932s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.49s
Steps: 222 | Train Loss: 0.0953595 Vali Loss: 0.1159682 Test Loss: 0.1396242
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0913273
	speed: 0.0759s/iter; left time: 1476.0173s
	iters: 200, epoch: 13 | loss: 0.0974089
	speed: 0.0413s/iter; left time: 798.9269s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.47s
Steps: 222 | Train Loss: 0.0947790 Vali Loss: 0.1162849 Test Loss: 0.1413390
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0933513
	speed: 0.0777s/iter; left time: 1493.3694s
	iters: 200, epoch: 14 | loss: 0.0954880
	speed: 0.0418s/iter; left time: 799.7613s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.46s
Steps: 222 | Train Loss: 0.0943125 Vali Loss: 0.1169559 Test Loss: 0.1414862
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0993926
	speed: 0.0776s/iter; left time: 1474.3737s
	iters: 200, epoch: 15 | loss: 0.0961179
	speed: 0.0415s/iter; left time: 783.8649s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.58s
Steps: 222 | Train Loss: 0.0938692 Vali Loss: 0.1164688 Test Loss: 0.1422094
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.040224574506282806, rmse:0.20056064426898956, mae:0.13798677921295166, rse:0.6935666799545288
Use GPU: cuda:0
>>>>>>>start training : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1305858
	speed: 0.0446s/iter; left time: 986.5156s
	iters: 200, epoch: 1 | loss: 0.1279940
	speed: 0.0419s/iter; left time: 920.9347s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.60s
Steps: 222 | Train Loss: 0.1310129 Vali Loss: 0.1287763 Test Loss: 0.1517726
Validation loss decreased (inf --> 0.128776).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1047999
	speed: 0.0773s/iter; left time: 1691.8110s
	iters: 200, epoch: 2 | loss: 0.1011871
	speed: 0.0423s/iter; left time: 922.2551s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.58s
Steps: 222 | Train Loss: 0.1081233 Vali Loss: 0.1171175 Test Loss: 0.1384159
Validation loss decreased (0.128776 --> 0.117118).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1041322
	speed: 0.0768s/iter; left time: 1662.2105s
	iters: 200, epoch: 3 | loss: 0.0997675
	speed: 0.0435s/iter; left time: 936.9470s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.65s
Steps: 222 | Train Loss: 0.1030756 Vali Loss: 0.1154505 Test Loss: 0.1378653
Validation loss decreased (0.117118 --> 0.115451).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1052338
	speed: 0.0782s/iter; left time: 1676.5682s
	iters: 200, epoch: 4 | loss: 0.1011579
	speed: 0.0418s/iter; left time: 891.4297s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.58s
Steps: 222 | Train Loss: 0.1016301 Vali Loss: 0.1150195 Test Loss: 0.1379458
Validation loss decreased (0.115451 --> 0.115019).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0983982
	speed: 0.0802s/iter; left time: 1702.1037s
	iters: 200, epoch: 5 | loss: 0.0970867
	speed: 0.0416s/iter; left time: 877.6973s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.47s
Steps: 222 | Train Loss: 0.1004418 Vali Loss: 0.1147584 Test Loss: 0.1383713
Validation loss decreased (0.115019 --> 0.114758).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1006362
	speed: 0.0793s/iter; left time: 1664.9695s
	iters: 200, epoch: 6 | loss: 0.0965790
	speed: 0.0416s/iter; left time: 868.5655s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.68s
Steps: 222 | Train Loss: 0.0992838 Vali Loss: 0.1148322 Test Loss: 0.1393588
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0966187
	speed: 0.0767s/iter; left time: 1593.1368s
	iters: 200, epoch: 7 | loss: 0.0989298
	speed: 0.0425s/iter; left time: 878.9518s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.63s
Steps: 222 | Train Loss: 0.0983812 Vali Loss: 0.1146387 Test Loss: 0.1399318
Validation loss decreased (0.114758 --> 0.114639).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0930875
	speed: 0.0778s/iter; left time: 1598.6296s
	iters: 200, epoch: 8 | loss: 0.0929199
	speed: 0.0429s/iter; left time: 877.4482s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.66s
Steps: 222 | Train Loss: 0.0972934 Vali Loss: 0.1146473 Test Loss: 0.1403886
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0951188
	speed: 0.0772s/iter; left time: 1568.9761s
	iters: 200, epoch: 9 | loss: 0.0949333
	speed: 0.0414s/iter; left time: 838.0335s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.49s
Steps: 222 | Train Loss: 0.0964337 Vali Loss: 0.1151828 Test Loss: 0.1416367
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0989180
	speed: 0.0785s/iter; left time: 1577.9541s
	iters: 200, epoch: 10 | loss: 0.0938160
	speed: 0.0416s/iter; left time: 831.2552s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.47s
Steps: 222 | Train Loss: 0.0956362 Vali Loss: 0.1152233 Test Loss: 0.1418035
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0915988
	speed: 0.0785s/iter; left time: 1560.3960s
	iters: 200, epoch: 11 | loss: 0.0964191
	speed: 0.0415s/iter; left time: 820.2697s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.68s
Steps: 222 | Train Loss: 0.0949925 Vali Loss: 0.1158287 Test Loss: 0.1423944
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0963742
	speed: 0.0773s/iter; left time: 1519.4097s
	iters: 200, epoch: 12 | loss: 0.0933959
	speed: 0.0423s/iter; left time: 827.7180s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.60s
Steps: 222 | Train Loss: 0.0941572 Vali Loss: 0.1160542 Test Loss: 0.1424110
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0961953
	speed: 0.0762s/iter; left time: 1480.6556s
	iters: 200, epoch: 13 | loss: 0.0965029
	speed: 0.0421s/iter; left time: 814.5173s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.49s
Steps: 222 | Train Loss: 0.0936945 Vali Loss: 0.1154687 Test Loss: 0.1416178
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0912792
	speed: 0.0774s/iter; left time: 1486.3895s
	iters: 200, epoch: 14 | loss: 0.0940753
	speed: 0.0413s/iter; left time: 789.0238s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.51s
Steps: 222 | Train Loss: 0.0929719 Vali Loss: 0.1157708 Test Loss: 0.1427507
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0968269
	speed: 0.0794s/iter; left time: 1507.9914s
	iters: 200, epoch: 15 | loss: 0.0915315
	speed: 0.0417s/iter; left time: 787.6881s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.45s
Steps: 222 | Train Loss: 0.0925117 Vali Loss: 0.1161520 Test Loss: 0.1430477
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0888845
	speed: 0.0785s/iter; left time: 1474.0309s
	iters: 200, epoch: 16 | loss: 0.0930691
	speed: 0.0414s/iter; left time: 772.2440s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.65s
Steps: 222 | Train Loss: 0.0921011 Vali Loss: 0.1164447 Test Loss: 0.1432250
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0904549
	speed: 0.0771s/iter; left time: 1431.0215s
	iters: 200, epoch: 17 | loss: 0.0925897
	speed: 0.0430s/iter; left time: 792.9510s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.63s
Steps: 222 | Train Loss: 0.0916482 Vali Loss: 0.1165479 Test Loss: 0.1434288
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.041966523975133896, rmse:0.20485731959342957, mae:0.13993188738822937, rse:0.7084251642227173
Intermediate time for GB and pred_len 96: 00h:06m:36.25s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_512_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1260497
	speed: 0.0661s/iter; left time: 1461.0643s
	iters: 200, epoch: 1 | loss: 0.1233853
	speed: 0.0420s/iter; left time: 924.4995s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.85s
Steps: 222 | Train Loss: 0.1326778 Vali Loss: 0.1309269 Test Loss: 0.1548633
Validation loss decreased (inf --> 0.130927).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1094469
	speed: 0.0794s/iter; left time: 1737.2973s
	iters: 200, epoch: 2 | loss: 0.1086948
	speed: 0.0417s/iter; left time: 908.1966s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.60s
Steps: 222 | Train Loss: 0.1121342 Vali Loss: 0.1213708 Test Loss: 0.1448956
Validation loss decreased (0.130927 --> 0.121371).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1085828
	speed: 0.0805s/iter; left time: 1744.2921s
	iters: 200, epoch: 3 | loss: 0.1110668
	speed: 0.0420s/iter; left time: 905.8066s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.68s
Steps: 222 | Train Loss: 0.1075699 Vali Loss: 0.1199603 Test Loss: 0.1443719
Validation loss decreased (0.121371 --> 0.119960).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1096162
	speed: 0.0780s/iter; left time: 1671.4152s
	iters: 200, epoch: 4 | loss: 0.1028981
	speed: 0.0438s/iter; left time: 934.7668s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.71s
Steps: 222 | Train Loss: 0.1060007 Vali Loss: 0.1197756 Test Loss: 0.1440592
Validation loss decreased (0.119960 --> 0.119776).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1043223
	speed: 0.0785s/iter; left time: 1664.7745s
	iters: 200, epoch: 5 | loss: 0.1071000
	speed: 0.0431s/iter; left time: 908.9659s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.70s
Steps: 222 | Train Loss: 0.1046242 Vali Loss: 0.1203860 Test Loss: 0.1448624
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0994743
	speed: 0.0777s/iter; left time: 1630.2978s
	iters: 200, epoch: 6 | loss: 0.1044898
	speed: 0.0422s/iter; left time: 881.8174s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.53s
Steps: 222 | Train Loss: 0.1033739 Vali Loss: 0.1210232 Test Loss: 0.1450372
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1018771
	speed: 0.0785s/iter; left time: 1630.0362s
	iters: 200, epoch: 7 | loss: 0.1027877
	speed: 0.0421s/iter; left time: 869.4557s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.54s
Steps: 222 | Train Loss: 0.1023430 Vali Loss: 0.1218093 Test Loss: 0.1471738
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0995843
	speed: 0.0778s/iter; left time: 1599.1551s
	iters: 200, epoch: 8 | loss: 0.0966036
	speed: 0.0417s/iter; left time: 853.5215s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.70s
Steps: 222 | Train Loss: 0.1014311 Vali Loss: 0.1216973 Test Loss: 0.1467350
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1010340
	speed: 0.0765s/iter; left time: 1554.9552s
	iters: 200, epoch: 9 | loss: 0.1001390
	speed: 0.0433s/iter; left time: 875.0557s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.69s
Steps: 222 | Train Loss: 0.1004857 Vali Loss: 0.1226195 Test Loss: 0.1462484
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0983590
	speed: 0.0768s/iter; left time: 1543.3019s
	iters: 200, epoch: 10 | loss: 0.0999743
	speed: 0.0422s/iter; left time: 844.8185s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.56s
Steps: 222 | Train Loss: 0.0997015 Vali Loss: 0.1216679 Test Loss: 0.1459581
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1025495
	speed: 0.0789s/iter; left time: 1567.7444s
	iters: 200, epoch: 11 | loss: 0.0974560
	speed: 0.0419s/iter; left time: 828.6228s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.61s
Steps: 222 | Train Loss: 0.0988213 Vali Loss: 0.1222738 Test Loss: 0.1464456
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1022936
	speed: 0.0794s/iter; left time: 1561.1810s
	iters: 200, epoch: 12 | loss: 0.0971468
	speed: 0.0421s/iter; left time: 823.0657s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.69s
Steps: 222 | Train Loss: 0.0980070 Vali Loss: 0.1221250 Test Loss: 0.1460842
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0957897
	speed: 0.0791s/iter; left time: 1537.1685s
	iters: 200, epoch: 13 | loss: 0.0973659
	speed: 0.0420s/iter; left time: 811.4997s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.76s
Steps: 222 | Train Loss: 0.0972951 Vali Loss: 0.1227004 Test Loss: 0.1479962
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0920695
	speed: 0.0766s/iter; left time: 1471.0401s
	iters: 200, epoch: 14 | loss: 0.0948682
	speed: 0.0431s/iter; left time: 823.2108s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.70s
Steps: 222 | Train Loss: 0.0966523 Vali Loss: 0.1230309 Test Loss: 0.1473147
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04283905029296875, rmse:0.20697596669197083, mae:0.14405910670757294, rse:0.7176154255867004
Use GPU: cuda:0
>>>>>>>start training : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1354174
	speed: 0.0440s/iter; left time: 971.9497s
	iters: 200, epoch: 1 | loss: 0.1272134
	speed: 0.0429s/iter; left time: 944.6074s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.66s
Steps: 222 | Train Loss: 0.1335480 Vali Loss: 0.1309509 Test Loss: 0.1545976
Validation loss decreased (inf --> 0.130951).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1133488
	speed: 0.0801s/iter; left time: 1753.2463s
	iters: 200, epoch: 2 | loss: 0.1126153
	speed: 0.0433s/iter; left time: 942.9559s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.86s
Steps: 222 | Train Loss: 0.1122327 Vali Loss: 0.1214331 Test Loss: 0.1448028
Validation loss decreased (0.130951 --> 0.121433).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1069784
	speed: 0.0798s/iter; left time: 1727.5802s
	iters: 200, epoch: 3 | loss: 0.1111818
	speed: 0.0419s/iter; left time: 903.1948s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.56s
Steps: 222 | Train Loss: 0.1077125 Vali Loss: 0.1202011 Test Loss: 0.1457766
Validation loss decreased (0.121433 --> 0.120201).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1072374
	speed: 0.0850s/iter; left time: 1821.7096s
	iters: 200, epoch: 4 | loss: 0.1061509
	speed: 0.0422s/iter; left time: 901.2968s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.74s
Steps: 222 | Train Loss: 0.1062208 Vali Loss: 0.1202800 Test Loss: 0.1458177
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1077023
	speed: 0.0798s/iter; left time: 1693.2286s
	iters: 200, epoch: 5 | loss: 0.1043039
	speed: 0.0420s/iter; left time: 886.4168s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.76s
Steps: 222 | Train Loss: 0.1048119 Vali Loss: 0.1204090 Test Loss: 0.1450815
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1053132
	speed: 0.0778s/iter; left time: 1633.7682s
	iters: 200, epoch: 6 | loss: 0.1045556
	speed: 0.0430s/iter; left time: 897.6966s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.68s
Steps: 222 | Train Loss: 0.1033933 Vali Loss: 0.1211432 Test Loss: 0.1460922
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1010433
	speed: 0.0777s/iter; left time: 1614.5203s
	iters: 200, epoch: 7 | loss: 0.0984273
	speed: 0.0427s/iter; left time: 883.2299s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.63s
Steps: 222 | Train Loss: 0.1019883 Vali Loss: 0.1219406 Test Loss: 0.1475383
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1020061
	speed: 0.0777s/iter; left time: 1596.4580s
	iters: 200, epoch: 8 | loss: 0.0999632
	speed: 0.0422s/iter; left time: 862.7162s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.70s
Steps: 222 | Train Loss: 0.1006895 Vali Loss: 0.1223867 Test Loss: 0.1473340
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0978350
	speed: 0.0805s/iter; left time: 1636.4255s
	iters: 200, epoch: 9 | loss: 0.0947712
	speed: 0.0417s/iter; left time: 843.6268s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.51s
Steps: 222 | Train Loss: 0.0993827 Vali Loss: 0.1230524 Test Loss: 0.1467847
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0975076
	speed: 0.0788s/iter; left time: 1583.7119s
	iters: 200, epoch: 10 | loss: 0.0976299
	speed: 0.0428s/iter; left time: 856.6663s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.74s
Steps: 222 | Train Loss: 0.0981397 Vali Loss: 0.1236404 Test Loss: 0.1466535
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0939989
	speed: 0.0793s/iter; left time: 1575.7932s
	iters: 200, epoch: 11 | loss: 0.0989537
	speed: 0.0428s/iter; left time: 846.7825s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.80s
Steps: 222 | Train Loss: 0.0970986 Vali Loss: 0.1238450 Test Loss: 0.1473410
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0958038
	speed: 0.0792s/iter; left time: 1556.7527s
	iters: 200, epoch: 12 | loss: 0.0997026
	speed: 0.0424s/iter; left time: 829.6332s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.64s
Steps: 222 | Train Loss: 0.0961723 Vali Loss: 0.1241202 Test Loss: 0.1478169
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0963423
	speed: 0.0793s/iter; left time: 1542.2571s
	iters: 200, epoch: 13 | loss: 0.0922489
	speed: 0.0446s/iter; left time: 861.7742s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.90s
Steps: 222 | Train Loss: 0.0953029 Vali Loss: 0.1242875 Test Loss: 0.1478923
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.0440988764166832, rmse:0.20999732613563538, mae:0.14577659964561462, rse:0.7280909419059753
Intermediate time for GB and pred_len 168: 00h:05m:42.00sIntermediate time for GB: 00h:26m:55.22s
=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_512_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_512_24_ES_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1177848
	speed: 0.0475s/iter; left time: 1054.6867s
	iters: 200, epoch: 1 | loss: 0.1059930
	speed: 0.0268s/iter; left time: 591.6345s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.47s
Steps: 223 | Train Loss: 0.1258416 Vali Loss: 0.0933806 Test Loss: 0.1067235
Validation loss decreased (inf --> 0.093381).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0721758
	speed: 0.0526s/iter; left time: 1155.1685s
	iters: 200, epoch: 2 | loss: 0.0688074
	speed: 0.0265s/iter; left time: 578.9755s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.0746695 Vali Loss: 0.0630054 Test Loss: 0.0701760
Validation loss decreased (0.093381 --> 0.063005).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0640021
	speed: 0.0541s/iter; left time: 1177.7243s
	iters: 200, epoch: 3 | loss: 0.0631628
	speed: 0.0266s/iter; left time: 575.9124s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.23s
Steps: 223 | Train Loss: 0.0643662 Vali Loss: 0.0596727 Test Loss: 0.0664817
Validation loss decreased (0.063005 --> 0.059673).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0633358
	speed: 0.0522s/iter; left time: 1123.8531s
	iters: 200, epoch: 4 | loss: 0.0598588
	speed: 0.0274s/iter; left time: 587.3806s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.0616559 Vali Loss: 0.0577069 Test Loss: 0.0649258
Validation loss decreased (0.059673 --> 0.057707).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0600730
	speed: 0.0542s/iter; left time: 1154.8282s
	iters: 200, epoch: 5 | loss: 0.0604561
	speed: 0.0269s/iter; left time: 569.8563s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.23s
Steps: 223 | Train Loss: 0.0598165 Vali Loss: 0.0575377 Test Loss: 0.0640054
Validation loss decreased (0.057707 --> 0.057538).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0562785
	speed: 0.0525s/iter; left time: 1107.4072s
	iters: 200, epoch: 6 | loss: 0.0579553
	speed: 0.0270s/iter; left time: 566.9038s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.0587862 Vali Loss: 0.0562634 Test Loss: 0.0629574
Validation loss decreased (0.057538 --> 0.056263).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0542753
	speed: 0.0552s/iter; left time: 1152.4921s
	iters: 200, epoch: 7 | loss: 0.0573975
	speed: 0.0267s/iter; left time: 554.9892s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.0578910 Vali Loss: 0.0557560 Test Loss: 0.0622238
Validation loss decreased (0.056263 --> 0.055756).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0539824
	speed: 0.0533s/iter; left time: 1100.2134s
	iters: 200, epoch: 8 | loss: 0.0542981
	speed: 0.0279s/iter; left time: 572.1662s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.41s
Steps: 223 | Train Loss: 0.0572106 Vali Loss: 0.0555416 Test Loss: 0.0623640
Validation loss decreased (0.055756 --> 0.055542).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0544912
	speed: 0.0526s/iter; left time: 1073.0902s
	iters: 200, epoch: 9 | loss: 0.0562044
	speed: 0.0275s/iter; left time: 558.0722s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.20s
Steps: 223 | Train Loss: 0.0565972 Vali Loss: 0.0552657 Test Loss: 0.0625549
Validation loss decreased (0.055542 --> 0.055266).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0573178
	speed: 0.0530s/iter; left time: 1070.0248s
	iters: 200, epoch: 10 | loss: 0.0550786
	speed: 0.0288s/iter; left time: 577.9575s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.43s
Steps: 223 | Train Loss: 0.0561248 Vali Loss: 0.0548072 Test Loss: 0.0617649
Validation loss decreased (0.055266 --> 0.054807).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0549671
	speed: 0.0519s/iter; left time: 1037.4837s
	iters: 200, epoch: 11 | loss: 0.0561140
	speed: 0.0264s/iter; left time: 525.1469s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.11s
Steps: 223 | Train Loss: 0.0556483 Vali Loss: 0.0546315 Test Loss: 0.0615806
Validation loss decreased (0.054807 --> 0.054632).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0561196
	speed: 0.0520s/iter; left time: 1025.9605s
	iters: 200, epoch: 12 | loss: 0.0555787
	speed: 0.0272s/iter; left time: 533.7141s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.20s
Steps: 223 | Train Loss: 0.0552293 Vali Loss: 0.0543794 Test Loss: 0.0613876
Validation loss decreased (0.054632 --> 0.054379).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0533709
	speed: 0.0533s/iter; left time: 1041.6509s
	iters: 200, epoch: 13 | loss: 0.0539893
	speed: 0.0267s/iter; left time: 517.7904s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.20s
Steps: 223 | Train Loss: 0.0549254 Vali Loss: 0.0543318 Test Loss: 0.0609576
Validation loss decreased (0.054379 --> 0.054332).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0530030
	speed: 0.0521s/iter; left time: 1006.1253s
	iters: 200, epoch: 14 | loss: 0.0533630
	speed: 0.0285s/iter; left time: 547.7245s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.39s
Steps: 223 | Train Loss: 0.0545588 Vali Loss: 0.0541453 Test Loss: 0.0611451
Validation loss decreased (0.054332 --> 0.054145).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0500635
	speed: 0.0516s/iter; left time: 985.3657s
	iters: 200, epoch: 15 | loss: 0.0591192
	speed: 0.0266s/iter; left time: 504.5599s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.13s
Steps: 223 | Train Loss: 0.0543057 Vali Loss: 0.0539221 Test Loss: 0.0611182
Validation loss decreased (0.054145 --> 0.053922).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0566576
	speed: 0.0524s/iter; left time: 987.9545s
	iters: 200, epoch: 16 | loss: 0.0502781
	speed: 0.0268s/iter; left time: 502.5444s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.0540829 Vali Loss: 0.0538061 Test Loss: 0.0607462
Validation loss decreased (0.053922 --> 0.053806).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0566290
	speed: 0.0521s/iter; left time: 971.4521s
	iters: 200, epoch: 17 | loss: 0.0503884
	speed: 0.0265s/iter; left time: 490.8331s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.19s
Steps: 223 | Train Loss: 0.0539302 Vali Loss: 0.0534953 Test Loss: 0.0605199
Validation loss decreased (0.053806 --> 0.053495).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0572149
	speed: 0.0537s/iter; left time: 988.0298s
	iters: 200, epoch: 18 | loss: 0.0543917
	speed: 0.0265s/iter; left time: 485.8873s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.26s
Steps: 223 | Train Loss: 0.0537375 Vali Loss: 0.0535588 Test Loss: 0.0605998
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0552805
	speed: 0.0514s/iter; left time: 935.1159s
	iters: 200, epoch: 19 | loss: 0.0523237
	speed: 0.0263s/iter; left time: 474.8411s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.12s
Steps: 223 | Train Loss: 0.0535796 Vali Loss: 0.0535295 Test Loss: 0.0603616
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0545848
	speed: 0.0537s/iter; left time: 965.2525s
	iters: 200, epoch: 20 | loss: 0.0549286
	speed: 0.0268s/iter; left time: 478.0525s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.0534138 Vali Loss: 0.0532950 Test Loss: 0.0604182
Validation loss decreased (0.053495 --> 0.053295).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0529836
	speed: 0.0532s/iter; left time: 944.3567s
	iters: 200, epoch: 21 | loss: 0.0538217
	speed: 0.0264s/iter; left time: 465.1661s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.13s
Steps: 223 | Train Loss: 0.0533455 Vali Loss: 0.0530735 Test Loss: 0.0601349
Validation loss decreased (0.053295 --> 0.053073).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0533596
	speed: 0.0563s/iter; left time: 986.5509s
	iters: 200, epoch: 22 | loss: 0.0551906
	speed: 0.0264s/iter; left time: 459.7246s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.0531747 Vali Loss: 0.0531457 Test Loss: 0.0603495
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0533368
	speed: 0.0512s/iter; left time: 885.7195s
	iters: 200, epoch: 23 | loss: 0.0566950
	speed: 0.0280s/iter; left time: 481.0885s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.24s
Steps: 223 | Train Loss: 0.0530683 Vali Loss: 0.0531179 Test Loss: 0.0601824
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0560505
	speed: 0.0540s/iter; left time: 922.4103s
	iters: 200, epoch: 24 | loss: 0.0509092
	speed: 0.0274s/iter; left time: 465.6859s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.23s
Steps: 223 | Train Loss: 0.0529976 Vali Loss: 0.0531084 Test Loss: 0.0601074
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0558175
	speed: 0.0519s/iter; left time: 873.8136s
	iters: 200, epoch: 25 | loss: 0.0517861
	speed: 0.0268s/iter; left time: 449.0302s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.15s
Steps: 223 | Train Loss: 0.0529033 Vali Loss: 0.0531205 Test Loss: 0.0602300
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0513149
	speed: 0.0511s/iter; left time: 849.6052s
	iters: 200, epoch: 26 | loss: 0.0500016
	speed: 0.0263s/iter; left time: 434.1711s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.04s
Steps: 223 | Train Loss: 0.0528154 Vali Loss: 0.0529059 Test Loss: 0.0601533
Validation loss decreased (0.053073 --> 0.052906).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0518654
	speed: 0.0519s/iter; left time: 851.0316s
	iters: 200, epoch: 27 | loss: 0.0523646
	speed: 0.0278s/iter; left time: 453.0433s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.26s
Steps: 223 | Train Loss: 0.0527788 Vali Loss: 0.0531640 Test Loss: 0.0602123
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0533427
	speed: 0.0525s/iter; left time: 849.6665s
	iters: 200, epoch: 28 | loss: 0.0546841
	speed: 0.0264s/iter; left time: 424.9276s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.16s
Steps: 223 | Train Loss: 0.0527124 Vali Loss: 0.0528726 Test Loss: 0.0599036
Validation loss decreased (0.052906 --> 0.052873).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0509959
	speed: 0.0522s/iter; left time: 833.0148s
	iters: 200, epoch: 29 | loss: 0.0543811
	speed: 0.0274s/iter; left time: 435.2259s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.0526367 Vali Loss: 0.0528099 Test Loss: 0.0598749
Validation loss decreased (0.052873 --> 0.052810).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0536711
	speed: 0.0540s/iter; left time: 849.1549s
	iters: 200, epoch: 30 | loss: 0.0521599
	speed: 0.0265s/iter; left time: 414.3454s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.13s
Steps: 223 | Train Loss: 0.0525897 Vali Loss: 0.0528667 Test Loss: 0.0601898
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0525367
	speed: 0.0504s/iter; left time: 781.6923s
	iters: 200, epoch: 31 | loss: 0.0528346
	speed: 0.0267s/iter; left time: 411.9359s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.13s
Steps: 223 | Train Loss: 0.0525614 Vali Loss: 0.0528139 Test Loss: 0.0600230
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0510059
	speed: 0.0549s/iter; left time: 839.7299s
	iters: 200, epoch: 32 | loss: 0.0555225
	speed: 0.0267s/iter; left time: 405.4120s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.27s
Steps: 223 | Train Loss: 0.0525297 Vali Loss: 0.0528147 Test Loss: 0.0600315
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0553756
	speed: 0.0517s/iter; left time: 778.7115s
	iters: 200, epoch: 33 | loss: 0.0561647
	speed: 0.0269s/iter; left time: 402.9765s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.17s
Steps: 223 | Train Loss: 0.0524675 Vali Loss: 0.0527943 Test Loss: 0.0599646
Validation loss decreased (0.052810 --> 0.052794).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0547888
	speed: 0.0546s/iter; left time: 810.3476s
	iters: 200, epoch: 34 | loss: 0.0502540
	speed: 0.0264s/iter; left time: 389.8042s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.19s
Steps: 223 | Train Loss: 0.0524123 Vali Loss: 0.0527812 Test Loss: 0.0600052
Validation loss decreased (0.052794 --> 0.052781).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0539715
	speed: 0.0522s/iter; left time: 763.3288s
	iters: 200, epoch: 35 | loss: 0.0542529
	speed: 0.0288s/iter; left time: 417.9559s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.40s
Steps: 223 | Train Loss: 0.0523824 Vali Loss: 0.0526560 Test Loss: 0.0598498
Validation loss decreased (0.052781 --> 0.052656).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0540629
	speed: 0.0551s/iter; left time: 793.6323s
	iters: 200, epoch: 36 | loss: 0.0535191
	speed: 0.0267s/iter; left time: 381.9144s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.22s
Steps: 223 | Train Loss: 0.0523539 Vali Loss: 0.0526808 Test Loss: 0.0598498
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0506244
	speed: 0.0521s/iter; left time: 738.5504s
	iters: 200, epoch: 37 | loss: 0.0530473
	speed: 0.0274s/iter; left time: 385.9141s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.0523549 Vali Loss: 0.0526425 Test Loss: 0.0598658
Validation loss decreased (0.052656 --> 0.052643).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0527134
	speed: 0.0556s/iter; left time: 775.5018s
	iters: 200, epoch: 38 | loss: 0.0536440
	speed: 0.0265s/iter; left time: 366.8005s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.21s
Steps: 223 | Train Loss: 0.0523354 Vali Loss: 0.0528015 Test Loss: 0.0598641
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0523238
	speed: 0.0513s/iter; left time: 704.6534s
	iters: 200, epoch: 39 | loss: 0.0517573
	speed: 0.0294s/iter; left time: 400.9276s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.41s
Steps: 223 | Train Loss: 0.0523230 Vali Loss: 0.0526925 Test Loss: 0.0598390
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0538465
	speed: 0.0518s/iter; left time: 699.8013s
	iters: 200, epoch: 40 | loss: 0.0512804
	speed: 0.0268s/iter; left time: 359.0913s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.15s
Steps: 223 | Train Loss: 0.0522718 Vali Loss: 0.0526854 Test Loss: 0.0598257
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0530373
	speed: 0.0519s/iter; left time: 689.1349s
	iters: 200, epoch: 41 | loss: 0.0532438
	speed: 0.0281s/iter; left time: 370.3300s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.0522268 Vali Loss: 0.0526668 Test Loss: 0.0599239
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0498807
	speed: 0.0514s/iter; left time: 670.6596s
	iters: 200, epoch: 42 | loss: 0.0523962
	speed: 0.0267s/iter; left time: 346.4268s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.16s
Steps: 223 | Train Loss: 0.0522847 Vali Loss: 0.0526407 Test Loss: 0.0598294
Validation loss decreased (0.052643 --> 0.052641).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0534996
	speed: 0.0540s/iter; left time: 692.4492s
	iters: 200, epoch: 43 | loss: 0.0532958
	speed: 0.0271s/iter; left time: 345.1474s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.35s
Steps: 223 | Train Loss: 0.0523306 Vali Loss: 0.0525946 Test Loss: 0.0597619
Validation loss decreased (0.052641 --> 0.052595).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0526985
	speed: 0.0521s/iter; left time: 656.6391s
	iters: 200, epoch: 44 | loss: 0.0511877
	speed: 0.0270s/iter; left time: 337.4740s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.17s
Steps: 223 | Train Loss: 0.0521692 Vali Loss: 0.0526428 Test Loss: 0.0597727
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0556191
	speed: 0.0533s/iter; left time: 660.9343s
	iters: 200, epoch: 45 | loss: 0.0514222
	speed: 0.0284s/iter; left time: 349.0831s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.43s
Steps: 223 | Train Loss: 0.0522454 Vali Loss: 0.0526971 Test Loss: 0.0597938
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0529044
	speed: 0.0522s/iter; left time: 635.0330s
	iters: 200, epoch: 46 | loss: 0.0533347
	speed: 0.0263s/iter; left time: 316.8991s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.10s
Steps: 223 | Train Loss: 0.0522511 Vali Loss: 0.0526150 Test Loss: 0.0598379
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0525579
	speed: 0.0556s/iter; left time: 663.7137s
	iters: 200, epoch: 47 | loss: 0.0559584
	speed: 0.0270s/iter; left time: 319.5735s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.0522442 Vali Loss: 0.0526613 Test Loss: 0.0597907
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0522379
	speed: 0.0513s/iter; left time: 601.7284s
	iters: 200, epoch: 48 | loss: 0.0542752
	speed: 0.0267s/iter; left time: 310.0350s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.14s
Steps: 223 | Train Loss: 0.0521854 Vali Loss: 0.0526289 Test Loss: 0.0597892
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0549363
	speed: 0.0526s/iter; left time: 604.4033s
	iters: 200, epoch: 49 | loss: 0.0465775
	speed: 0.0264s/iter; left time: 300.7727s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.20s
Steps: 223 | Train Loss: 0.0522630 Vali Loss: 0.0526140 Test Loss: 0.0598117
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0494051
	speed: 0.0507s/iter; left time: 571.0883s
	iters: 200, epoch: 50 | loss: 0.0522640
	speed: 0.0267s/iter; left time: 298.0243s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.11s
Steps: 223 | Train Loss: 0.0522751 Vali Loss: 0.0526901 Test Loss: 0.0599105
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0573033
	speed: 0.0538s/iter; left time: 594.8035s
	iters: 200, epoch: 51 | loss: 0.0508314
	speed: 0.0268s/iter; left time: 293.2057s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.26s
Steps: 223 | Train Loss: 0.0521932 Vali Loss: 0.0526688 Test Loss: 0.0598051
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0495923
	speed: 0.0525s/iter; left time: 568.0226s
	iters: 200, epoch: 52 | loss: 0.0519124
	speed: 0.0267s/iter; left time: 286.9072s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.0522027 Vali Loss: 0.0526402 Test Loss: 0.0598215
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0548224
	speed: 0.0537s/iter; left time: 569.8401s
	iters: 200, epoch: 53 | loss: 0.0511640
	speed: 0.0267s/iter; left time: 280.9340s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.21s
Steps: 223 | Train Loss: 0.0521802 Vali Loss: 0.0526538 Test Loss: 0.0598073
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_512_24_ES_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009856260381639004, rmse:0.09927870333194733, mae:0.059761930257081985, rse:0.29216518998146057
Use GPU: cuda:0
>>>>>>>start training : ES_512_24_ES_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1225064
	speed: 0.0293s/iter; left time: 649.8441s
	iters: 200, epoch: 1 | loss: 0.1018515
	speed: 0.0285s/iter; left time: 630.7153s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.42s
Steps: 223 | Train Loss: 0.1260264 Vali Loss: 0.0930495 Test Loss: 0.1065131
Validation loss decreased (inf --> 0.093049).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0733656
	speed: 0.0531s/iter; left time: 1166.1485s
	iters: 200, epoch: 2 | loss: 0.0689993
	speed: 0.0264s/iter; left time: 578.3729s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.24s
Steps: 223 | Train Loss: 0.0747297 Vali Loss: 0.0627035 Test Loss: 0.0696848
Validation loss decreased (0.093049 --> 0.062703).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0641976
	speed: 0.0527s/iter; left time: 1147.3285s
	iters: 200, epoch: 3 | loss: 0.0600092
	speed: 0.0267s/iter; left time: 577.7575s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.21s
Steps: 223 | Train Loss: 0.0643813 Vali Loss: 0.0594397 Test Loss: 0.0659568
Validation loss decreased (0.062703 --> 0.059440).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0578316
	speed: 0.0529s/iter; left time: 1139.9557s
	iters: 200, epoch: 4 | loss: 0.0639258
	speed: 0.0266s/iter; left time: 570.1623s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.14s
Steps: 223 | Train Loss: 0.0614354 Vali Loss: 0.0580388 Test Loss: 0.0646078
Validation loss decreased (0.059440 --> 0.058039).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0601949
	speed: 0.0529s/iter; left time: 1127.1254s
	iters: 200, epoch: 5 | loss: 0.0646062
	speed: 0.0263s/iter; left time: 557.4764s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.22s
Steps: 223 | Train Loss: 0.0598467 Vali Loss: 0.0574702 Test Loss: 0.0642393
Validation loss decreased (0.058039 --> 0.057470).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0582525
	speed: 0.0531s/iter; left time: 1120.5297s
	iters: 200, epoch: 6 | loss: 0.0598998
	speed: 0.0264s/iter; left time: 554.6506s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.16s
Steps: 223 | Train Loss: 0.0587508 Vali Loss: 0.0564080 Test Loss: 0.0630445
Validation loss decreased (0.057470 --> 0.056408).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0556834
	speed: 0.0529s/iter; left time: 1104.6372s
	iters: 200, epoch: 7 | loss: 0.0605512
	speed: 0.0266s/iter; left time: 552.5662s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.20s
Steps: 223 | Train Loss: 0.0577860 Vali Loss: 0.0561291 Test Loss: 0.0630853
Validation loss decreased (0.056408 --> 0.056129).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0619714
	speed: 0.0538s/iter; left time: 1110.8849s
	iters: 200, epoch: 8 | loss: 0.0560631
	speed: 0.0274s/iter; left time: 563.5240s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.27s
Steps: 223 | Train Loss: 0.0570553 Vali Loss: 0.0551744 Test Loss: 0.0620771
Validation loss decreased (0.056129 --> 0.055174).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0543769
	speed: 0.0527s/iter; left time: 1076.3225s
	iters: 200, epoch: 9 | loss: 0.0573231
	speed: 0.0267s/iter; left time: 542.2340s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.19s
Steps: 223 | Train Loss: 0.0564490 Vali Loss: 0.0553923 Test Loss: 0.0621985
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0564896
	speed: 0.0536s/iter; left time: 1082.7952s
	iters: 200, epoch: 10 | loss: 0.0550005
	speed: 0.0266s/iter; left time: 533.9927s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.0559311 Vali Loss: 0.0548954 Test Loss: 0.0616808
Validation loss decreased (0.055174 --> 0.054895).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0559047
	speed: 0.0522s/iter; left time: 1042.0117s
	iters: 200, epoch: 11 | loss: 0.0561010
	speed: 0.0267s/iter; left time: 530.0711s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.15s
Steps: 223 | Train Loss: 0.0554993 Vali Loss: 0.0547145 Test Loss: 0.0616678
Validation loss decreased (0.054895 --> 0.054715).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0549887
	speed: 0.0530s/iter; left time: 1046.4545s
	iters: 200, epoch: 12 | loss: 0.0535350
	speed: 0.0274s/iter; left time: 537.5358s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.0550779 Vali Loss: 0.0541503 Test Loss: 0.0611615
Validation loss decreased (0.054715 --> 0.054150).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0564112
	speed: 0.0521s/iter; left time: 1016.2813s
	iters: 200, epoch: 13 | loss: 0.0547302
	speed: 0.0267s/iter; left time: 518.3134s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.18s
Steps: 223 | Train Loss: 0.0548484 Vali Loss: 0.0540437 Test Loss: 0.0611038
Validation loss decreased (0.054150 --> 0.054044).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0563114
	speed: 0.0555s/iter; left time: 1071.2768s
	iters: 200, epoch: 14 | loss: 0.0546800
	speed: 0.0265s/iter; left time: 508.9484s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.18s
Steps: 223 | Train Loss: 0.0545632 Vali Loss: 0.0538223 Test Loss: 0.0608727
Validation loss decreased (0.054044 --> 0.053822).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0582940
	speed: 0.0523s/iter; left time: 997.0774s
	iters: 200, epoch: 15 | loss: 0.0569442
	speed: 0.0268s/iter; left time: 507.9737s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.17s
Steps: 223 | Train Loss: 0.0542870 Vali Loss: 0.0536832 Test Loss: 0.0606616
Validation loss decreased (0.053822 --> 0.053683).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0569478
	speed: 0.0532s/iter; left time: 1003.7836s
	iters: 200, epoch: 16 | loss: 0.0538614
	speed: 0.0274s/iter; left time: 513.2290s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.0540642 Vali Loss: 0.0534916 Test Loss: 0.0607154
Validation loss decreased (0.053683 --> 0.053492).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0559539
	speed: 0.0518s/iter; left time: 965.5459s
	iters: 200, epoch: 17 | loss: 0.0532772
	speed: 0.0265s/iter; left time: 491.9789s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.18s
Steps: 223 | Train Loss: 0.0538495 Vali Loss: 0.0537074 Test Loss: 0.0608297
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0547949
	speed: 0.0536s/iter; left time: 986.6825s
	iters: 200, epoch: 18 | loss: 0.0560665
	speed: 0.0266s/iter; left time: 486.9421s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.17s
Steps: 223 | Train Loss: 0.0536505 Vali Loss: 0.0534455 Test Loss: 0.0606475
Validation loss decreased (0.053492 --> 0.053446).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0518258
	speed: 0.0518s/iter; left time: 942.7260s
	iters: 200, epoch: 19 | loss: 0.0533621
	speed: 0.0271s/iter; left time: 489.3186s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.20s
Steps: 223 | Train Loss: 0.0534612 Vali Loss: 0.0531519 Test Loss: 0.0604471
Validation loss decreased (0.053446 --> 0.053152).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0547985
	speed: 0.0555s/iter; left time: 997.1039s
	iters: 200, epoch: 20 | loss: 0.0515255
	speed: 0.0269s/iter; left time: 480.7644s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.24s
Steps: 223 | Train Loss: 0.0534055 Vali Loss: 0.0532615 Test Loss: 0.0602668
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0534183
	speed: 0.0526s/iter; left time: 932.3127s
	iters: 200, epoch: 21 | loss: 0.0536347
	speed: 0.0276s/iter; left time: 487.4887s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.0532890 Vali Loss: 0.0531846 Test Loss: 0.0605303
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0549916
	speed: 0.0541s/iter; left time: 947.9029s
	iters: 200, epoch: 22 | loss: 0.0554341
	speed: 0.0266s/iter; left time: 462.4595s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.17s
Steps: 223 | Train Loss: 0.0531466 Vali Loss: 0.0528900 Test Loss: 0.0601454
Validation loss decreased (0.053152 --> 0.052890).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0513683
	speed: 0.0526s/iter; left time: 909.7789s
	iters: 200, epoch: 23 | loss: 0.0579329
	speed: 0.0269s/iter; left time: 463.3278s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.19s
Steps: 223 | Train Loss: 0.0530312 Vali Loss: 0.0530480 Test Loss: 0.0602246
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0499048
	speed: 0.0535s/iter; left time: 913.9284s
	iters: 200, epoch: 24 | loss: 0.0510843
	speed: 0.0267s/iter; left time: 453.3064s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.16s
Steps: 223 | Train Loss: 0.0529737 Vali Loss: 0.0528694 Test Loss: 0.0602031
Validation loss decreased (0.052890 --> 0.052869).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0577566
	speed: 0.0523s/iter; left time: 881.3431s
	iters: 200, epoch: 25 | loss: 0.0551628
	speed: 0.0270s/iter; left time: 451.8035s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.23s
Steps: 223 | Train Loss: 0.0528067 Vali Loss: 0.0529870 Test Loss: 0.0601069
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0513571
	speed: 0.0522s/iter; left time: 867.8912s
	iters: 200, epoch: 26 | loss: 0.0499296
	speed: 0.0266s/iter; left time: 438.8673s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.14s
Steps: 223 | Train Loss: 0.0527925 Vali Loss: 0.0529492 Test Loss: 0.0600720
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0509044
	speed: 0.0517s/iter; left time: 848.6226s
	iters: 200, epoch: 27 | loss: 0.0493349
	speed: 0.0272s/iter; left time: 443.6758s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.22s
Steps: 223 | Train Loss: 0.0527369 Vali Loss: 0.0528136 Test Loss: 0.0599594
Validation loss decreased (0.052869 --> 0.052814).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0532001
	speed: 0.0525s/iter; left time: 849.3808s
	iters: 200, epoch: 28 | loss: 0.0511784
	speed: 0.0267s/iter; left time: 430.0331s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.19s
Steps: 223 | Train Loss: 0.0526384 Vali Loss: 0.0528487 Test Loss: 0.0599587
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0495770
	speed: 0.0530s/iter; left time: 844.9906s
	iters: 200, epoch: 29 | loss: 0.0464556
	speed: 0.0269s/iter; left time: 427.3215s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.19s
Steps: 223 | Train Loss: 0.0526565 Vali Loss: 0.0527931 Test Loss: 0.0599919
Validation loss decreased (0.052814 --> 0.052793).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0552674
	speed: 0.0517s/iter; left time: 813.9372s
	iters: 200, epoch: 30 | loss: 0.0527033
	speed: 0.0268s/iter; left time: 418.4444s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.15s
Steps: 223 | Train Loss: 0.0525646 Vali Loss: 0.0527250 Test Loss: 0.0599071
Validation loss decreased (0.052793 --> 0.052725).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0544455
	speed: 0.0538s/iter; left time: 834.2253s
	iters: 200, epoch: 31 | loss: 0.0547280
	speed: 0.0275s/iter; left time: 424.3143s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.41s
Steps: 223 | Train Loss: 0.0525626 Vali Loss: 0.0527098 Test Loss: 0.0599193
Validation loss decreased (0.052725 --> 0.052710).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0535513
	speed: 0.0526s/iter; left time: 804.2974s
	iters: 200, epoch: 32 | loss: 0.0491902
	speed: 0.0270s/iter; left time: 409.4144s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.23s
Steps: 223 | Train Loss: 0.0524858 Vali Loss: 0.0527489 Test Loss: 0.0599410
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0548159
	speed: 0.0537s/iter; left time: 809.7204s
	iters: 200, epoch: 33 | loss: 0.0534750
	speed: 0.0265s/iter; left time: 396.1187s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.27s
Steps: 223 | Train Loss: 0.0524737 Vali Loss: 0.0526946 Test Loss: 0.0599220
Validation loss decreased (0.052710 --> 0.052695).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0547238
	speed: 0.0519s/iter; left time: 770.9554s
	iters: 200, epoch: 34 | loss: 0.0526712
	speed: 0.0265s/iter; left time: 390.0150s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.12s
Steps: 223 | Train Loss: 0.0524465 Vali Loss: 0.0526699 Test Loss: 0.0598708
Validation loss decreased (0.052695 --> 0.052670).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0548534
	speed: 0.0549s/iter; left time: 802.6370s
	iters: 200, epoch: 35 | loss: 0.0521703
	speed: 0.0267s/iter; left time: 387.8711s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.0524024 Vali Loss: 0.0526626 Test Loss: 0.0597937
Validation loss decreased (0.052670 --> 0.052663).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0503881
	speed: 0.0526s/iter; left time: 757.2531s
	iters: 200, epoch: 36 | loss: 0.0522587
	speed: 0.0269s/iter; left time: 384.2234s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.21s
Steps: 223 | Train Loss: 0.0523866 Vali Loss: 0.0526656 Test Loss: 0.0598915
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0512503
	speed: 0.0535s/iter; left time: 758.3364s
	iters: 200, epoch: 37 | loss: 0.0500938
	speed: 0.0262s/iter; left time: 368.8114s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.18s
Steps: 223 | Train Loss: 0.0523500 Vali Loss: 0.0526616 Test Loss: 0.0599231
Validation loss decreased (0.052663 --> 0.052662).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0501655
	speed: 0.0518s/iter; left time: 722.8999s
	iters: 200, epoch: 38 | loss: 0.0534852
	speed: 0.0268s/iter; left time: 371.6178s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.17s
Steps: 223 | Train Loss: 0.0523321 Vali Loss: 0.0527160 Test Loss: 0.0598248
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0514224
	speed: 0.0545s/iter; left time: 748.3258s
	iters: 200, epoch: 39 | loss: 0.0514188
	speed: 0.0269s/iter; left time: 366.1317s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.0523240 Vali Loss: 0.0526534 Test Loss: 0.0597652
Validation loss decreased (0.052662 --> 0.052653).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0530570
	speed: 0.0540s/iter; left time: 729.2703s
	iters: 200, epoch: 40 | loss: 0.0543625
	speed: 0.0265s/iter; left time: 355.3445s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.17s
Steps: 223 | Train Loss: 0.0523358 Vali Loss: 0.0526050 Test Loss: 0.0597801
Validation loss decreased (0.052653 --> 0.052605).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0526280
	speed: 0.0538s/iter; left time: 714.3920s
	iters: 200, epoch: 41 | loss: 0.0502842
	speed: 0.0269s/iter; left time: 354.9000s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.0523034 Vali Loss: 0.0525962 Test Loss: 0.0597211
Validation loss decreased (0.052605 --> 0.052596).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0504601
	speed: 0.0519s/iter; left time: 677.2080s
	iters: 200, epoch: 42 | loss: 0.0522450
	speed: 0.0267s/iter; left time: 346.2330s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.15s
Steps: 223 | Train Loss: 0.0522315 Vali Loss: 0.0525362 Test Loss: 0.0597368
Validation loss decreased (0.052596 --> 0.052536).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0511504
	speed: 0.0536s/iter; left time: 687.5830s
	iters: 200, epoch: 43 | loss: 0.0488503
	speed: 0.0271s/iter; left time: 344.9455s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.22s
Steps: 223 | Train Loss: 0.0522311 Vali Loss: 0.0525445 Test Loss: 0.0597039
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0522164
	speed: 0.0529s/iter; left time: 667.3444s
	iters: 200, epoch: 44 | loss: 0.0535703
	speed: 0.0284s/iter; left time: 354.7353s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.0522388 Vali Loss: 0.0525645 Test Loss: 0.0597437
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0495954
	speed: 0.0542s/iter; left time: 671.1270s
	iters: 200, epoch: 45 | loss: 0.0532957
	speed: 0.0266s/iter; left time: 327.4210s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.24s
Steps: 223 | Train Loss: 0.0521830 Vali Loss: 0.0525358 Test Loss: 0.0597217
Validation loss decreased (0.052536 --> 0.052536).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0547444
	speed: 0.0524s/iter; left time: 637.6216s
	iters: 200, epoch: 46 | loss: 0.0496140
	speed: 0.0269s/iter; left time: 324.3327s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.18s
Steps: 223 | Train Loss: 0.0521675 Vali Loss: 0.0525339 Test Loss: 0.0597081
Validation loss decreased (0.052536 --> 0.052534).  Saving model ...
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0506746
	speed: 0.0548s/iter; left time: 654.9451s
	iters: 200, epoch: 47 | loss: 0.0512049
	speed: 0.0264s/iter; left time: 313.0088s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.0522126 Vali Loss: 0.0525633 Test Loss: 0.0597424
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0528504
	speed: 0.0519s/iter; left time: 608.0480s
	iters: 200, epoch: 48 | loss: 0.0515653
	speed: 0.0264s/iter; left time: 306.4364s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.08s
Steps: 223 | Train Loss: 0.0522133 Vali Loss: 0.0525448 Test Loss: 0.0597099
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0548897
	speed: 0.0561s/iter; left time: 644.8778s
	iters: 200, epoch: 49 | loss: 0.0546200
	speed: 0.0264s/iter; left time: 301.0510s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.26s
Steps: 223 | Train Loss: 0.0521772 Vali Loss: 0.0526311 Test Loss: 0.0597383
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0529519
	speed: 0.0521s/iter; left time: 586.9512s
	iters: 200, epoch: 50 | loss: 0.0546627
	speed: 0.0266s/iter; left time: 297.0058s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.18s
Steps: 223 | Train Loss: 0.0522163 Vali Loss: 0.0525349 Test Loss: 0.0597257
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0562787
	speed: 0.0549s/iter; left time: 606.1844s
	iters: 200, epoch: 51 | loss: 0.0525578
	speed: 0.0263s/iter; left time: 288.2367s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.16s
Steps: 223 | Train Loss: 0.0522028 Vali Loss: 0.0525564 Test Loss: 0.0597158
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0567538
	speed: 0.0519s/iter; left time: 561.7646s
	iters: 200, epoch: 52 | loss: 0.0543848
	speed: 0.0270s/iter; left time: 289.6189s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:06.18s
Steps: 223 | Train Loss: 0.0521792 Vali Loss: 0.0525038 Test Loss: 0.0596972
Validation loss decreased (0.052534 --> 0.052504).  Saving model ...
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0541374
	speed: 0.0558s/iter; left time: 591.2647s
	iters: 200, epoch: 53 | loss: 0.0519631
	speed: 0.0267s/iter; left time: 280.1151s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.16s
Steps: 223 | Train Loss: 0.0521364 Vali Loss: 0.0525617 Test Loss: 0.0597053
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0510549
	speed: 0.0519s/iter; left time: 538.9647s
	iters: 200, epoch: 54 | loss: 0.0498644
	speed: 0.0276s/iter; left time: 283.4121s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.0521371 Vali Loss: 0.0525328 Test Loss: 0.0597132
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0494472
	speed: 0.0524s/iter; left time: 532.0514s
	iters: 200, epoch: 55 | loss: 0.0542947
	speed: 0.0265s/iter; left time: 266.1779s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:06.12s
Steps: 223 | Train Loss: 0.0521456 Vali Loss: 0.0525355 Test Loss: 0.0597412
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0560386
	speed: 0.0519s/iter; left time: 515.1972s
	iters: 200, epoch: 56 | loss: 0.0490938
	speed: 0.0275s/iter; left time: 270.0372s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:06.23s
Steps: 223 | Train Loss: 0.0521942 Vali Loss: 0.0525360 Test Loss: 0.0596775
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0516569
	speed: 0.0533s/iter; left time: 517.2387s
	iters: 200, epoch: 57 | loss: 0.0514586
	speed: 0.0265s/iter; left time: 255.0815s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:06.15s
Steps: 223 | Train Loss: 0.0521401 Vali Loss: 0.0525131 Test Loss: 0.0596987
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0532000
	speed: 0.0516s/iter; left time: 490.0769s
	iters: 200, epoch: 58 | loss: 0.0498075
	speed: 0.0280s/iter; left time: 263.2167s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.0521895 Vali Loss: 0.0524485 Test Loss: 0.0596977
Validation loss decreased (0.052504 --> 0.052448).  Saving model ...
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0487121
	speed: 0.0521s/iter; left time: 482.9457s
	iters: 200, epoch: 59 | loss: 0.0520011
	speed: 0.0263s/iter; left time: 241.3338s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:06.10s
Steps: 223 | Train Loss: 0.0520815 Vali Loss: 0.0525329 Test Loss: 0.0597163
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0499147
	speed: 0.0515s/iter; left time: 465.4498s
	iters: 200, epoch: 60 | loss: 0.0494750
	speed: 0.0274s/iter; left time: 245.2040s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:06.21s
Steps: 223 | Train Loss: 0.0521364 Vali Loss: 0.0525106 Test Loss: 0.0596920
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0571291
	speed: 0.0513s/iter; left time: 452.4577s
	iters: 200, epoch: 61 | loss: 0.0492495
	speed: 0.0267s/iter; left time: 232.9053s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:06.13s
Steps: 223 | Train Loss: 0.0520912 Vali Loss: 0.0525052 Test Loss: 0.0597109
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0515710
	speed: 0.0543s/iter; left time: 467.0255s
	iters: 200, epoch: 62 | loss: 0.0511826
	speed: 0.0270s/iter; left time: 229.4783s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:06.45s
Steps: 223 | Train Loss: 0.0521550 Vali Loss: 0.0525164 Test Loss: 0.0596776
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0522274
	speed: 0.0521s/iter; left time: 436.1762s
	iters: 200, epoch: 63 | loss: 0.0504325
	speed: 0.0266s/iter; left time: 220.2965s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:06.15s
Steps: 223 | Train Loss: 0.0521259 Vali Loss: 0.0525472 Test Loss: 0.0597064
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0529144
	speed: 0.0533s/iter; left time: 434.1040s
	iters: 200, epoch: 64 | loss: 0.0512218
	speed: 0.0271s/iter; left time: 218.0110s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.0521278 Vali Loss: 0.0525165 Test Loss: 0.0596788
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0476370
	speed: 0.0525s/iter; left time: 416.5912s
	iters: 200, epoch: 65 | loss: 0.0538774
	speed: 0.0265s/iter; left time: 207.4537s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:06.12s
Steps: 223 | Train Loss: 0.0521600 Vali Loss: 0.0525308 Test Loss: 0.0596834
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0497716
	speed: 0.0539s/iter; left time: 415.6925s
	iters: 200, epoch: 66 | loss: 0.0530621
	speed: 0.0270s/iter; left time: 205.6071s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:06.39s
Steps: 223 | Train Loss: 0.0521674 Vali Loss: 0.0524973 Test Loss: 0.0596974
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0499892
	speed: 0.0513s/iter; left time: 383.7247s
	iters: 200, epoch: 67 | loss: 0.0548931
	speed: 0.0257s/iter; left time: 190.0039s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:06.07s
Steps: 223 | Train Loss: 0.0520809 Vali Loss: 0.0525215 Test Loss: 0.0597028
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1790184577738603e-07
	iters: 100, epoch: 68 | loss: 0.0492604
	speed: 0.0538s/iter; left time: 390.9405s
	iters: 200, epoch: 68 | loss: 0.0565043
	speed: 0.0269s/iter; left time: 192.2992s
-------------------------------------------------------------------------------------
Epoch: 68
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.0521187 Vali Loss: 0.0525102 Test Loss: 0.0596645
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_512_24_ES_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009862316772341728, rmse:0.09930919855833054, mae:0.0596977174282074, rse:0.2922549545764923
Intermediate time for ES and pred_len 24: 00h:16m:15.63s
=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_512_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_512_96_ES_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1265439
	speed: 0.0400s/iter; left time: 884.7212s
	iters: 200, epoch: 1 | loss: 0.1094258
	speed: 0.0289s/iter; left time: 636.1633s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.67s
Steps: 222 | Train Loss: 0.1312871 Vali Loss: 0.1025756 Test Loss: 0.1179928
Validation loss decreased (inf --> 0.102576).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0907331
	speed: 0.0535s/iter; left time: 1170.6404s
	iters: 200, epoch: 2 | loss: 0.0867114
	speed: 0.0266s/iter; left time: 579.1231s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.22s
Steps: 222 | Train Loss: 0.0917246 Vali Loss: 0.0830300 Test Loss: 0.0950562
Validation loss decreased (0.102576 --> 0.083030).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0829765
	speed: 0.0554s/iter; left time: 1198.8487s
	iters: 200, epoch: 3 | loss: 0.0798829
	speed: 0.0265s/iter; left time: 571.3860s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.15s
Steps: 222 | Train Loss: 0.0835803 Vali Loss: 0.0801783 Test Loss: 0.0919009
Validation loss decreased (0.083030 --> 0.080178).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0821674
	speed: 0.0559s/iter; left time: 1197.5539s
	iters: 200, epoch: 4 | loss: 0.0791295
	speed: 0.0266s/iter; left time: 567.2269s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.27s
Steps: 222 | Train Loss: 0.0809995 Vali Loss: 0.0792776 Test Loss: 0.0911379
Validation loss decreased (0.080178 --> 0.079278).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0795954
	speed: 0.0537s/iter; left time: 1138.2492s
	iters: 200, epoch: 5 | loss: 0.0775064
	speed: 0.0284s/iter; left time: 600.3122s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.37s
Steps: 222 | Train Loss: 0.0793633 Vali Loss: 0.0774794 Test Loss: 0.0889028
Validation loss decreased (0.079278 --> 0.077479).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0782045
	speed: 0.0539s/iter; left time: 1131.9822s
	iters: 200, epoch: 6 | loss: 0.0778508
	speed: 0.0279s/iter; left time: 583.7887s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.34s
Steps: 222 | Train Loss: 0.0779934 Vali Loss: 0.0769796 Test Loss: 0.0893228
Validation loss decreased (0.077479 --> 0.076980).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0745626
	speed: 0.0550s/iter; left time: 1143.0104s
	iters: 200, epoch: 7 | loss: 0.0762473
	speed: 0.0267s/iter; left time: 552.3444s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.21s
Steps: 222 | Train Loss: 0.0769873 Vali Loss: 0.0768754 Test Loss: 0.0889773
Validation loss decreased (0.076980 --> 0.076875).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0770923
	speed: 0.0562s/iter; left time: 1155.5033s
	iters: 200, epoch: 8 | loss: 0.0742162
	speed: 0.0270s/iter; left time: 552.4254s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.33s
Steps: 222 | Train Loss: 0.0761248 Vali Loss: 0.0765266 Test Loss: 0.0878974
Validation loss decreased (0.076875 --> 0.076527).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0738049
	speed: 0.0546s/iter; left time: 1110.0115s
	iters: 200, epoch: 9 | loss: 0.0768474
	speed: 0.0268s/iter; left time: 542.4131s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.37s
Steps: 222 | Train Loss: 0.0753436 Vali Loss: 0.0767246 Test Loss: 0.0876410
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0751446
	speed: 0.0528s/iter; left time: 1061.9707s
	iters: 200, epoch: 10 | loss: 0.0730382
	speed: 0.0278s/iter; left time: 556.7091s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.36s
Steps: 222 | Train Loss: 0.0746837 Vali Loss: 0.0759690 Test Loss: 0.0876617
Validation loss decreased (0.076527 --> 0.075969).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0742704
	speed: 0.0547s/iter; left time: 1088.1799s
	iters: 200, epoch: 11 | loss: 0.0734047
	speed: 0.0283s/iter; left time: 558.8886s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.49s
Steps: 222 | Train Loss: 0.0740411 Vali Loss: 0.0764244 Test Loss: 0.0878260
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0752044
	speed: 0.0543s/iter; left time: 1066.5819s
	iters: 200, epoch: 12 | loss: 0.0752981
	speed: 0.0268s/iter; left time: 523.9445s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.19s
Steps: 222 | Train Loss: 0.0736232 Vali Loss: 0.0767008 Test Loss: 0.0877754
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0746256
	speed: 0.0564s/iter; left time: 1096.2401s
	iters: 200, epoch: 13 | loss: 0.0724523
	speed: 0.0268s/iter; left time: 518.4433s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.25s
Steps: 222 | Train Loss: 0.0732229 Vali Loss: 0.0764604 Test Loss: 0.0875878
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0758144
	speed: 0.0548s/iter; left time: 1053.8924s
	iters: 200, epoch: 14 | loss: 0.0700375
	speed: 0.0271s/iter; left time: 518.3594s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.44s
Steps: 222 | Train Loss: 0.0728587 Vali Loss: 0.0766782 Test Loss: 0.0877830
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0706620
	speed: 0.0543s/iter; left time: 1030.7524s
	iters: 200, epoch: 15 | loss: 0.0763170
	speed: 0.0296s/iter; left time: 559.0234s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.52s
Steps: 222 | Train Loss: 0.0725805 Vali Loss: 0.0769847 Test Loss: 0.0880434
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0747856
	speed: 0.0537s/iter; left time: 1007.8252s
	iters: 200, epoch: 16 | loss: 0.0682468
	speed: 0.0276s/iter; left time: 515.9298s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.40s
Steps: 222 | Train Loss: 0.0722561 Vali Loss: 0.0771711 Test Loss: 0.0879989
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0709803
	speed: 0.0552s/iter; left time: 1024.6003s
	iters: 200, epoch: 17 | loss: 0.0700381
	speed: 0.0273s/iter; left time: 503.1803s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.23s
Steps: 222 | Train Loss: 0.0719847 Vali Loss: 0.0766064 Test Loss: 0.0875815
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0710720
	speed: 0.0554s/iter; left time: 1014.6048s
	iters: 200, epoch: 18 | loss: 0.0727012
	speed: 0.0283s/iter; left time: 516.3897s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.51s
Steps: 222 | Train Loss: 0.0717268 Vali Loss: 0.0767684 Test Loss: 0.0876820
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0743508
	speed: 0.0547s/iter; left time: 989.5579s
	iters: 200, epoch: 19 | loss: 0.0689420
	speed: 0.0275s/iter; left time: 494.3742s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.40s
Steps: 222 | Train Loss: 0.0715864 Vali Loss: 0.0769818 Test Loss: 0.0876034
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0733923
	speed: 0.0529s/iter; left time: 946.8320s
	iters: 200, epoch: 20 | loss: 0.0733492
	speed: 0.0284s/iter; left time: 505.3310s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.32s
Steps: 222 | Train Loss: 0.0712923 Vali Loss: 0.0767117 Test Loss: 0.0876483
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_512_96_ES_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018943050876259804, rmse:0.13763375580310822, mae:0.08766170591115952, rse:0.40432655811309814
Use GPU: cuda:0
>>>>>>>start training : ES_512_96_ES_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1253982
	speed: 0.0289s/iter; left time: 638.4441s
	iters: 200, epoch: 1 | loss: 0.1141047
	speed: 0.0291s/iter; left time: 639.2259s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.42s
Steps: 222 | Train Loss: 0.1341000 Vali Loss: 0.1022669 Test Loss: 0.1178293
Validation loss decreased (inf --> 0.102267).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0919906
	speed: 0.0538s/iter; left time: 1177.6209s
	iters: 200, epoch: 2 | loss: 0.0841853
	speed: 0.0281s/iter; left time: 612.7510s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.38s
Steps: 222 | Train Loss: 0.0917120 Vali Loss: 0.0828372 Test Loss: 0.0952215
Validation loss decreased (0.102267 --> 0.082837).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0804817
	speed: 0.0553s/iter; left time: 1197.2060s
	iters: 200, epoch: 3 | loss: 0.0846727
	speed: 0.0272s/iter; left time: 585.5503s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.20s
Steps: 222 | Train Loss: 0.0834201 Vali Loss: 0.0801691 Test Loss: 0.0913734
Validation loss decreased (0.082837 --> 0.080169).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0814359
	speed: 0.0549s/iter; left time: 1177.4784s
	iters: 200, epoch: 4 | loss: 0.0801016
	speed: 0.0268s/iter; left time: 570.8222s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.25s
Steps: 222 | Train Loss: 0.0809782 Vali Loss: 0.0786221 Test Loss: 0.0896895
Validation loss decreased (0.080169 --> 0.078622).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0773623
	speed: 0.0557s/iter; left time: 1181.5318s
	iters: 200, epoch: 5 | loss: 0.0807470
	speed: 0.0269s/iter; left time: 567.8437s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.38s
Steps: 222 | Train Loss: 0.0791465 Vali Loss: 0.0776870 Test Loss: 0.0884282
Validation loss decreased (0.078622 --> 0.077687).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0764767
	speed: 0.0557s/iter; left time: 1168.8908s
	iters: 200, epoch: 6 | loss: 0.0776939
	speed: 0.0288s/iter; left time: 601.9911s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.50s
Steps: 222 | Train Loss: 0.0779017 Vali Loss: 0.0774003 Test Loss: 0.0885492
Validation loss decreased (0.077687 --> 0.077400).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0810065
	speed: 0.0550s/iter; left time: 1142.0334s
	iters: 200, epoch: 7 | loss: 0.0755886
	speed: 0.0274s/iter; left time: 566.7097s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.33s
Steps: 222 | Train Loss: 0.0769723 Vali Loss: 0.0767423 Test Loss: 0.0886906
Validation loss decreased (0.077400 --> 0.076742).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0772487
	speed: 0.0547s/iter; left time: 1123.3866s
	iters: 200, epoch: 8 | loss: 0.0774471
	speed: 0.0271s/iter; left time: 555.0383s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.24s
Steps: 222 | Train Loss: 0.0761289 Vali Loss: 0.0762937 Test Loss: 0.0885289
Validation loss decreased (0.076742 --> 0.076294).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0766210
	speed: 0.0558s/iter; left time: 1134.4816s
	iters: 200, epoch: 9 | loss: 0.0749435
	speed: 0.0269s/iter; left time: 544.2993s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.30s
Steps: 222 | Train Loss: 0.0755007 Vali Loss: 0.0760306 Test Loss: 0.0880587
Validation loss decreased (0.076294 --> 0.076031).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0746958
	speed: 0.0559s/iter; left time: 1123.7180s
	iters: 200, epoch: 10 | loss: 0.0730645
	speed: 0.0275s/iter; left time: 550.5338s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.41s
Steps: 222 | Train Loss: 0.0748742 Vali Loss: 0.0756054 Test Loss: 0.0881646
Validation loss decreased (0.076031 --> 0.075605).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0716690
	speed: 0.0534s/iter; left time: 1061.9451s
	iters: 200, epoch: 11 | loss: 0.0740186
	speed: 0.0284s/iter; left time: 561.3806s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.31s
Steps: 222 | Train Loss: 0.0743888 Vali Loss: 0.0763426 Test Loss: 0.0880540
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0735602
	speed: 0.0538s/iter; left time: 1057.8847s
	iters: 200, epoch: 12 | loss: 0.0751355
	speed: 0.0281s/iter; left time: 549.2004s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.37s
Steps: 222 | Train Loss: 0.0739728 Vali Loss: 0.0759540 Test Loss: 0.0883263
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0716493
	speed: 0.0541s/iter; left time: 1051.5080s
	iters: 200, epoch: 13 | loss: 0.0773238
	speed: 0.0267s/iter; left time: 515.7994s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.18s
Steps: 222 | Train Loss: 0.0734238 Vali Loss: 0.0758260 Test Loss: 0.0877946
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0718031
	speed: 0.0554s/iter; left time: 1064.5978s
	iters: 200, epoch: 14 | loss: 0.0764564
	speed: 0.0270s/iter; left time: 516.4653s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.31s
Steps: 222 | Train Loss: 0.0731561 Vali Loss: 0.0764050 Test Loss: 0.0881921
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0733460
	speed: 0.0543s/iter; left time: 1032.1122s
	iters: 200, epoch: 15 | loss: 0.0726849
	speed: 0.0273s/iter; left time: 515.3981s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.38s
Steps: 222 | Train Loss: 0.0728082 Vali Loss: 0.0762584 Test Loss: 0.0878794
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0713056
	speed: 0.0524s/iter; left time: 982.8385s
	iters: 200, epoch: 16 | loss: 0.0673408
	speed: 0.0280s/iter; left time: 523.1473s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.28s
Steps: 222 | Train Loss: 0.0725102 Vali Loss: 0.0764893 Test Loss: 0.0877887
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0729090
	speed: 0.0530s/iter; left time: 982.7459s
	iters: 200, epoch: 17 | loss: 0.0736606
	speed: 0.0270s/iter; left time: 498.6336s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.26s
Steps: 222 | Train Loss: 0.0722571 Vali Loss: 0.0764543 Test Loss: 0.0877635
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0751263
	speed: 0.0551s/iter; left time: 1010.3302s
	iters: 200, epoch: 18 | loss: 0.0732667
	speed: 0.0264s/iter; left time: 480.9158s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.19s
Steps: 222 | Train Loss: 0.0720145 Vali Loss: 0.0763173 Test Loss: 0.0881959
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0712821
	speed: 0.0561s/iter; left time: 1015.0635s
	iters: 200, epoch: 19 | loss: 0.0737556
	speed: 0.0275s/iter; left time: 494.3910s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.47s
Steps: 222 | Train Loss: 0.0717988 Vali Loss: 0.0764204 Test Loss: 0.0878492
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0701951
	speed: 0.0559s/iter; left time: 1000.3240s
	iters: 200, epoch: 20 | loss: 0.0730100
	speed: 0.0292s/iter; left time: 519.6067s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.57s
Steps: 222 | Train Loss: 0.0715539 Vali Loss: 0.0763633 Test Loss: 0.0877618
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_512_96_ES_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01899096928536892, rmse:0.1378077268600464, mae:0.08816458284854889, rse:0.40483760833740234
Intermediate time for ES and pred_len 96: 00h:05m:36.93s
=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_512_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_512_168_ES_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1250355
	speed: 0.0545s/iter; left time: 1204.7699s
	iters: 200, epoch: 1 | loss: 0.1118319
	speed: 0.0281s/iter; left time: 617.5021s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.69s
Steps: 222 | Train Loss: 0.1330013 Vali Loss: 0.1052809 Test Loss: 0.1202528
Validation loss decreased (inf --> 0.105281).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0916071
	speed: 0.0549s/iter; left time: 1200.7462s
	iters: 200, epoch: 2 | loss: 0.0897428
	speed: 0.0272s/iter; left time: 591.3106s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.26s
Steps: 222 | Train Loss: 0.0956554 Vali Loss: 0.0879480 Test Loss: 0.1003329
Validation loss decreased (0.105281 --> 0.087948).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0914022
	speed: 0.0579s/iter; left time: 1254.3048s
	iters: 200, epoch: 3 | loss: 0.0906762
	speed: 0.0270s/iter; left time: 582.6198s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.38s
Steps: 222 | Train Loss: 0.0882966 Vali Loss: 0.0851394 Test Loss: 0.0968764
Validation loss decreased (0.087948 --> 0.085139).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0883625
	speed: 0.0564s/iter; left time: 1209.4570s
	iters: 200, epoch: 4 | loss: 0.0835357
	speed: 0.0272s/iter; left time: 580.5430s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.42s
Steps: 222 | Train Loss: 0.0856180 Vali Loss: 0.0840554 Test Loss: 0.0959844
Validation loss decreased (0.085139 --> 0.084055).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0803824
	speed: 0.0554s/iter; left time: 1175.9016s
	iters: 200, epoch: 5 | loss: 0.0853965
	speed: 0.0286s/iter; left time: 603.7469s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.54s
Steps: 222 | Train Loss: 0.0838570 Vali Loss: 0.0833926 Test Loss: 0.0951348
Validation loss decreased (0.084055 --> 0.083393).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0797744
	speed: 0.0533s/iter; left time: 1118.2968s
	iters: 200, epoch: 6 | loss: 0.0826659
	speed: 0.0287s/iter; left time: 600.0754s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.41s
Steps: 222 | Train Loss: 0.0822528 Vali Loss: 0.0830472 Test Loss: 0.0943015
Validation loss decreased (0.083393 --> 0.083047).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0828038
	speed: 0.0536s/iter; left time: 1112.2997s
	iters: 200, epoch: 7 | loss: 0.0825458
	speed: 0.0272s/iter; left time: 562.4987s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.37s
Steps: 222 | Train Loss: 0.0811129 Vali Loss: 0.0834605 Test Loss: 0.0947691
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0849840
	speed: 0.0559s/iter; left time: 1148.1936s
	iters: 200, epoch: 8 | loss: 0.0815625
	speed: 0.0274s/iter; left time: 559.4835s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.24s
Steps: 222 | Train Loss: 0.0801981 Vali Loss: 0.0829874 Test Loss: 0.0947762
Validation loss decreased (0.083047 --> 0.082987).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0781479
	speed: 0.0549s/iter; left time: 1115.8102s
	iters: 200, epoch: 9 | loss: 0.0818327
	speed: 0.0275s/iter; left time: 555.8687s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.33s
Steps: 222 | Train Loss: 0.0794156 Vali Loss: 0.0829935 Test Loss: 0.0946946
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0794938
	speed: 0.0533s/iter; left time: 1071.4783s
	iters: 200, epoch: 10 | loss: 0.0774823
	speed: 0.0288s/iter; left time: 576.4229s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.48s
Steps: 222 | Train Loss: 0.0786948 Vali Loss: 0.0832779 Test Loss: 0.0945250
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0782731
	speed: 0.0537s/iter; left time: 1068.0314s
	iters: 200, epoch: 11 | loss: 0.0724275
	speed: 0.0286s/iter; left time: 565.7093s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.54s
Steps: 222 | Train Loss: 0.0781504 Vali Loss: 0.0839142 Test Loss: 0.0944648
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0773756
	speed: 0.0547s/iter; left time: 1075.9521s
	iters: 200, epoch: 12 | loss: 0.0790120
	speed: 0.0270s/iter; left time: 528.0343s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.30s
Steps: 222 | Train Loss: 0.0776322 Vali Loss: 0.0839175 Test Loss: 0.0947209
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0759633
	speed: 0.0562s/iter; left time: 1091.6846s
	iters: 200, epoch: 13 | loss: 0.0766064
	speed: 0.0270s/iter; left time: 522.6924s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.30s
Steps: 222 | Train Loss: 0.0772161 Vali Loss: 0.0840464 Test Loss: 0.0945042
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0776728
	speed: 0.0551s/iter; left time: 1058.3260s
	iters: 200, epoch: 14 | loss: 0.0716171
	speed: 0.0279s/iter; left time: 533.3754s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.50s
Steps: 222 | Train Loss: 0.0768410 Vali Loss: 0.0839806 Test Loss: 0.0951329
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0770181
	speed: 0.0529s/iter; left time: 1004.0617s
	iters: 200, epoch: 15 | loss: 0.0740275
	speed: 0.0280s/iter; left time: 529.6884s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.39s
Steps: 222 | Train Loss: 0.0765493 Vali Loss: 0.0842260 Test Loss: 0.0949700
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0760478
	speed: 0.0558s/iter; left time: 1047.1025s
	iters: 200, epoch: 16 | loss: 0.0732501
	speed: 0.0275s/iter; left time: 512.9081s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.37s
Steps: 222 | Train Loss: 0.0762004 Vali Loss: 0.0838910 Test Loss: 0.0946376
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0764160
	speed: 0.0565s/iter; left time: 1047.8797s
	iters: 200, epoch: 17 | loss: 0.0790075
	speed: 0.0273s/iter; left time: 504.0989s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.43s
Steps: 222 | Train Loss: 0.0759705 Vali Loss: 0.0844240 Test Loss: 0.0951427
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0746448
	speed: 0.0552s/iter; left time: 1012.1262s
	iters: 200, epoch: 18 | loss: 0.0749086
	speed: 0.0282s/iter; left time: 513.3303s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.46s
Steps: 222 | Train Loss: 0.0756720 Vali Loss: 0.0843374 Test Loss: 0.0958508
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_512_168_ES_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021302737295627594, rmse:0.14595457911491394, mae:0.0947762206196785, rse:0.42880141735076904
Use GPU: cuda:0
>>>>>>>start training : ES_512_168_ES_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1263854
	speed: 0.0309s/iter; left time: 682.9684s
	iters: 200, epoch: 1 | loss: 0.1156874
	speed: 0.0276s/iter; left time: 606.8545s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.48s
Steps: 222 | Train Loss: 0.1330581 Vali Loss: 0.1057428 Test Loss: 0.1209379
Validation loss decreased (inf --> 0.105743).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0964121
	speed: 0.0557s/iter; left time: 1218.0535s
	iters: 200, epoch: 2 | loss: 0.0929709
	speed: 0.0288s/iter; left time: 628.1006s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.54s
Steps: 222 | Train Loss: 0.0959172 Vali Loss: 0.0880870 Test Loss: 0.1012052
Validation loss decreased (0.105743 --> 0.088087).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0905122
	speed: 0.0563s/iter; left time: 1219.2802s
	iters: 200, epoch: 3 | loss: 0.0891663
	speed: 0.0291s/iter; left time: 628.2172s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.55s
Steps: 222 | Train Loss: 0.0886181 Vali Loss: 0.0859668 Test Loss: 0.0981919
Validation loss decreased (0.088087 --> 0.085967).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0836552
	speed: 0.0574s/iter; left time: 1231.0096s
	iters: 200, epoch: 4 | loss: 0.0862615
	speed: 0.0272s/iter; left time: 580.0435s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.35s
Steps: 222 | Train Loss: 0.0859728 Vali Loss: 0.0844449 Test Loss: 0.0958727
Validation loss decreased (0.085967 --> 0.084445).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0788982
	speed: 0.0583s/iter; left time: 1237.0605s
	iters: 200, epoch: 5 | loss: 0.0824617
	speed: 0.0274s/iter; left time: 577.8412s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.38s
Steps: 222 | Train Loss: 0.0840970 Vali Loss: 0.0829465 Test Loss: 0.0956325
Validation loss decreased (0.084445 --> 0.082947).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0843147
	speed: 0.0562s/iter; left time: 1179.0831s
	iters: 200, epoch: 6 | loss: 0.0826297
	speed: 0.0283s/iter; left time: 591.9055s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.45s
Steps: 222 | Train Loss: 0.0826575 Vali Loss: 0.0833131 Test Loss: 0.0959734
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0814445
	speed: 0.0537s/iter; left time: 1115.2986s
	iters: 200, epoch: 7 | loss: 0.0826768
	speed: 0.0289s/iter; left time: 597.0329s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.48s
Steps: 222 | Train Loss: 0.0814408 Vali Loss: 0.0830539 Test Loss: 0.0944358
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0832167
	speed: 0.0560s/iter; left time: 1149.8094s
	iters: 200, epoch: 8 | loss: 0.0797981
	speed: 0.0274s/iter; left time: 560.7844s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.43s
Steps: 222 | Train Loss: 0.0804610 Vali Loss: 0.0830255 Test Loss: 0.0940806
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0808557
	speed: 0.0570s/iter; left time: 1159.0573s
	iters: 200, epoch: 9 | loss: 0.0788599
	speed: 0.0269s/iter; left time: 544.1756s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.30s
Steps: 222 | Train Loss: 0.0795982 Vali Loss: 0.0830813 Test Loss: 0.0943129
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0793939
	speed: 0.0553s/iter; left time: 1112.2653s
	iters: 200, epoch: 10 | loss: 0.0804769
	speed: 0.0272s/iter; left time: 543.1426s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.33s
Steps: 222 | Train Loss: 0.0789372 Vali Loss: 0.0844544 Test Loss: 0.0946267
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0799205
	speed: 0.0563s/iter; left time: 1120.1130s
	iters: 200, epoch: 11 | loss: 0.0787828
	speed: 0.0275s/iter; left time: 543.6759s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.53s
Steps: 222 | Train Loss: 0.0783694 Vali Loss: 0.0832267 Test Loss: 0.0936449
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0794356
	speed: 0.0537s/iter; left time: 1055.5499s
	iters: 200, epoch: 12 | loss: 0.0780849
	speed: 0.0296s/iter; left time: 579.6828s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.55s
Steps: 222 | Train Loss: 0.0777887 Vali Loss: 0.0834535 Test Loss: 0.0943098
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0778237
	speed: 0.0542s/iter; left time: 1054.2259s
	iters: 200, epoch: 13 | loss: 0.0756606
	speed: 0.0274s/iter; left time: 529.8611s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.29s
Steps: 222 | Train Loss: 0.0773796 Vali Loss: 0.0838258 Test Loss: 0.0945887
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0753599
	speed: 0.0570s/iter; left time: 1094.4866s
	iters: 200, epoch: 14 | loss: 0.0772503
	speed: 0.0280s/iter; left time: 534.9680s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.36s
Steps: 222 | Train Loss: 0.0769784 Vali Loss: 0.0844897 Test Loss: 0.0947630
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0747140
	speed: 0.0574s/iter; left time: 1090.5105s
	iters: 200, epoch: 15 | loss: 0.0749678
	speed: 0.0272s/iter; left time: 514.6338s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.52s
Steps: 222 | Train Loss: 0.0766025 Vali Loss: 0.0839631 Test Loss: 0.0942935
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_512_168_ES_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021356923505663872, rmse:0.14614008367061615, mae:0.09563247114419937, rse:0.4293464124202728
Intermediate time for ES and pred_len 168: 00h:04m:47.34sIntermediate time for ES: 00h:26m:39.90s
=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_512_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_512_24_FR_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0843132
	speed: 0.0528s/iter; left time: 1172.4564s
	iters: 200, epoch: 1 | loss: 0.0826993
	speed: 0.0273s/iter; left time: 602.6090s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.51s
Steps: 223 | Train Loss: 0.0928899 Vali Loss: 0.0809973 Test Loss: 0.0874650
Validation loss decreased (inf --> 0.080997).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0540009
	speed: 0.0541s/iter; left time: 1189.4851s
	iters: 200, epoch: 2 | loss: 0.0534995
	speed: 0.0274s/iter; left time: 599.0115s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.35s
Steps: 223 | Train Loss: 0.0554808 Vali Loss: 0.0583653 Test Loss: 0.0612634
Validation loss decreased (0.080997 --> 0.058365).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0485997
	speed: 0.0511s/iter; left time: 1112.2014s
	iters: 200, epoch: 3 | loss: 0.0472784
	speed: 0.0265s/iter; left time: 574.6490s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.09s
Steps: 223 | Train Loss: 0.0488961 Vali Loss: 0.0559211 Test Loss: 0.0598280
Validation loss decreased (0.058365 --> 0.055921).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0495222
	speed: 0.0554s/iter; left time: 1193.9438s
	iters: 200, epoch: 4 | loss: 0.0483923
	speed: 0.0266s/iter; left time: 569.9407s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.21s
Steps: 223 | Train Loss: 0.0470500 Vali Loss: 0.0548929 Test Loss: 0.0586228
Validation loss decreased (0.055921 --> 0.054893).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0458255
	speed: 0.0540s/iter; left time: 1151.1256s
	iters: 200, epoch: 5 | loss: 0.0433537
	speed: 0.0277s/iter; left time: 587.8733s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.43s
Steps: 223 | Train Loss: 0.0458443 Vali Loss: 0.0543292 Test Loss: 0.0576505
Validation loss decreased (0.054893 --> 0.054329).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0430197
	speed: 0.0517s/iter; left time: 1090.1838s
	iters: 200, epoch: 6 | loss: 0.0458188
	speed: 0.0268s/iter; left time: 562.1362s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.12s
Steps: 223 | Train Loss: 0.0450522 Vali Loss: 0.0533698 Test Loss: 0.0574189
Validation loss decreased (0.054329 --> 0.053370).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0436309
	speed: 0.0533s/iter; left time: 1111.0120s
	iters: 200, epoch: 7 | loss: 0.0437001
	speed: 0.0274s/iter; left time: 568.1200s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.37s
Steps: 223 | Train Loss: 0.0443619 Vali Loss: 0.0534138 Test Loss: 0.0570331
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0455056
	speed: 0.0547s/iter; left time: 1129.6775s
	iters: 200, epoch: 8 | loss: 0.0435005
	speed: 0.0267s/iter; left time: 547.5106s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.23s
Steps: 223 | Train Loss: 0.0438976 Vali Loss: 0.0529732 Test Loss: 0.0568599
Validation loss decreased (0.053370 --> 0.052973).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0422169
	speed: 0.0547s/iter; left time: 1116.5035s
	iters: 200, epoch: 9 | loss: 0.0433253
	speed: 0.0267s/iter; left time: 542.1505s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.0434878 Vali Loss: 0.0527236 Test Loss: 0.0561925
Validation loss decreased (0.052973 --> 0.052724).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0444294
	speed: 0.0521s/iter; left time: 1051.5519s
	iters: 200, epoch: 10 | loss: 0.0413240
	speed: 0.0280s/iter; left time: 562.0882s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.35s
Steps: 223 | Train Loss: 0.0431111 Vali Loss: 0.0524848 Test Loss: 0.0564840
Validation loss decreased (0.052724 --> 0.052485).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0447372
	speed: 0.0547s/iter; left time: 1091.9684s
	iters: 200, epoch: 11 | loss: 0.0443235
	speed: 0.0272s/iter; left time: 539.7257s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.23s
Steps: 223 | Train Loss: 0.0428224 Vali Loss: 0.0525295 Test Loss: 0.0564360
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0440985
	speed: 0.0526s/iter; left time: 1039.4210s
	iters: 200, epoch: 12 | loss: 0.0438725
	speed: 0.0282s/iter; left time: 553.2477s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.0425661 Vali Loss: 0.0519805 Test Loss: 0.0558995
Validation loss decreased (0.052485 --> 0.051981).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0421945
	speed: 0.0540s/iter; left time: 1054.1201s
	iters: 200, epoch: 13 | loss: 0.0413549
	speed: 0.0263s/iter; left time: 511.8004s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.20s
Steps: 223 | Train Loss: 0.0423398 Vali Loss: 0.0518698 Test Loss: 0.0560660
Validation loss decreased (0.051981 --> 0.051870).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0388299
	speed: 0.0537s/iter; left time: 1036.0091s
	iters: 200, epoch: 14 | loss: 0.0418125
	speed: 0.0280s/iter; left time: 538.1113s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.44s
Steps: 223 | Train Loss: 0.0421227 Vali Loss: 0.0520392 Test Loss: 0.0560852
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0425634
	speed: 0.0541s/iter; left time: 1032.7221s
	iters: 200, epoch: 15 | loss: 0.0422673
	speed: 0.0281s/iter; left time: 532.6569s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.46s
Steps: 223 | Train Loss: 0.0419951 Vali Loss: 0.0516969 Test Loss: 0.0556645
Validation loss decreased (0.051870 --> 0.051697).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0408609
	speed: 0.0569s/iter; left time: 1073.5040s
	iters: 200, epoch: 16 | loss: 0.0428541
	speed: 0.0264s/iter; left time: 495.1751s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.17s
Steps: 223 | Train Loss: 0.0417983 Vali Loss: 0.0516113 Test Loss: 0.0556568
Validation loss decreased (0.051697 --> 0.051611).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0433161
	speed: 0.0539s/iter; left time: 1004.8645s
	iters: 200, epoch: 17 | loss: 0.0422571
	speed: 0.0269s/iter; left time: 497.8583s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.16s
Steps: 223 | Train Loss: 0.0416500 Vali Loss: 0.0514052 Test Loss: 0.0555000
Validation loss decreased (0.051611 --> 0.051405).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0451433
	speed: 0.0543s/iter; left time: 1000.5573s
	iters: 200, epoch: 18 | loss: 0.0420981
	speed: 0.0266s/iter; left time: 487.2478s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.0415242 Vali Loss: 0.0517223 Test Loss: 0.0556480
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0410448
	speed: 0.0513s/iter; left time: 932.6076s
	iters: 200, epoch: 19 | loss: 0.0432532
	speed: 0.0282s/iter; left time: 509.8674s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.0414556 Vali Loss: 0.0513815 Test Loss: 0.0556669
Validation loss decreased (0.051405 --> 0.051381).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0432690
	speed: 0.0525s/iter; left time: 942.6680s
	iters: 200, epoch: 20 | loss: 0.0416686
	speed: 0.0271s/iter; left time: 484.4756s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.19s
Steps: 223 | Train Loss: 0.0412836 Vali Loss: 0.0514204 Test Loss: 0.0554169
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0411735
	speed: 0.0527s/iter; left time: 935.6835s
	iters: 200, epoch: 21 | loss: 0.0403434
	speed: 0.0275s/iter; left time: 485.5511s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.0411740 Vali Loss: 0.0512162 Test Loss: 0.0553809
Validation loss decreased (0.051381 --> 0.051216).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0410238
	speed: 0.0536s/iter; left time: 939.4560s
	iters: 200, epoch: 22 | loss: 0.0431798
	speed: 0.0267s/iter; left time: 464.3242s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.20s
Steps: 223 | Train Loss: 0.0411241 Vali Loss: 0.0512545 Test Loss: 0.0554124
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0430400
	speed: 0.0530s/iter; left time: 916.0372s
	iters: 200, epoch: 23 | loss: 0.0405390
	speed: 0.0280s/iter; left time: 481.6875s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.37s
Steps: 223 | Train Loss: 0.0410707 Vali Loss: 0.0511939 Test Loss: 0.0553393
Validation loss decreased (0.051216 --> 0.051194).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0420456
	speed: 0.0517s/iter; left time: 882.1424s
	iters: 200, epoch: 24 | loss: 0.0422551
	speed: 0.0284s/iter; left time: 482.0183s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.41s
Steps: 223 | Train Loss: 0.0409819 Vali Loss: 0.0512411 Test Loss: 0.0552675
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0419776
	speed: 0.0554s/iter; left time: 933.9544s
	iters: 200, epoch: 25 | loss: 0.0394762
	speed: 0.0267s/iter; left time: 447.9372s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.17s
Steps: 223 | Train Loss: 0.0409476 Vali Loss: 0.0512755 Test Loss: 0.0553754
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0415562
	speed: 0.0537s/iter; left time: 893.2178s
	iters: 200, epoch: 26 | loss: 0.0394714
	speed: 0.0278s/iter; left time: 459.1665s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.0408676 Vali Loss: 0.0510152 Test Loss: 0.0553677
Validation loss decreased (0.051194 --> 0.051015).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0425590
	speed: 0.0547s/iter; left time: 897.5023s
	iters: 200, epoch: 27 | loss: 0.0395341
	speed: 0.0267s/iter; left time: 435.8227s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.0408256 Vali Loss: 0.0510102 Test Loss: 0.0553386
Validation loss decreased (0.051015 --> 0.051010).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0406038
	speed: 0.0527s/iter; left time: 853.1032s
	iters: 200, epoch: 28 | loss: 0.0398112
	speed: 0.0281s/iter; left time: 452.2022s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.41s
Steps: 223 | Train Loss: 0.0407815 Vali Loss: 0.0511237 Test Loss: 0.0552632
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0404074
	speed: 0.0522s/iter; left time: 832.5402s
	iters: 200, epoch: 29 | loss: 0.0439339
	speed: 0.0265s/iter; left time: 419.7493s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.20s
Steps: 223 | Train Loss: 0.0407395 Vali Loss: 0.0510612 Test Loss: 0.0552591
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0436032
	speed: 0.0548s/iter; left time: 861.7810s
	iters: 200, epoch: 30 | loss: 0.0381865
	speed: 0.0266s/iter; left time: 415.4775s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.21s
Steps: 223 | Train Loss: 0.0406719 Vali Loss: 0.0511291 Test Loss: 0.0551437
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0385469
	speed: 0.0521s/iter; left time: 808.2974s
	iters: 200, epoch: 31 | loss: 0.0384711
	speed: 0.0265s/iter; left time: 408.1923s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.26s
Steps: 223 | Train Loss: 0.0406380 Vali Loss: 0.0509718 Test Loss: 0.0551497
Validation loss decreased (0.051010 --> 0.050972).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0395896
	speed: 0.0563s/iter; left time: 860.3259s
	iters: 200, epoch: 32 | loss: 0.0421091
	speed: 0.0276s/iter; left time: 419.3569s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.0406369 Vali Loss: 0.0510668 Test Loss: 0.0552206
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0381517
	speed: 0.0534s/iter; left time: 805.1249s
	iters: 200, epoch: 33 | loss: 0.0395394
	speed: 0.0287s/iter; left time: 429.9415s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.44s
Steps: 223 | Train Loss: 0.0406346 Vali Loss: 0.0509685 Test Loss: 0.0552220
Validation loss decreased (0.050972 --> 0.050968).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0390877
	speed: 0.0529s/iter; left time: 784.9570s
	iters: 200, epoch: 34 | loss: 0.0426558
	speed: 0.0271s/iter; left time: 399.8353s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.19s
Steps: 223 | Train Loss: 0.0406084 Vali Loss: 0.0509817 Test Loss: 0.0551818
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0396101
	speed: 0.0550s/iter; left time: 804.7154s
	iters: 200, epoch: 35 | loss: 0.0452002
	speed: 0.0268s/iter; left time: 388.8294s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.27s
Steps: 223 | Train Loss: 0.0405750 Vali Loss: 0.0510232 Test Loss: 0.0551961
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0396727
	speed: 0.0535s/iter; left time: 770.7884s
	iters: 200, epoch: 36 | loss: 0.0376845
	speed: 0.0274s/iter; left time: 391.7799s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.45s
Steps: 223 | Train Loss: 0.0405536 Vali Loss: 0.0509294 Test Loss: 0.0551972
Validation loss decreased (0.050968 --> 0.050929).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0383235
	speed: 0.0553s/iter; left time: 784.1062s
	iters: 200, epoch: 37 | loss: 0.0379358
	speed: 0.0283s/iter; left time: 398.2996s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.0405320 Vali Loss: 0.0509095 Test Loss: 0.0551600
Validation loss decreased (0.050929 --> 0.050909).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0440550
	speed: 0.0517s/iter; left time: 721.2223s
	iters: 200, epoch: 38 | loss: 0.0409360
	speed: 0.0271s/iter; left time: 375.0808s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.22s
Steps: 223 | Train Loss: 0.0405302 Vali Loss: 0.0509632 Test Loss: 0.0551483
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0424551
	speed: 0.0544s/iter; left time: 746.2891s
	iters: 200, epoch: 39 | loss: 0.0407349
	speed: 0.0268s/iter; left time: 364.9452s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.16s
Steps: 223 | Train Loss: 0.0404400 Vali Loss: 0.0509475 Test Loss: 0.0551755
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0399665
	speed: 0.0539s/iter; left time: 727.9944s
	iters: 200, epoch: 40 | loss: 0.0386363
	speed: 0.0276s/iter; left time: 370.0188s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.46s
Steps: 223 | Train Loss: 0.0405515 Vali Loss: 0.0509822 Test Loss: 0.0551663
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0414642
	speed: 0.0536s/iter; left time: 711.4697s
	iters: 200, epoch: 41 | loss: 0.0414216
	speed: 0.0270s/iter; left time: 356.3245s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.0405032 Vali Loss: 0.0509070 Test Loss: 0.0551836
Validation loss decreased (0.050909 --> 0.050907).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0396513
	speed: 0.0547s/iter; left time: 714.2081s
	iters: 200, epoch: 42 | loss: 0.0407175
	speed: 0.0273s/iter; left time: 354.3178s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.0404501 Vali Loss: 0.0509050 Test Loss: 0.0551621
Validation loss decreased (0.050907 --> 0.050905).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0419802
	speed: 0.0522s/iter; left time: 669.5941s
	iters: 200, epoch: 43 | loss: 0.0435936
	speed: 0.0268s/iter; left time: 341.9310s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.23s
Steps: 223 | Train Loss: 0.0404785 Vali Loss: 0.0510068 Test Loss: 0.0551562
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0377414
	speed: 0.0557s/iter; left time: 702.0427s
	iters: 200, epoch: 44 | loss: 0.0404162
	speed: 0.0268s/iter; left time: 335.1467s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.21s
Steps: 223 | Train Loss: 0.0404870 Vali Loss: 0.0509230 Test Loss: 0.0551347
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0397641
	speed: 0.0534s/iter; left time: 661.6692s
	iters: 200, epoch: 45 | loss: 0.0363073
	speed: 0.0280s/iter; left time: 343.8013s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.40s
Steps: 223 | Train Loss: 0.0404352 Vali Loss: 0.0509129 Test Loss: 0.0551449
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0382217
	speed: 0.0512s/iter; left time: 622.3970s
	iters: 200, epoch: 46 | loss: 0.0383492
	speed: 0.0275s/iter; left time: 331.8624s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.19s
Steps: 223 | Train Loss: 0.0404233 Vali Loss: 0.0509525 Test Loss: 0.0551411
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0375880
	speed: 0.0539s/iter; left time: 644.2997s
	iters: 200, epoch: 47 | loss: 0.0388351
	speed: 0.0276s/iter; left time: 326.9712s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.0404278 Vali Loss: 0.0509438 Test Loss: 0.0551423
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0394593
	speed: 0.0537s/iter; left time: 628.9858s
	iters: 200, epoch: 48 | loss: 0.0419493
	speed: 0.0263s/iter; left time: 305.7643s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.09s
Steps: 223 | Train Loss: 0.0404258 Vali Loss: 0.0509123 Test Loss: 0.0551539
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0434436
	speed: 0.0508s/iter; left time: 584.4281s
	iters: 200, epoch: 49 | loss: 0.0394077
	speed: 0.0265s/iter; left time: 301.9150s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.16s
Steps: 223 | Train Loss: 0.0404041 Vali Loss: 0.0509195 Test Loss: 0.0551415
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0392535
	speed: 0.0513s/iter; left time: 577.8123s
	iters: 200, epoch: 50 | loss: 0.0380202
	speed: 0.0285s/iter; left time: 318.4440s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.0404302 Vali Loss: 0.0509391 Test Loss: 0.0551524
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0440110
	speed: 0.0531s/iter; left time: 586.7326s
	iters: 200, epoch: 51 | loss: 0.0394740
	speed: 0.0266s/iter; left time: 291.7425s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.22s
Steps: 223 | Train Loss: 0.0404130 Vali Loss: 0.0508948 Test Loss: 0.0551422
Validation loss decreased (0.050905 --> 0.050895).  Saving model ...
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0448568
	speed: 0.0530s/iter; left time: 573.4647s
	iters: 200, epoch: 52 | loss: 0.0377624
	speed: 0.0274s/iter; left time: 294.0894s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.0403924 Vali Loss: 0.0509185 Test Loss: 0.0551236
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0432277
	speed: 0.0544s/iter; left time: 577.3631s
	iters: 200, epoch: 53 | loss: 0.0382022
	speed: 0.0266s/iter; left time: 278.9200s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.0403406 Vali Loss: 0.0509090 Test Loss: 0.0551386
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0392583
	speed: 0.0539s/iter; left time: 559.1625s
	iters: 200, epoch: 54 | loss: 0.0379959
	speed: 0.0282s/iter; left time: 289.9848s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:06.53s
Steps: 223 | Train Loss: 0.0403821 Vali Loss: 0.0509590 Test Loss: 0.0551205
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0424123
	speed: 0.0516s/iter; left time: 524.5061s
	iters: 200, epoch: 55 | loss: 0.0390990
	speed: 0.0277s/iter; left time: 278.7551s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.0404026 Vali Loss: 0.0508852 Test Loss: 0.0551308
Validation loss decreased (0.050895 --> 0.050885).  Saving model ...
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0409146
	speed: 0.0545s/iter; left time: 541.4831s
	iters: 200, epoch: 56 | loss: 0.0394938
	speed: 0.0264s/iter; left time: 259.6164s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.0403666 Vali Loss: 0.0509080 Test Loss: 0.0551149
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0383278
	speed: 0.0563s/iter; left time: 546.3756s
	iters: 200, epoch: 57 | loss: 0.0380404
	speed: 0.0269s/iter; left time: 258.4197s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:06.21s
Steps: 223 | Train Loss: 0.0403914 Vali Loss: 0.0508964 Test Loss: 0.0551263
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0374241
	speed: 0.0562s/iter; left time: 533.1406s
	iters: 200, epoch: 58 | loss: 0.0384800
	speed: 0.0266s/iter; left time: 250.2165s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:06.43s
Steps: 223 | Train Loss: 0.0404106 Vali Loss: 0.0509074 Test Loss: 0.0551193
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0425259
	speed: 0.0510s/iter; left time: 472.3618s
	iters: 200, epoch: 59 | loss: 0.0383911
	speed: 0.0300s/iter; left time: 275.1423s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:06.54s
Steps: 223 | Train Loss: 0.0403796 Vali Loss: 0.0508939 Test Loss: 0.0551248
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0411102
	speed: 0.0529s/iter; left time: 478.6612s
	iters: 200, epoch: 60 | loss: 0.0403990
	speed: 0.0263s/iter; left time: 235.0986s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:06.16s
Steps: 223 | Train Loss: 0.0403918 Vali Loss: 0.0508964 Test Loss: 0.0551259
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0418877
	speed: 0.0570s/iter; left time: 502.4903s
	iters: 200, epoch: 61 | loss: 0.0403620
	speed: 0.0272s/iter; left time: 236.8564s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:06.28s
Steps: 223 | Train Loss: 0.0403829 Vali Loss: 0.0509169 Test Loss: 0.0551298
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0394381
	speed: 0.0554s/iter; left time: 476.7332s
	iters: 200, epoch: 62 | loss: 0.0413030
	speed: 0.0270s/iter; left time: 229.3679s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:06.43s
Steps: 223 | Train Loss: 0.0403858 Vali Loss: 0.0509289 Test Loss: 0.0551388
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0361456
	speed: 0.0547s/iter; left time: 458.4112s
	iters: 200, epoch: 63 | loss: 0.0410837
	speed: 0.0283s/iter; left time: 234.1365s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:06.43s
Steps: 223 | Train Loss: 0.0403752 Vali Loss: 0.0509146 Test Loss: 0.0551340
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0410504
	speed: 0.0519s/iter; left time: 422.6970s
	iters: 200, epoch: 64 | loss: 0.0393771
	speed: 0.0273s/iter; left time: 220.1650s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.0403604 Vali Loss: 0.0509011 Test Loss: 0.0551318
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0404327
	speed: 0.0566s/iter; left time: 448.6071s
	iters: 200, epoch: 65 | loss: 0.0426011
	speed: 0.0267s/iter; left time: 209.0092s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:06.13s
Steps: 223 | Train Loss: 0.0403942 Vali Loss: 0.0509536 Test Loss: 0.0551359
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_512_24_FR_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010024277493357658, rmse:0.10012131184339523, mae:0.055130843073129654, rse:0.38626524806022644
Use GPU: cuda:0
>>>>>>>start training : FR_512_24_FR_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0906341
	speed: 0.0301s/iter; left time: 667.8155s
	iters: 200, epoch: 1 | loss: 0.0826328
	speed: 0.0263s/iter; left time: 582.0596s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.0938272 Vali Loss: 0.0805418 Test Loss: 0.0871429
Validation loss decreased (inf --> 0.080542).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0551709
	speed: 0.0576s/iter; left time: 1265.1429s
	iters: 200, epoch: 2 | loss: 0.0524309
	speed: 0.0271s/iter; left time: 592.0533s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.39s
Steps: 223 | Train Loss: 0.0558666 Vali Loss: 0.0584886 Test Loss: 0.0616178
Validation loss decreased (0.080542 --> 0.058489).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0486506
	speed: 0.0536s/iter; left time: 1166.1015s
	iters: 200, epoch: 3 | loss: 0.0469318
	speed: 0.0284s/iter; left time: 615.9902s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.37s
Steps: 223 | Train Loss: 0.0488140 Vali Loss: 0.0560299 Test Loss: 0.0600615
Validation loss decreased (0.058489 --> 0.056030).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0490200
	speed: 0.0527s/iter; left time: 1134.7966s
	iters: 200, epoch: 4 | loss: 0.0490843
	speed: 0.0289s/iter; left time: 619.4607s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.51s
Steps: 223 | Train Loss: 0.0470409 Vali Loss: 0.0548938 Test Loss: 0.0585970
Validation loss decreased (0.056030 --> 0.054894).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0493169
	speed: 0.0564s/iter; left time: 1202.6886s
	iters: 200, epoch: 5 | loss: 0.0423416
	speed: 0.0264s/iter; left time: 560.2763s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.17s
Steps: 223 | Train Loss: 0.0458134 Vali Loss: 0.0537671 Test Loss: 0.0576985
Validation loss decreased (0.054894 --> 0.053767).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0481958
	speed: 0.0571s/iter; left time: 1204.8272s
	iters: 200, epoch: 6 | loss: 0.0447032
	speed: 0.0268s/iter; left time: 561.8081s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.47s
Steps: 223 | Train Loss: 0.0449244 Vali Loss: 0.0531660 Test Loss: 0.0571905
Validation loss decreased (0.053767 --> 0.053166).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0444714
	speed: 0.0541s/iter; left time: 1128.9689s
	iters: 200, epoch: 7 | loss: 0.0447756
	speed: 0.0277s/iter; left time: 575.4594s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.40s
Steps: 223 | Train Loss: 0.0443288 Vali Loss: 0.0529909 Test Loss: 0.0570281
Validation loss decreased (0.053166 --> 0.052991).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0460659
	speed: 0.0543s/iter; left time: 1119.9415s
	iters: 200, epoch: 8 | loss: 0.0454672
	speed: 0.0291s/iter; left time: 598.5550s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.48s
Steps: 223 | Train Loss: 0.0438346 Vali Loss: 0.0530107 Test Loss: 0.0570792
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0458995
	speed: 0.0516s/iter; left time: 1054.2843s
	iters: 200, epoch: 9 | loss: 0.0426223
	speed: 0.0270s/iter; left time: 548.8238s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.0434338 Vali Loss: 0.0526153 Test Loss: 0.0565650
Validation loss decreased (0.052991 --> 0.052615).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0406584
	speed: 0.0555s/iter; left time: 1121.0964s
	iters: 200, epoch: 10 | loss: 0.0479837
	speed: 0.0265s/iter; left time: 533.0273s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.14s
Steps: 223 | Train Loss: 0.0430610 Vali Loss: 0.0523429 Test Loss: 0.0565098
Validation loss decreased (0.052615 --> 0.052343).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0441144
	speed: 0.0565s/iter; left time: 1127.7538s
	iters: 200, epoch: 11 | loss: 0.0424211
	speed: 0.0273s/iter; left time: 543.3858s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.55s
Steps: 223 | Train Loss: 0.0427796 Vali Loss: 0.0520273 Test Loss: 0.0561341
Validation loss decreased (0.052343 --> 0.052027).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0395642
	speed: 0.0539s/iter; left time: 1064.6384s
	iters: 200, epoch: 12 | loss: 0.0417812
	speed: 0.0275s/iter; left time: 541.1331s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.40s
Steps: 223 | Train Loss: 0.0424066 Vali Loss: 0.0522500 Test Loss: 0.0566746
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0465006
	speed: 0.0542s/iter; left time: 1057.6991s
	iters: 200, epoch: 13 | loss: 0.0409592
	speed: 0.0280s/iter; left time: 543.9767s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.43s
Steps: 223 | Train Loss: 0.0422092 Vali Loss: 0.0518321 Test Loss: 0.0560570
Validation loss decreased (0.052027 --> 0.051832).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0417979
	speed: 0.0529s/iter; left time: 1020.2572s
	iters: 200, epoch: 14 | loss: 0.0418281
	speed: 0.0271s/iter; left time: 520.0586s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.28s
Steps: 223 | Train Loss: 0.0420007 Vali Loss: 0.0518557 Test Loss: 0.0559012
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0409619
	speed: 0.0591s/iter; left time: 1127.5658s
	iters: 200, epoch: 15 | loss: 0.0422560
	speed: 0.0264s/iter; left time: 501.5630s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.20s
Steps: 223 | Train Loss: 0.0418025 Vali Loss: 0.0515299 Test Loss: 0.0558530
Validation loss decreased (0.051832 --> 0.051530).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0418751
	speed: 0.0557s/iter; left time: 1050.5298s
	iters: 200, epoch: 16 | loss: 0.0431925
	speed: 0.0278s/iter; left time: 521.2920s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.69s
Steps: 223 | Train Loss: 0.0416322 Vali Loss: 0.0516220 Test Loss: 0.0559839
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0416599
	speed: 0.0536s/iter; left time: 998.4634s
	iters: 200, epoch: 17 | loss: 0.0385930
	speed: 0.0288s/iter; left time: 533.5704s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.0415159 Vali Loss: 0.0515925 Test Loss: 0.0557896
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0403570
	speed: 0.0546s/iter; left time: 1005.0983s
	iters: 200, epoch: 18 | loss: 0.0396579
	speed: 0.0271s/iter; left time: 496.2408s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.0413374 Vali Loss: 0.0514856 Test Loss: 0.0555889
Validation loss decreased (0.051530 --> 0.051486).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0426625
	speed: 0.0550s/iter; left time: 999.9825s
	iters: 200, epoch: 19 | loss: 0.0415856
	speed: 0.0267s/iter; left time: 483.7707s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.22s
Steps: 223 | Train Loss: 0.0412477 Vali Loss: 0.0512750 Test Loss: 0.0556268
Validation loss decreased (0.051486 --> 0.051275).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0406603
	speed: 0.0572s/iter; left time: 1027.6752s
	iters: 200, epoch: 20 | loss: 0.0444297
	speed: 0.0266s/iter; left time: 475.1067s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.42s
Steps: 223 | Train Loss: 0.0412201 Vali Loss: 0.0512715 Test Loss: 0.0556442
Validation loss decreased (0.051275 --> 0.051271).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0446360
	speed: 0.0541s/iter; left time: 959.2371s
	iters: 200, epoch: 21 | loss: 0.0451247
	speed: 0.0288s/iter; left time: 508.2968s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.47s
Steps: 223 | Train Loss: 0.0410562 Vali Loss: 0.0510677 Test Loss: 0.0556257
Validation loss decreased (0.051271 --> 0.051068).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0413175
	speed: 0.0525s/iter; left time: 920.2055s
	iters: 200, epoch: 22 | loss: 0.0406883
	speed: 0.0282s/iter; left time: 491.7806s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.0409632 Vali Loss: 0.0511050 Test Loss: 0.0554848
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0413638
	speed: 0.0532s/iter; left time: 920.3822s
	iters: 200, epoch: 23 | loss: 0.0385806
	speed: 0.0282s/iter; left time: 485.0287s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.43s
Steps: 223 | Train Loss: 0.0408717 Vali Loss: 0.0511044 Test Loss: 0.0554944
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0418123
	speed: 0.0560s/iter; left time: 956.3025s
	iters: 200, epoch: 24 | loss: 0.0407323
	speed: 0.0265s/iter; left time: 450.2349s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.0408074 Vali Loss: 0.0511794 Test Loss: 0.0554869
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0389306
	speed: 0.0548s/iter; left time: 924.0469s
	iters: 200, epoch: 25 | loss: 0.0398802
	speed: 0.0273s/iter; left time: 457.7225s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.45s
Steps: 223 | Train Loss: 0.0407822 Vali Loss: 0.0511632 Test Loss: 0.0554472
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0406251
	speed: 0.0514s/iter; left time: 854.9484s
	iters: 200, epoch: 26 | loss: 0.0404109
	speed: 0.0297s/iter; left time: 491.0488s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.45s
Steps: 223 | Train Loss: 0.0406947 Vali Loss: 0.0510870 Test Loss: 0.0554563
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0426260
	speed: 0.0533s/iter; left time: 873.7834s
	iters: 200, epoch: 27 | loss: 0.0422118
	speed: 0.0264s/iter; left time: 430.1369s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.17s
Steps: 223 | Train Loss: 0.0406440 Vali Loss: 0.0510169 Test Loss: 0.0554277
Validation loss decreased (0.051068 --> 0.051017).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0433261
	speed: 0.0584s/iter; left time: 944.4422s
	iters: 200, epoch: 28 | loss: 0.0414303
	speed: 0.0272s/iter; left time: 438.1722s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.28s
Steps: 223 | Train Loss: 0.0406054 Vali Loss: 0.0510836 Test Loss: 0.0553864
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0386375
	speed: 0.0533s/iter; left time: 849.9980s
	iters: 200, epoch: 29 | loss: 0.0398392
	speed: 0.0267s/iter; left time: 422.6816s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.0405403 Vali Loss: 0.0510816 Test Loss: 0.0554030
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0395849
	speed: 0.0570s/iter; left time: 897.0832s
	iters: 200, epoch: 30 | loss: 0.0434685
	speed: 0.0287s/iter; left time: 447.9219s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.49s
Steps: 223 | Train Loss: 0.0405472 Vali Loss: 0.0509714 Test Loss: 0.0553758
Validation loss decreased (0.051017 --> 0.050971).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0404055
	speed: 0.0524s/iter; left time: 812.5939s
	iters: 200, epoch: 31 | loss: 0.0423716
	speed: 0.0274s/iter; left time: 422.9799s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.0404917 Vali Loss: 0.0509903 Test Loss: 0.0553255
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0410218
	speed: 0.0558s/iter; left time: 853.0859s
	iters: 200, epoch: 32 | loss: 0.0379313
	speed: 0.0265s/iter; left time: 403.1240s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.10s
Steps: 223 | Train Loss: 0.0404833 Vali Loss: 0.0509146 Test Loss: 0.0553534
Validation loss decreased (0.050971 --> 0.050915).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0403348
	speed: 0.0554s/iter; left time: 834.4094s
	iters: 200, epoch: 33 | loss: 0.0399958
	speed: 0.0270s/iter; left time: 404.0324s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.41s
Steps: 223 | Train Loss: 0.0404073 Vali Loss: 0.0508854 Test Loss: 0.0553828
Validation loss decreased (0.050915 --> 0.050885).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0402859
	speed: 0.0528s/iter; left time: 784.3565s
	iters: 200, epoch: 34 | loss: 0.0393198
	speed: 0.0278s/iter; left time: 410.3908s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.0404330 Vali Loss: 0.0509054 Test Loss: 0.0553213
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0399488
	speed: 0.0524s/iter; left time: 766.7168s
	iters: 200, epoch: 35 | loss: 0.0390085
	speed: 0.0271s/iter; left time: 392.9306s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.0403941 Vali Loss: 0.0509035 Test Loss: 0.0553123
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0437253
	speed: 0.0543s/iter; left time: 781.3251s
	iters: 200, epoch: 36 | loss: 0.0389777
	speed: 0.0265s/iter; left time: 379.4889s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.24s
Steps: 223 | Train Loss: 0.0403536 Vali Loss: 0.0508838 Test Loss: 0.0553374
Validation loss decreased (0.050885 --> 0.050884).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0410785
	speed: 0.0546s/iter; left time: 773.2454s
	iters: 200, epoch: 37 | loss: 0.0399544
	speed: 0.0268s/iter; left time: 377.0510s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.37s
Steps: 223 | Train Loss: 0.0403515 Vali Loss: 0.0509292 Test Loss: 0.0553296
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0391543
	speed: 0.0525s/iter; left time: 732.7616s
	iters: 200, epoch: 38 | loss: 0.0413559
	speed: 0.0273s/iter; left time: 378.2236s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.35s
Steps: 223 | Train Loss: 0.0403439 Vali Loss: 0.0508500 Test Loss: 0.0553205
Validation loss decreased (0.050884 --> 0.050850).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0417169
	speed: 0.0569s/iter; left time: 780.8474s
	iters: 200, epoch: 39 | loss: 0.0405512
	speed: 0.0267s/iter; left time: 363.2913s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.15s
Steps: 223 | Train Loss: 0.0403442 Vali Loss: 0.0508796 Test Loss: 0.0553248
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0447844
	speed: 0.0542s/iter; left time: 731.6767s
	iters: 200, epoch: 40 | loss: 0.0395523
	speed: 0.0269s/iter; left time: 360.2602s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.0403389 Vali Loss: 0.0507638 Test Loss: 0.0552910
Validation loss decreased (0.050850 --> 0.050764).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0417288
	speed: 0.0538s/iter; left time: 714.9267s
	iters: 200, epoch: 41 | loss: 0.0412049
	speed: 0.0273s/iter; left time: 359.9401s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.0403560 Vali Loss: 0.0508435 Test Loss: 0.0553101
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0378692
	speed: 0.0529s/iter; left time: 690.6556s
	iters: 200, epoch: 42 | loss: 0.0401617
	speed: 0.0272s/iter; left time: 351.9640s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.43s
Steps: 223 | Train Loss: 0.0403200 Vali Loss: 0.0508418 Test Loss: 0.0553548
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0384229
	speed: 0.0534s/iter; left time: 685.2592s
	iters: 200, epoch: 43 | loss: 0.0370391
	speed: 0.0282s/iter; left time: 359.0381s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.0402477 Vali Loss: 0.0508064 Test Loss: 0.0553414
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0432439
	speed: 0.0566s/iter; left time: 713.6192s
	iters: 200, epoch: 44 | loss: 0.0400607
	speed: 0.0265s/iter; left time: 331.6480s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.0402985 Vali Loss: 0.0508538 Test Loss: 0.0553522
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0387721
	speed: 0.0530s/iter; left time: 656.5277s
	iters: 200, epoch: 45 | loss: 0.0426491
	speed: 0.0284s/iter; left time: 349.5811s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.44s
Steps: 223 | Train Loss: 0.0402648 Vali Loss: 0.0508805 Test Loss: 0.0553688
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0391906
	speed: 0.0538s/iter; left time: 654.6966s
	iters: 200, epoch: 46 | loss: 0.0383839
	speed: 0.0274s/iter; left time: 331.1835s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.0401979 Vali Loss: 0.0508143 Test Loss: 0.0553381
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0380304
	speed: 0.0531s/iter; left time: 634.4437s
	iters: 200, epoch: 47 | loss: 0.0415097
	speed: 0.0281s/iter; left time: 332.6533s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.35s
Steps: 223 | Train Loss: 0.0402226 Vali Loss: 0.0507866 Test Loss: 0.0553593
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0386002
	speed: 0.0554s/iter; left time: 649.1937s
	iters: 200, epoch: 48 | loss: 0.0388776
	speed: 0.0274s/iter; left time: 318.6836s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.39s
Steps: 223 | Train Loss: 0.0401984 Vali Loss: 0.0508578 Test Loss: 0.0553353
EarlyStopping counter: 8 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0421254
	speed: 0.0550s/iter; left time: 632.6324s
	iters: 200, epoch: 49 | loss: 0.0385936
	speed: 0.0279s/iter; left time: 318.3210s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.49s
Steps: 223 | Train Loss: 0.0402498 Vali Loss: 0.0508001 Test Loss: 0.0553192
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0405090
	speed: 0.0519s/iter; left time: 584.6391s
	iters: 200, epoch: 50 | loss: 0.0411080
	speed: 0.0275s/iter; left time: 307.4834s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.0402468 Vali Loss: 0.0508563 Test Loss: 0.0553059
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_512_24_FR_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010074619203805923, rmse:0.10037240386009216, mae:0.055291011929512024, rse:0.3872339427471161
Intermediate time for FR and pred_len 24: 00h:15m:47.95s
=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_512_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_512_96_FR_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0946442
	speed: 0.0544s/iter; left time: 1201.8179s
	iters: 200, epoch: 1 | loss: 0.0807172
	speed: 0.0280s/iter; left time: 615.1434s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.67s
Steps: 222 | Train Loss: 0.0976983 Vali Loss: 0.0885321 Test Loss: 0.0971842
Validation loss decreased (inf --> 0.088532).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0723190
	speed: 0.0547s/iter; left time: 1197.6152s
	iters: 200, epoch: 2 | loss: 0.0639201
	speed: 0.0271s/iter; left time: 589.6803s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.31s
Steps: 222 | Train Loss: 0.0691408 Vali Loss: 0.0740071 Test Loss: 0.0823792
Validation loss decreased (0.088532 --> 0.074007).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0629653
	speed: 0.0547s/iter; left time: 1183.5931s
	iters: 200, epoch: 3 | loss: 0.0609960
	speed: 0.0295s/iter; left time: 635.9466s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.53s
Steps: 222 | Train Loss: 0.0631580 Vali Loss: 0.0724165 Test Loss: 0.0810770
Validation loss decreased (0.074007 --> 0.072416).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0591992
	speed: 0.0530s/iter; left time: 1135.7080s
	iters: 200, epoch: 4 | loss: 0.0622611
	speed: 0.0286s/iter; left time: 609.7092s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.59s
Steps: 222 | Train Loss: 0.0616025 Vali Loss: 0.0718696 Test Loss: 0.0810709
Validation loss decreased (0.072416 --> 0.071870).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0633924
	speed: 0.0580s/iter; left time: 1231.3352s
	iters: 200, epoch: 5 | loss: 0.0584497
	speed: 0.0269s/iter; left time: 567.1046s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.18s
Steps: 222 | Train Loss: 0.0605206 Vali Loss: 0.0706461 Test Loss: 0.0808803
Validation loss decreased (0.071870 --> 0.070646).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0617116
	speed: 0.0574s/iter; left time: 1203.8881s
	iters: 200, epoch: 6 | loss: 0.0603344
	speed: 0.0279s/iter; left time: 581.8664s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.53s
Steps: 222 | Train Loss: 0.0597658 Vali Loss: 0.0708851 Test Loss: 0.0804708
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0572835
	speed: 0.0551s/iter; left time: 1143.7419s
	iters: 200, epoch: 7 | loss: 0.0595429
	speed: 0.0276s/iter; left time: 569.7530s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.38s
Steps: 222 | Train Loss: 0.0592192 Vali Loss: 0.0702724 Test Loss: 0.0811357
Validation loss decreased (0.070646 --> 0.070272).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0600042
	speed: 0.0542s/iter; left time: 1114.4691s
	iters: 200, epoch: 8 | loss: 0.0576544
	speed: 0.0292s/iter; left time: 597.5231s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.53s
Steps: 222 | Train Loss: 0.0586930 Vali Loss: 0.0699404 Test Loss: 0.0809467
Validation loss decreased (0.070272 --> 0.069940).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0586163
	speed: 0.0551s/iter; left time: 1119.9328s
	iters: 200, epoch: 9 | loss: 0.0577755
	speed: 0.0277s/iter; left time: 560.5701s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.37s
Steps: 222 | Train Loss: 0.0582909 Vali Loss: 0.0698899 Test Loss: 0.0808146
Validation loss decreased (0.069940 --> 0.069890).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0633654
	speed: 0.0606s/iter; left time: 1218.7369s
	iters: 200, epoch: 10 | loss: 0.0593716
	speed: 0.0269s/iter; left time: 537.4502s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.24s
Steps: 222 | Train Loss: 0.0578296 Vali Loss: 0.0697316 Test Loss: 0.0806795
Validation loss decreased (0.069890 --> 0.069732).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0568299
	speed: 0.0564s/iter; left time: 1121.0738s
	iters: 200, epoch: 11 | loss: 0.0571765
	speed: 0.0281s/iter; left time: 556.7197s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.72s
Steps: 222 | Train Loss: 0.0575434 Vali Loss: 0.0695331 Test Loss: 0.0808393
Validation loss decreased (0.069732 --> 0.069533).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0532095
	speed: 0.0540s/iter; left time: 1061.8762s
	iters: 200, epoch: 12 | loss: 0.0552783
	speed: 0.0286s/iter; left time: 559.9761s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.44s
Steps: 222 | Train Loss: 0.0572077 Vali Loss: 0.0695406 Test Loss: 0.0809313
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0564464
	speed: 0.0544s/iter; left time: 1058.2301s
	iters: 200, epoch: 13 | loss: 0.0570819
	speed: 0.0273s/iter; left time: 527.6275s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.41s
Steps: 222 | Train Loss: 0.0568615 Vali Loss: 0.0693137 Test Loss: 0.0810390
Validation loss decreased (0.069533 --> 0.069314).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0539912
	speed: 0.0568s/iter; left time: 1090.8423s
	iters: 200, epoch: 14 | loss: 0.0568080
	speed: 0.0266s/iter; left time: 507.6309s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.18s
Steps: 222 | Train Loss: 0.0565855 Vali Loss: 0.0695845 Test Loss: 0.0809268
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0593582
	speed: 0.0516s/iter; left time: 979.2710s
	iters: 200, epoch: 15 | loss: 0.0566474
	speed: 0.0271s/iter; left time: 511.1532s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.17s
Steps: 222 | Train Loss: 0.0563461 Vali Loss: 0.0693047 Test Loss: 0.0811887
Validation loss decreased (0.069314 --> 0.069305).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0594476
	speed: 0.0555s/iter; left time: 1040.9186s
	iters: 200, epoch: 16 | loss: 0.0533540
	speed: 0.0293s/iter; left time: 546.7886s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.66s
Steps: 222 | Train Loss: 0.0560892 Vali Loss: 0.0693481 Test Loss: 0.0814752
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0553667
	speed: 0.0528s/iter; left time: 979.3788s
	iters: 200, epoch: 17 | loss: 0.0557630
	speed: 0.0302s/iter; left time: 556.7782s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.56s
Steps: 222 | Train Loss: 0.0558328 Vali Loss: 0.0694838 Test Loss: 0.0814889
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0601683
	speed: 0.0535s/iter; left time: 980.2696s
	iters: 200, epoch: 18 | loss: 0.0555220
	speed: 0.0278s/iter; left time: 506.1241s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.34s
Steps: 222 | Train Loss: 0.0556501 Vali Loss: 0.0696565 Test Loss: 0.0816849
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0553780
	speed: 0.0552s/iter; left time: 999.6674s
	iters: 200, epoch: 19 | loss: 0.0562586
	speed: 0.0275s/iter; left time: 495.4604s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.43s
Steps: 222 | Train Loss: 0.0554732 Vali Loss: 0.0695040 Test Loss: 0.0815747
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0575418
	speed: 0.0550s/iter; left time: 983.9110s
	iters: 200, epoch: 20 | loss: 0.0529493
	speed: 0.0278s/iter; left time: 494.1149s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.35s
Steps: 222 | Train Loss: 0.0552923 Vali Loss: 0.0695789 Test Loss: 0.0819936
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0552874
	speed: 0.0537s/iter; left time: 949.1304s
	iters: 200, epoch: 21 | loss: 0.0571044
	speed: 0.0302s/iter; left time: 530.9708s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.75s
Steps: 222 | Train Loss: 0.0551806 Vali Loss: 0.0696505 Test Loss: 0.0819064
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0523697
	speed: 0.0560s/iter; left time: 975.7897s
	iters: 200, epoch: 22 | loss: 0.0539634
	speed: 0.0272s/iter; left time: 471.0802s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.23s
Steps: 222 | Train Loss: 0.0550097 Vali Loss: 0.0697481 Test Loss: 0.0818706
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0570134
	speed: 0.0566s/iter; left time: 973.8350s
	iters: 200, epoch: 23 | loss: 0.0503240
	speed: 0.0277s/iter; left time: 473.4388s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.45s
Steps: 222 | Train Loss: 0.0549191 Vali Loss: 0.0695426 Test Loss: 0.0819507
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0564718
	speed: 0.0544s/iter; left time: 924.8548s
	iters: 200, epoch: 24 | loss: 0.0560874
	speed: 0.0284s/iter; left time: 479.1639s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.45s
Steps: 222 | Train Loss: 0.0547920 Vali Loss: 0.0694288 Test Loss: 0.0827027
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0538619
	speed: 0.0546s/iter; left time: 916.5744s
	iters: 200, epoch: 25 | loss: 0.0557052
	speed: 0.0294s/iter; left time: 490.9115s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.63s
Steps: 222 | Train Loss: 0.0546779 Vali Loss: 0.0694937 Test Loss: 0.0824538
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_512_96_FR_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019583983346819878, rmse:0.13994278013706207, mae:0.08118870854377747, rse:0.5413358807563782
Use GPU: cuda:0
>>>>>>>start training : FR_512_96_FR_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0952129
	speed: 0.0302s/iter; left time: 667.3766s
	iters: 200, epoch: 1 | loss: 0.0885167
	speed: 0.0308s/iter; left time: 677.5023s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.77s
Steps: 222 | Train Loss: 0.0985027 Vali Loss: 0.0886972 Test Loss: 0.0972691
Validation loss decreased (inf --> 0.088697).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0681498
	speed: 0.0563s/iter; left time: 1232.1622s
	iters: 200, epoch: 2 | loss: 0.0649547
	speed: 0.0270s/iter; left time: 587.0453s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.27s
Steps: 222 | Train Loss: 0.0695079 Vali Loss: 0.0742967 Test Loss: 0.0827173
Validation loss decreased (0.088697 --> 0.074297).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0636618
	speed: 0.0621s/iter; left time: 1344.9321s
	iters: 200, epoch: 3 | loss: 0.0675858
	speed: 0.0272s/iter; left time: 585.7517s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.63s
Steps: 222 | Train Loss: 0.0632788 Vali Loss: 0.0724602 Test Loss: 0.0818352
Validation loss decreased (0.074297 --> 0.072460).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0607947
	speed: 0.0583s/iter; left time: 1248.7349s
	iters: 200, epoch: 4 | loss: 0.0615927
	speed: 0.0288s/iter; left time: 613.5707s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.73s
Steps: 222 | Train Loss: 0.0616307 Vali Loss: 0.0715656 Test Loss: 0.0804375
Validation loss decreased (0.072460 --> 0.071566).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0622085
	speed: 0.0546s/iter; left time: 1158.1798s
	iters: 200, epoch: 5 | loss: 0.0607410
	speed: 0.0310s/iter; left time: 653.6964s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.66s
Steps: 222 | Train Loss: 0.0605575 Vali Loss: 0.0711619 Test Loss: 0.0811173
Validation loss decreased (0.071566 --> 0.071162).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0583275
	speed: 0.0554s/iter; left time: 1163.7437s
	iters: 200, epoch: 6 | loss: 0.0605036
	speed: 0.0276s/iter; left time: 576.9671s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.47s
Steps: 222 | Train Loss: 0.0598762 Vali Loss: 0.0707136 Test Loss: 0.0810201
Validation loss decreased (0.071162 --> 0.070714).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0571717
	speed: 0.0581s/iter; left time: 1205.9736s
	iters: 200, epoch: 7 | loss: 0.0580162
	speed: 0.0270s/iter; left time: 558.6626s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.23s
Steps: 222 | Train Loss: 0.0591734 Vali Loss: 0.0701467 Test Loss: 0.0805756
Validation loss decreased (0.070714 --> 0.070147).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0549409
	speed: 0.0596s/iter; left time: 1225.5543s
	iters: 200, epoch: 8 | loss: 0.0589893
	speed: 0.0269s/iter; left time: 549.6732s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.76s
Steps: 222 | Train Loss: 0.0587496 Vali Loss: 0.0706592 Test Loss: 0.0805735
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0562943
	speed: 0.0540s/iter; left time: 1097.0223s
	iters: 200, epoch: 9 | loss: 0.0623835
	speed: 0.0310s/iter; left time: 626.0642s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.70s
Steps: 222 | Train Loss: 0.0582612 Vali Loss: 0.0701556 Test Loss: 0.0809764
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0560510
	speed: 0.0546s/iter; left time: 1098.6045s
	iters: 200, epoch: 10 | loss: 0.0569311
	speed: 0.0277s/iter; left time: 553.6848s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.46s
Steps: 222 | Train Loss: 0.0579194 Vali Loss: 0.0698631 Test Loss: 0.0805883
Validation loss decreased (0.070147 --> 0.069863).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0552880
	speed: 0.0576s/iter; left time: 1145.5217s
	iters: 200, epoch: 11 | loss: 0.0567831
	speed: 0.0276s/iter; left time: 546.6307s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.37s
Steps: 222 | Train Loss: 0.0575630 Vali Loss: 0.0698857 Test Loss: 0.0814239
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0589652
	speed: 0.0585s/iter; left time: 1149.6359s
	iters: 200, epoch: 12 | loss: 0.0571650
	speed: 0.0272s/iter; left time: 531.7563s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.45s
Steps: 222 | Train Loss: 0.0572331 Vali Loss: 0.0696580 Test Loss: 0.0805479
Validation loss decreased (0.069863 --> 0.069658).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0596699
	speed: 0.0590s/iter; left time: 1146.2923s
	iters: 200, epoch: 13 | loss: 0.0586063
	speed: 0.0274s/iter; left time: 529.5397s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.64s
Steps: 222 | Train Loss: 0.0569622 Vali Loss: 0.0694498 Test Loss: 0.0804356
Validation loss decreased (0.069658 --> 0.069450).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0589501
	speed: 0.0537s/iter; left time: 1032.2106s
	iters: 200, epoch: 14 | loss: 0.0569431
	speed: 0.0325s/iter; left time: 620.9112s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.77s
Steps: 222 | Train Loss: 0.0566912 Vali Loss: 0.0693219 Test Loss: 0.0799958
Validation loss decreased (0.069450 --> 0.069322).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0506507
	speed: 0.0546s/iter; left time: 1037.9295s
	iters: 200, epoch: 15 | loss: 0.0569483
	speed: 0.0267s/iter; left time: 503.9097s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.31s
Steps: 222 | Train Loss: 0.0564393 Vali Loss: 0.0695112 Test Loss: 0.0806874
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0580912
	speed: 0.0570s/iter; left time: 1069.7731s
	iters: 200, epoch: 16 | loss: 0.0560368
	speed: 0.0276s/iter; left time: 514.8626s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.35s
Steps: 222 | Train Loss: 0.0562285 Vali Loss: 0.0692488 Test Loss: 0.0806654
Validation loss decreased (0.069322 --> 0.069249).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0560966
	speed: 0.0579s/iter; left time: 1074.1554s
	iters: 200, epoch: 17 | loss: 0.0546358
	speed: 0.0272s/iter; left time: 501.0310s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.51s
Steps: 222 | Train Loss: 0.0560600 Vali Loss: 0.0693445 Test Loss: 0.0808701
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0536982
	speed: 0.0545s/iter; left time: 998.5697s
	iters: 200, epoch: 18 | loss: 0.0576510
	speed: 0.0297s/iter; left time: 541.3484s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.49s
Steps: 222 | Train Loss: 0.0558209 Vali Loss: 0.0692960 Test Loss: 0.0809055
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0568429
	speed: 0.0538s/iter; left time: 974.8709s
	iters: 200, epoch: 19 | loss: 0.0548730
	speed: 0.0272s/iter; left time: 488.8693s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.37s
Steps: 222 | Train Loss: 0.0556284 Vali Loss: 0.0691479 Test Loss: 0.0808090
Validation loss decreased (0.069249 --> 0.069148).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0542075
	speed: 0.0588s/iter; left time: 1052.1349s
	iters: 200, epoch: 20 | loss: 0.0543660
	speed: 0.0270s/iter; left time: 480.1171s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.25s
Steps: 222 | Train Loss: 0.0555214 Vali Loss: 0.0692614 Test Loss: 0.0808009
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0560614
	speed: 0.0583s/iter; left time: 1029.5537s
	iters: 200, epoch: 21 | loss: 0.0538527
	speed: 0.0276s/iter; left time: 483.8444s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.82s
Steps: 222 | Train Loss: 0.0553980 Vali Loss: 0.0693827 Test Loss: 0.0812554
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0574554
	speed: 0.0532s/iter; left time: 927.7367s
	iters: 200, epoch: 22 | loss: 0.0532297
	speed: 0.0295s/iter; left time: 511.7947s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.48s
Steps: 222 | Train Loss: 0.0552347 Vali Loss: 0.0692179 Test Loss: 0.0811274
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0512069
	speed: 0.0557s/iter; left time: 958.7464s
	iters: 200, epoch: 23 | loss: 0.0576784
	speed: 0.0279s/iter; left time: 476.9861s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.43s
Steps: 222 | Train Loss: 0.0551042 Vali Loss: 0.0693131 Test Loss: 0.0809331
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0545038
	speed: 0.0566s/iter; left time: 961.7671s
	iters: 200, epoch: 24 | loss: 0.0525213
	speed: 0.0287s/iter; left time: 484.4429s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.52s
Steps: 222 | Train Loss: 0.0549631 Vali Loss: 0.0693683 Test Loss: 0.0808207
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0531886
	speed: 0.0581s/iter; left time: 974.3355s
	iters: 200, epoch: 25 | loss: 0.0607770
	speed: 0.0270s/iter; left time: 450.1486s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.50s
Steps: 222 | Train Loss: 0.0548838 Vali Loss: 0.0693077 Test Loss: 0.0809227
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0545997
	speed: 0.0576s/iter; left time: 953.2549s
	iters: 200, epoch: 26 | loss: 0.0549107
	speed: 0.0294s/iter; left time: 483.4316s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.82s
Steps: 222 | Train Loss: 0.0547993 Vali Loss: 0.0692610 Test Loss: 0.0812203
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0559376
	speed: 0.0530s/iter; left time: 865.3901s
	iters: 200, epoch: 27 | loss: 0.0532648
	speed: 0.0288s/iter; left time: 467.0515s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.50s
Steps: 222 | Train Loss: 0.0547550 Vali Loss: 0.0691140 Test Loss: 0.0808653
Validation loss decreased (0.069148 --> 0.069114).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0582528
	speed: 0.0569s/iter; left time: 915.8264s
	iters: 200, epoch: 28 | loss: 0.0525920
	speed: 0.0273s/iter; left time: 436.6005s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.36s
Steps: 222 | Train Loss: 0.0546527 Vali Loss: 0.0690959 Test Loss: 0.0806358
Validation loss decreased (0.069114 --> 0.069096).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0547554
	speed: 0.0570s/iter; left time: 905.6622s
	iters: 200, epoch: 29 | loss: 0.0558492
	speed: 0.0281s/iter; left time: 444.1322s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.45s
Steps: 222 | Train Loss: 0.0545580 Vali Loss: 0.0692201 Test Loss: 0.0810624
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0513949
	speed: 0.0554s/iter; left time: 867.4813s
	iters: 200, epoch: 30 | loss: 0.0538825
	speed: 0.0268s/iter; left time: 417.5614s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.37s
Steps: 222 | Train Loss: 0.0545313 Vali Loss: 0.0691521 Test Loss: 0.0810161
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0517632
	speed: 0.0559s/iter; left time: 862.8661s
	iters: 200, epoch: 31 | loss: 0.0539208
	speed: 0.0308s/iter; left time: 472.2136s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.81s
Steps: 222 | Train Loss: 0.0545053 Vali Loss: 0.0692572 Test Loss: 0.0809226
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0550982
	speed: 0.0542s/iter; left time: 824.9185s
	iters: 200, epoch: 32 | loss: 0.0533233
	speed: 0.0273s/iter; left time: 412.3777s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.22s
Steps: 222 | Train Loss: 0.0544201 Vali Loss: 0.0691529 Test Loss: 0.0810605
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0533810
	speed: 0.0567s/iter; left time: 850.9174s
	iters: 200, epoch: 33 | loss: 0.0557891
	speed: 0.0270s/iter; left time: 402.8039s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.46s
Steps: 222 | Train Loss: 0.0543391 Vali Loss: 0.0690889 Test Loss: 0.0809323
Validation loss decreased (0.069096 --> 0.069089).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0543540
	speed: 0.0533s/iter; left time: 787.3487s
	iters: 200, epoch: 34 | loss: 0.0501789
	speed: 0.0319s/iter; left time: 467.4994s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.74s
Steps: 222 | Train Loss: 0.0543403 Vali Loss: 0.0692075 Test Loss: 0.0809898
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0572097
	speed: 0.0542s/iter; left time: 789.1576s
	iters: 200, epoch: 35 | loss: 0.0554948
	speed: 0.0274s/iter; left time: 396.0129s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.28s
Steps: 222 | Train Loss: 0.0543257 Vali Loss: 0.0691925 Test Loss: 0.0809306
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0536229
	speed: 0.0581s/iter; left time: 832.6273s
	iters: 200, epoch: 36 | loss: 0.0524175
	speed: 0.0276s/iter; left time: 392.3999s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.52s
Steps: 222 | Train Loss: 0.0542763 Vali Loss: 0.0691631 Test Loss: 0.0809931
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0568595
	speed: 0.0557s/iter; left time: 786.2092s
	iters: 200, epoch: 37 | loss: 0.0558364
	speed: 0.0270s/iter; left time: 378.3150s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.37s
Steps: 222 | Train Loss: 0.0542079 Vali Loss: 0.0692795 Test Loss: 0.0810558
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0523561
	speed: 0.0560s/iter; left time: 777.7551s
	iters: 200, epoch: 38 | loss: 0.0541448
	speed: 0.0290s/iter; left time: 400.1546s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.61s
Steps: 222 | Train Loss: 0.0541932 Vali Loss: 0.0691731 Test Loss: 0.0809929
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0515040
	speed: 0.0532s/iter; left time: 727.3661s
	iters: 200, epoch: 39 | loss: 0.0538739
	speed: 0.0318s/iter; left time: 430.8552s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.85s
Steps: 222 | Train Loss: 0.0542231 Vali Loss: 0.0692040 Test Loss: 0.0808713
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0547240
	speed: 0.0587s/iter; left time: 789.4755s
	iters: 200, epoch: 40 | loss: 0.0544746
	speed: 0.0281s/iter; left time: 374.8394s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.52s
Steps: 222 | Train Loss: 0.0541712 Vali Loss: 0.0691869 Test Loss: 0.0810898
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0535738
	speed: 0.0576s/iter; left time: 762.1386s
	iters: 200, epoch: 41 | loss: 0.0521586
	speed: 0.0274s/iter; left time: 359.0971s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.38s
Steps: 222 | Train Loss: 0.0541541 Vali Loss: 0.0692053 Test Loss: 0.0810138
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0560169
	speed: 0.0569s/iter; left time: 739.6913s
	iters: 200, epoch: 42 | loss: 0.0550496
	speed: 0.0286s/iter; left time: 368.3939s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.76s
Steps: 222 | Train Loss: 0.0541010 Vali Loss: 0.0692285 Test Loss: 0.0811099
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0485699
	speed: 0.0567s/iter; left time: 724.9226s
	iters: 200, epoch: 43 | loss: 0.0563646
	speed: 0.0295s/iter; left time: 374.5099s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.59s
Steps: 222 | Train Loss: 0.0541447 Vali Loss: 0.0692108 Test Loss: 0.0810611
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_512_96_FR_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019895073026418686, rmse:0.14104989171028137, mae:0.08093231916427612, rse:0.54561847448349
Intermediate time for FR and pred_len 96: 00h:09m:44.74s
=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_512_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_512_168_FR_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0938556
	speed: 0.0537s/iter; left time: 1187.7679s
	iters: 200, epoch: 1 | loss: 0.0854498
	speed: 0.0275s/iter; left time: 605.2973s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.63s
Steps: 222 | Train Loss: 0.0996454 Vali Loss: 0.0909195 Test Loss: 0.0982277
Validation loss decreased (inf --> 0.090919).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0675109
	speed: 0.0616s/iter; left time: 1348.6246s
	iters: 200, epoch: 2 | loss: 0.0670425
	speed: 0.0271s/iter; left time: 591.2223s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.28s
Steps: 222 | Train Loss: 0.0727755 Vali Loss: 0.0776914 Test Loss: 0.0867592
Validation loss decreased (0.090919 --> 0.077691).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0661314
	speed: 0.0576s/iter; left time: 1247.1888s
	iters: 200, epoch: 3 | loss: 0.0677241
	speed: 0.0282s/iter; left time: 608.7326s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.75s
Steps: 222 | Train Loss: 0.0669249 Vali Loss: 0.0761548 Test Loss: 0.0854462
Validation loss decreased (0.077691 --> 0.076155).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0679322
	speed: 0.0568s/iter; left time: 1217.4635s
	iters: 200, epoch: 4 | loss: 0.0632045
	speed: 0.0299s/iter; left time: 637.3804s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.66s
Steps: 222 | Train Loss: 0.0654356 Vali Loss: 0.0749669 Test Loss: 0.0855714
Validation loss decreased (0.076155 --> 0.074967).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0612492
	speed: 0.0552s/iter; left time: 1171.6811s
	iters: 200, epoch: 5 | loss: 0.0665668
	speed: 0.0289s/iter; left time: 609.3408s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.62s
Steps: 222 | Train Loss: 0.0643432 Vali Loss: 0.0746899 Test Loss: 0.0860002
Validation loss decreased (0.074967 --> 0.074690).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0619588
	speed: 0.0563s/iter; left time: 1181.4707s
	iters: 200, epoch: 6 | loss: 0.0662285
	speed: 0.0271s/iter; left time: 566.1069s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.22s
Steps: 222 | Train Loss: 0.0634915 Vali Loss: 0.0741637 Test Loss: 0.0862336
Validation loss decreased (0.074690 --> 0.074164).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0630885
	speed: 0.0599s/iter; left time: 1244.1855s
	iters: 200, epoch: 7 | loss: 0.0668416
	speed: 0.0271s/iter; left time: 560.3539s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.63s
Steps: 222 | Train Loss: 0.0628616 Vali Loss: 0.0739373 Test Loss: 0.0866496
Validation loss decreased (0.074164 --> 0.073937).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0633949
	speed: 0.0595s/iter; left time: 1222.1403s
	iters: 200, epoch: 8 | loss: 0.0597458
	speed: 0.0301s/iter; left time: 615.7145s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.95s
Steps: 222 | Train Loss: 0.0622367 Vali Loss: 0.0738674 Test Loss: 0.0874078
Validation loss decreased (0.073937 --> 0.073867).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0600061
	speed: 0.0550s/iter; left time: 1118.5541s
	iters: 200, epoch: 9 | loss: 0.0622538
	speed: 0.0301s/iter; left time: 608.4521s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.57s
Steps: 222 | Train Loss: 0.0617032 Vali Loss: 0.0734540 Test Loss: 0.0876739
Validation loss decreased (0.073867 --> 0.073454).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0591503
	speed: 0.0574s/iter; left time: 1153.2995s
	iters: 200, epoch: 10 | loss: 0.0608495
	speed: 0.0293s/iter; left time: 585.8230s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.58s
Steps: 222 | Train Loss: 0.0612152 Vali Loss: 0.0735651 Test Loss: 0.0878582
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0628291
	speed: 0.0580s/iter; left time: 1152.1630s
	iters: 200, epoch: 11 | loss: 0.0591405
	speed: 0.0276s/iter; left time: 546.4493s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.39s
Steps: 222 | Train Loss: 0.0608145 Vali Loss: 0.0734721 Test Loss: 0.0884252
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0628089
	speed: 0.0565s/iter; left time: 1110.0706s
	iters: 200, epoch: 12 | loss: 0.0601851
	speed: 0.0275s/iter; left time: 537.0279s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.48s
Steps: 222 | Train Loss: 0.0604573 Vali Loss: 0.0732824 Test Loss: 0.0882674
Validation loss decreased (0.073454 --> 0.073282).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0586489
	speed: 0.0549s/iter; left time: 1067.0806s
	iters: 200, epoch: 13 | loss: 0.0620482
	speed: 0.0302s/iter; left time: 583.8290s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.64s
Steps: 222 | Train Loss: 0.0600379 Vali Loss: 0.0735289 Test Loss: 0.0874406
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0555771
	speed: 0.0543s/iter; left time: 1044.1961s
	iters: 200, epoch: 14 | loss: 0.0605145
	speed: 0.0276s/iter; left time: 527.9006s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.66s
Steps: 222 | Train Loss: 0.0596907 Vali Loss: 0.0732599 Test Loss: 0.0885390
Validation loss decreased (0.073282 --> 0.073260).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0584461
	speed: 0.0618s/iter; left time: 1173.1642s
	iters: 200, epoch: 15 | loss: 0.0568878
	speed: 0.0271s/iter; left time: 511.3060s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.54s
Steps: 222 | Train Loss: 0.0593595 Vali Loss: 0.0733622 Test Loss: 0.0882639
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0593707
	speed: 0.0574s/iter; left time: 1076.9710s
	iters: 200, epoch: 16 | loss: 0.0584661
	speed: 0.0274s/iter; left time: 512.4154s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.50s
Steps: 222 | Train Loss: 0.0590356 Vali Loss: 0.0734783 Test Loss: 0.0876160
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0588905
	speed: 0.0564s/iter; left time: 1045.8583s
	iters: 200, epoch: 17 | loss: 0.0621994
	speed: 0.0304s/iter; left time: 560.8945s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.78s
Steps: 222 | Train Loss: 0.0587787 Vali Loss: 0.0732299 Test Loss: 0.0877349
Validation loss decreased (0.073260 --> 0.073230).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0621530
	speed: 0.0544s/iter; left time: 996.3035s
	iters: 200, epoch: 18 | loss: 0.0605658
	speed: 0.0306s/iter; left time: 556.9153s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.75s
Steps: 222 | Train Loss: 0.0585481 Vali Loss: 0.0734606 Test Loss: 0.0877434
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0583042
	speed: 0.0553s/iter; left time: 1000.5556s
	iters: 200, epoch: 19 | loss: 0.0605425
	speed: 0.0278s/iter; left time: 500.8201s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.41s
Steps: 222 | Train Loss: 0.0582981 Vali Loss: 0.0732683 Test Loss: 0.0879471
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0579087
	speed: 0.0598s/iter; left time: 1069.7862s
	iters: 200, epoch: 20 | loss: 0.0559152
	speed: 0.0272s/iter; left time: 484.2515s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.48s
Steps: 222 | Train Loss: 0.0581190 Vali Loss: 0.0734302 Test Loss: 0.0868313
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0566728
	speed: 0.0571s/iter; left time: 1009.1655s
	iters: 200, epoch: 21 | loss: 0.0573363
	speed: 0.0278s/iter; left time: 488.4281s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.71s
Steps: 222 | Train Loss: 0.0579168 Vali Loss: 0.0733025 Test Loss: 0.0868867
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0599002
	speed: 0.0547s/iter; left time: 953.8582s
	iters: 200, epoch: 22 | loss: 0.0579244
	speed: 0.0308s/iter; left time: 534.7831s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.68s
Steps: 222 | Train Loss: 0.0577381 Vali Loss: 0.0734787 Test Loss: 0.0877282
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0576215
	speed: 0.0563s/iter; left time: 968.5148s
	iters: 200, epoch: 23 | loss: 0.0555970
	speed: 0.0275s/iter; left time: 471.0447s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.52s
Steps: 222 | Train Loss: 0.0576474 Vali Loss: 0.0734664 Test Loss: 0.0873497
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0549140
	speed: 0.0574s/iter; left time: 976.1575s
	iters: 200, epoch: 24 | loss: 0.0565494
	speed: 0.0277s/iter; left time: 467.6025s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.34s
Steps: 222 | Train Loss: 0.0575239 Vali Loss: 0.0731563 Test Loss: 0.0869676
Validation loss decreased (0.073230 --> 0.073156).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0596233
	speed: 0.0578s/iter; left time: 968.7979s
	iters: 200, epoch: 25 | loss: 0.0541902
	speed: 0.0281s/iter; left time: 468.8686s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.75s
Steps: 222 | Train Loss: 0.0573391 Vali Loss: 0.0734023 Test Loss: 0.0868268
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0555391
	speed: 0.0544s/iter; left time: 900.2221s
	iters: 200, epoch: 26 | loss: 0.0553594
	speed: 0.0313s/iter; left time: 514.1817s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.78s
Steps: 222 | Train Loss: 0.0572754 Vali Loss: 0.0733688 Test Loss: 0.0870272
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0564770
	speed: 0.0558s/iter; left time: 910.6911s
	iters: 200, epoch: 27 | loss: 0.0569422
	speed: 0.0281s/iter; left time: 455.9473s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.57s
Steps: 222 | Train Loss: 0.0571740 Vali Loss: 0.0734585 Test Loss: 0.0868808
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0568383
	speed: 0.0574s/iter; left time: 923.9326s
	iters: 200, epoch: 28 | loss: 0.0575890
	speed: 0.0276s/iter; left time: 442.1387s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.37s
Steps: 222 | Train Loss: 0.0571011 Vali Loss: 0.0735396 Test Loss: 0.0867445
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0602893
	speed: 0.0554s/iter; left time: 879.4234s
	iters: 200, epoch: 29 | loss: 0.0582584
	speed: 0.0274s/iter; left time: 432.9316s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.41s
Steps: 222 | Train Loss: 0.0570145 Vali Loss: 0.0735997 Test Loss: 0.0871782
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0537078
	speed: 0.0572s/iter; left time: 896.0460s
	iters: 200, epoch: 30 | loss: 0.0555406
	speed: 0.0280s/iter; left time: 436.1792s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.63s
Steps: 222 | Train Loss: 0.0569776 Vali Loss: 0.0735232 Test Loss: 0.0871077
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0557368
	speed: 0.0533s/iter; left time: 822.2656s
	iters: 200, epoch: 31 | loss: 0.0554728
	speed: 0.0318s/iter; left time: 488.5950s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.83s
Steps: 222 | Train Loss: 0.0569504 Vali Loss: 0.0735121 Test Loss: 0.0870237
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0584505
	speed: 0.0546s/iter; left time: 831.0824s
	iters: 200, epoch: 32 | loss: 0.0585560
	speed: 0.0277s/iter; left time: 419.3098s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.32s
Steps: 222 | Train Loss: 0.0568485 Vali Loss: 0.0734587 Test Loss: 0.0867984
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0601608
	speed: 0.0571s/iter; left time: 855.6341s
	iters: 200, epoch: 33 | loss: 0.0542788
	speed: 0.0279s/iter; left time: 416.2910s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.39s
Steps: 222 | Train Loss: 0.0568110 Vali Loss: 0.0735852 Test Loss: 0.0870490
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0593282
	speed: 0.0565s/iter; left time: 834.2108s
	iters: 200, epoch: 34 | loss: 0.0566462
	speed: 0.0280s/iter; left time: 410.4423s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.59s
Steps: 222 | Train Loss: 0.0568219 Vali Loss: 0.0735635 Test Loss: 0.0869921
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_512_168_FR_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02209530398249626, rmse:0.14864489436149597, mae:0.0869675725698471, rse:0.5757157206535339
Use GPU: cuda:0
>>>>>>>start training : FR_512_168_FR_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0926753
	speed: 0.0322s/iter; left time: 711.0785s
	iters: 200, epoch: 1 | loss: 0.0864850
	speed: 0.0273s/iter; left time: 601.1498s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.59s
Steps: 222 | Train Loss: 0.0998092 Vali Loss: 0.0912169 Test Loss: 0.0984884
Validation loss decreased (inf --> 0.091217).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0706366
	speed: 0.0576s/iter; left time: 1260.3439s
	iters: 200, epoch: 2 | loss: 0.0685956
	speed: 0.0308s/iter; left time: 670.9510s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.78s
Steps: 222 | Train Loss: 0.0732876 Vali Loss: 0.0785562 Test Loss: 0.0867374
Validation loss decreased (0.091217 --> 0.078556).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0673651
	speed: 0.0541s/iter; left time: 1171.8726s
	iters: 200, epoch: 3 | loss: 0.0663863
	speed: 0.0280s/iter; left time: 604.0741s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.48s
Steps: 222 | Train Loss: 0.0673279 Vali Loss: 0.0765334 Test Loss: 0.0856419
Validation loss decreased (0.078556 --> 0.076533).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0669243
	speed: 0.0600s/iter; left time: 1286.9608s
	iters: 200, epoch: 4 | loss: 0.0647952
	speed: 0.0271s/iter; left time: 578.9654s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.24s
Steps: 222 | Train Loss: 0.0655516 Vali Loss: 0.0755698 Test Loss: 0.0860987
Validation loss decreased (0.076533 --> 0.075570).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0669611
	speed: 0.0548s/iter; left time: 1161.8915s
	iters: 200, epoch: 5 | loss: 0.0653353
	speed: 0.0279s/iter; left time: 588.9316s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.29s
Steps: 222 | Train Loss: 0.0644662 Vali Loss: 0.0751957 Test Loss: 0.0860627
Validation loss decreased (0.075570 --> 0.075196).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0651973
	speed: 0.0596s/iter; left time: 1250.0752s
	iters: 200, epoch: 6 | loss: 0.0602959
	speed: 0.0282s/iter; left time: 589.1540s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.45s
Steps: 222 | Train Loss: 0.0636211 Vali Loss: 0.0742472 Test Loss: 0.0868280
Validation loss decreased (0.075196 --> 0.074247).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0617981
	speed: 0.0553s/iter; left time: 1148.7227s
	iters: 200, epoch: 7 | loss: 0.0661122
	speed: 0.0295s/iter; left time: 609.3023s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.52s
Steps: 222 | Train Loss: 0.0629225 Vali Loss: 0.0737034 Test Loss: 0.0874572
Validation loss decreased (0.074247 --> 0.073703).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0658991
	speed: 0.0551s/iter; left time: 1132.5147s
	iters: 200, epoch: 8 | loss: 0.0613267
	speed: 0.0280s/iter; left time: 571.6752s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.37s
Steps: 222 | Train Loss: 0.0623983 Vali Loss: 0.0734330 Test Loss: 0.0871008
Validation loss decreased (0.073703 --> 0.073433).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0611679
	speed: 0.0582s/iter; left time: 1182.8415s
	iters: 200, epoch: 9 | loss: 0.0620157
	speed: 0.0271s/iter; left time: 547.8644s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.37s
Steps: 222 | Train Loss: 0.0617476 Vali Loss: 0.0734691 Test Loss: 0.0874490
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0648440
	speed: 0.0565s/iter; left time: 1135.3078s
	iters: 200, epoch: 10 | loss: 0.0623541
	speed: 0.0273s/iter; left time: 546.8126s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.43s
Steps: 222 | Train Loss: 0.0612791 Vali Loss: 0.0735913 Test Loss: 0.0876361
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0566490
	speed: 0.0557s/iter; left time: 1106.8575s
	iters: 200, epoch: 11 | loss: 0.0592110
	speed: 0.0281s/iter; left time: 555.7768s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.50s
Steps: 222 | Train Loss: 0.0607181 Vali Loss: 0.0732275 Test Loss: 0.0882248
Validation loss decreased (0.073433 --> 0.073228).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0632455
	speed: 0.0554s/iter; left time: 1089.5562s
	iters: 200, epoch: 12 | loss: 0.0584063
	speed: 0.0298s/iter; left time: 582.8886s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.61s
Steps: 222 | Train Loss: 0.0603093 Vali Loss: 0.0735247 Test Loss: 0.0875141
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0591289
	speed: 0.0542s/iter; left time: 1053.2718s
	iters: 200, epoch: 13 | loss: 0.0583428
	speed: 0.0280s/iter; left time: 540.7291s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.39s
Steps: 222 | Train Loss: 0.0599433 Vali Loss: 0.0735825 Test Loss: 0.0874094
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0605066
	speed: 0.0570s/iter; left time: 1095.4285s
	iters: 200, epoch: 14 | loss: 0.0622422
	speed: 0.0276s/iter; left time: 526.7503s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.40s
Steps: 222 | Train Loss: 0.0595383 Vali Loss: 0.0733542 Test Loss: 0.0877012
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0608642
	speed: 0.0570s/iter; left time: 1083.1895s
	iters: 200, epoch: 15 | loss: 0.0595879
	speed: 0.0279s/iter; left time: 526.9421s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.53s
Steps: 222 | Train Loss: 0.0591768 Vali Loss: 0.0733836 Test Loss: 0.0872333
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0593759
	speed: 0.0561s/iter; left time: 1053.7193s
	iters: 200, epoch: 16 | loss: 0.0591774
	speed: 0.0282s/iter; left time: 527.3116s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.53s
Steps: 222 | Train Loss: 0.0589033 Vali Loss: 0.0735029 Test Loss: 0.0868597
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0616219
	speed: 0.0540s/iter; left time: 1001.4667s
	iters: 200, epoch: 17 | loss: 0.0582787
	speed: 0.0291s/iter; left time: 536.0442s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.51s
Steps: 222 | Train Loss: 0.0586167 Vali Loss: 0.0735510 Test Loss: 0.0873291
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0608582
	speed: 0.0538s/iter; left time: 986.6374s
	iters: 200, epoch: 18 | loss: 0.0558169
	speed: 0.0274s/iter; left time: 499.2840s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.34s
Steps: 222 | Train Loss: 0.0583472 Vali Loss: 0.0736005 Test Loss: 0.0866306
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0579800
	speed: 0.0574s/iter; left time: 1039.8457s
	iters: 200, epoch: 19 | loss: 0.0586734
	speed: 0.0274s/iter; left time: 492.7419s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.38s
Steps: 222 | Train Loss: 0.0581088 Vali Loss: 0.0736148 Test Loss: 0.0869817
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0582891
	speed: 0.0546s/iter; left time: 976.7968s
	iters: 200, epoch: 20 | loss: 0.0546571
	speed: 0.0274s/iter; left time: 487.8506s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.40s
Steps: 222 | Train Loss: 0.0578948 Vali Loss: 0.0738315 Test Loss: 0.0869170
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0569176
	speed: 0.0556s/iter; left time: 982.4490s
	iters: 200, epoch: 21 | loss: 0.0584212
	speed: 0.0285s/iter; left time: 499.6546s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.45s
Steps: 222 | Train Loss: 0.0577929 Vali Loss: 0.0737043 Test Loss: 0.0868128
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_512_168_FR_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02231057547032833, rmse:0.14936724305152893, mae:0.08822478353977203, rse:0.578513503074646
Intermediate time for FR and pred_len 168: 00h:08m:00.54sIntermediate time for FR: 00h:33m:33.22s
=== Starting experiments for country: IT ===

=== Starting experiments for pred_len: 24 ===

--- Running model for IT, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_24_IT_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1220752
	speed: 0.0509s/iter; left time: 1130.2764s
	iters: 200, epoch: 1 | loss: 0.1124015
	speed: 0.0281s/iter; left time: 622.0805s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.63s
Steps: 223 | Train Loss: 0.1325993 Vali Loss: 0.0942944 Test Loss: 0.0955565
Validation loss decreased (inf --> 0.094294).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0693890
	speed: 0.0528s/iter; left time: 1159.9153s
	iters: 200, epoch: 2 | loss: 0.0668445
	speed: 0.0266s/iter; left time: 582.0171s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.20s
Steps: 223 | Train Loss: 0.0759136 Vali Loss: 0.0627112 Test Loss: 0.0656406
Validation loss decreased (0.094294 --> 0.062711).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0662491
	speed: 0.0544s/iter; left time: 1183.8244s
	iters: 200, epoch: 3 | loss: 0.0660577
	speed: 0.0273s/iter; left time: 591.0971s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.20s
Steps: 223 | Train Loss: 0.0650764 Vali Loss: 0.0596654 Test Loss: 0.0621885
Validation loss decreased (0.062711 --> 0.059665).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0611442
	speed: 0.0533s/iter; left time: 1147.3704s
	iters: 200, epoch: 4 | loss: 0.0643807
	speed: 0.0267s/iter; left time: 571.7833s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.28s
Steps: 223 | Train Loss: 0.0621614 Vali Loss: 0.0590315 Test Loss: 0.0613040
Validation loss decreased (0.059665 --> 0.059032).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0575514
	speed: 0.0530s/iter; left time: 1129.6298s
	iters: 200, epoch: 5 | loss: 0.0622045
	speed: 0.0281s/iter; left time: 596.7537s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.40s
Steps: 223 | Train Loss: 0.0607118 Vali Loss: 0.0582237 Test Loss: 0.0606797
Validation loss decreased (0.059032 --> 0.058224).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0604667
	speed: 0.0516s/iter; left time: 1088.1781s
	iters: 200, epoch: 6 | loss: 0.0586946
	speed: 0.0273s/iter; left time: 572.4943s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.0596630 Vali Loss: 0.0575096 Test Loss: 0.0601424
Validation loss decreased (0.058224 --> 0.057510).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0605737
	speed: 0.0555s/iter; left time: 1157.0877s
	iters: 200, epoch: 7 | loss: 0.0577191
	speed: 0.0267s/iter; left time: 553.6049s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.21s
Steps: 223 | Train Loss: 0.0587539 Vali Loss: 0.0573150 Test Loss: 0.0599158
Validation loss decreased (0.057510 --> 0.057315).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0569133
	speed: 0.0554s/iter; left time: 1144.2128s
	iters: 200, epoch: 8 | loss: 0.0609494
	speed: 0.0269s/iter; left time: 552.8415s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.19s
Steps: 223 | Train Loss: 0.0581800 Vali Loss: 0.0571470 Test Loss: 0.0595391
Validation loss decreased (0.057315 --> 0.057147).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0543008
	speed: 0.0537s/iter; left time: 1096.9061s
	iters: 200, epoch: 9 | loss: 0.0545223
	speed: 0.0267s/iter; left time: 542.8641s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.0575996 Vali Loss: 0.0566902 Test Loss: 0.0590270
Validation loss decreased (0.057147 --> 0.056690).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0564065
	speed: 0.0527s/iter; left time: 1064.7117s
	iters: 200, epoch: 10 | loss: 0.0549191
	speed: 0.0283s/iter; left time: 569.3037s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.0571505 Vali Loss: 0.0567421 Test Loss: 0.0591187
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0562808
	speed: 0.0510s/iter; left time: 1019.5154s
	iters: 200, epoch: 11 | loss: 0.0546165
	speed: 0.0269s/iter; left time: 533.5515s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.20s
Steps: 223 | Train Loss: 0.0566563 Vali Loss: 0.0563506 Test Loss: 0.0590622
Validation loss decreased (0.056690 --> 0.056351).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0594916
	speed: 0.0541s/iter; left time: 1068.2255s
	iters: 200, epoch: 12 | loss: 0.0550755
	speed: 0.0265s/iter; left time: 520.1228s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.12s
Steps: 223 | Train Loss: 0.0563721 Vali Loss: 0.0559727 Test Loss: 0.0584474
Validation loss decreased (0.056351 --> 0.055973).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0533181
	speed: 0.0545s/iter; left time: 1064.3111s
	iters: 200, epoch: 13 | loss: 0.0591052
	speed: 0.0266s/iter; left time: 516.9073s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.19s
Steps: 223 | Train Loss: 0.0560483 Vali Loss: 0.0560773 Test Loss: 0.0585655
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0576542
	speed: 0.0512s/iter; left time: 988.1637s
	iters: 200, epoch: 14 | loss: 0.0536710
	speed: 0.0273s/iter; left time: 524.5586s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.28s
Steps: 223 | Train Loss: 0.0557588 Vali Loss: 0.0557475 Test Loss: 0.0584036
Validation loss decreased (0.055973 --> 0.055747).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0577584
	speed: 0.0550s/iter; left time: 1048.6455s
	iters: 200, epoch: 15 | loss: 0.0573185
	speed: 0.0283s/iter; left time: 536.7314s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.56s
Steps: 223 | Train Loss: 0.0554317 Vali Loss: 0.0554833 Test Loss: 0.0582388
Validation loss decreased (0.055747 --> 0.055483).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0574488
	speed: 0.0530s/iter; left time: 998.9107s
	iters: 200, epoch: 16 | loss: 0.0597576
	speed: 0.0268s/iter; left time: 502.1894s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.21s
Steps: 223 | Train Loss: 0.0553067 Vali Loss: 0.0555447 Test Loss: 0.0582300
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0528388
	speed: 0.0548s/iter; left time: 1020.4668s
	iters: 200, epoch: 17 | loss: 0.0528586
	speed: 0.0266s/iter; left time: 492.3478s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.0550844 Vali Loss: 0.0555010 Test Loss: 0.0580867
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0575727
	speed: 0.0531s/iter; left time: 978.1223s
	iters: 200, epoch: 18 | loss: 0.0554257
	speed: 0.0283s/iter; left time: 518.8671s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.58s
Steps: 223 | Train Loss: 0.0548954 Vali Loss: 0.0554527 Test Loss: 0.0580303
Validation loss decreased (0.055483 --> 0.055453).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0514130
	speed: 0.0530s/iter; left time: 964.1856s
	iters: 200, epoch: 19 | loss: 0.0547660
	speed: 0.0275s/iter; left time: 496.5606s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.0548206 Vali Loss: 0.0552508 Test Loss: 0.0577160
Validation loss decreased (0.055453 --> 0.055251).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0535157
	speed: 0.0514s/iter; left time: 923.5797s
	iters: 200, epoch: 20 | loss: 0.0577883
	speed: 0.0279s/iter; left time: 498.0141s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.0545696 Vali Loss: 0.0552697 Test Loss: 0.0577830
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0555147
	speed: 0.0520s/iter; left time: 923.1396s
	iters: 200, epoch: 21 | loss: 0.0544950
	speed: 0.0266s/iter; left time: 469.6798s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.12s
Steps: 223 | Train Loss: 0.0544441 Vali Loss: 0.0549807 Test Loss: 0.0576976
Validation loss decreased (0.055251 --> 0.054981).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0534422
	speed: 0.0547s/iter; left time: 957.8440s
	iters: 200, epoch: 22 | loss: 0.0564228
	speed: 0.0264s/iter; left time: 459.1149s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.18s
Steps: 223 | Train Loss: 0.0543254 Vali Loss: 0.0550190 Test Loss: 0.0575762
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0517031
	speed: 0.0519s/iter; left time: 897.4414s
	iters: 200, epoch: 23 | loss: 0.0587856
	speed: 0.0267s/iter; left time: 458.8382s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.0543248 Vali Loss: 0.0550559 Test Loss: 0.0577396
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0560705
	speed: 0.0509s/iter; left time: 869.2080s
	iters: 200, epoch: 24 | loss: 0.0528798
	speed: 0.0286s/iter; left time: 486.1306s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.0541613 Vali Loss: 0.0549477 Test Loss: 0.0576477
Validation loss decreased (0.054981 --> 0.054948).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0560655
	speed: 0.0556s/iter; left time: 937.5092s
	iters: 200, epoch: 25 | loss: 0.0542304
	speed: 0.0268s/iter; left time: 448.2663s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.20s
Steps: 223 | Train Loss: 0.0541076 Vali Loss: 0.0548136 Test Loss: 0.0576309
Validation loss decreased (0.054948 --> 0.054814).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0548747
	speed: 0.0533s/iter; left time: 885.5314s
	iters: 200, epoch: 26 | loss: 0.0538855
	speed: 0.0266s/iter; left time: 439.8611s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.14s
Steps: 223 | Train Loss: 0.0540087 Vali Loss: 0.0549526 Test Loss: 0.0575554
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0517120
	speed: 0.0527s/iter; left time: 864.8934s
	iters: 200, epoch: 27 | loss: 0.0527826
	speed: 0.0266s/iter; left time: 434.0973s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.17s
Steps: 223 | Train Loss: 0.0539188 Vali Loss: 0.0549253 Test Loss: 0.0575773
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0549809
	speed: 0.0516s/iter; left time: 835.4098s
	iters: 200, epoch: 28 | loss: 0.0554980
	speed: 0.0271s/iter; left time: 435.7370s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.0538956 Vali Loss: 0.0548986 Test Loss: 0.0574903
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0527975
	speed: 0.0508s/iter; left time: 809.8721s
	iters: 200, epoch: 29 | loss: 0.0547849
	speed: 0.0276s/iter; left time: 437.1923s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.26s
Steps: 223 | Train Loss: 0.0538247 Vali Loss: 0.0547120 Test Loss: 0.0574399
Validation loss decreased (0.054814 --> 0.054712).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0507995
	speed: 0.0515s/iter; left time: 809.8363s
	iters: 200, epoch: 30 | loss: 0.0500010
	speed: 0.0266s/iter; left time: 415.8860s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.20s
Steps: 223 | Train Loss: 0.0537853 Vali Loss: 0.0547885 Test Loss: 0.0574554
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0550639
	speed: 0.0535s/iter; left time: 829.3732s
	iters: 200, epoch: 31 | loss: 0.0518903
	speed: 0.0264s/iter; left time: 407.0015s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.10s
Steps: 223 | Train Loss: 0.0537086 Vali Loss: 0.0547136 Test Loss: 0.0574395
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0559142
	speed: 0.0537s/iter; left time: 820.9508s
	iters: 200, epoch: 32 | loss: 0.0563869
	speed: 0.0273s/iter; left time: 415.1658s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.39s
Steps: 223 | Train Loss: 0.0537152 Vali Loss: 0.0546903 Test Loss: 0.0574024
Validation loss decreased (0.054712 --> 0.054690).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0501247
	speed: 0.0517s/iter; left time: 779.3576s
	iters: 200, epoch: 33 | loss: 0.0544526
	speed: 0.0277s/iter; left time: 413.8670s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.0536137 Vali Loss: 0.0547255 Test Loss: 0.0573914
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0529143
	speed: 0.0514s/iter; left time: 762.4844s
	iters: 200, epoch: 34 | loss: 0.0530024
	speed: 0.0265s/iter; left time: 389.9579s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.10s
Steps: 223 | Train Loss: 0.0535995 Vali Loss: 0.0547244 Test Loss: 0.0574674
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0510959
	speed: 0.0529s/iter; left time: 773.3129s
	iters: 200, epoch: 35 | loss: 0.0544512
	speed: 0.0266s/iter; left time: 385.7615s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.21s
Steps: 223 | Train Loss: 0.0535950 Vali Loss: 0.0546488 Test Loss: 0.0574228
Validation loss decreased (0.054690 --> 0.054649).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0535187
	speed: 0.0517s/iter; left time: 743.7813s
	iters: 200, epoch: 36 | loss: 0.0523912
	speed: 0.0271s/iter; left time: 386.8756s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.0535439 Vali Loss: 0.0546921 Test Loss: 0.0573547
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0519122
	speed: 0.0512s/iter; left time: 726.0438s
	iters: 200, epoch: 37 | loss: 0.0526450
	speed: 0.0276s/iter; left time: 388.3387s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.22s
Steps: 223 | Train Loss: 0.0535251 Vali Loss: 0.0546742 Test Loss: 0.0573575
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0550824
	speed: 0.0506s/iter; left time: 705.9884s
	iters: 200, epoch: 38 | loss: 0.0517140
	speed: 0.0267s/iter; left time: 370.3394s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.09s
Steps: 223 | Train Loss: 0.0535045 Vali Loss: 0.0546824 Test Loss: 0.0573583
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0504631
	speed: 0.0538s/iter; left time: 737.9139s
	iters: 200, epoch: 39 | loss: 0.0540452
	speed: 0.0267s/iter; left time: 364.1994s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.19s
Steps: 223 | Train Loss: 0.0535086 Vali Loss: 0.0546178 Test Loss: 0.0573389
Validation loss decreased (0.054649 --> 0.054618).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0553547
	speed: 0.0533s/iter; left time: 719.5076s
	iters: 200, epoch: 40 | loss: 0.0607494
	speed: 0.0266s/iter; left time: 355.9441s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.28s
Steps: 223 | Train Loss: 0.0534950 Vali Loss: 0.0546346 Test Loss: 0.0573255
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0535479
	speed: 0.0517s/iter; left time: 686.2660s
	iters: 200, epoch: 41 | loss: 0.0538877
	speed: 0.0283s/iter; left time: 373.5522s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.35s
Steps: 223 | Train Loss: 0.0534341 Vali Loss: 0.0546129 Test Loss: 0.0573383
Validation loss decreased (0.054618 --> 0.054613).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0530539
	speed: 0.0519s/iter; left time: 677.9868s
	iters: 200, epoch: 42 | loss: 0.0503627
	speed: 0.0266s/iter; left time: 344.0633s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.17s
Steps: 223 | Train Loss: 0.0534945 Vali Loss: 0.0546511 Test Loss: 0.0573564
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0522355
	speed: 0.0524s/iter; left time: 672.6512s
	iters: 200, epoch: 43 | loss: 0.0554015
	speed: 0.0266s/iter; left time: 338.2975s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.09s
Steps: 223 | Train Loss: 0.0534944 Vali Loss: 0.0545573 Test Loss: 0.0572970
Validation loss decreased (0.054613 --> 0.054557).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0508118
	speed: 0.0527s/iter; left time: 664.7909s
	iters: 200, epoch: 44 | loss: 0.0487365
	speed: 0.0265s/iter; left time: 331.5699s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.26s
Steps: 223 | Train Loss: 0.0534317 Vali Loss: 0.0546139 Test Loss: 0.0573201
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0559016
	speed: 0.0525s/iter; left time: 650.4442s
	iters: 200, epoch: 45 | loss: 0.0545299
	speed: 0.0274s/iter; left time: 336.5358s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.26s
Steps: 223 | Train Loss: 0.0533953 Vali Loss: 0.0546057 Test Loss: 0.0572799
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0540960
	speed: 0.0502s/iter; left time: 611.0743s
	iters: 200, epoch: 46 | loss: 0.0512552
	speed: 0.0266s/iter; left time: 321.4195s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.15s
Steps: 223 | Train Loss: 0.0533736 Vali Loss: 0.0546207 Test Loss: 0.0572905
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0561732
	speed: 0.0534s/iter; left time: 637.7349s
	iters: 200, epoch: 47 | loss: 0.0581061
	speed: 0.0267s/iter; left time: 316.5392s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.19s
Steps: 223 | Train Loss: 0.0533965 Vali Loss: 0.0546026 Test Loss: 0.0573136
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0520449
	speed: 0.0535s/iter; left time: 627.0966s
	iters: 200, epoch: 48 | loss: 0.0524969
	speed: 0.0268s/iter; left time: 311.2152s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.23s
Steps: 223 | Train Loss: 0.0534021 Vali Loss: 0.0545990 Test Loss: 0.0572868
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0543634
	speed: 0.0521s/iter; left time: 599.3406s
	iters: 200, epoch: 49 | loss: 0.0546120
	speed: 0.0273s/iter; left time: 311.5407s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.26s
Steps: 223 | Train Loss: 0.0533844 Vali Loss: 0.0545882 Test Loss: 0.0572972
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0534620
	speed: 0.0506s/iter; left time: 570.4850s
	iters: 200, epoch: 50 | loss: 0.0547533
	speed: 0.0275s/iter; left time: 307.2852s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.23s
Steps: 223 | Train Loss: 0.0533451 Vali Loss: 0.0545814 Test Loss: 0.0573124
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0546054
	speed: 0.0523s/iter; left time: 578.0639s
	iters: 200, epoch: 51 | loss: 0.0510880
	speed: 0.0267s/iter; left time: 292.2801s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.15s
Steps: 223 | Train Loss: 0.0533503 Vali Loss: 0.0546255 Test Loss: 0.0573027
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0514563
	speed: 0.0527s/iter; left time: 570.8214s
	iters: 200, epoch: 52 | loss: 0.0495366
	speed: 0.0267s/iter; left time: 286.4385s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:06.24s
Steps: 223 | Train Loss: 0.0533897 Vali Loss: 0.0545539 Test Loss: 0.0572905
Validation loss decreased (0.054557 --> 0.054554).  Saving model ...
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0526214
	speed: 0.0521s/iter; left time: 552.3314s
	iters: 200, epoch: 53 | loss: 0.0528501
	speed: 0.0272s/iter; left time: 285.3972s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.0533348 Vali Loss: 0.0545499 Test Loss: 0.0572744
Validation loss decreased (0.054554 --> 0.054550).  Saving model ...
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0534821
	speed: 0.0511s/iter; left time: 530.3323s
	iters: 200, epoch: 54 | loss: 0.0502692
	speed: 0.0278s/iter; left time: 286.2061s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.0533270 Vali Loss: 0.0546059 Test Loss: 0.0572837
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0566965
	speed: 0.0525s/iter; left time: 533.3248s
	iters: 200, epoch: 55 | loss: 0.0537091
	speed: 0.0265s/iter; left time: 266.4896s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:06.21s
Steps: 223 | Train Loss: 0.0533742 Vali Loss: 0.0545576 Test Loss: 0.0572765
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0570078
	speed: 0.0548s/iter; left time: 544.3453s
	iters: 200, epoch: 56 | loss: 0.0543868
	speed: 0.0266s/iter; left time: 262.0291s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:06.22s
Steps: 223 | Train Loss: 0.0533093 Vali Loss: 0.0545547 Test Loss: 0.0572905
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0484664
	speed: 0.0542s/iter; left time: 526.0091s
	iters: 200, epoch: 57 | loss: 0.0509104
	speed: 0.0266s/iter; left time: 255.6188s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.0533533 Vali Loss: 0.0545238 Test Loss: 0.0572867
Validation loss decreased (0.054550 --> 0.054524).  Saving model ...
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0565883
	speed: 0.0532s/iter; left time: 505.2635s
	iters: 200, epoch: 58 | loss: 0.0582136
	speed: 0.0271s/iter; left time: 254.5315s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:06.22s
Steps: 223 | Train Loss: 0.0533185 Vali Loss: 0.0546001 Test Loss: 0.0572918
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0523805
	speed: 0.0508s/iter; left time: 470.7098s
	iters: 200, epoch: 59 | loss: 0.0535988
	speed: 0.0265s/iter; left time: 242.7708s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:06.15s
Steps: 223 | Train Loss: 0.0533365 Vali Loss: 0.0545593 Test Loss: 0.0572962
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0546732
	speed: 0.0535s/iter; left time: 483.9101s
	iters: 200, epoch: 60 | loss: 0.0520667
	speed: 0.0265s/iter; left time: 237.1724s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:06.13s
Steps: 223 | Train Loss: 0.0533063 Vali Loss: 0.0545351 Test Loss: 0.0572758
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0580502
	speed: 0.0526s/iter; left time: 464.3747s
	iters: 200, epoch: 61 | loss: 0.0520758
	speed: 0.0265s/iter; left time: 230.9682s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:06.12s
Steps: 223 | Train Loss: 0.0533507 Vali Loss: 0.0545636 Test Loss: 0.0572944
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0565598
	speed: 0.0535s/iter; left time: 460.1389s
	iters: 200, epoch: 62 | loss: 0.0505943
	speed: 0.0289s/iter; left time: 245.6082s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:06.49s
Steps: 223 | Train Loss: 0.0533690 Vali Loss: 0.0546163 Test Loss: 0.0573110
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0569731
	speed: 0.0512s/iter; left time: 428.7700s
	iters: 200, epoch: 63 | loss: 0.0532570
	speed: 0.0279s/iter; left time: 230.9070s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.0533448 Vali Loss: 0.0545721 Test Loss: 0.0572936
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0568857
	speed: 0.0515s/iter; left time: 419.9548s
	iters: 200, epoch: 64 | loss: 0.0522906
	speed: 0.0266s/iter; left time: 214.3468s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:06.18s
Steps: 223 | Train Loss: 0.0533268 Vali Loss: 0.0545559 Test Loss: 0.0572829
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0549613
	speed: 0.0542s/iter; left time: 429.4227s
	iters: 200, epoch: 65 | loss: 0.0547876
	speed: 0.0264s/iter; left time: 206.8800s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:06.16s
Steps: 223 | Train Loss: 0.0533261 Vali Loss: 0.0546123 Test Loss: 0.0572819
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0571021
	speed: 0.0533s/iter; left time: 410.3956s
	iters: 200, epoch: 66 | loss: 0.0556666
	speed: 0.0267s/iter; left time: 203.3017s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.0533458 Vali Loss: 0.0545249 Test Loss: 0.0572845
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0536378
	speed: 0.0511s/iter; left time: 382.4235s
	iters: 200, epoch: 67 | loss: 0.0556360
	speed: 0.0278s/iter; left time: 205.4955s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.0533135 Vali Loss: 0.0545504 Test Loss: 0.0572871
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_24_IT_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01012159138917923, rmse:0.10060612112283707, mae:0.057286690920591354, rse:0.3801409900188446
Use GPU: cuda:0
>>>>>>>start training : IT_512_24_IT_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1248728
	speed: 0.0282s/iter; left time: 626.4181s
	iters: 200, epoch: 1 | loss: 0.1110343
	speed: 0.0278s/iter; left time: 615.1629s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.1324539 Vali Loss: 0.0937511 Test Loss: 0.0949556
Validation loss decreased (inf --> 0.093751).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0720905
	speed: 0.0539s/iter; left time: 1184.2051s
	iters: 200, epoch: 2 | loss: 0.0645590
	speed: 0.0274s/iter; left time: 599.8625s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.41s
Steps: 223 | Train Loss: 0.0755588 Vali Loss: 0.0620441 Test Loss: 0.0650663
Validation loss decreased (0.093751 --> 0.062044).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0640341
	speed: 0.0545s/iter; left time: 1186.3514s
	iters: 200, epoch: 3 | loss: 0.0612153
	speed: 0.0269s/iter; left time: 582.5923s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.21s
Steps: 223 | Train Loss: 0.0647354 Vali Loss: 0.0599341 Test Loss: 0.0626789
Validation loss decreased (0.062044 --> 0.059934).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0636144
	speed: 0.0552s/iter; left time: 1188.4956s
	iters: 200, epoch: 4 | loss: 0.0610736
	speed: 0.0266s/iter; left time: 569.9392s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.27s
Steps: 223 | Train Loss: 0.0622370 Vali Loss: 0.0586477 Test Loss: 0.0611086
Validation loss decreased (0.059934 --> 0.058648).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0597302
	speed: 0.0525s/iter; left time: 1118.1597s
	iters: 200, epoch: 5 | loss: 0.0593400
	speed: 0.0267s/iter; left time: 565.5797s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.26s
Steps: 223 | Train Loss: 0.0605518 Vali Loss: 0.0583430 Test Loss: 0.0606032
Validation loss decreased (0.058648 --> 0.058343).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0601675
	speed: 0.0519s/iter; left time: 1094.6959s
	iters: 200, epoch: 6 | loss: 0.0591417
	speed: 0.0276s/iter; left time: 580.1022s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.0595355 Vali Loss: 0.0577077 Test Loss: 0.0602866
Validation loss decreased (0.058343 --> 0.057708).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0616218
	speed: 0.0527s/iter; left time: 1100.1340s
	iters: 200, epoch: 7 | loss: 0.0583670
	speed: 0.0267s/iter; left time: 554.1562s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.13s
Steps: 223 | Train Loss: 0.0587154 Vali Loss: 0.0572509 Test Loss: 0.0596006
Validation loss decreased (0.057708 --> 0.057251).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0568723
	speed: 0.0575s/iter; left time: 1187.0474s
	iters: 200, epoch: 8 | loss: 0.0633062
	speed: 0.0266s/iter; left time: 545.3813s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.20s
Steps: 223 | Train Loss: 0.0581127 Vali Loss: 0.0571833 Test Loss: 0.0592898
Validation loss decreased (0.057251 --> 0.057183).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0551414
	speed: 0.0534s/iter; left time: 1090.9052s
	iters: 200, epoch: 9 | loss: 0.0602552
	speed: 0.0265s/iter; left time: 538.2335s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.24s
Steps: 223 | Train Loss: 0.0575728 Vali Loss: 0.0565193 Test Loss: 0.0591429
Validation loss decreased (0.057183 --> 0.056519).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0542222
	speed: 0.0522s/iter; left time: 1053.9653s
	iters: 200, epoch: 10 | loss: 0.0603032
	speed: 0.0276s/iter; left time: 554.1029s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.27s
Steps: 223 | Train Loss: 0.0570322 Vali Loss: 0.0563715 Test Loss: 0.0591157
Validation loss decreased (0.056519 --> 0.056372).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0570678
	speed: 0.0515s/iter; left time: 1029.4251s
	iters: 200, epoch: 11 | loss: 0.0550144
	speed: 0.0277s/iter; left time: 550.9342s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.0566705 Vali Loss: 0.0562801 Test Loss: 0.0587650
Validation loss decreased (0.056372 --> 0.056280).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0574326
	speed: 0.0526s/iter; left time: 1038.9030s
	iters: 200, epoch: 12 | loss: 0.0546103
	speed: 0.0268s/iter; left time: 527.5405s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.15s
Steps: 223 | Train Loss: 0.0563215 Vali Loss: 0.0561686 Test Loss: 0.0584310
Validation loss decreased (0.056280 --> 0.056169).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0557495
	speed: 0.0545s/iter; left time: 1063.4217s
	iters: 200, epoch: 13 | loss: 0.0531652
	speed: 0.0266s/iter; left time: 516.0870s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.24s
Steps: 223 | Train Loss: 0.0559293 Vali Loss: 0.0560087 Test Loss: 0.0585652
Validation loss decreased (0.056169 --> 0.056009).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0552769
	speed: 0.0533s/iter; left time: 1029.0034s
	iters: 200, epoch: 14 | loss: 0.0531435
	speed: 0.0268s/iter; left time: 515.3364s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.0556957 Vali Loss: 0.0558831 Test Loss: 0.0582514
Validation loss decreased (0.056009 --> 0.055883).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0521481
	speed: 0.0524s/iter; left time: 999.6095s
	iters: 200, epoch: 15 | loss: 0.0553430
	speed: 0.0283s/iter; left time: 536.9041s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.0555145 Vali Loss: 0.0557019 Test Loss: 0.0581627
Validation loss decreased (0.055883 --> 0.055702).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0609594
	speed: 0.0527s/iter; left time: 993.4804s
	iters: 200, epoch: 16 | loss: 0.0542896
	speed: 0.0272s/iter; left time: 509.3344s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.21s
Steps: 223 | Train Loss: 0.0552573 Vali Loss: 0.0554980 Test Loss: 0.0579392
Validation loss decreased (0.055702 --> 0.055498).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0568106
	speed: 0.0542s/iter; left time: 1009.8471s
	iters: 200, epoch: 17 | loss: 0.0526110
	speed: 0.0264s/iter; left time: 489.3135s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.13s
Steps: 223 | Train Loss: 0.0551050 Vali Loss: 0.0555646 Test Loss: 0.0581667
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0543328
	speed: 0.0534s/iter; left time: 982.9672s
	iters: 200, epoch: 18 | loss: 0.0529872
	speed: 0.0265s/iter; left time: 484.9821s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.28s
Steps: 223 | Train Loss: 0.0549972 Vali Loss: 0.0554904 Test Loss: 0.0578824
Validation loss decreased (0.055498 --> 0.055490).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0561036
	speed: 0.0511s/iter; left time: 929.3392s
	iters: 200, epoch: 19 | loss: 0.0585789
	speed: 0.0269s/iter; left time: 486.8368s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.12s
Steps: 223 | Train Loss: 0.0547228 Vali Loss: 0.0551855 Test Loss: 0.0576403
Validation loss decreased (0.055490 --> 0.055185).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0551048
	speed: 0.0535s/iter; left time: 961.2267s
	iters: 200, epoch: 20 | loss: 0.0540609
	speed: 0.0283s/iter; left time: 505.7844s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.0546380 Vali Loss: 0.0555217 Test Loss: 0.0577946
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0542702
	speed: 0.0516s/iter; left time: 916.2719s
	iters: 200, epoch: 21 | loss: 0.0512278
	speed: 0.0263s/iter; left time: 464.7523s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.13s
Steps: 223 | Train Loss: 0.0545288 Vali Loss: 0.0553299 Test Loss: 0.0576920
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0561697
	speed: 0.0550s/iter; left time: 962.6244s
	iters: 200, epoch: 22 | loss: 0.0527409
	speed: 0.0268s/iter; left time: 466.6340s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.0544019 Vali Loss: 0.0552929 Test Loss: 0.0575224
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0529760
	speed: 0.0534s/iter; left time: 923.4529s
	iters: 200, epoch: 23 | loss: 0.0520137
	speed: 0.0270s/iter; left time: 463.5967s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.0542588 Vali Loss: 0.0552379 Test Loss: 0.0575204
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0544704
	speed: 0.0515s/iter; left time: 878.6230s
	iters: 200, epoch: 24 | loss: 0.0581453
	speed: 0.0287s/iter; left time: 486.8710s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.40s
Steps: 223 | Train Loss: 0.0542069 Vali Loss: 0.0551895 Test Loss: 0.0574684
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0549121
	speed: 0.0518s/iter; left time: 872.9043s
	iters: 200, epoch: 25 | loss: 0.0512915
	speed: 0.0269s/iter; left time: 450.0854s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.21s
Steps: 223 | Train Loss: 0.0541660 Vali Loss: 0.0550061 Test Loss: 0.0575668
Validation loss decreased (0.055185 --> 0.055006).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0542531
	speed: 0.0547s/iter; left time: 910.0617s
	iters: 200, epoch: 26 | loss: 0.0534555
	speed: 0.0271s/iter; left time: 447.9879s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.23s
Steps: 223 | Train Loss: 0.0540092 Vali Loss: 0.0549437 Test Loss: 0.0573728
Validation loss decreased (0.055006 --> 0.054944).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0522741
	speed: 0.0547s/iter; left time: 897.5644s
	iters: 200, epoch: 27 | loss: 0.0540177
	speed: 0.0269s/iter; left time: 438.4087s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.0539847 Vali Loss: 0.0550816 Test Loss: 0.0574916
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0527179
	speed: 0.0518s/iter; left time: 838.5554s
	iters: 200, epoch: 28 | loss: 0.0534733
	speed: 0.0276s/iter; left time: 443.3765s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.0539413 Vali Loss: 0.0550135 Test Loss: 0.0575341
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0502411
	speed: 0.0513s/iter; left time: 819.2275s
	iters: 200, epoch: 29 | loss: 0.0528361
	speed: 0.0275s/iter; left time: 435.9257s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.0538017 Vali Loss: 0.0548889 Test Loss: 0.0573778
Validation loss decreased (0.054944 --> 0.054889).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0518792
	speed: 0.0524s/iter; left time: 824.7375s
	iters: 200, epoch: 30 | loss: 0.0557014
	speed: 0.0265s/iter; left time: 414.4736s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.14s
Steps: 223 | Train Loss: 0.0537871 Vali Loss: 0.0549768 Test Loss: 0.0574409
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0499483
	speed: 0.0546s/iter; left time: 847.1963s
	iters: 200, epoch: 31 | loss: 0.0548199
	speed: 0.0265s/iter; left time: 408.3978s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.23s
Steps: 223 | Train Loss: 0.0537241 Vali Loss: 0.0548849 Test Loss: 0.0573524
Validation loss decreased (0.054889 --> 0.054885).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0519677
	speed: 0.0530s/iter; left time: 809.8001s
	iters: 200, epoch: 32 | loss: 0.0509725
	speed: 0.0269s/iter; left time: 408.1699s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.0537428 Vali Loss: 0.0548889 Test Loss: 0.0573561
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0516712
	speed: 0.0519s/iter; left time: 781.2646s
	iters: 200, epoch: 33 | loss: 0.0521875
	speed: 0.0286s/iter; left time: 428.3656s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.0536519 Vali Loss: 0.0549251 Test Loss: 0.0573139
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0525791
	speed: 0.0522s/iter; left time: 775.0032s
	iters: 200, epoch: 34 | loss: 0.0539121
	speed: 0.0266s/iter; left time: 392.6953s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.0536618 Vali Loss: 0.0548495 Test Loss: 0.0573276
Validation loss decreased (0.054885 --> 0.054850).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0548193
	speed: 0.0559s/iter; left time: 817.7348s
	iters: 200, epoch: 35 | loss: 0.0560694
	speed: 0.0269s/iter; left time: 390.7112s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.21s
Steps: 223 | Train Loss: 0.0536223 Vali Loss: 0.0549313 Test Loss: 0.0573653
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0531555
	speed: 0.0537s/iter; left time: 772.3500s
	iters: 200, epoch: 36 | loss: 0.0529074
	speed: 0.0270s/iter; left time: 385.8289s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.42s
Steps: 223 | Train Loss: 0.0535724 Vali Loss: 0.0548796 Test Loss: 0.0573130
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0542191
	speed: 0.0515s/iter; left time: 729.6216s
	iters: 200, epoch: 37 | loss: 0.0521309
	speed: 0.0284s/iter; left time: 399.6735s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.0536354 Vali Loss: 0.0548213 Test Loss: 0.0573156
Validation loss decreased (0.054850 --> 0.054821).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0513455
	speed: 0.0514s/iter; left time: 716.9502s
	iters: 200, epoch: 38 | loss: 0.0484909
	speed: 0.0283s/iter; left time: 391.7052s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.0535302 Vali Loss: 0.0548031 Test Loss: 0.0572883
Validation loss decreased (0.054821 --> 0.054803).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0567436
	speed: 0.0533s/iter; left time: 731.9007s
	iters: 200, epoch: 39 | loss: 0.0543030
	speed: 0.0268s/iter; left time: 364.6817s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.18s
Steps: 223 | Train Loss: 0.0535580 Vali Loss: 0.0548298 Test Loss: 0.0572565
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0577767
	speed: 0.0542s/iter; left time: 731.7697s
	iters: 200, epoch: 40 | loss: 0.0489657
	speed: 0.0265s/iter; left time: 355.5326s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.22s
Steps: 223 | Train Loss: 0.0535311 Vali Loss: 0.0547384 Test Loss: 0.0572284
Validation loss decreased (0.054803 --> 0.054738).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0492260
	speed: 0.0523s/iter; left time: 695.0258s
	iters: 200, epoch: 41 | loss: 0.0530771
	speed: 0.0274s/iter; left time: 361.2924s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.0535195 Vali Loss: 0.0547555 Test Loss: 0.0572335
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0536120
	speed: 0.0524s/iter; left time: 683.8322s
	iters: 200, epoch: 42 | loss: 0.0539439
	speed: 0.0290s/iter; left time: 375.9186s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.40s
Steps: 223 | Train Loss: 0.0535063 Vali Loss: 0.0547998 Test Loss: 0.0572487
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0516886
	speed: 0.0513s/iter; left time: 659.0389s
	iters: 200, epoch: 43 | loss: 0.0514923
	speed: 0.0263s/iter; left time: 335.1796s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.22s
Steps: 223 | Train Loss: 0.0534249 Vali Loss: 0.0548376 Test Loss: 0.0572255
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0577250
	speed: 0.0549s/iter; left time: 692.4608s
	iters: 200, epoch: 44 | loss: 0.0516380
	speed: 0.0269s/iter; left time: 336.5462s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.14s
Steps: 223 | Train Loss: 0.0534548 Vali Loss: 0.0547533 Test Loss: 0.0572155
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0551903
	speed: 0.0531s/iter; left time: 657.8252s
	iters: 200, epoch: 45 | loss: 0.0587276
	speed: 0.0268s/iter; left time: 329.1076s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.0534890 Vali Loss: 0.0547240 Test Loss: 0.0572646
Validation loss decreased (0.054738 --> 0.054724).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0569799
	speed: 0.0520s/iter; left time: 632.1113s
	iters: 200, epoch: 46 | loss: 0.0528706
	speed: 0.0281s/iter; left time: 339.4052s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.0534028 Vali Loss: 0.0548343 Test Loss: 0.0572270
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0535365
	speed: 0.0521s/iter; left time: 622.7815s
	iters: 200, epoch: 47 | loss: 0.0522014
	speed: 0.0276s/iter; left time: 327.0512s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.40s
Steps: 223 | Train Loss: 0.0534371 Vali Loss: 0.0548092 Test Loss: 0.0572257
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0540526
	speed: 0.0528s/iter; left time: 618.2454s
	iters: 200, epoch: 48 | loss: 0.0521358
	speed: 0.0267s/iter; left time: 309.8122s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.17s
Steps: 223 | Train Loss: 0.0534032 Vali Loss: 0.0547515 Test Loss: 0.0572309
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0514734
	speed: 0.0548s/iter; left time: 630.1869s
	iters: 200, epoch: 49 | loss: 0.0515570
	speed: 0.0268s/iter; left time: 305.6974s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.0533995 Vali Loss: 0.0547729 Test Loss: 0.0572376
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0553200
	speed: 0.0539s/iter; left time: 607.7663s
	iters: 200, epoch: 50 | loss: 0.0507628
	speed: 0.0283s/iter; left time: 316.0048s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.54s
Steps: 223 | Train Loss: 0.0534180 Vali Loss: 0.0548830 Test Loss: 0.0572152
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0522079
	speed: 0.0516s/iter; left time: 570.3257s
	iters: 200, epoch: 51 | loss: 0.0526080
	speed: 0.0291s/iter; left time: 319.0372s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.44s
Steps: 223 | Train Loss: 0.0533703 Vali Loss: 0.0547865 Test Loss: 0.0572359
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0549524
	speed: 0.0527s/iter; left time: 570.7138s
	iters: 200, epoch: 52 | loss: 0.0532417
	speed: 0.0268s/iter; left time: 287.4457s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:06.18s
Steps: 223 | Train Loss: 0.0534304 Vali Loss: 0.0547305 Test Loss: 0.0572217
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0537086
	speed: 0.0548s/iter; left time: 580.8395s
	iters: 200, epoch: 53 | loss: 0.0529253
	speed: 0.0266s/iter; left time: 279.1696s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.14s
Steps: 223 | Train Loss: 0.0533663 Vali Loss: 0.0548078 Test Loss: 0.0572288
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0523412
	speed: 0.0540s/iter; left time: 560.4656s
	iters: 200, epoch: 54 | loss: 0.0549152
	speed: 0.0271s/iter; left time: 278.8274s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:06.61s
Steps: 223 | Train Loss: 0.0533426 Vali Loss: 0.0547861 Test Loss: 0.0572313
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0475683
	speed: 0.0546s/iter; left time: 554.5516s
	iters: 200, epoch: 55 | loss: 0.0524945
	speed: 0.0275s/iter; left time: 276.4473s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:06.42s
Steps: 223 | Train Loss: 0.0534049 Vali Loss: 0.0548184 Test Loss: 0.0572309
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_24_IT_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010083268396556377, rmse:0.10041547566652298, mae:0.05726462975144386, rse:0.3794206380844116
Intermediate time for IT and pred_len 24: 00h:16m:28.08s
=== Starting experiments for pred_len: 96 ===

--- Running model for IT, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_96_IT_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1321838
	speed: 0.0528s/iter; left time: 1166.6778s
	iters: 200, epoch: 1 | loss: 0.1144970
	speed: 0.0271s/iter; left time: 597.1894s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.51s
Steps: 222 | Train Loss: 0.1387064 Vali Loss: 0.1032817 Test Loss: 0.1052682
Validation loss decreased (inf --> 0.103282).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0853616
	speed: 0.0561s/iter; left time: 1228.0293s
	iters: 200, epoch: 2 | loss: 0.0828326
	speed: 0.0272s/iter; left time: 592.7509s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.46s
Steps: 222 | Train Loss: 0.0932694 Vali Loss: 0.0822700 Test Loss: 0.0855554
Validation loss decreased (0.103282 --> 0.082270).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0840157
	speed: 0.0575s/iter; left time: 1245.1145s
	iters: 200, epoch: 3 | loss: 0.0772976
	speed: 0.0294s/iter; left time: 633.0791s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.79s
Steps: 222 | Train Loss: 0.0837174 Vali Loss: 0.0802281 Test Loss: 0.0841231
Validation loss decreased (0.082270 --> 0.080228).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0776535
	speed: 0.0538s/iter; left time: 1152.2520s
	iters: 200, epoch: 4 | loss: 0.0804181
	speed: 0.0279s/iter; left time: 595.0900s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.39s
Steps: 222 | Train Loss: 0.0811037 Vali Loss: 0.0788419 Test Loss: 0.0832654
Validation loss decreased (0.080228 --> 0.078842).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0817597
	speed: 0.0555s/iter; left time: 1177.6018s
	iters: 200, epoch: 5 | loss: 0.0780218
	speed: 0.0272s/iter; left time: 573.5973s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.24s
Steps: 222 | Train Loss: 0.0794239 Vali Loss: 0.0786723 Test Loss: 0.0830877
Validation loss decreased (0.078842 --> 0.078672).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0774737
	speed: 0.0564s/iter; left time: 1183.8263s
	iters: 200, epoch: 6 | loss: 0.0789120
	speed: 0.0275s/iter; left time: 574.0121s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.44s
Steps: 222 | Train Loss: 0.0783094 Vali Loss: 0.0786543 Test Loss: 0.0826141
Validation loss decreased (0.078672 --> 0.078654).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0756353
	speed: 0.0550s/iter; left time: 1142.9273s
	iters: 200, epoch: 7 | loss: 0.0770764
	speed: 0.0279s/iter; left time: 577.5774s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.49s
Steps: 222 | Train Loss: 0.0773383 Vali Loss: 0.0779212 Test Loss: 0.0822634
Validation loss decreased (0.078654 --> 0.077921).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0771187
	speed: 0.0532s/iter; left time: 1092.8138s
	iters: 200, epoch: 8 | loss: 0.0760235
	speed: 0.0281s/iter; left time: 574.2985s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.36s
Steps: 222 | Train Loss: 0.0764953 Vali Loss: 0.0783359 Test Loss: 0.0821347
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0729671
	speed: 0.0537s/iter; left time: 1091.8457s
	iters: 200, epoch: 9 | loss: 0.0753743
	speed: 0.0275s/iter; left time: 555.3709s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.29s
Steps: 222 | Train Loss: 0.0758295 Vali Loss: 0.0776675 Test Loss: 0.0825013
Validation loss decreased (0.077921 --> 0.077668).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0795718
	speed: 0.0567s/iter; left time: 1138.8475s
	iters: 200, epoch: 10 | loss: 0.0746166
	speed: 0.0272s/iter; left time: 543.0987s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.26s
Steps: 222 | Train Loss: 0.0753310 Vali Loss: 0.0781949 Test Loss: 0.0824108
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0762351
	speed: 0.0550s/iter; left time: 1093.5082s
	iters: 200, epoch: 11 | loss: 0.0735926
	speed: 0.0272s/iter; left time: 537.7020s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.44s
Steps: 222 | Train Loss: 0.0748693 Vali Loss: 0.0781084 Test Loss: 0.0827782
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0725338
	speed: 0.0526s/iter; left time: 1033.7681s
	iters: 200, epoch: 12 | loss: 0.0750147
	speed: 0.0284s/iter; left time: 555.6160s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.39s
Steps: 222 | Train Loss: 0.0743695 Vali Loss: 0.0778181 Test Loss: 0.0824795
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0748884
	speed: 0.0529s/iter; left time: 1028.8589s
	iters: 200, epoch: 13 | loss: 0.0768396
	speed: 0.0279s/iter; left time: 539.9647s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.43s
Steps: 222 | Train Loss: 0.0740004 Vali Loss: 0.0777673 Test Loss: 0.0825389
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0698381
	speed: 0.0549s/iter; left time: 1055.0927s
	iters: 200, epoch: 14 | loss: 0.0717925
	speed: 0.0269s/iter; left time: 513.7232s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.23s
Steps: 222 | Train Loss: 0.0736021 Vali Loss: 0.0778859 Test Loss: 0.0826246
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0710938
	speed: 0.0559s/iter; left time: 1062.4510s
	iters: 200, epoch: 15 | loss: 0.0687255
	speed: 0.0270s/iter; left time: 510.3216s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.35s
Steps: 222 | Train Loss: 0.0732304 Vali Loss: 0.0778723 Test Loss: 0.0830562
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0749232
	speed: 0.0533s/iter; left time: 1000.4663s
	iters: 200, epoch: 16 | loss: 0.0746401
	speed: 0.0276s/iter; left time: 516.1447s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.36s
Steps: 222 | Train Loss: 0.0729620 Vali Loss: 0.0777781 Test Loss: 0.0827808
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0733482
	speed: 0.0528s/iter; left time: 979.8157s
	iters: 200, epoch: 17 | loss: 0.0715483
	speed: 0.0288s/iter; left time: 531.9808s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.46s
Steps: 222 | Train Loss: 0.0726490 Vali Loss: 0.0779078 Test Loss: 0.0832266
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0739253
	speed: 0.0536s/iter; left time: 981.6920s
	iters: 200, epoch: 18 | loss: 0.0751582
	speed: 0.0272s/iter; left time: 495.0143s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.27s
Steps: 222 | Train Loss: 0.0724323 Vali Loss: 0.0774746 Test Loss: 0.0825534
Validation loss decreased (0.077668 --> 0.077475).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0730057
	speed: 0.0590s/iter; left time: 1068.9870s
	iters: 200, epoch: 19 | loss: 0.0744534
	speed: 0.0269s/iter; left time: 484.2311s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.42s
Steps: 222 | Train Loss: 0.0721436 Vali Loss: 0.0777745 Test Loss: 0.0828253
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0702813
	speed: 0.0554s/iter; left time: 989.9029s
	iters: 200, epoch: 20 | loss: 0.0714406
	speed: 0.0274s/iter; left time: 486.6499s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.50s
Steps: 222 | Train Loss: 0.0719519 Vali Loss: 0.0777934 Test Loss: 0.0831720
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0752490
	speed: 0.0530s/iter; left time: 936.4262s
	iters: 200, epoch: 21 | loss: 0.0729214
	speed: 0.0297s/iter; left time: 522.3971s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.46s
Steps: 222 | Train Loss: 0.0717573 Vali Loss: 0.0775301 Test Loss: 0.0829119
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0729312
	speed: 0.0534s/iter; left time: 930.4178s
	iters: 200, epoch: 22 | loss: 0.0712821
	speed: 0.0279s/iter; left time: 483.3509s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.39s
Steps: 222 | Train Loss: 0.0716219 Vali Loss: 0.0775715 Test Loss: 0.0831647
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0745800
	speed: 0.0545s/iter; left time: 939.0949s
	iters: 200, epoch: 23 | loss: 0.0710693
	speed: 0.0268s/iter; left time: 458.5333s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.17s
Steps: 222 | Train Loss: 0.0714176 Vali Loss: 0.0774375 Test Loss: 0.0831591
Validation loss decreased (0.077475 --> 0.077438).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0726332
	speed: 0.0550s/iter; left time: 934.8110s
	iters: 200, epoch: 24 | loss: 0.0703410
	speed: 0.0270s/iter; left time: 455.4759s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.35s
Steps: 222 | Train Loss: 0.0712783 Vali Loss: 0.0776950 Test Loss: 0.0831947
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0688102
	speed: 0.0542s/iter; left time: 908.8879s
	iters: 200, epoch: 25 | loss: 0.0745878
	speed: 0.0288s/iter; left time: 480.9376s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.51s
Steps: 222 | Train Loss: 0.0710946 Vali Loss: 0.0775712 Test Loss: 0.0831804
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0722734
	speed: 0.0529s/iter; left time: 874.8612s
	iters: 200, epoch: 26 | loss: 0.0690523
	speed: 0.0284s/iter; left time: 467.9860s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.43s
Steps: 222 | Train Loss: 0.0710367 Vali Loss: 0.0774692 Test Loss: 0.0832843
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0757137
	speed: 0.0539s/iter; left time: 880.8381s
	iters: 200, epoch: 27 | loss: 0.0672927
	speed: 0.0275s/iter; left time: 445.8787s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.25s
Steps: 222 | Train Loss: 0.0709873 Vali Loss: 0.0775369 Test Loss: 0.0832190
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0734061
	speed: 0.0564s/iter; left time: 908.3009s
	iters: 200, epoch: 28 | loss: 0.0689125
	speed: 0.0269s/iter; left time: 430.4418s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.26s
Steps: 222 | Train Loss: 0.0708438 Vali Loss: 0.0776351 Test Loss: 0.0832205
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0706797
	speed: 0.0549s/iter; left time: 871.6611s
	iters: 200, epoch: 29 | loss: 0.0731136
	speed: 0.0278s/iter; left time: 439.3401s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.45s
Steps: 222 | Train Loss: 0.0707727 Vali Loss: 0.0773896 Test Loss: 0.0832303
Validation loss decreased (0.077438 --> 0.077390).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0717404
	speed: 0.0534s/iter; left time: 835.9623s
	iters: 200, epoch: 30 | loss: 0.0729116
	speed: 0.0290s/iter; left time: 451.0989s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.42s
Steps: 222 | Train Loss: 0.0706910 Vali Loss: 0.0774434 Test Loss: 0.0832887
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0757121
	speed: 0.0534s/iter; left time: 825.1587s
	iters: 200, epoch: 31 | loss: 0.0711617
	speed: 0.0271s/iter; left time: 415.8039s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.27s
Steps: 222 | Train Loss: 0.0706033 Vali Loss: 0.0776396 Test Loss: 0.0833558
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0712611
	speed: 0.0575s/iter; left time: 874.6293s
	iters: 200, epoch: 32 | loss: 0.0727751
	speed: 0.0272s/iter; left time: 411.0677s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.35s
Steps: 222 | Train Loss: 0.0705892 Vali Loss: 0.0775814 Test Loss: 0.0833558
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0709131
	speed: 0.0545s/iter; left time: 817.8930s
	iters: 200, epoch: 33 | loss: 0.0718555
	speed: 0.0271s/iter; left time: 403.8077s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.41s
Steps: 222 | Train Loss: 0.0705573 Vali Loss: 0.0772810 Test Loss: 0.0833159
Validation loss decreased (0.077390 --> 0.077281).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0690060
	speed: 0.0518s/iter; left time: 765.6173s
	iters: 200, epoch: 34 | loss: 0.0711988
	speed: 0.0280s/iter; left time: 410.2681s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.25s
Steps: 222 | Train Loss: 0.0705202 Vali Loss: 0.0774535 Test Loss: 0.0832982
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0732094
	speed: 0.0534s/iter; left time: 776.4035s
	iters: 200, epoch: 35 | loss: 0.0739846
	speed: 0.0278s/iter; left time: 401.4896s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.37s
Steps: 222 | Train Loss: 0.0704378 Vali Loss: 0.0774655 Test Loss: 0.0832758
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0734195
	speed: 0.0536s/iter; left time: 768.0877s
	iters: 200, epoch: 36 | loss: 0.0688326
	speed: 0.0276s/iter; left time: 393.4594s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.27s
Steps: 222 | Train Loss: 0.0703314 Vali Loss: 0.0775375 Test Loss: 0.0834405
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0667930
	speed: 0.0559s/iter; left time: 788.8954s
	iters: 200, epoch: 37 | loss: 0.0698663
	speed: 0.0271s/iter; left time: 379.4721s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.39s
Steps: 222 | Train Loss: 0.0703407 Vali Loss: 0.0774669 Test Loss: 0.0833736
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0679398
	speed: 0.0555s/iter; left time: 771.3706s
	iters: 200, epoch: 38 | loss: 0.0724612
	speed: 0.0274s/iter; left time: 377.5145s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.46s
Steps: 222 | Train Loss: 0.0703553 Vali Loss: 0.0775958 Test Loss: 0.0833337
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0718481
	speed: 0.0526s/iter; left time: 718.1055s
	iters: 200, epoch: 39 | loss: 0.0735828
	speed: 0.0286s/iter; left time: 388.2652s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.41s
Steps: 222 | Train Loss: 0.0702385 Vali Loss: 0.0774214 Test Loss: 0.0832950
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0657273
	speed: 0.0537s/iter; left time: 722.4613s
	iters: 200, epoch: 40 | loss: 0.0679445
	speed: 0.0268s/iter; left time: 357.9045s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.23s
Steps: 222 | Train Loss: 0.0702638 Vali Loss: 0.0775013 Test Loss: 0.0834430
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0673170
	speed: 0.0568s/iter; left time: 750.9906s
	iters: 200, epoch: 41 | loss: 0.0687927
	speed: 0.0269s/iter; left time: 352.5034s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.32s
Steps: 222 | Train Loss: 0.0702658 Vali Loss: 0.0773642 Test Loss: 0.0834067
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0763263
	speed: 0.0575s/iter; left time: 746.9921s
	iters: 200, epoch: 42 | loss: 0.0653355
	speed: 0.0279s/iter; left time: 359.5060s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.60s
Steps: 222 | Train Loss: 0.0701891 Vali Loss: 0.0775082 Test Loss: 0.0834283
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0718496
	speed: 0.0548s/iter; left time: 700.0664s
	iters: 200, epoch: 43 | loss: 0.0727848
	speed: 0.0281s/iter; left time: 355.6376s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.41s
Steps: 222 | Train Loss: 0.0702348 Vali Loss: 0.0775226 Test Loss: 0.0834311
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_96_IT_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019748352468013763, rmse:0.1405288279056549, mae:0.0833158940076828, rse:0.5313546657562256
Use GPU: cuda:0
>>>>>>>start training : IT_512_96_IT_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1307300
	speed: 0.0299s/iter; left time: 661.4012s
	iters: 200, epoch: 1 | loss: 0.1169153
	speed: 0.0295s/iter; left time: 649.2948s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.60s
Steps: 222 | Train Loss: 0.1395382 Vali Loss: 0.1032388 Test Loss: 0.1049907
Validation loss decreased (inf --> 0.103239).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0917928
	speed: 0.0557s/iter; left time: 1217.6038s
	iters: 200, epoch: 2 | loss: 0.0827175
	speed: 0.0287s/iter; left time: 624.5582s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.46s
Steps: 222 | Train Loss: 0.0932693 Vali Loss: 0.0824907 Test Loss: 0.0859276
Validation loss decreased (0.103239 --> 0.082491).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0872422
	speed: 0.0548s/iter; left time: 1186.2276s
	iters: 200, epoch: 3 | loss: 0.0782116
	speed: 0.0270s/iter; left time: 582.1704s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.24s
Steps: 222 | Train Loss: 0.0836970 Vali Loss: 0.0801819 Test Loss: 0.0838659
Validation loss decreased (0.082491 --> 0.080182).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0816273
	speed: 0.0592s/iter; left time: 1268.5184s
	iters: 200, epoch: 4 | loss: 0.0826085
	speed: 0.0267s/iter; left time: 569.6264s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.27s
Steps: 222 | Train Loss: 0.0810833 Vali Loss: 0.0788540 Test Loss: 0.0829947
Validation loss decreased (0.080182 --> 0.078854).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0761694
	speed: 0.0566s/iter; left time: 1201.0110s
	iters: 200, epoch: 5 | loss: 0.0798683
	speed: 0.0270s/iter; left time: 569.4732s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.44s
Steps: 222 | Train Loss: 0.0795185 Vali Loss: 0.0781875 Test Loss: 0.0825942
Validation loss decreased (0.078854 --> 0.078187).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0777261
	speed: 0.0551s/iter; left time: 1156.6782s
	iters: 200, epoch: 6 | loss: 0.0814498
	speed: 0.0286s/iter; left time: 598.3216s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.46s
Steps: 222 | Train Loss: 0.0783964 Vali Loss: 0.0775421 Test Loss: 0.0821851
Validation loss decreased (0.078187 --> 0.077542).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0739338
	speed: 0.0550s/iter; left time: 1142.5101s
	iters: 200, epoch: 7 | loss: 0.0811702
	speed: 0.0280s/iter; left time: 578.6869s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.40s
Steps: 222 | Train Loss: 0.0774509 Vali Loss: 0.0783391 Test Loss: 0.0824711
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0753421
	speed: 0.0553s/iter; left time: 1136.8596s
	iters: 200, epoch: 8 | loss: 0.0756552
	speed: 0.0269s/iter; left time: 550.5640s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.22s
Steps: 222 | Train Loss: 0.0767014 Vali Loss: 0.0771883 Test Loss: 0.0820175
Validation loss decreased (0.077542 --> 0.077188).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0738878
	speed: 0.0593s/iter; left time: 1204.7930s
	iters: 200, epoch: 9 | loss: 0.0749177
	speed: 0.0268s/iter; left time: 542.7853s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.31s
Steps: 222 | Train Loss: 0.0760252 Vali Loss: 0.0781950 Test Loss: 0.0820919
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0755344
	speed: 0.0569s/iter; left time: 1143.6002s
	iters: 200, epoch: 10 | loss: 0.0751255
	speed: 0.0270s/iter; left time: 539.5263s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.52s
Steps: 222 | Train Loss: 0.0755306 Vali Loss: 0.0778631 Test Loss: 0.0822712
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0782155
	speed: 0.0549s/iter; left time: 1091.8220s
	iters: 200, epoch: 11 | loss: 0.0755833
	speed: 0.0290s/iter; left time: 573.2812s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.50s
Steps: 222 | Train Loss: 0.0749816 Vali Loss: 0.0776737 Test Loss: 0.0817804
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0693621
	speed: 0.0548s/iter; left time: 1077.9669s
	iters: 200, epoch: 12 | loss: 0.0719745
	speed: 0.0273s/iter; left time: 533.2537s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.43s
Steps: 222 | Train Loss: 0.0745667 Vali Loss: 0.0779224 Test Loss: 0.0818569
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0694613
	speed: 0.0573s/iter; left time: 1113.5811s
	iters: 200, epoch: 13 | loss: 0.0725119
	speed: 0.0269s/iter; left time: 521.0562s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.28s
Steps: 222 | Train Loss: 0.0740950 Vali Loss: 0.0777880 Test Loss: 0.0819785
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0775695
	speed: 0.0581s/iter; left time: 1115.6870s
	iters: 200, epoch: 14 | loss: 0.0681774
	speed: 0.0270s/iter; left time: 516.6794s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.37s
Steps: 222 | Train Loss: 0.0736995 Vali Loss: 0.0773107 Test Loss: 0.0820360
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0733372
	speed: 0.0569s/iter; left time: 1081.2037s
	iters: 200, epoch: 15 | loss: 0.0732900
	speed: 0.0273s/iter; left time: 516.6942s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.57s
Steps: 222 | Train Loss: 0.0734037 Vali Loss: 0.0772424 Test Loss: 0.0821582
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0713919
	speed: 0.0549s/iter; left time: 1030.8488s
	iters: 200, epoch: 16 | loss: 0.0709377
	speed: 0.0313s/iter; left time: 583.8926s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.68s
Steps: 222 | Train Loss: 0.0731161 Vali Loss: 0.0773405 Test Loss: 0.0820549
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0754753
	speed: 0.0540s/iter; left time: 1001.8352s
	iters: 200, epoch: 17 | loss: 0.0705882
	speed: 0.0272s/iter; left time: 501.7343s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.29s
Steps: 222 | Train Loss: 0.0728018 Vali Loss: 0.0775164 Test Loss: 0.0821095
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0719491
	speed: 0.0591s/iter; left time: 1083.3750s
	iters: 200, epoch: 18 | loss: 0.0699536
	speed: 0.0275s/iter; left time: 500.3980s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.79s
Steps: 222 | Train Loss: 0.0726074 Vali Loss: 0.0776926 Test Loss: 0.0821289
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_96_IT_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01836535520851612, rmse:0.13551883399486542, mae:0.08201750367879868, rse:0.51241135597229
Intermediate time for IT and pred_len 96: 00h:08m:37.56s
=== Starting experiments for pred_len: 168 ===

--- Running model for IT, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_168_IT_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1298100
	speed: 0.0534s/iter; left time: 1180.0906s
	iters: 200, epoch: 1 | loss: 0.1176691
	speed: 0.0292s/iter; left time: 643.0642s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.75s
Steps: 222 | Train Loss: 0.1401385 Vali Loss: 0.1051041 Test Loss: 0.1060515
Validation loss decreased (inf --> 0.105104).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0925689
	speed: 0.0530s/iter; left time: 1158.9939s
	iters: 200, epoch: 2 | loss: 0.0874640
	speed: 0.0274s/iter; left time: 597.2888s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.43s
Steps: 222 | Train Loss: 0.0966582 Vali Loss: 0.0868458 Test Loss: 0.0894829
Validation loss decreased (0.105104 --> 0.086846).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0902038
	speed: 0.0607s/iter; left time: 1313.8809s
	iters: 200, epoch: 3 | loss: 0.0879562
	speed: 0.0273s/iter; left time: 588.1558s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.22s
Steps: 222 | Train Loss: 0.0874138 Vali Loss: 0.0842694 Test Loss: 0.0879542
Validation loss decreased (0.086846 --> 0.084269).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0857633
	speed: 0.0538s/iter; left time: 1153.1748s
	iters: 200, epoch: 4 | loss: 0.0834477
	speed: 0.0272s/iter; left time: 580.5097s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.40s
Steps: 222 | Train Loss: 0.0846647 Vali Loss: 0.0835778 Test Loss: 0.0880411
Validation loss decreased (0.084269 --> 0.083578).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0838752
	speed: 0.0540s/iter; left time: 1144.7333s
	iters: 200, epoch: 5 | loss: 0.0841271
	speed: 0.0300s/iter; left time: 632.4537s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.60s
Steps: 222 | Train Loss: 0.0829673 Vali Loss: 0.0838262 Test Loss: 0.0883332
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0792901
	speed: 0.0527s/iter; left time: 1106.0900s
	iters: 200, epoch: 6 | loss: 0.0827553
	speed: 0.0281s/iter; left time: 587.3857s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.34s
Steps: 222 | Train Loss: 0.0816290 Vali Loss: 0.0842234 Test Loss: 0.0882273
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0829263
	speed: 0.0550s/iter; left time: 1142.8870s
	iters: 200, epoch: 7 | loss: 0.0831176
	speed: 0.0273s/iter; left time: 563.8993s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.37s
Steps: 222 | Train Loss: 0.0805962 Vali Loss: 0.0847038 Test Loss: 0.0883791
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0816610
	speed: 0.0575s/iter; left time: 1181.3405s
	iters: 200, epoch: 8 | loss: 0.0787463
	speed: 0.0276s/iter; left time: 564.5246s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.57s
Steps: 222 | Train Loss: 0.0797245 Vali Loss: 0.0845396 Test Loss: 0.0883748
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0766695
	speed: 0.0528s/iter; left time: 1073.0838s
	iters: 200, epoch: 9 | loss: 0.0811797
	speed: 0.0309s/iter; left time: 625.4854s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.65s
Steps: 222 | Train Loss: 0.0790013 Vali Loss: 0.0842658 Test Loss: 0.0882581
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0773436
	speed: 0.0541s/iter; left time: 1086.6544s
	iters: 200, epoch: 10 | loss: 0.0750153
	speed: 0.0282s/iter; left time: 563.2027s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.55s
Steps: 222 | Train Loss: 0.0784806 Vali Loss: 0.0848489 Test Loss: 0.0890048
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0781072
	speed: 0.0543s/iter; left time: 1079.4039s
	iters: 200, epoch: 11 | loss: 0.0776325
	speed: 0.0273s/iter; left time: 540.2096s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.30s
Steps: 222 | Train Loss: 0.0778847 Vali Loss: 0.0847653 Test Loss: 0.0893754
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0796271
	speed: 0.0551s/iter; left time: 1082.2326s
	iters: 200, epoch: 12 | loss: 0.0788494
	speed: 0.0272s/iter; left time: 532.2107s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.48s
Steps: 222 | Train Loss: 0.0774273 Vali Loss: 0.0847762 Test Loss: 0.0897269
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0719526
	speed: 0.0518s/iter; left time: 1006.1097s
	iters: 200, epoch: 13 | loss: 0.0759829
	speed: 0.0291s/iter; left time: 562.6513s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.46s
Steps: 222 | Train Loss: 0.0770110 Vali Loss: 0.0850721 Test Loss: 0.0895426
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0745691
	speed: 0.0531s/iter; left time: 1020.3689s
	iters: 200, epoch: 14 | loss: 0.0722817
	speed: 0.0281s/iter; left time: 537.2496s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.44s
Steps: 222 | Train Loss: 0.0765886 Vali Loss: 0.0847122 Test Loss: 0.0897249
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_168_IT_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.0201936773955822, rmse:0.14210446178913116, mae:0.08804111182689667, rse:0.5378115773200989
Use GPU: cuda:0
>>>>>>>start training : IT_512_168_IT_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1329002
	speed: 0.0291s/iter; left time: 642.7910s
	iters: 200, epoch: 1 | loss: 0.1175623
	speed: 0.0281s/iter; left time: 619.0376s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.42s
Steps: 222 | Train Loss: 0.1417617 Vali Loss: 0.1047845 Test Loss: 0.1055077
Validation loss decreased (inf --> 0.104784).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0927295
	speed: 0.0578s/iter; left time: 1264.0138s
	iters: 200, epoch: 2 | loss: 0.0941170
	speed: 0.0277s/iter; left time: 604.3101s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.35s
Steps: 222 | Train Loss: 0.0963996 Vali Loss: 0.0871643 Test Loss: 0.0895704
Validation loss decreased (0.104784 --> 0.087164).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0878410
	speed: 0.0590s/iter; left time: 1278.2876s
	iters: 200, epoch: 3 | loss: 0.0902920
	speed: 0.0280s/iter; left time: 603.3085s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.59s
Steps: 222 | Train Loss: 0.0870747 Vali Loss: 0.0847243 Test Loss: 0.0878319
Validation loss decreased (0.087164 --> 0.084724).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0853640
	speed: 0.0566s/iter; left time: 1213.5422s
	iters: 200, epoch: 4 | loss: 0.0840227
	speed: 0.0282s/iter; left time: 601.4801s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.58s
Steps: 222 | Train Loss: 0.0846555 Vali Loss: 0.0835151 Test Loss: 0.0876056
Validation loss decreased (0.084724 --> 0.083515).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0851938
	speed: 0.0580s/iter; left time: 1229.8414s
	iters: 200, epoch: 5 | loss: 0.0813548
	speed: 0.0306s/iter; left time: 645.7616s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.76s
Steps: 222 | Train Loss: 0.0830201 Vali Loss: 0.0840696 Test Loss: 0.0879182
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0852846
	speed: 0.0531s/iter; left time: 1114.5854s
	iters: 200, epoch: 6 | loss: 0.0810560
	speed: 0.0272s/iter; left time: 567.2324s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.30s
Steps: 222 | Train Loss: 0.0818896 Vali Loss: 0.0842003 Test Loss: 0.0879094
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0802038
	speed: 0.0572s/iter; left time: 1187.9462s
	iters: 200, epoch: 7 | loss: 0.0809201
	speed: 0.0271s/iter; left time: 559.9111s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.23s
Steps: 222 | Train Loss: 0.0808258 Vali Loss: 0.0832934 Test Loss: 0.0873938
Validation loss decreased (0.083515 --> 0.083293).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0792483
	speed: 0.0624s/iter; left time: 1281.8376s
	iters: 200, epoch: 8 | loss: 0.0819951
	speed: 0.0279s/iter; left time: 570.6466s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.80s
Steps: 222 | Train Loss: 0.0800518 Vali Loss: 0.0839962 Test Loss: 0.0880267
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0774117
	speed: 0.0541s/iter; left time: 1098.8363s
	iters: 200, epoch: 9 | loss: 0.0775325
	speed: 0.0285s/iter; left time: 576.1996s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.40s
Steps: 222 | Train Loss: 0.0793224 Vali Loss: 0.0844191 Test Loss: 0.0877155
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0806580
	speed: 0.0556s/iter; left time: 1116.7889s
	iters: 200, epoch: 10 | loss: 0.0799583
	speed: 0.0277s/iter; left time: 555.0166s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.60s
Steps: 222 | Train Loss: 0.0787225 Vali Loss: 0.0840966 Test Loss: 0.0883957
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0771481
	speed: 0.0573s/iter; left time: 1138.9736s
	iters: 200, epoch: 11 | loss: 0.0804428
	speed: 0.0278s/iter; left time: 549.0437s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.41s
Steps: 222 | Train Loss: 0.0780882 Vali Loss: 0.0844000 Test Loss: 0.0881920
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0766762
	speed: 0.0586s/iter; left time: 1151.7988s
	iters: 200, epoch: 12 | loss: 0.0793117
	speed: 0.0274s/iter; left time: 535.4687s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.36s
Steps: 222 | Train Loss: 0.0776378 Vali Loss: 0.0840316 Test Loss: 0.0880184
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0769361
	speed: 0.0577s/iter; left time: 1121.7394s
	iters: 200, epoch: 13 | loss: 0.0785047
	speed: 0.0276s/iter; left time: 532.7954s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.59s
Steps: 222 | Train Loss: 0.0771586 Vali Loss: 0.0841548 Test Loss: 0.0880232
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0777556
	speed: 0.0529s/iter; left time: 1017.3781s
	iters: 200, epoch: 14 | loss: 0.0767437
	speed: 0.0300s/iter; left time: 573.3832s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.52s
Steps: 222 | Train Loss: 0.0767452 Vali Loss: 0.0836313 Test Loss: 0.0883247
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0787518
	speed: 0.0534s/iter; left time: 1014.7503s
	iters: 200, epoch: 15 | loss: 0.0794870
	speed: 0.0274s/iter; left time: 518.1945s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.30s
Steps: 222 | Train Loss: 0.0763562 Vali Loss: 0.0837894 Test Loss: 0.0880314
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0768457
	speed: 0.0613s/iter; left time: 1150.8829s
	iters: 200, epoch: 16 | loss: 0.0772194
	speed: 0.0280s/iter; left time: 523.0709s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.50s
Steps: 222 | Train Loss: 0.0760031 Vali Loss: 0.0840183 Test Loss: 0.0883679
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0778723
	speed: 0.0571s/iter; left time: 1058.7481s
	iters: 200, epoch: 17 | loss: 0.0730445
	speed: 0.0282s/iter; left time: 519.6386s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.73s
Steps: 222 | Train Loss: 0.0756556 Vali Loss: 0.0837157 Test Loss: 0.0881411
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_168_IT_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020205043256282806, rmse:0.14214444160461426, mae:0.08739381283521652, rse:0.5379629135131836
Intermediate time for IT and pred_len 168: 00h:04m:33.10sIntermediate time for IT: 00h:29m:38.75sTotal time: 02h:35m:30.27s