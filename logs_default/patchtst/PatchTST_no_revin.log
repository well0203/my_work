
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_DE_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2499919
	speed: 0.0658s/iter; left time: 1460.8138s
	iters: 200, epoch: 1 | loss: 0.2436910
	speed: 0.0406s/iter; left time: 898.0765s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.53s
Steps: 223 | Train Loss: 0.2587705 Vali Loss: 0.2142105 Test Loss: 0.2142683
Validation loss decreased (inf --> 0.214210).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1444289
	speed: 0.0730s/iter; left time: 1604.8517s
	iters: 200, epoch: 2 | loss: 0.1144736
	speed: 0.0406s/iter; left time: 888.4407s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.1504814 Vali Loss: 0.1128043 Test Loss: 0.1141900
Validation loss decreased (0.214210 --> 0.112804).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0981728
	speed: 0.0739s/iter; left time: 1607.4491s
	iters: 200, epoch: 3 | loss: 0.0966857
	speed: 0.0407s/iter; left time: 881.5327s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.26s
Steps: 223 | Train Loss: 0.1023327 Vali Loss: 0.1024211 Test Loss: 0.1045258
Validation loss decreased (0.112804 --> 0.102421).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0986164
	speed: 0.0731s/iter; left time: 1574.1318s
	iters: 200, epoch: 4 | loss: 0.0926824
	speed: 0.0405s/iter; left time: 868.4345s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0923211 Vali Loss: 0.0976600 Test Loss: 0.1011424
Validation loss decreased (0.102421 --> 0.097660).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0845721
	speed: 0.0730s/iter; left time: 1556.1748s
	iters: 200, epoch: 5 | loss: 0.0823605
	speed: 0.0407s/iter; left time: 862.4737s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0869272 Vali Loss: 0.0991358 Test Loss: 0.1009714
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0904725
	speed: 0.0726s/iter; left time: 1531.8614s
	iters: 200, epoch: 6 | loss: 0.0837727
	speed: 0.0405s/iter; left time: 850.0220s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0847074 Vali Loss: 0.0954096 Test Loss: 0.0982914
Validation loss decreased (0.097660 --> 0.095410).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0801862
	speed: 0.0734s/iter; left time: 1531.9617s
	iters: 200, epoch: 7 | loss: 0.0803515
	speed: 0.0408s/iter; left time: 846.8477s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.27s
Steps: 223 | Train Loss: 0.0832287 Vali Loss: 0.0951605 Test Loss: 0.0972525
Validation loss decreased (0.095410 --> 0.095161).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0804220
	speed: 0.0736s/iter; left time: 1518.7944s
	iters: 200, epoch: 8 | loss: 0.0831103
	speed: 0.0406s/iter; left time: 834.1243s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.0819955 Vali Loss: 0.0937350 Test Loss: 0.0955580
Validation loss decreased (0.095161 --> 0.093735).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0793873
	speed: 0.0733s/iter; left time: 1496.4164s
	iters: 200, epoch: 9 | loss: 0.0803101
	speed: 0.0407s/iter; left time: 827.1249s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.0811540 Vali Loss: 0.0927585 Test Loss: 0.0953479
Validation loss decreased (0.093735 --> 0.092758).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0782375
	speed: 0.0731s/iter; left time: 1475.5020s
	iters: 200, epoch: 10 | loss: 0.0773353
	speed: 0.0405s/iter; left time: 814.0009s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.19s
Steps: 223 | Train Loss: 0.0800262 Vali Loss: 0.0921328 Test Loss: 0.0946891
Validation loss decreased (0.092758 --> 0.092133).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0823820
	speed: 0.0737s/iter; left time: 1471.4809s
	iters: 200, epoch: 11 | loss: 0.0817686
	speed: 0.0408s/iter; left time: 810.8882s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.0796635 Vali Loss: 0.0937218 Test Loss: 0.0953466
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0754142
	speed: 0.0732s/iter; left time: 1445.2342s
	iters: 200, epoch: 12 | loss: 0.0828499
	speed: 0.0407s/iter; left time: 799.6367s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.0791359 Vali Loss: 0.0927852 Test Loss: 0.0945764
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0757163
	speed: 0.0730s/iter; left time: 1425.1292s
	iters: 200, epoch: 13 | loss: 0.0751605
	speed: 0.0406s/iter; left time: 789.3677s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0785484 Vali Loss: 0.0908916 Test Loss: 0.0931771
Validation loss decreased (0.092133 --> 0.090892).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0783123
	speed: 0.0738s/iter; left time: 1424.8674s
	iters: 200, epoch: 14 | loss: 0.0730657
	speed: 0.0408s/iter; left time: 782.9000s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.26s
Steps: 223 | Train Loss: 0.0783134 Vali Loss: 0.0914211 Test Loss: 0.0944387
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0774497
	speed: 0.0729s/iter; left time: 1390.6462s
	iters: 200, epoch: 15 | loss: 0.0728654
	speed: 0.0407s/iter; left time: 772.6495s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0776525 Vali Loss: 0.0905649 Test Loss: 0.0927544
Validation loss decreased (0.090892 --> 0.090565).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0790887
	speed: 0.0738s/iter; left time: 1391.1247s
	iters: 200, epoch: 16 | loss: 0.0848109
	speed: 0.0408s/iter; left time: 764.5445s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.26s
Steps: 223 | Train Loss: 0.0773813 Vali Loss: 0.0902008 Test Loss: 0.0929217
Validation loss decreased (0.090565 --> 0.090201).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0758974
	speed: 0.0733s/iter; left time: 1365.3199s
	iters: 200, epoch: 17 | loss: 0.0838227
	speed: 0.0408s/iter; left time: 756.0861s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.28s
Steps: 223 | Train Loss: 0.0771536 Vali Loss: 0.0904575 Test Loss: 0.0925641
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0757755
	speed: 0.0737s/iter; left time: 1355.9004s
	iters: 200, epoch: 18 | loss: 0.0695810
	speed: 0.0406s/iter; left time: 743.9856s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0770377 Vali Loss: 0.0901770 Test Loss: 0.0923888
Validation loss decreased (0.090201 --> 0.090177).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0788964
	speed: 0.0735s/iter; left time: 1336.5116s
	iters: 200, epoch: 19 | loss: 0.0844894
	speed: 0.0407s/iter; left time: 735.8726s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.0769240 Vali Loss: 0.0897702 Test Loss: 0.0919861
Validation loss decreased (0.090177 --> 0.089770).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0775444
	speed: 0.0737s/iter; left time: 1324.1760s
	iters: 200, epoch: 20 | loss: 0.0746429
	speed: 0.0407s/iter; left time: 727.3712s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.26s
Steps: 223 | Train Loss: 0.0764474 Vali Loss: 0.0902695 Test Loss: 0.0922728
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0802677
	speed: 0.0740s/iter; left time: 1313.1684s
	iters: 200, epoch: 21 | loss: 0.0794932
	speed: 0.0412s/iter; left time: 726.6119s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.30s
Steps: 223 | Train Loss: 0.0762567 Vali Loss: 0.0901378 Test Loss: 0.0922254
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0770537
	speed: 0.0729s/iter; left time: 1277.6140s
	iters: 200, epoch: 22 | loss: 0.0755091
	speed: 0.0406s/iter; left time: 707.7604s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0761860 Vali Loss: 0.0894913 Test Loss: 0.0918291
Validation loss decreased (0.089770 --> 0.089491).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0777771
	speed: 0.0741s/iter; left time: 1281.5458s
	iters: 200, epoch: 23 | loss: 0.0789890
	speed: 0.0406s/iter; left time: 698.1924s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.32s
Steps: 223 | Train Loss: 0.0762359 Vali Loss: 0.0894669 Test Loss: 0.0919503
Validation loss decreased (0.089491 --> 0.089467).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0799321
	speed: 0.0741s/iter; left time: 1265.6626s
	iters: 200, epoch: 24 | loss: 0.0719270
	speed: 0.0409s/iter; left time: 694.0638s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.30s
Steps: 223 | Train Loss: 0.0760288 Vali Loss: 0.0891843 Test Loss: 0.0916291
Validation loss decreased (0.089467 --> 0.089184).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0755746
	speed: 0.0747s/iter; left time: 1257.9010s
	iters: 200, epoch: 25 | loss: 0.0722538
	speed: 0.0406s/iter; left time: 680.4375s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0758618 Vali Loss: 0.0900205 Test Loss: 0.0921426
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0737276
	speed: 0.0731s/iter; left time: 1215.3027s
	iters: 200, epoch: 26 | loss: 0.0673043
	speed: 0.0408s/iter; left time: 674.2375s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.0758111 Vali Loss: 0.0891910 Test Loss: 0.0915482
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0730214
	speed: 0.0733s/iter; left time: 1202.0108s
	iters: 200, epoch: 27 | loss: 0.0759810
	speed: 0.0406s/iter; left time: 661.5126s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0757108 Vali Loss: 0.0891556 Test Loss: 0.0914952
Validation loss decreased (0.089184 --> 0.089156).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0771012
	speed: 0.0735s/iter; left time: 1189.8955s
	iters: 200, epoch: 28 | loss: 0.0760731
	speed: 0.0406s/iter; left time: 652.8488s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0756882 Vali Loss: 0.0890177 Test Loss: 0.0914545
Validation loss decreased (0.089156 --> 0.089018).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0769613
	speed: 0.0737s/iter; left time: 1175.7426s
	iters: 200, epoch: 29 | loss: 0.0793866
	speed: 0.0405s/iter; left time: 642.5562s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0755070 Vali Loss: 0.0891815 Test Loss: 0.0915899
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0799019
	speed: 0.0724s/iter; left time: 1138.8449s
	iters: 200, epoch: 30 | loss: 0.0709466
	speed: 0.0407s/iter; left time: 636.5624s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0754872 Vali Loss: 0.0889884 Test Loss: 0.0913857
Validation loss decreased (0.089018 --> 0.088988).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0772122
	speed: 0.0734s/iter; left time: 1137.9824s
	iters: 200, epoch: 31 | loss: 0.0749073
	speed: 0.0407s/iter; left time: 627.4633s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0756048 Vali Loss: 0.0890902 Test Loss: 0.0914594
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0750521
	speed: 0.0730s/iter; left time: 1116.4423s
	iters: 200, epoch: 32 | loss: 0.0714288
	speed: 0.0405s/iter; left time: 615.0117s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0753802 Vali Loss: 0.0892077 Test Loss: 0.0914487
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0754758
	speed: 0.0731s/iter; left time: 1100.5299s
	iters: 200, epoch: 33 | loss: 0.0736746
	speed: 0.0408s/iter; left time: 610.0020s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.0753398 Vali Loss: 0.0888427 Test Loss: 0.0911820
Validation loss decreased (0.088988 --> 0.088843).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0780085
	speed: 0.0736s/iter; left time: 1092.1198s
	iters: 200, epoch: 34 | loss: 0.0827072
	speed: 0.0407s/iter; left time: 599.8373s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.26s
Steps: 223 | Train Loss: 0.0754376 Vali Loss: 0.0886854 Test Loss: 0.0912371
Validation loss decreased (0.088843 --> 0.088685).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0754874
	speed: 0.0739s/iter; left time: 1080.0398s
	iters: 200, epoch: 35 | loss: 0.0765214
	speed: 0.0406s/iter; left time: 589.1172s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0751991 Vali Loss: 0.0887921 Test Loss: 0.0912284
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0704297
	speed: 0.0735s/iter; left time: 1057.7101s
	iters: 200, epoch: 36 | loss: 0.0678000
	speed: 0.0408s/iter; left time: 582.6455s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.27s
Steps: 223 | Train Loss: 0.0752452 Vali Loss: 0.0890741 Test Loss: 0.0913816
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0751649
	speed: 0.0740s/iter; left time: 1048.2918s
	iters: 200, epoch: 37 | loss: 0.0667919
	speed: 0.0407s/iter; left time: 572.2563s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.0751544 Vali Loss: 0.0895227 Test Loss: 0.0917092
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0733178
	speed: 0.0728s/iter; left time: 1016.0476s
	iters: 200, epoch: 38 | loss: 0.0748011
	speed: 0.0407s/iter; left time: 564.0559s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0752542 Vali Loss: 0.0889293 Test Loss: 0.0913233
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0749977
	speed: 0.0728s/iter; left time: 999.0728s
	iters: 200, epoch: 39 | loss: 0.0753593
	speed: 0.0408s/iter; left time: 555.3169s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0751538 Vali Loss: 0.0889531 Test Loss: 0.0914155
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0715109
	speed: 0.0732s/iter; left time: 988.9210s
	iters: 200, epoch: 40 | loss: 0.0728657
	speed: 0.0406s/iter; left time: 544.0460s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0750966 Vali Loss: 0.0888149 Test Loss: 0.0912853
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0752533
	speed: 0.0726s/iter; left time: 964.3129s
	iters: 200, epoch: 41 | loss: 0.0700043
	speed: 0.0405s/iter; left time: 534.0720s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0750710 Vali Loss: 0.0891853 Test Loss: 0.0914680
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0787514
	speed: 0.0721s/iter; left time: 941.1671s
	iters: 200, epoch: 42 | loss: 0.0725864
	speed: 0.0406s/iter; left time: 525.5893s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:09.20s
Steps: 223 | Train Loss: 0.0751097 Vali Loss: 0.0889587 Test Loss: 0.0911660
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0719825
	speed: 0.0727s/iter; left time: 933.3287s
	iters: 200, epoch: 43 | loss: 0.0771057
	speed: 0.0406s/iter; left time: 517.3801s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:09.20s
Steps: 223 | Train Loss: 0.0751448 Vali Loss: 0.0888525 Test Loss: 0.0911740
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0768098
	speed: 0.0723s/iter; left time: 912.4304s
	iters: 200, epoch: 44 | loss: 0.0772383
	speed: 0.0405s/iter; left time: 507.0488s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0750597 Vali Loss: 0.0886218 Test Loss: 0.0911328
Validation loss decreased (0.088685 --> 0.088622).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0779737
	speed: 0.0741s/iter; left time: 917.4950s
	iters: 200, epoch: 45 | loss: 0.0755863
	speed: 0.0407s/iter; left time: 500.7758s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.0750743 Vali Loss: 0.0887918 Test Loss: 0.0912314
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0722934
	speed: 0.0728s/iter; left time: 885.1862s
	iters: 200, epoch: 46 | loss: 0.0699959
	speed: 0.0407s/iter; left time: 490.9774s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0749830 Vali Loss: 0.0889013 Test Loss: 0.0912362
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0759183
	speed: 0.0736s/iter; left time: 878.5527s
	iters: 200, epoch: 47 | loss: 0.0749620
	speed: 0.0406s/iter; left time: 480.4826s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0749101 Vali Loss: 0.0888265 Test Loss: 0.0911309
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0698817
	speed: 0.0726s/iter; left time: 851.1191s
	iters: 200, epoch: 48 | loss: 0.0821849
	speed: 0.0411s/iter; left time: 477.1904s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:09.27s
Steps: 223 | Train Loss: 0.0750398 Vali Loss: 0.0890523 Test Loss: 0.0912561
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0728214
	speed: 0.0735s/iter; left time: 844.5457s
	iters: 200, epoch: 49 | loss: 0.0714761
	speed: 0.0408s/iter; left time: 464.8406s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:09.26s
Steps: 223 | Train Loss: 0.0750492 Vali Loss: 0.0888740 Test Loss: 0.0912737
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0724019
	speed: 0.0730s/iter; left time: 822.9129s
	iters: 200, epoch: 50 | loss: 0.0741286
	speed: 0.0406s/iter; left time: 453.3994s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:09.26s
Steps: 223 | Train Loss: 0.0750670 Vali Loss: 0.0887359 Test Loss: 0.0911868
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0787290
	speed: 0.0725s/iter; left time: 801.3948s
	iters: 200, epoch: 51 | loss: 0.0753462
	speed: 0.0404s/iter; left time: 442.7808s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:09.19s
Steps: 223 | Train Loss: 0.0749521 Vali Loss: 0.0887865 Test Loss: 0.0912171
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0740552
	speed: 0.0723s/iter; left time: 783.1845s
	iters: 200, epoch: 52 | loss: 0.0765331
	speed: 0.0404s/iter; left time: 433.8159s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:09.18s
Steps: 223 | Train Loss: 0.0749272 Vali Loss: 0.0887596 Test Loss: 0.0911566
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0752389
	speed: 0.0730s/iter; left time: 774.3844s
	iters: 200, epoch: 53 | loss: 0.0749326
	speed: 0.0406s/iter; left time: 426.7113s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0749209 Vali Loss: 0.0891328 Test Loss: 0.0914290
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0763818
	speed: 0.0723s/iter; left time: 750.4049s
	iters: 200, epoch: 54 | loss: 0.0732591
	speed: 0.0404s/iter; left time: 415.8886s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:09.17s
Steps: 223 | Train Loss: 0.0749576 Vali Loss: 0.0889539 Test Loss: 0.0911720
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_DE_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021490950137376785, rmse:0.14659792184829712, mae:0.09113281220197678, rse:0.5173643827438354
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_DE_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2490839
	speed: 0.0424s/iter; left time: 940.5830s
	iters: 200, epoch: 1 | loss: 0.2472512
	speed: 0.0404s/iter; left time: 893.8779s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.26s
Steps: 223 | Train Loss: 0.2592057 Vali Loss: 0.2150097 Test Loss: 0.2137868
Validation loss decreased (inf --> 0.215010).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1459719
	speed: 0.0749s/iter; left time: 1647.1686s
	iters: 200, epoch: 2 | loss: 0.1184580
	speed: 0.0405s/iter; left time: 885.9038s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.1509299 Vali Loss: 0.1149763 Test Loss: 0.1172944
Validation loss decreased (0.215010 --> 0.114976).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1085657
	speed: 0.0739s/iter; left time: 1608.4739s
	iters: 200, epoch: 3 | loss: 0.0910014
	speed: 0.0405s/iter; left time: 876.0632s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.1019505 Vali Loss: 0.1020273 Test Loss: 0.1047064
Validation loss decreased (0.114976 --> 0.102027).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0922076
	speed: 0.0742s/iter; left time: 1598.6307s
	iters: 200, epoch: 4 | loss: 0.0915935
	speed: 0.0405s/iter; left time: 867.5118s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.20s
Steps: 223 | Train Loss: 0.0911547 Vali Loss: 0.0988794 Test Loss: 0.1018604
Validation loss decreased (0.102027 --> 0.098879).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0869290
	speed: 0.0738s/iter; left time: 1573.3247s
	iters: 200, epoch: 5 | loss: 0.0920424
	speed: 0.0404s/iter; left time: 857.3965s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0867149 Vali Loss: 0.0959272 Test Loss: 0.0990677
Validation loss decreased (0.098879 --> 0.095927).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0805324
	speed: 0.0740s/iter; left time: 1559.9050s
	iters: 200, epoch: 6 | loss: 0.0808611
	speed: 0.0409s/iter; left time: 857.4625s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.26s
Steps: 223 | Train Loss: 0.0846302 Vali Loss: 0.0953569 Test Loss: 0.0985537
Validation loss decreased (0.095927 --> 0.095357).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0785462
	speed: 0.0739s/iter; left time: 1541.7431s
	iters: 200, epoch: 7 | loss: 0.0870119
	speed: 0.0404s/iter; left time: 839.4817s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0828189 Vali Loss: 0.0946173 Test Loss: 0.0970928
Validation loss decreased (0.095357 --> 0.094617).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0830550
	speed: 0.0743s/iter; left time: 1533.9439s
	iters: 200, epoch: 8 | loss: 0.0783509
	speed: 0.0405s/iter; left time: 830.9927s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0819139 Vali Loss: 0.0929983 Test Loss: 0.0954704
Validation loss decreased (0.094617 --> 0.092998).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0828439
	speed: 0.0738s/iter; left time: 1506.3108s
	iters: 200, epoch: 9 | loss: 0.0793067
	speed: 0.0405s/iter; left time: 823.4338s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0810855 Vali Loss: 0.0931124 Test Loss: 0.0957941
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0794291
	speed: 0.0738s/iter; left time: 1491.0702s
	iters: 200, epoch: 10 | loss: 0.0810912
	speed: 0.0405s/iter; left time: 813.5412s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0799131 Vali Loss: 0.0918286 Test Loss: 0.0939341
Validation loss decreased (0.092998 --> 0.091829).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0799937
	speed: 0.0739s/iter; left time: 1476.1767s
	iters: 200, epoch: 11 | loss: 0.0784184
	speed: 0.0404s/iter; left time: 802.8217s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0799298 Vali Loss: 0.0915549 Test Loss: 0.0937229
Validation loss decreased (0.091829 --> 0.091555).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0813086
	speed: 0.0744s/iter; left time: 1468.5366s
	iters: 200, epoch: 12 | loss: 0.0809460
	speed: 0.0405s/iter; left time: 795.2590s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0788708 Vali Loss: 0.0908034 Test Loss: 0.0935894
Validation loss decreased (0.091555 --> 0.090803).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0783942
	speed: 0.0741s/iter; left time: 1447.0675s
	iters: 200, epoch: 13 | loss: 0.0777297
	speed: 0.0404s/iter; left time: 785.4308s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.20s
Steps: 223 | Train Loss: 0.0781689 Vali Loss: 0.0904064 Test Loss: 0.0931068
Validation loss decreased (0.090803 --> 0.090406).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0749564
	speed: 0.0740s/iter; left time: 1428.0823s
	iters: 200, epoch: 14 | loss: 0.0798429
	speed: 0.0404s/iter; left time: 775.9453s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.20s
Steps: 223 | Train Loss: 0.0777671 Vali Loss: 0.0901483 Test Loss: 0.0928477
Validation loss decreased (0.090406 --> 0.090148).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0729283
	speed: 0.0744s/iter; left time: 1419.9873s
	iters: 200, epoch: 15 | loss: 0.0799183
	speed: 0.0408s/iter; left time: 773.7138s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.28s
Steps: 223 | Train Loss: 0.0773314 Vali Loss: 0.0902604 Test Loss: 0.0926346
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0805474
	speed: 0.0739s/iter; left time: 1394.0597s
	iters: 200, epoch: 16 | loss: 0.0798859
	speed: 0.0405s/iter; left time: 758.7350s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0775261 Vali Loss: 0.0915505 Test Loss: 0.0935391
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0801417
	speed: 0.0743s/iter; left time: 1383.7399s
	iters: 200, epoch: 17 | loss: 0.0805798
	speed: 0.0410s/iter; left time: 760.6452s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.30s
Steps: 223 | Train Loss: 0.0773038 Vali Loss: 0.0897665 Test Loss: 0.0923034
Validation loss decreased (0.090148 --> 0.089767).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0717844
	speed: 0.0740s/iter; left time: 1362.0225s
	iters: 200, epoch: 18 | loss: 0.0810524
	speed: 0.0404s/iter; left time: 740.4830s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.20s
Steps: 223 | Train Loss: 0.0767832 Vali Loss: 0.0896475 Test Loss: 0.0923133
Validation loss decreased (0.089767 --> 0.089647).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0745617
	speed: 0.0744s/iter; left time: 1353.3911s
	iters: 200, epoch: 19 | loss: 0.0777391
	speed: 0.0404s/iter; left time: 731.3619s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.26s
Steps: 223 | Train Loss: 0.0767936 Vali Loss: 0.0906551 Test Loss: 0.0926315
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0831475
	speed: 0.0750s/iter; left time: 1346.4112s
	iters: 200, epoch: 20 | loss: 0.0784714
	speed: 0.0407s/iter; left time: 726.4181s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.26s
Steps: 223 | Train Loss: 0.0763930 Vali Loss: 0.0905861 Test Loss: 0.0925194
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0737767
	speed: 0.0739s/iter; left time: 1311.7471s
	iters: 200, epoch: 21 | loss: 0.0791329
	speed: 0.0411s/iter; left time: 725.2459s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.28s
Steps: 223 | Train Loss: 0.0762994 Vali Loss: 0.0893644 Test Loss: 0.0919495
Validation loss decreased (0.089647 --> 0.089364).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0721182
	speed: 0.0740s/iter; left time: 1296.3618s
	iters: 200, epoch: 22 | loss: 0.0774618
	speed: 0.0404s/iter; left time: 704.2509s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0760505 Vali Loss: 0.0894501 Test Loss: 0.0918606
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0720288
	speed: 0.0733s/iter; left time: 1268.2947s
	iters: 200, epoch: 23 | loss: 0.0820614
	speed: 0.0409s/iter; left time: 702.9506s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.0760261 Vali Loss: 0.0895003 Test Loss: 0.0916805
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0764086
	speed: 0.0743s/iter; left time: 1268.0780s
	iters: 200, epoch: 24 | loss: 0.0725959
	speed: 0.0406s/iter; left time: 689.2166s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0760008 Vali Loss: 0.0896566 Test Loss: 0.0917640
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0786116
	speed: 0.0742s/iter; left time: 1250.0979s
	iters: 200, epoch: 25 | loss: 0.0806988
	speed: 0.0406s/iter; left time: 679.1920s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0759024 Vali Loss: 0.0898015 Test Loss: 0.0920800
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0746573
	speed: 0.0742s/iter; left time: 1233.6015s
	iters: 200, epoch: 26 | loss: 0.0807535
	speed: 0.0404s/iter; left time: 668.4374s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.0757923 Vali Loss: 0.0896346 Test Loss: 0.0917760
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0722282
	speed: 0.0739s/iter; left time: 1212.1805s
	iters: 200, epoch: 27 | loss: 0.0755098
	speed: 0.0409s/iter; left time: 666.1233s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.27s
Steps: 223 | Train Loss: 0.0757295 Vali Loss: 0.0904972 Test Loss: 0.0922839
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0760738
	speed: 0.0738s/iter; left time: 1194.1319s
	iters: 200, epoch: 28 | loss: 0.0779437
	speed: 0.0405s/iter; left time: 650.6543s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0756201 Vali Loss: 0.0896967 Test Loss: 0.0918662
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0767091
	speed: 0.0736s/iter; left time: 1174.1355s
	iters: 200, epoch: 29 | loss: 0.0785072
	speed: 0.0405s/iter; left time: 641.4380s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.20s
Steps: 223 | Train Loss: 0.0755951 Vali Loss: 0.0890588 Test Loss: 0.0913929
Validation loss decreased (0.089364 --> 0.089059).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0739342
	speed: 0.0740s/iter; left time: 1163.6194s
	iters: 200, epoch: 30 | loss: 0.0765195
	speed: 0.0404s/iter; left time: 632.0960s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0755656 Vali Loss: 0.0892964 Test Loss: 0.0915140
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0735635
	speed: 0.0735s/iter; left time: 1139.7656s
	iters: 200, epoch: 31 | loss: 0.0765849
	speed: 0.0404s/iter; left time: 622.7313s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0752674 Vali Loss: 0.0891411 Test Loss: 0.0913493
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0837285
	speed: 0.0734s/iter; left time: 1121.9148s
	iters: 200, epoch: 32 | loss: 0.0738451
	speed: 0.0407s/iter; left time: 617.7219s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0752781 Vali Loss: 0.0888913 Test Loss: 0.0913681
Validation loss decreased (0.089059 --> 0.088891).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0746147
	speed: 0.0743s/iter; left time: 1119.3678s
	iters: 200, epoch: 33 | loss: 0.0797450
	speed: 0.0404s/iter; left time: 605.2894s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0753205 Vali Loss: 0.0897216 Test Loss: 0.0917012
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0774863
	speed: 0.0737s/iter; left time: 1093.7600s
	iters: 200, epoch: 34 | loss: 0.0765698
	speed: 0.0404s/iter; left time: 596.2525s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0752888 Vali Loss: 0.0890659 Test Loss: 0.0913897
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0722521
	speed: 0.0736s/iter; left time: 1076.5117s
	iters: 200, epoch: 35 | loss: 0.0744749
	speed: 0.0404s/iter; left time: 587.1158s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.20s
Steps: 223 | Train Loss: 0.0752661 Vali Loss: 0.0889065 Test Loss: 0.0914638
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0719926
	speed: 0.0733s/iter; left time: 1055.9039s
	iters: 200, epoch: 36 | loss: 0.0778509
	speed: 0.0426s/iter; left time: 608.8478s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.43s
Steps: 223 | Train Loss: 0.0751457 Vali Loss: 0.0891029 Test Loss: 0.0912891
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0752357
	speed: 0.0736s/iter; left time: 1043.4570s
	iters: 200, epoch: 37 | loss: 0.0760674
	speed: 0.0410s/iter; left time: 576.9443s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.27s
Steps: 223 | Train Loss: 0.0751595 Vali Loss: 0.0890321 Test Loss: 0.0913641
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0730760
	speed: 0.0738s/iter; left time: 1029.5801s
	iters: 200, epoch: 38 | loss: 0.0733152
	speed: 0.0405s/iter; left time: 560.4740s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.19s
Steps: 223 | Train Loss: 0.0750889 Vali Loss: 0.0892685 Test Loss: 0.0913550
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0731313
	speed: 0.0740s/iter; left time: 1016.0448s
	iters: 200, epoch: 39 | loss: 0.0802235
	speed: 0.0406s/iter; left time: 552.8457s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0751633 Vali Loss: 0.0890973 Test Loss: 0.0913351
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0782451
	speed: 0.0738s/iter; left time: 997.0832s
	iters: 200, epoch: 40 | loss: 0.0770663
	speed: 0.0405s/iter; left time: 543.4730s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0750894 Vali Loss: 0.0888284 Test Loss: 0.0911175
Validation loss decreased (0.088891 --> 0.088828).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0729259
	speed: 0.0745s/iter; left time: 988.7966s
	iters: 200, epoch: 41 | loss: 0.0800762
	speed: 0.0407s/iter; left time: 536.8266s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0751201 Vali Loss: 0.0890968 Test Loss: 0.0913125
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0744944
	speed: 0.0739s/iter; left time: 964.4323s
	iters: 200, epoch: 42 | loss: 0.0714591
	speed: 0.0404s/iter; left time: 524.0150s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0750512 Vali Loss: 0.0891539 Test Loss: 0.0913914
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0745371
	speed: 0.0740s/iter; left time: 950.2899s
	iters: 200, epoch: 43 | loss: 0.0727399
	speed: 0.0409s/iter; left time: 520.3880s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.0750380 Vali Loss: 0.0888861 Test Loss: 0.0912264
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0763964
	speed: 0.0738s/iter; left time: 930.8001s
	iters: 200, epoch: 44 | loss: 0.0757533
	speed: 0.0405s/iter; left time: 506.4672s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:09.20s
Steps: 223 | Train Loss: 0.0750093 Vali Loss: 0.0889866 Test Loss: 0.0912434
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0779515
	speed: 0.0744s/iter; left time: 921.3173s
	iters: 200, epoch: 45 | loss: 0.0768006
	speed: 0.0405s/iter; left time: 497.1839s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:09.26s
Steps: 223 | Train Loss: 0.0749965 Vali Loss: 0.0889191 Test Loss: 0.0911606
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0754055
	speed: 0.0738s/iter; left time: 898.3389s
	iters: 200, epoch: 46 | loss: 0.0713660
	speed: 0.0405s/iter; left time: 488.1449s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0750679 Vali Loss: 0.0890442 Test Loss: 0.0913261
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0809722
	speed: 0.0740s/iter; left time: 883.5226s
	iters: 200, epoch: 47 | loss: 0.0759240
	speed: 0.0405s/iter; left time: 479.1877s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0749856 Vali Loss: 0.0891433 Test Loss: 0.0912630
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0784684
	speed: 0.0736s/iter; left time: 862.9615s
	iters: 200, epoch: 48 | loss: 0.0805372
	speed: 0.0406s/iter; left time: 471.4583s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0749227 Vali Loss: 0.0891498 Test Loss: 0.0913095
EarlyStopping counter: 8 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0751135
	speed: 0.0739s/iter; left time: 850.0897s
	iters: 200, epoch: 49 | loss: 0.0722965
	speed: 0.0405s/iter; left time: 461.0816s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0750630 Vali Loss: 0.0889131 Test Loss: 0.0911809
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0758723
	speed: 0.0741s/iter; left time: 835.0764s
	iters: 200, epoch: 50 | loss: 0.0768833
	speed: 0.0405s/iter; left time: 452.5161s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0749795 Vali Loss: 0.0890788 Test Loss: 0.0912218
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_DE_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021613840013742447, rmse:0.1470164656639099, mae:0.09111756086349487, rse:0.5188414454460144
Intermediate time for DE and pred_len 24: 00h:20m:00.30s
=== Starting experiments for pred_len: 96 ===

--- Running model for DE, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2567174
	speed: 0.0648s/iter; left time: 1432.0993s
	iters: 200, epoch: 1 | loss: 0.2369715
	speed: 0.0406s/iter; left time: 893.8286s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.54s
Steps: 222 | Train Loss: 0.2615639 Vali Loss: 0.2209979 Test Loss: 0.2222324
Validation loss decreased (inf --> 0.220998).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1564926
	speed: 0.0745s/iter; left time: 1630.5161s
	iters: 200, epoch: 2 | loss: 0.1341260
	speed: 0.0406s/iter; left time: 884.3588s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.26s
Steps: 222 | Train Loss: 0.1608338 Vali Loss: 0.1363482 Test Loss: 0.1418259
Validation loss decreased (0.220998 --> 0.136348).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1162611
	speed: 0.0748s/iter; left time: 1619.6686s
	iters: 200, epoch: 3 | loss: 0.1177480
	speed: 0.0406s/iter; left time: 874.7976s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.24s
Steps: 222 | Train Loss: 0.1208445 Vali Loss: 0.1277944 Test Loss: 0.1374204
Validation loss decreased (0.136348 --> 0.127794).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1102845
	speed: 0.0747s/iter; left time: 1601.3925s
	iters: 200, epoch: 4 | loss: 0.1140750
	speed: 0.0406s/iter; left time: 866.2031s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.23s
Steps: 222 | Train Loss: 0.1129174 Vali Loss: 0.1251605 Test Loss: 0.1341668
Validation loss decreased (0.127794 --> 0.125161).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1166949
	speed: 0.0747s/iter; left time: 1583.5849s
	iters: 200, epoch: 5 | loss: 0.1081393
	speed: 0.0406s/iter; left time: 857.7306s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.23s
Steps: 222 | Train Loss: 0.1103549 Vali Loss: 0.1227886 Test Loss: 0.1303220
Validation loss decreased (0.125161 --> 0.122789).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1062442
	speed: 0.0738s/iter; left time: 1549.4482s
	iters: 200, epoch: 6 | loss: 0.1072186
	speed: 0.0407s/iter; left time: 850.9097s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.24s
Steps: 222 | Train Loss: 0.1078670 Vali Loss: 0.1219471 Test Loss: 0.1291881
Validation loss decreased (0.122789 --> 0.121947).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1061169
	speed: 0.0746s/iter; left time: 1549.9471s
	iters: 200, epoch: 7 | loss: 0.1112051
	speed: 0.0407s/iter; left time: 840.6692s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.24s
Steps: 222 | Train Loss: 0.1068713 Vali Loss: 0.1213121 Test Loss: 0.1290444
Validation loss decreased (0.121947 --> 0.121312).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1057692
	speed: 0.0750s/iter; left time: 1541.0175s
	iters: 200, epoch: 8 | loss: 0.1068326
	speed: 0.0407s/iter; left time: 832.6106s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.22s
Steps: 222 | Train Loss: 0.1059914 Vali Loss: 0.1224635 Test Loss: 0.1298995
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1034219
	speed: 0.0740s/iter; left time: 1503.2741s
	iters: 200, epoch: 9 | loss: 0.0999100
	speed: 0.0407s/iter; left time: 823.7152s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.26s
Steps: 222 | Train Loss: 0.1050044 Vali Loss: 0.1230605 Test Loss: 0.1317926
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1093468
	speed: 0.0740s/iter; left time: 1486.9577s
	iters: 200, epoch: 10 | loss: 0.1081782
	speed: 0.0406s/iter; left time: 812.3368s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.25s
Steps: 222 | Train Loss: 0.1045642 Vali Loss: 0.1219349 Test Loss: 0.1301681
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1027195
	speed: 0.0738s/iter; left time: 1467.1678s
	iters: 200, epoch: 11 | loss: 0.1048118
	speed: 0.0407s/iter; left time: 805.4237s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.23s
Steps: 222 | Train Loss: 0.1038951 Vali Loss: 0.1220826 Test Loss: 0.1309490
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1036500
	speed: 0.0741s/iter; left time: 1456.2813s
	iters: 200, epoch: 12 | loss: 0.0967905
	speed: 0.0407s/iter; left time: 796.7972s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.24s
Steps: 222 | Train Loss: 0.1036535 Vali Loss: 0.1236033 Test Loss: 0.1331385
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1004048
	speed: 0.0737s/iter; left time: 1432.3356s
	iters: 200, epoch: 13 | loss: 0.0993740
	speed: 0.0406s/iter; left time: 784.7658s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.22s
Steps: 222 | Train Loss: 0.1033556 Vali Loss: 0.1226675 Test Loss: 0.1322711
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1005409
	speed: 0.0739s/iter; left time: 1420.1313s
	iters: 200, epoch: 14 | loss: 0.1024006
	speed: 0.0406s/iter; left time: 775.8794s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.20s
Steps: 222 | Train Loss: 0.1029066 Vali Loss: 0.1230128 Test Loss: 0.1320505
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1068955
	speed: 0.0734s/iter; left time: 1393.3702s
	iters: 200, epoch: 15 | loss: 0.1093898
	speed: 0.0407s/iter; left time: 769.7067s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.21s
Steps: 222 | Train Loss: 0.1028959 Vali Loss: 0.1227752 Test Loss: 0.1326943
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1076504
	speed: 0.0761s/iter; left time: 1427.9437s
	iters: 200, epoch: 16 | loss: 0.0938831
	speed: 0.0417s/iter; left time: 779.5070s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.57s
Steps: 222 | Train Loss: 0.1022091 Vali Loss: 0.1224919 Test Loss: 0.1329917
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1013022
	speed: 0.0749s/iter; left time: 1389.7856s
	iters: 200, epoch: 17 | loss: 0.1030388
	speed: 0.0407s/iter; left time: 750.2474s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.26s
Steps: 222 | Train Loss: 0.1022000 Vali Loss: 0.1220423 Test Loss: 0.1307992
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03688869625329971, rmse:0.1920643001794815, mae:0.12904435396194458, rse:0.6801385283470154
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2674383
	speed: 0.0427s/iter; left time: 943.7735s
	iters: 200, epoch: 1 | loss: 0.2461667
	speed: 0.0406s/iter; left time: 893.2663s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.27s
Steps: 222 | Train Loss: 0.2638501 Vali Loss: 0.2226131 Test Loss: 0.2216158
Validation loss decreased (inf --> 0.222613).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1543895
	speed: 0.0757s/iter; left time: 1656.3967s
	iters: 200, epoch: 2 | loss: 0.1398169
	speed: 0.0407s/iter; left time: 886.8301s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.25s
Steps: 222 | Train Loss: 0.1605066 Vali Loss: 0.1367813 Test Loss: 0.1428790
Validation loss decreased (0.222613 --> 0.136781).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1166887
	speed: 0.0768s/iter; left time: 1663.7442s
	iters: 200, epoch: 3 | loss: 0.1116634
	speed: 0.0408s/iter; left time: 879.9609s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1194075 Vali Loss: 0.1278751 Test Loss: 0.1380406
Validation loss decreased (0.136781 --> 0.127875).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1114147
	speed: 0.0758s/iter; left time: 1625.6180s
	iters: 200, epoch: 4 | loss: 0.1107357
	speed: 0.0408s/iter; left time: 869.5598s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.25s
Steps: 222 | Train Loss: 0.1119658 Vali Loss: 0.1239229 Test Loss: 0.1325669
Validation loss decreased (0.127875 --> 0.123923).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1104820
	speed: 0.0762s/iter; left time: 1616.7930s
	iters: 200, epoch: 5 | loss: 0.1076826
	speed: 0.0406s/iter; left time: 857.9088s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.25s
Steps: 222 | Train Loss: 0.1088037 Vali Loss: 0.1234485 Test Loss: 0.1317335
Validation loss decreased (0.123923 --> 0.123449).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1043967
	speed: 0.0761s/iter; left time: 1596.8855s
	iters: 200, epoch: 6 | loss: 0.1043626
	speed: 0.0407s/iter; left time: 849.8446s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.24s
Steps: 222 | Train Loss: 0.1072132 Vali Loss: 0.1251106 Test Loss: 0.1335774
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1115653
	speed: 0.0770s/iter; left time: 1599.2377s
	iters: 200, epoch: 7 | loss: 0.1044515
	speed: 0.0406s/iter; left time: 838.6782s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.24s
Steps: 222 | Train Loss: 0.1065478 Vali Loss: 0.1222214 Test Loss: 0.1305019
Validation loss decreased (0.123449 --> 0.122221).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1077851
	speed: 0.0769s/iter; left time: 1579.0798s
	iters: 200, epoch: 8 | loss: 0.1084414
	speed: 0.0414s/iter; left time: 847.1744s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.44s
Steps: 222 | Train Loss: 0.1052958 Vali Loss: 0.1238670 Test Loss: 0.1318427
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1064024
	speed: 0.0758s/iter; left time: 1541.4378s
	iters: 200, epoch: 9 | loss: 0.1059458
	speed: 0.0407s/iter; left time: 823.6497s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.28s
Steps: 222 | Train Loss: 0.1049578 Vali Loss: 0.1226378 Test Loss: 0.1321362
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1027817
	speed: 0.0769s/iter; left time: 1545.3618s
	iters: 200, epoch: 10 | loss: 0.1018352
	speed: 0.0408s/iter; left time: 815.8975s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.30s
Steps: 222 | Train Loss: 0.1040832 Vali Loss: 0.1221598 Test Loss: 0.1312657
Validation loss decreased (0.122221 --> 0.122160).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1044997
	speed: 0.0762s/iter; left time: 1515.3054s
	iters: 200, epoch: 11 | loss: 0.1089497
	speed: 0.0410s/iter; left time: 810.5174s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.31s
Steps: 222 | Train Loss: 0.1037177 Vali Loss: 0.1224726 Test Loss: 0.1325074
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1011573
	speed: 0.0752s/iter; left time: 1479.2674s
	iters: 200, epoch: 12 | loss: 0.1064023
	speed: 0.0407s/iter; left time: 795.6882s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.24s
Steps: 222 | Train Loss: 0.1033040 Vali Loss: 0.1231317 Test Loss: 0.1332391
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1020794
	speed: 0.0748s/iter; left time: 1453.4621s
	iters: 200, epoch: 13 | loss: 0.1041973
	speed: 0.0413s/iter; left time: 798.5129s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1027258 Vali Loss: 0.1206543 Test Loss: 0.1306935
Validation loss decreased (0.122160 --> 0.120654).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1010036
	speed: 0.0763s/iter; left time: 1465.2096s
	iters: 200, epoch: 14 | loss: 0.1005691
	speed: 0.0412s/iter; left time: 787.3859s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.32s
Steps: 222 | Train Loss: 0.1023238 Vali Loss: 0.1209531 Test Loss: 0.1310647
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1021855
	speed: 0.0771s/iter; left time: 1463.6128s
	iters: 200, epoch: 15 | loss: 0.1030579
	speed: 0.0409s/iter; left time: 773.2408s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1019652 Vali Loss: 0.1216964 Test Loss: 0.1336367
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0990499
	speed: 0.0760s/iter; left time: 1426.1772s
	iters: 200, epoch: 16 | loss: 0.1013082
	speed: 0.0411s/iter; left time: 768.1412s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.33s
Steps: 222 | Train Loss: 0.1017566 Vali Loss: 0.1207150 Test Loss: 0.1311256
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0989789
	speed: 0.0756s/iter; left time: 1402.1427s
	iters: 200, epoch: 17 | loss: 0.1032420
	speed: 0.0408s/iter; left time: 752.3694s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.32s
Steps: 222 | Train Loss: 0.1016855 Vali Loss: 0.1216641 Test Loss: 0.1335739
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1009876
	speed: 0.0770s/iter; left time: 1412.0166s
	iters: 200, epoch: 18 | loss: 0.0992788
	speed: 0.0409s/iter; left time: 745.9864s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.39s
Steps: 222 | Train Loss: 0.1016551 Vali Loss: 0.1225416 Test Loss: 0.1356461
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0994656
	speed: 0.0760s/iter; left time: 1375.1815s
	iters: 200, epoch: 19 | loss: 0.1023100
	speed: 0.0406s/iter; left time: 731.8847s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1011918 Vali Loss: 0.1226855 Test Loss: 0.1347964
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1051435
	speed: 0.0752s/iter; left time: 1344.7277s
	iters: 200, epoch: 20 | loss: 0.1025466
	speed: 0.0408s/iter; left time: 725.4539s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1011156 Vali Loss: 0.1218346 Test Loss: 0.1332678
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1033999
	speed: 0.0756s/iter; left time: 1335.3309s
	iters: 200, epoch: 21 | loss: 0.1037384
	speed: 0.0410s/iter; left time: 719.5225s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1009183 Vali Loss: 0.1211568 Test Loss: 0.1323556
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.1021763
	speed: 0.0752s/iter; left time: 1311.0473s
	iters: 200, epoch: 22 | loss: 0.0984414
	speed: 0.0408s/iter; left time: 707.8167s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.32s
Steps: 222 | Train Loss: 0.1006230 Vali Loss: 0.1213428 Test Loss: 0.1328119
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0972030
	speed: 0.0762s/iter; left time: 1312.4213s
	iters: 200, epoch: 23 | loss: 0.0972501
	speed: 0.0409s/iter; left time: 700.9353s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1005551 Vali Loss: 0.1217129 Test Loss: 0.1332923
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03879741579294205, rmse:0.196970596909523, mae:0.1306934952735901, rse:0.6975127458572388
Intermediate time for DE and pred_len 96: 00h:07m:58.46s
=== Starting experiments for pred_len: 168 ===

--- Running model for DE, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2547011
	speed: 0.0649s/iter; left time: 1434.3913s
	iters: 200, epoch: 1 | loss: 0.2446538
	speed: 0.0413s/iter; left time: 909.6503s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.63s
Steps: 222 | Train Loss: 0.2621706 Vali Loss: 0.2210747 Test Loss: 0.2229995
Validation loss decreased (inf --> 0.221075).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1477357
	speed: 0.0753s/iter; left time: 1646.9532s
	iters: 200, epoch: 2 | loss: 0.1341442
	speed: 0.0414s/iter; left time: 901.3195s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1630918 Vali Loss: 0.1387679 Test Loss: 0.1472351
Validation loss decreased (0.221075 --> 0.138768).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1283511
	speed: 0.0773s/iter; left time: 1673.2325s
	iters: 200, epoch: 3 | loss: 0.1233076
	speed: 0.0415s/iter; left time: 894.0401s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.41s
Steps: 222 | Train Loss: 0.1242776 Vali Loss: 0.1343270 Test Loss: 0.1477458
Validation loss decreased (0.138768 --> 0.134327).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1228040
	speed: 0.0763s/iter; left time: 1636.0119s
	iters: 200, epoch: 4 | loss: 0.1145430
	speed: 0.0415s/iter; left time: 884.3793s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.39s
Steps: 222 | Train Loss: 0.1177692 Vali Loss: 0.1332793 Test Loss: 0.1471356
Validation loss decreased (0.134327 --> 0.133279).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1108847
	speed: 0.0759s/iter; left time: 1609.3516s
	iters: 200, epoch: 5 | loss: 0.1184591
	speed: 0.0414s/iter; left time: 873.9368s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.37s
Steps: 222 | Train Loss: 0.1150895 Vali Loss: 0.1292599 Test Loss: 0.1394582
Validation loss decreased (0.133279 --> 0.129260).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1109404
	speed: 0.0769s/iter; left time: 1614.6553s
	iters: 200, epoch: 6 | loss: 0.1151391
	speed: 0.0413s/iter; left time: 863.2956s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.41s
Steps: 222 | Train Loss: 0.1130198 Vali Loss: 0.1282362 Test Loss: 0.1374332
Validation loss decreased (0.129260 --> 0.128236).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1107276
	speed: 0.0772s/iter; left time: 1603.9556s
	iters: 200, epoch: 7 | loss: 0.1117783
	speed: 0.0416s/iter; left time: 859.2919s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.48s
Steps: 222 | Train Loss: 0.1117408 Vali Loss: 0.1297795 Test Loss: 0.1401883
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1098032
	speed: 0.0757s/iter; left time: 1555.5269s
	iters: 200, epoch: 8 | loss: 0.1121785
	speed: 0.0416s/iter; left time: 849.6746s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.42s
Steps: 222 | Train Loss: 0.1110236 Vali Loss: 0.1291916 Test Loss: 0.1372601
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1095344
	speed: 0.0752s/iter; left time: 1527.6213s
	iters: 200, epoch: 9 | loss: 0.1124224
	speed: 0.0416s/iter; left time: 841.2329s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.42s
Steps: 222 | Train Loss: 0.1099584 Vali Loss: 0.1276474 Test Loss: 0.1373459
Validation loss decreased (0.128236 --> 0.127647).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1069649
	speed: 0.0766s/iter; left time: 1540.7017s
	iters: 200, epoch: 10 | loss: 0.1128789
	speed: 0.0415s/iter; left time: 829.4442s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.40s
Steps: 222 | Train Loss: 0.1094869 Vali Loss: 0.1279376 Test Loss: 0.1391968
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1130599
	speed: 0.0759s/iter; left time: 1508.8837s
	iters: 200, epoch: 11 | loss: 0.1103044
	speed: 0.0414s/iter; left time: 818.9556s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.38s
Steps: 222 | Train Loss: 0.1087799 Vali Loss: 0.1274702 Test Loss: 0.1376306
Validation loss decreased (0.127647 --> 0.127470).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1128469
	speed: 0.0758s/iter; left time: 1490.2098s
	iters: 200, epoch: 12 | loss: 0.1105351
	speed: 0.0411s/iter; left time: 804.6000s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.33s
Steps: 222 | Train Loss: 0.1082214 Vali Loss: 0.1273075 Test Loss: 0.1389605
Validation loss decreased (0.127470 --> 0.127308).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1044768
	speed: 0.0755s/iter; left time: 1467.1021s
	iters: 200, epoch: 13 | loss: 0.1075517
	speed: 0.0413s/iter; left time: 798.0555s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.38s
Steps: 222 | Train Loss: 0.1078091 Vali Loss: 0.1270512 Test Loss: 0.1373295
Validation loss decreased (0.127308 --> 0.127051).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1049805
	speed: 0.0767s/iter; left time: 1473.9038s
	iters: 200, epoch: 14 | loss: 0.1062305
	speed: 0.0414s/iter; left time: 790.5586s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.40s
