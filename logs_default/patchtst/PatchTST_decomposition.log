
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1467022
	speed: 0.0950s/iter; left time: 2118.9031s
	iters: 200, epoch: 1 | loss: 0.1380337
	speed: 0.0659s/iter; left time: 1463.5829s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:15.38s
Steps: 224 | Train Loss: 0.1492598 Vali Loss: 0.1491447 Test Loss: 0.1573455
Validation loss decreased (inf --> 0.149145).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0933916
	speed: 0.1230s/iter; left time: 2716.2641s
	iters: 200, epoch: 2 | loss: 0.0793409
	speed: 0.0694s/iter; left time: 1525.5481s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:15.56s
Steps: 224 | Train Loss: 0.0958381 Vali Loss: 0.0959918 Test Loss: 0.0965967
Validation loss decreased (0.149145 --> 0.095992).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0804107
	speed: 0.1329s/iter; left time: 2904.6195s
	iters: 200, epoch: 3 | loss: 0.0822360
	speed: 0.0601s/iter; left time: 1306.8907s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:14.72s
Steps: 224 | Train Loss: 0.0800409 Vali Loss: 0.0911792 Test Loss: 0.0924903
Validation loss decreased (0.095992 --> 0.091179).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0721088
	speed: 0.1141s/iter; left time: 2468.9429s
	iters: 200, epoch: 4 | loss: 0.0784065
	speed: 0.0637s/iter; left time: 1372.0856s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:14.60s
Steps: 224 | Train Loss: 0.0768202 Vali Loss: 0.0894785 Test Loss: 0.0912090
Validation loss decreased (0.091179 --> 0.089479).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0701359
	speed: 0.1280s/iter; left time: 2740.0871s
	iters: 200, epoch: 5 | loss: 0.0721674
	speed: 0.0634s/iter; left time: 1350.0053s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:14.95s
Steps: 224 | Train Loss: 0.0751275 Vali Loss: 0.0886305 Test Loss: 0.0903440
Validation loss decreased (0.089479 --> 0.088631).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0747568
	speed: 0.1270s/iter; left time: 2689.6027s
	iters: 200, epoch: 6 | loss: 0.0739783
	speed: 0.0656s/iter; left time: 1382.7311s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:15.98s
Steps: 224 | Train Loss: 0.0740978 Vali Loss: 0.0879776 Test Loss: 0.0896847
Validation loss decreased (0.088631 --> 0.087978).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0773371
	speed: 0.1189s/iter; left time: 2491.1703s
	iters: 200, epoch: 7 | loss: 0.0693570
	speed: 0.0658s/iter; left time: 1373.4131s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:14.93s
Steps: 224 | Train Loss: 0.0731795 Vali Loss: 0.0878054 Test Loss: 0.0894686
Validation loss decreased (0.087978 --> 0.087805).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0742184
	speed: 0.1238s/iter; left time: 2565.7303s
	iters: 200, epoch: 8 | loss: 0.0694305
	speed: 0.0701s/iter; left time: 1447.0983s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:15.62s
Steps: 224 | Train Loss: 0.0726620 Vali Loss: 0.0872411 Test Loss: 0.0890743
Validation loss decreased (0.087805 --> 0.087241).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0730793
	speed: 0.1373s/iter; left time: 2816.8462s
	iters: 200, epoch: 9 | loss: 0.0740317
	speed: 0.0627s/iter; left time: 1280.4878s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:15.16s
Steps: 224 | Train Loss: 0.0721427 Vali Loss: 0.0873636 Test Loss: 0.0895516
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0651195
	speed: 0.1195s/iter; left time: 2424.1713s
	iters: 200, epoch: 10 | loss: 0.0683019
	speed: 0.0632s/iter; left time: 1276.0370s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:14.78s
Steps: 224 | Train Loss: 0.0717890 Vali Loss: 0.0870031 Test Loss: 0.0891616
Validation loss decreased (0.087241 --> 0.087003).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0714403
	speed: 0.1300s/iter; left time: 2607.9335s
	iters: 200, epoch: 11 | loss: 0.0766668
	speed: 0.0645s/iter; left time: 1286.4963s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0714359 Vali Loss: 0.0870827 Test Loss: 0.0894357
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0713613
	speed: 0.1163s/iter; left time: 2306.6772s
	iters: 200, epoch: 12 | loss: 0.0730791
	speed: 0.0674s/iter; left time: 1330.8254s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:14.63s
Steps: 224 | Train Loss: 0.0711605 Vali Loss: 0.0868916 Test Loss: 0.0890513
Validation loss decreased (0.087003 --> 0.086892).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0658389
	speed: 0.1201s/iter; left time: 2356.2263s
	iters: 200, epoch: 13 | loss: 0.0685006
	speed: 0.0734s/iter; left time: 1431.8800s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:15.72s
Steps: 224 | Train Loss: 0.0708652 Vali Loss: 0.0865712 Test Loss: 0.0891132
Validation loss decreased (0.086892 --> 0.086571).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0742952
	speed: 0.1337s/iter; left time: 2591.8576s
	iters: 200, epoch: 14 | loss: 0.0701290
	speed: 0.0607s/iter; left time: 1170.5141s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:14.60s
Steps: 224 | Train Loss: 0.0706609 Vali Loss: 0.0864862 Test Loss: 0.0889904
Validation loss decreased (0.086571 --> 0.086486).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0725446
	speed: 0.1249s/iter; left time: 2393.5944s
	iters: 200, epoch: 15 | loss: 0.0695209
	speed: 0.0637s/iter; left time: 1214.7578s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:14.81s
Steps: 224 | Train Loss: 0.0704827 Vali Loss: 0.0864452 Test Loss: 0.0889387
Validation loss decreased (0.086486 --> 0.086445).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0676632
	speed: 0.1199s/iter; left time: 2270.5361s
	iters: 200, epoch: 16 | loss: 0.0735662
	speed: 0.0667s/iter; left time: 1256.2349s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:15.05s
Steps: 224 | Train Loss: 0.0703078 Vali Loss: 0.0865087 Test Loss: 0.0890939
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0669014
	speed: 0.1205s/iter; left time: 2256.0113s
	iters: 200, epoch: 17 | loss: 0.0692772
	speed: 0.0647s/iter; left time: 1204.2729s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:14.60s
Steps: 224 | Train Loss: 0.0701388 Vali Loss: 0.0867771 Test Loss: 0.0890331
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0704841
	speed: 0.1230s/iter; left time: 2275.2929s
	iters: 200, epoch: 18 | loss: 0.0685036
	speed: 0.0720s/iter; left time: 1324.1445s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:15.36s
Steps: 224 | Train Loss: 0.0699684 Vali Loss: 0.0864049 Test Loss: 0.0891183
Validation loss decreased (0.086445 --> 0.086405).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0693344
	speed: 0.1250s/iter; left time: 2284.3230s
	iters: 200, epoch: 19 | loss: 0.0699148
	speed: 0.0629s/iter; left time: 1143.3571s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:14.46s
Steps: 224 | Train Loss: 0.0698359 Vali Loss: 0.0864480 Test Loss: 0.0891146
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0743156
	speed: 0.1131s/iter; left time: 2040.7547s
	iters: 200, epoch: 20 | loss: 0.0695782
	speed: 0.0632s/iter; left time: 1133.6380s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:14.62s
Steps: 224 | Train Loss: 0.0698212 Vali Loss: 0.0862729 Test Loss: 0.0889007
Validation loss decreased (0.086405 --> 0.086273).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0642834
	speed: 0.1247s/iter; left time: 2223.1491s
	iters: 200, epoch: 21 | loss: 0.0729156
	speed: 0.0623s/iter; left time: 1104.2577s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:14.12s
Steps: 224 | Train Loss: 0.0696815 Vali Loss: 0.0863191 Test Loss: 0.0889219
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0668081
	speed: 0.1139s/iter; left time: 2003.4293s
	iters: 200, epoch: 22 | loss: 0.0675850
	speed: 0.0641s/iter; left time: 1120.9391s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:14.34s
Steps: 224 | Train Loss: 0.0696013 Vali Loss: 0.0863717 Test Loss: 0.0890059
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0662554
	speed: 0.1180s/iter; left time: 2049.7502s
	iters: 200, epoch: 23 | loss: 0.0715963
	speed: 0.0639s/iter; left time: 1103.6358s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:14.63s
Steps: 224 | Train Loss: 0.0694505 Vali Loss: 0.0862607 Test Loss: 0.0890646
Validation loss decreased (0.086273 --> 0.086261).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0695211
	speed: 0.1102s/iter; left time: 1889.0027s
	iters: 200, epoch: 24 | loss: 0.0653179
	speed: 0.0629s/iter; left time: 1072.1291s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:13.89s
Steps: 224 | Train Loss: 0.0693793 Vali Loss: 0.0863263 Test Loss: 0.0889909
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0677006
	speed: 0.1239s/iter; left time: 2097.2938s
	iters: 200, epoch: 25 | loss: 0.0705059
	speed: 0.0661s/iter; left time: 1112.4056s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:14.75s
Steps: 224 | Train Loss: 0.0693588 Vali Loss: 0.0863821 Test Loss: 0.0890807
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0654885
	speed: 0.1172s/iter; left time: 1957.9176s
	iters: 200, epoch: 26 | loss: 0.0649945
	speed: 0.0655s/iter; left time: 1086.6304s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:14.47s
Steps: 224 | Train Loss: 0.0692742 Vali Loss: 0.0864751 Test Loss: 0.0893381
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0677808
	speed: 0.1194s/iter; left time: 1966.8512s
	iters: 200, epoch: 27 | loss: 0.0714075
	speed: 0.0619s/iter; left time: 1014.0380s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:14.69s
Steps: 224 | Train Loss: 0.0692092 Vali Loss: 0.0862476 Test Loss: 0.0890449
Validation loss decreased (0.086261 --> 0.086248).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0650818
	speed: 0.1338s/iter; left time: 2175.3443s
	iters: 200, epoch: 28 | loss: 0.0720823
	speed: 0.0628s/iter; left time: 1013.9104s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:14.69s
Steps: 224 | Train Loss: 0.0691955 Vali Loss: 0.0863042 Test Loss: 0.0889602
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0675507
	speed: 0.1180s/iter; left time: 1891.4063s
	iters: 200, epoch: 29 | loss: 0.0689953
	speed: 0.0637s/iter; left time: 1013.9908s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:14.39s
Steps: 224 | Train Loss: 0.0691315 Vali Loss: 0.0862055 Test Loss: 0.0891577
Validation loss decreased (0.086248 --> 0.086206).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0723119
	speed: 0.1205s/iter; left time: 1904.0685s
	iters: 200, epoch: 30 | loss: 0.0689444
	speed: 0.0712s/iter; left time: 1118.9621s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:15.57s
Steps: 224 | Train Loss: 0.0690726 Vali Loss: 0.0864122 Test Loss: 0.0891799
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0699471
	speed: 0.1202s/iter; left time: 1872.5759s
	iters: 200, epoch: 31 | loss: 0.0650906
	speed: 0.0614s/iter; left time: 950.8127s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:14.07s
Steps: 224 | Train Loss: 0.0690898 Vali Loss: 0.0861617 Test Loss: 0.0890982
Validation loss decreased (0.086206 --> 0.086162).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0697123
	speed: 0.1258s/iter; left time: 1932.4683s
	iters: 200, epoch: 32 | loss: 0.0689837
	speed: 0.0672s/iter; left time: 1025.0592s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:14.74s
Steps: 224 | Train Loss: 0.0690290 Vali Loss: 0.0862783 Test Loss: 0.0891600
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0689367
	speed: 0.1181s/iter; left time: 1786.6067s
	iters: 200, epoch: 33 | loss: 0.0651389
	speed: 0.0605s/iter; left time: 909.9110s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:13.98s
Steps: 224 | Train Loss: 0.0689599 Vali Loss: 0.0864315 Test Loss: 0.0891968
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0703542
	speed: 0.1150s/iter; left time: 1714.7491s
	iters: 200, epoch: 34 | loss: 0.0736774
	speed: 0.0611s/iter; left time: 905.5012s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:13.71s
Steps: 224 | Train Loss: 0.0689449 Vali Loss: 0.0863892 Test Loss: 0.0892073
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0694088
	speed: 0.1209s/iter; left time: 1776.0411s
	iters: 200, epoch: 35 | loss: 0.0643488
	speed: 0.0608s/iter; left time: 886.1649s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:14.04s
Steps: 224 | Train Loss: 0.0689930 Vali Loss: 0.0862459 Test Loss: 0.0891558
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0662179
	speed: 0.1141s/iter; left time: 1649.5385s
	iters: 200, epoch: 36 | loss: 0.0716586
	speed: 0.0613s/iter; left time: 879.9374s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:14.30s
Steps: 224 | Train Loss: 0.0689090 Vali Loss: 0.0862916 Test Loss: 0.0891562
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0689815
	speed: 0.1206s/iter; left time: 1716.8763s
	iters: 200, epoch: 37 | loss: 0.0692148
	speed: 0.0590s/iter; left time: 834.6358s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:13.57s
Steps: 224 | Train Loss: 0.0688933 Vali Loss: 0.0864036 Test Loss: 0.0891469
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0756959
	speed: 0.1219s/iter; left time: 1707.6168s
	iters: 200, epoch: 38 | loss: 0.0706713
	speed: 0.0631s/iter; left time: 877.3000s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:14.53s
Steps: 224 | Train Loss: 0.0689504 Vali Loss: 0.0863323 Test Loss: 0.0891482
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0717678
	speed: 0.1210s/iter; left time: 1667.7915s
	iters: 200, epoch: 39 | loss: 0.0696688
	speed: 0.0636s/iter; left time: 871.2852s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:14.90s
Steps: 224 | Train Loss: 0.0688292 Vali Loss: 0.0862189 Test Loss: 0.0891291
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0669256
	speed: 0.1225s/iter; left time: 1662.1895s
	iters: 200, epoch: 40 | loss: 0.0677449
	speed: 0.0633s/iter; left time: 851.7725s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:14.46s
Steps: 224 | Train Loss: 0.0688930 Vali Loss: 0.0861876 Test Loss: 0.0891016
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0648098
	speed: 0.1213s/iter; left time: 1618.3571s
	iters: 200, epoch: 41 | loss: 0.0646161
	speed: 0.0676s/iter; left time: 894.6094s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:15.33s
Steps: 224 | Train Loss: 0.0688258 Vali Loss: 0.0862216 Test Loss: 0.0891206
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021291740238666534, rmse:0.1459168940782547, mae:0.08909820020198822, rse:0.5149609446525574
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1485177
	speed: 0.0621s/iter; left time: 1384.0774s
	iters: 200, epoch: 1 | loss: 0.1372107
	speed: 0.0651s/iter; left time: 1446.2785s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:14.28s
Steps: 224 | Train Loss: 0.1479508 Vali Loss: 0.1469130 Test Loss: 0.1552787
Validation loss decreased (inf --> 0.146913).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0860679
	speed: 0.1240s/iter; left time: 2736.6685s
	iters: 200, epoch: 2 | loss: 0.0842555
	speed: 0.0617s/iter; left time: 1355.3881s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:14.32s
Steps: 224 | Train Loss: 0.0963806 Vali Loss: 0.0965345 Test Loss: 0.0970062
Validation loss decreased (0.146913 --> 0.096534).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0792745
	speed: 0.1228s/iter; left time: 2683.1567s
	iters: 200, epoch: 3 | loss: 0.0799089
	speed: 0.0657s/iter; left time: 1429.1401s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:15.05s
Steps: 224 | Train Loss: 0.0806034 Vali Loss: 0.0915469 Test Loss: 0.0932558
Validation loss decreased (0.096534 --> 0.091547).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0692745
	speed: 0.1149s/iter; left time: 2486.1917s
	iters: 200, epoch: 4 | loss: 0.0753272
	speed: 0.0625s/iter; left time: 1346.4517s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:14.10s
Steps: 224 | Train Loss: 0.0771334 Vali Loss: 0.0894109 Test Loss: 0.0913275
Validation loss decreased (0.091547 --> 0.089411).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0780892
	speed: 0.1276s/iter; left time: 2731.8281s
	iters: 200, epoch: 5 | loss: 0.0733127
	speed: 0.0621s/iter; left time: 1322.0636s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:15.09s
Steps: 224 | Train Loss: 0.0752457 Vali Loss: 0.0887977 Test Loss: 0.0907949
Validation loss decreased (0.089411 --> 0.088798).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0735669
	speed: 0.1179s/iter; left time: 2496.6906s
	iters: 200, epoch: 6 | loss: 0.0754406
	speed: 0.0604s/iter; left time: 1272.8398s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:14.01s
Steps: 224 | Train Loss: 0.0741429 Vali Loss: 0.0879942 Test Loss: 0.0900813
Validation loss decreased (0.088798 --> 0.087994).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0708586
	speed: 0.1147s/iter; left time: 2403.2162s
	iters: 200, epoch: 7 | loss: 0.0723750
	speed: 0.0675s/iter; left time: 1407.8100s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:14.90s
Steps: 224 | Train Loss: 0.0733710 Vali Loss: 0.0877222 Test Loss: 0.0897023
Validation loss decreased (0.087994 --> 0.087722).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0735653
	speed: 0.1221s/iter; left time: 2530.4863s
	iters: 200, epoch: 8 | loss: 0.0752200
	speed: 0.0629s/iter; left time: 1297.5821s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:14.53s
Steps: 224 | Train Loss: 0.0726825 Vali Loss: 0.0871324 Test Loss: 0.0893786
Validation loss decreased (0.087722 --> 0.087132).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0738944
	speed: 0.1156s/iter; left time: 2370.1262s
	iters: 200, epoch: 9 | loss: 0.0740931
	speed: 0.0647s/iter; left time: 1319.9574s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:14.63s
Steps: 224 | Train Loss: 0.0721897 Vali Loss: 0.0869960 Test Loss: 0.0890788
Validation loss decreased (0.087132 --> 0.086996).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0751932
	speed: 0.1254s/iter; left time: 2542.9586s
	iters: 200, epoch: 10 | loss: 0.0673028
	speed: 0.0662s/iter; left time: 1336.2239s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:14.72s
Steps: 224 | Train Loss: 0.0717408 Vali Loss: 0.0867880 Test Loss: 0.0891405
Validation loss decreased (0.086996 --> 0.086788).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0667565
	speed: 0.1210s/iter; left time: 2427.9128s
	iters: 200, epoch: 11 | loss: 0.0711614
	speed: 0.0618s/iter; left time: 1232.8800s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:14.38s
Steps: 224 | Train Loss: 0.0714507 Vali Loss: 0.0870664 Test Loss: 0.0891779
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0710983
	speed: 0.1320s/iter; left time: 2619.0962s
	iters: 200, epoch: 12 | loss: 0.0680309
	speed: 0.0659s/iter; left time: 1299.9922s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.74s
Steps: 224 | Train Loss: 0.0711380 Vali Loss: 0.0867219 Test Loss: 0.0890017
Validation loss decreased (0.086788 --> 0.086722).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0719549
	speed: 0.1264s/iter; left time: 2478.2972s
	iters: 200, epoch: 13 | loss: 0.0728736
	speed: 0.0667s/iter; left time: 1302.1044s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:14.77s
Steps: 224 | Train Loss: 0.0709379 Vali Loss: 0.0864662 Test Loss: 0.0890279
Validation loss decreased (0.086722 --> 0.086466).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0695809
	speed: 0.1251s/iter; left time: 2424.6956s
	iters: 200, epoch: 14 | loss: 0.0691624
	speed: 0.0709s/iter; left time: 1367.8997s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:15.36s
Steps: 224 | Train Loss: 0.0707244 Vali Loss: 0.0867192 Test Loss: 0.0890669
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0662107
	speed: 0.1254s/iter; left time: 2402.8683s
	iters: 200, epoch: 15 | loss: 0.0770034
	speed: 0.0634s/iter; left time: 1207.9135s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:14.89s
Steps: 224 | Train Loss: 0.0704650 Vali Loss: 0.0864952 Test Loss: 0.0890869
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0746670
	speed: 0.1261s/iter; left time: 2387.6390s
	iters: 200, epoch: 16 | loss: 0.0751349
	speed: 0.0661s/iter; left time: 1246.2305s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:14.93s
Steps: 224 | Train Loss: 0.0703478 Vali Loss: 0.0866213 Test Loss: 0.0890552
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0691212
	speed: 0.1290s/iter; left time: 2413.9802s
	iters: 200, epoch: 17 | loss: 0.0701027
	speed: 0.0672s/iter; left time: 1250.4591s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:15.08s
Steps: 224 | Train Loss: 0.0701723 Vali Loss: 0.0864791 Test Loss: 0.0890113
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0723499
	speed: 0.1182s/iter; left time: 2185.8872s
	iters: 200, epoch: 18 | loss: 0.0661663
	speed: 0.0649s/iter; left time: 1194.5697s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:14.77s
Steps: 224 | Train Loss: 0.0700250 Vali Loss: 0.0864334 Test Loss: 0.0889767
Validation loss decreased (0.086466 --> 0.086433).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0676247
	speed: 0.1403s/iter; left time: 2563.1624s
	iters: 200, epoch: 19 | loss: 0.0656377
	speed: 0.0662s/iter; left time: 1203.3913s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:16.01s
Steps: 224 | Train Loss: 0.0698972 Vali Loss: 0.0863700 Test Loss: 0.0890557
Validation loss decreased (0.086433 --> 0.086370).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0731429
	speed: 0.1251s/iter; left time: 2257.0634s
	iters: 200, epoch: 20 | loss: 0.0692441
	speed: 0.0640s/iter; left time: 1148.2912s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:15.11s
Steps: 224 | Train Loss: 0.0697965 Vali Loss: 0.0862033 Test Loss: 0.0890447
Validation loss decreased (0.086370 --> 0.086203).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0687015
	speed: 0.1302s/iter; left time: 2320.8509s
	iters: 200, epoch: 21 | loss: 0.0658207
	speed: 0.0727s/iter; left time: 1288.2780s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:15.50s
Steps: 224 | Train Loss: 0.0696816 Vali Loss: 0.0863567 Test Loss: 0.0893161
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0706210
	speed: 0.1223s/iter; left time: 2152.9136s
	iters: 200, epoch: 22 | loss: 0.0746962
	speed: 0.0656s/iter; left time: 1147.4610s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:14.58s
Steps: 224 | Train Loss: 0.0696258 Vali Loss: 0.0863918 Test Loss: 0.0891025
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0717456
	speed: 0.1242s/iter; left time: 2157.3633s
	iters: 200, epoch: 23 | loss: 0.0713271
	speed: 0.0631s/iter; left time: 1089.6731s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:14.99s
Steps: 224 | Train Loss: 0.0695054 Vali Loss: 0.0861524 Test Loss: 0.0890253
Validation loss decreased (0.086203 --> 0.086152).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0754816
	speed: 0.1252s/iter; left time: 2146.2373s
	iters: 200, epoch: 24 | loss: 0.0685918
	speed: 0.0637s/iter; left time: 1085.9859s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:14.48s
Steps: 224 | Train Loss: 0.0694104 Vali Loss: 0.0862667 Test Loss: 0.0890559
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0633278
	speed: 0.1208s/iter; left time: 2045.3087s
	iters: 200, epoch: 25 | loss: 0.0648984
	speed: 0.0652s/iter; left time: 1097.2327s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:14.99s
Steps: 224 | Train Loss: 0.0693590 Vali Loss: 0.0861933 Test Loss: 0.0891097
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0697152
	speed: 0.1304s/iter; left time: 2177.3724s
	iters: 200, epoch: 26 | loss: 0.0684530
	speed: 0.0669s/iter; left time: 1110.8550s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:15.66s
Steps: 224 | Train Loss: 0.0692901 Vali Loss: 0.0861402 Test Loss: 0.0891699
Validation loss decreased (0.086152 --> 0.086140).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0680913
	speed: 0.1202s/iter; left time: 1980.6748s
	iters: 200, epoch: 27 | loss: 0.0710975
	speed: 0.0665s/iter; left time: 1088.3861s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:14.77s
Steps: 224 | Train Loss: 0.0692415 Vali Loss: 0.0861493 Test Loss: 0.0890312
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0662386
	speed: 0.1191s/iter; left time: 1935.2237s
	iters: 200, epoch: 28 | loss: 0.0694833
	speed: 0.0707s/iter; left time: 1141.6237s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:15.37s
Steps: 224 | Train Loss: 0.0691602 Vali Loss: 0.0861183 Test Loss: 0.0892049
Validation loss decreased (0.086140 --> 0.086118).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0725555
	speed: 0.1381s/iter; left time: 2212.8754s
	iters: 200, epoch: 29 | loss: 0.0715661
	speed: 0.0615s/iter; left time: 979.6940s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:14.43s
Steps: 224 | Train Loss: 0.0691908 Vali Loss: 0.0860879 Test Loss: 0.0891321
Validation loss decreased (0.086118 --> 0.086088).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0675764
	speed: 0.1190s/iter; left time: 1880.9579s
	iters: 200, epoch: 30 | loss: 0.0685819
	speed: 0.0651s/iter; left time: 1021.9364s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:14.45s
Steps: 224 | Train Loss: 0.0691524 Vali Loss: 0.0860893 Test Loss: 0.0891131
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0705770
	speed: 0.1307s/iter; left time: 2036.3264s
	iters: 200, epoch: 31 | loss: 0.0713090
	speed: 0.0700s/iter; left time: 1083.7904s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:15.73s
Steps: 224 | Train Loss: 0.0691323 Vali Loss: 0.0861251 Test Loss: 0.0891209
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0725021
	speed: 0.1215s/iter; left time: 1866.2094s
	iters: 200, epoch: 32 | loss: 0.0674104
	speed: 0.0628s/iter; left time: 958.6838s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:14.67s
Steps: 224 | Train Loss: 0.0690699 Vali Loss: 0.0860819 Test Loss: 0.0890955
Validation loss decreased (0.086088 --> 0.086082).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0671740
	speed: 0.1250s/iter; left time: 1891.9180s
	iters: 200, epoch: 33 | loss: 0.0640508
	speed: 0.0776s/iter; left time: 1165.9629s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:16.15s
Steps: 224 | Train Loss: 0.0690287 Vali Loss: 0.0861212 Test Loss: 0.0891954
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0705414
	speed: 0.1315s/iter; left time: 1961.1411s
	iters: 200, epoch: 34 | loss: 0.0681740
	speed: 0.0631s/iter; left time: 934.4324s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:15.14s
Steps: 224 | Train Loss: 0.0689596 Vali Loss: 0.0862194 Test Loss: 0.0890935
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0701695
	speed: 0.1257s/iter; left time: 1846.2539s
	iters: 200, epoch: 35 | loss: 0.0673041
	speed: 0.0613s/iter; left time: 893.5701s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:14.62s
Steps: 224 | Train Loss: 0.0689486 Vali Loss: 0.0861580 Test Loss: 0.0891037
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0642554
	speed: 0.1356s/iter; left time: 1960.5575s
	iters: 200, epoch: 36 | loss: 0.0672532
	speed: 0.0671s/iter; left time: 964.1959s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:15.65s
Steps: 224 | Train Loss: 0.0689205 Vali Loss: 0.0860491 Test Loss: 0.0890471
Validation loss decreased (0.086082 --> 0.086049).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0744950
	speed: 0.1247s/iter; left time: 1775.0127s
	iters: 200, epoch: 37 | loss: 0.0638594
	speed: 0.0624s/iter; left time: 881.9234s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:14.61s
Steps: 224 | Train Loss: 0.0689579 Vali Loss: 0.0861269 Test Loss: 0.0891083
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0700178
	speed: 0.1234s/iter; left time: 1728.6455s
	iters: 200, epoch: 38 | loss: 0.0661885
	speed: 0.0670s/iter; left time: 931.7994s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:15.64s
Steps: 224 | Train Loss: 0.0688744 Vali Loss: 0.0861560 Test Loss: 0.0891225
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0645115
	speed: 0.1244s/iter; left time: 1714.9794s
	iters: 200, epoch: 39 | loss: 0.0643578
	speed: 0.0657s/iter; left time: 899.2097s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:14.99s
Steps: 224 | Train Loss: 0.0689252 Vali Loss: 0.0861439 Test Loss: 0.0890523
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0712911
	speed: 0.1209s/iter; left time: 1639.7164s
	iters: 200, epoch: 40 | loss: 0.0740808
	speed: 0.0560s/iter; left time: 753.9828s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:14.36s
Steps: 224 | Train Loss: 0.0688536 Vali Loss: 0.0859760 Test Loss: 0.0890604
Validation loss decreased (0.086049 --> 0.085976).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0645042
	speed: 0.1357s/iter; left time: 1810.8289s
	iters: 200, epoch: 41 | loss: 0.0700506
	speed: 0.0656s/iter; left time: 868.9498s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:15.02s
Steps: 224 | Train Loss: 0.0688851 Vali Loss: 0.0861665 Test Loss: 0.0890974
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0722492
	speed: 0.1259s/iter; left time: 1651.6405s
	iters: 200, epoch: 42 | loss: 0.0705930
	speed: 0.0633s/iter; left time: 824.6233s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:15.00s
Steps: 224 | Train Loss: 0.0688321 Vali Loss: 0.0860264 Test Loss: 0.0891213
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0742681
	speed: 0.1254s/iter; left time: 1617.3489s
	iters: 200, epoch: 43 | loss: 0.0690211
	speed: 0.0662s/iter; left time: 846.3824s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:15.56s
Steps: 224 | Train Loss: 0.0688786 Vali Loss: 0.0860898 Test Loss: 0.0890831
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0646683
	speed: 0.1210s/iter; left time: 1532.4200s
	iters: 200, epoch: 44 | loss: 0.0692453
	speed: 0.0637s/iter; left time: 800.6207s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:14.53s
Steps: 224 | Train Loss: 0.0688329 Vali Loss: 0.0861044 Test Loss: 0.0890925
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0659040
	speed: 0.1264s/iter; left time: 1573.0609s
	iters: 200, epoch: 45 | loss: 0.0643121
	speed: 0.0621s/iter; left time: 766.2162s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:14.93s
Steps: 224 | Train Loss: 0.0688306 Vali Loss: 0.0860788 Test Loss: 0.0891090
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0707033
	speed: 0.1271s/iter; left time: 1553.8735s
	iters: 200, epoch: 46 | loss: 0.0666583
	speed: 0.0634s/iter; left time: 768.2570s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:14.72s
Steps: 224 | Train Loss: 0.0687669 Vali Loss: 0.0861802 Test Loss: 0.0891388
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0668203
	speed: 0.1238s/iter; left time: 1485.6883s
	iters: 200, epoch: 47 | loss: 0.0678259
	speed: 0.0630s/iter; left time: 749.3701s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:14.54s
Steps: 224 | Train Loss: 0.0687843 Vali Loss: 0.0860328 Test Loss: 0.0891000
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0671443
	speed: 0.1311s/iter; left time: 1543.8882s
	iters: 200, epoch: 48 | loss: 0.0705720
	speed: 0.0642s/iter; left time: 748.8982s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:15.70s
Steps: 224 | Train Loss: 0.0687883 Vali Loss: 0.0860063 Test Loss: 0.0891141
EarlyStopping counter: 8 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0660993
	speed: 0.1266s/iter; left time: 1461.9893s
	iters: 200, epoch: 49 | loss: 0.0729448
	speed: 0.0665s/iter; left time: 761.5672s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:15.02s
Steps: 224 | Train Loss: 0.0687500 Vali Loss: 0.0861000 Test Loss: 0.0891243
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0677664
	speed: 0.1275s/iter; left time: 1444.1350s
	iters: 200, epoch: 50 | loss: 0.0669769
	speed: 0.0697s/iter; left time: 781.9626s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:15.32s
Steps: 224 | Train Loss: 0.0687967 Vali Loss: 0.0861120 Test Loss: 0.0891771
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02123580500483513, rmse:0.1457251012325287, mae:0.08906044065952301, rse:0.514284074306488
Intermediate time for DE and pred_len 24: 00h:28m:49.86s
=== Starting experiments for pred_len: 96 ===

--- Running model for DE, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1550613
	speed: 0.0927s/iter; left time: 2067.0848s
	iters: 200, epoch: 1 | loss: 0.1477888
	speed: 0.0637s/iter; left time: 1414.5580s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:15.00s
Steps: 224 | Train Loss: 0.1587900 Vali Loss: 0.1620391 Test Loss: 0.1741875
Validation loss decreased (inf --> 0.162039).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1160155
	speed: 0.1242s/iter; left time: 2741.3462s
	iters: 200, epoch: 2 | loss: 0.1055968
	speed: 0.0738s/iter; left time: 1621.9344s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:15.90s
Steps: 224 | Train Loss: 0.1189358 Vali Loss: 0.1230573 Test Loss: 0.1298083
Validation loss decreased (0.162039 --> 0.123057).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1057696
	speed: 0.1272s/iter; left time: 2779.8019s
	iters: 200, epoch: 3 | loss: 0.1068358
	speed: 0.0645s/iter; left time: 1402.9554s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:14.85s
Steps: 224 | Train Loss: 0.1064453 Vali Loss: 0.1199574 Test Loss: 0.1270489
Validation loss decreased (0.123057 --> 0.119957).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1014582
	speed: 0.1272s/iter; left time: 2750.1429s
	iters: 200, epoch: 4 | loss: 0.0987709
	speed: 0.0642s/iter; left time: 1382.8085s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:15.20s
Steps: 224 | Train Loss: 0.1033780 Vali Loss: 0.1184104 Test Loss: 0.1268103
Validation loss decreased (0.119957 --> 0.118410).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1038326
	speed: 0.1427s/iter; left time: 3053.5747s
	iters: 200, epoch: 5 | loss: 0.0999108
	speed: 0.0631s/iter; left time: 1344.9435s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:14.87s
Steps: 224 | Train Loss: 0.1016363 Vali Loss: 0.1186604 Test Loss: 0.1271338
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0998692
	speed: 0.1217s/iter; left time: 2578.5565s
	iters: 200, epoch: 6 | loss: 0.1016956
	speed: 0.0626s/iter; left time: 1318.7493s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:14.30s
Steps: 224 | Train Loss: 0.1003976 Vali Loss: 0.1183543 Test Loss: 0.1267805
Validation loss decreased (0.118410 --> 0.118354).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0950561
	speed: 0.1268s/iter; left time: 2658.0194s
	iters: 200, epoch: 7 | loss: 0.1018301
	speed: 0.0682s/iter; left time: 1421.6701s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:15.64s
Steps: 224 | Train Loss: 0.0993858 Vali Loss: 0.1191201 Test Loss: 0.1267930
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0975684
	speed: 0.1226s/iter; left time: 2541.6046s
	iters: 200, epoch: 8 | loss: 0.0958021
	speed: 0.0648s/iter; left time: 1336.9003s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:14.67s
Steps: 224 | Train Loss: 0.0985251 Vali Loss: 0.1189736 Test Loss: 0.1276529
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0942768
	speed: 0.1228s/iter; left time: 2518.5226s
	iters: 200, epoch: 9 | loss: 0.0987583
	speed: 0.0570s/iter; left time: 1164.1372s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:14.51s
Steps: 224 | Train Loss: 0.0976029 Vali Loss: 0.1196053 Test Loss: 0.1274840
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0960662
	speed: 0.1316s/iter; left time: 2670.2964s
	iters: 200, epoch: 10 | loss: 0.0947696
	speed: 0.0641s/iter; left time: 1293.9225s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:14.74s
Steps: 224 | Train Loss: 0.0968994 Vali Loss: 0.1194730 Test Loss: 0.1282073
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0937361
	speed: 0.1235s/iter; left time: 2477.4133s
	iters: 200, epoch: 11 | loss: 0.0961174
	speed: 0.0660s/iter; left time: 1317.4915s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:14.87s
Steps: 224 | Train Loss: 0.0961025 Vali Loss: 0.1201492 Test Loss: 0.1287695
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0976077
	speed: 0.1246s/iter; left time: 2472.3915s
	iters: 200, epoch: 12 | loss: 0.0968714
	speed: 0.0650s/iter; left time: 1283.8619s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.51s
Steps: 224 | Train Loss: 0.0954843 Vali Loss: 0.1202374 Test Loss: 0.1301523
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0951096
	speed: 0.1202s/iter; left time: 2357.2966s
	iters: 200, epoch: 13 | loss: 0.0931655
	speed: 0.0644s/iter; left time: 1257.0579s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:14.64s
Steps: 224 | Train Loss: 0.0946925 Vali Loss: 0.1202413 Test Loss: 0.1300704
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0932792
	speed: 0.1225s/iter; left time: 2375.9017s
	iters: 200, epoch: 14 | loss: 0.0952017
	speed: 0.0679s/iter; left time: 1310.3449s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:14.96s
Steps: 224 | Train Loss: 0.0941036 Vali Loss: 0.1202730 Test Loss: 0.1306375
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0893586
	speed: 0.1207s/iter; left time: 2312.8706s
	iters: 200, epoch: 15 | loss: 0.0917358
	speed: 0.0660s/iter; left time: 1259.0155s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:14.64s
Steps: 224 | Train Loss: 0.0935348 Vali Loss: 0.1209930 Test Loss: 0.1316901
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0920206
	speed: 0.1269s/iter; left time: 2403.9661s
	iters: 200, epoch: 16 | loss: 0.0893951
	speed: 0.0637s/iter; left time: 1199.6952s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:14.68s
Steps: 224 | Train Loss: 0.0930603 Vali Loss: 0.1205535 Test Loss: 0.1314782
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03634786978363991, rmse:0.19065117835998535, mae:0.12678050994873047, rse:0.6751343607902527
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1646978
	speed: 0.0641s/iter; left time: 1429.7703s
	iters: 200, epoch: 1 | loss: 0.1596227
	speed: 0.0669s/iter; left time: 1484.8509s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:14.67s
Steps: 224 | Train Loss: 0.1592930 Vali Loss: 0.1618121 Test Loss: 0.1739579
Validation loss decreased (inf --> 0.161812).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1183173
	speed: 0.1220s/iter; left time: 2694.2424s
	iters: 200, epoch: 2 | loss: 0.1138795
	speed: 0.0630s/iter; left time: 1384.2941s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:14.28s
Steps: 224 | Train Loss: 0.1198862 Vali Loss: 0.1227517 Test Loss: 0.1297694
Validation loss decreased (0.161812 --> 0.122752).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1076060
	speed: 0.1350s/iter; left time: 2950.2241s
	iters: 200, epoch: 3 | loss: 0.1004281
	speed: 0.0644s/iter; left time: 1400.5902s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:15.09s
Steps: 224 | Train Loss: 0.1062988 Vali Loss: 0.1194519 Test Loss: 0.1273959
Validation loss decreased (0.122752 --> 0.119452).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1068373
	speed: 0.1353s/iter; left time: 2926.9106s
	iters: 200, epoch: 4 | loss: 0.1038922
	speed: 0.0623s/iter; left time: 1340.7820s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:14.42s
Steps: 224 | Train Loss: 0.1036002 Vali Loss: 0.1188033 Test Loss: 0.1266809
Validation loss decreased (0.119452 --> 0.118803).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0981667
	speed: 0.1393s/iter; left time: 2981.3798s
	iters: 200, epoch: 5 | loss: 0.1001305
	speed: 0.0680s/iter; left time: 1449.1319s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:15.68s
Steps: 224 | Train Loss: 0.1017561 Vali Loss: 0.1185325 Test Loss: 0.1270410
Validation loss decreased (0.118803 --> 0.118533).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1016373
	speed: 0.1241s/iter; left time: 2629.1349s
	iters: 200, epoch: 6 | loss: 0.0977255
	speed: 0.0680s/iter; left time: 1433.9526s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:15.03s
Steps: 224 | Train Loss: 0.1004691 Vali Loss: 0.1189096 Test Loss: 0.1266581
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1057052
	speed: 0.1249s/iter; left time: 2618.3944s
	iters: 200, epoch: 7 | loss: 0.0980047
	speed: 0.0654s/iter; left time: 1363.5711s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:14.97s
Steps: 224 | Train Loss: 0.0994334 Vali Loss: 0.1192198 Test Loss: 0.1271698
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0998428
	speed: 0.1361s/iter; left time: 2821.4241s
	iters: 200, epoch: 8 | loss: 0.0941586
	speed: 0.0649s/iter; left time: 1340.0215s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:14.81s
Steps: 224 | Train Loss: 0.0984135 Vali Loss: 0.1194942 Test Loss: 0.1277537
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0962894
	speed: 0.1307s/iter; left time: 2681.0142s
	iters: 200, epoch: 9 | loss: 0.0965957
	speed: 0.0647s/iter; left time: 1320.1520s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:14.86s
Steps: 224 | Train Loss: 0.0975901 Vali Loss: 0.1195832 Test Loss: 0.1275134
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0941738
	speed: 0.1230s/iter; left time: 2494.2907s
	iters: 200, epoch: 10 | loss: 0.0928220
	speed: 0.0694s/iter; left time: 1400.8307s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:15.76s
Steps: 224 | Train Loss: 0.0966882 Vali Loss: 0.1200024 Test Loss: 0.1288202
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0951017
	speed: 0.1243s/iter; left time: 2494.4116s
	iters: 200, epoch: 11 | loss: 0.0957812
	speed: 0.0683s/iter; left time: 1363.3334s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:15.00s
Steps: 224 | Train Loss: 0.0959330 Vali Loss: 0.1206276 Test Loss: 0.1287879
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0955243
	speed: 0.1281s/iter; left time: 2541.7955s
	iters: 200, epoch: 12 | loss: 0.0936859
	speed: 0.0704s/iter; left time: 1388.9048s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.65s
Steps: 224 | Train Loss: 0.0952509 Vali Loss: 0.1204279 Test Loss: 0.1292543
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0911372
	speed: 0.1371s/iter; left time: 2689.2185s
	iters: 200, epoch: 13 | loss: 0.0944463
	speed: 0.0635s/iter; left time: 1239.7751s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:15.16s
Steps: 224 | Train Loss: 0.0944741 Vali Loss: 0.1204605 Test Loss: 0.1296869
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0935038
	speed: 0.1386s/iter; left time: 2686.6480s
	iters: 200, epoch: 14 | loss: 0.0967305
	speed: 0.0632s/iter; left time: 1219.0403s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:14.48s
Steps: 224 | Train Loss: 0.0937822 Vali Loss: 0.1207107 Test Loss: 0.1295574
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0885421
	speed: 0.1439s/iter; left time: 2757.4592s
	iters: 200, epoch: 15 | loss: 0.0946899
	speed: 0.0682s/iter; left time: 1299.5462s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:15.48s
Steps: 224 | Train Loss: 0.0932084 Vali Loss: 0.1205535 Test Loss: 0.1298851
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03631800040602684, rmse:0.1905728280544281, mae:0.12704099714756012, rse:0.6748569011688232
Intermediate time for DE and pred_len 96: 00h:10m:19.48s
=== Starting experiments for pred_len: 168 ===

--- Running model for DE, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1548019
	speed: 0.0885s/iter; left time: 1963.7239s
	iters: 200, epoch: 1 | loss: 0.1487349
	speed: 0.0546s/iter; left time: 1207.4693s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:13.37s
Steps: 223 | Train Loss: 0.1608134 Vali Loss: 0.1642606 Test Loss: 0.1773646
Validation loss decreased (inf --> 0.164261).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1214235
	speed: 0.1039s/iter; left time: 2282.5374s
	iters: 200, epoch: 2 | loss: 0.1186251
	speed: 0.0604s/iter; left time: 1322.1370s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:13.63s
Steps: 223 | Train Loss: 0.1239817 Vali Loss: 0.1269845 Test Loss: 0.1359027
Validation loss decreased (0.164261 --> 0.126984).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1170573
	speed: 0.1096s/iter; left time: 2385.0655s
	iters: 200, epoch: 3 | loss: 0.1074152
	speed: 0.0581s/iter; left time: 1258.5519s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:13.30s
Steps: 223 | Train Loss: 0.1123392 Vali Loss: 0.1241037 Test Loss: 0.1344680
Validation loss decreased (0.126984 --> 0.124104).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1116649
	speed: 0.1077s/iter; left time: 2319.0279s
	iters: 200, epoch: 4 | loss: 0.1098954
	speed: 0.0614s/iter; left time: 1315.0111s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:13.55s
Steps: 223 | Train Loss: 0.1095220 Vali Loss: 0.1238564 Test Loss: 0.1336398
Validation loss decreased (0.124104 --> 0.123856).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1103088
	speed: 0.1084s/iter; left time: 2309.2080s
	iters: 200, epoch: 5 | loss: 0.1059337
	speed: 0.0601s/iter; left time: 1275.6416s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:13.62s
Steps: 223 | Train Loss: 0.1077120 Vali Loss: 0.1238542 Test Loss: 0.1340634
Validation loss decreased (0.123856 --> 0.123854).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1093670
	speed: 0.1155s/iter; left time: 2434.6916s
	iters: 200, epoch: 6 | loss: 0.1044136
	speed: 0.0619s/iter; left time: 1299.8243s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:13.85s
Steps: 223 | Train Loss: 0.1062742 Vali Loss: 0.1234706 Test Loss: 0.1347027
Validation loss decreased (0.123854 --> 0.123471).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1005224
	speed: 0.1090s/iter; left time: 2273.5851s
	iters: 200, epoch: 7 | loss: 0.1047263
	speed: 0.0571s/iter; left time: 1185.8803s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.92s
Steps: 223 | Train Loss: 0.1051898 Vali Loss: 0.1239938 Test Loss: 0.1345310
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1043732
	speed: 0.1013s/iter; left time: 2091.7110s
	iters: 200, epoch: 8 | loss: 0.1046246
	speed: 0.0549s/iter; left time: 1128.1784s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.74s
Steps: 223 | Train Loss: 0.1041525 Vali Loss: 0.1243894 Test Loss: 0.1351599
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1036047
	speed: 0.0972s/iter; left time: 1984.3051s
	iters: 200, epoch: 9 | loss: 0.1000770
	speed: 0.0535s/iter; left time: 1086.8363s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.21s
Steps: 223 | Train Loss: 0.1031845 Vali Loss: 0.1245980 Test Loss: 0.1351988
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0945465
	speed: 0.0962s/iter; left time: 1942.2344s
	iters: 200, epoch: 10 | loss: 0.1016872
	speed: 0.0555s/iter; left time: 1115.0494s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.38s
Steps: 223 | Train Loss: 0.1024096 Vali Loss: 0.1248682 Test Loss: 0.1363112
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1013406
	speed: 0.0979s/iter; left time: 1955.9067s
	iters: 200, epoch: 11 | loss: 0.1035435
	speed: 0.0537s/iter; left time: 1067.5552s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.20s
Steps: 223 | Train Loss: 0.1016130 Vali Loss: 0.1255188 Test Loss: 0.1362312
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0993369
	speed: 0.0959s/iter; left time: 1894.2588s
	iters: 200, epoch: 12 | loss: 0.1056814
	speed: 0.0535s/iter; left time: 1051.5623s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.14s
Steps: 223 | Train Loss: 0.1009609 Vali Loss: 0.1256741 Test Loss: 0.1363840
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1032659
	speed: 0.0964s/iter; left time: 1881.4402s
	iters: 200, epoch: 13 | loss: 0.0941548
	speed: 0.0533s/iter; left time: 1035.6132s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.13s
Steps: 223 | Train Loss: 0.1002403 Vali Loss: 0.1265315 Test Loss: 0.1380129
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0971907
	speed: 0.0953s/iter; left time: 1840.0929s
	iters: 200, epoch: 14 | loss: 0.1011847
	speed: 0.0533s/iter; left time: 1023.1713s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.08s
Steps: 223 | Train Loss: 0.0995397 Vali Loss: 0.1270013 Test Loss: 0.1374407
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0925344
	speed: 0.0943s/iter; left time: 1798.3851s
	iters: 200, epoch: 15 | loss: 0.0943704
	speed: 0.0532s/iter; left time: 1009.4163s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:12.06s
Steps: 223 | Train Loss: 0.0989645 Vali Loss: 0.1275917 Test Loss: 0.1384556
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0975892
	speed: 0.0950s/iter; left time: 1792.1456s
	iters: 200, epoch: 16 | loss: 0.0999596
	speed: 0.0532s/iter; left time: 997.6198s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:12.11s
Steps: 223 | Train Loss: 0.0984323 Vali Loss: 0.1276390 Test Loss: 0.1387271
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03956723213195801, rmse:0.19891513884067535, mae:0.13470256328582764, rse:0.7045734524726868
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1586475
	speed: 0.0549s/iter; left time: 1218.9030s
	iters: 200, epoch: 1 | loss: 0.1522224
	speed: 0.0532s/iter; left time: 1176.7078s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:12.09s
Steps: 223 | Train Loss: 0.1616155 Vali Loss: 0.1641567 Test Loss: 0.1773076
Validation loss decreased (inf --> 0.164157).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1187496
	speed: 0.1064s/iter; left time: 2338.9623s
	iters: 200, epoch: 2 | loss: 0.1157281
	speed: 0.0533s/iter; left time: 1166.9164s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.13s
Steps: 223 | Train Loss: 0.1241101 Vali Loss: 0.1277330 Test Loss: 0.1362454
Validation loss decreased (0.164157 --> 0.127733).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1088427
	speed: 0.0992s/iter; left time: 2158.0220s
	iters: 200, epoch: 3 | loss: 0.1101429
	speed: 0.0533s/iter; left time: 1154.7108s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.13s
Steps: 223 | Train Loss: 0.1123035 Vali Loss: 0.1245199 Test Loss: 0.1350362
Validation loss decreased (0.127733 --> 0.124520).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1039694
	speed: 0.0974s/iter; left time: 2097.0559s
	iters: 200, epoch: 4 | loss: 0.1144476
	speed: 0.0532s/iter; left time: 1140.7232s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:12.08s
Steps: 223 | Train Loss: 0.1094969 Vali Loss: 0.1235680 Test Loss: 0.1340981
Validation loss decreased (0.124520 --> 0.123568).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1059165
	speed: 0.0975s/iter; left time: 2077.6615s
	iters: 200, epoch: 5 | loss: 0.1059672
	speed: 0.0532s/iter; left time: 1129.3562s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.12s
Steps: 223 | Train Loss: 0.1077130 Vali Loss: 0.1228737 Test Loss: 0.1347752
Validation loss decreased (0.123568 --> 0.122874).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1075763
	speed: 0.0986s/iter; left time: 2078.2449s
	iters: 200, epoch: 6 | loss: 0.1046234
	speed: 0.0533s/iter; left time: 1118.1532s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.09s
Steps: 223 | Train Loss: 0.1062918 Vali Loss: 0.1232371 Test Loss: 0.1351631
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1086531
	speed: 0.0960s/iter; left time: 2003.7094s
	iters: 200, epoch: 7 | loss: 0.1062272
	speed: 0.0532s/iter; left time: 1104.1128s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.06s
Steps: 223 | Train Loss: 0.1050808 Vali Loss: 0.1232536 Test Loss: 0.1345480
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1097154
	speed: 0.0969s/iter; left time: 2000.8928s
	iters: 200, epoch: 8 | loss: 0.1039724
	speed: 0.0532s/iter; left time: 1091.9763s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.08s
Steps: 223 | Train Loss: 0.1040496 Vali Loss: 0.1236265 Test Loss: 0.1358001
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1069149
	speed: 0.0966s/iter; left time: 1971.3761s
	iters: 200, epoch: 9 | loss: 0.1070597
	speed: 0.0533s/iter; left time: 1083.0819s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.12s
Steps: 223 | Train Loss: 0.1030779 Vali Loss: 0.1237163 Test Loss: 0.1358926
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1037227
	speed: 0.0962s/iter; left time: 1942.7337s
	iters: 200, epoch: 10 | loss: 0.1070804
	speed: 0.0532s/iter; left time: 1068.8481s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.09s
Steps: 223 | Train Loss: 0.1020539 Vali Loss: 0.1243779 Test Loss: 0.1360747
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0994673
	speed: 0.0966s/iter; left time: 1929.8477s
	iters: 200, epoch: 11 | loss: 0.0967816
	speed: 0.0531s/iter; left time: 1055.9280s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.10s
Steps: 223 | Train Loss: 0.1011504 Vali Loss: 0.1246540 Test Loss: 0.1372310
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1035772
	speed: 0.0970s/iter; left time: 1916.4164s
	iters: 200, epoch: 12 | loss: 0.1003781
	speed: 0.0530s/iter; left time: 1041.2426s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.09s
Steps: 223 | Train Loss: 0.1002424 Vali Loss: 0.1252042 Test Loss: 0.1371934
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1011443
	speed: 0.0960s/iter; left time: 1874.5248s
	iters: 200, epoch: 13 | loss: 0.0993868
	speed: 0.0531s/iter; left time: 1032.2990s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.11s
Steps: 223 | Train Loss: 0.0994014 Vali Loss: 0.1259811 Test Loss: 0.1378808
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0967515
	speed: 0.0956s/iter; left time: 1845.2392s
	iters: 200, epoch: 14 | loss: 0.0992444
	speed: 0.0530s/iter; left time: 1018.3774s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.08s
Steps: 223 | Train Loss: 0.0987232 Vali Loss: 0.1261198 Test Loss: 0.1377028
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0974795
	speed: 0.0957s/iter; left time: 1824.9962s
	iters: 200, epoch: 15 | loss: 0.0960967
	speed: 0.0532s/iter; left time: 1009.6834s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:12.08s
Steps: 223 | Train Loss: 0.0980965 Vali Loss: 0.1264970 Test Loss: 0.1387069
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.039511777460575104, rmse:0.19877569377422333, mae:0.13477523624897003, rse:0.7040795087814331
Intermediate time for DE and pred_len 168: 00h:08m:14.84sIntermediate time for DE: 00h:47m:24.17s
=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1337681
	speed: 0.0772s/iter; left time: 1721.4568s
	iters: 200, epoch: 1 | loss: 0.1301103
	speed: 0.0521s/iter; left time: 1155.9863s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:12.21s
Steps: 224 | Train Loss: 0.1369913 Vali Loss: 0.1359314 Test Loss: 0.1558871
Validation loss decreased (inf --> 0.135931).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0913649
	speed: 0.0945s/iter; left time: 2087.3596s
	iters: 200, epoch: 2 | loss: 0.0844155
	speed: 0.0524s/iter; left time: 1150.6662s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:11.94s
Steps: 224 | Train Loss: 0.0923259 Vali Loss: 0.0929204 Test Loss: 0.1050857
Validation loss decreased (0.135931 --> 0.092920).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0808693
	speed: 0.0952s/iter; left time: 2080.9624s
	iters: 200, epoch: 3 | loss: 0.0861732
	speed: 0.0523s/iter; left time: 1136.8411s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:11.94s
Steps: 224 | Train Loss: 0.0791791 Vali Loss: 0.0913382 Test Loss: 0.1042468
Validation loss decreased (0.092920 --> 0.091338).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0733298
	speed: 0.0966s/iter; left time: 2089.7803s
	iters: 200, epoch: 4 | loss: 0.0772558
	speed: 0.0524s/iter; left time: 1128.5724s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:11.97s
Steps: 224 | Train Loss: 0.0773386 Vali Loss: 0.0909781 Test Loss: 0.1037574
Validation loss decreased (0.091338 --> 0.090978).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0725079
	speed: 0.0944s/iter; left time: 2021.6394s
	iters: 200, epoch: 5 | loss: 0.0707540
	speed: 0.0523s/iter; left time: 1113.9711s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:11.93s
Steps: 224 | Train Loss: 0.0761784 Vali Loss: 0.0895637 Test Loss: 0.1028150
Validation loss decreased (0.090978 --> 0.089564).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0770092
	speed: 0.0953s/iter; left time: 2018.1352s
	iters: 200, epoch: 6 | loss: 0.0714131
	speed: 0.0524s/iter; left time: 1105.5169s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:11.94s
Steps: 224 | Train Loss: 0.0753703 Vali Loss: 0.0893661 Test Loss: 0.1025691
Validation loss decreased (0.089564 --> 0.089366).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0798632
	speed: 0.0984s/iter; left time: 2061.6240s
	iters: 200, epoch: 7 | loss: 0.0708998
	speed: 0.0522s/iter; left time: 1089.3604s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:11.93s
Steps: 224 | Train Loss: 0.0748158 Vali Loss: 0.0894289 Test Loss: 0.1025083
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0749726
	speed: 0.0936s/iter; left time: 1940.1901s
	iters: 200, epoch: 8 | loss: 0.0733200
	speed: 0.0523s/iter; left time: 1078.8051s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:11.96s
Steps: 224 | Train Loss: 0.0743430 Vali Loss: 0.0890287 Test Loss: 0.1023971
Validation loss decreased (0.089366 --> 0.089029).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0791299
	speed: 0.0941s/iter; left time: 1930.5205s
	iters: 200, epoch: 9 | loss: 0.0748995
	speed: 0.0523s/iter; left time: 1067.4508s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:11.94s
Steps: 224 | Train Loss: 0.0738968 Vali Loss: 0.0888048 Test Loss: 0.1026755
Validation loss decreased (0.089029 --> 0.088805).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0725861
	speed: 0.0945s/iter; left time: 1916.4283s
	iters: 200, epoch: 10 | loss: 0.0756589
	speed: 0.0524s/iter; left time: 1056.8750s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:11.96s
Steps: 224 | Train Loss: 0.0735116 Vali Loss: 0.0885439 Test Loss: 0.1022316
Validation loss decreased (0.088805 --> 0.088544).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0702687
	speed: 0.0943s/iter; left time: 1890.8247s
	iters: 200, epoch: 11 | loss: 0.0753673
	speed: 0.0525s/iter; left time: 1048.1375s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:11.95s
Steps: 224 | Train Loss: 0.0731713 Vali Loss: 0.0884424 Test Loss: 0.1024115
Validation loss decreased (0.088544 --> 0.088442).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0696664
	speed: 0.0934s/iter; left time: 1853.0548s
	iters: 200, epoch: 12 | loss: 0.0712836
	speed: 0.0525s/iter; left time: 1035.3221s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:11.94s
Steps: 224 | Train Loss: 0.0729458 Vali Loss: 0.0885137 Test Loss: 0.1023535
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0772517
	speed: 0.0933s/iter; left time: 1830.2605s
	iters: 200, epoch: 13 | loss: 0.0727321
	speed: 0.0523s/iter; left time: 1020.3740s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:11.93s
Steps: 224 | Train Loss: 0.0727253 Vali Loss: 0.0882543 Test Loss: 0.1018357
Validation loss decreased (0.088442 --> 0.088254).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0730511
	speed: 0.0940s/iter; left time: 1822.8780s
	iters: 200, epoch: 14 | loss: 0.0743207
	speed: 0.0521s/iter; left time: 1005.4792s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:11.90s
Steps: 224 | Train Loss: 0.0724939 Vali Loss: 0.0883527 Test Loss: 0.1019900
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0745256
	speed: 0.0933s/iter; left time: 1787.9579s
	iters: 200, epoch: 15 | loss: 0.0704399
	speed: 0.0523s/iter; left time: 997.3905s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:11.93s
Steps: 224 | Train Loss: 0.0722996 Vali Loss: 0.0880289 Test Loss: 0.1020303
Validation loss decreased (0.088254 --> 0.088029).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0770125
	speed: 0.0940s/iter; left time: 1780.8996s
	iters: 200, epoch: 16 | loss: 0.0694815
	speed: 0.0521s/iter; left time: 982.0702s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:11.89s
Steps: 224 | Train Loss: 0.0721522 Vali Loss: 0.0880209 Test Loss: 0.1023730
Validation loss decreased (0.088029 --> 0.088021).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0658797
	speed: 0.0931s/iter; left time: 1742.2440s
	iters: 200, epoch: 17 | loss: 0.0695038
	speed: 0.0523s/iter; left time: 973.5301s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:11.94s
Steps: 224 | Train Loss: 0.0719564 Vali Loss: 0.0880820 Test Loss: 0.1024347
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0731994
	speed: 0.0932s/iter; left time: 1723.4834s
	iters: 200, epoch: 18 | loss: 0.0695477
	speed: 0.0524s/iter; left time: 963.7179s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:11.93s
Steps: 224 | Train Loss: 0.0718094 Vali Loss: 0.0881291 Test Loss: 0.1022878
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0677946
	speed: 0.0927s/iter; left time: 1693.1766s
	iters: 200, epoch: 19 | loss: 0.0691350
	speed: 0.0523s/iter; left time: 950.6167s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:11.91s
Steps: 224 | Train Loss: 0.0717229 Vali Loss: 0.0878378 Test Loss: 0.1025048
Validation loss decreased (0.088021 --> 0.087838).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0751754
	speed: 0.0938s/iter; left time: 1692.2204s
	iters: 200, epoch: 20 | loss: 0.0717342
	speed: 0.0525s/iter; left time: 942.8454s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:11.93s
Steps: 224 | Train Loss: 0.0715432 Vali Loss: 0.0879541 Test Loss: 0.1023896
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0683073
	speed: 0.0922s/iter; left time: 1643.4609s
	iters: 200, epoch: 21 | loss: 0.0753092
	speed: 0.0525s/iter; left time: 929.9080s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:11.92s
Steps: 224 | Train Loss: 0.0714210 Vali Loss: 0.0878884 Test Loss: 0.1025704
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0739669
	speed: 0.0934s/iter; left time: 1642.8751s
	iters: 200, epoch: 22 | loss: 0.0735120
	speed: 0.0524s/iter; left time: 917.1106s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:11.92s
Steps: 224 | Train Loss: 0.0713990 Vali Loss: 0.0879366 Test Loss: 0.1023931
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0725404
	speed: 0.0928s/iter; left time: 1611.5688s
	iters: 200, epoch: 23 | loss: 0.0742865
	speed: 0.0523s/iter; left time: 903.6880s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:11.91s
Steps: 224 | Train Loss: 0.0712040 Vali Loss: 0.0877694 Test Loss: 0.1021546
Validation loss decreased (0.087838 --> 0.087769).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0733356
	speed: 0.0931s/iter; left time: 1596.4130s
	iters: 200, epoch: 24 | loss: 0.0658376
	speed: 0.0522s/iter; left time: 890.6319s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:11.89s
Steps: 224 | Train Loss: 0.0712310 Vali Loss: 0.0878737 Test Loss: 0.1022747
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0756377
	speed: 0.0932s/iter; left time: 1578.1782s
	iters: 200, epoch: 25 | loss: 0.0714636
	speed: 0.0524s/iter; left time: 880.9829s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:11.92s
Steps: 224 | Train Loss: 0.0711283 Vali Loss: 0.0876985 Test Loss: 0.1023861
Validation loss decreased (0.087769 --> 0.087698).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0730481
	speed: 0.0943s/iter; left time: 1575.0464s
	iters: 200, epoch: 26 | loss: 0.0673774
	speed: 0.0525s/iter; left time: 870.7927s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:11.96s
Steps: 224 | Train Loss: 0.0710204 Vali Loss: 0.0878645 Test Loss: 0.1025371
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0692971
	speed: 0.0931s/iter; left time: 1533.2364s
	iters: 200, epoch: 27 | loss: 0.0748941
	speed: 0.0523s/iter; left time: 855.8746s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:11.93s
Steps: 224 | Train Loss: 0.0709922 Vali Loss: 0.0878092 Test Loss: 0.1024434
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0731720
	speed: 0.0933s/iter; left time: 1515.9991s
	iters: 200, epoch: 28 | loss: 0.0709607
	speed: 0.0523s/iter; left time: 845.3432s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:11.94s
Steps: 224 | Train Loss: 0.0709522 Vali Loss: 0.0876303 Test Loss: 0.1024348
Validation loss decreased (0.087698 --> 0.087630).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0729126
	speed: 0.0942s/iter; left time: 1509.2603s
	iters: 200, epoch: 29 | loss: 0.0757939
	speed: 0.0523s/iter; left time: 832.6521s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:11.91s
Steps: 224 | Train Loss: 0.0709114 Vali Loss: 0.0877213 Test Loss: 0.1024486
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0686514
	speed: 0.0939s/iter; left time: 1484.8003s
	iters: 200, epoch: 30 | loss: 0.0682729
	speed: 0.0525s/iter; left time: 823.7680s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:11.95s
Steps: 224 | Train Loss: 0.0708208 Vali Loss: 0.0877651 Test Loss: 0.1023511
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0680746
	speed: 0.0933s/iter; left time: 1454.2431s
	iters: 200, epoch: 31 | loss: 0.0703695
	speed: 0.0524s/iter; left time: 810.6841s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:11.96s
Steps: 224 | Train Loss: 0.0707644 Vali Loss: 0.0875608 Test Loss: 0.1024484
Validation loss decreased (0.087630 --> 0.087561).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0712823
	speed: 0.0939s/iter; left time: 1441.3324s
	iters: 200, epoch: 32 | loss: 0.0645696
	speed: 0.0523s/iter; left time: 797.6492s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:11.94s
Steps: 224 | Train Loss: 0.0707321 Vali Loss: 0.0877208 Test Loss: 0.1026194
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0686052
	speed: 0.0934s/iter; left time: 1413.3648s
	iters: 200, epoch: 33 | loss: 0.0751981
	speed: 0.0524s/iter; left time: 788.3904s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:11.96s
Steps: 224 | Train Loss: 0.0707160 Vali Loss: 0.0876859 Test Loss: 0.1025198
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0700265
	speed: 0.0931s/iter; left time: 1388.3844s
	iters: 200, epoch: 34 | loss: 0.0709091
	speed: 0.0522s/iter; left time: 773.2178s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:11.91s
Steps: 224 | Train Loss: 0.0706691 Vali Loss: 0.0876336 Test Loss: 0.1025292
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0714695
	speed: 0.0929s/iter; left time: 1364.3497s
	iters: 200, epoch: 35 | loss: 0.0675804
	speed: 0.0523s/iter; left time: 762.1868s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:11.91s
Steps: 224 | Train Loss: 0.0706608 Vali Loss: 0.0876634 Test Loss: 0.1025143
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0716697
	speed: 0.0931s/iter; left time: 1346.7562s
	iters: 200, epoch: 36 | loss: 0.0745230
	speed: 0.0524s/iter; left time: 752.7126s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:11.94s
Steps: 224 | Train Loss: 0.0706338 Vali Loss: 0.0876844 Test Loss: 0.1025104
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0692014
	speed: 0.0938s/iter; left time: 1335.3094s
	iters: 200, epoch: 37 | loss: 0.0667195
	speed: 0.0523s/iter; left time: 739.4948s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:11.97s
Steps: 224 | Train Loss: 0.0706335 Vali Loss: 0.0875388 Test Loss: 0.1025336
Validation loss decreased (0.087561 --> 0.087539).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0696882
	speed: 0.0945s/iter; left time: 1324.8033s
	iters: 200, epoch: 38 | loss: 0.0767173
	speed: 0.0520s/iter; left time: 722.7913s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:11.91s
Steps: 224 | Train Loss: 0.0705597 Vali Loss: 0.0876549 Test Loss: 0.1025695
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0688473
	speed: 0.0937s/iter; left time: 1292.6102s
	iters: 200, epoch: 39 | loss: 0.0736877
	speed: 0.0525s/iter; left time: 718.7778s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:11.98s
Steps: 224 | Train Loss: 0.0705348 Vali Loss: 0.0877679 Test Loss: 0.1025379
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0706787
	speed: 0.0929s/iter; left time: 1260.7052s
	iters: 200, epoch: 40 | loss: 0.0669279
	speed: 0.0523s/iter; left time: 703.9471s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:11.93s
Steps: 224 | Train Loss: 0.0705901 Vali Loss: 0.0876181 Test Loss: 0.1025662
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0689001
	speed: 0.0939s/iter; left time: 1252.2301s
	iters: 200, epoch: 41 | loss: 0.0677012
	speed: 0.0523s/iter; left time: 692.0248s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:11.95s
Steps: 224 | Train Loss: 0.0705525 Vali Loss: 0.0876695 Test Loss: 0.1025416
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0700784
	speed: 0.0929s/iter; left time: 1218.8393s
	iters: 200, epoch: 42 | loss: 0.0700355
	speed: 0.0520s/iter; left time: 677.4660s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:11.85s
Steps: 224 | Train Loss: 0.0705240 Vali Loss: 0.0876143 Test Loss: 0.1026173
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0726577
	speed: 0.0930s/iter; left time: 1198.8184s
	iters: 200, epoch: 43 | loss: 0.0706721
	speed: 0.0522s/iter; left time: 668.3542s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:11.92s
Steps: 224 | Train Loss: 0.0705564 Vali Loss: 0.0876295 Test Loss: 0.1025662
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0696796
	speed: 0.0926s/iter; left time: 1173.7211s
	iters: 200, epoch: 44 | loss: 0.0707281
	speed: 0.0522s/iter; left time: 656.5054s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:11.89s
Steps: 224 | Train Loss: 0.0704933 Vali Loss: 0.0876881 Test Loss: 0.1025814
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0757044
	speed: 0.0932s/iter; left time: 1160.3548s
	iters: 200, epoch: 45 | loss: 0.0726157
	speed: 0.0523s/iter; left time: 645.8571s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:11.95s
Steps: 224 | Train Loss: 0.0705575 Vali Loss: 0.0874810 Test Loss: 0.1025429
Validation loss decreased (0.087539 --> 0.087481).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0742189
	speed: 0.0941s/iter; left time: 1149.8477s
	iters: 200, epoch: 46 | loss: 0.0736142
	speed: 0.0523s/iter; left time: 633.9717s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:11.92s
Steps: 224 | Train Loss: 0.0705232 Vali Loss: 0.0875848 Test Loss: 0.1025821
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0672498
	speed: 0.0926s/iter; left time: 1110.7055s
	iters: 200, epoch: 47 | loss: 0.0682913
	speed: 0.0522s/iter; left time: 621.4756s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:11.92s
Steps: 224 | Train Loss: 0.0704723 Vali Loss: 0.0876123 Test Loss: 0.1025846
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0696902
	speed: 0.0927s/iter; left time: 1091.8042s
	iters: 200, epoch: 48 | loss: 0.0676515
	speed: 0.0522s/iter; left time: 608.9455s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:11.88s
Steps: 224 | Train Loss: 0.0705277 Vali Loss: 0.0876810 Test Loss: 0.1025829
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0700386
	speed: 0.0924s/iter; left time: 1067.2475s
	iters: 200, epoch: 49 | loss: 0.0666300
	speed: 0.0523s/iter; left time: 598.6801s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:11.88s
Steps: 224 | Train Loss: 0.0704845 Vali Loss: 0.0876203 Test Loss: 0.1025853
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0734844
	speed: 0.0924s/iter; left time: 1046.8790s
	iters: 200, epoch: 50 | loss: 0.0679541
	speed: 0.0522s/iter; left time: 585.5599s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:11.88s
Steps: 224 | Train Loss: 0.0704916 Vali Loss: 0.0877179 Test Loss: 0.1025884
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0736447
	speed: 0.0937s/iter; left time: 1039.9746s
	iters: 200, epoch: 51 | loss: 0.0654428
	speed: 0.0522s/iter; left time: 574.6351s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:11.95s
Steps: 224 | Train Loss: 0.0705029 Vali Loss: 0.0875974 Test Loss: 0.1025916
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0700766
	speed: 0.0926s/iter; left time: 1007.6814s
	iters: 200, epoch: 52 | loss: 0.0760974
	speed: 0.0522s/iter; left time: 562.2034s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:11.87s
Steps: 224 | Train Loss: 0.0704561 Vali Loss: 0.0875556 Test Loss: 0.1025784
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0712552
	speed: 0.0926s/iter; left time: 985.9431s
	iters: 200, epoch: 53 | loss: 0.0681484
	speed: 0.0523s/iter; left time: 551.6700s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:11.92s
Steps: 224 | Train Loss: 0.0704864 Vali Loss: 0.0875903 Test Loss: 0.1026226
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0698976
	speed: 0.0922s/iter; left time: 961.8901s
	iters: 200, epoch: 54 | loss: 0.0694280
	speed: 0.0522s/iter; left time: 539.0669s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:11.88s
Steps: 224 | Train Loss: 0.0705067 Vali Loss: 0.0876638 Test Loss: 0.1025732
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0714906
	speed: 0.0925s/iter; left time: 944.1057s
	iters: 200, epoch: 55 | loss: 0.0664937
	speed: 0.0523s/iter; left time: 528.0955s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:11.90s
Steps: 224 | Train Loss: 0.0704601 Vali Loss: 0.0876570 Test Loss: 0.1026139
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.026038529351353645, rmse:0.1613645851612091, mae:0.10254285484552383, rse:0.5566620826721191
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1340888
	speed: 0.0543s/iter; left time: 1209.8383s
	iters: 200, epoch: 1 | loss: 0.1284338
	speed: 0.0525s/iter; left time: 1165.6667s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:11.99s
Steps: 224 | Train Loss: 0.1371192 Vali Loss: 0.1359184 Test Loss: 0.1564447
Validation loss decreased (inf --> 0.135918).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0986784
	speed: 0.0945s/iter; left time: 2086.9999s
	iters: 200, epoch: 2 | loss: 0.0827210
	speed: 0.0526s/iter; left time: 1156.4095s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.01s
Steps: 224 | Train Loss: 0.0929912 Vali Loss: 0.0933088 Test Loss: 0.1047612
Validation loss decreased (0.135918 --> 0.093309).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0803287
	speed: 0.0945s/iter; left time: 2064.1116s
	iters: 200, epoch: 3 | loss: 0.0777847
	speed: 0.0524s/iter; left time: 1139.5728s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:11.98s
Steps: 224 | Train Loss: 0.0793267 Vali Loss: 0.0914609 Test Loss: 0.1030556
Validation loss decreased (0.093309 --> 0.091461).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0806357
	speed: 0.0942s/iter; left time: 2037.6861s
	iters: 200, epoch: 4 | loss: 0.0757164
	speed: 0.0523s/iter; left time: 1126.1738s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:11.96s
Steps: 224 | Train Loss: 0.0774351 Vali Loss: 0.0906578 Test Loss: 0.1030808
Validation loss decreased (0.091461 --> 0.090658).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0742374
	speed: 0.0943s/iter; left time: 2018.3902s
	iters: 200, epoch: 5 | loss: 0.0708531
	speed: 0.0523s/iter; left time: 1115.0898s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:11.95s
Steps: 224 | Train Loss: 0.0764426 Vali Loss: 0.0899601 Test Loss: 0.1026692
Validation loss decreased (0.090658 --> 0.089960).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0776469
	speed: 0.0947s/iter; left time: 2006.8819s
	iters: 200, epoch: 6 | loss: 0.0802776
	speed: 0.0526s/iter; left time: 1109.2554s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.01s
Steps: 224 | Train Loss: 0.0755150 Vali Loss: 0.0892671 Test Loss: 0.1024971
Validation loss decreased (0.089960 --> 0.089267).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0744159
	speed: 0.0942s/iter; left time: 1973.8478s
	iters: 200, epoch: 7 | loss: 0.0703802
	speed: 0.0525s/iter; left time: 1094.3854s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:11.96s
Steps: 224 | Train Loss: 0.0749787 Vali Loss: 0.0892036 Test Loss: 0.1022584
Validation loss decreased (0.089267 --> 0.089204).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0728884
	speed: 0.0941s/iter; left time: 1951.0242s
	iters: 200, epoch: 8 | loss: 0.0763242
	speed: 0.0524s/iter; left time: 1080.9020s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:11.96s
Steps: 224 | Train Loss: 0.0744411 Vali Loss: 0.0888207 Test Loss: 0.1025281
Validation loss decreased (0.089204 --> 0.088821).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0749100
	speed: 0.0940s/iter; left time: 1928.1962s
	iters: 200, epoch: 9 | loss: 0.0729593
	speed: 0.0524s/iter; left time: 1069.6898s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:11.96s
Steps: 224 | Train Loss: 0.0740723 Vali Loss: 0.0889069 Test Loss: 0.1022433
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0736462
	speed: 0.0939s/iter; left time: 1904.0869s
	iters: 200, epoch: 10 | loss: 0.0683928
	speed: 0.0525s/iter; left time: 1060.2319s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.00s
Steps: 224 | Train Loss: 0.0736698 Vali Loss: 0.0882708 Test Loss: 0.1022037
Validation loss decreased (0.088821 --> 0.088271).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0685093
	speed: 0.0941s/iter; left time: 1887.1174s
	iters: 200, epoch: 11 | loss: 0.0748501
	speed: 0.0521s/iter; left time: 1039.0196s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:11.89s
Steps: 224 | Train Loss: 0.0733367 Vali Loss: 0.0885927 Test Loss: 0.1025729
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0694412
	speed: 0.0941s/iter; left time: 1866.7245s
	iters: 200, epoch: 12 | loss: 0.0729200
	speed: 0.0525s/iter; left time: 1035.2776s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.01s
Steps: 224 | Train Loss: 0.0730160 Vali Loss: 0.0883027 Test Loss: 0.1023279
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0722981
	speed: 0.0943s/iter; left time: 1849.0667s
	iters: 200, epoch: 13 | loss: 0.0708375
	speed: 0.0525s/iter; left time: 1023.7575s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.01s
Steps: 224 | Train Loss: 0.0727724 Vali Loss: 0.0881370 Test Loss: 0.1023577
Validation loss decreased (0.088271 --> 0.088137).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0679360
	speed: 0.0949s/iter; left time: 1839.3175s
	iters: 200, epoch: 14 | loss: 0.0720937
	speed: 0.0524s/iter; left time: 1010.5496s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:11.99s
Steps: 224 | Train Loss: 0.0726295 Vali Loss: 0.0878316 Test Loss: 0.1023786
Validation loss decreased (0.088137 --> 0.087832).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0757486
	speed: 0.0949s/iter; left time: 1819.5625s
	iters: 200, epoch: 15 | loss: 0.0714281
	speed: 0.0524s/iter; left time: 998.1405s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:11.96s
Steps: 224 | Train Loss: 0.0723702 Vali Loss: 0.0882032 Test Loss: 0.1025239
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0744029
	speed: 0.0937s/iter; left time: 1775.1121s
	iters: 200, epoch: 16 | loss: 0.0732896
	speed: 0.0524s/iter; left time: 987.9542s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:11.97s
Steps: 224 | Train Loss: 0.0722303 Vali Loss: 0.0879967 Test Loss: 0.1022053
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0708814
	speed: 0.0935s/iter; left time: 1749.8102s
	iters: 200, epoch: 17 | loss: 0.0643175
	speed: 0.0525s/iter; left time: 978.0579s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:11.98s
Steps: 224 | Train Loss: 0.0720519 Vali Loss: 0.0878360 Test Loss: 0.1024031
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0691474
	speed: 0.0938s/iter; left time: 1735.2624s
	iters: 200, epoch: 18 | loss: 0.0731347
	speed: 0.0523s/iter; left time: 962.3495s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:11.95s
Steps: 224 | Train Loss: 0.0717889 Vali Loss: 0.0880502 Test Loss: 0.1021411
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0713383
	speed: 0.0936s/iter; left time: 1709.7715s
	iters: 200, epoch: 19 | loss: 0.0802521
	speed: 0.0524s/iter; left time: 951.1599s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:11.94s
Steps: 224 | Train Loss: 0.0717140 Vali Loss: 0.0880324 Test Loss: 0.1025808
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0718002
	speed: 0.0938s/iter; left time: 1693.0729s
	iters: 200, epoch: 20 | loss: 0.0694699
	speed: 0.0524s/iter; left time: 941.2006s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:12.00s
Steps: 224 | Train Loss: 0.0716252 Vali Loss: 0.0878140 Test Loss: 0.1023368
Validation loss decreased (0.087832 --> 0.087814).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0732282
	speed: 0.0950s/iter; left time: 1693.3363s
	iters: 200, epoch: 21 | loss: 0.0687660
	speed: 0.0521s/iter; left time: 924.0883s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:11.94s
Steps: 224 | Train Loss: 0.0715591 Vali Loss: 0.0878166 Test Loss: 0.1024134
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0704203
	speed: 0.0938s/iter; left time: 1649.8494s
	iters: 200, epoch: 22 | loss: 0.0698574
	speed: 0.0524s/iter; left time: 917.4953s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:11.98s
Steps: 224 | Train Loss: 0.0714010 Vali Loss: 0.0878006 Test Loss: 0.1022703
Validation loss decreased (0.087814 --> 0.087801).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0693955
	speed: 0.0957s/iter; left time: 1662.1524s
	iters: 200, epoch: 23 | loss: 0.0668513
	speed: 0.0523s/iter; left time: 904.1905s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:11.98s
Steps: 224 | Train Loss: 0.0713579 Vali Loss: 0.0878292 Test Loss: 0.1025530
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0714743
	speed: 0.0943s/iter; left time: 1617.4032s
	iters: 200, epoch: 24 | loss: 0.0696637
	speed: 0.0525s/iter; left time: 894.6946s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:12.02s
Steps: 224 | Train Loss: 0.0712420 Vali Loss: 0.0878795 Test Loss: 0.1024655
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0674481
	speed: 0.0945s/iter; left time: 1598.9433s
	iters: 200, epoch: 25 | loss: 0.0701551
	speed: 0.0523s/iter; left time: 880.2719s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:12.02s
Steps: 224 | Train Loss: 0.0711827 Vali Loss: 0.0878567 Test Loss: 0.1025342
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0699493
	speed: 0.0951s/iter; left time: 1587.6389s
	iters: 200, epoch: 26 | loss: 0.0704517
	speed: 0.0523s/iter; left time: 868.8810s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:12.06s
Steps: 224 | Train Loss: 0.0711286 Vali Loss: 0.0878145 Test Loss: 0.1025468
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0690658
	speed: 0.0947s/iter; left time: 1560.5824s
	iters: 200, epoch: 27 | loss: 0.0724766
	speed: 0.0524s/iter; left time: 858.8684s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:12.03s
Steps: 224 | Train Loss: 0.0710852 Vali Loss: 0.0877976 Test Loss: 0.1023908
Validation loss decreased (0.087801 --> 0.087798).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0726968
	speed: 0.0951s/iter; left time: 1545.3238s
	iters: 200, epoch: 28 | loss: 0.0673573
	speed: 0.0525s/iter; left time: 847.6995s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:11.96s
Steps: 224 | Train Loss: 0.0710127 Vali Loss: 0.0877014 Test Loss: 0.1025226
Validation loss decreased (0.087798 --> 0.087701).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0690880
	speed: 0.0958s/iter; left time: 1535.1482s
	iters: 200, epoch: 29 | loss: 0.0689618
	speed: 0.0524s/iter; left time: 834.5876s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:12.00s
Steps: 224 | Train Loss: 0.0709411 Vali Loss: 0.0878401 Test Loss: 0.1026098
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0678539
	speed: 0.0947s/iter; left time: 1497.1219s
	iters: 200, epoch: 30 | loss: 0.0694931
	speed: 0.0524s/iter; left time: 822.8117s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:11.97s
Steps: 224 | Train Loss: 0.0709095 Vali Loss: 0.0877920 Test Loss: 0.1025607
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0682457
	speed: 0.0935s/iter; left time: 1457.1596s
	iters: 200, epoch: 31 | loss: 0.0681491
	speed: 0.0521s/iter; left time: 807.0675s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:11.92s
Steps: 224 | Train Loss: 0.0708165 Vali Loss: 0.0876857 Test Loss: 0.1025284
Validation loss decreased (0.087701 --> 0.087686).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0699011
	speed: 0.0948s/iter; left time: 1455.1746s
	iters: 200, epoch: 32 | loss: 0.0707282
	speed: 0.0522s/iter; left time: 797.0003s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:11.97s
Steps: 224 | Train Loss: 0.0708926 Vali Loss: 0.0877611 Test Loss: 0.1025761
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0750260
	speed: 0.0937s/iter; left time: 1417.7752s
	iters: 200, epoch: 33 | loss: 0.0712225
	speed: 0.0524s/iter; left time: 787.6366s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:11.97s
Steps: 224 | Train Loss: 0.0708430 Vali Loss: 0.0878547 Test Loss: 0.1025163
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0709231
	speed: 0.0935s/iter; left time: 1393.7420s
	iters: 200, epoch: 34 | loss: 0.0734632
	speed: 0.0526s/iter; left time: 778.2671s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:11.99s
Steps: 224 | Train Loss: 0.0707557 Vali Loss: 0.0878187 Test Loss: 0.1025741
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0741756
	speed: 0.0938s/iter; left time: 1377.9772s
	iters: 200, epoch: 35 | loss: 0.0756165
	speed: 0.0524s/iter; left time: 764.4085s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:11.98s
Steps: 224 | Train Loss: 0.0707925 Vali Loss: 0.0877389 Test Loss: 0.1025545
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0762861
	speed: 0.0935s/iter; left time: 1352.1350s
	iters: 200, epoch: 36 | loss: 0.0745686
	speed: 0.0525s/iter; left time: 753.7614s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:11.97s
Steps: 224 | Train Loss: 0.0706969 Vali Loss: 0.0878429 Test Loss: 0.1024922
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0752780
	speed: 0.0940s/iter; left time: 1338.2770s
	iters: 200, epoch: 37 | loss: 0.0681149
	speed: 0.0525s/iter; left time: 741.9103s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:12.01s
Steps: 224 | Train Loss: 0.0706726 Vali Loss: 0.0878174 Test Loss: 0.1026253
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0696197
	speed: 0.0947s/iter; left time: 1326.9728s
	iters: 200, epoch: 38 | loss: 0.0708822
	speed: 0.0525s/iter; left time: 730.5040s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:12.04s
Steps: 224 | Train Loss: 0.0706715 Vali Loss: 0.0877813 Test Loss: 0.1026189
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0691303
	speed: 0.0944s/iter; left time: 1301.7707s
	iters: 200, epoch: 39 | loss: 0.0709607
	speed: 0.0524s/iter; left time: 716.8210s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:12.00s
Steps: 224 | Train Loss: 0.0706529 Vali Loss: 0.0878448 Test Loss: 0.1025701
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0710506
	speed: 0.0938s/iter; left time: 1272.4545s
	iters: 200, epoch: 40 | loss: 0.0685172
	speed: 0.0524s/iter; left time: 705.8024s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:11.98s
Steps: 224 | Train Loss: 0.0706797 Vali Loss: 0.0877237 Test Loss: 0.1025156
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0680695
	speed: 0.0939s/iter; left time: 1252.7076s
	iters: 200, epoch: 41 | loss: 0.0707226
	speed: 0.0525s/iter; left time: 694.8040s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:11.98s
Steps: 224 | Train Loss: 0.0706761 Vali Loss: 0.0877903 Test Loss: 0.1025302
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02596805803477764, rmse:0.16114607453346252, mae:0.1025284007191658, rse:0.5559083223342896
Intermediate time for GB and pred_len 24: 00h:23m:37.48s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1406689
	speed: 0.0778s/iter; left time: 1735.0379s
	iters: 200, epoch: 1 | loss: 0.1337222
	speed: 0.0531s/iter; left time: 1179.5028s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:12.41s
Steps: 224 | Train Loss: 0.1448316 Vali Loss: 0.1478217 Test Loss: 0.1731035
Validation loss decreased (inf --> 0.147822).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1138583
	speed: 0.0962s/iter; left time: 2124.7654s
	iters: 200, epoch: 2 | loss: 0.1043878
	speed: 0.0528s/iter; left time: 1160.9072s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.07s
Steps: 224 | Train Loss: 0.1130484 Vali Loss: 0.1190484 Test Loss: 0.1404722
Validation loss decreased (0.147822 --> 0.119048).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1049010
	speed: 0.0957s/iter; left time: 2090.6869s
	iters: 200, epoch: 3 | loss: 0.0996536
	speed: 0.0528s/iter; left time: 1147.7181s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.04s
Steps: 224 | Train Loss: 0.1032481 Vali Loss: 0.1175735 Test Loss: 0.1405436
Validation loss decreased (0.119048 --> 0.117573).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0995604
	speed: 0.0952s/iter; left time: 2059.6948s
	iters: 200, epoch: 4 | loss: 0.1006075
	speed: 0.0525s/iter; left time: 1130.2437s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:11.95s
Steps: 224 | Train Loss: 0.1012283 Vali Loss: 0.1169945 Test Loss: 0.1409361
Validation loss decreased (0.117573 --> 0.116995).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1010126
	speed: 0.0959s/iter; left time: 2051.9458s
	iters: 200, epoch: 5 | loss: 0.1020785
	speed: 0.0528s/iter; left time: 1123.9785s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.07s
Steps: 224 | Train Loss: 0.0999265 Vali Loss: 0.1165816 Test Loss: 0.1420393
Validation loss decreased (0.116995 --> 0.116582).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0985006
	speed: 0.0969s/iter; left time: 2051.6560s
	iters: 200, epoch: 6 | loss: 0.1023615
	speed: 0.0529s/iter; left time: 1115.3105s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.11s
Steps: 224 | Train Loss: 0.0988150 Vali Loss: 0.1164725 Test Loss: 0.1419193
Validation loss decreased (0.116582 --> 0.116472).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0936005
	speed: 0.0974s/iter; left time: 2041.5122s
	iters: 200, epoch: 7 | loss: 0.1041656
	speed: 0.0528s/iter; left time: 1100.7558s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.13s
Steps: 224 | Train Loss: 0.0977622 Vali Loss: 0.1164984 Test Loss: 0.1426636
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0965147
	speed: 0.0958s/iter; left time: 1987.1782s
	iters: 200, epoch: 8 | loss: 0.0945425
	speed: 0.0529s/iter; left time: 1090.7124s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.08s
Steps: 224 | Train Loss: 0.0968455 Vali Loss: 0.1165157 Test Loss: 0.1424598
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0966142
	speed: 0.0949s/iter; left time: 1947.1544s
	iters: 200, epoch: 9 | loss: 0.0961041
	speed: 0.0524s/iter; left time: 1070.1141s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.04s
Steps: 224 | Train Loss: 0.0958037 Vali Loss: 0.1168818 Test Loss: 0.1435367
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0900782
	speed: 0.0957s/iter; left time: 1941.4901s
	iters: 200, epoch: 10 | loss: 0.0928683
	speed: 0.0525s/iter; left time: 1060.2323s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.05s
Steps: 224 | Train Loss: 0.0950237 Vali Loss: 0.1168693 Test Loss: 0.1427697
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0930412
	speed: 0.0949s/iter; left time: 1904.4256s
	iters: 200, epoch: 11 | loss: 0.0950651
	speed: 0.0529s/iter; left time: 1056.0567s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.06s
Steps: 224 | Train Loss: 0.0941731 Vali Loss: 0.1173024 Test Loss: 0.1442032
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0968957
	speed: 0.0955s/iter; left time: 1893.4818s
	iters: 200, epoch: 12 | loss: 0.0931910
	speed: 0.0528s/iter; left time: 1043.0468s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.08s
Steps: 224 | Train Loss: 0.0934533 Vali Loss: 0.1175537 Test Loss: 0.1439120
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0920408
	speed: 0.0952s/iter; left time: 1866.3103s
	iters: 200, epoch: 13 | loss: 0.0944622
	speed: 0.0527s/iter; left time: 1027.4704s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.05s
Steps: 224 | Train Loss: 0.0928211 Vali Loss: 0.1180769 Test Loss: 0.1442586
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0956941
	speed: 0.0952s/iter; left time: 1846.1370s
	iters: 200, epoch: 14 | loss: 0.0928700
	speed: 0.0528s/iter; left time: 1017.6732s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.03s
Steps: 224 | Train Loss: 0.0922051 Vali Loss: 0.1175812 Test Loss: 0.1443594
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0883551
	speed: 0.0954s/iter; left time: 1827.9641s
	iters: 200, epoch: 15 | loss: 0.0926333
	speed: 0.0526s/iter; left time: 1002.0282s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:12.05s
Steps: 224 | Train Loss: 0.0916389 Vali Loss: 0.1180225 Test Loss: 0.1446331
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0901917
	speed: 0.0953s/iter; left time: 1804.3375s
	iters: 200, epoch: 16 | loss: 0.0919948
	speed: 0.0525s/iter; left time: 989.9656s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:11.97s
Steps: 224 | Train Loss: 0.0911649 Vali Loss: 0.1185595 Test Loss: 0.1457173
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04354952275753021, rmse:0.20868521928787231, mae:0.14191927015781403, rse:0.7216625809669495
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1456753
	speed: 0.0545s/iter; left time: 1216.4646s
	iters: 200, epoch: 1 | loss: 0.1401336
	speed: 0.0528s/iter; left time: 1172.0063s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:12.06s
Steps: 224 | Train Loss: 0.1450534 Vali Loss: 0.1476693 Test Loss: 0.1731948
Validation loss decreased (inf --> 0.147669).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1121303
	speed: 0.0971s/iter; left time: 2144.6319s
	iters: 200, epoch: 2 | loss: 0.1097031
	speed: 0.0523s/iter; left time: 1150.3591s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.03s
Steps: 224 | Train Loss: 0.1142875 Vali Loss: 0.1189107 Test Loss: 0.1412798
Validation loss decreased (0.147669 --> 0.118911).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1073427
	speed: 0.0961s/iter; left time: 2099.4687s
	iters: 200, epoch: 3 | loss: 0.1005311
	speed: 0.0526s/iter; left time: 1143.6469s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:11.97s
Steps: 224 | Train Loss: 0.1034565 Vali Loss: 0.1175246 Test Loss: 0.1412851
Validation loss decreased (0.118911 --> 0.117525).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1021812
	speed: 0.0962s/iter; left time: 2079.8129s
	iters: 200, epoch: 4 | loss: 0.0990468
	speed: 0.0524s/iter; left time: 1128.9112s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:11.99s
Steps: 224 | Train Loss: 0.1013426 Vali Loss: 0.1167549 Test Loss: 0.1418313
Validation loss decreased (0.117525 --> 0.116755).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0974963
	speed: 0.0975s/iter; left time: 2086.9744s
	iters: 200, epoch: 5 | loss: 0.1008517
	speed: 0.0525s/iter; left time: 1118.9854s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.03s
Steps: 224 | Train Loss: 0.0997085 Vali Loss: 0.1166128 Test Loss: 0.1418357
Validation loss decreased (0.116755 --> 0.116613).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1000176
	speed: 0.0971s/iter; left time: 2057.1909s
	iters: 200, epoch: 6 | loss: 0.0948140
	speed: 0.0528s/iter; left time: 1113.1116s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.10s
Steps: 224 | Train Loss: 0.0984699 Vali Loss: 0.1163163 Test Loss: 0.1417426
Validation loss decreased (0.116613 --> 0.116316).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0972994
	speed: 0.0985s/iter; left time: 2063.5184s
	iters: 200, epoch: 7 | loss: 0.0936878
	speed: 0.0529s/iter; left time: 1102.3493s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.11s
Steps: 224 | Train Loss: 0.0972406 Vali Loss: 0.1165814 Test Loss: 0.1420426
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0935553
	speed: 0.0957s/iter; left time: 1984.6068s
	iters: 200, epoch: 8 | loss: 0.0962930
	speed: 0.0524s/iter; left time: 1081.9871s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.00s
Steps: 224 | Train Loss: 0.0962139 Vali Loss: 0.1169551 Test Loss: 0.1428138
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0923287
	speed: 0.0947s/iter; left time: 1941.2373s
	iters: 200, epoch: 9 | loss: 0.0975701
	speed: 0.0526s/iter; left time: 1073.3739s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.00s
Steps: 224 | Train Loss: 0.0952119 Vali Loss: 0.1167024 Test Loss: 0.1424034
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0950940
	speed: 0.0950s/iter; left time: 1927.0254s
	iters: 200, epoch: 10 | loss: 0.0920952
	speed: 0.0523s/iter; left time: 1056.2667s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:11.99s
Steps: 224 | Train Loss: 0.0942552 Vali Loss: 0.1169274 Test Loss: 0.1425461
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0946459
	speed: 0.0958s/iter; left time: 1921.9933s
	iters: 200, epoch: 11 | loss: 0.0923537
	speed: 0.0526s/iter; left time: 1049.9876s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.07s
Steps: 224 | Train Loss: 0.0934874 Vali Loss: 0.1180461 Test Loss: 0.1432987
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0927330
	speed: 0.0948s/iter; left time: 1879.7731s
	iters: 200, epoch: 12 | loss: 0.0926669
	speed: 0.0524s/iter; left time: 1034.8491s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.01s
Steps: 224 | Train Loss: 0.0927273 Vali Loss: 0.1177090 Test Loss: 0.1433754
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0888391
	speed: 0.0959s/iter; left time: 1880.3587s
	iters: 200, epoch: 13 | loss: 0.0915669
	speed: 0.0525s/iter; left time: 1024.4157s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.01s
Steps: 224 | Train Loss: 0.0920820 Vali Loss: 0.1174937 Test Loss: 0.1429974
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0890915
	speed: 0.0951s/iter; left time: 1844.2392s
	iters: 200, epoch: 14 | loss: 0.0909410
	speed: 0.0525s/iter; left time: 1011.8706s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.01s
Steps: 224 | Train Loss: 0.0915154 Vali Loss: 0.1185164 Test Loss: 0.1435190
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0897911
	speed: 0.0955s/iter; left time: 1829.3221s
	iters: 200, epoch: 15 | loss: 0.0919447
	speed: 0.0526s/iter; left time: 1002.4357s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:12.03s
Steps: 224 | Train Loss: 0.0909746 Vali Loss: 0.1183434 Test Loss: 0.1438548
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0908882
	speed: 0.0958s/iter; left time: 1815.0659s
	iters: 200, epoch: 16 | loss: 0.0895689
	speed: 0.0526s/iter; left time: 990.8904s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:12.07s
Steps: 224 | Train Loss: 0.0904027 Vali Loss: 0.1184962 Test Loss: 0.1438918
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04310917481780052, rmse:0.20762749016284943, mae:0.14174264669418335, rse:0.7180048227310181
Intermediate time for GB and pred_len 96: 00h:08m:09.21s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1386354
	speed: 0.0799s/iter; left time: 1774.0109s
	iters: 200, epoch: 1 | loss: 0.1395205
	speed: 0.0533s/iter; left time: 1178.3183s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:12.50s
Steps: 223 | Train Loss: 0.1463431 Vali Loss: 0.1503382 Test Loss: 0.1766342
Validation loss decreased (inf --> 0.150338).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1167225
	speed: 0.0971s/iter; left time: 2133.9906s
	iters: 200, epoch: 2 | loss: 0.1144232
	speed: 0.0532s/iter; left time: 1163.7614s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.13s
Steps: 223 | Train Loss: 0.1172889 Vali Loss: 0.1233330 Test Loss: 0.1472234
Validation loss decreased (0.150338 --> 0.123333).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1107266
	speed: 0.0966s/iter; left time: 2100.9772s
	iters: 200, epoch: 3 | loss: 0.1062191
	speed: 0.0532s/iter; left time: 1151.7519s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.14s
Steps: 223 | Train Loss: 0.1077707 Vali Loss: 0.1215602 Test Loss: 0.1480374
Validation loss decreased (0.123333 --> 0.121560).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1096353
	speed: 0.0962s/iter; left time: 2071.6968s
	iters: 200, epoch: 4 | loss: 0.1031461
	speed: 0.0530s/iter; left time: 1135.9295s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:12.08s
Steps: 223 | Train Loss: 0.1054061 Vali Loss: 0.1210068 Test Loss: 0.1477708
Validation loss decreased (0.121560 --> 0.121007).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1060579
	speed: 0.1009s/iter; left time: 2150.0264s
	iters: 200, epoch: 5 | loss: 0.1032196
	speed: 0.0531s/iter; left time: 1126.3639s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.14s
Steps: 223 | Train Loss: 0.1034220 Vali Loss: 0.1211447 Test Loss: 0.1495119
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1040526
	speed: 0.0952s/iter; left time: 2007.9565s
	iters: 200, epoch: 6 | loss: 0.0999122
	speed: 0.0532s/iter; left time: 1116.9635s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.09s
Steps: 223 | Train Loss: 0.1017199 Vali Loss: 0.1208167 Test Loss: 0.1491451
Validation loss decreased (0.121007 --> 0.120817).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0974309
	speed: 0.0971s/iter; left time: 2026.3603s
	iters: 200, epoch: 7 | loss: 0.0973077
	speed: 0.0532s/iter; left time: 1104.9180s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.13s
Steps: 223 | Train Loss: 0.1002500 Vali Loss: 0.1214452 Test Loss: 0.1506692
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0991654
	speed: 0.0961s/iter; left time: 1983.5420s
	iters: 200, epoch: 8 | loss: 0.0999737
	speed: 0.0534s/iter; left time: 1096.6195s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.13s
Steps: 223 | Train Loss: 0.0989331 Vali Loss: 0.1217749 Test Loss: 0.1506914
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0970173
	speed: 0.0953s/iter; left time: 1945.7000s
	iters: 200, epoch: 9 | loss: 0.0956019
	speed: 0.0529s/iter; left time: 1074.7306s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.07s
Steps: 223 | Train Loss: 0.0976805 Vali Loss: 0.1223509 Test Loss: 0.1528988
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0916557
	speed: 0.0952s/iter; left time: 1922.6336s
	iters: 200, epoch: 10 | loss: 0.0955586
	speed: 0.0533s/iter; left time: 1070.8174s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.10s
Steps: 223 | Train Loss: 0.0966453 Vali Loss: 0.1220048 Test Loss: 0.1516780
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0931706
	speed: 0.0954s/iter; left time: 1905.0389s
	iters: 200, epoch: 11 | loss: 0.0948939
	speed: 0.0530s/iter; left time: 1053.6415s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.08s
Steps: 223 | Train Loss: 0.0956451 Vali Loss: 0.1224576 Test Loss: 0.1529393
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0946385
	speed: 0.0951s/iter; left time: 1878.5123s
	iters: 200, epoch: 12 | loss: 0.0961585
	speed: 0.0531s/iter; left time: 1043.7084s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.09s
Steps: 223 | Train Loss: 0.0948170 Vali Loss: 0.1230200 Test Loss: 0.1536463
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0947491
	speed: 0.0963s/iter; left time: 1880.2425s
	iters: 200, epoch: 13 | loss: 0.0919266
	speed: 0.0532s/iter; left time: 1032.5508s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.15s
Steps: 223 | Train Loss: 0.0940334 Vali Loss: 0.1228369 Test Loss: 0.1537511
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0905955
	speed: 0.0954s/iter; left time: 1842.2054s
	iters: 200, epoch: 14 | loss: 0.0925452
	speed: 0.0531s/iter; left time: 1019.8482s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.09s
Steps: 223 | Train Loss: 0.0933891 Vali Loss: 0.1232879 Test Loss: 0.1543309
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0899824
	speed: 0.0961s/iter; left time: 1833.3011s
	iters: 200, epoch: 15 | loss: 0.0903571
	speed: 0.0531s/iter; left time: 1008.5286s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:12.11s
Steps: 223 | Train Loss: 0.0927193 Vali Loss: 0.1231269 Test Loss: 0.1540274
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0921509
	speed: 0.0953s/iter; left time: 1797.8988s
	iters: 200, epoch: 16 | loss: 0.0940645
	speed: 0.0528s/iter; left time: 991.0784s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:12.07s
Steps: 223 | Train Loss: 0.0921280 Vali Loss: 0.1235844 Test Loss: 0.1547213
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04644313454627991, rmse:0.2155066877603531, mae:0.14914505183696747, rse:0.7471926212310791
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1437372
	speed: 0.0554s/iter; left time: 1230.5675s
	iters: 200, epoch: 1 | loss: 0.1413468
	speed: 0.0531s/iter; left time: 1173.5521s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:12.15s
Steps: 223 | Train Loss: 0.1469574 Vali Loss: 0.1503597 Test Loss: 0.1767833
Validation loss decreased (inf --> 0.150360).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1121952
	speed: 0.0985s/iter; left time: 2165.5026s
	iters: 200, epoch: 2 | loss: 0.1107133
	speed: 0.0531s/iter; left time: 1160.6755s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.11s
Steps: 223 | Train Loss: 0.1172488 Vali Loss: 0.1230871 Test Loss: 0.1470359
Validation loss decreased (0.150360 --> 0.123087).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1074790
	speed: 0.0977s/iter; left time: 2125.6744s
	iters: 200, epoch: 3 | loss: 0.1082936
	speed: 0.0531s/iter; left time: 1150.3794s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.12s
Steps: 223 | Train Loss: 0.1079106 Vali Loss: 0.1219156 Test Loss: 0.1472393
Validation loss decreased (0.123087 --> 0.121916).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1024566
	speed: 0.0985s/iter; left time: 2121.1252s
	iters: 200, epoch: 4 | loss: 0.1093854
	speed: 0.0530s/iter; left time: 1135.9856s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:12.11s
Steps: 223 | Train Loss: 0.1056144 Vali Loss: 0.1214643 Test Loss: 0.1478963
Validation loss decreased (0.121916 --> 0.121464).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1043837
	speed: 0.0995s/iter; left time: 2120.1471s
	iters: 200, epoch: 5 | loss: 0.1008662
	speed: 0.0532s/iter; left time: 1128.3737s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.15s
Steps: 223 | Train Loss: 0.1037652 Vali Loss: 0.1209340 Test Loss: 0.1483610
Validation loss decreased (0.121464 --> 0.120934).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1018177
	speed: 0.0988s/iter; left time: 2082.5883s
	iters: 200, epoch: 6 | loss: 0.1021051
	speed: 0.0528s/iter; left time: 1108.5448s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.11s
Steps: 223 | Train Loss: 0.1021854 Vali Loss: 0.1211857 Test Loss: 0.1487773
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1033683
	speed: 0.0959s/iter; left time: 2001.1717s
	iters: 200, epoch: 7 | loss: 0.1002985
	speed: 0.0526s/iter; left time: 1092.4706s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.00s
Steps: 223 | Train Loss: 0.1008956 Vali Loss: 0.1210550 Test Loss: 0.1488046
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1034819
	speed: 0.0961s/iter; left time: 1982.6148s
	iters: 200, epoch: 8 | loss: 0.0974347
	speed: 0.0529s/iter; left time: 1086.7923s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.06s
Steps: 223 | Train Loss: 0.0997048 Vali Loss: 0.1213903 Test Loss: 0.1492843
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0996106
	speed: 0.0971s/iter; left time: 1983.2062s
	iters: 200, epoch: 9 | loss: 0.1009926
	speed: 0.0529s/iter; left time: 1074.2654s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.07s
Steps: 223 | Train Loss: 0.0987894 Vali Loss: 0.1212850 Test Loss: 0.1499267
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0979183
	speed: 0.0963s/iter; left time: 1943.9106s
	iters: 200, epoch: 10 | loss: 0.0985871
	speed: 0.0530s/iter; left time: 1065.6986s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.13s
Steps: 223 | Train Loss: 0.0978428 Vali Loss: 0.1210372 Test Loss: 0.1496313
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0980109
	speed: 0.0968s/iter; left time: 1933.7956s
	iters: 200, epoch: 11 | loss: 0.0930352
	speed: 0.0531s/iter; left time: 1054.9296s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.09s
Steps: 223 | Train Loss: 0.0970727 Vali Loss: 0.1218514 Test Loss: 0.1515267
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0990410
	speed: 0.0972s/iter; left time: 1919.2860s
	iters: 200, epoch: 12 | loss: 0.0954193
	speed: 0.0533s/iter; left time: 1046.5248s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.17s
Steps: 223 | Train Loss: 0.0962643 Vali Loss: 0.1218991 Test Loss: 0.1503961
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0943987
	speed: 0.0971s/iter; left time: 1895.7932s
	iters: 200, epoch: 13 | loss: 0.0911834
	speed: 0.0531s/iter; left time: 1031.6715s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.12s
Steps: 223 | Train Loss: 0.0956385 Vali Loss: 0.1226010 Test Loss: 0.1523950
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0947586
	speed: 0.0979s/iter; left time: 1889.2056s
	iters: 200, epoch: 14 | loss: 0.0958324
	speed: 0.0532s/iter; left time: 1020.6452s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.15s
Steps: 223 | Train Loss: 0.0950461 Vali Loss: 0.1226071 Test Loss: 0.1518613
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0910238
	speed: 0.0971s/iter; left time: 1851.7204s
	iters: 200, epoch: 15 | loss: 0.0908302
	speed: 0.0533s/iter; left time: 1012.1962s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:12.15s
Steps: 223 | Train Loss: 0.0944825 Vali Loss: 0.1224583 Test Loss: 0.1519933
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04599538445472717, rmse:0.21446534991264343, mae:0.14836086332798004, rse:0.7435821890830994
Intermediate time for GB and pred_len 168: 00h:07m:59.59sIntermediate time for GB: 00h:39m:46.28s
=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1526842
	speed: 0.0604s/iter; left time: 1346.6424s
	iters: 200, epoch: 1 | loss: 0.1366305
	speed: 0.0345s/iter; left time: 766.6100s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.27s
Steps: 224 | Train Loss: 0.1550454 Vali Loss: 0.1393994 Test Loss: 0.1681718
Validation loss decreased (inf --> 0.139399).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0732484
	speed: 0.0661s/iter; left time: 1460.0271s
	iters: 200, epoch: 2 | loss: 0.0723599
	speed: 0.0360s/iter; left time: 790.6278s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.15s
Steps: 224 | Train Loss: 0.0805116 Vali Loss: 0.0647224 Test Loss: 0.0717992
Validation loss decreased (0.139399 --> 0.064722).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0670712
	speed: 0.0676s/iter; left time: 1477.0346s
	iters: 200, epoch: 3 | loss: 0.0631713
	speed: 0.0340s/iter; left time: 739.7252s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0640164 Vali Loss: 0.0604511 Test Loss: 0.0675387
Validation loss decreased (0.064722 --> 0.060451).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0615953
	speed: 0.0650s/iter; left time: 1405.4457s
	iters: 200, epoch: 4 | loss: 0.0594863
	speed: 0.0354s/iter; left time: 762.2104s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.15s
Steps: 224 | Train Loss: 0.0607313 Vali Loss: 0.0585351 Test Loss: 0.0652289
Validation loss decreased (0.060451 --> 0.058535).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0582284
	speed: 0.0646s/iter; left time: 1383.3173s
	iters: 200, epoch: 5 | loss: 0.0548869
	speed: 0.0340s/iter; left time: 723.9232s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0586365 Vali Loss: 0.0571023 Test Loss: 0.0640453
Validation loss decreased (0.058535 --> 0.057102).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0568549
	speed: 0.0667s/iter; left time: 1413.1525s
	iters: 200, epoch: 6 | loss: 0.0545233
	speed: 0.0343s/iter; left time: 722.9715s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0572533 Vali Loss: 0.0562853 Test Loss: 0.0630265
Validation loss decreased (0.057102 --> 0.056285).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0588305
	speed: 0.0663s/iter; left time: 1388.5654s
	iters: 200, epoch: 7 | loss: 0.0523065
	speed: 0.0356s/iter; left time: 742.9014s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.16s
Steps: 224 | Train Loss: 0.0561701 Vali Loss: 0.0557691 Test Loss: 0.0625740
Validation loss decreased (0.056285 --> 0.055769).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0549896
	speed: 0.0635s/iter; left time: 1316.3383s
	iters: 200, epoch: 8 | loss: 0.0590127
	speed: 0.0342s/iter; left time: 706.0416s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0555243 Vali Loss: 0.0552860 Test Loss: 0.0622382
Validation loss decreased (0.055769 --> 0.055286).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0538663
	speed: 0.0643s/iter; left time: 1318.4272s
	iters: 200, epoch: 9 | loss: 0.0581174
	speed: 0.0339s/iter; left time: 692.2422s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0549856 Vali Loss: 0.0547778 Test Loss: 0.0615789
Validation loss decreased (0.055286 --> 0.054778).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0544842
	speed: 0.0641s/iter; left time: 1299.8318s
	iters: 200, epoch: 10 | loss: 0.0509822
	speed: 0.0339s/iter; left time: 684.6274s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0545583 Vali Loss: 0.0547986 Test Loss: 0.0614929
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0541769
	speed: 0.0632s/iter; left time: 1267.4606s
	iters: 200, epoch: 11 | loss: 0.0549371
	speed: 0.0338s/iter; left time: 675.3753s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0541390 Vali Loss: 0.0542580 Test Loss: 0.0609762
Validation loss decreased (0.054778 --> 0.054258).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0538365
	speed: 0.0632s/iter; left time: 1253.3795s
	iters: 200, epoch: 12 | loss: 0.0529875
	speed: 0.0341s/iter; left time: 672.4888s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0538779 Vali Loss: 0.0541497 Test Loss: 0.0608541
Validation loss decreased (0.054258 --> 0.054150).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0556539
	speed: 0.0644s/iter; left time: 1262.7040s
	iters: 200, epoch: 13 | loss: 0.0526646
	speed: 0.0343s/iter; left time: 670.0860s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0536023 Vali Loss: 0.0540321 Test Loss: 0.0606161
Validation loss decreased (0.054150 --> 0.054032).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0543625
	speed: 0.0634s/iter; left time: 1228.6336s
	iters: 200, epoch: 14 | loss: 0.0530023
	speed: 0.0339s/iter; left time: 653.4071s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0533630 Vali Loss: 0.0541184 Test Loss: 0.0608187
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0521512
	speed: 0.0620s/iter; left time: 1188.6895s
	iters: 200, epoch: 15 | loss: 0.0521281
	speed: 0.0339s/iter; left time: 645.8167s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0531000 Vali Loss: 0.0539720 Test Loss: 0.0605283
Validation loss decreased (0.054032 --> 0.053972).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0509178
	speed: 0.0634s/iter; left time: 1200.9643s
	iters: 200, epoch: 16 | loss: 0.0512274
	speed: 0.0338s/iter; left time: 636.0189s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0529989 Vali Loss: 0.0536041 Test Loss: 0.0602776
Validation loss decreased (0.053972 --> 0.053604).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0513468
	speed: 0.0637s/iter; left time: 1192.9851s
	iters: 200, epoch: 17 | loss: 0.0483066
	speed: 0.0341s/iter; left time: 635.5707s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0528339 Vali Loss: 0.0536399 Test Loss: 0.0601474
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0508105
	speed: 0.0630s/iter; left time: 1164.2827s
	iters: 200, epoch: 18 | loss: 0.0472548
	speed: 0.0337s/iter; left time: 619.7756s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0526830 Vali Loss: 0.0535131 Test Loss: 0.0600573
Validation loss decreased (0.053604 --> 0.053513).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0543427
	speed: 0.0631s/iter; left time: 1153.5161s
	iters: 200, epoch: 19 | loss: 0.0539975
	speed: 0.0338s/iter; left time: 614.1322s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0526239 Vali Loss: 0.0534467 Test Loss: 0.0600467
Validation loss decreased (0.053513 --> 0.053447).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0512956
	speed: 0.0653s/iter; left time: 1178.5996s
	iters: 200, epoch: 20 | loss: 0.0518979
	speed: 0.0338s/iter; left time: 606.8786s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0524580 Vali Loss: 0.0534504 Test Loss: 0.0601290
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0516894
	speed: 0.0621s/iter; left time: 1106.9958s
	iters: 200, epoch: 21 | loss: 0.0514001
	speed: 0.0338s/iter; left time: 599.0989s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.76s
Steps: 224 | Train Loss: 0.0523597 Vali Loss: 0.0533231 Test Loss: 0.0599976
Validation loss decreased (0.053447 --> 0.053323).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0483420
	speed: 0.0634s/iter; left time: 1114.9022s
	iters: 200, epoch: 22 | loss: 0.0524221
	speed: 0.0341s/iter; left time: 597.3589s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0522725 Vali Loss: 0.0532108 Test Loss: 0.0598633
Validation loss decreased (0.053323 --> 0.053211).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0503389
	speed: 0.0634s/iter; left time: 1101.4061s
	iters: 200, epoch: 23 | loss: 0.0539414
	speed: 0.0340s/iter; left time: 587.2548s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0522263 Vali Loss: 0.0532671 Test Loss: 0.0599022
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0542046
	speed: 0.0623s/iter; left time: 1067.7372s
	iters: 200, epoch: 24 | loss: 0.0510984
	speed: 0.0337s/iter; left time: 574.7898s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0521891 Vali Loss: 0.0531939 Test Loss: 0.0597542
Validation loss decreased (0.053211 --> 0.053194).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0514270
	speed: 0.0630s/iter; left time: 1066.0431s
	iters: 200, epoch: 25 | loss: 0.0550747
	speed: 0.0353s/iter; left time: 593.5440s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0520553 Vali Loss: 0.0530766 Test Loss: 0.0597279
Validation loss decreased (0.053194 --> 0.053077).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0486141
	speed: 0.0624s/iter; left time: 1042.4930s
	iters: 200, epoch: 26 | loss: 0.0538085
	speed: 0.0337s/iter; left time: 559.5630s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0519923 Vali Loss: 0.0531875 Test Loss: 0.0597662
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0524277
	speed: 0.0620s/iter; left time: 1021.5561s
	iters: 200, epoch: 27 | loss: 0.0521245
	speed: 0.0340s/iter; left time: 556.3864s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0520323 Vali Loss: 0.0530715 Test Loss: 0.0596598
Validation loss decreased (0.053077 --> 0.053071).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0528489
	speed: 0.0635s/iter; left time: 1032.3777s
	iters: 200, epoch: 28 | loss: 0.0528272
	speed: 0.0338s/iter; left time: 545.7895s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0519045 Vali Loss: 0.0530310 Test Loss: 0.0596944
Validation loss decreased (0.053071 --> 0.053031).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0494530
	speed: 0.0640s/iter; left time: 1026.1535s
	iters: 200, epoch: 29 | loss: 0.0549773
	speed: 0.0339s/iter; left time: 539.8393s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0518919 Vali Loss: 0.0531214 Test Loss: 0.0597658
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0509516
	speed: 0.0634s/iter; left time: 1002.2817s
	iters: 200, epoch: 30 | loss: 0.0541899
	speed: 0.0340s/iter; left time: 534.1842s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0518665 Vali Loss: 0.0530275 Test Loss: 0.0596586
Validation loss decreased (0.053031 --> 0.053028).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0517120
	speed: 0.0643s/iter; left time: 1001.5331s
	iters: 200, epoch: 31 | loss: 0.0504429
	speed: 0.0339s/iter; left time: 525.2424s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0518409 Vali Loss: 0.0530472 Test Loss: 0.0595775
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0496667
	speed: 0.0627s/iter; left time: 962.6306s
	iters: 200, epoch: 32 | loss: 0.0514431
	speed: 0.0338s/iter; left time: 516.1538s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0518175 Vali Loss: 0.0530794 Test Loss: 0.0596468
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0489944
	speed: 0.0629s/iter; left time: 951.3312s
	iters: 200, epoch: 33 | loss: 0.0532939
	speed: 0.0340s/iter; left time: 511.1134s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0517973 Vali Loss: 0.0530503 Test Loss: 0.0596521
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0528417
	speed: 0.0622s/iter; left time: 927.0861s
	iters: 200, epoch: 34 | loss: 0.0519611
	speed: 0.0343s/iter; left time: 508.4967s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0517021 Vali Loss: 0.0530652 Test Loss: 0.0594816
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0530752
	speed: 0.0621s/iter; left time: 911.7153s
	iters: 200, epoch: 35 | loss: 0.0518166
	speed: 0.0339s/iter; left time: 493.8992s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0517347 Vali Loss: 0.0528620 Test Loss: 0.0595123
Validation loss decreased (0.053028 --> 0.052862).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0506464
	speed: 0.0628s/iter; left time: 908.1825s
	iters: 200, epoch: 36 | loss: 0.0517927
	speed: 0.0337s/iter; left time: 483.5578s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.75s
Steps: 224 | Train Loss: 0.0516731 Vali Loss: 0.0529967 Test Loss: 0.0596204
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0519233
	speed: 0.0620s/iter; left time: 882.0725s
	iters: 200, epoch: 37 | loss: 0.0506047
	speed: 0.0337s/iter; left time: 477.0007s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0516810 Vali Loss: 0.0530068 Test Loss: 0.0595802
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0507490
	speed: 0.0626s/iter; left time: 876.5285s
	iters: 200, epoch: 38 | loss: 0.0562936
	speed: 0.0340s/iter; left time: 473.5797s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0516737 Vali Loss: 0.0529319 Test Loss: 0.0594970
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0492359
	speed: 0.0624s/iter; left time: 859.9221s
	iters: 200, epoch: 39 | loss: 0.0538159
	speed: 0.0340s/iter; left time: 466.0065s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0516829 Vali Loss: 0.0529696 Test Loss: 0.0594831
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0513327
	speed: 0.0621s/iter; left time: 842.2274s
	iters: 200, epoch: 40 | loss: 0.0514433
	speed: 0.0339s/iter; left time: 456.3563s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0516562 Vali Loss: 0.0530150 Test Loss: 0.0596243
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0518598
	speed: 0.0626s/iter; left time: 835.4721s
	iters: 200, epoch: 41 | loss: 0.0497989
	speed: 0.0337s/iter; left time: 446.1685s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0516688 Vali Loss: 0.0528681 Test Loss: 0.0594650
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0497980
	speed: 0.0621s/iter; left time: 815.0426s
	iters: 200, epoch: 42 | loss: 0.0535568
	speed: 0.0338s/iter; left time: 439.9037s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:07.76s
Steps: 224 | Train Loss: 0.0516297 Vali Loss: 0.0529409 Test Loss: 0.0594555
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0522472
	speed: 0.0624s/iter; left time: 804.6057s
	iters: 200, epoch: 43 | loss: 0.0489027
	speed: 0.0341s/iter; left time: 436.8538s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0516606 Vali Loss: 0.0529695 Test Loss: 0.0595177
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0520200
	speed: 0.0624s/iter; left time: 790.9626s
	iters: 200, epoch: 44 | loss: 0.0508248
	speed: 0.0339s/iter; left time: 426.7010s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0515849 Vali Loss: 0.0529528 Test Loss: 0.0595244
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0524924
	speed: 0.0624s/iter; left time: 776.7002s
	iters: 200, epoch: 45 | loss: 0.0509926
	speed: 0.0337s/iter; left time: 416.1641s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:07.75s
Steps: 224 | Train Loss: 0.0515887 Vali Loss: 0.0530027 Test Loss: 0.0595490
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009823016822338104, rmse:0.09911113232374191, mae:0.05951228737831116, rse:0.2916720509529114
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1579360
	speed: 0.0361s/iter; left time: 804.0798s
	iters: 200, epoch: 1 | loss: 0.1345574
	speed: 0.0339s/iter; left time: 751.8680s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.1544287 Vali Loss: 0.1378902 Test Loss: 0.1664125
Validation loss decreased (inf --> 0.137890).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0723953
	speed: 0.0656s/iter; left time: 1447.5926s
	iters: 200, epoch: 2 | loss: 0.0673680
	speed: 0.0343s/iter; left time: 752.7593s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0807752 Vali Loss: 0.0640944 Test Loss: 0.0714371
Validation loss decreased (0.137890 --> 0.064094).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0664814
	speed: 0.0640s/iter; left time: 1399.1998s
	iters: 200, epoch: 3 | loss: 0.0602823
	speed: 0.0338s/iter; left time: 735.2364s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0644568 Vali Loss: 0.0613151 Test Loss: 0.0682127
Validation loss decreased (0.064094 --> 0.061315).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0619137
	speed: 0.0638s/iter; left time: 1379.6420s
	iters: 200, epoch: 4 | loss: 0.0629501
	speed: 0.0340s/iter; left time: 731.6259s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0613793 Vali Loss: 0.0588372 Test Loss: 0.0659621
Validation loss decreased (0.061315 --> 0.058837).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0599205
	speed: 0.0636s/iter; left time: 1361.2482s
	iters: 200, epoch: 5 | loss: 0.0566143
	speed: 0.0343s/iter; left time: 729.9419s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0592500 Vali Loss: 0.0577281 Test Loss: 0.0648115
Validation loss decreased (0.058837 --> 0.057728).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0587412
	speed: 0.0646s/iter; left time: 1368.8715s
	iters: 200, epoch: 6 | loss: 0.0555555
	speed: 0.0337s/iter; left time: 710.7802s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0577187 Vali Loss: 0.0565377 Test Loss: 0.0634899
Validation loss decreased (0.057728 --> 0.056538).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0582398
	speed: 0.0647s/iter; left time: 1355.8622s
	iters: 200, epoch: 7 | loss: 0.0569732
	speed: 0.0342s/iter; left time: 713.0679s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0565804 Vali Loss: 0.0560253 Test Loss: 0.0630894
Validation loss decreased (0.056538 --> 0.056025).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0576674
	speed: 0.0638s/iter; left time: 1323.4970s
	iters: 200, epoch: 8 | loss: 0.0565004
	speed: 0.0338s/iter; left time: 697.2153s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0557787 Vali Loss: 0.0554661 Test Loss: 0.0624663
Validation loss decreased (0.056025 --> 0.055466).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0545671
	speed: 0.0644s/iter; left time: 1320.2648s
	iters: 200, epoch: 9 | loss: 0.0577309
	speed: 0.0339s/iter; left time: 692.3419s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0551741 Vali Loss: 0.0550627 Test Loss: 0.0620055
Validation loss decreased (0.055466 --> 0.055063).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0536375
	speed: 0.0638s/iter; left time: 1294.8314s
	iters: 200, epoch: 10 | loss: 0.0555455
	speed: 0.0338s/iter; left time: 682.6029s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0547537 Vali Loss: 0.0550868 Test Loss: 0.0618774
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0518436
	speed: 0.0642s/iter; left time: 1288.8872s
	iters: 200, epoch: 11 | loss: 0.0547084
	speed: 0.0338s/iter; left time: 675.1675s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0543565 Vali Loss: 0.0546177 Test Loss: 0.0611843
Validation loss decreased (0.055063 --> 0.054618).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0567422
	speed: 0.0646s/iter; left time: 1282.2327s
	iters: 200, epoch: 12 | loss: 0.0523581
	speed: 0.0345s/iter; left time: 681.3067s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0540275 Vali Loss: 0.0544829 Test Loss: 0.0609822
Validation loss decreased (0.054618 --> 0.054483).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0552673
	speed: 0.0641s/iter; left time: 1257.6833s
	iters: 200, epoch: 13 | loss: 0.0510562
	speed: 0.0350s/iter; left time: 682.6441s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0537494 Vali Loss: 0.0542448 Test Loss: 0.0610533
Validation loss decreased (0.054483 --> 0.054245).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0562548
	speed: 0.0641s/iter; left time: 1243.7317s
	iters: 200, epoch: 14 | loss: 0.0558280
	speed: 0.0339s/iter; left time: 654.3784s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0534659 Vali Loss: 0.0541800 Test Loss: 0.0609532
Validation loss decreased (0.054245 --> 0.054180).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0524575
	speed: 0.0645s/iter; left time: 1236.6597s
	iters: 200, epoch: 15 | loss: 0.0552186
	speed: 0.0342s/iter; left time: 652.7631s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0533038 Vali Loss: 0.0540752 Test Loss: 0.0606174
Validation loss decreased (0.054180 --> 0.054075).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0530639
	speed: 0.0638s/iter; left time: 1208.7191s
	iters: 200, epoch: 16 | loss: 0.0518307
	speed: 0.0340s/iter; left time: 640.5706s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0531068 Vali Loss: 0.0539237 Test Loss: 0.0606197
Validation loss decreased (0.054075 --> 0.053924).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0549129
	speed: 0.0634s/iter; left time: 1186.5953s
	iters: 200, epoch: 17 | loss: 0.0486911
	speed: 0.0341s/iter; left time: 634.3103s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0529943 Vali Loss: 0.0538352 Test Loss: 0.0604584
Validation loss decreased (0.053924 --> 0.053835).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0533815
	speed: 0.0634s/iter; left time: 1172.0304s
	iters: 200, epoch: 18 | loss: 0.0563068
	speed: 0.0337s/iter; left time: 620.0059s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0528632 Vali Loss: 0.0536740 Test Loss: 0.0603638
Validation loss decreased (0.053835 --> 0.053674).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0529857
	speed: 0.0644s/iter; left time: 1176.9571s
	iters: 200, epoch: 19 | loss: 0.0518051
	speed: 0.0345s/iter; left time: 627.5872s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0526865 Vali Loss: 0.0534223 Test Loss: 0.0601238
Validation loss decreased (0.053674 --> 0.053422).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0509609
	speed: 0.0664s/iter; left time: 1197.7934s
	iters: 200, epoch: 20 | loss: 0.0505578
	speed: 0.0340s/iter; left time: 610.8590s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0526346 Vali Loss: 0.0535342 Test Loss: 0.0601085
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0515755
	speed: 0.0633s/iter; left time: 1128.2819s
	iters: 200, epoch: 21 | loss: 0.0507104
	speed: 0.0338s/iter; left time: 599.6432s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0525259 Vali Loss: 0.0534651 Test Loss: 0.0600710
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0511437
	speed: 0.0634s/iter; left time: 1115.0485s
	iters: 200, epoch: 22 | loss: 0.0498561
	speed: 0.0341s/iter; left time: 596.6270s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0524205 Vali Loss: 0.0534762 Test Loss: 0.0601843
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0535026
	speed: 0.0638s/iter; left time: 1108.3810s
	iters: 200, epoch: 23 | loss: 0.0500406
	speed: 0.0339s/iter; left time: 585.4355s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0523597 Vali Loss: 0.0534131 Test Loss: 0.0600998
Validation loss decreased (0.053422 --> 0.053413).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0492497
	speed: 0.0636s/iter; left time: 1091.3796s
	iters: 200, epoch: 24 | loss: 0.0506229
	speed: 0.0342s/iter; left time: 582.3522s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0522823 Vali Loss: 0.0532963 Test Loss: 0.0599198
Validation loss decreased (0.053413 --> 0.053296).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0521318
	speed: 0.0641s/iter; left time: 1084.4582s
	iters: 200, epoch: 25 | loss: 0.0511510
	speed: 0.0338s/iter; left time: 569.1534s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0522033 Vali Loss: 0.0533299 Test Loss: 0.0599659
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0504086
	speed: 0.0655s/iter; left time: 1094.5408s
	iters: 200, epoch: 26 | loss: 0.0505698
	speed: 0.0338s/iter; left time: 561.8624s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0521587 Vali Loss: 0.0533623 Test Loss: 0.0599633
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0529970
	speed: 0.0630s/iter; left time: 1037.4595s
	iters: 200, epoch: 27 | loss: 0.0493081
	speed: 0.0338s/iter; left time: 553.8609s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0521429 Vali Loss: 0.0534271 Test Loss: 0.0600620
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0561010
	speed: 0.0630s/iter; left time: 1023.9073s
	iters: 200, epoch: 28 | loss: 0.0526673
	speed: 0.0343s/iter; left time: 554.8269s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0520879 Vali Loss: 0.0532309 Test Loss: 0.0596975
Validation loss decreased (0.053296 --> 0.053231).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0538653
	speed: 0.0646s/iter; left time: 1035.0157s
	iters: 200, epoch: 29 | loss: 0.0507462
	speed: 0.0338s/iter; left time: 538.8909s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0520182 Vali Loss: 0.0532914 Test Loss: 0.0598624
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0564779
	speed: 0.0630s/iter; left time: 996.0205s
	iters: 200, epoch: 30 | loss: 0.0513206
	speed: 0.0340s/iter; left time: 534.3814s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0519411 Vali Loss: 0.0531523 Test Loss: 0.0597022
Validation loss decreased (0.053231 --> 0.053152).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0504823
	speed: 0.0650s/iter; left time: 1013.0064s
	iters: 200, epoch: 31 | loss: 0.0540285
	speed: 0.0347s/iter; left time: 536.8186s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0519207 Vali Loss: 0.0531699 Test Loss: 0.0596743
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0498894
	speed: 0.0643s/iter; left time: 988.1779s
	iters: 200, epoch: 32 | loss: 0.0540251
	speed: 0.0341s/iter; left time: 520.0592s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0519015 Vali Loss: 0.0531963 Test Loss: 0.0597262
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0543305
	speed: 0.0635s/iter; left time: 960.2463s
	iters: 200, epoch: 33 | loss: 0.0495824
	speed: 0.0338s/iter; left time: 508.1895s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0518915 Vali Loss: 0.0531901 Test Loss: 0.0596950
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0508410
	speed: 0.0629s/iter; left time: 937.3653s
	iters: 200, epoch: 34 | loss: 0.0491989
	speed: 0.0338s/iter; left time: 500.3855s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0518669 Vali Loss: 0.0531966 Test Loss: 0.0597255
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0490082
	speed: 0.0637s/iter; left time: 935.0894s
	iters: 200, epoch: 35 | loss: 0.0526008
	speed: 0.0340s/iter; left time: 495.3771s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0518020 Vali Loss: 0.0531861 Test Loss: 0.0596925
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0554945
	speed: 0.0636s/iter; left time: 920.2849s
	iters: 200, epoch: 36 | loss: 0.0519463
	speed: 0.0342s/iter; left time: 490.6210s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0518643 Vali Loss: 0.0531078 Test Loss: 0.0596932
Validation loss decreased (0.053152 --> 0.053108).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0496504
	speed: 0.0642s/iter; left time: 914.6147s
	iters: 200, epoch: 37 | loss: 0.0498719
	speed: 0.0339s/iter; left time: 478.8486s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0518462 Vali Loss: 0.0531845 Test Loss: 0.0596469
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0510170
	speed: 0.0632s/iter; left time: 885.8509s
	iters: 200, epoch: 38 | loss: 0.0542504
	speed: 0.0340s/iter; left time: 472.4715s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0518217 Vali Loss: 0.0531203 Test Loss: 0.0596973
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0488454
	speed: 0.0647s/iter; left time: 892.1316s
	iters: 200, epoch: 39 | loss: 0.0506440
	speed: 0.0345s/iter; left time: 471.7330s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0517673 Vali Loss: 0.0530957 Test Loss: 0.0596440
Validation loss decreased (0.053108 --> 0.053096).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0500557
	speed: 0.0677s/iter; left time: 918.0741s
	iters: 200, epoch: 40 | loss: 0.0513093
	speed: 0.0343s/iter; left time: 462.1892s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0517291 Vali Loss: 0.0530914 Test Loss: 0.0595172
Validation loss decreased (0.053096 --> 0.053091).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0547261
	speed: 0.0639s/iter; left time: 852.7917s
	iters: 200, epoch: 41 | loss: 0.0481549
	speed: 0.0339s/iter; left time: 449.3066s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0517457 Vali Loss: 0.0530916 Test Loss: 0.0596419
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0524280
	speed: 0.0630s/iter; left time: 825.7892s
	iters: 200, epoch: 42 | loss: 0.0527511
	speed: 0.0341s/iter; left time: 444.1422s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0517541 Vali Loss: 0.0532012 Test Loss: 0.0597727
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0527208
	speed: 0.0644s/iter; left time: 830.0778s
	iters: 200, epoch: 43 | loss: 0.0518980
	speed: 0.0346s/iter; left time: 442.3068s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0517267 Vali Loss: 0.0529711 Test Loss: 0.0595133
Validation loss decreased (0.053091 --> 0.052971).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0536714
	speed: 0.0677s/iter; left time: 858.0545s
	iters: 200, epoch: 44 | loss: 0.0551635
	speed: 0.0341s/iter; left time: 428.2017s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:08.18s
Steps: 224 | Train Loss: 0.0517666 Vali Loss: 0.0530981 Test Loss: 0.0596632
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0518254
	speed: 0.0636s/iter; left time: 791.2838s
	iters: 200, epoch: 45 | loss: 0.0512678
	speed: 0.0345s/iter; left time: 426.1934s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0516751 Vali Loss: 0.0531732 Test Loss: 0.0596597
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0521856
	speed: 0.0635s/iter; left time: 776.6086s
	iters: 200, epoch: 46 | loss: 0.0487361
	speed: 0.0339s/iter; left time: 410.8650s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0516208 Vali Loss: 0.0530561 Test Loss: 0.0595802
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0530450
	speed: 0.0639s/iter; left time: 766.6442s
	iters: 200, epoch: 47 | loss: 0.0445639
	speed: 0.0342s/iter; left time: 407.0757s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0516959 Vali Loss: 0.0531059 Test Loss: 0.0596224
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0539990
	speed: 0.0642s/iter; left time: 756.1971s
	iters: 200, epoch: 48 | loss: 0.0513229
	speed: 0.0340s/iter; left time: 396.7440s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0516967 Vali Loss: 0.0530909 Test Loss: 0.0596255
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0525027
	speed: 0.0636s/iter; left time: 734.5643s
	iters: 200, epoch: 49 | loss: 0.0530085
	speed: 0.0339s/iter; left time: 388.6068s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0516743 Vali Loss: 0.0531389 Test Loss: 0.0596946
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0477419
	speed: 0.0644s/iter; left time: 729.6514s
	iters: 200, epoch: 50 | loss: 0.0513889
	speed: 0.0341s/iter; left time: 382.6163s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0516918 Vali Loss: 0.0530067 Test Loss: 0.0595521
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0530295
	speed: 0.0628s/iter; left time: 696.8344s
	iters: 200, epoch: 51 | loss: 0.0510417
	speed: 0.0338s/iter; left time: 371.3628s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0516617 Vali Loss: 0.0531040 Test Loss: 0.0595510
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0517732
	speed: 0.0640s/iter; left time: 696.2413s
	iters: 200, epoch: 52 | loss: 0.0523332
	speed: 0.0337s/iter; left time: 363.2735s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0517148 Vali Loss: 0.0530957 Test Loss: 0.0596316
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0531154
	speed: 0.0630s/iter; left time: 671.4200s
	iters: 200, epoch: 53 | loss: 0.0505686
	speed: 0.0339s/iter; left time: 357.8787s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0516867 Vali Loss: 0.0530429 Test Loss: 0.0595754
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.00980827771127224, rmse:0.09903674572706223, mae:0.059513285756111145, rse:0.29145318269729614
Intermediate time for ES and pred_len 24: 00h:16m:11.47s
=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1583152
	speed: 0.0590s/iter; left time: 1315.7724s
	iters: 200, epoch: 1 | loss: 0.1448403
	speed: 0.0342s/iter; left time: 760.0676s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.20s
Steps: 224 | Train Loss: 0.1628648 Vali Loss: 0.1497765 Test Loss: 0.1801975
Validation loss decreased (inf --> 0.149776).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0921436
	speed: 0.0649s/iter; left time: 1432.1076s
	iters: 200, epoch: 2 | loss: 0.0816166
	speed: 0.0347s/iter; left time: 761.7926s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0972727 Vali Loss: 0.0838135 Test Loss: 0.0948474
Validation loss decreased (0.149776 --> 0.083813).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0829061
	speed: 0.0668s/iter; left time: 1460.3469s
	iters: 200, epoch: 3 | loss: 0.0841351
	speed: 0.0345s/iter; left time: 749.5907s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0835706 Vali Loss: 0.0805995 Test Loss: 0.0918064
Validation loss decreased (0.083813 --> 0.080599).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0807449
	speed: 0.0663s/iter; left time: 1434.2795s
	iters: 200, epoch: 4 | loss: 0.0770914
	speed: 0.0342s/iter; left time: 736.5181s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0804804 Vali Loss: 0.0785825 Test Loss: 0.0897993
Validation loss decreased (0.080599 --> 0.078583).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0813333
	speed: 0.0651s/iter; left time: 1394.2855s
	iters: 200, epoch: 5 | loss: 0.0801107
	speed: 0.0341s/iter; left time: 726.4598s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0785711 Vali Loss: 0.0776296 Test Loss: 0.0890472
Validation loss decreased (0.078583 --> 0.077630).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0758659
	speed: 0.0660s/iter; left time: 1397.9019s
	iters: 200, epoch: 6 | loss: 0.0811755
	speed: 0.0345s/iter; left time: 727.8188s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0773020 Vali Loss: 0.0770908 Test Loss: 0.0882573
Validation loss decreased (0.077630 --> 0.077091).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0749255
	speed: 0.0656s/iter; left time: 1374.3857s
	iters: 200, epoch: 7 | loss: 0.0767308
	speed: 0.0346s/iter; left time: 720.6784s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0764460 Vali Loss: 0.0769096 Test Loss: 0.0878721
Validation loss decreased (0.077091 --> 0.076910).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0756682
	speed: 0.0648s/iter; left time: 1342.9008s
	iters: 200, epoch: 8 | loss: 0.0762002
	speed: 0.0345s/iter; left time: 711.2232s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0758666 Vali Loss: 0.0765788 Test Loss: 0.0876366
Validation loss decreased (0.076910 --> 0.076579).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0734542
	speed: 0.0653s/iter; left time: 1339.5656s
	iters: 200, epoch: 9 | loss: 0.0735278
	speed: 0.0346s/iter; left time: 705.7365s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0753596 Vali Loss: 0.0765925 Test Loss: 0.0876100
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0753230
	speed: 0.0652s/iter; left time: 1321.6367s
	iters: 200, epoch: 10 | loss: 0.0781913
	speed: 0.0345s/iter; left time: 696.4015s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0748802 Vali Loss: 0.0762593 Test Loss: 0.0871955
Validation loss decreased (0.076579 --> 0.076259).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0749062
	speed: 0.0653s/iter; left time: 1310.9624s
	iters: 200, epoch: 11 | loss: 0.0777845
	speed: 0.0342s/iter; left time: 683.0836s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0745766 Vali Loss: 0.0759519 Test Loss: 0.0867373
Validation loss decreased (0.076259 --> 0.075952).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0746499
	speed: 0.0650s/iter; left time: 1288.9790s
	iters: 200, epoch: 12 | loss: 0.0707181
	speed: 0.0342s/iter; left time: 674.8921s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0741716 Vali Loss: 0.0759469 Test Loss: 0.0867018
Validation loss decreased (0.075952 --> 0.075947).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0738060
	speed: 0.0646s/iter; left time: 1267.8282s
	iters: 200, epoch: 13 | loss: 0.0733494
	speed: 0.0344s/iter; left time: 672.1472s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0739369 Vali Loss: 0.0760515 Test Loss: 0.0871067
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0706884
	speed: 0.0642s/iter; left time: 1245.0887s
	iters: 200, epoch: 14 | loss: 0.0737723
	speed: 0.0349s/iter; left time: 672.7586s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0736894 Vali Loss: 0.0760189 Test Loss: 0.0869981
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0755268
	speed: 0.0648s/iter; left time: 1242.6854s
	iters: 200, epoch: 15 | loss: 0.0732484
	speed: 0.0343s/iter; left time: 653.0179s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0733935 Vali Loss: 0.0757354 Test Loss: 0.0867739
Validation loss decreased (0.075947 --> 0.075735).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0715213
	speed: 0.0667s/iter; left time: 1263.4738s
	iters: 200, epoch: 16 | loss: 0.0740862
	speed: 0.0342s/iter; left time: 643.8856s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0732062 Vali Loss: 0.0755924 Test Loss: 0.0867386
Validation loss decreased (0.075735 --> 0.075592).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0706640
	speed: 0.0652s/iter; left time: 1219.5419s
	iters: 200, epoch: 17 | loss: 0.0721274
	speed: 0.0343s/iter; left time: 639.0968s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0730183 Vali Loss: 0.0758885 Test Loss: 0.0868945
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0740165
	speed: 0.0639s/iter; left time: 1181.8771s
	iters: 200, epoch: 18 | loss: 0.0715243
	speed: 0.0343s/iter; left time: 630.1533s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0728788 Vali Loss: 0.0759454 Test Loss: 0.0867216
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0722490
	speed: 0.0646s/iter; left time: 1180.8540s
	iters: 200, epoch: 19 | loss: 0.0700200
	speed: 0.0353s/iter; left time: 642.0328s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.07s
Steps: 224 | Train Loss: 0.0728002 Vali Loss: 0.0754850 Test Loss: 0.0865807
Validation loss decreased (0.075592 --> 0.075485).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0729250
	speed: 0.0703s/iter; left time: 1268.5333s
	iters: 200, epoch: 20 | loss: 0.0730267
	speed: 0.0347s/iter; left time: 622.5789s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.11s
Steps: 224 | Train Loss: 0.0726108 Vali Loss: 0.0756786 Test Loss: 0.0865085
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0720294
	speed: 0.0646s/iter; left time: 1151.0404s
	iters: 200, epoch: 21 | loss: 0.0724624
	speed: 0.0342s/iter; left time: 606.3477s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0724719 Vali Loss: 0.0756035 Test Loss: 0.0865330
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0717145
	speed: 0.0643s/iter; left time: 1131.2873s
	iters: 200, epoch: 22 | loss: 0.0705282
	speed: 0.0343s/iter; left time: 600.2867s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0723564 Vali Loss: 0.0755396 Test Loss: 0.0866191
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0681314
	speed: 0.0647s/iter; left time: 1123.2192s
	iters: 200, epoch: 23 | loss: 0.0691133
	speed: 0.0346s/iter; left time: 598.0977s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0722308 Vali Loss: 0.0756375 Test Loss: 0.0867327
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0723156
	speed: 0.0672s/iter; left time: 1152.0120s
	iters: 200, epoch: 24 | loss: 0.0737724
	speed: 0.0393s/iter; left time: 669.8160s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.84s
Steps: 224 | Train Loss: 0.0722322 Vali Loss: 0.0753499 Test Loss: 0.0864964
Validation loss decreased (0.075485 --> 0.075350).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0734103
	speed: 0.0675s/iter; left time: 1143.0537s
	iters: 200, epoch: 25 | loss: 0.0698764
	speed: 0.0355s/iter; left time: 596.6023s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.28s
Steps: 224 | Train Loss: 0.0721284 Vali Loss: 0.0755213 Test Loss: 0.0866127
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0749125
	speed: 0.0656s/iter; left time: 1095.3208s
	iters: 200, epoch: 26 | loss: 0.0681941
	speed: 0.0367s/iter; left time: 609.6762s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:08.18s
Steps: 224 | Train Loss: 0.0720451 Vali Loss: 0.0755095 Test Loss: 0.0866491
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0748759
	speed: 0.0644s/iter; left time: 1060.3908s
	iters: 200, epoch: 27 | loss: 0.0692100
	speed: 0.0344s/iter; left time: 563.7156s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0719510 Vali Loss: 0.0755535 Test Loss: 0.0866617
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0701714
	speed: 0.0641s/iter; left time: 1042.6154s
	iters: 200, epoch: 28 | loss: 0.0740284
	speed: 0.0348s/iter; left time: 562.0250s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0718891 Vali Loss: 0.0755887 Test Loss: 0.0867537
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0725884
	speed: 0.0644s/iter; left time: 1032.7483s
	iters: 200, epoch: 29 | loss: 0.0677367
	speed: 0.0345s/iter; left time: 549.8622s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0718561 Vali Loss: 0.0753443 Test Loss: 0.0863624
Validation loss decreased (0.075350 --> 0.075344).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0719654
	speed: 0.0651s/iter; left time: 1028.8544s
	iters: 200, epoch: 30 | loss: 0.0742018
	speed: 0.0347s/iter; left time: 544.6679s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0718349 Vali Loss: 0.0753530 Test Loss: 0.0864401
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0718995
	speed: 0.0645s/iter; left time: 1004.7464s
	iters: 200, epoch: 31 | loss: 0.0726714
	speed: 0.0344s/iter; left time: 531.9041s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0716989 Vali Loss: 0.0755160 Test Loss: 0.0866547
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0725034
	speed: 0.0642s/iter; left time: 985.9795s
	iters: 200, epoch: 32 | loss: 0.0703748
	speed: 0.0345s/iter; left time: 525.6965s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0716934 Vali Loss: 0.0754083 Test Loss: 0.0864467
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0715083
	speed: 0.0644s/iter; left time: 974.0109s
	iters: 200, epoch: 33 | loss: 0.0704834
	speed: 0.0345s/iter; left time: 518.4390s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0716789 Vali Loss: 0.0755103 Test Loss: 0.0866822
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0697350
	speed: 0.0645s/iter; left time: 961.4561s
	iters: 200, epoch: 34 | loss: 0.0721267
	speed: 0.0343s/iter; left time: 508.4351s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0716551 Vali Loss: 0.0756040 Test Loss: 0.0869137
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0750437
	speed: 0.0651s/iter; left time: 955.7285s
	iters: 200, epoch: 35 | loss: 0.0722882
	speed: 0.0345s/iter; left time: 502.5394s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0716405 Vali Loss: 0.0754976 Test Loss: 0.0866905
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0708376
	speed: 0.0635s/iter; left time: 918.7989s
	iters: 200, epoch: 36 | loss: 0.0717003
	speed: 0.0342s/iter; left time: 491.7724s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0715762 Vali Loss: 0.0754502 Test Loss: 0.0866363
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0710196
	speed: 0.0658s/iter; left time: 937.1543s
	iters: 200, epoch: 37 | loss: 0.0715786
	speed: 0.0345s/iter; left time: 488.3489s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0715935 Vali Loss: 0.0754666 Test Loss: 0.0865808
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0731768
	speed: 0.0644s/iter; left time: 902.1619s
	iters: 200, epoch: 38 | loss: 0.0697412
	speed: 0.0349s/iter; left time: 485.1953s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0715302 Vali Loss: 0.0754760 Test Loss: 0.0866731
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0720512
	speed: 0.0649s/iter; left time: 894.4278s
	iters: 200, epoch: 39 | loss: 0.0706587
	speed: 0.0342s/iter; left time: 468.5931s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0715180 Vali Loss: 0.0755162 Test Loss: 0.0867972
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.0185981597751379, rmse:0.1363750696182251, mae:0.08636235445737839, rse:0.4006288945674896
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1582830
	speed: 0.0364s/iter; left time: 811.4456s
	iters: 200, epoch: 1 | loss: 0.1536793
	speed: 0.0348s/iter; left time: 773.0827s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.1618317 Vali Loss: 0.1495777 Test Loss: 0.1801662
Validation loss decreased (inf --> 0.149578).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0939178
	speed: 0.0676s/iter; left time: 1492.5444s
	iters: 200, epoch: 2 | loss: 0.0864733
	speed: 0.0343s/iter; left time: 754.0109s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0985453 Vali Loss: 0.0839609 Test Loss: 0.0956050
Validation loss decreased (0.149578 --> 0.083961).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0878430
	speed: 0.0650s/iter; left time: 1421.2057s
	iters: 200, epoch: 3 | loss: 0.0782254
	speed: 0.0343s/iter; left time: 746.3160s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0840291 Vali Loss: 0.0807863 Test Loss: 0.0920472
Validation loss decreased (0.083961 --> 0.080786).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0836028
	speed: 0.0667s/iter; left time: 1443.3118s
	iters: 200, epoch: 4 | loss: 0.0806706
	speed: 0.0344s/iter; left time: 740.8030s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0807939 Vali Loss: 0.0788258 Test Loss: 0.0900378
Validation loss decreased (0.080786 --> 0.078826).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0788435
	speed: 0.0668s/iter; left time: 1429.3499s
	iters: 200, epoch: 5 | loss: 0.0807367
	speed: 0.0344s/iter; left time: 732.5102s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0788217 Vali Loss: 0.0780139 Test Loss: 0.0892532
Validation loss decreased (0.078826 --> 0.078014).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0773067
	speed: 0.0666s/iter; left time: 1410.2190s
	iters: 200, epoch: 6 | loss: 0.0772312
	speed: 0.0343s/iter; left time: 723.9274s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0775746 Vali Loss: 0.0777914 Test Loss: 0.0886277
Validation loss decreased (0.078014 --> 0.077791).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0767768
	speed: 0.0656s/iter; left time: 1375.0271s
	iters: 200, epoch: 7 | loss: 0.0746151
	speed: 0.0344s/iter; left time: 718.3594s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0767128 Vali Loss: 0.0770210 Test Loss: 0.0880919
Validation loss decreased (0.077791 --> 0.077021).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0772053
	speed: 0.0660s/iter; left time: 1368.8719s
	iters: 200, epoch: 8 | loss: 0.0728543
	speed: 0.0344s/iter; left time: 708.8748s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0759991 Vali Loss: 0.0769128 Test Loss: 0.0879381
Validation loss decreased (0.077021 --> 0.076913).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0746797
	speed: 0.0672s/iter; left time: 1378.6858s
	iters: 200, epoch: 9 | loss: 0.0793813
	speed: 0.0348s/iter; left time: 711.1650s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.08s
Steps: 224 | Train Loss: 0.0754255 Vali Loss: 0.0765287 Test Loss: 0.0876836
Validation loss decreased (0.076913 --> 0.076529).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0778281
	speed: 0.0663s/iter; left time: 1345.0732s
	iters: 200, epoch: 10 | loss: 0.0760081
	speed: 0.0344s/iter; left time: 695.0386s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0749424 Vali Loss: 0.0765791 Test Loss: 0.0876946
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0761849
	speed: 0.0648s/iter; left time: 1300.8232s
	iters: 200, epoch: 11 | loss: 0.0759281
	speed: 0.0346s/iter; left time: 691.4679s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0745479 Vali Loss: 0.0765141 Test Loss: 0.0871809
Validation loss decreased (0.076529 --> 0.076514).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0740213
	speed: 0.0666s/iter; left time: 1321.0962s
	iters: 200, epoch: 12 | loss: 0.0729842
	speed: 0.0344s/iter; left time: 678.7113s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0742243 Vali Loss: 0.0766330 Test Loss: 0.0873586
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0739172
	speed: 0.0649s/iter; left time: 1273.3946s
	iters: 200, epoch: 13 | loss: 0.0755008
	speed: 0.0345s/iter; left time: 672.4258s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0739385 Vali Loss: 0.0763564 Test Loss: 0.0872647
Validation loss decreased (0.076514 --> 0.076356).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0703849
	speed: 0.0656s/iter; left time: 1272.8350s
	iters: 200, epoch: 14 | loss: 0.0713772
	speed: 0.0343s/iter; left time: 662.5630s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0736357 Vali Loss: 0.0765072 Test Loss: 0.0869802
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0685526
	speed: 0.0653s/iter; left time: 1252.1004s
	iters: 200, epoch: 15 | loss: 0.0744490
	speed: 0.0346s/iter; left time: 660.5611s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0733645 Vali Loss: 0.0765096 Test Loss: 0.0869906
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0745860
	speed: 0.0646s/iter; left time: 1223.7277s
	iters: 200, epoch: 16 | loss: 0.0714565
	speed: 0.0341s/iter; left time: 642.0158s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0731870 Vali Loss: 0.0763907 Test Loss: 0.0867740
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0767808
	speed: 0.0648s/iter; left time: 1212.7443s
	iters: 200, epoch: 17 | loss: 0.0734670
	speed: 0.0343s/iter; left time: 638.6161s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0729853 Vali Loss: 0.0765046 Test Loss: 0.0869768
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0747071
	speed: 0.0653s/iter; left time: 1207.1564s
	iters: 200, epoch: 18 | loss: 0.0728723
	speed: 0.0345s/iter; left time: 635.3889s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0727439 Vali Loss: 0.0765303 Test Loss: 0.0870398
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0708978
	speed: 0.0651s/iter; left time: 1190.1975s
	iters: 200, epoch: 19 | loss: 0.0723809
	speed: 0.0350s/iter; left time: 635.0696s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0725793 Vali Loss: 0.0764471 Test Loss: 0.0870042
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0734421
	speed: 0.0665s/iter; left time: 1200.1180s
	iters: 200, epoch: 20 | loss: 0.0769663
	speed: 0.0344s/iter; left time: 617.9313s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0725307 Vali Loss: 0.0765048 Test Loss: 0.0870345
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0716774
	speed: 0.0657s/iter; left time: 1170.1201s
	iters: 200, epoch: 21 | loss: 0.0718850
	speed: 0.0343s/iter; left time: 607.0500s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0723870 Vali Loss: 0.0766452 Test Loss: 0.0869602
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0720396
	speed: 0.0660s/iter; left time: 1161.1070s
	iters: 200, epoch: 22 | loss: 0.0696126
	speed: 0.0343s/iter; left time: 600.0298s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0722414 Vali Loss: 0.0765089 Test Loss: 0.0867656
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0730018
	speed: 0.0653s/iter; left time: 1134.6921s
	iters: 200, epoch: 23 | loss: 0.0753521
	speed: 0.0345s/iter; left time: 595.4149s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0721670 Vali Loss: 0.0766542 Test Loss: 0.0870228
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018632538616657257, rmse:0.13650105893611908, mae:0.08726463466882706, rse:0.4009990394115448
Intermediate time for ES and pred_len 96: 00h:10m:32.65s
=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1581242
	speed: 0.0630s/iter; left time: 1398.1511s
	iters: 200, epoch: 1 | loss: 0.1507171
	speed: 0.0350s/iter; left time: 773.2666s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.38s
Steps: 223 | Train Loss: 0.1638708 Vali Loss: 0.1523550 Test Loss: 0.1819388
Validation loss decreased (inf --> 0.152355).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0986643
	speed: 0.0665s/iter; left time: 1460.6345s
	iters: 200, epoch: 2 | loss: 0.0934433
	speed: 0.0348s/iter; left time: 761.0845s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.1013446 Vali Loss: 0.0890421 Test Loss: 0.1011388
Validation loss decreased (0.152355 --> 0.089042).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0940395
	speed: 0.0650s/iter; left time: 1414.3198s
	iters: 200, epoch: 3 | loss: 0.0868575
	speed: 0.0350s/iter; left time: 757.7458s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0888059 Vali Loss: 0.0860402 Test Loss: 0.0980579
Validation loss decreased (0.089042 --> 0.086040).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0851304
	speed: 0.0664s/iter; left time: 1429.6060s
	iters: 200, epoch: 4 | loss: 0.0841597
	speed: 0.0352s/iter; left time: 755.3775s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.12s
Steps: 223 | Train Loss: 0.0857711 Vali Loss: 0.0841981 Test Loss: 0.0959112
Validation loss decreased (0.086040 --> 0.084198).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0825492
	speed: 0.0656s/iter; left time: 1396.8516s
	iters: 200, epoch: 5 | loss: 0.0825241
	speed: 0.0349s/iter; left time: 740.3545s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0838901 Vali Loss: 0.0835975 Test Loss: 0.0951364
Validation loss decreased (0.084198 --> 0.083597).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0831312
	speed: 0.0659s/iter; left time: 1390.0068s
	iters: 200, epoch: 6 | loss: 0.0821218
	speed: 0.0347s/iter; left time: 727.3247s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0827609 Vali Loss: 0.0835203 Test Loss: 0.0949269
Validation loss decreased (0.083597 --> 0.083520).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0847962
	speed: 0.0659s/iter; left time: 1374.9758s
	iters: 200, epoch: 7 | loss: 0.0801695
	speed: 0.0348s/iter; left time: 722.5295s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0820128 Vali Loss: 0.0828906 Test Loss: 0.0942042
Validation loss decreased (0.083520 --> 0.082891).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0826582
	speed: 0.0663s/iter; left time: 1368.6312s
	iters: 200, epoch: 8 | loss: 0.0829372
	speed: 0.0352s/iter; left time: 722.6593s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0813807 Vali Loss: 0.0829064 Test Loss: 0.0940305
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0785602
	speed: 0.0652s/iter; left time: 1331.3931s
	iters: 200, epoch: 9 | loss: 0.0813846
	speed: 0.0354s/iter; left time: 719.0891s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0808702 Vali Loss: 0.0826419 Test Loss: 0.0939117
Validation loss decreased (0.082891 --> 0.082642).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0784310
	speed: 0.0663s/iter; left time: 1338.8498s
	iters: 200, epoch: 10 | loss: 0.0772360
	speed: 0.0350s/iter; left time: 703.1731s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0803654 Vali Loss: 0.0824731 Test Loss: 0.0937046
Validation loss decreased (0.082642 --> 0.082473).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0798821
	speed: 0.0665s/iter; left time: 1328.1396s
	iters: 200, epoch: 11 | loss: 0.0784780
	speed: 0.0348s/iter; left time: 691.3370s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0799386 Vali Loss: 0.0822538 Test Loss: 0.0935915
Validation loss decreased (0.082473 --> 0.082254).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0809544
	speed: 0.0666s/iter; left time: 1315.2420s
	iters: 200, epoch: 12 | loss: 0.0804690
	speed: 0.0348s/iter; left time: 684.4643s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.09s
Steps: 223 | Train Loss: 0.0795472 Vali Loss: 0.0822670 Test Loss: 0.0936214
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0796984
	speed: 0.0646s/iter; left time: 1260.7374s
	iters: 200, epoch: 13 | loss: 0.0766402
	speed: 0.0346s/iter; left time: 672.7460s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0792191 Vali Loss: 0.0818180 Test Loss: 0.0939182
Validation loss decreased (0.082254 --> 0.081818).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0797491
	speed: 0.0659s/iter; left time: 1272.3367s
	iters: 200, epoch: 14 | loss: 0.0768970
	speed: 0.0353s/iter; left time: 677.9128s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.13s
Steps: 223 | Train Loss: 0.0789267 Vali Loss: 0.0818768 Test Loss: 0.0939726
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0793521
	speed: 0.0649s/iter; left time: 1238.7376s
	iters: 200, epoch: 15 | loss: 0.0760051
	speed: 0.0348s/iter; left time: 660.7859s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0786685 Vali Loss: 0.0820166 Test Loss: 0.0940066
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0786998
	speed: 0.0647s/iter; left time: 1220.3448s
	iters: 200, epoch: 16 | loss: 0.0790844
	speed: 0.0347s/iter; left time: 650.7348s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0784924 Vali Loss: 0.0818277 Test Loss: 0.0944564
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0776468
	speed: 0.0649s/iter; left time: 1209.4681s
	iters: 200, epoch: 17 | loss: 0.0762781
	speed: 0.0349s/iter; left time: 646.4701s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0782404 Vali Loss: 0.0818648 Test Loss: 0.0947103
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0797928
	speed: 0.0645s/iter; left time: 1187.7365s
	iters: 200, epoch: 18 | loss: 0.0767054
	speed: 0.0347s/iter; left time: 636.0733s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0780503 Vali Loss: 0.0820865 Test Loss: 0.0952556
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0800530
	speed: 0.0650s/iter; left time: 1183.0390s
	iters: 200, epoch: 19 | loss: 0.0773672
	speed: 0.0347s/iter; left time: 627.5183s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0779013 Vali Loss: 0.0819001 Test Loss: 0.0952660
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0764023
	speed: 0.0641s/iter; left time: 1151.3233s
	iters: 200, epoch: 20 | loss: 0.0789287
	speed: 0.0352s/iter; left time: 628.0481s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0777259 Vali Loss: 0.0817606 Test Loss: 0.0951863
Validation loss decreased (0.081818 --> 0.081761).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0766384
	speed: 0.0668s/iter; left time: 1184.6482s
	iters: 200, epoch: 21 | loss: 0.0782197
	speed: 0.0350s/iter; left time: 618.2103s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0775856 Vali Loss: 0.0819180 Test Loss: 0.0953271
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0756970
	speed: 0.0649s/iter; left time: 1136.2370s
	iters: 200, epoch: 22 | loss: 0.0782074
	speed: 0.0351s/iter; left time: 612.1815s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0774701 Vali Loss: 0.0816166 Test Loss: 0.0955943
Validation loss decreased (0.081761 --> 0.081617).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0767044
	speed: 0.0674s/iter; left time: 1166.2206s
	iters: 200, epoch: 23 | loss: 0.0780989
	speed: 0.0359s/iter; left time: 616.7085s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.16s
Steps: 223 | Train Loss: 0.0773348 Vali Loss: 0.0818224 Test Loss: 0.0957033
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0800862
	speed: 0.0653s/iter; left time: 1113.9552s
	iters: 200, epoch: 24 | loss: 0.0712628
	speed: 0.0350s/iter; left time: 593.2079s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0772094 Vali Loss: 0.0816642 Test Loss: 0.0957151
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0788048
	speed: 0.0663s/iter; left time: 1117.1215s
	iters: 200, epoch: 25 | loss: 0.0728152
	speed: 0.0351s/iter; left time: 587.2085s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.10s
Steps: 223 | Train Loss: 0.0771515 Vali Loss: 0.0817642 Test Loss: 0.0957897
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0781624
	speed: 0.0663s/iter; left time: 1102.8555s
	iters: 200, epoch: 26 | loss: 0.0739947
	speed: 0.0347s/iter; left time: 574.0256s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0770992 Vali Loss: 0.0816698 Test Loss: 0.0958092
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0785158
	speed: 0.0649s/iter; left time: 1064.3347s
	iters: 200, epoch: 27 | loss: 0.0776058
	speed: 0.0347s/iter; left time: 565.2099s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0770031 Vali Loss: 0.0817289 Test Loss: 0.0957823
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0762650
	speed: 0.0653s/iter; left time: 1057.1673s
	iters: 200, epoch: 28 | loss: 0.0730262
	speed: 0.0354s/iter; left time: 568.6214s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0769375 Vali Loss: 0.0817190 Test Loss: 0.0960716
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0779013
	speed: 0.0659s/iter; left time: 1050.9776s
	iters: 200, epoch: 29 | loss: 0.0780241
	speed: 0.0350s/iter; left time: 555.0852s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:08.11s
Steps: 223 | Train Loss: 0.0768650 Vali Loss: 0.0818699 Test Loss: 0.0961976
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0775625
	speed: 0.0642s/iter; left time: 1010.3148s
	iters: 200, epoch: 30 | loss: 0.0751118
	speed: 0.0346s/iter; left time: 540.3673s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0768085 Vali Loss: 0.0818688 Test Loss: 0.0963391
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0737045
	speed: 0.0643s/iter; left time: 997.6590s
	iters: 200, epoch: 31 | loss: 0.0770995
	speed: 0.0354s/iter; left time: 545.2687s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0767635 Vali Loss: 0.0816762 Test Loss: 0.0960850
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0781929
	speed: 0.0646s/iter; left time: 986.8986s
	iters: 200, epoch: 32 | loss: 0.0797998
	speed: 0.0348s/iter; left time: 528.8135s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0767546 Vali Loss: 0.0817475 Test Loss: 0.0963959
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02126566879451275, rmse:0.1458275318145752, mae:0.0955943912267685, rse:0.42842817306518555
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1622073
	speed: 0.0371s/iter; left time: 822.8089s
	iters: 200, epoch: 1 | loss: 0.1511776
	speed: 0.0350s/iter; left time: 773.7123s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.1635544 Vali Loss: 0.1513875 Test Loss: 0.1804619
Validation loss decreased (inf --> 0.151388).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0963681
	speed: 0.0682s/iter; left time: 1497.8571s
	iters: 200, epoch: 2 | loss: 0.0897276
	speed: 0.0349s/iter; left time: 762.4773s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.10s
Steps: 223 | Train Loss: 0.1009506 Vali Loss: 0.0887425 Test Loss: 0.1008672
Validation loss decreased (0.151388 --> 0.088743).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0909871
	speed: 0.0676s/iter; left time: 1470.1090s
	iters: 200, epoch: 3 | loss: 0.0840339
	speed: 0.0362s/iter; left time: 784.7153s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.19s
Steps: 223 | Train Loss: 0.0886917 Vali Loss: 0.0861339 Test Loss: 0.0982522
Validation loss decreased (0.088743 --> 0.086134).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0863238
	speed: 0.0671s/iter; left time: 1444.2573s
	iters: 200, epoch: 4 | loss: 0.0863077
	speed: 0.0350s/iter; left time: 749.9455s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0857665 Vali Loss: 0.0844378 Test Loss: 0.0962862
Validation loss decreased (0.086134 --> 0.084438).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0852887
	speed: 0.0672s/iter; left time: 1432.6733s
	iters: 200, epoch: 5 | loss: 0.0826804
	speed: 0.0346s/iter; left time: 733.8268s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0839180 Vali Loss: 0.0839240 Test Loss: 0.0957661
Validation loss decreased (0.084438 --> 0.083924).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0836342
	speed: 0.0671s/iter; left time: 1414.6025s
	iters: 200, epoch: 6 | loss: 0.0806390
	speed: 0.0348s/iter; left time: 730.6954s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0828160 Vali Loss: 0.0837571 Test Loss: 0.0950037
Validation loss decreased (0.083924 --> 0.083757).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0857420
	speed: 0.0674s/iter; left time: 1405.2264s
	iters: 200, epoch: 7 | loss: 0.0848666
	speed: 0.0347s/iter; left time: 720.2573s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0820557 Vali Loss: 0.0831144 Test Loss: 0.0942615
Validation loss decreased (0.083757 --> 0.083114).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0834368
	speed: 0.0689s/iter; left time: 1422.0157s
	iters: 200, epoch: 8 | loss: 0.0797058
	speed: 0.0348s/iter; left time: 714.0920s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0814393 Vali Loss: 0.0832333 Test Loss: 0.0942153
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0792525
	speed: 0.0663s/iter; left time: 1352.6476s
	iters: 200, epoch: 9 | loss: 0.0831456
	speed: 0.0348s/iter; left time: 707.7840s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0809265 Vali Loss: 0.0834103 Test Loss: 0.0940458
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0839281
	speed: 0.0674s/iter; left time: 1361.9193s
	iters: 200, epoch: 10 | loss: 0.0820906
	speed: 0.0355s/iter; left time: 713.2553s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.22s
Steps: 223 | Train Loss: 0.0804400 Vali Loss: 0.0831343 Test Loss: 0.0936590
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0800651
	speed: 0.0664s/iter; left time: 1327.0249s
	iters: 200, epoch: 11 | loss: 0.0795596
	speed: 0.0359s/iter; left time: 713.8801s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.14s
Steps: 223 | Train Loss: 0.0799918 Vali Loss: 0.0829600 Test Loss: 0.0931671
Validation loss decreased (0.083114 --> 0.082960).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0811823
	speed: 0.0672s/iter; left time: 1327.9084s
	iters: 200, epoch: 12 | loss: 0.0830218
	speed: 0.0348s/iter; left time: 683.5517s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0796409 Vali Loss: 0.0829638 Test Loss: 0.0932920
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0763461
	speed: 0.0670s/iter; left time: 1309.0778s
	iters: 200, epoch: 13 | loss: 0.0818228
	speed: 0.0361s/iter; left time: 700.3493s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.20s
Steps: 223 | Train Loss: 0.0793178 Vali Loss: 0.0828459 Test Loss: 0.0931148
Validation loss decreased (0.082960 --> 0.082846).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0800062
	speed: 0.0693s/iter; left time: 1337.6314s
	iters: 200, epoch: 14 | loss: 0.0819832
	speed: 0.0354s/iter; left time: 679.0999s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.31s
Steps: 223 | Train Loss: 0.0789994 Vali Loss: 0.0825182 Test Loss: 0.0933117
Validation loss decreased (0.082846 --> 0.082518).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0812188
	speed: 0.0686s/iter; left time: 1309.6940s
	iters: 200, epoch: 15 | loss: 0.0769876
	speed: 0.0349s/iter; left time: 663.2349s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.10s
Steps: 223 | Train Loss: 0.0787149 Vali Loss: 0.0826182 Test Loss: 0.0934537
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0786891
	speed: 0.0663s/iter; left time: 1249.6553s
	iters: 200, epoch: 16 | loss: 0.0829321
	speed: 0.0345s/iter; left time: 647.3484s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0785222 Vali Loss: 0.0824578 Test Loss: 0.0933246
Validation loss decreased (0.082518 --> 0.082458).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0766105
	speed: 0.0677s/iter; left time: 1260.6527s
	iters: 200, epoch: 17 | loss: 0.0775430
	speed: 0.0347s/iter; left time: 643.4154s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0782164 Vali Loss: 0.0823364 Test Loss: 0.0936304
Validation loss decreased (0.082458 --> 0.082336).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0737783
	speed: 0.0674s/iter; left time: 1240.6921s
	iters: 200, epoch: 18 | loss: 0.0795119
	speed: 0.0345s/iter; left time: 632.3278s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0780388 Vali Loss: 0.0823434 Test Loss: 0.0939227
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0779562
	speed: 0.0665s/iter; left time: 1209.5024s
	iters: 200, epoch: 19 | loss: 0.0744572
	speed: 0.0346s/iter; left time: 625.9008s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0778180 Vali Loss: 0.0823256 Test Loss: 0.0938507
Validation loss decreased (0.082336 --> 0.082326).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0811709
	speed: 0.0667s/iter; left time: 1198.8429s
	iters: 200, epoch: 20 | loss: 0.0786681
	speed: 0.0347s/iter; left time: 619.0352s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0775951 Vali Loss: 0.0823114 Test Loss: 0.0941019
Validation loss decreased (0.082326 --> 0.082311).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0748576
	speed: 0.0672s/iter; left time: 1192.0376s
	iters: 200, epoch: 21 | loss: 0.0787515
	speed: 0.0346s/iter; left time: 609.5680s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0774586 Vali Loss: 0.0820314 Test Loss: 0.0940175
Validation loss decreased (0.082311 --> 0.082031).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0802003
	speed: 0.0675s/iter; left time: 1183.2490s
	iters: 200, epoch: 22 | loss: 0.0754237
	speed: 0.0349s/iter; left time: 607.2937s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0773000 Vali Loss: 0.0820159 Test Loss: 0.0942531
Validation loss decreased (0.082031 --> 0.082016).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0779743
	speed: 0.0677s/iter; left time: 1171.6439s
	iters: 200, epoch: 23 | loss: 0.0747215
	speed: 0.0346s/iter; left time: 594.9294s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.10s
Steps: 223 | Train Loss: 0.0772234 Vali Loss: 0.0822244 Test Loss: 0.0947550
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0775924
	speed: 0.0677s/iter; left time: 1154.9276s
	iters: 200, epoch: 24 | loss: 0.0774336
	speed: 0.0345s/iter; left time: 585.6178s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0770066 Vali Loss: 0.0819901 Test Loss: 0.0946638
Validation loss decreased (0.082016 --> 0.081990).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0765772
	speed: 0.0681s/iter; left time: 1147.0967s
	iters: 200, epoch: 25 | loss: 0.0774296
	speed: 0.0351s/iter; left time: 587.2769s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.09s
Steps: 223 | Train Loss: 0.0769184 Vali Loss: 0.0818508 Test Loss: 0.0945564
Validation loss decreased (0.081990 --> 0.081851).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0752274
	speed: 0.0680s/iter; left time: 1131.3903s
	iters: 200, epoch: 26 | loss: 0.0780611
	speed: 0.0353s/iter; left time: 583.5845s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:08.14s
Steps: 223 | Train Loss: 0.0768677 Vali Loss: 0.0820124 Test Loss: 0.0949415
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0767367
	speed: 0.0657s/iter; left time: 1077.5556s
	iters: 200, epoch: 27 | loss: 0.0761459
	speed: 0.0345s/iter; left time: 562.0168s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0767765 Vali Loss: 0.0820813 Test Loss: 0.0948841
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0743221
	speed: 0.0661s/iter; left time: 1069.9981s
	iters: 200, epoch: 28 | loss: 0.0752958
	speed: 0.0345s/iter; left time: 554.8820s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0767860 Vali Loss: 0.0819307 Test Loss: 0.0946716
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0782983
	speed: 0.0670s/iter; left time: 1069.5213s
	iters: 200, epoch: 29 | loss: 0.0778854
	speed: 0.0349s/iter; left time: 553.5048s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:08.13s
Steps: 223 | Train Loss: 0.0766185 Vali Loss: 0.0818122 Test Loss: 0.0950429
Validation loss decreased (0.081851 --> 0.081812).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0740042
	speed: 0.0677s/iter; left time: 1065.8825s
	iters: 200, epoch: 30 | loss: 0.0801981
	speed: 0.0350s/iter; left time: 547.0448s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0765305 Vali Loss: 0.0820920 Test Loss: 0.0952042
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0767182
	speed: 0.0665s/iter; left time: 1031.8913s
	iters: 200, epoch: 31 | loss: 0.0758625
	speed: 0.0351s/iter; left time: 540.7807s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.09s
Steps: 223 | Train Loss: 0.0765871 Vali Loss: 0.0818485 Test Loss: 0.0951992
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0781168
	speed: 0.0664s/iter; left time: 1015.8220s
	iters: 200, epoch: 32 | loss: 0.0793877
	speed: 0.0346s/iter; left time: 526.1388s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0764493 Vali Loss: 0.0820237 Test Loss: 0.0955673
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0740315
	speed: 0.0673s/iter; left time: 1013.5381s
	iters: 200, epoch: 33 | loss: 0.0757111
	speed: 0.0351s/iter; left time: 524.7843s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0763936 Vali Loss: 0.0819379 Test Loss: 0.0954416
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0753173
	speed: 0.0661s/iter; left time: 980.3859s
	iters: 200, epoch: 34 | loss: 0.0706699
	speed: 0.0349s/iter; left time: 514.4846s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0763890 Vali Loss: 0.0819006 Test Loss: 0.0955024
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0773871
	speed: 0.0662s/iter; left time: 967.3064s
	iters: 200, epoch: 35 | loss: 0.0741799
	speed: 0.0345s/iter; left time: 500.8015s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0763201 Vali Loss: 0.0818680 Test Loss: 0.0954335
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0785499
	speed: 0.0665s/iter; left time: 957.3399s
	iters: 200, epoch: 36 | loss: 0.0738299
	speed: 0.0347s/iter; left time: 496.5049s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0762440 Vali Loss: 0.0819575 Test Loss: 0.0954877
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0755313
	speed: 0.0661s/iter; left time: 936.3916s
	iters: 200, epoch: 37 | loss: 0.0735468
	speed: 0.0349s/iter; left time: 490.7438s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0762236 Vali Loss: 0.0820155 Test Loss: 0.0955825
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0732269
	speed: 0.0662s/iter; left time: 923.8246s
	iters: 200, epoch: 38 | loss: 0.0770698
	speed: 0.0347s/iter; left time: 480.0003s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0762167 Vali Loss: 0.0818996 Test Loss: 0.0954762
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0765640
	speed: 0.0650s/iter; left time: 892.6714s
	iters: 200, epoch: 39 | loss: 0.0754804
	speed: 0.0345s/iter; left time: 469.8251s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0761922 Vali Loss: 0.0818792 Test Loss: 0.0953627
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02110309898853302, rmse:0.14526905119419098, mae:0.09504284709692001, rse:0.42678743600845337
Intermediate time for ES and pred_len 168: 00h:12m:12.76sIntermediate time for ES: 00h:38m:56.89s
=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1116106
	speed: 0.0593s/iter; left time: 1322.9017s
	iters: 200, epoch: 1 | loss: 0.0999537
	speed: 0.0341s/iter; left time: 758.1575s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.20s
Steps: 224 | Train Loss: 0.1124358 Vali Loss: 0.1140086 Test Loss: 0.1257845
Validation loss decreased (inf --> 0.114009).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0549609
	speed: 0.0642s/iter; left time: 1417.1195s
	iters: 200, epoch: 2 | loss: 0.0493058
	speed: 0.0343s/iter; left time: 752.8627s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0611678 Vali Loss: 0.0598257 Test Loss: 0.0630514
Validation loss decreased (0.114009 --> 0.059826).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0481192
	speed: 0.0647s/iter; left time: 1413.7064s
	iters: 200, epoch: 3 | loss: 0.0486705
	speed: 0.0340s/iter; left time: 738.6109s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0486903 Vali Loss: 0.0571938 Test Loss: 0.0604145
Validation loss decreased (0.059826 --> 0.057194).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0446055
	speed: 0.0648s/iter; left time: 1401.1282s
	iters: 200, epoch: 4 | loss: 0.0433150
	speed: 0.0340s/iter; left time: 732.6875s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0464468 Vali Loss: 0.0553259 Test Loss: 0.0587835
Validation loss decreased (0.057194 --> 0.055326).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0416506
	speed: 0.0644s/iter; left time: 1378.7821s
	iters: 200, epoch: 5 | loss: 0.0478258
	speed: 0.0339s/iter; left time: 722.4945s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0450221 Vali Loss: 0.0544317 Test Loss: 0.0578488
Validation loss decreased (0.055326 --> 0.054432).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0430584
	speed: 0.0646s/iter; left time: 1368.2821s
	iters: 200, epoch: 6 | loss: 0.0435158
	speed: 0.0340s/iter; left time: 717.5696s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0438523 Vali Loss: 0.0536000 Test Loss: 0.0572354
Validation loss decreased (0.054432 --> 0.053600).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0451543
	speed: 0.0637s/iter; left time: 1335.1167s
	iters: 200, epoch: 7 | loss: 0.0420685
	speed: 0.0340s/iter; left time: 709.9499s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0432100 Vali Loss: 0.0533147 Test Loss: 0.0569039
Validation loss decreased (0.053600 --> 0.053315).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0422426
	speed: 0.0653s/iter; left time: 1354.6848s
	iters: 200, epoch: 8 | loss: 0.0431216
	speed: 0.0342s/iter; left time: 705.7998s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0426419 Vali Loss: 0.0527611 Test Loss: 0.0564472
Validation loss decreased (0.053315 --> 0.052761).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0423509
	speed: 0.0648s/iter; left time: 1329.3455s
	iters: 200, epoch: 9 | loss: 0.0432939
	speed: 0.0340s/iter; left time: 694.4398s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0422622 Vali Loss: 0.0525936 Test Loss: 0.0564336
Validation loss decreased (0.052761 --> 0.052594).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0399028
	speed: 0.0643s/iter; left time: 1303.3671s
	iters: 200, epoch: 10 | loss: 0.0399608
	speed: 0.0341s/iter; left time: 687.5753s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0419118 Vali Loss: 0.0523241 Test Loss: 0.0560268
Validation loss decreased (0.052594 --> 0.052324).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0448097
	speed: 0.0646s/iter; left time: 1295.6634s
	iters: 200, epoch: 11 | loss: 0.0413758
	speed: 0.0340s/iter; left time: 678.3863s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0416651 Vali Loss: 0.0522914 Test Loss: 0.0561402
Validation loss decreased (0.052324 --> 0.052291).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0400997
	speed: 0.0651s/iter; left time: 1291.9483s
	iters: 200, epoch: 12 | loss: 0.0403079
	speed: 0.0341s/iter; left time: 672.0480s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0414033 Vali Loss: 0.0523278 Test Loss: 0.0561529
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0406680
	speed: 0.0641s/iter; left time: 1256.9465s
	iters: 200, epoch: 13 | loss: 0.0439693
	speed: 0.0344s/iter; left time: 671.3764s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0411912 Vali Loss: 0.0521584 Test Loss: 0.0558714
Validation loss decreased (0.052291 --> 0.052158).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0443909
	speed: 0.0641s/iter; left time: 1242.0645s
	iters: 200, epoch: 14 | loss: 0.0410335
	speed: 0.0345s/iter; left time: 665.8426s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0410604 Vali Loss: 0.0520966 Test Loss: 0.0557349
Validation loss decreased (0.052158 --> 0.052097).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0426491
	speed: 0.0653s/iter; left time: 1251.7173s
	iters: 200, epoch: 15 | loss: 0.0410878
	speed: 0.0343s/iter; left time: 653.2763s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0408608 Vali Loss: 0.0522173 Test Loss: 0.0559802
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0420199
	speed: 0.0638s/iter; left time: 1209.2118s
	iters: 200, epoch: 16 | loss: 0.0383129
	speed: 0.0340s/iter; left time: 640.4869s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0408030 Vali Loss: 0.0520518 Test Loss: 0.0557027
Validation loss decreased (0.052097 --> 0.052052).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0373026
	speed: 0.0645s/iter; left time: 1206.6407s
	iters: 200, epoch: 17 | loss: 0.0383360
	speed: 0.0340s/iter; left time: 632.6412s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0406606 Vali Loss: 0.0520363 Test Loss: 0.0557682
Validation loss decreased (0.052052 --> 0.052036).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0412390
	speed: 0.0646s/iter; left time: 1194.6779s
	iters: 200, epoch: 18 | loss: 0.0358473
	speed: 0.0341s/iter; left time: 627.2845s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0405495 Vali Loss: 0.0519978 Test Loss: 0.0555904
Validation loss decreased (0.052036 --> 0.051998).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0373392
	speed: 0.0651s/iter; left time: 1189.3143s
	iters: 200, epoch: 19 | loss: 0.0407665
	speed: 0.0345s/iter; left time: 627.0176s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0404592 Vali Loss: 0.0519362 Test Loss: 0.0555198
Validation loss decreased (0.051998 --> 0.051936).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0412234
	speed: 0.0646s/iter; left time: 1166.0737s
	iters: 200, epoch: 20 | loss: 0.0396656
	speed: 0.0341s/iter; left time: 611.1266s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0403646 Vali Loss: 0.0520998 Test Loss: 0.0556649
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0373310
	speed: 0.0643s/iter; left time: 1146.4092s
	iters: 200, epoch: 21 | loss: 0.0401153
	speed: 0.0340s/iter; left time: 601.6936s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0402911 Vali Loss: 0.0519288 Test Loss: 0.0554669
Validation loss decreased (0.051936 --> 0.051929).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0404831
	speed: 0.0657s/iter; left time: 1156.6298s
	iters: 200, epoch: 22 | loss: 0.0438901
	speed: 0.0339s/iter; left time: 593.6115s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0402111 Vali Loss: 0.0519242 Test Loss: 0.0554432
Validation loss decreased (0.051929 --> 0.051924).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0380333
	speed: 0.0642s/iter; left time: 1115.1035s
	iters: 200, epoch: 23 | loss: 0.0435249
	speed: 0.0340s/iter; left time: 587.2865s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0401183 Vali Loss: 0.0519605 Test Loss: 0.0554244
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0405794
	speed: 0.0631s/iter; left time: 1081.9224s
	iters: 200, epoch: 24 | loss: 0.0401202
	speed: 0.0341s/iter; left time: 580.5751s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0400855 Vali Loss: 0.0518724 Test Loss: 0.0554681
Validation loss decreased (0.051924 --> 0.051872).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0394155
	speed: 0.0644s/iter; left time: 1089.5760s
	iters: 200, epoch: 25 | loss: 0.0379388
	speed: 0.0339s/iter; left time: 570.9058s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0400947 Vali Loss: 0.0518481 Test Loss: 0.0554663
Validation loss decreased (0.051872 --> 0.051848).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0417797
	speed: 0.0650s/iter; left time: 1085.9534s
	iters: 200, epoch: 26 | loss: 0.0404329
	speed: 0.0341s/iter; left time: 566.4458s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0400209 Vali Loss: 0.0519860 Test Loss: 0.0555432
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0387534
	speed: 0.0652s/iter; left time: 1073.6171s
	iters: 200, epoch: 27 | loss: 0.0388816
	speed: 0.0338s/iter; left time: 554.0888s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0399715 Vali Loss: 0.0518692 Test Loss: 0.0553300
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0414896
	speed: 0.0637s/iter; left time: 1035.8004s
	iters: 200, epoch: 28 | loss: 0.0427325
	speed: 0.0340s/iter; left time: 548.5443s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0399775 Vali Loss: 0.0519125 Test Loss: 0.0554073
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0402069
	speed: 0.0631s/iter; left time: 1011.9898s
	iters: 200, epoch: 29 | loss: 0.0397794
	speed: 0.0346s/iter; left time: 551.6192s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0399143 Vali Loss: 0.0517919 Test Loss: 0.0553706
Validation loss decreased (0.051848 --> 0.051792).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0404619
	speed: 0.0659s/iter; left time: 1041.6696s
	iters: 200, epoch: 30 | loss: 0.0417322
	speed: 0.0339s/iter; left time: 533.1483s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0398649 Vali Loss: 0.0519664 Test Loss: 0.0553933
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0404604
	speed: 0.0635s/iter; left time: 988.6864s
	iters: 200, epoch: 31 | loss: 0.0367844
	speed: 0.0339s/iter; left time: 524.6228s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0398406 Vali Loss: 0.0518829 Test Loss: 0.0554485
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0417230
	speed: 0.0627s/iter; left time: 962.9298s
	iters: 200, epoch: 32 | loss: 0.0367436
	speed: 0.0340s/iter; left time: 519.0646s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0398467 Vali Loss: 0.0518404 Test Loss: 0.0554078
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0369080
	speed: 0.0632s/iter; left time: 957.1100s
	iters: 200, epoch: 33 | loss: 0.0412066
	speed: 0.0340s/iter; left time: 511.6876s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0397875 Vali Loss: 0.0518950 Test Loss: 0.0554227
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0421704
	speed: 0.0634s/iter; left time: 945.8384s
	iters: 200, epoch: 34 | loss: 0.0425691
	speed: 0.0340s/iter; left time: 503.1850s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0397469 Vali Loss: 0.0518491 Test Loss: 0.0554131
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0411076
	speed: 0.0635s/iter; left time: 933.2036s
	iters: 200, epoch: 35 | loss: 0.0394340
	speed: 0.0339s/iter; left time: 494.4870s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0397841 Vali Loss: 0.0518472 Test Loss: 0.0553956
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0379899
	speed: 0.0632s/iter; left time: 914.5856s
	iters: 200, epoch: 36 | loss: 0.0464343
	speed: 0.0338s/iter; left time: 486.0098s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0397807 Vali Loss: 0.0518250 Test Loss: 0.0554601
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0436030
	speed: 0.0631s/iter; left time: 898.1131s
	iters: 200, epoch: 37 | loss: 0.0395444
	speed: 0.0339s/iter; left time: 479.1100s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0398131 Vali Loss: 0.0518522 Test Loss: 0.0554317
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0391678
	speed: 0.0633s/iter; left time: 887.1587s
	iters: 200, epoch: 38 | loss: 0.0418203
	speed: 0.0339s/iter; left time: 471.3997s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0397366 Vali Loss: 0.0518405 Test Loss: 0.0553314
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0387209
	speed: 0.0634s/iter; left time: 874.4528s
	iters: 200, epoch: 39 | loss: 0.0396145
	speed: 0.0339s/iter; left time: 463.4650s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0397391 Vali Loss: 0.0518850 Test Loss: 0.0553082
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010155079886317253, rmse:0.1007724180817604, mae:0.055370621383190155, rse:0.3887771964073181
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1094401
	speed: 0.0362s/iter; left time: 807.6698s
	iters: 200, epoch: 1 | loss: 0.1005816
	speed: 0.0338s/iter; left time: 751.3744s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.1106520 Vali Loss: 0.1126437 Test Loss: 0.1250588
Validation loss decreased (inf --> 0.112644).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0544627
	speed: 0.0649s/iter; left time: 1432.8599s
	iters: 200, epoch: 2 | loss: 0.0556115
	speed: 0.0340s/iter; left time: 746.4316s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0617397 Vali Loss: 0.0603577 Test Loss: 0.0636075
Validation loss decreased (0.112644 --> 0.060358).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0505745
	speed: 0.0646s/iter; left time: 1411.1494s
	iters: 200, epoch: 3 | loss: 0.0481833
	speed: 0.0340s/iter; left time: 739.9706s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0490784 Vali Loss: 0.0574146 Test Loss: 0.0607994
Validation loss decreased (0.060358 --> 0.057415).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0464242
	speed: 0.0653s/iter; left time: 1413.3350s
	iters: 200, epoch: 4 | loss: 0.0459194
	speed: 0.0340s/iter; left time: 732.5262s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0467708 Vali Loss: 0.0557457 Test Loss: 0.0591055
Validation loss decreased (0.057415 --> 0.055746).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0451788
	speed: 0.0655s/iter; left time: 1402.5287s
	iters: 200, epoch: 5 | loss: 0.0424137
	speed: 0.0339s/iter; left time: 722.3778s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0452176 Vali Loss: 0.0545432 Test Loss: 0.0581420
Validation loss decreased (0.055746 --> 0.054543).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0388246
	speed: 0.0650s/iter; left time: 1376.0239s
	iters: 200, epoch: 6 | loss: 0.0420071
	speed: 0.0340s/iter; left time: 716.7809s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0442202 Vali Loss: 0.0532858 Test Loss: 0.0572766
Validation loss decreased (0.054543 --> 0.053286).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0463440
	speed: 0.0654s/iter; left time: 1370.6924s
	iters: 200, epoch: 7 | loss: 0.0442682
	speed: 0.0339s/iter; left time: 707.8037s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0434301 Vali Loss: 0.0530425 Test Loss: 0.0569921
Validation loss decreased (0.053286 --> 0.053043).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0456950
	speed: 0.0665s/iter; left time: 1378.4367s
	iters: 200, epoch: 8 | loss: 0.0421521
	speed: 0.0347s/iter; left time: 716.7931s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0428847 Vali Loss: 0.0531325 Test Loss: 0.0566786
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0417287
	speed: 0.0647s/iter; left time: 1325.9924s
	iters: 200, epoch: 9 | loss: 0.0442855
	speed: 0.0342s/iter; left time: 698.3043s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0424366 Vali Loss: 0.0526041 Test Loss: 0.0563456
Validation loss decreased (0.053043 --> 0.052604).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0429612
	speed: 0.0660s/iter; left time: 1338.2909s
	iters: 200, epoch: 10 | loss: 0.0458863
	speed: 0.0339s/iter; left time: 684.6313s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0420584 Vali Loss: 0.0526172 Test Loss: 0.0566575
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0429619
	speed: 0.0638s/iter; left time: 1279.1407s
	iters: 200, epoch: 11 | loss: 0.0428643
	speed: 0.0340s/iter; left time: 678.3812s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0417614 Vali Loss: 0.0522490 Test Loss: 0.0558945
Validation loss decreased (0.052604 --> 0.052249).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0444045
	speed: 0.0663s/iter; left time: 1314.7652s
	iters: 200, epoch: 12 | loss: 0.0396510
	speed: 0.0341s/iter; left time: 672.4310s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0415418 Vali Loss: 0.0523290 Test Loss: 0.0560020
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0381419
	speed: 0.0639s/iter; left time: 1253.6912s
	iters: 200, epoch: 13 | loss: 0.0405829
	speed: 0.0339s/iter; left time: 661.3600s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0413200 Vali Loss: 0.0521626 Test Loss: 0.0557546
Validation loss decreased (0.052249 --> 0.052163).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0425900
	speed: 0.0655s/iter; left time: 1269.4160s
	iters: 200, epoch: 14 | loss: 0.0441515
	speed: 0.0339s/iter; left time: 654.2193s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0411346 Vali Loss: 0.0519422 Test Loss: 0.0557106
Validation loss decreased (0.052163 --> 0.051942).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0393237
	speed: 0.0646s/iter; left time: 1237.9296s
	iters: 200, epoch: 15 | loss: 0.0445696
	speed: 0.0344s/iter; left time: 655.8553s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0410265 Vali Loss: 0.0520698 Test Loss: 0.0555845
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0392608
	speed: 0.0642s/iter; left time: 1215.9841s
	iters: 200, epoch: 16 | loss: 0.0390381
	speed: 0.0339s/iter; left time: 638.7679s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0408100 Vali Loss: 0.0520630 Test Loss: 0.0554447
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0408467
	speed: 0.0639s/iter; left time: 1196.7954s
	iters: 200, epoch: 17 | loss: 0.0394916
	speed: 0.0345s/iter; left time: 642.8564s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0407442 Vali Loss: 0.0520150 Test Loss: 0.0554374
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0407220
	speed: 0.0645s/iter; left time: 1192.2501s
	iters: 200, epoch: 18 | loss: 0.0391960
	speed: 0.0340s/iter; left time: 625.0734s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0405791 Vali Loss: 0.0518669 Test Loss: 0.0553506
Validation loss decreased (0.051942 --> 0.051867).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0418227
	speed: 0.0647s/iter; left time: 1182.3281s
	iters: 200, epoch: 19 | loss: 0.0407169
	speed: 0.0340s/iter; left time: 616.8772s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0405353 Vali Loss: 0.0519316 Test Loss: 0.0553939
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0447454
	speed: 0.0663s/iter; left time: 1196.9953s
	iters: 200, epoch: 20 | loss: 0.0399602
	speed: 0.0347s/iter; left time: 622.0510s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.12s
Steps: 224 | Train Loss: 0.0404139 Vali Loss: 0.0518210 Test Loss: 0.0553704
Validation loss decreased (0.051867 --> 0.051821).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0401816
	speed: 0.0668s/iter; left time: 1190.2473s
	iters: 200, epoch: 21 | loss: 0.0379708
	speed: 0.0346s/iter; left time: 613.8889s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0403843 Vali Loss: 0.0518794 Test Loss: 0.0552368
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0394045
	speed: 0.0647s/iter; left time: 1139.0224s
	iters: 200, epoch: 22 | loss: 0.0403346
	speed: 0.0339s/iter; left time: 594.0014s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0402803 Vali Loss: 0.0517825 Test Loss: 0.0554102
Validation loss decreased (0.051821 --> 0.051782).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0382460
	speed: 0.0679s/iter; left time: 1179.3249s
	iters: 200, epoch: 23 | loss: 0.0375762
	speed: 0.0342s/iter; left time: 590.0077s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0402176 Vali Loss: 0.0517951 Test Loss: 0.0553523
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0401320
	speed: 0.0652s/iter; left time: 1118.0325s
	iters: 200, epoch: 24 | loss: 0.0385567
	speed: 0.0340s/iter; left time: 579.2939s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0401603 Vali Loss: 0.0517928 Test Loss: 0.0553305
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0406993
	speed: 0.0659s/iter; left time: 1115.3775s
	iters: 200, epoch: 25 | loss: 0.0390302
	speed: 0.0342s/iter; left time: 575.0774s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0401084 Vali Loss: 0.0515937 Test Loss: 0.0551319
Validation loss decreased (0.051782 --> 0.051594).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0428648
	speed: 0.0648s/iter; left time: 1081.4468s
	iters: 200, epoch: 26 | loss: 0.0403279
	speed: 0.0340s/iter; left time: 565.1855s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0400728 Vali Loss: 0.0516763 Test Loss: 0.0551821
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0387913
	speed: 0.0647s/iter; left time: 1065.2723s
	iters: 200, epoch: 27 | loss: 0.0396870
	speed: 0.0339s/iter; left time: 554.8977s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0400329 Vali Loss: 0.0517391 Test Loss: 0.0552157
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0412506
	speed: 0.0644s/iter; left time: 1045.9661s
	iters: 200, epoch: 28 | loss: 0.0388730
	speed: 0.0342s/iter; left time: 552.8854s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0399488 Vali Loss: 0.0516464 Test Loss: 0.0551403
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0434460
	speed: 0.0650s/iter; left time: 1042.2943s
	iters: 200, epoch: 29 | loss: 0.0378317
	speed: 0.0339s/iter; left time: 540.3149s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0399308 Vali Loss: 0.0517076 Test Loss: 0.0551429
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0363359
	speed: 0.0661s/iter; left time: 1045.4556s
	iters: 200, epoch: 30 | loss: 0.0391354
	speed: 0.0340s/iter; left time: 533.5865s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0399297 Vali Loss: 0.0516798 Test Loss: 0.0550891
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0417295
	speed: 0.0686s/iter; left time: 1069.6033s
	iters: 200, epoch: 31 | loss: 0.0409997
	speed: 0.0339s/iter; left time: 525.1216s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.16s
Steps: 224 | Train Loss: 0.0398885 Vali Loss: 0.0515366 Test Loss: 0.0550938
Validation loss decreased (0.051594 --> 0.051537).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0421586
	speed: 0.0656s/iter; left time: 1007.4437s
	iters: 200, epoch: 32 | loss: 0.0414021
	speed: 0.0339s/iter; left time: 517.1556s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0399434 Vali Loss: 0.0517420 Test Loss: 0.0551615
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0417471
	speed: 0.0645s/iter; left time: 976.1938s
	iters: 200, epoch: 33 | loss: 0.0378959
	speed: 0.0341s/iter; left time: 512.4632s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0398366 Vali Loss: 0.0516584 Test Loss: 0.0550776
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0419260
	speed: 0.0649s/iter; left time: 967.9931s
	iters: 200, epoch: 34 | loss: 0.0400693
	speed: 0.0340s/iter; left time: 502.8198s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0398225 Vali Loss: 0.0516691 Test Loss: 0.0550839
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0443570
	speed: 0.0651s/iter; left time: 956.1675s
	iters: 200, epoch: 35 | loss: 0.0384875
	speed: 0.0343s/iter; left time: 500.5030s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0398284 Vali Loss: 0.0516524 Test Loss: 0.0551450
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0444361
	speed: 0.0642s/iter; left time: 928.4809s
	iters: 200, epoch: 36 | loss: 0.0367514
	speed: 0.0340s/iter; left time: 487.9621s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0398057 Vali Loss: 0.0515834 Test Loss: 0.0550931
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0442064
	speed: 0.0634s/iter; left time: 902.3862s
	iters: 200, epoch: 37 | loss: 0.0412975
	speed: 0.0340s/iter; left time: 480.7403s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0398019 Vali Loss: 0.0516367 Test Loss: 0.0551290
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0357967
	speed: 0.0655s/iter; left time: 918.0591s
	iters: 200, epoch: 38 | loss: 0.0372386
	speed: 0.0339s/iter; left time: 471.5232s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0397723 Vali Loss: 0.0515989 Test Loss: 0.0550932
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0391088
	speed: 0.0653s/iter; left time: 900.1992s
	iters: 200, epoch: 39 | loss: 0.0371802
	speed: 0.0344s/iter; left time: 470.6175s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0397517 Vali Loss: 0.0516996 Test Loss: 0.0550966
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0400200
	speed: 0.0651s/iter; left time: 883.3657s
	iters: 200, epoch: 40 | loss: 0.0437033
	speed: 0.0339s/iter; left time: 456.5061s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0397919 Vali Loss: 0.0516300 Test Loss: 0.0551088
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0427056
	speed: 0.0655s/iter; left time: 873.8880s
	iters: 200, epoch: 41 | loss: 0.0400225
	speed: 0.0343s/iter; left time: 454.3322s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0397633 Vali Loss: 0.0517601 Test Loss: 0.0551124
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010057547129690647, rmse:0.10028732568025589, mae:0.055093761533498764, rse:0.386905699968338
Intermediate time for FR and pred_len 24: 00h:13m:22.79s
=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1156252
	speed: 0.0604s/iter; left time: 1345.9853s
	iters: 200, epoch: 1 | loss: 0.1060459
	speed: 0.0343s/iter; left time: 761.8394s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.22s
Steps: 224 | Train Loss: 0.1190825 Vali Loss: 0.1222190 Test Loss: 0.1367768
Validation loss decreased (inf --> 0.122219).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0704846
	speed: 0.0676s/iter; left time: 1493.0354s
	iters: 200, epoch: 2 | loss: 0.0632950
	speed: 0.0344s/iter; left time: 756.0345s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0741069 Vali Loss: 0.0766063 Test Loss: 0.0843476
Validation loss decreased (0.122219 --> 0.076606).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0635311
	speed: 0.0748s/iter; left time: 1634.8924s
	iters: 200, epoch: 3 | loss: 0.0638851
	speed: 0.0346s/iter; left time: 753.0099s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0637177 Vali Loss: 0.0739754 Test Loss: 0.0829573
Validation loss decreased (0.076606 --> 0.073975).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0602097
	speed: 0.0689s/iter; left time: 1490.0047s
	iters: 200, epoch: 4 | loss: 0.0603170
	speed: 0.0345s/iter; left time: 742.3865s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0613591 Vali Loss: 0.0727099 Test Loss: 0.0827149
Validation loss decreased (0.073975 --> 0.072710).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0608542
	speed: 0.0668s/iter; left time: 1430.9076s
	iters: 200, epoch: 5 | loss: 0.0596984
	speed: 0.0351s/iter; left time: 748.4870s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.08s
Steps: 224 | Train Loss: 0.0599456 Vali Loss: 0.0722712 Test Loss: 0.0833736
Validation loss decreased (0.072710 --> 0.072271).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0593878
	speed: 0.0673s/iter; left time: 1426.2353s
	iters: 200, epoch: 6 | loss: 0.0608334
	speed: 0.0342s/iter; left time: 721.8281s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0589583 Vali Loss: 0.0716899 Test Loss: 0.0825764
Validation loss decreased (0.072271 --> 0.071690).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0560035
	speed: 0.0691s/iter; left time: 1448.2979s
	iters: 200, epoch: 7 | loss: 0.0553835
	speed: 0.0349s/iter; left time: 728.0453s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.28s
Steps: 224 | Train Loss: 0.0582878 Vali Loss: 0.0717173 Test Loss: 0.0819899
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0581815
	speed: 0.0659s/iter; left time: 1366.7073s
	iters: 200, epoch: 8 | loss: 0.0568370
	speed: 0.0347s/iter; left time: 715.0457s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0577010 Vali Loss: 0.0716664 Test Loss: 0.0823132
Validation loss decreased (0.071690 --> 0.071666).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0548898
	speed: 0.0687s/iter; left time: 1409.4139s
	iters: 200, epoch: 9 | loss: 0.0588697
	speed: 0.0344s/iter; left time: 701.7075s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0572062 Vali Loss: 0.0716870 Test Loss: 0.0822819
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0548872
	speed: 0.0645s/iter; left time: 1307.4689s
	iters: 200, epoch: 10 | loss: 0.0590986
	speed: 0.0343s/iter; left time: 692.5745s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0567653 Vali Loss: 0.0713302 Test Loss: 0.0821311
Validation loss decreased (0.071666 --> 0.071330).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0579021
	speed: 0.0679s/iter; left time: 1362.5119s
	iters: 200, epoch: 11 | loss: 0.0552177
	speed: 0.0341s/iter; left time: 680.9281s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0563869 Vali Loss: 0.0716126 Test Loss: 0.0826249
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0555543
	speed: 0.0667s/iter; left time: 1323.7540s
	iters: 200, epoch: 12 | loss: 0.0536382
	speed: 0.0350s/iter; left time: 690.3991s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.15s
Steps: 224 | Train Loss: 0.0560712 Vali Loss: 0.0713404 Test Loss: 0.0824922
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0569652
	speed: 0.0660s/iter; left time: 1294.0780s
	iters: 200, epoch: 13 | loss: 0.0547314
	speed: 0.0347s/iter; left time: 678.0448s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.09s
Steps: 224 | Train Loss: 0.0557423 Vali Loss: 0.0713660 Test Loss: 0.0824726
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0589291
	speed: 0.0657s/iter; left time: 1273.0113s
	iters: 200, epoch: 14 | loss: 0.0563333
	speed: 0.0345s/iter; left time: 665.0601s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0554690 Vali Loss: 0.0713429 Test Loss: 0.0827610
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0554153
	speed: 0.0651s/iter; left time: 1248.5381s
	iters: 200, epoch: 15 | loss: 0.0534402
	speed: 0.0351s/iter; left time: 669.9150s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.07s
Steps: 224 | Train Loss: 0.0552738 Vali Loss: 0.0714421 Test Loss: 0.0823074
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0558507
	speed: 0.0651s/iter; left time: 1233.1843s
	iters: 200, epoch: 16 | loss: 0.0544727
	speed: 0.0349s/iter; left time: 657.9695s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0550275 Vali Loss: 0.0715380 Test Loss: 0.0824943
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0563965
	speed: 0.0660s/iter; left time: 1234.7593s
	iters: 200, epoch: 17 | loss: 0.0557426
	speed: 0.0348s/iter; left time: 647.5485s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0548346 Vali Loss: 0.0713193 Test Loss: 0.0822374
Validation loss decreased (0.071330 --> 0.071319).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0557317
	speed: 0.0666s/iter; left time: 1231.6848s
	iters: 200, epoch: 18 | loss: 0.0546155
	speed: 0.0342s/iter; left time: 629.2543s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0546819 Vali Loss: 0.0714567 Test Loss: 0.0823589
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0554896
	speed: 0.0652s/iter; left time: 1190.8170s
	iters: 200, epoch: 19 | loss: 0.0566898
	speed: 0.0343s/iter; left time: 622.2937s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0545064 Vali Loss: 0.0715879 Test Loss: 0.0822342
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0555959
	speed: 0.0665s/iter; left time: 1199.1972s
	iters: 200, epoch: 20 | loss: 0.0549557
	speed: 0.0348s/iter; left time: 625.1631s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.08s
Steps: 224 | Train Loss: 0.0543912 Vali Loss: 0.0714636 Test Loss: 0.0820047
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0523533
	speed: 0.0661s/iter; left time: 1177.5761s
	iters: 200, epoch: 21 | loss: 0.0542324
	speed: 0.0343s/iter; left time: 607.0180s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0542423 Vali Loss: 0.0715133 Test Loss: 0.0822591
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0547638
	speed: 0.0656s/iter; left time: 1154.3612s
	iters: 200, epoch: 22 | loss: 0.0534443
	speed: 0.0344s/iter; left time: 601.7239s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0541305 Vali Loss: 0.0715368 Test Loss: 0.0822879
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0543886
	speed: 0.0649s/iter; left time: 1127.2654s
	iters: 200, epoch: 23 | loss: 0.0536552
	speed: 0.0344s/iter; left time: 593.7727s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0540624 Vali Loss: 0.0716271 Test Loss: 0.0821227
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0565382
	speed: 0.0656s/iter; left time: 1124.6657s
	iters: 200, epoch: 24 | loss: 0.0541424
	speed: 0.0343s/iter; left time: 584.1485s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0539107 Vali Loss: 0.0714931 Test Loss: 0.0822808
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0554970
	speed: 0.0655s/iter; left time: 1107.9420s
	iters: 200, epoch: 25 | loss: 0.0549087
	speed: 0.0342s/iter; left time: 575.5909s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0538984 Vali Loss: 0.0715967 Test Loss: 0.0822921
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0516994
	speed: 0.0650s/iter; left time: 1085.5945s
	iters: 200, epoch: 26 | loss: 0.0525186
	speed: 0.0341s/iter; left time: 566.5034s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0537778 Vali Loss: 0.0716958 Test Loss: 0.0822449
EarlyStopping counter: 9 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0538938
	speed: 0.0649s/iter; left time: 1069.1663s
	iters: 200, epoch: 27 | loss: 0.0564168
	speed: 0.0344s/iter; left time: 563.1755s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0537319 Vali Loss: 0.0715339 Test Loss: 0.0823089
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01963534578680992, rmse:0.14012618362903595, mae:0.0822373777627945, rse:0.5420452952384949
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1154160
	speed: 0.0369s/iter; left time: 822.2644s
	iters: 200, epoch: 1 | loss: 0.1075368
	speed: 0.0342s/iter; left time: 758.8033s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.1184687 Vali Loss: 0.1218070 Test Loss: 0.1364096
Validation loss decreased (inf --> 0.121807).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0671379
	speed: 0.0674s/iter; left time: 1488.5667s
	iters: 200, epoch: 2 | loss: 0.0653378
	speed: 0.0345s/iter; left time: 759.2689s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0744347 Vali Loss: 0.0762421 Test Loss: 0.0846303
Validation loss decreased (0.121807 --> 0.076242).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0609564
	speed: 0.0672s/iter; left time: 1468.8353s
	iters: 200, epoch: 3 | loss: 0.0597287
	speed: 0.0349s/iter; left time: 759.4237s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.09s
Steps: 224 | Train Loss: 0.0638290 Vali Loss: 0.0739613 Test Loss: 0.0829957
Validation loss decreased (0.076242 --> 0.073961).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0612373
	speed: 0.0676s/iter; left time: 1462.1886s
	iters: 200, epoch: 4 | loss: 0.0595653
	speed: 0.0346s/iter; left time: 743.9171s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0615989 Vali Loss: 0.0728422 Test Loss: 0.0828065
Validation loss decreased (0.073961 --> 0.072842).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0597562
	speed: 0.0678s/iter; left time: 1452.0248s
	iters: 200, epoch: 5 | loss: 0.0553987
	speed: 0.0346s/iter; left time: 736.4323s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0600575 Vali Loss: 0.0720670 Test Loss: 0.0821896
Validation loss decreased (0.072842 --> 0.072067).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0634054
	speed: 0.0698s/iter; left time: 1478.7075s
	iters: 200, epoch: 6 | loss: 0.0571606
	speed: 0.0347s/iter; left time: 732.1645s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.07s
Steps: 224 | Train Loss: 0.0590135 Vali Loss: 0.0718440 Test Loss: 0.0823829
Validation loss decreased (0.072067 --> 0.071844).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0590718
	speed: 0.0685s/iter; left time: 1435.3223s
	iters: 200, epoch: 7 | loss: 0.0594180
	speed: 0.0342s/iter; left time: 713.2879s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0582545 Vali Loss: 0.0717599 Test Loss: 0.0820033
Validation loss decreased (0.071844 --> 0.071760).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0619572
	speed: 0.0680s/iter; left time: 1410.2946s
	iters: 200, epoch: 8 | loss: 0.0600717
	speed: 0.0345s/iter; left time: 712.2773s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0577964 Vali Loss: 0.0718982 Test Loss: 0.0819674
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0560200
	speed: 0.0658s/iter; left time: 1349.9095s
	iters: 200, epoch: 9 | loss: 0.0540999
	speed: 0.0343s/iter; left time: 699.8930s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0572643 Vali Loss: 0.0718750 Test Loss: 0.0820005
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0550202
	speed: 0.0656s/iter; left time: 1330.6960s
	iters: 200, epoch: 10 | loss: 0.0548419
	speed: 0.0343s/iter; left time: 691.4751s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0568043 Vali Loss: 0.0720056 Test Loss: 0.0818854
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0563849
	speed: 0.0675s/iter; left time: 1354.5707s
	iters: 200, epoch: 11 | loss: 0.0559479
	speed: 0.0341s/iter; left time: 679.7345s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0565039 Vali Loss: 0.0718800 Test Loss: 0.0816959
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0566436
	speed: 0.0665s/iter; left time: 1319.8537s
	iters: 200, epoch: 12 | loss: 0.0577709
	speed: 0.0343s/iter; left time: 677.2418s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0561187 Vali Loss: 0.0717747 Test Loss: 0.0819871
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0572069
	speed: 0.0657s/iter; left time: 1287.8029s
	iters: 200, epoch: 13 | loss: 0.0562036
	speed: 0.0343s/iter; left time: 669.8438s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0558834 Vali Loss: 0.0718664 Test Loss: 0.0820116
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0550445
	speed: 0.0664s/iter; left time: 1288.2498s
	iters: 200, epoch: 14 | loss: 0.0556109
	speed: 0.0346s/iter; left time: 666.5314s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0556139 Vali Loss: 0.0718217 Test Loss: 0.0819398
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0537335
	speed: 0.0649s/iter; left time: 1243.9253s
	iters: 200, epoch: 15 | loss: 0.0527605
	speed: 0.0340s/iter; left time: 649.0799s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0554120 Vali Loss: 0.0716225 Test Loss: 0.0815059
Validation loss decreased (0.071760 --> 0.071622).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0604739
	speed: 0.0668s/iter; left time: 1264.5059s
	iters: 200, epoch: 16 | loss: 0.0552410
	speed: 0.0342s/iter; left time: 645.2052s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0552135 Vali Loss: 0.0717006 Test Loss: 0.0817680
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0567907
	speed: 0.0662s/iter; left time: 1238.6092s
	iters: 200, epoch: 17 | loss: 0.0579164
	speed: 0.0343s/iter; left time: 638.6202s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0550305 Vali Loss: 0.0715534 Test Loss: 0.0811857
Validation loss decreased (0.071622 --> 0.071553).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0576145
	speed: 0.0674s/iter; left time: 1246.4929s
	iters: 200, epoch: 18 | loss: 0.0511277
	speed: 0.0348s/iter; left time: 639.3363s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0548723 Vali Loss: 0.0716544 Test Loss: 0.0812668
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0563549
	speed: 0.0660s/iter; left time: 1205.7830s
	iters: 200, epoch: 19 | loss: 0.0547888
	speed: 0.0342s/iter; left time: 621.9084s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0546784 Vali Loss: 0.0715687 Test Loss: 0.0814313
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0552318
	speed: 0.0652s/iter; left time: 1176.8254s
	iters: 200, epoch: 20 | loss: 0.0549999
	speed: 0.0346s/iter; left time: 620.0799s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0545594 Vali Loss: 0.0717095 Test Loss: 0.0815305
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0532561
	speed: 0.0660s/iter; left time: 1175.4948s
	iters: 200, epoch: 21 | loss: 0.0591274
	speed: 0.0342s/iter; left time: 605.6960s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0544117 Vali Loss: 0.0716369 Test Loss: 0.0813597
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0557993
	speed: 0.0661s/iter; left time: 1163.9386s
	iters: 200, epoch: 22 | loss: 0.0508411
	speed: 0.0342s/iter; left time: 598.7943s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0543858 Vali Loss: 0.0716580 Test Loss: 0.0815713
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0556825
	speed: 0.0673s/iter; left time: 1169.2730s
	iters: 200, epoch: 23 | loss: 0.0515426
	speed: 0.0356s/iter; left time: 614.5950s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.19s
Steps: 224 | Train Loss: 0.0542970 Vali Loss: 0.0717369 Test Loss: 0.0813571
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0522207
	speed: 0.0659s/iter; left time: 1129.9488s
	iters: 200, epoch: 24 | loss: 0.0535139
	speed: 0.0342s/iter; left time: 583.3232s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0541846 Vali Loss: 0.0715603 Test Loss: 0.0812604
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0517692
	speed: 0.0677s/iter; left time: 1145.7009s
	iters: 200, epoch: 25 | loss: 0.0537290
	speed: 0.0342s/iter; left time: 574.6679s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0540874 Vali Loss: 0.0717348 Test Loss: 0.0813865
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0540747
	speed: 0.0656s/iter; left time: 1094.9858s
	iters: 200, epoch: 26 | loss: 0.0552746
	speed: 0.0343s/iter; left time: 568.6464s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0540465 Vali Loss: 0.0716443 Test Loss: 0.0814750
EarlyStopping counter: 9 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0510588
	speed: 0.0672s/iter; left time: 1107.5105s
	iters: 200, epoch: 27 | loss: 0.0515561
	speed: 0.0350s/iter; left time: 573.5724s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:08.17s
Steps: 224 | Train Loss: 0.0539529 Vali Loss: 0.0717339 Test Loss: 0.0817004
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019514502957463264, rmse:0.13969431817531586, mae:0.08118564635515213, rse:0.540374755859375
Intermediate time for FR and pred_len 96: 00h:09m:19.12s
=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1153208
	speed: 0.0603s/iter; left time: 1337.6876s
	iters: 200, epoch: 1 | loss: 0.1100991
	speed: 0.0347s/iter; left time: 767.6555s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.33s
Steps: 223 | Train Loss: 0.1203847 Vali Loss: 0.1246423 Test Loss: 0.1390748
Validation loss decreased (inf --> 0.124642).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0745880
	speed: 0.0673s/iter; left time: 1479.0777s
	iters: 200, epoch: 2 | loss: 0.0722736
	speed: 0.0349s/iter; left time: 762.7939s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0777389 Vali Loss: 0.0799943 Test Loss: 0.0888394
Validation loss decreased (0.124642 --> 0.079994).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0674564
	speed: 0.0664s/iter; left time: 1445.5302s
	iters: 200, epoch: 3 | loss: 0.0637951
	speed: 0.0347s/iter; left time: 751.1428s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0680533 Vali Loss: 0.0776140 Test Loss: 0.0879805
Validation loss decreased (0.079994 --> 0.077614).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0654204
	speed: 0.0672s/iter; left time: 1447.0490s
	iters: 200, epoch: 4 | loss: 0.0639187
	speed: 0.0350s/iter; left time: 749.4370s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0657068 Vali Loss: 0.0768534 Test Loss: 0.0878971
Validation loss decreased (0.077614 --> 0.076853).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0666997
	speed: 0.0666s/iter; left time: 1419.5269s
	iters: 200, epoch: 5 | loss: 0.0655546
	speed: 0.0347s/iter; left time: 735.4110s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0641879 Vali Loss: 0.0760667 Test Loss: 0.0877345
Validation loss decreased (0.076853 --> 0.076067).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0664016
	speed: 0.0668s/iter; left time: 1409.2923s
	iters: 200, epoch: 6 | loss: 0.0615867
	speed: 0.0348s/iter; left time: 730.8152s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0632301 Vali Loss: 0.0757157 Test Loss: 0.0874930
Validation loss decreased (0.076067 --> 0.075716).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0584839
	speed: 0.0656s/iter; left time: 1368.6534s
	iters: 200, epoch: 7 | loss: 0.0630124
	speed: 0.0348s/iter; left time: 722.3418s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0625077 Vali Loss: 0.0755675 Test Loss: 0.0875279
Validation loss decreased (0.075716 --> 0.075568).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0630511
	speed: 0.0660s/iter; left time: 1361.3566s
	iters: 200, epoch: 8 | loss: 0.0623851
	speed: 0.0351s/iter; left time: 719.9735s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0618813 Vali Loss: 0.0757895 Test Loss: 0.0882833
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0657311
	speed: 0.0646s/iter; left time: 1319.1850s
	iters: 200, epoch: 9 | loss: 0.0610993
	speed: 0.0350s/iter; left time: 711.5123s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0613065 Vali Loss: 0.0753160 Test Loss: 0.0877921
Validation loss decreased (0.075568 --> 0.075316).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0575956
	speed: 0.0666s/iter; left time: 1344.8136s
	iters: 200, epoch: 10 | loss: 0.0608523
	speed: 0.0347s/iter; left time: 696.4536s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0608570 Vali Loss: 0.0752572 Test Loss: 0.0885264
Validation loss decreased (0.075316 --> 0.075257).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0602005
	speed: 0.0659s/iter; left time: 1315.2547s
	iters: 200, epoch: 11 | loss: 0.0629922
	speed: 0.0346s/iter; left time: 688.0212s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0604874 Vali Loss: 0.0755354 Test Loss: 0.0883545
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0592349
	speed: 0.0654s/iter; left time: 1292.3911s
	iters: 200, epoch: 12 | loss: 0.0635952
	speed: 0.0348s/iter; left time: 684.6834s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0600681 Vali Loss: 0.0754909 Test Loss: 0.0881430
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0601584
	speed: 0.0644s/iter; left time: 1256.7896s
	iters: 200, epoch: 13 | loss: 0.0585968
	speed: 0.0348s/iter; left time: 676.0389s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0596364 Vali Loss: 0.0754418 Test Loss: 0.0889707
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0573724
	speed: 0.0644s/iter; left time: 1243.6262s
	iters: 200, epoch: 14 | loss: 0.0607545
	speed: 0.0347s/iter; left time: 665.3496s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0593828 Vali Loss: 0.0757721 Test Loss: 0.0886866
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0580708
	speed: 0.0644s/iter; left time: 1229.6352s
	iters: 200, epoch: 15 | loss: 0.0588880
	speed: 0.0347s/iter; left time: 658.5333s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0590973 Vali Loss: 0.0754703 Test Loss: 0.0889454
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0575878
	speed: 0.0648s/iter; left time: 1221.7293s
	iters: 200, epoch: 16 | loss: 0.0604072
	speed: 0.0346s/iter; left time: 649.4004s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0588240 Vali Loss: 0.0754639 Test Loss: 0.0887070
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0572679
	speed: 0.0647s/iter; left time: 1206.1892s
	iters: 200, epoch: 17 | loss: 0.0556697
	speed: 0.0349s/iter; left time: 646.5941s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0585886 Vali Loss: 0.0757347 Test Loss: 0.0891244
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0596313
	speed: 0.0653s/iter; left time: 1202.1653s
	iters: 200, epoch: 18 | loss: 0.0587842
	speed: 0.0346s/iter; left time: 633.3591s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0583622 Vali Loss: 0.0758549 Test Loss: 0.0893418
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0568345
	speed: 0.0656s/iter; left time: 1192.7889s
	iters: 200, epoch: 19 | loss: 0.0550314
	speed: 0.0348s/iter; left time: 629.3585s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0582125 Vali Loss: 0.0756776 Test Loss: 0.0891228
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0581905
	speed: 0.0657s/iter; left time: 1180.0864s
	iters: 200, epoch: 20 | loss: 0.0588121
	speed: 0.0349s/iter; left time: 624.0670s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0580326 Vali Loss: 0.0758502 Test Loss: 0.0892652
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021153263747692108, rmse:0.14544162154197693, mae:0.0885264202952385, rse:0.5633091330528259
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1190915
	speed: 0.0365s/iter; left time: 810.2243s
	iters: 200, epoch: 1 | loss: 0.1097881
	speed: 0.0347s/iter; left time: 767.8814s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.1205956 Vali Loss: 0.1248965 Test Loss: 0.1393289
Validation loss decreased (inf --> 0.124897).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0711008
	speed: 0.0673s/iter; left time: 1479.4554s
	iters: 200, epoch: 2 | loss: 0.0703841
	speed: 0.0350s/iter; left time: 765.3464s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0782206 Vali Loss: 0.0799629 Test Loss: 0.0888531
Validation loss decreased (0.124897 --> 0.079963).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0687007
	speed: 0.0662s/iter; left time: 1440.9972s
	iters: 200, epoch: 3 | loss: 0.0673348
	speed: 0.0347s/iter; left time: 751.0225s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0680140 Vali Loss: 0.0777647 Test Loss: 0.0882832
Validation loss decreased (0.079963 --> 0.077765).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0688667
	speed: 0.0665s/iter; left time: 1430.8825s
	iters: 200, epoch: 4 | loss: 0.0627218
	speed: 0.0347s/iter; left time: 743.1052s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0656168 Vali Loss: 0.0766561 Test Loss: 0.0883783
Validation loss decreased (0.077765 --> 0.076656).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0656176
	speed: 0.0666s/iter; left time: 1419.0821s
	iters: 200, epoch: 5 | loss: 0.0660023
	speed: 0.0351s/iter; left time: 744.9462s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0642845 Vali Loss: 0.0762945 Test Loss: 0.0880121
Validation loss decreased (0.076656 --> 0.076295).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0643106
	speed: 0.0665s/iter; left time: 1402.0931s
	iters: 200, epoch: 6 | loss: 0.0636514
	speed: 0.0347s/iter; left time: 727.4968s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0633810 Vali Loss: 0.0759921 Test Loss: 0.0878032
Validation loss decreased (0.076295 --> 0.075992).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0605581
	speed: 0.0662s/iter; left time: 1380.2859s
	iters: 200, epoch: 7 | loss: 0.0603610
	speed: 0.0348s/iter; left time: 722.2007s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0625573 Vali Loss: 0.0758101 Test Loss: 0.0877436
Validation loss decreased (0.075992 --> 0.075810).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0640318
	speed: 0.0697s/iter; left time: 1439.4564s
	iters: 200, epoch: 8 | loss: 0.0560514
	speed: 0.0347s/iter; left time: 712.8043s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0619226 Vali Loss: 0.0752848 Test Loss: 0.0878139
Validation loss decreased (0.075810 --> 0.075285).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0624686
	speed: 0.0691s/iter; left time: 1411.6781s
	iters: 200, epoch: 9 | loss: 0.0615818
	speed: 0.0347s/iter; left time: 705.8846s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.15s
Steps: 223 | Train Loss: 0.0613472 Vali Loss: 0.0754208 Test Loss: 0.0882448
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0598454
	speed: 0.0658s/iter; left time: 1328.9268s
	iters: 200, epoch: 10 | loss: 0.0620275
	speed: 0.0347s/iter; left time: 698.2017s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0608847 Vali Loss: 0.0753788 Test Loss: 0.0879055
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0595490
	speed: 0.0655s/iter; left time: 1308.5181s
	iters: 200, epoch: 11 | loss: 0.0564547
	speed: 0.0348s/iter; left time: 690.8574s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0604800 Vali Loss: 0.0753783 Test Loss: 0.0885742
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0663159
	speed: 0.0666s/iter; left time: 1315.7838s
	iters: 200, epoch: 12 | loss: 0.0586635
	speed: 0.0347s/iter; left time: 682.3563s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0601038 Vali Loss: 0.0752748 Test Loss: 0.0883173
Validation loss decreased (0.075285 --> 0.075275).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0591716
	speed: 0.0669s/iter; left time: 1306.7900s
	iters: 200, epoch: 13 | loss: 0.0619611
	speed: 0.0348s/iter; left time: 676.1794s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0597688 Vali Loss: 0.0754530 Test Loss: 0.0886947
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0628451
	speed: 0.0660s/iter; left time: 1274.2231s
	iters: 200, epoch: 14 | loss: 0.0571450
	speed: 0.0347s/iter; left time: 667.0531s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0594889 Vali Loss: 0.0754246 Test Loss: 0.0889243
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0597695
	speed: 0.0653s/iter; left time: 1246.0228s
	iters: 200, epoch: 15 | loss: 0.0608148
	speed: 0.0352s/iter; left time: 668.3314s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0592113 Vali Loss: 0.0752915 Test Loss: 0.0887281
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0587053
	speed: 0.0655s/iter; left time: 1234.8179s
	iters: 200, epoch: 16 | loss: 0.0613898
	speed: 0.0347s/iter; left time: 650.2221s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0590177 Vali Loss: 0.0752665 Test Loss: 0.0886148
Validation loss decreased (0.075275 --> 0.075266).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0556257
	speed: 0.0681s/iter; left time: 1268.6138s
	iters: 200, epoch: 17 | loss: 0.0600753
	speed: 0.0346s/iter; left time: 641.3263s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0587513 Vali Loss: 0.0754278 Test Loss: 0.0891135
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0595197
	speed: 0.0666s/iter; left time: 1225.2562s
	iters: 200, epoch: 18 | loss: 0.0541842
	speed: 0.0347s/iter; left time: 634.8351s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0586244 Vali Loss: 0.0753491 Test Loss: 0.0892311
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0618455
	speed: 0.0663s/iter; left time: 1206.5824s
	iters: 200, epoch: 19 | loss: 0.0609220
	speed: 0.0352s/iter; left time: 636.3206s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0584854 Vali Loss: 0.0752955 Test Loss: 0.0892121
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0582511
	speed: 0.0664s/iter; left time: 1192.4749s
	iters: 200, epoch: 20 | loss: 0.0580657
	speed: 0.0349s/iter; left time: 623.3579s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.10s
Steps: 223 | Train Loss: 0.0583330 Vali Loss: 0.0755161 Test Loss: 0.0891338
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0597132
	speed: 0.0659s/iter; left time: 1169.1982s
	iters: 200, epoch: 21 | loss: 0.0572131
	speed: 0.0348s/iter; left time: 613.1017s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0581857 Vali Loss: 0.0752635 Test Loss: 0.0893303
Validation loss decreased (0.075266 --> 0.075264).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0599081
	speed: 0.0675s/iter; left time: 1182.4693s
	iters: 200, epoch: 22 | loss: 0.0631349
	speed: 0.0353s/iter; left time: 614.5435s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0580309 Vali Loss: 0.0754908 Test Loss: 0.0894723
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0593954
	speed: 0.0665s/iter; left time: 1149.2976s
	iters: 200, epoch: 23 | loss: 0.0571021
	speed: 0.0349s/iter; left time: 600.8016s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0579649 Vali Loss: 0.0752245 Test Loss: 0.0894107
Validation loss decreased (0.075264 --> 0.075224).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0609411
	speed: 0.0666s/iter; left time: 1136.2541s
	iters: 200, epoch: 24 | loss: 0.0616606
	speed: 0.0347s/iter; left time: 588.7563s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0578781 Vali Loss: 0.0755082 Test Loss: 0.0896305
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0574753
	speed: 0.0661s/iter; left time: 1113.4850s
	iters: 200, epoch: 25 | loss: 0.0571148
	speed: 0.0348s/iter; left time: 583.6325s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0577253 Vali Loss: 0.0754464 Test Loss: 0.0895677
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0566095
	speed: 0.0656s/iter; left time: 1091.2293s
	iters: 200, epoch: 26 | loss: 0.0602154
	speed: 0.0347s/iter; left time: 573.0307s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0576776 Vali Loss: 0.0753909 Test Loss: 0.0896359
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0608131
	speed: 0.0653s/iter; left time: 1071.2662s
	iters: 200, epoch: 27 | loss: 0.0541946
	speed: 0.0347s/iter; left time: 566.1929s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0576239 Vali Loss: 0.0753789 Test Loss: 0.0897510
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0563107
	speed: 0.0649s/iter; left time: 1049.3249s
	iters: 200, epoch: 28 | loss: 0.0646379
	speed: 0.0351s/iter; left time: 564.8705s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0576085 Vali Loss: 0.0753111 Test Loss: 0.0897061
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0537694
	speed: 0.0650s/iter; left time: 1037.8461s
	iters: 200, epoch: 29 | loss: 0.0549931
	speed: 0.0348s/iter; left time: 551.1022s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0575102 Vali Loss: 0.0755265 Test Loss: 0.0897974
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0543042
	speed: 0.0654s/iter; left time: 1028.7636s
	iters: 200, epoch: 30 | loss: 0.0600720
	speed: 0.0346s/iter; left time: 540.6175s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0574181 Vali Loss: 0.0753452 Test Loss: 0.0897552
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0569441
	speed: 0.0648s/iter; left time: 1005.1043s
	iters: 200, epoch: 31 | loss: 0.0567248
	speed: 0.0350s/iter; left time: 540.1078s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0573839 Vali Loss: 0.0754152 Test Loss: 0.0897348
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0576866
	speed: 0.0667s/iter; left time: 1019.0075s
	iters: 200, epoch: 32 | loss: 0.0556905
	speed: 0.0348s/iter; left time: 527.8390s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:08.11s
Steps: 223 | Train Loss: 0.0573533 Vali Loss: 0.0753913 Test Loss: 0.0897891
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0569799
	speed: 0.0653s/iter; left time: 984.4409s
	iters: 200, epoch: 33 | loss: 0.0603436
	speed: 0.0349s/iter; left time: 521.8852s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0573787 Vali Loss: 0.0753961 Test Loss: 0.0897591
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021873392164707184, rmse:0.14789655804634094, mae:0.08941067010164261, rse:0.5728173851966858
Intermediate time for FR and pred_len 168: 00h:09m:07.49sIntermediate time for FR: 00h:31m:49.39s
=== Starting experiments for country: IT ===

=== Starting experiments for pred_len: 24 ===

--- Running model for IT, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1670014
	speed: 0.0610s/iter; left time: 1359.2600s
	iters: 200, epoch: 1 | loss: 0.1489597
	speed: 0.0340s/iter; left time: 754.9766s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.30s
Steps: 224 | Train Loss: 0.1647013 Vali Loss: 0.1381420 Test Loss: 0.1453397
Validation loss decreased (inf --> 0.138142).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0750999
	speed: 0.0637s/iter; left time: 1406.4205s
	iters: 200, epoch: 2 | loss: 0.0690238
	speed: 0.0340s/iter; left time: 746.5705s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0844961 Vali Loss: 0.0635143 Test Loss: 0.0670098
Validation loss decreased (0.138142 --> 0.063514).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0655265
	speed: 0.0631s/iter; left time: 1379.5755s
	iters: 200, epoch: 3 | loss: 0.0632529
	speed: 0.0341s/iter; left time: 742.7435s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0647828 Vali Loss: 0.0602731 Test Loss: 0.0637938
Validation loss decreased (0.063514 --> 0.060273).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0584319
	speed: 0.0630s/iter; left time: 1363.3126s
	iters: 200, epoch: 4 | loss: 0.0584496
	speed: 0.0341s/iter; left time: 734.0579s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0615912 Vali Loss: 0.0586225 Test Loss: 0.0620069
Validation loss decreased (0.060273 --> 0.058623).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0533112
	speed: 0.0635s/iter; left time: 1359.4961s
	iters: 200, epoch: 5 | loss: 0.0589854
	speed: 0.0339s/iter; left time: 722.5336s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0597137 Vali Loss: 0.0576908 Test Loss: 0.0609164
Validation loss decreased (0.058623 --> 0.057691).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0561888
	speed: 0.0628s/iter; left time: 1329.4210s
	iters: 200, epoch: 6 | loss: 0.0549157
	speed: 0.0340s/iter; left time: 716.1461s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0582900 Vali Loss: 0.0568975 Test Loss: 0.0601823
Validation loss decreased (0.057691 --> 0.056897).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0597739
	speed: 0.0634s/iter; left time: 1329.4983s
	iters: 200, epoch: 7 | loss: 0.0557049
	speed: 0.0338s/iter; left time: 704.6721s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.75s
Steps: 224 | Train Loss: 0.0573733 Vali Loss: 0.0562706 Test Loss: 0.0595303
Validation loss decreased (0.056897 --> 0.056271).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0595894
	speed: 0.0636s/iter; left time: 1319.4512s
	iters: 200, epoch: 8 | loss: 0.0569145
	speed: 0.0339s/iter; left time: 699.8897s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0567145 Vali Loss: 0.0558174 Test Loss: 0.0591373
Validation loss decreased (0.056271 --> 0.055817).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0568185
	speed: 0.0630s/iter; left time: 1291.9065s
	iters: 200, epoch: 9 | loss: 0.0579889
	speed: 0.0339s/iter; left time: 690.9568s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0561700 Vali Loss: 0.0554012 Test Loss: 0.0587200
Validation loss decreased (0.055817 --> 0.055401).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0552366
	speed: 0.0643s/iter; left time: 1304.0597s
	iters: 200, epoch: 10 | loss: 0.0576353
	speed: 0.0339s/iter; left time: 685.2184s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0557297 Vali Loss: 0.0552699 Test Loss: 0.0583700
Validation loss decreased (0.055401 --> 0.055270).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0569591
	speed: 0.0637s/iter; left time: 1278.0031s
	iters: 200, epoch: 11 | loss: 0.0549891
	speed: 0.0339s/iter; left time: 676.7483s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0553976 Vali Loss: 0.0552579 Test Loss: 0.0583410
Validation loss decreased (0.055270 --> 0.055258).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0558492
	speed: 0.0640s/iter; left time: 1269.3833s
	iters: 200, epoch: 12 | loss: 0.0542611
	speed: 0.0341s/iter; left time: 672.1110s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0551059 Vali Loss: 0.0549728 Test Loss: 0.0580589
Validation loss decreased (0.055258 --> 0.054973).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0535999
	speed: 0.0647s/iter; left time: 1268.4732s
	iters: 200, epoch: 13 | loss: 0.0559298
	speed: 0.0342s/iter; left time: 667.6684s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0547429 Vali Loss: 0.0549172 Test Loss: 0.0579679
Validation loss decreased (0.054973 --> 0.054917).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0529017
	speed: 0.0634s/iter; left time: 1228.7968s
	iters: 200, epoch: 14 | loss: 0.0515292
	speed: 0.0341s/iter; left time: 657.5581s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0545808 Vali Loss: 0.0548573 Test Loss: 0.0578365
Validation loss decreased (0.054917 --> 0.054857).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0529730
	speed: 0.0632s/iter; left time: 1210.7666s
	iters: 200, epoch: 15 | loss: 0.0543535
	speed: 0.0339s/iter; left time: 646.9571s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0543980 Vali Loss: 0.0548917 Test Loss: 0.0579333
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0531671
	speed: 0.0628s/iter; left time: 1189.8872s
	iters: 200, epoch: 16 | loss: 0.0551569
	speed: 0.0338s/iter; left time: 636.6986s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0542372 Vali Loss: 0.0547073 Test Loss: 0.0578216
Validation loss decreased (0.054857 --> 0.054707).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0498223
	speed: 0.0640s/iter; left time: 1197.1398s
	iters: 200, epoch: 17 | loss: 0.0495734
	speed: 0.0342s/iter; left time: 636.5193s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0540312 Vali Loss: 0.0546522 Test Loss: 0.0577874
Validation loss decreased (0.054707 --> 0.054652).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0524506
	speed: 0.0665s/iter; left time: 1229.7721s
	iters: 200, epoch: 18 | loss: 0.0500953
	speed: 0.0339s/iter; left time: 623.8325s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0539062 Vali Loss: 0.0546065 Test Loss: 0.0576987
Validation loss decreased (0.054652 --> 0.054607).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0556998
	speed: 0.0630s/iter; left time: 1150.0473s
	iters: 200, epoch: 19 | loss: 0.0539675
	speed: 0.0341s/iter; left time: 619.2333s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0538145 Vali Loss: 0.0546639 Test Loss: 0.0576787
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0527673
	speed: 0.0616s/iter; left time: 1111.4715s
	iters: 200, epoch: 20 | loss: 0.0554663
	speed: 0.0340s/iter; left time: 609.2968s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.74s
Steps: 224 | Train Loss: 0.0537279 Vali Loss: 0.0545529 Test Loss: 0.0575282
Validation loss decreased (0.054607 --> 0.054553).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0509504
	speed: 0.0630s/iter; left time: 1122.2505s
	iters: 200, epoch: 21 | loss: 0.0495274
	speed: 0.0339s/iter; left time: 599.9695s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0535640 Vali Loss: 0.0544416 Test Loss: 0.0574515
Validation loss decreased (0.054553 --> 0.054442).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0533115
	speed: 0.0629s/iter; left time: 1107.1221s
	iters: 200, epoch: 22 | loss: 0.0542290
	speed: 0.0338s/iter; left time: 591.3214s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0534959 Vali Loss: 0.0542820 Test Loss: 0.0574463
Validation loss decreased (0.054442 --> 0.054282).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0526288
	speed: 0.0633s/iter; left time: 1100.3808s
	iters: 200, epoch: 23 | loss: 0.0600811
	speed: 0.0342s/iter; left time: 589.9398s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0534766 Vali Loss: 0.0543668 Test Loss: 0.0574086
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0539013
	speed: 0.0628s/iter; left time: 1077.5361s
	iters: 200, epoch: 24 | loss: 0.0493163
	speed: 0.0342s/iter; left time: 582.8454s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0533377 Vali Loss: 0.0544038 Test Loss: 0.0574341
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0503086
	speed: 0.0626s/iter; left time: 1060.0305s
	iters: 200, epoch: 25 | loss: 0.0536984
	speed: 0.0338s/iter; left time: 569.4894s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0533721 Vali Loss: 0.0542806 Test Loss: 0.0573443
Validation loss decreased (0.054282 --> 0.054281).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0499277
	speed: 0.0641s/iter; left time: 1069.8160s
	iters: 200, epoch: 26 | loss: 0.0532250
	speed: 0.0347s/iter; left time: 576.7107s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0533321 Vali Loss: 0.0543798 Test Loss: 0.0574476
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0477513
	speed: 0.0621s/iter; left time: 1023.4171s
	iters: 200, epoch: 27 | loss: 0.0493515
	speed: 0.0339s/iter; left time: 555.7160s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0532538 Vali Loss: 0.0543540 Test Loss: 0.0573775
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0525711
	speed: 0.0630s/iter; left time: 1023.9152s
	iters: 200, epoch: 28 | loss: 0.0506829
	speed: 0.0339s/iter; left time: 547.2639s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0532494 Vali Loss: 0.0543063 Test Loss: 0.0573612
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0528766
	speed: 0.0626s/iter; left time: 1002.6497s
	iters: 200, epoch: 29 | loss: 0.0544927
	speed: 0.0348s/iter; left time: 553.7796s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0531865 Vali Loss: 0.0542757 Test Loss: 0.0572928
Validation loss decreased (0.054281 --> 0.054276).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0529646
	speed: 0.0637s/iter; left time: 1007.3349s
	iters: 200, epoch: 30 | loss: 0.0546274
	speed: 0.0339s/iter; left time: 532.4153s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0531795 Vali Loss: 0.0543578 Test Loss: 0.0573470
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0503102
	speed: 0.0623s/iter; left time: 971.2654s
	iters: 200, epoch: 31 | loss: 0.0527957
	speed: 0.0339s/iter; left time: 524.1185s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:07.75s
Steps: 224 | Train Loss: 0.0531406 Vali Loss: 0.0542675 Test Loss: 0.0572747
Validation loss decreased (0.054276 --> 0.054267).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0553217
	speed: 0.0630s/iter; left time: 967.9845s
	iters: 200, epoch: 32 | loss: 0.0545876
	speed: 0.0341s/iter; left time: 520.2935s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0530841 Vali Loss: 0.0542606 Test Loss: 0.0572245
Validation loss decreased (0.054267 --> 0.054261).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0551260
	speed: 0.0644s/iter; left time: 974.4908s
	iters: 200, epoch: 33 | loss: 0.0535069
	speed: 0.0337s/iter; left time: 506.7551s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.76s
Steps: 224 | Train Loss: 0.0530346 Vali Loss: 0.0544190 Test Loss: 0.0573000
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0557198
	speed: 0.0624s/iter; left time: 930.4660s
	iters: 200, epoch: 34 | loss: 0.0516284
	speed: 0.0342s/iter; left time: 506.7373s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0530344 Vali Loss: 0.0543570 Test Loss: 0.0573233
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0517058
	speed: 0.0624s/iter; left time: 916.4048s
	iters: 200, epoch: 35 | loss: 0.0504066
	speed: 0.0344s/iter; left time: 502.1405s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0530052 Vali Loss: 0.0542769 Test Loss: 0.0572484
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0498497
	speed: 0.0625s/iter; left time: 904.5077s
	iters: 200, epoch: 36 | loss: 0.0520643
	speed: 0.0341s/iter; left time: 490.0631s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0529799 Vali Loss: 0.0543435 Test Loss: 0.0572919
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0537570
	speed: 0.0623s/iter; left time: 887.2193s
	iters: 200, epoch: 37 | loss: 0.0553898
	speed: 0.0338s/iter; left time: 477.1562s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0529558 Vali Loss: 0.0542968 Test Loss: 0.0572239
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0527173
	speed: 0.0625s/iter; left time: 875.5509s
	iters: 200, epoch: 38 | loss: 0.0577624
	speed: 0.0342s/iter; left time: 476.2560s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0529243 Vali Loss: 0.0542218 Test Loss: 0.0572267
Validation loss decreased (0.054261 --> 0.054222).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0527045
	speed: 0.0640s/iter; left time: 882.6612s
	iters: 200, epoch: 39 | loss: 0.0528507
	speed: 0.0339s/iter; left time: 464.4768s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0529220 Vali Loss: 0.0541531 Test Loss: 0.0572099
Validation loss decreased (0.054222 --> 0.054153).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0555587
	speed: 0.0640s/iter; left time: 867.7170s
	iters: 200, epoch: 40 | loss: 0.0516601
	speed: 0.0341s/iter; left time: 459.2415s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0529083 Vali Loss: 0.0542817 Test Loss: 0.0572354
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0571790
	speed: 0.0624s/iter; left time: 831.8615s
	iters: 200, epoch: 41 | loss: 0.0551317
	speed: 0.0341s/iter; left time: 451.7523s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0529310 Vali Loss: 0.0542987 Test Loss: 0.0572387
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0539040
	speed: 0.0630s/iter; left time: 825.8557s
	iters: 200, epoch: 42 | loss: 0.0542281
	speed: 0.0337s/iter; left time: 438.9419s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0529366 Vali Loss: 0.0542584 Test Loss: 0.0572168
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0535784
	speed: 0.0626s/iter; left time: 807.4526s
	iters: 200, epoch: 43 | loss: 0.0499920
	speed: 0.0342s/iter; left time: 437.9764s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0529107 Vali Loss: 0.0541936 Test Loss: 0.0572207
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0497392
	speed: 0.0628s/iter; left time: 795.9702s
	iters: 200, epoch: 44 | loss: 0.0531565
	speed: 0.0340s/iter; left time: 426.8650s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0529647 Vali Loss: 0.0542098 Test Loss: 0.0572039
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0524694
	speed: 0.0625s/iter; left time: 778.1356s
	iters: 200, epoch: 45 | loss: 0.0541316
	speed: 0.0339s/iter; left time: 418.6191s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0529106 Vali Loss: 0.0542475 Test Loss: 0.0571963
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0542567
	speed: 0.0686s/iter; left time: 837.9284s
	iters: 200, epoch: 46 | loss: 0.0523972
	speed: 0.0366s/iter; left time: 444.1917s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:08.70s
Steps: 224 | Train Loss: 0.0529340 Vali Loss: 0.0542955 Test Loss: 0.0572426
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0530457
	speed: 0.0623s/iter; left time: 747.2901s
	iters: 200, epoch: 47 | loss: 0.0522194
	speed: 0.0339s/iter; left time: 403.6157s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0528431 Vali Loss: 0.0543051 Test Loss: 0.0572482
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0551153
	speed: 0.0625s/iter; left time: 735.7430s
	iters: 200, epoch: 48 | loss: 0.0525597
	speed: 0.0339s/iter; left time: 395.5479s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0528467 Vali Loss: 0.0542701 Test Loss: 0.0572070
EarlyStopping counter: 9 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0565221
	speed: 0.0624s/iter; left time: 720.8405s
	iters: 200, epoch: 49 | loss: 0.0526045
	speed: 0.0338s/iter; left time: 386.8022s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0529101 Vali Loss: 0.0542374 Test Loss: 0.0571746
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010236818343400955, rmse:0.1011771634221077, mae:0.05720987543463707, rse:0.38229870796203613
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1621688
	speed: 0.0355s/iter; left time: 791.1282s
	iters: 200, epoch: 1 | loss: 0.1480829
	speed: 0.0337s/iter; left time: 748.7414s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.1636317 Vali Loss: 0.1371520 Test Loss: 0.1445785
Validation loss decreased (inf --> 0.137152).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0798413
	speed: 0.0641s/iter; left time: 1414.4975s
	iters: 200, epoch: 2 | loss: 0.0680234
	speed: 0.0364s/iter; left time: 799.3360s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.12s
Steps: 224 | Train Loss: 0.0861070 Vali Loss: 0.0640334 Test Loss: 0.0674341
Validation loss decreased (0.137152 --> 0.064033).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0621117
	speed: 0.0641s/iter; left time: 1400.5036s
	iters: 200, epoch: 3 | loss: 0.0625479
	speed: 0.0344s/iter; left time: 748.1002s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0656358 Vali Loss: 0.0609181 Test Loss: 0.0640399
Validation loss decreased (0.064033 --> 0.060918).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0576662
	speed: 0.0654s/iter; left time: 1414.0814s
	iters: 200, epoch: 4 | loss: 0.0587245
	speed: 0.0339s/iter; left time: 729.6234s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0623379 Vali Loss: 0.0589963 Test Loss: 0.0623144
Validation loss decreased (0.060918 --> 0.058996).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0582271
	speed: 0.0632s/iter; left time: 1353.7053s
	iters: 200, epoch: 5 | loss: 0.0601743
	speed: 0.0340s/iter; left time: 723.5229s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0601944 Vali Loss: 0.0576187 Test Loss: 0.0609705
Validation loss decreased (0.058996 --> 0.057619).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0583400
	speed: 0.0627s/iter; left time: 1327.2818s
	iters: 200, epoch: 6 | loss: 0.0598197
	speed: 0.0339s/iter; left time: 714.1302s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0586558 Vali Loss: 0.0567894 Test Loss: 0.0597033
Validation loss decreased (0.057619 --> 0.056789).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0587187
	speed: 0.0642s/iter; left time: 1345.4747s
	iters: 200, epoch: 7 | loss: 0.0549502
	speed: 0.0338s/iter; left time: 705.0090s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0575522 Vali Loss: 0.0564804 Test Loss: 0.0593413
Validation loss decreased (0.056789 --> 0.056480).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0576376
	speed: 0.0635s/iter; left time: 1317.1115s
	iters: 200, epoch: 8 | loss: 0.0604712
	speed: 0.0338s/iter; left time: 697.7233s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0568006 Vali Loss: 0.0560504 Test Loss: 0.0590656
Validation loss decreased (0.056480 --> 0.056050).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0524535
	speed: 0.0645s/iter; left time: 1322.3546s
	iters: 200, epoch: 9 | loss: 0.0537298
	speed: 0.0338s/iter; left time: 689.8205s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0561865 Vali Loss: 0.0557121 Test Loss: 0.0586558
Validation loss decreased (0.056050 --> 0.055712).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0570483
	speed: 0.0631s/iter; left time: 1279.1294s
	iters: 200, epoch: 10 | loss: 0.0529609
	speed: 0.0338s/iter; left time: 682.1217s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0557597 Vali Loss: 0.0554276 Test Loss: 0.0585423
Validation loss decreased (0.055712 --> 0.055428).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0543032
	speed: 0.0659s/iter; left time: 1321.7488s
	iters: 200, epoch: 11 | loss: 0.0550120
	speed: 0.0337s/iter; left time: 673.5995s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.76s
Steps: 224 | Train Loss: 0.0553544 Vali Loss: 0.0552403 Test Loss: 0.0582124
Validation loss decreased (0.055428 --> 0.055240).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0529443
	speed: 0.0664s/iter; left time: 1316.7593s
	iters: 200, epoch: 12 | loss: 0.0546039
	speed: 0.0340s/iter; left time: 670.6249s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0550798 Vali Loss: 0.0553219 Test Loss: 0.0583543
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0552135
	speed: 0.0620s/iter; left time: 1216.8340s
	iters: 200, epoch: 13 | loss: 0.0542144
	speed: 0.0339s/iter; left time: 661.2807s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0548424 Vali Loss: 0.0552345 Test Loss: 0.0580900
Validation loss decreased (0.055240 --> 0.055235).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0516681
	speed: 0.0628s/iter; left time: 1216.7089s
	iters: 200, epoch: 14 | loss: 0.0560737
	speed: 0.0338s/iter; left time: 652.4142s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0546319 Vali Loss: 0.0550627 Test Loss: 0.0579910
Validation loss decreased (0.055235 --> 0.055063).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0576609
	speed: 0.0627s/iter; left time: 1201.5765s
	iters: 200, epoch: 15 | loss: 0.0566705
	speed: 0.0340s/iter; left time: 648.6885s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0543967 Vali Loss: 0.0550173 Test Loss: 0.0579663
Validation loss decreased (0.055063 --> 0.055017).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0581773
	speed: 0.0634s/iter; left time: 1201.0449s
	iters: 200, epoch: 16 | loss: 0.0566819
	speed: 0.0340s/iter; left time: 640.9139s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0542331 Vali Loss: 0.0548165 Test Loss: 0.0577646
Validation loss decreased (0.055017 --> 0.054816).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0518837
	speed: 0.0632s/iter; left time: 1183.1684s
	iters: 200, epoch: 17 | loss: 0.0521889
	speed: 0.0340s/iter; left time: 633.3272s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0540859 Vali Loss: 0.0547377 Test Loss: 0.0577218
Validation loss decreased (0.054816 --> 0.054738).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0507305
	speed: 0.0633s/iter; left time: 1170.5826s
	iters: 200, epoch: 18 | loss: 0.0521321
	speed: 0.0338s/iter; left time: 622.2073s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0539531 Vali Loss: 0.0547232 Test Loss: 0.0576991
Validation loss decreased (0.054738 --> 0.054723).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0515661
	speed: 0.0640s/iter; left time: 1169.6368s
	iters: 200, epoch: 19 | loss: 0.0490565
	speed: 0.0339s/iter; left time: 615.0773s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0538102 Vali Loss: 0.0545976 Test Loss: 0.0575722
Validation loss decreased (0.054723 --> 0.054598).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0540523
	speed: 0.0627s/iter; left time: 1131.3324s
	iters: 200, epoch: 20 | loss: 0.0558243
	speed: 0.0340s/iter; left time: 610.6172s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0537262 Vali Loss: 0.0545503 Test Loss: 0.0574780
Validation loss decreased (0.054598 --> 0.054550).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0531959
	speed: 0.0634s/iter; left time: 1130.4634s
	iters: 200, epoch: 21 | loss: 0.0531068
	speed: 0.0346s/iter; left time: 612.4871s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0536436 Vali Loss: 0.0545609 Test Loss: 0.0576187
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0549796
	speed: 0.0621s/iter; left time: 1092.5973s
	iters: 200, epoch: 22 | loss: 0.0504838
	speed: 0.0339s/iter; left time: 592.9505s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.76s
Steps: 224 | Train Loss: 0.0535751 Vali Loss: 0.0543996 Test Loss: 0.0574319
Validation loss decreased (0.054550 --> 0.054400).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0524602
	speed: 0.0641s/iter; left time: 1114.2832s
	iters: 200, epoch: 23 | loss: 0.0520602
	speed: 0.0341s/iter; left time: 588.2082s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0534214 Vali Loss: 0.0544026 Test Loss: 0.0573988
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0566802
	speed: 0.0631s/iter; left time: 1081.8506s
	iters: 200, epoch: 24 | loss: 0.0517550
	speed: 0.0344s/iter; left time: 586.9353s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0533806 Vali Loss: 0.0544291 Test Loss: 0.0574103
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0517298
	speed: 0.0632s/iter; left time: 1069.6751s
	iters: 200, epoch: 25 | loss: 0.0507057
	speed: 0.0340s/iter; left time: 572.3292s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0533945 Vali Loss: 0.0544829 Test Loss: 0.0574231
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0491315
	speed: 0.0624s/iter; left time: 1042.1019s
	iters: 200, epoch: 26 | loss: 0.0530935
	speed: 0.0337s/iter; left time: 559.5711s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.75s
Steps: 224 | Train Loss: 0.0533575 Vali Loss: 0.0542973 Test Loss: 0.0573110
Validation loss decreased (0.054400 --> 0.054297).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0490967
	speed: 0.0631s/iter; left time: 1040.0874s
	iters: 200, epoch: 27 | loss: 0.0517953
	speed: 0.0343s/iter; left time: 562.4126s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0532923 Vali Loss: 0.0543248 Test Loss: 0.0573602
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0512018
	speed: 0.0635s/iter; left time: 1031.3157s
	iters: 200, epoch: 28 | loss: 0.0506737
	speed: 0.0338s/iter; left time: 546.2470s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0532094 Vali Loss: 0.0543913 Test Loss: 0.0573815
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0583045
	speed: 0.0630s/iter; left time: 1009.2881s
	iters: 200, epoch: 29 | loss: 0.0556699
	speed: 0.0339s/iter; left time: 540.1052s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0531794 Vali Loss: 0.0543335 Test Loss: 0.0573315
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0514338
	speed: 0.0629s/iter; left time: 994.8156s
	iters: 200, epoch: 30 | loss: 0.0496146
	speed: 0.0340s/iter; left time: 533.9477s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0532194 Vali Loss: 0.0542887 Test Loss: 0.0572902
Validation loss decreased (0.054297 --> 0.054289).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0534682
	speed: 0.0640s/iter; left time: 997.0319s
	iters: 200, epoch: 31 | loss: 0.0533699
	speed: 0.0341s/iter; left time: 527.6837s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0530668 Vali Loss: 0.0543162 Test Loss: 0.0572438
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0534906
	speed: 0.0635s/iter; left time: 975.1197s
	iters: 200, epoch: 32 | loss: 0.0558061
	speed: 0.0343s/iter; left time: 523.9937s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0530975 Vali Loss: 0.0542848 Test Loss: 0.0572557
Validation loss decreased (0.054289 --> 0.054285).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0511128
	speed: 0.0639s/iter; left time: 967.5762s
	iters: 200, epoch: 33 | loss: 0.0516018
	speed: 0.0339s/iter; left time: 509.5225s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0530165 Vali Loss: 0.0542628 Test Loss: 0.0572513
Validation loss decreased (0.054285 --> 0.054263).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0518864
	speed: 0.0642s/iter; left time: 957.8793s
	iters: 200, epoch: 34 | loss: 0.0545096
	speed: 0.0339s/iter; left time: 501.6444s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0529784 Vali Loss: 0.0542210 Test Loss: 0.0572153
Validation loss decreased (0.054263 --> 0.054221).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0510553
	speed: 0.0643s/iter; left time: 943.7723s
	iters: 200, epoch: 35 | loss: 0.0511590
	speed: 0.0344s/iter; left time: 501.6780s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0529844 Vali Loss: 0.0542394 Test Loss: 0.0572186
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0522200
	speed: 0.0624s/iter; left time: 901.9441s
	iters: 200, epoch: 36 | loss: 0.0524517
	speed: 0.0342s/iter; left time: 491.2125s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0530213 Vali Loss: 0.0542710 Test Loss: 0.0572017
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0506751
	speed: 0.0628s/iter; left time: 893.4562s
	iters: 200, epoch: 37 | loss: 0.0464932
	speed: 0.0340s/iter; left time: 481.2202s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0530234 Vali Loss: 0.0541738 Test Loss: 0.0571844
Validation loss decreased (0.054221 --> 0.054174).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0501622
	speed: 0.0630s/iter; left time: 882.1578s
	iters: 200, epoch: 38 | loss: 0.0518436
	speed: 0.0339s/iter; left time: 471.0068s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0529541 Vali Loss: 0.0543143 Test Loss: 0.0572248
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0525550
	speed: 0.0627s/iter; left time: 864.7172s
	iters: 200, epoch: 39 | loss: 0.0533633
	speed: 0.0341s/iter; left time: 467.3947s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0529305 Vali Loss: 0.0541389 Test Loss: 0.0571800
Validation loss decreased (0.054174 --> 0.054139).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0552160
	speed: 0.0643s/iter; left time: 872.1290s
	iters: 200, epoch: 40 | loss: 0.0551916
	speed: 0.0340s/iter; left time: 458.3141s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0528851 Vali Loss: 0.0541413 Test Loss: 0.0571632
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0530558
	speed: 0.0634s/iter; left time: 845.3774s
	iters: 200, epoch: 41 | loss: 0.0574618
	speed: 0.0340s/iter; left time: 450.5248s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0529675 Vali Loss: 0.0541982 Test Loss: 0.0571757
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0524376
	speed: 0.0624s/iter; left time: 817.9675s
	iters: 200, epoch: 42 | loss: 0.0524560
	speed: 0.0337s/iter; left time: 439.2131s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0529099 Vali Loss: 0.0541665 Test Loss: 0.0571621
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0551292
	speed: 0.0624s/iter; left time: 805.1638s
	iters: 200, epoch: 43 | loss: 0.0514255
	speed: 0.0339s/iter; left time: 434.2509s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0529093 Vali Loss: 0.0542868 Test Loss: 0.0571981
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0526689
	speed: 0.0622s/iter; left time: 787.9536s
	iters: 200, epoch: 44 | loss: 0.0535498
	speed: 0.0340s/iter; left time: 427.7148s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0529326 Vali Loss: 0.0542185 Test Loss: 0.0571942
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0596547
	speed: 0.0627s/iter; left time: 779.7806s
	iters: 200, epoch: 45 | loss: 0.0498769
	speed: 0.0338s/iter; left time: 417.6871s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0528972 Vali Loss: 0.0542430 Test Loss: 0.0572216
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0516230
	speed: 0.0624s/iter; left time: 762.5652s
	iters: 200, epoch: 46 | loss: 0.0527195
	speed: 0.0339s/iter; left time: 410.8358s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0528695 Vali Loss: 0.0541202 Test Loss: 0.0571376
Validation loss decreased (0.054139 --> 0.054120).  Saving model ...
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0525249
	speed: 0.0630s/iter; left time: 756.0183s
	iters: 200, epoch: 47 | loss: 0.0511307
	speed: 0.0339s/iter; left time: 403.1342s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0529027 Vali Loss: 0.0541644 Test Loss: 0.0571724
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0508050
	speed: 0.0629s/iter; left time: 740.6182s
	iters: 200, epoch: 48 | loss: 0.0541915
	speed: 0.0342s/iter; left time: 399.0152s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0528709 Vali Loss: 0.0541885 Test Loss: 0.0571710
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0553696
	speed: 0.0624s/iter; left time: 720.8960s
	iters: 200, epoch: 49 | loss: 0.0518353
	speed: 0.0338s/iter; left time: 387.3759s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0529159 Vali Loss: 0.0541697 Test Loss: 0.0571644
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0539344
	speed: 0.0623s/iter; left time: 706.1050s
	iters: 200, epoch: 50 | loss: 0.0496123
	speed: 0.0341s/iter; left time: 383.2009s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0528739 Vali Loss: 0.0541643 Test Loss: 0.0571312
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0521338
	speed: 0.0628s/iter; left time: 697.1460s
	iters: 200, epoch: 51 | loss: 0.0517713
	speed: 0.0340s/iter; left time: 374.4859s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0529285 Vali Loss: 0.0541869 Test Loss: 0.0571487
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0502872
	speed: 0.0632s/iter; left time: 687.5517s
	iters: 200, epoch: 52 | loss: 0.0518404
	speed: 0.0340s/iter; left time: 366.8974s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0528991 Vali Loss: 0.0541382 Test Loss: 0.0571131
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0528773
	speed: 0.0640s/iter; left time: 682.1553s
	iters: 200, epoch: 53 | loss: 0.0550838
	speed: 0.0340s/iter; left time: 359.0225s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0528394 Vali Loss: 0.0540858 Test Loss: 0.0571252
Validation loss decreased (0.054120 --> 0.054086).  Saving model ...
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0533713
	speed: 0.0640s/iter; left time: 667.0699s
	iters: 200, epoch: 54 | loss: 0.0546677
	speed: 0.0341s/iter; left time: 351.9812s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0529049 Vali Loss: 0.0541218 Test Loss: 0.0571443
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0513141
	speed: 0.0628s/iter; left time: 641.3197s
	iters: 200, epoch: 55 | loss: 0.0553885
	speed: 0.0339s/iter; left time: 342.4464s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0528430 Vali Loss: 0.0541577 Test Loss: 0.0571592
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0541152
	speed: 0.0631s/iter; left time: 629.7683s
	iters: 200, epoch: 56 | loss: 0.0500019
	speed: 0.0343s/iter; left time: 338.8987s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0528580 Vali Loss: 0.0541782 Test Loss: 0.0571533
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0504828
	speed: 0.0635s/iter; left time: 620.0526s
	iters: 200, epoch: 57 | loss: 0.0521803
	speed: 0.0341s/iter; left time: 328.8730s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0528007 Vali Loss: 0.0541686 Test Loss: 0.0571215
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0518517
	speed: 0.0623s/iter; left time: 594.2006s
	iters: 200, epoch: 58 | loss: 0.0560168
	speed: 0.0338s/iter; left time: 319.0331s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0528598 Vali Loss: 0.0542424 Test Loss: 0.0571867
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0541537
	speed: 0.0626s/iter; left time: 582.9825s
	iters: 200, epoch: 59 | loss: 0.0537782
	speed: 0.0340s/iter; left time: 313.2510s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0528410 Vali Loss: 0.0541864 Test Loss: 0.0571392
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0491767
	speed: 0.0624s/iter; left time: 566.7145s
	iters: 200, epoch: 60 | loss: 0.0531485
	speed: 0.0339s/iter; left time: 304.3246s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0528693 Vali Loss: 0.0541679 Test Loss: 0.0571413
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0544172
	speed: 0.0625s/iter; left time: 553.4237s
	iters: 200, epoch: 61 | loss: 0.0510035
	speed: 0.0338s/iter; left time: 296.2505s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0528560 Vali Loss: 0.0542183 Test Loss: 0.0571623
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0512042
	speed: 0.0628s/iter; left time: 542.5279s
	iters: 200, epoch: 62 | loss: 0.0531393
	speed: 0.0346s/iter; left time: 295.4480s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0528431 Vali Loss: 0.0541732 Test Loss: 0.0571681
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0540698
	speed: 0.0628s/iter; left time: 528.2091s
	iters: 200, epoch: 63 | loss: 0.0589358
	speed: 0.0339s/iter; left time: 281.6424s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0528726 Vali Loss: 0.0541508 Test Loss: 0.0571197
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01018845196813345, rmse:0.1009378582239151, mae:0.057125240564346313, rse:0.38139447569847107
Intermediate time for IT and pred_len 24: 00h:18m:22.20s
=== Starting experiments for pred_len: 96 ===

--- Running model for IT, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1708428
	speed: 0.0604s/iter; left time: 1345.8820s
	iters: 200, epoch: 1 | loss: 0.1594457
	speed: 0.0345s/iter; left time: 764.9112s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.28s
Steps: 224 | Train Loss: 0.1731542 Vali Loss: 0.1467581 Test Loss: 0.1548955
Validation loss decreased (inf --> 0.146758).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0911917
	speed: 0.0676s/iter; left time: 1492.1971s
	iters: 200, epoch: 2 | loss: 0.0814402
	speed: 0.0346s/iter; left time: 760.2033s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.1010911 Vali Loss: 0.0820083 Test Loss: 0.0875059
Validation loss decreased (0.146758 --> 0.082008).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0830979
	speed: 0.0655s/iter; left time: 1430.7089s
	iters: 200, epoch: 3 | loss: 0.0889395
	speed: 0.0343s/iter; left time: 745.2946s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0844789 Vali Loss: 0.0791793 Test Loss: 0.0851529
Validation loss decreased (0.082008 --> 0.079179).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0824321
	speed: 0.0652s/iter; left time: 1409.2475s
	iters: 200, epoch: 4 | loss: 0.0785757
	speed: 0.0344s/iter; left time: 740.7649s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0813190 Vali Loss: 0.0774232 Test Loss: 0.0832199
Validation loss decreased (0.079179 --> 0.077423).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0809543
	speed: 0.0650s/iter; left time: 1392.1430s
	iters: 200, epoch: 5 | loss: 0.0777268
	speed: 0.0347s/iter; left time: 739.8572s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0791435 Vali Loss: 0.0766719 Test Loss: 0.0825766
Validation loss decreased (0.077423 --> 0.076672).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0763184
	speed: 0.0653s/iter; left time: 1382.2476s
	iters: 200, epoch: 6 | loss: 0.0782094
	speed: 0.0360s/iter; left time: 758.0795s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.13s
Steps: 224 | Train Loss: 0.0778040 Vali Loss: 0.0764557 Test Loss: 0.0820813
Validation loss decreased (0.076672 --> 0.076456).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0754540
	speed: 0.0665s/iter; left time: 1394.0757s
	iters: 200, epoch: 7 | loss: 0.0774429
	speed: 0.0342s/iter; left time: 713.5401s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0768773 Vali Loss: 0.0759133 Test Loss: 0.0815514
Validation loss decreased (0.076456 --> 0.075913).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0827561
	speed: 0.0653s/iter; left time: 1353.7802s
	iters: 200, epoch: 8 | loss: 0.0756439
	speed: 0.0347s/iter; left time: 715.6030s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0761391 Vali Loss: 0.0757392 Test Loss: 0.0811567
Validation loss decreased (0.075913 --> 0.075739).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0711883
	speed: 0.0655s/iter; left time: 1343.3206s
	iters: 200, epoch: 9 | loss: 0.0744836
	speed: 0.0342s/iter; left time: 698.5246s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0754943 Vali Loss: 0.0753163 Test Loss: 0.0810659
Validation loss decreased (0.075739 --> 0.075316).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0763812
	speed: 0.0641s/iter; left time: 1300.1501s
	iters: 200, epoch: 10 | loss: 0.0725944
	speed: 0.0343s/iter; left time: 693.3268s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0750145 Vali Loss: 0.0755616 Test Loss: 0.0812671
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0727805
	speed: 0.0647s/iter; left time: 1297.2183s
	iters: 200, epoch: 11 | loss: 0.0757687
	speed: 0.0345s/iter; left time: 689.3621s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0746283 Vali Loss: 0.0752170 Test Loss: 0.0808455
Validation loss decreased (0.075316 --> 0.075217).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0721116
	speed: 0.0648s/iter; left time: 1286.3889s
	iters: 200, epoch: 12 | loss: 0.0727255
	speed: 0.0342s/iter; left time: 675.9831s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0742536 Vali Loss: 0.0751851 Test Loss: 0.0806396
Validation loss decreased (0.075217 --> 0.075185).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0705675
	speed: 0.0662s/iter; left time: 1297.5205s
	iters: 200, epoch: 13 | loss: 0.0709595
	speed: 0.0345s/iter; left time: 672.8037s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0738950 Vali Loss: 0.0749574 Test Loss: 0.0804897
Validation loss decreased (0.075185 --> 0.074957).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0724083
	speed: 0.0652s/iter; left time: 1264.6320s
	iters: 200, epoch: 14 | loss: 0.0710550
	speed: 0.0348s/iter; left time: 671.2010s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0735501 Vali Loss: 0.0751684 Test Loss: 0.0806189
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0723576
	speed: 0.0642s/iter; left time: 1230.2187s
	iters: 200, epoch: 15 | loss: 0.0725039
	speed: 0.0342s/iter; left time: 651.1582s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0732920 Vali Loss: 0.0750311 Test Loss: 0.0806733
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0713176
	speed: 0.0638s/iter; left time: 1208.0324s
	iters: 200, epoch: 16 | loss: 0.0744308
	speed: 0.0340s/iter; left time: 639.7744s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0730593 Vali Loss: 0.0752731 Test Loss: 0.0807205
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0710878
	speed: 0.0636s/iter; left time: 1189.7422s
	iters: 200, epoch: 17 | loss: 0.0697964
	speed: 0.0340s/iter; left time: 633.4459s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0727951 Vali Loss: 0.0751548 Test Loss: 0.0807240
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0758380
	speed: 0.0636s/iter; left time: 1175.4070s
	iters: 200, epoch: 18 | loss: 0.0758936
	speed: 0.0345s/iter; left time: 634.5195s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0725756 Vali Loss: 0.0750683 Test Loss: 0.0805463
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0716046
	speed: 0.0644s/iter; left time: 1176.1559s
	iters: 200, epoch: 19 | loss: 0.0751578
	speed: 0.0344s/iter; left time: 625.8149s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0723964 Vali Loss: 0.0750442 Test Loss: 0.0805577
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0689812
	speed: 0.0640s/iter; left time: 1155.7426s
	iters: 200, epoch: 20 | loss: 0.0691623
	speed: 0.0344s/iter; left time: 617.5007s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0722792 Vali Loss: 0.0751461 Test Loss: 0.0805010
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0688393
	speed: 0.0641s/iter; left time: 1141.9272s
	iters: 200, epoch: 21 | loss: 0.0750959
	speed: 0.0344s/iter; left time: 610.2391s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0720699 Vali Loss: 0.0750215 Test Loss: 0.0805558
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0725956
	speed: 0.0642s/iter; left time: 1130.1982s
	iters: 200, epoch: 22 | loss: 0.0757748
	speed: 0.0344s/iter; left time: 601.7339s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0718513 Vali Loss: 0.0750700 Test Loss: 0.0805067
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0682724
	speed: 0.0649s/iter; left time: 1128.2544s
	iters: 200, epoch: 23 | loss: 0.0704672
	speed: 0.0346s/iter; left time: 597.2213s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0718010 Vali Loss: 0.0751507 Test Loss: 0.0804503
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018429992720484734, rmse:0.13575710356235504, mae:0.08048970252275467, rse:0.5133122801780701
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1717162
	speed: 0.0361s/iter; left time: 804.8448s
	iters: 200, epoch: 1 | loss: 0.1547311
	speed: 0.0342s/iter; left time: 759.0579s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.1720086 Vali Loss: 0.1459155 Test Loss: 0.1540600
Validation loss decreased (inf --> 0.145916).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0902586
	speed: 0.0670s/iter; left time: 1479.2132s
	iters: 200, epoch: 2 | loss: 0.0884021
	speed: 0.0347s/iter; left time: 761.5463s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.1020034 Vali Loss: 0.0817397 Test Loss: 0.0876089
Validation loss decreased (0.145916 --> 0.081740).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0806921
	speed: 0.0664s/iter; left time: 1450.4385s
	iters: 200, epoch: 3 | loss: 0.0818520
	speed: 0.0353s/iter; left time: 767.6461s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0844065 Vali Loss: 0.0787544 Test Loss: 0.0849668
Validation loss decreased (0.081740 --> 0.078754).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0823183
	speed: 0.0661s/iter; left time: 1430.1323s
	iters: 200, epoch: 4 | loss: 0.0748083
	speed: 0.0347s/iter; left time: 746.8314s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0812384 Vali Loss: 0.0773447 Test Loss: 0.0834567
Validation loss decreased (0.078754 --> 0.077345).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0773717
	speed: 0.0659s/iter; left time: 1411.4664s
	iters: 200, epoch: 5 | loss: 0.0803391
	speed: 0.0364s/iter; left time: 774.9536s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.15s
Steps: 224 | Train Loss: 0.0791357 Vali Loss: 0.0765479 Test Loss: 0.0827161
Validation loss decreased (0.077345 --> 0.076548).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0742378
	speed: 0.0655s/iter; left time: 1387.0200s
	iters: 200, epoch: 6 | loss: 0.0735158
	speed: 0.0342s/iter; left time: 721.0578s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0778847 Vali Loss: 0.0759478 Test Loss: 0.0819176
Validation loss decreased (0.076548 --> 0.075948).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0798959
	speed: 0.0656s/iter; left time: 1375.0080s
	iters: 200, epoch: 7 | loss: 0.0762781
	speed: 0.0346s/iter; left time: 721.0470s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0770121 Vali Loss: 0.0754765 Test Loss: 0.0812748
Validation loss decreased (0.075948 --> 0.075477).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0762613
	speed: 0.0663s/iter; left time: 1375.4889s
	iters: 200, epoch: 8 | loss: 0.0738247
	speed: 0.0348s/iter; left time: 717.7156s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0763575 Vali Loss: 0.0754799 Test Loss: 0.0810893
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0707921
	speed: 0.0644s/iter; left time: 1320.0440s
	iters: 200, epoch: 9 | loss: 0.0730707
	speed: 0.0343s/iter; left time: 700.8790s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0758007 Vali Loss: 0.0752670 Test Loss: 0.0810076
Validation loss decreased (0.075477 --> 0.075267).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0768500
	speed: 0.0658s/iter; left time: 1333.8397s
	iters: 200, epoch: 10 | loss: 0.0770572
	speed: 0.0342s/iter; left time: 690.6711s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0752275 Vali Loss: 0.0755037 Test Loss: 0.0809618
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0702061
	speed: 0.0643s/iter; left time: 1290.4299s
	iters: 200, epoch: 11 | loss: 0.0721966
	speed: 0.0345s/iter; left time: 687.7470s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0747662 Vali Loss: 0.0752120 Test Loss: 0.0806102
Validation loss decreased (0.075267 --> 0.075212).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0721364
	speed: 0.0654s/iter; left time: 1297.7648s
	iters: 200, epoch: 12 | loss: 0.0765346
	speed: 0.0342s/iter; left time: 674.3479s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0744425 Vali Loss: 0.0750042 Test Loss: 0.0803983
Validation loss decreased (0.075212 --> 0.075004).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0755303
	speed: 0.0658s/iter; left time: 1291.2967s
	iters: 200, epoch: 13 | loss: 0.0725444
	speed: 0.0342s/iter; left time: 666.4311s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0740546 Vali Loss: 0.0751376 Test Loss: 0.0805491
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0720178
	speed: 0.0655s/iter; left time: 1269.5515s
	iters: 200, epoch: 14 | loss: 0.0738684
	speed: 0.0346s/iter; left time: 667.2500s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0737559 Vali Loss: 0.0750192 Test Loss: 0.0804674
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0704391
	speed: 0.0648s/iter; left time: 1241.0324s
	iters: 200, epoch: 15 | loss: 0.0770458
	speed: 0.0345s/iter; left time: 658.1703s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0734251 Vali Loss: 0.0749590 Test Loss: 0.0803911
Validation loss decreased (0.075004 --> 0.074959).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0704973
	speed: 0.0664s/iter; left time: 1257.7991s
	iters: 200, epoch: 16 | loss: 0.0751103
	speed: 0.0342s/iter; left time: 644.3762s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0731332 Vali Loss: 0.0751347 Test Loss: 0.0805202
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0713474
	speed: 0.0655s/iter; left time: 1226.1795s
	iters: 200, epoch: 17 | loss: 0.0723478
	speed: 0.0345s/iter; left time: 641.4608s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0729386 Vali Loss: 0.0752624 Test Loss: 0.0806591
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0748544
	speed: 0.0651s/iter; left time: 1204.7753s
	iters: 200, epoch: 18 | loss: 0.0719111
	speed: 0.0345s/iter; left time: 635.2292s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0726287 Vali Loss: 0.0750974 Test Loss: 0.0806480
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0740988
	speed: 0.0652s/iter; left time: 1191.3455s
	iters: 200, epoch: 19 | loss: 0.0716079
	speed: 0.0345s/iter; left time: 626.2177s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0723735 Vali Loss: 0.0751401 Test Loss: 0.0804492
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0795438
	speed: 0.0645s/iter; left time: 1163.3321s
	iters: 200, epoch: 20 | loss: 0.0723670
	speed: 0.0342s/iter; left time: 614.0082s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0722089 Vali Loss: 0.0750112 Test Loss: 0.0805029
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0775375
	speed: 0.0646s/iter; left time: 1151.3928s
	iters: 200, epoch: 21 | loss: 0.0697027
	speed: 0.0341s/iter; left time: 604.4413s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0720628 Vali Loss: 0.0752527 Test Loss: 0.0808125
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0729531
	speed: 0.0646s/iter; left time: 1137.3580s
	iters: 200, epoch: 22 | loss: 0.0735260
	speed: 0.0342s/iter; left time: 598.2798s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0718946 Vali Loss: 0.0754438 Test Loss: 0.0807066
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0729971
	speed: 0.0653s/iter; left time: 1134.9392s
	iters: 200, epoch: 23 | loss: 0.0684208
	speed: 0.0341s/iter; left time: 589.6345s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0717447 Vali Loss: 0.0752911 Test Loss: 0.0807496
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0746076
	speed: 0.0650s/iter; left time: 1114.7638s
	iters: 200, epoch: 24 | loss: 0.0737846
	speed: 0.0341s/iter; left time: 581.7698s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0715528 Vali Loss: 0.0754601 Test Loss: 0.0807979
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0713751
	speed: 0.0662s/iter; left time: 1119.8767s
	iters: 200, epoch: 25 | loss: 0.0718056
	speed: 0.0341s/iter; left time: 574.3578s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.07s
Steps: 224 | Train Loss: 0.0714146 Vali Loss: 0.0752501 Test Loss: 0.0808415
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018284546211361885, rmse:0.13522036373615265, mae:0.08039116114377975, rse:0.5112828016281128
Intermediate time for IT and pred_len 96: 00h:08m:11.05s
=== Starting experiments for pred_len: 168 ===

--- Running model for IT, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1685615
	speed: 0.0630s/iter; left time: 1398.8682s
	iters: 200, epoch: 1 | loss: 0.1568272
	speed: 0.0348s/iter; left time: 768.3004s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.29s
Steps: 223 | Train Loss: 0.1736213 Vali Loss: 0.1484853 Test Loss: 0.1557566
Validation loss decreased (inf --> 0.148485).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0974978
	speed: 0.0661s/iter; left time: 1452.6432s
	iters: 200, epoch: 2 | loss: 0.0910320
	speed: 0.0348s/iter; left time: 760.5426s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.1043769 Vali Loss: 0.0866889 Test Loss: 0.0919048
Validation loss decreased (0.148485 --> 0.086689).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0912040
	speed: 0.0657s/iter; left time: 1429.5490s
	iters: 200, epoch: 3 | loss: 0.0904868
	speed: 0.0348s/iter; left time: 752.9527s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0892210 Vali Loss: 0.0842649 Test Loss: 0.0895253
Validation loss decreased (0.086689 --> 0.084265).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0852099
	speed: 0.0657s/iter; left time: 1414.6351s
	iters: 200, epoch: 4 | loss: 0.0859520
	speed: 0.0346s/iter; left time: 740.7383s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0859204 Vali Loss: 0.0823648 Test Loss: 0.0877696
Validation loss decreased (0.084265 --> 0.082365).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0825829
	speed: 0.0660s/iter; left time: 1407.1327s
	iters: 200, epoch: 5 | loss: 0.0865354
	speed: 0.0349s/iter; left time: 739.7752s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0837493 Vali Loss: 0.0820099 Test Loss: 0.0869467
Validation loss decreased (0.082365 --> 0.082010).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0812117
	speed: 0.0660s/iter; left time: 1391.9976s
	iters: 200, epoch: 6 | loss: 0.0805016
	speed: 0.0349s/iter; left time: 731.7569s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0823856 Vali Loss: 0.0815980 Test Loss: 0.0865260
Validation loss decreased (0.082010 --> 0.081598).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0781863
	speed: 0.0655s/iter; left time: 1365.7983s
	iters: 200, epoch: 7 | loss: 0.0789772
	speed: 0.0346s/iter; left time: 718.5576s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0814742 Vali Loss: 0.0814899 Test Loss: 0.0861910
Validation loss decreased (0.081598 --> 0.081490).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0846676
	speed: 0.0650s/iter; left time: 1341.8151s
	iters: 200, epoch: 8 | loss: 0.0805376
	speed: 0.0346s/iter; left time: 710.1787s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0806293 Vali Loss: 0.0812760 Test Loss: 0.0857881
Validation loss decreased (0.081490 --> 0.081276).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0786573
	speed: 0.0661s/iter; left time: 1349.5099s
	iters: 200, epoch: 9 | loss: 0.0793395
	speed: 0.0353s/iter; left time: 718.1084s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0799030 Vali Loss: 0.0811255 Test Loss: 0.0857040
Validation loss decreased (0.081276 --> 0.081126).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0748710
	speed: 0.0658s/iter; left time: 1329.4709s
	iters: 200, epoch: 10 | loss: 0.0782158
	speed: 0.0349s/iter; left time: 700.3029s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0792681 Vali Loss: 0.0811365 Test Loss: 0.0855135
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0783835
	speed: 0.0644s/iter; left time: 1286.3416s
	iters: 200, epoch: 11 | loss: 0.0823445
	speed: 0.0347s/iter; left time: 689.2722s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0788008 Vali Loss: 0.0812760 Test Loss: 0.0855287
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0793765
	speed: 0.0652s/iter; left time: 1287.6063s
	iters: 200, epoch: 12 | loss: 0.0761238
	speed: 0.0350s/iter; left time: 688.6211s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0782779 Vali Loss: 0.0819592 Test Loss: 0.0858866
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0769632
	speed: 0.0649s/iter; left time: 1267.7708s
	iters: 200, epoch: 13 | loss: 0.0757491
	speed: 0.0346s/iter; left time: 671.4746s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0778690 Vali Loss: 0.0812044 Test Loss: 0.0857033
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0760562
	speed: 0.0645s/iter; left time: 1244.6670s
	iters: 200, epoch: 14 | loss: 0.0776277
	speed: 0.0354s/iter; left time: 679.4237s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0774190 Vali Loss: 0.0813871 Test Loss: 0.0856038
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0768229
	speed: 0.0648s/iter; left time: 1237.2421s
	iters: 200, epoch: 15 | loss: 0.0817131
	speed: 0.0347s/iter; left time: 657.8893s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0771079 Vali Loss: 0.0816075 Test Loss: 0.0856013
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0770470
	speed: 0.0649s/iter; left time: 1222.9102s
	iters: 200, epoch: 16 | loss: 0.0779783
	speed: 0.0348s/iter; left time: 651.9359s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0767886 Vali Loss: 0.0815303 Test Loss: 0.0856111
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0730242
	speed: 0.0644s/iter; left time: 1199.9369s
	iters: 200, epoch: 17 | loss: 0.0730916
	speed: 0.0345s/iter; left time: 639.1990s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.90s
Steps: 223 | Train Loss: 0.0765942 Vali Loss: 0.0811437 Test Loss: 0.0854295
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0739851
	speed: 0.0644s/iter; left time: 1184.9958s
	iters: 200, epoch: 18 | loss: 0.0721104
	speed: 0.0348s/iter; left time: 636.3711s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0762804 Vali Loss: 0.0812141 Test Loss: 0.0856437
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0764789
	speed: 0.0657s/iter; left time: 1194.2780s
	iters: 200, epoch: 19 | loss: 0.0732362
	speed: 0.0345s/iter; left time: 624.6995s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0760899 Vali Loss: 0.0813462 Test Loss: 0.0856425
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.01992725394666195, rmse:0.1411639302968979, mae:0.08570398390293121, rse:0.5342520475387573
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1683050
	speed: 0.0371s/iter; left time: 823.3448s
	iters: 200, epoch: 1 | loss: 0.1609643
	speed: 0.0349s/iter; left time: 771.3603s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.1735891 Vali Loss: 0.1484374 Test Loss: 0.1558327
Validation loss decreased (inf --> 0.148437).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1005189
	speed: 0.0668s/iter; left time: 1467.9994s
	iters: 200, epoch: 2 | loss: 0.0957257
	speed: 0.0357s/iter; left time: 781.1401s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.14s
Steps: 223 | Train Loss: 0.1053175 Vali Loss: 0.0867120 Test Loss: 0.0919353
Validation loss decreased (0.148437 --> 0.086712).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0910446
	speed: 0.0665s/iter; left time: 1446.1851s
	iters: 200, epoch: 3 | loss: 0.0867514
	speed: 0.0345s/iter; left time: 747.7420s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0895826 Vali Loss: 0.0842891 Test Loss: 0.0896376
Validation loss decreased (0.086712 --> 0.084289).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0842633
	speed: 0.0662s/iter; left time: 1424.8121s
	iters: 200, epoch: 4 | loss: 0.0837887
	speed: 0.0353s/iter; left time: 756.0464s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0864344 Vali Loss: 0.0827821 Test Loss: 0.0879717
Validation loss decreased (0.084289 --> 0.082782).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0866451
	speed: 0.0667s/iter; left time: 1420.6010s
	iters: 200, epoch: 5 | loss: 0.0811731
	speed: 0.0347s/iter; left time: 735.8709s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0838926 Vali Loss: 0.0819751 Test Loss: 0.0869465
Validation loss decreased (0.082782 --> 0.081975).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0824393
	speed: 0.0666s/iter; left time: 1404.8578s
	iters: 200, epoch: 6 | loss: 0.0826765
	speed: 0.0349s/iter; left time: 733.3537s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0824055 Vali Loss: 0.0814825 Test Loss: 0.0861749
Validation loss decreased (0.081975 --> 0.081483).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0800761
	speed: 0.0654s/iter; left time: 1363.9162s
	iters: 200, epoch: 7 | loss: 0.0836602
	speed: 0.0346s/iter; left time: 717.6750s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0812305 Vali Loss: 0.0814719 Test Loss: 0.0861034
Validation loss decreased (0.081483 --> 0.081472).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0795792
	speed: 0.0659s/iter; left time: 1360.5517s
	iters: 200, epoch: 8 | loss: 0.0773741
	speed: 0.0345s/iter; left time: 709.2594s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0803744 Vali Loss: 0.0819383 Test Loss: 0.0864487
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0826027
	speed: 0.0655s/iter; left time: 1336.8366s
	iters: 200, epoch: 9 | loss: 0.0796509
	speed: 0.0347s/iter; left time: 705.8878s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0796907 Vali Loss: 0.0814607 Test Loss: 0.0857157
Validation loss decreased (0.081472 --> 0.081461).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0774815
	speed: 0.0662s/iter; left time: 1336.8656s
	iters: 200, epoch: 10 | loss: 0.0809388
	speed: 0.0348s/iter; left time: 699.1591s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0790804 Vali Loss: 0.0810461 Test Loss: 0.0858849
Validation loss decreased (0.081461 --> 0.081046).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0768481
	speed: 0.0660s/iter; left time: 1317.3015s
	iters: 200, epoch: 11 | loss: 0.0760282
	speed: 0.0344s/iter; left time: 683.2307s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0785108 Vali Loss: 0.0815009 Test Loss: 0.0857234
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0766115
	speed: 0.0646s/iter; left time: 1274.9758s
	iters: 200, epoch: 12 | loss: 0.0779266
	speed: 0.0347s/iter; left time: 682.4678s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0780359 Vali Loss: 0.0812513 Test Loss: 0.0858585
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0796628
	speed: 0.0656s/iter; left time: 1281.0470s
	iters: 200, epoch: 13 | loss: 0.0790740
	speed: 0.0356s/iter; left time: 690.8332s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.20s
Steps: 223 | Train Loss: 0.0776244 Vali Loss: 0.0812385 Test Loss: 0.0857170
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0790037
	speed: 0.0683s/iter; left time: 1317.8873s
	iters: 200, epoch: 14 | loss: 0.0766306
	speed: 0.0350s/iter; left time: 671.2272s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.20s
Steps: 223 | Train Loss: 0.0771826 Vali Loss: 0.0817818 Test Loss: 0.0858997
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0781479
	speed: 0.0654s/iter; left time: 1246.9404s
	iters: 200, epoch: 15 | loss: 0.0743111
	speed: 0.0345s/iter; left time: 654.7870s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0769004 Vali Loss: 0.0816473 Test Loss: 0.0860531
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0774469
	speed: 0.0654s/iter; left time: 1232.9693s
	iters: 200, epoch: 16 | loss: 0.0763741
	speed: 0.0354s/iter; left time: 664.0220s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.12s
Steps: 223 | Train Loss: 0.0765900 Vali Loss: 0.0816954 Test Loss: 0.0859498
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0787390
	speed: 0.0663s/iter; left time: 1236.1100s
	iters: 200, epoch: 17 | loss: 0.0796342
	speed: 0.0346s/iter; left time: 641.6290s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0762675 Vali Loss: 0.0815481 Test Loss: 0.0859443
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0713304
	speed: 0.0652s/iter; left time: 1201.2073s
	iters: 200, epoch: 18 | loss: 0.0787289
	speed: 0.0347s/iter; left time: 636.1353s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0761126 Vali Loss: 0.0816839 Test Loss: 0.0860736
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0760462
	speed: 0.0652s/iter; left time: 1185.8225s
	iters: 200, epoch: 19 | loss: 0.0744022
	speed: 0.0347s/iter; left time: 627.8678s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0758258 Vali Loss: 0.0815189 Test Loss: 0.0859328
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0774111
	speed: 0.0661s/iter; left time: 1186.6793s
	iters: 200, epoch: 20 | loss: 0.0786737
	speed: 0.0344s/iter; left time: 615.2253s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0756284 Vali Loss: 0.0817036 Test Loss: 0.0859395
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02019226923584938, rmse:0.1420994997024536, mae:0.08588487654924393, rse:0.5377928018569946
Intermediate time for IT and pred_len 168: 00h:06m:44.86sIntermediate time for IT: 00h:33m:18.11sTotal time: 03h:11m:14.85s