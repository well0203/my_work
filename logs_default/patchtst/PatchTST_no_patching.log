=== Starting experiments for country: DE ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1185825
	speed: 0.6688s/iter; left time: 2929.8023s
	iters: 200, epoch: 1 | loss: 0.1090781
	speed: 0.6481s/iter; left time: 2774.4317s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:02m:25.38s
Steps: 224 | Train Loss: 0.1187725 Vali Loss: 0.1100739 Test Loss: 0.1098653
Validation loss decreased (inf --> 0.110074).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0894905
	speed: 1.0742s/iter; left time: 4465.5195s
	iters: 200, epoch: 2 | loss: 0.0864838
	speed: 0.6444s/iter; left time: 2614.3216s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:02m:26.19s
Steps: 224 | Train Loss: 0.0909381 Vali Loss: 0.1002815 Test Loss: 0.1011409
Validation loss decreased (0.110074 --> 0.100282).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0831252
	speed: 1.0301s/iter; left time: 4051.2992s
	iters: 200, epoch: 3 | loss: 0.0806472
	speed: 0.6468s/iter; left time: 2479.1589s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:02m:25.18s
Steps: 224 | Train Loss: 0.0837995 Vali Loss: 0.0962656 Test Loss: 0.0981424
Validation loss decreased (0.100282 --> 0.096266).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0774977
	speed: 1.0416s/iter; left time: 3863.3389s
	iters: 200, epoch: 4 | loss: 0.0760295
	speed: 0.6417s/iter; left time: 2315.7849s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:02m:25.62s
Steps: 224 | Train Loss: 0.0802265 Vali Loss: 0.0948865 Test Loss: 0.0951428
Validation loss decreased (0.096266 --> 0.094887).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0776035
	speed: 1.0485s/iter; left time: 3653.8660s
	iters: 200, epoch: 5 | loss: 0.0754470
	speed: 0.6488s/iter; left time: 2196.3046s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:02m:26.27s
Steps: 224 | Train Loss: 0.0781352 Vali Loss: 0.0920579 Test Loss: 0.0930737
Validation loss decreased (0.094887 --> 0.092058).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0768398
	speed: 1.0371s/iter; left time: 3381.9026s
	iters: 200, epoch: 6 | loss: 0.0745844
	speed: 0.6492s/iter; left time: 2052.1100s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:02m:26.35s
Steps: 224 | Train Loss: 0.0772739 Vali Loss: 0.0921749 Test Loss: 0.0929615
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0779816
	speed: 1.0322s/iter; left time: 3134.9141s
	iters: 200, epoch: 7 | loss: 0.0759176
	speed: 0.6528s/iter; left time: 1917.2566s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:02m:26.20s
Steps: 224 | Train Loss: 0.0761425 Vali Loss: 0.0916203 Test Loss: 0.0923960
Validation loss decreased (0.092058 --> 0.091620).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0725002
	speed: 1.0339s/iter; left time: 2908.4458s
	iters: 200, epoch: 8 | loss: 0.0762453
	speed: 0.6654s/iter; left time: 1805.3610s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:02m:26.01s
Steps: 224 | Train Loss: 0.0752119 Vali Loss: 0.0908312 Test Loss: 0.0916540
Validation loss decreased (0.091620 --> 0.090831).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0725041
	speed: 1.0305s/iter; left time: 2667.9906s
	iters: 200, epoch: 9 | loss: 0.0683068
	speed: 0.6454s/iter; left time: 1606.4371s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:02m:24.63s
Steps: 224 | Train Loss: 0.0745990 Vali Loss: 0.0904099 Test Loss: 0.0917372
Validation loss decreased (0.090831 --> 0.090410).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0700386
	speed: 1.0345s/iter; left time: 2446.5496s
	iters: 200, epoch: 10 | loss: 0.0721033
	speed: 0.6512s/iter; left time: 1474.9141s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:02m:25.67s
Steps: 224 | Train Loss: 0.0740525 Vali Loss: 0.0897951 Test Loss: 0.0912578
Validation loss decreased (0.090410 --> 0.089795).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0666174
	speed: 1.0623s/iter; left time: 2274.3769s
	iters: 200, epoch: 11 | loss: 0.0760651
	speed: 0.6506s/iter; left time: 1327.8246s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:02m:27.15s
Steps: 224 | Train Loss: 0.0736123 Vali Loss: 0.0899318 Test Loss: 0.0916627
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0749207
	speed: 1.0237s/iter; left time: 1962.4604s
	iters: 200, epoch: 12 | loss: 0.0740589
	speed: 0.7478s/iter; left time: 1358.7869s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:02m:39.26s
Steps: 224 | Train Loss: 0.0732611 Vali Loss: 0.0894925 Test Loss: 0.0912984
Validation loss decreased (0.089795 --> 0.089493).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0752842
	speed: 1.2674s/iter; left time: 2145.6531s
	iters: 200, epoch: 13 | loss: 0.0713753
	speed: 0.8199s/iter; left time: 1306.1555s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:02m:58.25s
Steps: 224 | Train Loss: 0.0728936 Vali Loss: 0.0895770 Test Loss: 0.0911928
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0732628
	speed: 1.4032s/iter; left time: 2061.2683s
	iters: 200, epoch: 14 | loss: 0.0704660
	speed: 0.7742s/iter; left time: 1059.8824s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:02m:53.68s
Steps: 224 | Train Loss: 0.0725533 Vali Loss: 0.0897301 Test Loss: 0.0914722
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0720317
	speed: 1.3729s/iter; left time: 1709.2980s
	iters: 200, epoch: 15 | loss: 0.0720388
	speed: 0.7695s/iter; left time: 881.1346s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:03m:00.35s
Steps: 224 | Train Loss: 0.0724398 Vali Loss: 0.0893662 Test Loss: 0.0911104
Validation loss decreased (0.089493 --> 0.089366).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0741066
	speed: 1.4951s/iter; left time: 1526.4775s
	iters: 200, epoch: 16 | loss: 0.0676593
	speed: 0.8263s/iter; left time: 761.0263s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:03m:07.78s
Steps: 224 | Train Loss: 0.0721958 Vali Loss: 0.0895748 Test Loss: 0.0918992
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0727639
	speed: 1.3470s/iter; left time: 1073.5445s
	iters: 200, epoch: 17 | loss: 0.0744767
	speed: 0.8282s/iter; left time: 577.2719s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:03m:05.18s
Steps: 224 | Train Loss: 0.0720195 Vali Loss: 0.0894382 Test Loss: 0.0920587
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0706366
	speed: 1.3400s/iter; left time: 767.7954s
	iters: 200, epoch: 18 | loss: 0.0681392
	speed: 0.7862s/iter; left time: 371.8836s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:03m:00.68s
Steps: 224 | Train Loss: 0.0717208 Vali Loss: 0.0891432 Test Loss: 0.0911035
Validation loss decreased (0.089366 --> 0.089143).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0646649
	speed: 1.3424s/iter; left time: 468.4852s
	iters: 200, epoch: 19 | loss: 0.0705285
	speed: 0.8197s/iter; left time: 204.0946s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:03m:02.57s
Steps: 224 | Train Loss: 0.0716752 Vali Loss: 0.0893801 Test Loss: 0.0916932
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0748916
	speed: 1.3266s/iter; left time: 165.8264s
	iters: 200, epoch: 20 | loss: 0.0762143
	speed: 0.9504s/iter; left time: 23.7599s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:03m:13.58s
Steps: 224 | Train Loss: 0.0715203 Vali Loss: 0.0894523 Test Loss: 0.0925765
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021852394565939903, rmse:0.14782555401325226, mae:0.09110347926616669, rse:0.5216968655586243
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1201662
	speed: 0.6902s/iter; left time: 3023.8023s
	iters: 200, epoch: 1 | loss: 0.1083984
	speed: 0.8199s/iter; left time: 3510.1849s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:02m:51.51s
Steps: 224 | Train Loss: 0.1197711 Vali Loss: 0.1104640 Test Loss: 0.1099900
Validation loss decreased (inf --> 0.110464).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0871584
	speed: 1.5188s/iter; left time: 6313.7035s
	iters: 200, epoch: 2 | loss: 0.0852323
	speed: 0.8325s/iter; left time: 3377.4109s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:03m:07.89s
Steps: 224 | Train Loss: 0.0910880 Vali Loss: 0.0981202 Test Loss: 0.1009802
Validation loss decreased (0.110464 --> 0.098120).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0853115
	speed: 1.4874s/iter; left time: 5850.0365s
	iters: 200, epoch: 3 | loss: 0.0795056
	speed: 0.8492s/iter; left time: 3254.9814s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:03m:10.77s
Steps: 224 | Train Loss: 0.0834218 Vali Loss: 0.0952579 Test Loss: 0.0964131
Validation loss decreased (0.098120 --> 0.095258).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0764321
	speed: 1.4849s/iter; left time: 5507.3214s
	iters: 200, epoch: 4 | loss: 0.0704273
	speed: 0.8500s/iter; left time: 3067.5528s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:03m:09.02s
Steps: 224 | Train Loss: 0.0803541 Vali Loss: 0.0942130 Test Loss: 0.0944882
Validation loss decreased (0.095258 --> 0.094213).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0812252
	speed: 1.4917s/iter; left time: 5198.6443s
	iters: 200, epoch: 5 | loss: 0.0723357
	speed: 0.8511s/iter; left time: 2880.8499s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:03m:09.99s
Steps: 224 | Train Loss: 0.0780411 Vali Loss: 0.0926510 Test Loss: 0.0935687
Validation loss decreased (0.094213 --> 0.092651).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0705587
	speed: 1.4860s/iter; left time: 4845.7223s
	iters: 200, epoch: 6 | loss: 0.0729282
	speed: 0.8480s/iter; left time: 2680.6743s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:03m:09.33s
Steps: 224 | Train Loss: 0.0770898 Vali Loss: 0.0913223 Test Loss: 0.0926111
Validation loss decreased (0.092651 --> 0.091322).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0752742
	speed: 1.4621s/iter; left time: 4440.5407s
	iters: 200, epoch: 7 | loss: 0.0756757
	speed: 0.8388s/iter; left time: 2463.6334s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:03m:08.41s
Steps: 224 | Train Loss: 0.0762828 Vali Loss: 0.0902402 Test Loss: 0.0915751
Validation loss decreased (0.091322 --> 0.090240).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0777563
	speed: 1.4495s/iter; left time: 4077.5128s
	iters: 200, epoch: 8 | loss: 0.0748446
	speed: 0.8418s/iter; left time: 2283.8057s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:03m:07.98s
Steps: 224 | Train Loss: 0.0754152 Vali Loss: 0.0899461 Test Loss: 0.0914084
Validation loss decreased (0.090240 --> 0.089946).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0721380
	speed: 1.4680s/iter; left time: 3800.5822s
	iters: 200, epoch: 9 | loss: 0.0728657
	speed: 0.8333s/iter; left time: 2074.0374s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:03m:07.14s
Steps: 224 | Train Loss: 0.0746742 Vali Loss: 0.0903633 Test Loss: 0.0908017
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0710530
	speed: 1.4918s/iter; left time: 3528.1873s
	iters: 200, epoch: 10 | loss: 0.0705148
	speed: 0.8472s/iter; left time: 1919.0177s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:03m:11.14s
Steps: 224 | Train Loss: 0.0740754 Vali Loss: 0.0897875 Test Loss: 0.0912357
Validation loss decreased (0.089946 --> 0.089788).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0720897
	speed: 1.4902s/iter; left time: 3190.4692s
	iters: 200, epoch: 11 | loss: 0.0687625
	speed: 0.8463s/iter; left time: 1727.3280s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:03m:09.46s
Steps: 224 | Train Loss: 0.0735199 Vali Loss: 0.0899521 Test Loss: 0.0915615
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0725851
	speed: 1.4774s/iter; left time: 2832.1454s
	iters: 200, epoch: 12 | loss: 0.0756204
	speed: 0.8193s/iter; left time: 1488.7527s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:03m:07.48s
Steps: 224 | Train Loss: 0.0731441 Vali Loss: 0.0894233 Test Loss: 0.0906191
Validation loss decreased (0.089788 --> 0.089423).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0718960
	speed: 1.4565s/iter; left time: 2465.8815s
	iters: 200, epoch: 13 | loss: 0.0757970
	speed: 0.8378s/iter; left time: 1334.5497s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:03m:06.85s
Steps: 224 | Train Loss: 0.0727348 Vali Loss: 0.0896581 Test Loss: 0.0914745
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0716447
	speed: 1.5150s/iter; left time: 2225.6009s
	iters: 200, epoch: 14 | loss: 0.0759265
	speed: 0.8626s/iter; left time: 1180.9018s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:03m:10.92s
Steps: 224 | Train Loss: 0.0725364 Vali Loss: 0.0889910 Test Loss: 0.0906905
Validation loss decreased (0.089423 --> 0.088991).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0730583
	speed: 1.5198s/iter; left time: 1892.1442s
	iters: 200, epoch: 15 | loss: 0.0691186
	speed: 0.8478s/iter; left time: 970.6965s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:03m:12.07s
Steps: 224 | Train Loss: 0.0723537 Vali Loss: 0.0896075 Test Loss: 0.0918515
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0712389
	speed: 1.4952s/iter; left time: 1526.6150s
	iters: 200, epoch: 16 | loss: 0.0701750
	speed: 0.8390s/iter; left time: 772.7165s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:03m:09.82s
Steps: 224 | Train Loss: 0.0719971 Vali Loss: 0.0890231 Test Loss: 0.0908993
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0748366
	speed: 1.4536s/iter; left time: 1158.4845s
	iters: 200, epoch: 17 | loss: 0.0762918
	speed: 0.8353s/iter; left time: 582.2337s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:03m:07.85s
Steps: 224 | Train Loss: 0.0718654 Vali Loss: 0.0890983 Test Loss: 0.0911705
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0735894
	speed: 1.4531s/iter; left time: 832.6268s
	iters: 200, epoch: 18 | loss: 0.0716164
	speed: 0.8461s/iter; left time: 400.2154s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:03m:09.21s
Steps: 224 | Train Loss: 0.0716082 Vali Loss: 0.0896960 Test Loss: 0.0908316
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0675492
	speed: 1.4522s/iter; left time: 506.8123s
	iters: 200, epoch: 19 | loss: 0.0709308
	speed: 0.8435s/iter; left time: 210.0197s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:03m:08.09s
Steps: 224 | Train Loss: 0.0714599 Vali Loss: 0.0893303 Test Loss: 0.0912627
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021494006738066673, rmse:0.14660833775997162, mae:0.090690478682518, rse:0.5174011588096619
Intermediate time for DE and pred_len 24: 02h:17m:12.47s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1286584
	speed: 0.9340s/iter; left time: 4091.8390s
	iters: 200, epoch: 1 | loss: 0.1283274
	speed: 0.8474s/iter; left time: 3627.6502s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:03m:09.65s
Steps: 224 | Train Loss: 0.1345625 Vali Loss: 0.1315352 Test Loss: 0.1368086
Validation loss decreased (inf --> 0.131535).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1160355
	speed: 1.5376s/iter; left time: 6391.8059s
	iters: 200, epoch: 2 | loss: 0.1159737
	speed: 0.7543s/iter; left time: 3060.1617s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:02m:51.93s
Steps: 224 | Train Loss: 0.1175694 Vali Loss: 0.1254385 Test Loss: 0.1331406
Validation loss decreased (0.131535 --> 0.125439).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1108091
	speed: 1.5735s/iter; left time: 6188.4592s
	iters: 200, epoch: 3 | loss: 0.1001122
	speed: 0.8370s/iter; left time: 3208.0554s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:03m:08.50s
Steps: 224 | Train Loss: 0.1085928 Vali Loss: 0.1210968 Test Loss: 0.1298962
Validation loss decreased (0.125439 --> 0.121097).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1040234
	speed: 1.5905s/iter; left time: 5899.3342s
	iters: 200, epoch: 4 | loss: 0.1003075
	speed: 0.8453s/iter; left time: 3050.6049s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:03m:08.50s
Steps: 224 | Train Loss: 0.1052479 Vali Loss: 0.1204925 Test Loss: 0.1286892
Validation loss decreased (0.121097 --> 0.120492).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1077605
	speed: 1.5720s/iter; left time: 5478.3663s
	iters: 200, epoch: 5 | loss: 0.1053044
	speed: 0.8029s/iter; left time: 2717.9300s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:03m:03.00s
Steps: 224 | Train Loss: 0.1037430 Vali Loss: 0.1204495 Test Loss: 0.1279174
Validation loss decreased (0.120492 --> 0.120449).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1021977
	speed: 1.5619s/iter; left time: 5093.3130s
	iters: 200, epoch: 6 | loss: 0.0977674
	speed: 0.7894s/iter; left time: 2495.2815s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:02m:59.61s
Steps: 224 | Train Loss: 0.1024423 Vali Loss: 0.1194088 Test Loss: 0.1291354
Validation loss decreased (0.120449 --> 0.119409).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1003975
	speed: 1.5046s/iter; left time: 4569.3553s
	iters: 200, epoch: 7 | loss: 0.1074992
	speed: 0.8332s/iter; left time: 2447.0527s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:03m:04.41s
Steps: 224 | Train Loss: 0.1017708 Vali Loss: 0.1194237 Test Loss: 0.1292074
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1023403
	speed: 1.6401s/iter; left time: 4613.7078s
	iters: 200, epoch: 8 | loss: 0.1019197
	speed: 0.8487s/iter; left time: 2302.6512s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:03m:06.99s
Steps: 224 | Train Loss: 0.1011935 Vali Loss: 0.1189429 Test Loss: 0.1283226
Validation loss decreased (0.119409 --> 0.118943).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0991009
	speed: 1.6411s/iter; left time: 4248.7852s
	iters: 200, epoch: 9 | loss: 0.1018876
	speed: 0.8182s/iter; left time: 2036.4763s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:03m:04.46s
Steps: 224 | Train Loss: 0.1006589 Vali Loss: 0.1188852 Test Loss: 0.1294801
Validation loss decreased (0.118943 --> 0.118885).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1020254
	speed: 1.5694s/iter; left time: 3711.5246s
	iters: 200, epoch: 10 | loss: 0.1003808
	speed: 0.8315s/iter; left time: 1883.4227s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:03m:07.20s
Steps: 224 | Train Loss: 0.1001412 Vali Loss: 0.1185911 Test Loss: 0.1275851
Validation loss decreased (0.118885 --> 0.118591).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1003736
	speed: 1.5670s/iter; left time: 3355.0398s
	iters: 200, epoch: 11 | loss: 0.0996785
	speed: 0.7831s/iter; left time: 1598.3427s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:02m:58.17s
Steps: 224 | Train Loss: 0.0998360 Vali Loss: 0.1192170 Test Loss: 0.1295892
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1009651
	speed: 1.6085s/iter; left time: 3083.4932s
	iters: 200, epoch: 12 | loss: 0.1002403
	speed: 0.8107s/iter; left time: 1472.9978s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:03m:03.91s
Steps: 224 | Train Loss: 0.0993493 Vali Loss: 0.1186539 Test Loss: 0.1287528
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1009898
	speed: 1.5807s/iter; left time: 2676.0931s
	iters: 200, epoch: 13 | loss: 0.1007161
	speed: 0.8221s/iter; left time: 1309.6165s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:03m:04.25s
Steps: 224 | Train Loss: 0.0989542 Vali Loss: 0.1189050 Test Loss: 0.1297899
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0981157
	speed: 1.5740s/iter; left time: 2312.2567s
	iters: 200, epoch: 14 | loss: 0.1043117
	speed: 0.8439s/iter; left time: 1155.3286s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:03m:06.25s
Steps: 224 | Train Loss: 0.0986829 Vali Loss: 0.1192963 Test Loss: 0.1300762
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1003836
	speed: 1.5546s/iter; left time: 1935.4919s
	iters: 200, epoch: 15 | loss: 0.0967155
	speed: 0.8249s/iter; left time: 944.5546s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:03m:03.89s
Steps: 224 | Train Loss: 0.0983634 Vali Loss: 0.1188927 Test Loss: 0.1290997
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03747020289301872, rmse:0.19357222318649292, mae:0.12758517265319824, rse:0.6854783296585083
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1364218
	speed: 0.8214s/iter; left time: 3598.3893s
	iters: 200, epoch: 1 | loss: 0.1313399
	speed: 0.7984s/iter; left time: 3418.0901s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:03m:00.06s
Steps: 224 | Train Loss: 0.1353756 Vali Loss: 0.1317179 Test Loss: 0.1366934
Validation loss decreased (inf --> 0.131718).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1200846
	speed: 1.6313s/iter; left time: 6781.3599s
	iters: 200, epoch: 2 | loss: 0.1105273
	speed: 0.8539s/iter; left time: 3464.2280s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:03m:10.31s
Steps: 224 | Train Loss: 0.1165046 Vali Loss: 0.1257103 Test Loss: 0.1339367
Validation loss decreased (0.131718 --> 0.125710).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1135974
	speed: 1.6437s/iter; left time: 6464.8500s
	iters: 200, epoch: 3 | loss: 0.1066958
	speed: 0.8525s/iter; left time: 3267.5653s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:03m:13.84s
Steps: 224 | Train Loss: 0.1087123 Vali Loss: 0.1218007 Test Loss: 0.1306605
Validation loss decreased (0.125710 --> 0.121801).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1062235
	speed: 1.6802s/iter; left time: 6231.7454s
	iters: 200, epoch: 4 | loss: 0.1012442
	speed: 0.8510s/iter; left time: 3071.4385s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:03m:12.08s
Steps: 224 | Train Loss: 0.1057830 Vali Loss: 0.1204576 Test Loss: 0.1288750
Validation loss decreased (0.121801 --> 0.120458).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1029572
	speed: 1.7320s/iter; left time: 6036.0183s
	iters: 200, epoch: 5 | loss: 0.1097937
	speed: 0.8764s/iter; left time: 2966.5960s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:03m:15.04s
Steps: 224 | Train Loss: 0.1041747 Vali Loss: 0.1198968 Test Loss: 0.1290881
Validation loss decreased (0.120458 --> 0.119897).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1044354
	speed: 1.7541s/iter; left time: 5720.0084s
	iters: 200, epoch: 6 | loss: 0.1042368
	speed: 0.8483s/iter; left time: 2681.5671s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:03m:11.34s
Steps: 224 | Train Loss: 0.1030439 Vali Loss: 0.1198872 Test Loss: 0.1294045
Validation loss decreased (0.119897 --> 0.119887).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1028243
	speed: 1.7801s/iter; left time: 5406.1527s
	iters: 200, epoch: 7 | loss: 0.1059746
	speed: 0.8741s/iter; left time: 2567.0912s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:03m:15.47s
Steps: 224 | Train Loss: 0.1019859 Vali Loss: 0.1196817 Test Loss: 0.1293018
Validation loss decreased (0.119887 --> 0.119682).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1014663
	speed: 2.3313s/iter; left time: 6557.8122s
	iters: 200, epoch: 8 | loss: 0.1035754
	speed: 0.7724s/iter; left time: 2095.5189s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:03m:38.54s
Steps: 224 | Train Loss: 0.1013703 Vali Loss: 0.1194906 Test Loss: 0.1304186
Validation loss decreased (0.119682 --> 0.119491).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0996586
	speed: 1.5930s/iter; left time: 4124.2748s
	iters: 200, epoch: 9 | loss: 0.0992961
	speed: 0.8279s/iter; left time: 2060.5846s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:03m:04.67s
Steps: 224 | Train Loss: 0.1008033 Vali Loss: 0.1198257 Test Loss: 0.1310487
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1048882
	speed: 1.6737s/iter; left time: 3958.2572s
	iters: 200, epoch: 10 | loss: 0.1055110
	speed: 0.8171s/iter; left time: 1850.6817s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:03m:06.26s
Steps: 224 | Train Loss: 0.1001401 Vali Loss: 0.1198027 Test Loss: 0.1308678
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0972710
	speed: 1.6763s/iter; left time: 3588.9164s
	iters: 200, epoch: 11 | loss: 0.1006895
	speed: 0.8502s/iter; left time: 1735.2009s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:03m:08.01s
Steps: 224 | Train Loss: 0.0996930 Vali Loss: 0.1197501 Test Loss: 0.1311171
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0987459
	speed: 1.6857s/iter; left time: 3231.5802s
	iters: 200, epoch: 12 | loss: 0.1033765
	speed: 0.8450s/iter; left time: 1535.4342s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:03m:10.22s
Steps: 224 | Train Loss: 0.0991635 Vali Loss: 0.1197549 Test Loss: 0.1314769
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1000874
	speed: 1.7511s/iter; left time: 2964.6524s
	iters: 200, epoch: 13 | loss: 0.0997200
	speed: 0.8513s/iter; left time: 1356.1081s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:03m:11.01s
Steps: 224 | Train Loss: 0.0988495 Vali Loss: 0.1200454 Test Loss: 0.1321729
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.038512662053108215, rmse:0.1962464302778244, mae:0.13041862845420837, rse:0.6949483156204224
Intermediate time for DE and pred_len 96: 01h:57m:14.56s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1400413
	speed: 0.8899s/iter; left time: 3880.7776s
	iters: 200, epoch: 1 | loss: 0.1308107
	speed: 0.8546s/iter; left time: 3641.5057s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:03m:10.20s
Steps: 223 | Train Loss: 0.1382469 Vali Loss: 0.1349166 Test Loss: 0.1416962
Validation loss decreased (inf --> 0.134917).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1242591
	speed: 1.8069s/iter; left time: 7476.8304s
	iters: 200, epoch: 2 | loss: 0.1166725
	speed: 0.8570s/iter; left time: 3460.7532s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:03m:14.33s
Steps: 223 | Train Loss: 0.1226699 Vali Loss: 0.1295651 Test Loss: 0.1393560
Validation loss decreased (0.134917 --> 0.129565).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1153209
	speed: 1.7485s/iter; left time: 6845.2142s
	iters: 200, epoch: 3 | loss: 0.1126005
	speed: 0.8771s/iter; left time: 3345.9563s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:03m:15.27s
Steps: 223 | Train Loss: 0.1139000 Vali Loss: 0.1261486 Test Loss: 0.1358930
Validation loss decreased (0.129565 --> 0.126149).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1062162
	speed: 1.7090s/iter; left time: 6309.7661s
	iters: 200, epoch: 4 | loss: 0.1107251
	speed: 0.8831s/iter; left time: 3172.1049s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:03m:15.11s
Steps: 223 | Train Loss: 0.1110505 Vali Loss: 0.1244184 Test Loss: 0.1335864
Validation loss decreased (0.126149 --> 0.124418).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1084757
	speed: 1.7248s/iter; left time: 5983.3949s
	iters: 200, epoch: 5 | loss: 0.1087421
	speed: 0.8599s/iter; left time: 2897.0521s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:03m:10.65s
Steps: 223 | Train Loss: 0.1094183 Vali Loss: 0.1241783 Test Loss: 0.1338822
Validation loss decreased (0.124418 --> 0.124178).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1141112
	speed: 1.8323s/iter; left time: 5947.5092s
	iters: 200, epoch: 6 | loss: 0.1091668
	speed: 0.8817s/iter; left time: 2773.8218s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:03m:16.80s
Steps: 223 | Train Loss: 0.1086366 Vali Loss: 0.1237398 Test Loss: 0.1352959
Validation loss decreased (0.124178 --> 0.123740).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1066006
	speed: 1.8825s/iter; left time: 5690.6879s
	iters: 200, epoch: 7 | loss: 0.1082050
	speed: 0.8714s/iter; left time: 2547.0474s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:03m:18.07s
Steps: 223 | Train Loss: 0.1077990 Vali Loss: 0.1234855 Test Loss: 0.1357112
Validation loss decreased (0.123740 --> 0.123486).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1045769
	speed: 1.7335s/iter; left time: 4853.6769s
	iters: 200, epoch: 8 | loss: 0.1086057
	speed: 0.8623s/iter; left time: 2328.3074s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:03m:12.69s
Steps: 223 | Train Loss: 0.1074179 Vali Loss: 0.1231780 Test Loss: 0.1348252
Validation loss decreased (0.123486 --> 0.123178).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1079995
	speed: 1.7192s/iter; left time: 4430.4052s
	iters: 200, epoch: 9 | loss: 0.1060561
	speed: 0.8545s/iter; left time: 2116.6193s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:03m:09.60s
Steps: 223 | Train Loss: 0.1069891 Vali Loss: 0.1235725 Test Loss: 0.1355295
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1018216
	speed: 1.7313s/iter; left time: 4075.4651s
	iters: 200, epoch: 10 | loss: 0.1136913
	speed: 0.8794s/iter; left time: 1982.0896s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:03m:14.36s
Steps: 223 | Train Loss: 0.1066360 Vali Loss: 0.1234050 Test Loss: 0.1363396
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1071401
	speed: 1.7654s/iter; left time: 3762.0229s
	iters: 200, epoch: 11 | loss: 0.1049976
	speed: 0.8746s/iter; left time: 1776.3226s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:03m:14.34s
Steps: 223 | Train Loss: 0.1062648 Vali Loss: 0.1234758 Test Loss: 0.1363748
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1055855
	speed: 1.7604s/iter; left time: 3358.8136s
	iters: 200, epoch: 12 | loss: 0.1099972
	speed: 0.8517s/iter; left time: 1539.8473s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:03m:11.70s
Steps: 223 | Train Loss: 0.1059586 Vali Loss: 0.1235797 Test Loss: 0.1368409
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1016340
	speed: 1.7306s/iter; left time: 2915.9802s
	iters: 200, epoch: 13 | loss: 0.1034260
	speed: 0.8518s/iter; left time: 1350.0727s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:03m:11.89s
Steps: 223 | Train Loss: 0.1056342 Vali Loss: 0.1233136 Test Loss: 0.1364277
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.040120694786310196, rmse:0.20030151307582855, mae:0.13482515513896942, rse:0.7094841003417969
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1343999
	speed: 0.8474s/iter; left time: 3695.5296s
	iters: 200, epoch: 1 | loss: 0.1272989
	speed: 0.8469s/iter; left time: 3608.7569s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:03m:09.14s
Steps: 223 | Train Loss: 0.1386628 Vali Loss: 0.1349369 Test Loss: 0.1415361
Validation loss decreased (inf --> 0.134937).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1219488
	speed: 1.7101s/iter; left time: 7076.1974s
	iters: 200, epoch: 2 | loss: 0.1157697
	speed: 0.7994s/iter; left time: 3227.9501s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:03m:04.91s
Steps: 223 | Train Loss: 0.1217117 Vali Loss: 0.1286630 Test Loss: 0.1371584
Validation loss decreased (0.134937 --> 0.128663).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1134495
	speed: 1.6744s/iter; left time: 6555.3014s
	iters: 200, epoch: 3 | loss: 0.1091854
	speed: 0.8857s/iter; left time: 3379.1141s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:03m:12.57s
Steps: 223 | Train Loss: 0.1140187 Vali Loss: 0.1251376 Test Loss: 0.1358937
Validation loss decreased (0.128663 --> 0.125138).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1115679
	speed: 1.6663s/iter; left time: 6152.1628s
	iters: 200, epoch: 4 | loss: 0.1115438
	speed: 0.8562s/iter; left time: 3075.5739s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:03m:10.74s
Steps: 223 | Train Loss: 0.1116452 Vali Loss: 0.1244681 Test Loss: 0.1350853
Validation loss decreased (0.125138 --> 0.124468).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1106175
	speed: 1.7480s/iter; left time: 6063.7318s
	iters: 200, epoch: 5 | loss: 0.1095825
	speed: 0.8591s/iter; left time: 2894.1604s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:03m:12.89s
Steps: 223 | Train Loss: 0.1102210 Vali Loss: 0.1239026 Test Loss: 0.1343044
Validation loss decreased (0.124468 --> 0.123903).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1118471
	speed: 1.7579s/iter; left time: 5706.1713s
	iters: 200, epoch: 6 | loss: 0.1098318
	speed: 0.8545s/iter; left time: 2688.3946s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:03m:11.79s
Steps: 223 | Train Loss: 0.1090337 Vali Loss: 0.1244645 Test Loss: 0.1359817
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1072461
	speed: 1.8050s/iter; left time: 5456.6141s
	iters: 200, epoch: 7 | loss: 0.1047308
	speed: 0.8728s/iter; left time: 2551.1847s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:03m:15.02s
Steps: 223 | Train Loss: 0.1081847 Vali Loss: 0.1242444 Test Loss: 0.1349455
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0977734
	speed: 1.7448s/iter; left time: 4885.3021s
	iters: 200, epoch: 8 | loss: 0.1037813
	speed: 0.8489s/iter; left time: 2292.0101s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:03m:12.29s
Steps: 223 | Train Loss: 0.1075828 Vali Loss: 0.1239628 Test Loss: 0.1348020
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1006511
	speed: 1.7049s/iter; left time: 4393.5337s
	iters: 200, epoch: 9 | loss: 0.1090960
	speed: 0.8624s/iter; left time: 2136.0959s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:03m:11.65s
Steps: 223 | Train Loss: 0.1071309 Vali Loss: 0.1239745 Test Loss: 0.1353526
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1043709
	speed: 1.6966s/iter; left time: 3993.7451s
	iters: 200, epoch: 10 | loss: 0.1067678
	speed: 0.8641s/iter; left time: 1947.7302s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:03m:13.35s
Steps: 223 | Train Loss: 0.1066391 Vali Loss: 0.1235742 Test Loss: 0.1350486
Validation loss decreased (0.123903 --> 0.123574).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1088294
	speed: 1.7244s/iter; left time: 3674.6979s
	iters: 200, epoch: 11 | loss: 0.1030726
	speed: 0.8540s/iter; left time: 1734.3941s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:03m:11.19s
Steps: 223 | Train Loss: 0.1062802 Vali Loss: 0.1233648 Test Loss: 0.1349831
Validation loss decreased (0.123574 --> 0.123365).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1034573
	speed: 1.8148s/iter; left time: 3462.7278s
	iters: 200, epoch: 12 | loss: 0.1029600
	speed: 0.8572s/iter; left time: 1549.7427s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:03m:13.61s
Steps: 223 | Train Loss: 0.1059580 Vali Loss: 0.1236015 Test Loss: 0.1355882
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1070623
	speed: 1.7590s/iter; left time: 2963.9161s
	iters: 200, epoch: 13 | loss: 0.1071535
	speed: 0.8557s/iter; left time: 1356.2622s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:03m:11.45s
Steps: 223 | Train Loss: 0.1056516 Vali Loss: 0.1236461 Test Loss: 0.1358070
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1007426
	speed: 1.7315s/iter; left time: 2531.5073s
	iters: 200, epoch: 14 | loss: 0.1061819
	speed: 0.8401s/iter; left time: 1144.1660s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:03m:10.12s
Steps: 223 | Train Loss: 0.1053684 Vali Loss: 0.1238686 Test Loss: 0.1371689
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1087525
	speed: 1.7272s/iter; left time: 2139.9453s
	iters: 200, epoch: 15 | loss: 0.1041255
	speed: 0.8668s/iter; left time: 987.2698s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:03m:12.73s
Steps: 223 | Train Loss: 0.1050500 Vali Loss: 0.1236121 Test Loss: 0.1367470
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1058608
	speed: 1.7639s/iter; left time: 1792.1227s
	iters: 200, epoch: 16 | loss: 0.1124790
	speed: 0.8965s/iter; left time: 821.1905s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:03m:16.09s
Steps: 223 | Train Loss: 0.1047191 Vali Loss: 0.1237539 Test Loss: 0.1365166
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04019937664270401, rmse:0.2004978209733963, mae:0.1349831074476242, rse:0.7101793885231018
Intermediate time for DE and pred_len 168: 02h:07m:10.52s
Intermediate time for DE: 06h:21m:37.55s

=== Starting experiments for country: GB ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1116893
	speed: 0.8959s/iter; left time: 3925.1028s
	iters: 200, epoch: 1 | loss: 0.1038978
	speed: 0.8831s/iter; left time: 3780.6659s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:03m:14.71s
Steps: 224 | Train Loss: 0.1110849 Vali Loss: 0.1032261 Test Loss: 0.1155894
Validation loss decreased (inf --> 0.103226).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0890798
	speed: 1.5255s/iter; left time: 6341.4464s
	iters: 200, epoch: 2 | loss: 0.0849172
	speed: 0.8737s/iter; left time: 3544.7782s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:03m:15.83s
Steps: 224 | Train Loss: 0.0889122 Vali Loss: 0.0968059 Test Loss: 0.1091108
Validation loss decreased (0.103226 --> 0.096806).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0819009
	speed: 1.5297s/iter; left time: 6016.2809s
	iters: 200, epoch: 3 | loss: 0.0776293
	speed: 0.8688s/iter; left time: 3330.0201s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:03m:14.50s
Steps: 224 | Train Loss: 0.0812004 Vali Loss: 0.0940494 Test Loss: 0.1048684
Validation loss decreased (0.096806 --> 0.094049).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0770025
	speed: 1.5063s/iter; left time: 5586.7644s
	iters: 200, epoch: 4 | loss: 0.0848865
	speed: 0.8648s/iter; left time: 3121.2363s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:03m:14.27s
Steps: 224 | Train Loss: 0.0796152 Vali Loss: 0.0937369 Test Loss: 0.1047043
Validation loss decreased (0.094049 --> 0.093737).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0734676
	speed: 1.5334s/iter; left time: 5343.9518s
	iters: 200, epoch: 5 | loss: 0.0762912
	speed: 0.8661s/iter; left time: 2931.6183s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:03m:15.36s
Steps: 224 | Train Loss: 0.0783571 Vali Loss: 0.0932249 Test Loss: 0.1037360
Validation loss decreased (0.093737 --> 0.093225).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0782692
	speed: 1.4208s/iter; left time: 4633.1158s
	iters: 200, epoch: 6 | loss: 0.0721411
	speed: 0.8070s/iter; left time: 2550.9418s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:03m:02.02s
Steps: 224 | Train Loss: 0.0774817 Vali Loss: 0.0925879 Test Loss: 0.1041476
Validation loss decreased (0.093225 --> 0.092588).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0812348
	speed: 1.5342s/iter; left time: 4659.4099s
	iters: 200, epoch: 7 | loss: 0.0759008
	speed: 0.8840s/iter; left time: 2596.2167s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:03m:14.46s
Steps: 224 | Train Loss: 0.0769514 Vali Loss: 0.0922961 Test Loss: 0.1031611
Validation loss decreased (0.092588 --> 0.092296).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0749917
	speed: 1.5055s/iter; left time: 4234.8770s
	iters: 200, epoch: 8 | loss: 0.0806865
	speed: 0.8563s/iter; left time: 2323.0589s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:03m:11.90s
Steps: 224 | Train Loss: 0.0766532 Vali Loss: 0.0923761 Test Loss: 0.1039077
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0769141
	speed: 1.5225s/iter; left time: 3941.8340s
	iters: 200, epoch: 9 | loss: 0.0745924
	speed: 0.8558s/iter; left time: 2130.0009s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:03m:11.52s
Steps: 224 | Train Loss: 0.0762349 Vali Loss: 0.0921174 Test Loss: 0.1033806
Validation loss decreased (0.092296 --> 0.092117).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0747170
	speed: 1.4998s/iter; left time: 3546.9952s
	iters: 200, epoch: 10 | loss: 0.0790516
	speed: 0.8371s/iter; left time: 1895.9927s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:03m:07.94s
Steps: 224 | Train Loss: 0.0758396 Vali Loss: 0.0917899 Test Loss: 0.1031209
Validation loss decreased (0.092117 --> 0.091790).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0702004
	speed: 1.4857s/iter; left time: 3180.9334s
	iters: 200, epoch: 11 | loss: 0.0749110
	speed: 0.8391s/iter; left time: 1712.6379s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:03m:08.92s
Steps: 224 | Train Loss: 0.0755050 Vali Loss: 0.0919418 Test Loss: 0.1042525
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0728829
	speed: 1.4704s/iter; left time: 2818.7016s
	iters: 200, epoch: 12 | loss: 0.0757767
	speed: 0.8425s/iter; left time: 1530.8725s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:03m:09.42s
Steps: 224 | Train Loss: 0.0751960 Vali Loss: 0.0917938 Test Loss: 0.1037975
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0698661
	speed: 1.4651s/iter; left time: 2480.3355s
	iters: 200, epoch: 13 | loss: 0.0741580
	speed: 0.8403s/iter; left time: 1338.5192s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:03m:07.63s
Steps: 224 | Train Loss: 0.0749474 Vali Loss: 0.0923169 Test Loss: 0.1042981
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0734728
	speed: 1.4869s/iter; left time: 2184.3007s
	iters: 200, epoch: 14 | loss: 0.0667883
	speed: 0.8433s/iter; left time: 1154.5151s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:03m:09.46s
Steps: 224 | Train Loss: 0.0747666 Vali Loss: 0.0917064 Test Loss: 0.1039197
Validation loss decreased (0.091790 --> 0.091706).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0662220
	speed: 1.4713s/iter; left time: 1831.7687s
	iters: 200, epoch: 15 | loss: 0.0799081
	speed: 0.8449s/iter; left time: 967.4414s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:03m:08.89s
Steps: 224 | Train Loss: 0.0746049 Vali Loss: 0.0917562 Test Loss: 0.1039334
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0779508
	speed: 1.5109s/iter; left time: 1542.6142s
	iters: 200, epoch: 16 | loss: 0.0741158
	speed: 0.8687s/iter; left time: 800.0402s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:03m:13.68s
Steps: 224 | Train Loss: 0.0744549 Vali Loss: 0.0919189 Test Loss: 0.1040348
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0742268
	speed: 1.5145s/iter; left time: 1207.0217s
	iters: 200, epoch: 17 | loss: 0.0780587
	speed: 0.8582s/iter; left time: 598.1571s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:03m:11.58s
Steps: 224 | Train Loss: 0.0742948 Vali Loss: 0.0919655 Test Loss: 0.1043945
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0706386
	speed: 1.5120s/iter; left time: 866.3568s
	iters: 200, epoch: 18 | loss: 0.0753198
	speed: 0.8484s/iter; left time: 401.3028s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:03m:11.77s
Steps: 224 | Train Loss: 0.0741458 Vali Loss: 0.0919789 Test Loss: 0.1042754
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0694558
	speed: 1.3137s/iter; left time: 458.4893s
	iters: 200, epoch: 19 | loss: 0.0766510
	speed: 0.6998s/iter; left time: 174.2402s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:02m:44.93s
Steps: 224 | Train Loss: 0.0740221 Vali Loss: 0.0918603 Test Loss: 0.1038902
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.026621254161000252, rmse:0.16316020488739014, mae:0.10391969978809357, rse:0.5628564953804016
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1084992
	speed: 0.6800s/iter; left time: 2979.1896s
	iters: 200, epoch: 1 | loss: 0.0999074
	speed: 0.6846s/iter; left time: 2930.8014s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:02m:33.04s
Steps: 224 | Train Loss: 0.1116735 Vali Loss: 0.1036351 Test Loss: 0.1160170
Validation loss decreased (inf --> 0.103635).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0966203
	speed: 1.2673s/iter; left time: 5268.3150s
	iters: 200, epoch: 2 | loss: 0.0817607
	speed: 0.8231s/iter; left time: 3339.1742s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:03m:03.06s
Steps: 224 | Train Loss: 0.0888987 Vali Loss: 0.0972792 Test Loss: 0.1101744
Validation loss decreased (0.103635 --> 0.097279).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0799150
	speed: 1.4437s/iter; left time: 5677.8835s
	iters: 200, epoch: 3 | loss: 0.0805758
	speed: 0.8110s/iter; left time: 3108.6982s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:03m:03.18s
Steps: 224 | Train Loss: 0.0818355 Vali Loss: 0.0941807 Test Loss: 0.1062411
Validation loss decreased (0.097279 --> 0.094181).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0784878
	speed: 1.4282s/iter; left time: 5297.1938s
	iters: 200, epoch: 4 | loss: 0.0763587
	speed: 0.8138s/iter; left time: 2936.9178s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:03m:01.52s
Steps: 224 | Train Loss: 0.0791132 Vali Loss: 0.0929848 Test Loss: 0.1047919
Validation loss decreased (0.094181 --> 0.092985).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0749025
	speed: 1.3683s/iter; left time: 4768.4074s
	iters: 200, epoch: 5 | loss: 0.0754450
	speed: 0.8028s/iter; left time: 2717.4079s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:02m:58.70s
Steps: 224 | Train Loss: 0.0782957 Vali Loss: 0.0929606 Test Loss: 0.1038269
Validation loss decreased (0.092985 --> 0.092961).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0793271
	speed: 1.5037s/iter; left time: 4903.4140s
	iters: 200, epoch: 6 | loss: 0.0813081
	speed: 0.8539s/iter; left time: 2699.0884s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:03m:12.12s
Steps: 224 | Train Loss: 0.0773415 Vali Loss: 0.0923607 Test Loss: 0.1038644
Validation loss decreased (0.092961 --> 0.092361).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0782389
	speed: 1.5050s/iter; left time: 4570.6902s
	iters: 200, epoch: 7 | loss: 0.0773057
	speed: 0.8308s/iter; left time: 2440.0651s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:03m:09.70s
Steps: 224 | Train Loss: 0.0769673 Vali Loss: 0.0921593 Test Loss: 0.1032822
Validation loss decreased (0.092361 --> 0.092159).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0770141
	speed: 1.4834s/iter; left time: 4172.8993s
	iters: 200, epoch: 8 | loss: 0.0750573
	speed: 0.8219s/iter; left time: 2229.7185s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:03m:07.39s
Steps: 224 | Train Loss: 0.0764386 Vali Loss: 0.0918024 Test Loss: 0.1035269
Validation loss decreased (0.092159 --> 0.091802).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0684199
	speed: 1.4720s/iter; left time: 3811.0929s
	iters: 200, epoch: 9 | loss: 0.0699812
	speed: 0.8387s/iter; left time: 2087.4136s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:03m:08.70s
Steps: 224 | Train Loss: 0.0761223 Vali Loss: 0.0920349 Test Loss: 0.1038026
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0787783
	speed: 1.4548s/iter; left time: 3440.6238s
	iters: 200, epoch: 10 | loss: 0.0783952
	speed: 0.7669s/iter; left time: 1736.9723s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:02m:58.88s
Steps: 224 | Train Loss: 0.0757484 Vali Loss: 0.0919563 Test Loss: 0.1029629
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0753692
	speed: 1.4349s/iter; left time: 3072.1642s
	iters: 200, epoch: 11 | loss: 0.0728229
	speed: 0.8486s/iter; left time: 1731.9977s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:03m:07.79s
Steps: 224 | Train Loss: 0.0755147 Vali Loss: 0.0919968 Test Loss: 0.1047305
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0715075
	speed: 1.5133s/iter; left time: 2900.9155s
	iters: 200, epoch: 12 | loss: 0.0739322
	speed: 0.8266s/iter; left time: 1501.8796s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:03m:06.30s
Steps: 224 | Train Loss: 0.0752598 Vali Loss: 0.0923253 Test Loss: 0.1040638
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0775367
	speed: 1.4810s/iter; left time: 2507.3889s
	iters: 200, epoch: 13 | loss: 0.0789441
	speed: 0.8396s/iter; left time: 1337.5059s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:03m:08.59s
Steps: 224 | Train Loss: 0.0750797 Vali Loss: 0.0919649 Test Loss: 0.1041826
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02626371942460537, rmse:0.16206085681915283, mae:0.10352689772844315, rse:0.5590639710426331
Intermediate time for GB and pred_len 24: 02h:03m:14.10s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1252335
	speed: 0.8947s/iter; left time: 3919.6867s
	iters: 200, epoch: 1 | loss: 0.1201171
	speed: 0.8332s/iter; left time: 3567.1273s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:03m:06.99s
Steps: 224 | Train Loss: 0.1246595 Vali Loss: 0.1228046 Test Loss: 0.1431150
Validation loss decreased (inf --> 0.122805).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1149061
	speed: 1.6577s/iter; left time: 6891.1368s
	iters: 200, epoch: 2 | loss: 0.1042059
	speed: 0.8480s/iter; left time: 3440.4919s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:03m:06.84s
Steps: 224 | Train Loss: 0.1117659 Vali Loss: 0.1201113 Test Loss: 0.1403482
Validation loss decreased (0.122805 --> 0.120111).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1069597
	speed: 1.7151s/iter; left time: 6745.3664s
	iters: 200, epoch: 3 | loss: 0.1021630
	speed: 0.8387s/iter; left time: 3214.5781s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:03m:08.73s
Steps: 224 | Train Loss: 0.1052783 Vali Loss: 0.1193737 Test Loss: 0.1403535
Validation loss decreased (0.120111 --> 0.119374).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1045493
	speed: 1.7337s/iter; left time: 6430.3361s
	iters: 200, epoch: 4 | loss: 0.0997706
	speed: 0.8424s/iter; left time: 3040.2571s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:03m:09.74s
Steps: 224 | Train Loss: 0.1036617 Vali Loss: 0.1194295 Test Loss: 0.1381266
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1030175
	speed: 1.7161s/iter; left time: 5980.4878s
	iters: 200, epoch: 5 | loss: 0.1078746
	speed: 0.8664s/iter; left time: 2932.6201s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:03m:12.60s
Steps: 224 | Train Loss: 0.1025570 Vali Loss: 0.1188874 Test Loss: 0.1394207
Validation loss decreased (0.119374 --> 0.118887).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1021968
	speed: 1.7392s/iter; left time: 5671.6279s
	iters: 200, epoch: 6 | loss: 0.1011541
	speed: 0.8588s/iter; left time: 2714.5515s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:03m:15.16s
Steps: 224 | Train Loss: 0.1016647 Vali Loss: 0.1199620 Test Loss: 0.1390563
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0985276
	speed: 1.7798s/iter; left time: 5405.3696s
	iters: 200, epoch: 7 | loss: 0.1043604
	speed: 0.8527s/iter; left time: 2504.3101s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:03m:12.22s
Steps: 224 | Train Loss: 0.1007115 Vali Loss: 0.1197896 Test Loss: 0.1403841
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1001039
	speed: 1.7219s/iter; left time: 4843.8043s
	iters: 200, epoch: 8 | loss: 0.1033350
	speed: 0.8533s/iter; left time: 2315.0184s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:03m:11.03s
Steps: 224 | Train Loss: 0.1001557 Vali Loss: 0.1202944 Test Loss: 0.1393946
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0982785
	speed: 1.6656s/iter; left time: 4312.2334s
	iters: 200, epoch: 9 | loss: 0.1042185
	speed: 0.8577s/iter; left time: 2134.8288s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:03m:10.93s
Steps: 224 | Train Loss: 0.0997188 Vali Loss: 0.1200153 Test Loss: 0.1401132
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0954204
	speed: 1.7502s/iter; left time: 4139.2094s
	iters: 200, epoch: 10 | loss: 0.1010626
	speed: 0.8743s/iter; left time: 1980.2128s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:03m:15.95s
Steps: 224 | Train Loss: 0.0993233 Vali Loss: 0.1199207 Test Loss: 0.1392622
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04243852570652962, rmse:0.20600612461566925, mae:0.13942068815231323, rse:0.7123979330062866
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1213994
	speed: 0.8481s/iter; left time: 3715.4370s
	iters: 200, epoch: 1 | loss: 0.1157816
	speed: 0.8547s/iter; left time: 3659.0057s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:03m:10.57s
Steps: 224 | Train Loss: 0.1246331 Vali Loss: 0.1226478 Test Loss: 0.1431716
Validation loss decreased (inf --> 0.122648).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1097208
	speed: 1.6775s/iter; left time: 6973.5719s
	iters: 200, epoch: 2 | loss: 0.1022605
	speed: 0.8425s/iter; left time: 3417.9541s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:03m:09.36s
Steps: 224 | Train Loss: 0.1115726 Vali Loss: 0.1201536 Test Loss: 0.1400796
Validation loss decreased (0.122648 --> 0.120154).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1016258
	speed: 1.7072s/iter; left time: 6714.4824s
	iters: 200, epoch: 3 | loss: 0.1017843
	speed: 0.8483s/iter; left time: 3251.5941s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:03m:09.16s
Steps: 224 | Train Loss: 0.1053649 Vali Loss: 0.1187505 Test Loss: 0.1394587
Validation loss decreased (0.120154 --> 0.118751).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1072599
	speed: 1.7390s/iter; left time: 6450.0632s
	iters: 200, epoch: 4 | loss: 0.1007376
	speed: 0.8765s/iter; left time: 3163.3199s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:03m:16.15s
Steps: 224 | Train Loss: 0.1034409 Vali Loss: 0.1196524 Test Loss: 0.1391735
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1053430
	speed: 1.7610s/iter; left time: 6137.0463s
	iters: 200, epoch: 5 | loss: 0.1057364
	speed: 0.8451s/iter; left time: 2860.6046s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:03m:10.68s
Steps: 224 | Train Loss: 0.1023294 Vali Loss: 0.1185409 Test Loss: 0.1385030
Validation loss decreased (0.118751 --> 0.118541).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1058340
	speed: 1.6907s/iter; left time: 5513.3094s
	iters: 200, epoch: 6 | loss: 0.1048339
	speed: 1.0748s/iter; left time: 3397.4975s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:03m:46.13s
Steps: 224 | Train Loss: 0.1016991 Vali Loss: 0.1183163 Test Loss: 0.1388204
Validation loss decreased (0.118541 --> 0.118316).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1021866
	speed: 1.6960s/iter; left time: 5150.9019s
	iters: 200, epoch: 7 | loss: 0.1028333
	speed: 0.7745s/iter; left time: 2274.7246s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:02m:54.27s
Steps: 224 | Train Loss: 0.1008699 Vali Loss: 0.1182164 Test Loss: 0.1383967
Validation loss decreased (0.118316 --> 0.118216).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0997323
	speed: 1.7355s/iter; left time: 4881.9588s
	iters: 200, epoch: 8 | loss: 0.1055382
	speed: 0.8556s/iter; left time: 2321.2394s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:03m:10.32s
Steps: 224 | Train Loss: 0.1004637 Vali Loss: 0.1179797 Test Loss: 0.1388233
Validation loss decreased (0.118216 --> 0.117980).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1006353
	speed: 1.7252s/iter; left time: 4466.5448s
	iters: 200, epoch: 9 | loss: 0.1000371
	speed: 0.8375s/iter; left time: 2084.5308s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:03m:08.54s
Steps: 224 | Train Loss: 0.1000307 Vali Loss: 0.1185631 Test Loss: 0.1388896
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0983968
	speed: 1.7024s/iter; left time: 4026.1124s
	iters: 200, epoch: 10 | loss: 0.0981454
	speed: 0.8492s/iter; left time: 1923.4986s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:03m:09.87s
Steps: 224 | Train Loss: 0.0995587 Vali Loss: 0.1187217 Test Loss: 0.1394587
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0945402
	speed: 1.6826s/iter; left time: 3602.5143s
	iters: 200, epoch: 11 | loss: 0.1004767
	speed: 0.8392s/iter; left time: 1712.7929s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:03m:07.38s
Steps: 224 | Train Loss: 0.0991112 Vali Loss: 0.1180590 Test Loss: 0.1385924
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1008899
	speed: 1.7303s/iter; left time: 3316.9489s
	iters: 200, epoch: 12 | loss: 0.1023057
	speed: 0.8639s/iter; left time: 1569.6895s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:03m:13.29s
Steps: 224 | Train Loss: 0.0988884 Vali Loss: 0.1189626 Test Loss: 0.1391280
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0995492
	speed: 1.7523s/iter; left time: 2966.6760s
	iters: 200, epoch: 13 | loss: 0.0980858
	speed: 0.8459s/iter; left time: 1347.4559s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:03m:08.48s
Steps: 224 | Train Loss: 0.0985649 Vali Loss: 0.1183671 Test Loss: 0.1400267
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04178399592638016, rmse:0.2044113427400589, mae:0.13882331550121307, rse:0.706882894039154
Intermediate time for GB and pred_len 96: 01h:39m:54.88s

=== Starting experiments for country: GB ===


=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1262437
	speed: 0.9538s/iter; left time: 4159.6182s
	iters: 200, epoch: 1 | loss: 0.1255427
	speed: 0.8996s/iter; left time: 3833.3320s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:03m:19.83s
Steps: 223 | Train Loss: 0.1275161 Vali Loss: 0.1261149 Test Loss: 0.1482998
Validation loss decreased (inf --> 0.126115).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1220572
	speed: 1.8902s/iter; left time: 7821.8090s
	iters: 200, epoch: 2 | loss: 0.1127881
	speed: 0.9023s/iter; left time: 3643.5770s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:03m:17.41s
Steps: 223 | Train Loss: 0.1161988 Vali Loss: 0.1244968 Test Loss: 0.1460275
Validation loss decreased (0.126115 --> 0.124497).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1119694
	speed: 1.9300s/iter; left time: 7555.9896s
	iters: 200, epoch: 3 | loss: 0.1092657
	speed: 0.8274s/iter; left time: 3156.3517s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:03m:10.65s
Steps: 223 | Train Loss: 0.1098035 Vali Loss: 0.1232283 Test Loss: 0.1448834
Validation loss decreased (0.124497 --> 0.123228).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1035951
	speed: 1.3706s/iter; left time: 5060.4192s
	iters: 200, epoch: 4 | loss: 0.1102420
	speed: 0.6575s/iter; left time: 2361.8000s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:02m:26.76s
Steps: 223 | Train Loss: 0.1084558 Vali Loss: 0.1238444 Test Loss: 0.1453509
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1056152
	speed: 1.1736s/iter; left time: 4071.1935s
	iters: 200, epoch: 5 | loss: 0.1081839
	speed: 0.8627s/iter; left time: 2906.5332s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:02m:58.35s
Steps: 223 | Train Loss: 0.1070753 Vali Loss: 0.1249096 Test Loss: 0.1445197
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1071108
	speed: 1.8306s/iter; left time: 5942.1042s
	iters: 200, epoch: 6 | loss: 0.1073095
	speed: 0.8727s/iter; left time: 2745.4559s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:03m:15.48s
Steps: 223 | Train Loss: 0.1061970 Vali Loss: 0.1237516 Test Loss: 0.1443963
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1042712
	speed: 1.7341s/iter; left time: 5242.2331s
	iters: 200, epoch: 7 | loss: 0.1047149
	speed: 0.8167s/iter; left time: 2387.1709s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:03m:03.62s
Steps: 223 | Train Loss: 0.1054054 Vali Loss: 0.1249201 Test Loss: 0.1452798
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1045145
	speed: 1.7474s/iter; left time: 4892.7160s
	iters: 200, epoch: 8 | loss: 0.1070593
	speed: 0.8463s/iter; left time: 2285.0487s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:03m:10.36s
Steps: 223 | Train Loss: 0.1048996 Vali Loss: 0.1254642 Test Loss: 0.1453099
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.044780973345041275, rmse:0.2116151601076126, mae:0.1448834091424942, rse:0.733700156211853
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1253674
	speed: 0.8461s/iter; left time: 3689.7430s
	iters: 200, epoch: 1 | loss: 0.1180807
	speed: 0.8716s/iter; left time: 3714.0467s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:03m:11.62s
Steps: 223 | Train Loss: 0.1275907 Vali Loss: 0.1263502 Test Loss: 0.1479516
Validation loss decreased (inf --> 0.126350).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1199527
	speed: 1.8185s/iter; left time: 7524.9905s
	iters: 200, epoch: 2 | loss: 0.1128289
	speed: 0.8420s/iter; left time: 3400.1803s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:03m:12.27s
Steps: 223 | Train Loss: 0.1153434 Vali Loss: 0.1239250 Test Loss: 0.1455328
Validation loss decreased (0.126350 --> 0.123925).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1058768
	speed: 1.8700s/iter; left time: 7321.1467s
	iters: 200, epoch: 3 | loss: 0.1119004
	speed: 0.8515s/iter; left time: 3248.6056s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:03m:13.60s
Steps: 223 | Train Loss: 0.1095921 Vali Loss: 0.1235483 Test Loss: 0.1450385
Validation loss decreased (0.123925 --> 0.123548).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1080894
	speed: 1.8161s/iter; left time: 6704.9456s
	iters: 200, epoch: 4 | loss: 0.1080989
	speed: 0.8845s/iter; left time: 3176.9568s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:03m:14.79s
Steps: 223 | Train Loss: 0.1078938 Vali Loss: 0.1241412 Test Loss: 0.1448997
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1067806
	speed: 1.5769s/iter; left time: 5470.4197s
	iters: 200, epoch: 5 | loss: 0.1051023
	speed: 0.6739s/iter; left time: 2270.5015s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:02m:30.55s
Steps: 223 | Train Loss: 0.1067980 Vali Loss: 0.1239786 Test Loss: 0.1435250
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1036594
	speed: 1.3350s/iter; left time: 4333.2921s
	iters: 200, epoch: 6 | loss: 0.1027717
	speed: 0.7261s/iter; left time: 2284.2103s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:02m:41.84s
Steps: 223 | Train Loss: 0.1059389 Vali Loss: 0.1244342 Test Loss: 0.1451251
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1044913
	speed: 1.3224s/iter; left time: 3997.4924s
	iters: 200, epoch: 7 | loss: 0.1042593
	speed: 0.7415s/iter; left time: 2167.3433s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:02m:45.64s
Steps: 223 | Train Loss: 0.1053292 Vali Loss: 0.1232965 Test Loss: 0.1446349
Validation loss decreased (0.123548 --> 0.123297).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1084356
	speed: 1.3072s/iter; left time: 3660.2365s
	iters: 200, epoch: 8 | loss: 0.1020323
	speed: 0.7299s/iter; left time: 1970.6022s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:02m:43.10s
Steps: 223 | Train Loss: 0.1047977 Vali Loss: 0.1237958 Test Loss: 0.1456516
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1023016
	speed: 1.2202s/iter; left time: 3144.3819s
	iters: 200, epoch: 9 | loss: 0.1056232
	speed: 0.8348s/iter; left time: 2067.8575s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:02m:53.63s
Steps: 223 | Train Loss: 0.1042798 Vali Loss: 0.1225102 Test Loss: 0.1441709
Validation loss decreased (0.123297 --> 0.122510).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1050892
	speed: 2.1071s/iter; left time: 4960.0625s
	iters: 200, epoch: 10 | loss: 0.1061154
	speed: 0.9119s/iter; left time: 2055.4900s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:03m:27.36s
Steps: 223 | Train Loss: 0.1037750 Vali Loss: 0.1231186 Test Loss: 0.1447400
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1047578
	speed: 2.0821s/iter; left time: 4436.9028s
	iters: 200, epoch: 11 | loss: 0.1035429
	speed: 0.9084s/iter; left time: 1845.0420s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:03m:23.18s
Steps: 223 | Train Loss: 0.1034640 Vali Loss: 0.1233780 Test Loss: 0.1461038
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1028577
	speed: 2.1453s/iter; left time: 4093.2577s
	iters: 200, epoch: 12 | loss: 0.1016717
	speed: 0.9171s/iter; left time: 1658.1602s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:03m:25.01s
Steps: 223 | Train Loss: 0.1030662 Vali Loss: 0.1233430 Test Loss: 0.1459888
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0997995
	speed: 2.0742s/iter; left time: 3495.0310s
	iters: 200, epoch: 13 | loss: 0.1027487
	speed: 0.9356s/iter; left time: 1482.9997s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:03m:25.97s
Steps: 223 | Train Loss: 0.1027875 Vali Loss: 0.1235063 Test Loss: 0.1458432
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0962730
	speed: 2.1455s/iter; left time: 3136.7930s
	iters: 200, epoch: 14 | loss: 0.1029050
	speed: 0.9132s/iter; left time: 1243.7327s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:03m:24.37s
Steps: 223 | Train Loss: 0.1024660 Vali Loss: 0.1232413 Test Loss: 0.1458410
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.0439450778067112, rmse:0.2096308171749115, mae:0.1441708207130432, rse:0.7268201112747192
Intermediate time for GB and pred_len 168: 01h:36m:01.40s
Intermediate time for GB: 01h:36m:01.40s


=== Starting experiments for country: ES ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1029446
	speed: 0.5130s/iter; left time: 2247.2404s
	iters: 200, epoch: 1 | loss: 0.0990795
	speed: 0.4651s/iter; left time: 1991.2373s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:46.26s
Steps: 224 | Train Loss: 0.1079208 Vali Loss: 0.0759579 Test Loss: 0.0847905
Validation loss decreased (inf --> 0.075958).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0776041
	speed: 0.9138s/iter; left time: 3798.5559s
	iters: 200, epoch: 2 | loss: 0.0662459
	speed: 0.4663s/iter; left time: 1891.7080s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:49.94s
Steps: 224 | Train Loss: 0.0756754 Vali Loss: 0.0681889 Test Loss: 0.0746097
Validation loss decreased (0.075958 --> 0.068189).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0684085
	speed: 0.8864s/iter; left time: 3486.3620s
	iters: 200, epoch: 3 | loss: 0.0653357
	speed: 0.4730s/iter; left time: 1813.0152s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:47.36s
Steps: 224 | Train Loss: 0.0677710 Vali Loss: 0.0649290 Test Loss: 0.0719882
Validation loss decreased (0.068189 --> 0.064929).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0651796
	speed: 0.8669s/iter; left time: 3215.2448s
	iters: 200, epoch: 4 | loss: 0.0659340
	speed: 0.4748s/iter; left time: 1713.4052s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:46.58s
Steps: 224 | Train Loss: 0.0651402 Vali Loss: 0.0636680 Test Loss: 0.0708732
Validation loss decreased (0.064929 --> 0.063668).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0599553
	speed: 0.8757s/iter; left time: 3051.9186s
	iters: 200, epoch: 5 | loss: 0.0627105
	speed: 0.4733s/iter; left time: 1602.2809s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:47.22s
Steps: 224 | Train Loss: 0.0625719 Vali Loss: 0.0618946 Test Loss: 0.0692723
Validation loss decreased (0.063668 --> 0.061895).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0587988
	speed: 0.7268s/iter; left time: 2369.9770s
	iters: 200, epoch: 6 | loss: 0.0571924
	speed: 0.4101s/iter; left time: 1296.1887s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:33.01s
Steps: 224 | Train Loss: 0.0606071 Vali Loss: 0.0595530 Test Loss: 0.0669068
Validation loss decreased (0.061895 --> 0.059553).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0607307
	speed: 0.7002s/iter; left time: 2126.5190s
	iters: 200, epoch: 7 | loss: 0.0586838
	speed: 0.4155s/iter; left time: 1220.4534s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:33.06s
Steps: 224 | Train Loss: 0.0592641 Vali Loss: 0.0591412 Test Loss: 0.0664582
Validation loss decreased (0.059553 --> 0.059141).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0567253
	speed: 0.7093s/iter; left time: 1995.2450s
	iters: 200, epoch: 8 | loss: 0.0580647
	speed: 0.4175s/iter; left time: 1132.7368s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:33.52s
Steps: 224 | Train Loss: 0.0582934 Vali Loss: 0.0591095 Test Loss: 0.0662979
Validation loss decreased (0.059141 --> 0.059110).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0610105
	speed: 0.7011s/iter; left time: 1815.0298s
	iters: 200, epoch: 9 | loss: 0.0524651
	speed: 0.4154s/iter; left time: 1034.0471s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:33.54s
Steps: 224 | Train Loss: 0.0575675 Vali Loss: 0.0583953 Test Loss: 0.0656035
Validation loss decreased (0.059110 --> 0.058395).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0585550
	speed: 0.7002s/iter; left time: 1656.0559s
	iters: 200, epoch: 10 | loss: 0.0530401
	speed: 0.4159s/iter; left time: 942.0187s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:33.48s
Steps: 224 | Train Loss: 0.0571272 Vali Loss: 0.0575555 Test Loss: 0.0649217
Validation loss decreased (0.058395 --> 0.057555).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0531184
	speed: 0.7277s/iter; left time: 1558.1031s
	iters: 200, epoch: 11 | loss: 0.0544947
	speed: 0.3943s/iter; left time: 804.8646s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:29.84s
Steps: 224 | Train Loss: 0.0566428 Vali Loss: 0.0574256 Test Loss: 0.0651745
Validation loss decreased (0.057555 --> 0.057426).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0586503
	speed: 0.7934s/iter; left time: 1521.0381s
	iters: 200, epoch: 12 | loss: 0.0599026
	speed: 0.4468s/iter; left time: 811.7756s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:40.21s
Steps: 224 | Train Loss: 0.0562778 Vali Loss: 0.0575190 Test Loss: 0.0651269
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0554091
	speed: 0.8892s/iter; left time: 1505.3692s
	iters: 200, epoch: 13 | loss: 0.0555284
	speed: 0.4425s/iter; left time: 704.9628s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:01m:40.66s
Steps: 224 | Train Loss: 0.0558332 Vali Loss: 0.0575139 Test Loss: 0.0649289
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0546675
	speed: 0.8115s/iter; left time: 1192.1205s
	iters: 200, epoch: 14 | loss: 0.0538944
	speed: 0.4502s/iter; left time: 616.3436s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:01m:41.16s
Steps: 224 | Train Loss: 0.0555734 Vali Loss: 0.0573127 Test Loss: 0.0645391
Validation loss decreased (0.057426 --> 0.057313).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0518334
	speed: 0.8015s/iter; left time: 997.8246s
	iters: 200, epoch: 15 | loss: 0.0562424
	speed: 0.4553s/iter; left time: 521.2724s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:41.96s
Steps: 224 | Train Loss: 0.0554358 Vali Loss: 0.0570852 Test Loss: 0.0642410
Validation loss decreased (0.057313 --> 0.057085).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0567232
	speed: 0.8106s/iter; left time: 827.6014s
	iters: 200, epoch: 16 | loss: 0.0532635
	speed: 0.4531s/iter; left time: 417.2761s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:41.59s
Steps: 224 | Train Loss: 0.0551189 Vali Loss: 0.0569095 Test Loss: 0.0640773
Validation loss decreased (0.057085 --> 0.056909).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0566243
	speed: 0.8134s/iter; left time: 648.2597s
	iters: 200, epoch: 17 | loss: 0.0531764
	speed: 0.4506s/iter; left time: 314.0935s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:42.29s
Steps: 224 | Train Loss: 0.0549043 Vali Loss: 0.0567856 Test Loss: 0.0639867
Validation loss decreased (0.056909 --> 0.056786).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0531949
	speed: 0.8984s/iter; left time: 514.7581s
	iters: 200, epoch: 18 | loss: 0.0508188
	speed: 0.4556s/iter; left time: 215.5000s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:50.09s
Steps: 224 | Train Loss: 0.0545764 Vali Loss: 0.0564090 Test Loss: 0.0634984
Validation loss decreased (0.056786 --> 0.056409).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0523050
	speed: 0.8457s/iter; left time: 295.1415s
	iters: 200, epoch: 19 | loss: 0.0540444
	speed: 0.4468s/iter; left time: 111.2544s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:41.00s
Steps: 224 | Train Loss: 0.0545186 Vali Loss: 0.0565756 Test Loss: 0.0637340
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0527570
	speed: 0.8920s/iter; left time: 111.5052s
	iters: 200, epoch: 20 | loss: 0.0542966
	speed: 0.4556s/iter; left time: 11.3908s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:42.46s
Steps: 224 | Train Loss: 0.0543701 Vali Loss: 0.0568146 Test Loss: 0.0637774
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010762921534478664, rmse:0.1037444993853569, mae:0.06349841505289078, rse:0.3053075075149536
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1032665
	speed: 0.4565s/iter; left time: 1999.9374s
	iters: 200, epoch: 1 | loss: 0.0991914
	speed: 0.4504s/iter; left time: 1928.2830s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:41.57s
Steps: 224 | Train Loss: 0.1096127 Vali Loss: 0.0768486 Test Loss: 0.0859218
Validation loss decreased (inf --> 0.076849).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0739522
	speed: 0.8021s/iter; left time: 3334.4136s
	iters: 200, epoch: 2 | loss: 0.0696664
	speed: 0.4547s/iter; left time: 1844.6928s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:40.95s
Steps: 224 | Train Loss: 0.0758878 Vali Loss: 0.0693194 Test Loss: 0.0760165
Validation loss decreased (0.076849 --> 0.069319).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0686753
	speed: 0.8329s/iter; left time: 3275.9790s
	iters: 200, epoch: 3 | loss: 0.0651648
	speed: 0.4527s/iter; left time: 1735.1894s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:41.65s
Steps: 224 | Train Loss: 0.0674712 Vali Loss: 0.0642719 Test Loss: 0.0714982
Validation loss decreased (0.069319 --> 0.064272).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0618553
	speed: 0.8213s/iter; left time: 3046.1647s
	iters: 200, epoch: 4 | loss: 0.0630430
	speed: 0.4461s/iter; left time: 1610.1316s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:40.66s
Steps: 224 | Train Loss: 0.0647203 Vali Loss: 0.0636634 Test Loss: 0.0706875
Validation loss decreased (0.064272 --> 0.063663).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0618326
	speed: 0.8265s/iter; left time: 2880.4149s
	iters: 200, epoch: 5 | loss: 0.0637024
	speed: 0.4418s/iter; left time: 1495.3550s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:39.85s
Steps: 224 | Train Loss: 0.0622671 Vali Loss: 0.0612872 Test Loss: 0.0688221
Validation loss decreased (0.063663 --> 0.061287).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0615858
	speed: 0.7996s/iter; left time: 2607.3391s
	iters: 200, epoch: 6 | loss: 0.0575338
	speed: 0.4339s/iter; left time: 1371.6939s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:38.19s
Steps: 224 | Train Loss: 0.0604503 Vali Loss: 0.0591435 Test Loss: 0.0662856
Validation loss decreased (0.061287 --> 0.059143).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0611197
	speed: 0.6582s/iter; left time: 1998.8895s
	iters: 200, epoch: 7 | loss: 0.0593193
	speed: 0.4431s/iter; left time: 1301.2635s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:34.88s
Steps: 224 | Train Loss: 0.0589661 Vali Loss: 0.0588702 Test Loss: 0.0661415
Validation loss decreased (0.059143 --> 0.058870).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0578592
	speed: 0.8135s/iter; left time: 2288.3704s
	iters: 200, epoch: 8 | loss: 0.0538578
	speed: 0.4504s/iter; left time: 1221.8475s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:41.38s
Steps: 224 | Train Loss: 0.0580438 Vali Loss: 0.0579257 Test Loss: 0.0652300
Validation loss decreased (0.058870 --> 0.057926).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0591956
	speed: 0.8046s/iter; left time: 2083.1901s
	iters: 200, epoch: 9 | loss: 0.0582842
	speed: 0.4428s/iter; left time: 1102.0574s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:40.67s
Steps: 224 | Train Loss: 0.0573978 Vali Loss: 0.0580860 Test Loss: 0.0652464
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0573916
	speed: 0.8014s/iter; left time: 1895.1967s
	iters: 200, epoch: 10 | loss: 0.0535634
	speed: 0.4453s/iter; left time: 1008.6529s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:41.13s
Steps: 224 | Train Loss: 0.0568957 Vali Loss: 0.0578221 Test Loss: 0.0650002
Validation loss decreased (0.057926 --> 0.057822).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0559630
	speed: 0.8002s/iter; left time: 1713.1513s
	iters: 200, epoch: 11 | loss: 0.0524693
	speed: 0.4573s/iter; left time: 933.3707s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:41.89s
Steps: 224 | Train Loss: 0.0564283 Vali Loss: 0.0570378 Test Loss: 0.0641107
Validation loss decreased (0.057822 --> 0.057038).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0554577
	speed: 0.8079s/iter; left time: 1548.8350s
	iters: 200, epoch: 12 | loss: 0.0555868
	speed: 0.4505s/iter; left time: 818.4885s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:41.57s
Steps: 224 | Train Loss: 0.0559803 Vali Loss: 0.0570644 Test Loss: 0.0641625
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0542900
	speed: 0.8066s/iter; left time: 1365.6425s
	iters: 200, epoch: 13 | loss: 0.0591467
	speed: 0.4448s/iter; left time: 708.4925s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:01m:40.06s
Steps: 224 | Train Loss: 0.0557331 Vali Loss: 0.0568308 Test Loss: 0.0637137
Validation loss decreased (0.057038 --> 0.056831).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0526479
	speed: 0.7983s/iter; left time: 1172.7316s
	iters: 200, epoch: 14 | loss: 0.0584162
	speed: 0.4526s/iter; left time: 619.6040s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:01m:41.35s
Steps: 224 | Train Loss: 0.0552549 Vali Loss: 0.0565104 Test Loss: 0.0632669
Validation loss decreased (0.056831 --> 0.056510).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0575271
	speed: 0.8076s/iter; left time: 1005.4123s
	iters: 200, epoch: 15 | loss: 0.0553147
	speed: 0.4536s/iter; left time: 519.4191s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:41.62s
Steps: 224 | Train Loss: 0.0550015 Vali Loss: 0.0562629 Test Loss: 0.0633010
Validation loss decreased (0.056510 --> 0.056263).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0567195
	speed: 0.7877s/iter; left time: 804.2652s
	iters: 200, epoch: 16 | loss: 0.0545197
	speed: 0.4524s/iter; left time: 416.6628s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:40.94s
Steps: 224 | Train Loss: 0.0547239 Vali Loss: 0.0562044 Test Loss: 0.0631984
Validation loss decreased (0.056263 --> 0.056204).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0529404
	speed: 0.8306s/iter; left time: 661.9819s
	iters: 200, epoch: 17 | loss: 0.0550891
	speed: 0.4498s/iter; left time: 313.5057s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:41.12s
Steps: 224 | Train Loss: 0.0546247 Vali Loss: 0.0562394 Test Loss: 0.0631969
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0533830
	speed: 0.8159s/iter; left time: 467.5074s
	iters: 200, epoch: 18 | loss: 0.0568826
	speed: 0.4441s/iter; left time: 210.0669s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:41.47s
Steps: 224 | Train Loss: 0.0543704 Vali Loss: 0.0562169 Test Loss: 0.0630499
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0529612
	speed: 0.8206s/iter; left time: 286.3728s
	iters: 200, epoch: 19 | loss: 0.0535058
	speed: 0.4438s/iter; left time: 110.4981s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:41.06s
Steps: 224 | Train Loss: 0.0541535 Vali Loss: 0.0560991 Test Loss: 0.0629003
Validation loss decreased (0.056204 --> 0.056099).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0550337
	speed: 0.8179s/iter; left time: 102.2405s
	iters: 200, epoch: 20 | loss: 0.0525426
	speed: 0.4436s/iter; left time: 11.0898s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:40.56s
Steps: 224 | Train Loss: 0.0540673 Vali Loss: 0.0558894 Test Loss: 0.0629101
Validation loss decreased (0.056099 --> 0.055889).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010615193285048008, rmse:0.10303006321191788, mae:0.06291008740663528, rse:0.3032050132751465
Intermediate time for ES and pred_len 24: 01h:24m:09.67s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1167136
	speed: 0.5732s/iter; left time: 2511.1870s
	iters: 200, epoch: 1 | loss: 0.1113692
	speed: 0.5014s/iter; left time: 2146.3245s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:57.53s
Steps: 224 | Train Loss: 0.1193400 Vali Loss: 0.0932128 Test Loss: 0.1051226
Validation loss decreased (inf --> 0.093213).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0965767
	speed: 1.0636s/iter; left time: 4421.3832s
	iters: 200, epoch: 2 | loss: 0.0921089
	speed: 0.4886s/iter; left time: 1982.0838s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:50.03s
Steps: 224 | Train Loss: 0.0958194 Vali Loss: 0.0890634 Test Loss: 0.1001628
Validation loss decreased (0.093213 --> 0.089063).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0885787
	speed: 1.0772s/iter; left time: 4236.6150s
	iters: 200, epoch: 3 | loss: 0.0812848
	speed: 0.4157s/iter; left time: 1593.4597s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:42.02s
Steps: 224 | Train Loss: 0.0874869 Vali Loss: 0.0854821 Test Loss: 0.0969783
Validation loss decreased (0.089063 --> 0.085482).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0780477
	speed: 0.8447s/iter; left time: 3132.8415s
	iters: 200, epoch: 4 | loss: 0.0860942
	speed: 0.4363s/iter; left time: 1574.7726s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:37.76s
Steps: 224 | Train Loss: 0.0843778 Vali Loss: 0.0840356 Test Loss: 0.0956189
Validation loss decreased (0.085482 --> 0.084036).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0798992
	speed: 0.8033s/iter; left time: 2799.4977s
	iters: 200, epoch: 5 | loss: 0.0824614
	speed: 0.4347s/iter; left time: 1471.5854s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:37.34s
Steps: 224 | Train Loss: 0.0819452 Vali Loss: 0.0823933 Test Loss: 0.0941767
Validation loss decreased (0.084036 --> 0.082393).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0841987
	speed: 0.8143s/iter; left time: 2655.3528s
	iters: 200, epoch: 6 | loss: 0.0801335
	speed: 0.4309s/iter; left time: 1362.1667s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:36.84s
Steps: 224 | Train Loss: 0.0802385 Vali Loss: 0.0811689 Test Loss: 0.0923504
Validation loss decreased (0.082393 --> 0.081169).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0780803
	speed: 0.8040s/iter; left time: 2441.7309s
	iters: 200, epoch: 7 | loss: 0.0759986
	speed: 0.4337s/iter; left time: 1273.7300s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:37.75s
Steps: 224 | Train Loss: 0.0790918 Vali Loss: 0.0804617 Test Loss: 0.0916002
Validation loss decreased (0.081169 --> 0.080462).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0782464
	speed: 0.8205s/iter; left time: 2307.9918s
	iters: 200, epoch: 8 | loss: 0.0784367
	speed: 0.4088s/iter; left time: 1109.0191s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:34.28s
Steps: 224 | Train Loss: 0.0785034 Vali Loss: 0.0805083 Test Loss: 0.0913763
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0807393
	speed: 0.7322s/iter; left time: 1895.5514s
	iters: 200, epoch: 9 | loss: 0.0811604
	speed: 0.5012s/iter; left time: 1247.5488s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:45.83s
Steps: 224 | Train Loss: 0.0779705 Vali Loss: 0.0798951 Test Loss: 0.0900216
Validation loss decreased (0.080462 --> 0.079895).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0756566
	speed: 1.0467s/iter; left time: 2475.5094s
	iters: 200, epoch: 10 | loss: 0.0751782
	speed: 0.4870s/iter; left time: 1103.1316s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:49.90s
Steps: 224 | Train Loss: 0.0775467 Vali Loss: 0.0799544 Test Loss: 0.0909356
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0762294
	speed: 1.1025s/iter; left time: 2360.4065s
	iters: 200, epoch: 11 | loss: 0.0776403
	speed: 0.4896s/iter; left time: 999.1973s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:49.48s
Steps: 224 | Train Loss: 0.0771461 Vali Loss: 0.0800384 Test Loss: 0.0909417
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0725788
	speed: 1.1216s/iter; left time: 2150.1800s
	iters: 200, epoch: 12 | loss: 0.0784077
	speed: 0.4886s/iter; left time: 887.8594s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:49.65s
Steps: 224 | Train Loss: 0.0770552 Vali Loss: 0.0795305 Test Loss: 0.0905157
Validation loss decreased (0.079895 --> 0.079530).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0751376
	speed: 1.0553s/iter; left time: 1786.6563s
	iters: 200, epoch: 13 | loss: 0.0745936
	speed: 0.4881s/iter; left time: 777.5122s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:01m:51.96s
Steps: 224 | Train Loss: 0.0765096 Vali Loss: 0.0795917 Test Loss: 0.0900794
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0789997
	speed: 1.0465s/iter; left time: 1537.3353s
	iters: 200, epoch: 14 | loss: 0.0775031
	speed: 0.4905s/iter; left time: 671.5171s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:01m:50.32s
Steps: 224 | Train Loss: 0.0762570 Vali Loss: 0.0796025 Test Loss: 0.0899796
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0772134
	speed: 1.0341s/iter; left time: 1287.4291s
	iters: 200, epoch: 15 | loss: 0.0754506
	speed: 0.4856s/iter; left time: 556.0556s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:49.36s
Steps: 224 | Train Loss: 0.0759657 Vali Loss: 0.0796881 Test Loss: 0.0905825
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0784081
	speed: 1.0985s/iter; left time: 1121.5476s
	iters: 200, epoch: 16 | loss: 0.0749004
	speed: 0.4880s/iter; left time: 449.4128s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:49.94s
Steps: 224 | Train Loss: 0.0758571 Vali Loss: 0.0794466 Test Loss: 0.0900384
Validation loss decreased (0.079530 --> 0.079447).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0745344
	speed: 1.0670s/iter; left time: 850.3707s
	iters: 200, epoch: 17 | loss: 0.0735723
	speed: 0.4804s/iter; left time: 334.8635s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:48.85s
Steps: 224 | Train Loss: 0.0758652 Vali Loss: 0.0793460 Test Loss: 0.0899469
Validation loss decreased (0.079447 --> 0.079346).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0782885
	speed: 1.1356s/iter; left time: 650.7249s
	iters: 200, epoch: 18 | loss: 0.0724042
	speed: 0.4802s/iter; left time: 227.1509s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:58.16s
Steps: 224 | Train Loss: 0.0757748 Vali Loss: 0.0797755 Test Loss: 0.0904603
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0740940
	speed: 0.9596s/iter; left time: 334.8881s
	iters: 200, epoch: 19 | loss: 0.0751040
	speed: 0.4870s/iter; left time: 121.2635s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:50.39s
Steps: 224 | Train Loss: 0.0754512 Vali Loss: 0.0795362 Test Loss: 0.0902340
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0780370
	speed: 1.0876s/iter; left time: 135.9448s
	iters: 200, epoch: 20 | loss: 0.0721612
	speed: 0.4931s/iter; left time: 12.3270s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:53.23s
Steps: 224 | Train Loss: 0.0752366 Vali Loss: 0.0792375 Test Loss: 0.0893325
Validation loss decreased (0.079346 --> 0.079237).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01933741569519043, rmse:0.13905903697013855, mae:0.08933248370885849, rse:0.408513605594635
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1175029
	speed: 0.4969s/iter; left time: 2176.9747s
	iters: 200, epoch: 1 | loss: 0.1092772
	speed: 0.4844s/iter; left time: 2073.5567s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:49.83s
Steps: 224 | Train Loss: 0.1195248 Vali Loss: 0.0929825 Test Loss: 0.1053775
Validation loss decreased (inf --> 0.092982).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0965189
	speed: 0.7942s/iter; left time: 3301.3091s
	iters: 200, epoch: 2 | loss: 0.0899113
	speed: 0.4066s/iter; left time: 1649.5792s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:31.41s
Steps: 224 | Train Loss: 0.0952994 Vali Loss: 0.0893233 Test Loss: 0.0999092
Validation loss decreased (0.092982 --> 0.089323).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0902880
	speed: 0.7064s/iter; left time: 2778.4136s
	iters: 200, epoch: 3 | loss: 0.0883282
	speed: 0.4052s/iter; left time: 1553.1792s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:30.93s
Steps: 224 | Train Loss: 0.0874066 Vali Loss: 0.0870304 Test Loss: 0.0975766
Validation loss decreased (0.089323 --> 0.087030).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0818710
	speed: 0.9545s/iter; left time: 3540.1097s
	iters: 200, epoch: 4 | loss: 0.0860198
	speed: 0.5055s/iter; left time: 1824.3106s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:52.88s
Steps: 224 | Train Loss: 0.0844759 Vali Loss: 0.0830518 Test Loss: 0.0937686
Validation loss decreased (0.087030 --> 0.083052).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0836892
	speed: 1.0574s/iter; left time: 3685.0145s
	iters: 200, epoch: 5 | loss: 0.0815450
	speed: 0.4916s/iter; left time: 1664.2050s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:50.74s
Steps: 224 | Train Loss: 0.0822521 Vali Loss: 0.0822913 Test Loss: 0.0928820
Validation loss decreased (0.083052 --> 0.082291).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0788935
	speed: 1.0826s/iter; left time: 3530.3985s
	iters: 200, epoch: 6 | loss: 0.0808163
	speed: 0.4917s/iter; left time: 1554.2701s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:51.02s
Steps: 224 | Train Loss: 0.0806715 Vali Loss: 0.0811825 Test Loss: 0.0923603
Validation loss decreased (0.082291 --> 0.081183).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0814950
	speed: 1.0298s/iter; left time: 3127.6365s
	iters: 200, epoch: 7 | loss: 0.0773085
	speed: 0.4963s/iter; left time: 1457.6886s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:51.88s
Steps: 224 | Train Loss: 0.0794067 Vali Loss: 0.0805480 Test Loss: 0.0913771
Validation loss decreased (0.081183 --> 0.080548).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0803885
	speed: 1.0399s/iter; left time: 2925.3448s
	iters: 200, epoch: 8 | loss: 0.0785220
	speed: 0.4887s/iter; left time: 1325.9762s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:50.70s
Steps: 224 | Train Loss: 0.0787849 Vali Loss: 0.0801221 Test Loss: 0.0910448
Validation loss decreased (0.080548 --> 0.080122).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0760399
	speed: 1.0432s/iter; left time: 2700.8632s
	iters: 200, epoch: 9 | loss: 0.0757184
	speed: 0.4936s/iter; left time: 1228.6351s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:50.63s
Steps: 224 | Train Loss: 0.0782524 Vali Loss: 0.0802404 Test Loss: 0.0910217
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0788515
	speed: 1.0142s/iter; left time: 2398.6699s
	iters: 200, epoch: 10 | loss: 0.0783852
	speed: 0.4860s/iter; left time: 1100.7099s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:48.21s
Steps: 224 | Train Loss: 0.0777956 Vali Loss: 0.0795742 Test Loss: 0.0900392
Validation loss decreased (0.080122 --> 0.079574).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0826291
	speed: 1.0262s/iter; left time: 2197.0803s
	iters: 200, epoch: 11 | loss: 0.0776902
	speed: 0.4880s/iter; left time: 996.0175s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:49.05s
Steps: 224 | Train Loss: 0.0774411 Vali Loss: 0.0799839 Test Loss: 0.0907601
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0772021
	speed: 1.0350s/iter; left time: 1984.0153s
	iters: 200, epoch: 12 | loss: 0.0790357
	speed: 0.4834s/iter; left time: 878.3672s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:48.53s
Steps: 224 | Train Loss: 0.0772629 Vali Loss: 0.0799252 Test Loss: 0.0908321
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0783965
	speed: 1.0267s/iter; left time: 1738.1460s
	iters: 200, epoch: 13 | loss: 0.0748329
	speed: 0.4849s/iter; left time: 772.4102s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:01m:50.12s
Steps: 224 | Train Loss: 0.0767687 Vali Loss: 0.0793242 Test Loss: 0.0899927
Validation loss decreased (0.079574 --> 0.079324).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0743536
	speed: 1.0402s/iter; left time: 1528.1090s
	iters: 200, epoch: 14 | loss: 0.0781949
	speed: 0.4869s/iter; left time: 666.6023s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:01m:49.41s
Steps: 224 | Train Loss: 0.0764331 Vali Loss: 0.0792248 Test Loss: 0.0899387
Validation loss decreased (0.079324 --> 0.079225).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0768853
	speed: 1.0584s/iter; left time: 1317.6845s
	iters: 200, epoch: 15 | loss: 0.0764216
	speed: 0.4843s/iter; left time: 554.5598s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:50.96s
Steps: 224 | Train Loss: 0.0762905 Vali Loss: 0.0792417 Test Loss: 0.0896885
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0778881
	speed: 0.9706s/iter; left time: 991.0271s
	iters: 200, epoch: 16 | loss: 0.0733138
	speed: 0.4080s/iter; left time: 375.7268s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:35.11s
Steps: 224 | Train Loss: 0.0760286 Vali Loss: 0.0794188 Test Loss: 0.0900215
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0781714
	speed: 0.7645s/iter; left time: 609.3397s
	iters: 200, epoch: 17 | loss: 0.0724908
	speed: 0.4317s/iter; left time: 300.8970s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:35.67s
Steps: 224 | Train Loss: 0.0757489 Vali Loss: 0.0794565 Test Loss: 0.0899036
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0768087
	speed: 0.7905s/iter; left time: 452.9751s
	iters: 200, epoch: 18 | loss: 0.0740070
	speed: 0.4274s/iter; left time: 202.1574s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:35.27s
Steps: 224 | Train Loss: 0.0755602 Vali Loss: 0.0792832 Test Loss: 0.0895367
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0743845
	speed: 0.7755s/iter; left time: 270.6541s
	iters: 200, epoch: 19 | loss: 0.0774982
	speed: 0.4331s/iter; left time: 107.8537s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:37.02s
Steps: 224 | Train Loss: 0.0752978 Vali Loss: 0.0791737 Test Loss: 0.0895495
Validation loss decreased (0.079225 --> 0.079174).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0772385
	speed: 0.7690s/iter; left time: 96.1282s
	iters: 200, epoch: 20 | loss: 0.0751759
	speed: 0.4284s/iter; left time: 10.7107s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:35.88s
Steps: 224 | Train Loss: 0.0751847 Vali Loss: 0.0793495 Test Loss: 0.0897298
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019314749166369438, rmse:0.138977512717247, mae:0.08954952657222748, rse:0.4082740843296051
Intermediate time for ES and pred_len 96: 01h:36m:13.29s


=== Starting experiments for country: ES ===


=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1201173
	speed: 0.7111s/iter; left time: 3101.1487s
	iters: 200, epoch: 1 | loss: 0.1138434
	speed: 0.6604s/iter; left time: 2814.0197s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:02m:25.49s
Steps: 223 | Train Loss: 0.1220068 Vali Loss: 0.0970707 Test Loss: 0.1094999
Validation loss decreased (inf --> 0.097071).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1008289
	speed: 1.6564s/iter; left time: 6854.0219s
	iters: 200, epoch: 2 | loss: 0.1012299
	speed: 0.6524s/iter; left time: 2634.5740s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:02m:23.27s
Steps: 223 | Train Loss: 0.1000176 Vali Loss: 0.0960066 Test Loss: 0.1077563
Validation loss decreased (0.097071 --> 0.096007).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0943796
	speed: 1.7192s/iter; left time: 6730.6263s
	iters: 200, epoch: 3 | loss: 0.0926010
	speed: 0.4183s/iter; left time: 1595.6286s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:55.62s
Steps: 223 | Train Loss: 0.0923409 Vali Loss: 0.0916715 Test Loss: 0.1024567
Validation loss decreased (0.096007 --> 0.091671).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0869269
	speed: 0.6933s/iter; left time: 2559.7672s
	iters: 200, epoch: 4 | loss: 0.0863417
	speed: 0.4156s/iter; left time: 1492.6637s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:33.09s
Steps: 223 | Train Loss: 0.0893949 Vali Loss: 0.0878021 Test Loss: 0.0989605
Validation loss decreased (0.091671 --> 0.087802).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0880632
	speed: 0.9452s/iter; left time: 3278.8800s
	iters: 200, epoch: 5 | loss: 0.0863833
	speed: 0.6888s/iter; left time: 2320.4983s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:02m:29.27s
Steps: 223 | Train Loss: 0.0864631 Vali Loss: 0.0870810 Test Loss: 0.0986551
Validation loss decreased (0.087802 --> 0.087081).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0839308
	speed: 1.6958s/iter; left time: 5504.5040s
	iters: 200, epoch: 6 | loss: 0.0883309
	speed: 0.6981s/iter; left time: 2196.1714s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:02m:37.09s
Steps: 223 | Train Loss: 0.0851007 Vali Loss: 0.0862161 Test Loss: 0.0979620
Validation loss decreased (0.087081 --> 0.086216).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0842098
	speed: 1.8780s/iter; left time: 5677.1173s
	iters: 200, epoch: 7 | loss: 0.0835176
	speed: 0.6941s/iter; left time: 2028.9199s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:02m:33.44s
Steps: 223 | Train Loss: 0.0840701 Vali Loss: 0.0861444 Test Loss: 0.0979294
Validation loss decreased (0.086216 --> 0.086144).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0840583
	speed: 1.7061s/iter; left time: 4777.0697s
	iters: 200, epoch: 8 | loss: 0.0805856
	speed: 0.6846s/iter; left time: 1848.4187s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:02m:30.87s
Steps: 223 | Train Loss: 0.0834117 Vali Loss: 0.0861725 Test Loss: 0.0979781
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0820462
	speed: 1.7008s/iter; left time: 4383.0155s
	iters: 200, epoch: 9 | loss: 0.0842395
	speed: 0.6563s/iter; left time: 1625.6047s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:02m:26.52s
Steps: 223 | Train Loss: 0.0827916 Vali Loss: 0.0858114 Test Loss: 0.0976006
Validation loss decreased (0.086144 --> 0.085811).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0807762
	speed: 1.5393s/iter; left time: 3623.4624s
	iters: 200, epoch: 10 | loss: 0.0826545
	speed: 0.6599s/iter; left time: 1487.4871s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:02m:32.04s
Steps: 223 | Train Loss: 0.0823522 Vali Loss: 0.0853876 Test Loss: 0.0961035
Validation loss decreased (0.085811 --> 0.085388).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0830523
	speed: 1.7080s/iter; left time: 3639.6812s
	iters: 200, epoch: 11 | loss: 0.0849956
	speed: 0.6753s/iter; left time: 1371.5652s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:02m:30.04s
Steps: 223 | Train Loss: 0.0822309 Vali Loss: 0.0851900 Test Loss: 0.0968313
Validation loss decreased (0.085388 --> 0.085190).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0789915
	speed: 1.6375s/iter; left time: 3124.3156s
	iters: 200, epoch: 12 | loss: 0.0828379
	speed: 0.6439s/iter; left time: 1164.2260s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:02m:22.47s
Steps: 223 | Train Loss: 0.0816741 Vali Loss: 0.0854409 Test Loss: 0.0967536
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0807976
	speed: 1.7666s/iter; left time: 2976.7785s
	iters: 200, epoch: 13 | loss: 0.0790383
	speed: 0.6352s/iter; left time: 1006.7540s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:02m:21.85s
Steps: 223 | Train Loss: 0.0815751 Vali Loss: 0.0853703 Test Loss: 0.0967650
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0829430
	speed: 1.7659s/iter; left time: 2581.8026s
	iters: 200, epoch: 14 | loss: 0.0840117
	speed: 0.6337s/iter; left time: 863.1319s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:02m:21.25s
Steps: 223 | Train Loss: 0.0814808 Vali Loss: 0.0852086 Test Loss: 0.0960664
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0865231
	speed: 0.7276s/iter; left time: 901.5446s
	iters: 200, epoch: 15 | loss: 0.0799231
	speed: 0.4125s/iter; left time: 469.8516s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:33.82s
Steps: 223 | Train Loss: 0.0812662 Vali Loss: 0.0851957 Test Loss: 0.0961628
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0814724
	speed: 0.8771s/iter; left time: 891.1158s
	iters: 200, epoch: 16 | loss: 0.0759782
	speed: 0.4690s/iter; left time: 429.6496s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:44.96s
Steps: 223 | Train Loss: 0.0807269 Vali Loss: 0.0849759 Test Loss: 0.0957775
Validation loss decreased (0.085190 --> 0.084976).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0790517
	speed: 0.9085s/iter; left time: 720.4513s
	iters: 200, epoch: 17 | loss: 0.0825272
	speed: 0.4616s/iter; left time: 319.8957s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:45.05s
Steps: 223 | Train Loss: 0.0804840 Vali Loss: 0.0851645 Test Loss: 0.0962809
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0811116
	speed: 0.9178s/iter; left time: 523.1179s
	iters: 200, epoch: 18 | loss: 0.0861766
	speed: 0.4723s/iter; left time: 221.9654s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:50.16s
Steps: 223 | Train Loss: 0.0806337 Vali Loss: 0.0847186 Test Loss: 0.0953869
Validation loss decreased (0.084976 --> 0.084719).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0800357
	speed: 0.8841s/iter; left time: 306.7877s
	iters: 200, epoch: 19 | loss: 0.0805173
	speed: 0.4655s/iter; left time: 114.9869s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:44.54s
Steps: 223 | Train Loss: 0.0804246 Vali Loss: 0.0848673 Test Loss: 0.0960263
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0810287
	speed: 0.8621s/iter; left time: 106.8955s
	iters: 200, epoch: 20 | loss: 0.0821864
	speed: 0.4441s/iter; left time: 10.6585s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:44.74s
Steps: 223 | Train Loss: 0.0802869 Vali Loss: 0.0846076 Test Loss: 0.0955830
Validation loss decreased (0.084719 --> 0.084608).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02158721722662449, rmse:0.1469258964061737, mae:0.09558301419019699, rse:0.43165504932403564
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1190949
	speed: 0.6440s/iter; left time: 2808.3127s
	iters: 200, epoch: 1 | loss: 0.1149573
	speed: 0.6736s/iter; left time: 2870.0368s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:02m:27.51s
Steps: 223 | Train Loss: 0.1237161 Vali Loss: 0.0974902 Test Loss: 0.1097186
Validation loss decreased (inf --> 0.097490).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1017616
	speed: 1.8254s/iter; left time: 7553.5539s
	iters: 200, epoch: 2 | loss: 0.0937457
	speed: 0.6415s/iter; left time: 2590.5308s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:02m:25.30s
Steps: 223 | Train Loss: 0.0998200 Vali Loss: 0.0933207 Test Loss: 0.1053617
Validation loss decreased (0.097490 --> 0.093321).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0931459
	speed: 1.7956s/iter; left time: 7029.7712s
	iters: 200, epoch: 3 | loss: 0.0905714
	speed: 0.6450s/iter; left time: 2460.7407s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:02m:26.14s
Steps: 223 | Train Loss: 0.0922401 Vali Loss: 0.0912229 Test Loss: 0.1028882
Validation loss decreased (0.093321 --> 0.091223).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0932125
	speed: 1.8387s/iter; left time: 6788.6578s
	iters: 200, epoch: 4 | loss: 0.0871020
	speed: 0.6738s/iter; left time: 2420.1444s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:02m:28.00s
Steps: 223 | Train Loss: 0.0894587 Vali Loss: 0.0897735 Test Loss: 0.1027882
Validation loss decreased (0.091223 --> 0.089773).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0888882
	speed: 1.9546s/iter; left time: 6780.6402s
	iters: 200, epoch: 5 | loss: 0.0867240
	speed: 0.6559s/iter; left time: 2209.8780s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:02m:30.15s
Steps: 223 | Train Loss: 0.0867611 Vali Loss: 0.0873882 Test Loss: 0.0993024
Validation loss decreased (0.089773 --> 0.087388).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0855773
	speed: 1.9836s/iter; left time: 6438.6789s
	iters: 200, epoch: 6 | loss: 0.0867043
	speed: 0.6771s/iter; left time: 2130.1595s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:02m:32.78s
Steps: 223 | Train Loss: 0.0852469 Vali Loss: 0.0863633 Test Loss: 0.0987250
Validation loss decreased (0.087388 --> 0.086363).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0850454
	speed: 1.9813s/iter; left time: 5989.4599s
	iters: 200, epoch: 7 | loss: 0.0862091
	speed: 0.6710s/iter; left time: 1961.2235s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:02m:32.77s
Steps: 223 | Train Loss: 0.0843249 Vali Loss: 0.0871426 Test Loss: 0.0993244
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0871101
	speed: 2.0516s/iter; left time: 5744.5826s
	iters: 200, epoch: 8 | loss: 0.0850631
	speed: 0.6395s/iter; left time: 1726.7067s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:02m:28.59s
Steps: 223 | Train Loss: 0.0836867 Vali Loss: 0.0866393 Test Loss: 0.0988438
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0841584
	speed: 2.0382s/iter; left time: 5252.4473s
	iters: 200, epoch: 9 | loss: 0.0833049
	speed: 0.6657s/iter; left time: 1648.8162s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:02m:30.05s
Steps: 223 | Train Loss: 0.0833859 Vali Loss: 0.0859983 Test Loss: 0.0977135
Validation loss decreased (0.086363 --> 0.085998).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0851300
	speed: 2.0290s/iter; left time: 4776.1719s
	iters: 200, epoch: 10 | loss: 0.0818470
	speed: 0.6747s/iter; left time: 1520.7157s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:02m:30.79s
Steps: 223 | Train Loss: 0.0826597 Vali Loss: 0.0854817 Test Loss: 0.0972199
Validation loss decreased (0.085998 --> 0.085482).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0829688
	speed: 1.8350s/iter; left time: 3910.4128s
	iters: 200, epoch: 11 | loss: 0.0837023
	speed: 0.4334s/iter; left time: 880.2849s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:40.33s
Steps: 223 | Train Loss: 0.0825377 Vali Loss: 0.0860413 Test Loss: 0.0972846
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0797202
	speed: 1.0414s/iter; left time: 1986.9859s
	iters: 200, epoch: 12 | loss: 0.0830613
	speed: 0.7048s/iter; left time: 1274.2768s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:02m:34.03s
Steps: 223 | Train Loss: 0.0823943 Vali Loss: 0.0853766 Test Loss: 0.0963799
Validation loss decreased (0.085482 --> 0.085377).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0850847
	speed: 2.1037s/iter; left time: 3544.7043s
	iters: 200, epoch: 13 | loss: 0.0788418
	speed: 0.6912s/iter; left time: 1095.6067s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:02m:33.07s
Steps: 223 | Train Loss: 0.0817176 Vali Loss: 0.0864874 Test Loss: 0.0979733
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0820731
	speed: 2.0547s/iter; left time: 3003.9664s
	iters: 200, epoch: 14 | loss: 0.0797177
	speed: 0.6924s/iter; left time: 943.0915s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:02m:34.97s
Steps: 223 | Train Loss: 0.0815327 Vali Loss: 0.0858428 Test Loss: 0.0972124
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0800128
	speed: 2.0553s/iter; left time: 2546.4984s
	iters: 200, epoch: 15 | loss: 0.0818097
	speed: 0.6800s/iter; left time: 774.4638s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:02m:33.16s
Steps: 223 | Train Loss: 0.0814261 Vali Loss: 0.0853859 Test Loss: 0.0963020
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0797769
	speed: 2.0439s/iter; left time: 2076.5820s
	iters: 200, epoch: 16 | loss: 0.0812480
	speed: 0.6847s/iter; left time: 627.1669s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:02m:33.31s
Steps: 223 | Train Loss: 0.0811830 Vali Loss: 0.0854322 Test Loss: 0.0962062
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0812291
	speed: 2.0615s/iter; left time: 1634.7519s
	iters: 200, epoch: 17 | loss: 0.0802803
	speed: 0.6581s/iter; left time: 456.0760s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:02m:32.75s
Steps: 223 | Train Loss: 0.0809164 Vali Loss: 0.0858576 Test Loss: 0.0971119
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021762611344456673, rmse:0.14752155542373657, mae:0.09637989103794098, rse:0.4334050714969635
Intermediate time for ES and pred_len 168: 02h:18m:42.71s


=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0741635
	speed: 0.5708s/iter; left time: 2500.8415s
	iters: 200, epoch: 1 | loss: 0.0679884
	speed: 0.5113s/iter; left time: 2188.9000s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:56.99s
Steps: 224 | Train Loss: 0.0782206 Vali Loss: 0.0676163 Test Loss: 0.0710905
Validation loss decreased (inf --> 0.067616).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0571999
	speed: 1.0231s/iter; left time: 4253.1103s
	iters: 200, epoch: 2 | loss: 0.0530720
	speed: 0.5292s/iter; left time: 2146.7929s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:58.29s
Steps: 224 | Train Loss: 0.0560526 Vali Loss: 0.0633108 Test Loss: 0.0668970
Validation loss decreased (0.067616 --> 0.063311).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0510423
	speed: 0.9218s/iter; left time: 3625.4374s
	iters: 200, epoch: 3 | loss: 0.0503691
	speed: 0.5224s/iter; left time: 2002.2813s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:58.11s
Steps: 224 | Train Loss: 0.0511469 Vali Loss: 0.0592119 Test Loss: 0.0629828
Validation loss decreased (0.063311 --> 0.059212).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0491063
	speed: 1.0329s/iter; left time: 3831.0217s
	iters: 200, epoch: 4 | loss: 0.0505364
	speed: 0.5411s/iter; left time: 1952.8353s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:02m:01.37s
Steps: 224 | Train Loss: 0.0494321 Vali Loss: 0.0585475 Test Loss: 0.0633185
Validation loss decreased (0.059212 --> 0.058547).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0465938
	speed: 1.0322s/iter; left time: 3597.2642s
	iters: 200, epoch: 5 | loss: 0.0491887
	speed: 0.5038s/iter; left time: 1705.5231s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:55.31s
Steps: 224 | Train Loss: 0.0483536 Vali Loss: 0.0573059 Test Loss: 0.0610991
Validation loss decreased (0.058547 --> 0.057306).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0490926
	speed: 0.9346s/iter; left time: 3047.7333s
	iters: 200, epoch: 6 | loss: 0.0470517
	speed: 0.4014s/iter; left time: 1268.6959s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:36.54s
Steps: 224 | Train Loss: 0.0473513 Vali Loss: 0.0564111 Test Loss: 0.0612781
Validation loss decreased (0.057306 --> 0.056411).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0499295
	speed: 0.6584s/iter; left time: 1999.6678s
	iters: 200, epoch: 7 | loss: 0.0473870
	speed: 0.4002s/iter; left time: 1175.3013s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:29.93s
Steps: 224 | Train Loss: 0.0465086 Vali Loss: 0.0571610 Test Loss: 0.0616596
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0439542
	speed: 0.6645s/iter; left time: 1869.2982s
	iters: 200, epoch: 8 | loss: 0.0479710
	speed: 0.5146s/iter; left time: 1395.9899s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:44.36s
Steps: 224 | Train Loss: 0.0459280 Vali Loss: 0.0576381 Test Loss: 0.0614896
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0475387
	speed: 0.9912s/iter; left time: 2566.1859s
	iters: 200, epoch: 9 | loss: 0.0453485
	speed: 0.5365s/iter; left time: 1335.4107s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:59.85s
Steps: 224 | Train Loss: 0.0453640 Vali Loss: 0.0554559 Test Loss: 0.0597512
Validation loss decreased (0.056411 --> 0.055456).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0458424
	speed: 1.0086s/iter; left time: 2385.3127s
	iters: 200, epoch: 10 | loss: 0.0452441
	speed: 0.5291s/iter; left time: 1198.3921s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:57.90s
Steps: 224 | Train Loss: 0.0450074 Vali Loss: 0.0555391 Test Loss: 0.0598116
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0442044
	speed: 1.0072s/iter; left time: 2156.3218s
	iters: 200, epoch: 11 | loss: 0.0435896
	speed: 0.5035s/iter; left time: 1027.6986s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:57.27s
Steps: 224 | Train Loss: 0.0444883 Vali Loss: 0.0554136 Test Loss: 0.0599817
Validation loss decreased (0.055456 --> 0.055414).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0424460
	speed: 0.9475s/iter; left time: 1816.3509s
	iters: 200, epoch: 12 | loss: 0.0451619
	speed: 0.5011s/iter; left time: 910.5067s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:53.44s
Steps: 224 | Train Loss: 0.0441556 Vali Loss: 0.0544067 Test Loss: 0.0586788
Validation loss decreased (0.055414 --> 0.054407).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0436894
	speed: 1.1038s/iter; left time: 1868.7266s
	iters: 200, epoch: 13 | loss: 0.0427660
	speed: 0.5045s/iter; left time: 803.7351s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:02m:03.37s
Steps: 224 | Train Loss: 0.0439926 Vali Loss: 0.0550943 Test Loss: 0.0596506
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0437070
	speed: 1.0543s/iter; left time: 1548.8239s
	iters: 200, epoch: 14 | loss: 0.0412054
	speed: 0.5491s/iter; left time: 751.7131s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:02m:00.45s
Steps: 224 | Train Loss: 0.0435745 Vali Loss: 0.0546885 Test Loss: 0.0586498
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0428522
	speed: 1.0075s/iter; left time: 1254.2910s
	iters: 200, epoch: 15 | loss: 0.0500519
	speed: 0.5118s/iter; left time: 586.0053s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:55.23s
Steps: 224 | Train Loss: 0.0434454 Vali Loss: 0.0548867 Test Loss: 0.0584106
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0448227
	speed: 0.9809s/iter; left time: 1001.4545s
	iters: 200, epoch: 16 | loss: 0.0397810
	speed: 0.5409s/iter; left time: 498.1779s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:59.82s
Steps: 224 | Train Loss: 0.0430999 Vali Loss: 0.0546642 Test Loss: 0.0588972
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0446427
	speed: 1.0617s/iter; left time: 846.2069s
	iters: 200, epoch: 17 | loss: 0.0431333
	speed: 0.5256s/iter; left time: 366.3262s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:57.19s
Steps: 224 | Train Loss: 0.0429250 Vali Loss: 0.0544990 Test Loss: 0.0584436
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010853175073862076, rmse:0.10417857021093369, mae:0.0586787611246109, rse:0.4019180238246918
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0780145
	speed: 0.5816s/iter; left time: 2547.9237s
	iters: 200, epoch: 1 | loss: 0.0720459
	speed: 0.5362s/iter; left time: 2295.4387s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:02m:04.43s
Steps: 224 | Train Loss: 0.0805163 Vali Loss: 0.0683344 Test Loss: 0.0719207
Validation loss decreased (inf --> 0.068334).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0558290
	speed: 1.0195s/iter; left time: 4237.9262s
	iters: 200, epoch: 2 | loss: 0.0514401
	speed: 0.5250s/iter; left time: 2129.8433s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:02m:00.03s
Steps: 224 | Train Loss: 0.0565542 Vali Loss: 0.0618889 Test Loss: 0.0658956
Validation loss decreased (0.068334 --> 0.061889).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0492897
	speed: 1.0837s/iter; left time: 4262.1080s
	iters: 200, epoch: 3 | loss: 0.0513813
	speed: 0.5260s/iter; left time: 2016.0013s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:58.94s
Steps: 224 | Train Loss: 0.0513088 Vali Loss: 0.0605794 Test Loss: 0.0644502
Validation loss decreased (0.061889 --> 0.060579).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0511346
	speed: 1.0460s/iter; left time: 3879.6155s
	iters: 200, epoch: 4 | loss: 0.0494789
	speed: 0.5409s/iter; left time: 1952.0366s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:02m:00.10s
Steps: 224 | Train Loss: 0.0495841 Vali Loss: 0.0604868 Test Loss: 0.0651150
Validation loss decreased (0.060579 --> 0.060487).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0463785
	speed: 0.6815s/iter; left time: 2375.0537s
	iters: 200, epoch: 5 | loss: 0.0442550
	speed: 0.4077s/iter; left time: 1379.9356s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:30.83s
Steps: 224 | Train Loss: 0.0483376 Vali Loss: 0.0574522 Test Loss: 0.0617310
Validation loss decreased (0.060487 --> 0.057452).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0503065
	speed: 0.7240s/iter; left time: 2360.8338s
	iters: 200, epoch: 6 | loss: 0.0453981
	speed: 0.4425s/iter; left time: 1398.6923s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:39.32s
Steps: 224 | Train Loss: 0.0471440 Vali Loss: 0.0571167 Test Loss: 0.0615236
Validation loss decreased (0.057452 --> 0.057117).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0410710
	speed: 0.7597s/iter; left time: 2307.1139s
	iters: 200, epoch: 7 | loss: 0.0443639
	speed: 0.4375s/iter; left time: 1284.8599s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:39.06s
Steps: 224 | Train Loss: 0.0463930 Vali Loss: 0.0562444 Test Loss: 0.0607640
Validation loss decreased (0.057117 --> 0.056244).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0439059
	speed: 0.7879s/iter; left time: 2216.4168s
	iters: 200, epoch: 8 | loss: 0.0481910
	speed: 0.4388s/iter; left time: 1190.3893s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:40.97s
Steps: 224 | Train Loss: 0.0458666 Vali Loss: 0.0570391 Test Loss: 0.0610227
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0467500
	speed: 0.7762s/iter; left time: 2009.5561s
	iters: 200, epoch: 9 | loss: 0.0444453
	speed: 0.4490s/iter; left time: 1117.4737s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:39.48s
Steps: 224 | Train Loss: 0.0453758 Vali Loss: 0.0555958 Test Loss: 0.0600128
Validation loss decreased (0.056244 --> 0.055596).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0457202
	speed: 0.7721s/iter; left time: 1826.0630s
	iters: 200, epoch: 10 | loss: 0.0461981
	speed: 0.4368s/iter; left time: 989.2523s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:38.56s
Steps: 224 | Train Loss: 0.0450458 Vali Loss: 0.0551158 Test Loss: 0.0597481
Validation loss decreased (0.055596 --> 0.055116).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0452794
	speed: 0.7639s/iter; left time: 1635.5514s
	iters: 200, epoch: 11 | loss: 0.0447801
	speed: 0.4232s/iter; left time: 863.7401s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:37.19s
Steps: 224 | Train Loss: 0.0446596 Vali Loss: 0.0557915 Test Loss: 0.0600701
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0469518
	speed: 0.6811s/iter; left time: 1305.7106s
	iters: 200, epoch: 12 | loss: 0.0447115
	speed: 0.5341s/iter; left time: 970.4005s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:47.37s
Steps: 224 | Train Loss: 0.0443919 Vali Loss: 0.0549661 Test Loss: 0.0597439
Validation loss decreased (0.055116 --> 0.054966).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0429083
	speed: 1.1202s/iter; left time: 1896.4502s
	iters: 200, epoch: 13 | loss: 0.0418400
	speed: 0.5437s/iter; left time: 866.1830s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:02m:04.10s
Steps: 224 | Train Loss: 0.0440255 Vali Loss: 0.0546247 Test Loss: 0.0595138
Validation loss decreased (0.054966 --> 0.054625).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0439650
	speed: 1.0814s/iter; left time: 1588.5992s
	iters: 200, epoch: 14 | loss: 0.0436355
	speed: 0.5431s/iter; left time: 743.5356s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:02m:02.51s
Steps: 224 | Train Loss: 0.0437833 Vali Loss: 0.0547587 Test Loss: 0.0589082
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0417232
	speed: 1.1306s/iter; left time: 1407.5633s
	iters: 200, epoch: 15 | loss: 0.0449522
	speed: 0.5220s/iter; left time: 597.6775s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:02m:02.57s
Steps: 224 | Train Loss: 0.0435455 Vali Loss: 0.0546969 Test Loss: 0.0591773
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0432610
	speed: 1.0434s/iter; left time: 1065.3283s
	iters: 200, epoch: 16 | loss: 0.0450950
	speed: 0.5514s/iter; left time: 507.8716s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:02m:02.22s
Steps: 224 | Train Loss: 0.0433135 Vali Loss: 0.0544474 Test Loss: 0.0586903
Validation loss decreased (0.054625 --> 0.054447).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0419044
	speed: 1.1365s/iter; left time: 905.7911s
	iters: 200, epoch: 17 | loss: 0.0461629
	speed: 0.5481s/iter; left time: 382.0544s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:02m:02.13s
Steps: 224 | Train Loss: 0.0431229 Vali Loss: 0.0542110 Test Loss: 0.0585988
Validation loss decreased (0.054447 --> 0.054211).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0435826
	speed: 1.0615s/iter; left time: 608.2654s
	iters: 200, epoch: 18 | loss: 0.0416215
	speed: 0.5615s/iter; left time: 265.6060s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:02m:04.96s
Steps: 224 | Train Loss: 0.0430168 Vali Loss: 0.0542871 Test Loss: 0.0586248
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0466837
	speed: 1.0779s/iter; left time: 376.1941s
	iters: 200, epoch: 19 | loss: 0.0435416
	speed: 0.5301s/iter; left time: 131.9954s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:59.71s
Steps: 224 | Train Loss: 0.0427527 Vali Loss: 0.0541190 Test Loss: 0.0584089
Validation loss decreased (0.054211 --> 0.054119).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0437300
	speed: 1.1286s/iter; left time: 141.0749s
	iters: 200, epoch: 20 | loss: 0.0438389
	speed: 0.5846s/iter; left time: 14.6145s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:02m:09.53s
Steps: 224 | Train Loss: 0.0426628 Vali Loss: 0.0539172 Test Loss: 0.0582472
Validation loss decreased (0.054119 --> 0.053917).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01079373899847269, rmse:0.10389292240142822, mae:0.05824723839759827, rse:0.4008159935474396
Intermediate time for FR and pred_len 24: 01h:31m:14.84s
=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0822043
	speed: 0.6835s/iter; left time: 2994.6257s
	iters: 200, epoch: 1 | loss: 0.0801138
	speed: 0.6141s/iter; left time: 2628.9389s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:02m:20.87s
Steps: 224 | Train Loss: 0.0876584 Vali Loss: 0.0811369 Test Loss: 0.0879948
Validation loss decreased (inf --> 0.081137).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0725832
	speed: 1.5019s/iter; left time: 6243.4774s
	iters: 200, epoch: 2 | loss: 0.0671679
	speed: 0.6262s/iter; left time: 2540.3329s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:02m:13.98s
Steps: 224 | Train Loss: 0.0706645 Vali Loss: 0.0777931 Test Loss: 0.0874774
Validation loss decreased (0.081137 --> 0.077793).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0694495
	speed: 1.4962s/iter; left time: 5884.4836s
	iters: 200, epoch: 3 | loss: 0.0630888
	speed: 0.6471s/iter; left time: 2480.5084s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:02m:26.04s
Steps: 224 | Train Loss: 0.0665816 Vali Loss: 0.0757638 Test Loss: 0.0860757
Validation loss decreased (0.077793 --> 0.075764).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0621174
	speed: 1.4713s/iter; left time: 5456.9637s
	iters: 200, epoch: 4 | loss: 0.0666458
	speed: 0.6612s/iter; left time: 2386.2536s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:02m:24.84s
Steps: 224 | Train Loss: 0.0648800 Vali Loss: 0.0765844 Test Loss: 0.0865802
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0649208
	speed: 0.9954s/iter; left time: 3468.9188s
	iters: 200, epoch: 5 | loss: 0.0653924
	speed: 0.4175s/iter; left time: 1413.0819s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:32.31s
Steps: 224 | Train Loss: 0.0636884 Vali Loss: 0.0765816 Test Loss: 0.0862831
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0628735
	speed: 0.7056s/iter; left time: 2301.1037s
	iters: 200, epoch: 6 | loss: 0.0600195
	speed: 0.5311s/iter; left time: 1678.7419s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:49.71s
Steps: 224 | Train Loss: 0.0627224 Vali Loss: 0.0744470 Test Loss: 0.0849148
Validation loss decreased (0.075764 --> 0.074447).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0603407
	speed: 1.7405s/iter; left time: 5285.8260s
	iters: 200, epoch: 7 | loss: 0.0618772
	speed: 0.6698s/iter; left time: 1967.3237s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:02m:33.18s
Steps: 224 | Train Loss: 0.0620332 Vali Loss: 0.0740727 Test Loss: 0.0849416
Validation loss decreased (0.074447 --> 0.074073).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0631868
	speed: 1.9183s/iter; left time: 5396.2738s
	iters: 200, epoch: 8 | loss: 0.0663366
	speed: 0.6741s/iter; left time: 1828.9505s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:02m:36.13s
Steps: 224 | Train Loss: 0.0608456 Vali Loss: 0.0731956 Test Loss: 0.0832105
Validation loss decreased (0.074073 --> 0.073196).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0612206
	speed: 1.8800s/iter; left time: 4867.3986s
	iters: 200, epoch: 9 | loss: 0.0613866
	speed: 0.6597s/iter; left time: 1642.0141s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:02m:28.64s
Steps: 224 | Train Loss: 0.0602461 Vali Loss: 0.0738090 Test Loss: 0.0846329
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0585036
	speed: 1.7629s/iter; left time: 4169.1682s
	iters: 200, epoch: 10 | loss: 0.0593078
	speed: 0.6450s/iter; left time: 1460.8303s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:02m:28.39s
Steps: 224 | Train Loss: 0.0595766 Vali Loss: 0.0730542 Test Loss: 0.0833850
Validation loss decreased (0.073196 --> 0.073054).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0587517
	speed: 1.7617s/iter; left time: 3771.8972s
	iters: 200, epoch: 11 | loss: 0.0560300
	speed: 0.6409s/iter; left time: 1308.1447s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:02m:22.45s
Steps: 224 | Train Loss: 0.0593071 Vali Loss: 0.0733921 Test Loss: 0.0835128
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0561371
	speed: 1.7716s/iter; left time: 3396.0789s
	iters: 200, epoch: 12 | loss: 0.0627608
	speed: 0.6617s/iter; left time: 1202.2736s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:02m:34.67s
Steps: 224 | Train Loss: 0.0587455 Vali Loss: 0.0730180 Test Loss: 0.0837190
Validation loss decreased (0.073054 --> 0.073018).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0559313
	speed: 1.7880s/iter; left time: 3027.0897s
	iters: 200, epoch: 13 | loss: 0.0577337
	speed: 0.6152s/iter; left time: 980.0083s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:02m:30.80s
Steps: 224 | Train Loss: 0.0584179 Vali Loss: 0.0729526 Test Loss: 0.0834749
Validation loss decreased (0.073018 --> 0.072953).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0587623
	speed: 1.7826s/iter; left time: 2618.5834s
	iters: 200, epoch: 14 | loss: 0.0612975
	speed: 0.6195s/iter; left time: 848.1420s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:02m:22.25s
Steps: 224 | Train Loss: 0.0582049 Vali Loss: 0.0728990 Test Loss: 0.0832678
Validation loss decreased (0.072953 --> 0.072899).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0595100
	speed: 1.7691s/iter; left time: 2202.4788s
	iters: 200, epoch: 15 | loss: 0.0574390
	speed: 0.6424s/iter; left time: 735.5070s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:02m:29.93s
Steps: 224 | Train Loss: 0.0578830 Vali Loss: 0.0725832 Test Loss: 0.0835408
Validation loss decreased (0.072899 --> 0.072583).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0555549
	speed: 1.0139s/iter; left time: 1035.2175s
	iters: 200, epoch: 16 | loss: 0.0565989
	speed: 0.4137s/iter; left time: 380.9812s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:33.23s
Steps: 224 | Train Loss: 0.0577436 Vali Loss: 0.0723933 Test Loss: 0.0829109
Validation loss decreased (0.072583 --> 0.072393).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0619565
	speed: 0.9114s/iter; left time: 726.3625s
	iters: 200, epoch: 17 | loss: 0.0523877
	speed: 0.4702s/iter; left time: 327.7218s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:45.56s
Steps: 224 | Train Loss: 0.0574654 Vali Loss: 0.0722555 Test Loss: 0.0828303
Validation loss decreased (0.072393 --> 0.072255).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0591102
	speed: 0.8813s/iter; left time: 504.9568s
	iters: 200, epoch: 18 | loss: 0.0541627
	speed: 0.4707s/iter; left time: 222.6251s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:44.86s
Steps: 224 | Train Loss: 0.0573445 Vali Loss: 0.0723349 Test Loss: 0.0828360
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0591391
	speed: 0.8620s/iter; left time: 300.8494s
	iters: 200, epoch: 19 | loss: 0.0568241
	speed: 0.4702s/iter; left time: 117.0732s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:45.53s
Steps: 224 | Train Loss: 0.0570968 Vali Loss: 0.0718846 Test Loss: 0.0828890
Validation loss decreased (0.072255 --> 0.071885).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0579674
	speed: 0.8869s/iter; left time: 110.8590s
	iters: 200, epoch: 20 | loss: 0.0565838
	speed: 0.4711s/iter; left time: 11.7766s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:45.64s
Steps: 224 | Train Loss: 0.0569846 Vali Loss: 0.0719662 Test Loss: 0.0826769
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.020243143662810326, rmse:0.14227840304374695, mae:0.08288899809122086, rse:0.5503706932067871
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0880227
	speed: 0.4567s/iter; left time: 2000.8055s
	iters: 200, epoch: 1 | loss: 0.0805063
	speed: 0.4467s/iter; left time: 1912.1407s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:46.16s
Steps: 224 | Train Loss: 0.0879751 Vali Loss: 0.0816362 Test Loss: 0.0886729
Validation loss decreased (inf --> 0.081636).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0727710
	speed: 1.7565s/iter; left time: 7301.6360s
	iters: 200, epoch: 2 | loss: 0.0682203
	speed: 0.6575s/iter; left time: 2667.4375s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:02m:26.03s
Steps: 224 | Train Loss: 0.0704947 Vali Loss: 0.0773885 Test Loss: 0.0864598
Validation loss decreased (0.081636 --> 0.077388).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0667700
	speed: 1.8484s/iter; left time: 7269.8561s
	iters: 200, epoch: 3 | loss: 0.0652523
	speed: 0.6495s/iter; left time: 2489.4330s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:02m:27.32s
Steps: 224 | Train Loss: 0.0663362 Vali Loss: 0.0761778 Test Loss: 0.0855001
Validation loss decreased (0.077388 --> 0.076178).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0644975
	speed: 1.8234s/iter; left time: 6762.8379s
	iters: 200, epoch: 4 | loss: 0.0635591
	speed: 0.6406s/iter; left time: 2312.0719s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:02m:25.31s
Steps: 224 | Train Loss: 0.0652648 Vali Loss: 0.0754755 Test Loss: 0.0854209
Validation loss decreased (0.076178 --> 0.075476).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0670753
	speed: 1.9096s/iter; left time: 6655.0771s
	iters: 200, epoch: 5 | loss: 0.0648453
	speed: 0.6665s/iter; left time: 2255.9694s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:02m:30.22s
Steps: 224 | Train Loss: 0.0637899 Vali Loss: 0.0754475 Test Loss: 0.0851619
Validation loss decreased (0.075476 --> 0.075448).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0614910
	speed: 1.9608s/iter; left time: 6394.1650s
	iters: 200, epoch: 6 | loss: 0.0654274
	speed: 0.6544s/iter; left time: 2068.4938s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:02m:29.88s
Steps: 224 | Train Loss: 0.0627489 Vali Loss: 0.0748391 Test Loss: 0.0846352
Validation loss decreased (0.075448 --> 0.074839).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0648205
	speed: 1.9941s/iter; left time: 6056.0342s
	iters: 200, epoch: 7 | loss: 0.0593134
	speed: 0.6878s/iter; left time: 2020.0793s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:02m:37.11s
Steps: 224 | Train Loss: 0.0618413 Vali Loss: 0.0751579 Test Loss: 0.0838350
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0625529
	speed: 1.9548s/iter; left time: 5498.9576s
	iters: 200, epoch: 8 | loss: 0.0593333
	speed: 0.6570s/iter; left time: 1782.4770s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:02m:29.31s
Steps: 224 | Train Loss: 0.0609410 Vali Loss: 0.0741432 Test Loss: 0.0834898
Validation loss decreased (0.074839 --> 0.074143).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0575745
	speed: 2.0663s/iter; left time: 5349.7550s
	iters: 200, epoch: 9 | loss: 0.0586704
	speed: 0.6477s/iter; left time: 1612.1739s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:02m:30.59s
Steps: 224 | Train Loss: 0.0600951 Vali Loss: 0.0741837 Test Loss: 0.0839766
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0618289
	speed: 2.1323s/iter; left time: 5042.8912s
	iters: 200, epoch: 10 | loss: 0.0607469
	speed: 0.6578s/iter; left time: 1489.8674s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:02m:31.28s
Steps: 224 | Train Loss: 0.0597041 Vali Loss: 0.0741893 Test Loss: 0.0838761
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0627530
	speed: 2.0532s/iter; left time: 4395.9017s
	iters: 200, epoch: 11 | loss: 0.0562625
	speed: 0.6916s/iter; left time: 1411.5621s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:02m:34.39s
Steps: 224 | Train Loss: 0.0591313 Vali Loss: 0.0745488 Test Loss: 0.0837392
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0584534
	speed: 1.8502s/iter; left time: 3546.8647s
	iters: 200, epoch: 12 | loss: 0.0572757
	speed: 0.4336s/iter; left time: 787.7743s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:39.95s
Steps: 224 | Train Loss: 0.0588393 Vali Loss: 0.0739432 Test Loss: 0.0841246
Validation loss decreased (0.074143 --> 0.073943).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0585089
	speed: 1.0373s/iter; left time: 1756.1605s
	iters: 200, epoch: 13 | loss: 0.0595922
	speed: 0.7191s/iter; left time: 1145.4947s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:02m:34.67s
Steps: 224 | Train Loss: 0.0583908 Vali Loss: 0.0740251 Test Loss: 0.0838024
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0531647
	speed: 2.1291s/iter; left time: 3127.6347s
	iters: 200, epoch: 14 | loss: 0.0581940
	speed: 0.7002s/iter; left time: 958.5513s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:02m:34.33s
Steps: 224 | Train Loss: 0.0579865 Vali Loss: 0.0738622 Test Loss: 0.0843226
Validation loss decreased (0.073943 --> 0.073862).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0583588
	speed: 2.1138s/iter; left time: 2631.6318s
	iters: 200, epoch: 15 | loss: 0.0600461
	speed: 0.6941s/iter; left time: 794.7948s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:02m:37.86s
Steps: 224 | Train Loss: 0.0577379 Vali Loss: 0.0738878 Test Loss: 0.0840145
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0564763
	speed: 2.1044s/iter; left time: 2148.5705s
	iters: 200, epoch: 16 | loss: 0.0538279
	speed: 0.6796s/iter; left time: 625.9082s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:02m:33.89s
Steps: 224 | Train Loss: 0.0573872 Vali Loss: 0.0735901 Test Loss: 0.0838881
Validation loss decreased (0.073862 --> 0.073590).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0621106
	speed: 2.0898s/iter; left time: 1665.6083s
	iters: 200, epoch: 17 | loss: 0.0559162
	speed: 0.7064s/iter; left time: 492.3498s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:02m:38.62s
Steps: 224 | Train Loss: 0.0571685 Vali Loss: 0.0738277 Test Loss: 0.0840675
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0576714
	speed: 2.1076s/iter; left time: 1207.6403s
	iters: 200, epoch: 18 | loss: 0.0538922
	speed: 0.6996s/iter; left time: 330.9262s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:02m:36.90s
Steps: 224 | Train Loss: 0.0570251 Vali Loss: 0.0732664 Test Loss: 0.0845110
Validation loss decreased (0.073590 --> 0.073266).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0528641
	speed: 1.6685s/iter; left time: 582.3039s
	iters: 200, epoch: 19 | loss: 0.0570264
	speed: 0.5891s/iter; left time: 146.6797s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:02m:11.83s
Steps: 224 | Train Loss: 0.0567895 Vali Loss: 0.0735933 Test Loss: 0.0848350
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0585575
	speed: 1.4139s/iter; left time: 176.7339s
	iters: 200, epoch: 20 | loss: 0.0584958
	speed: 0.6466s/iter; left time: 16.1662s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:02m:20.47s
Steps: 224 | Train Loss: 0.0566139 Vali Loss: 0.0737802 Test Loss: 0.0842619
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.020773133262991905, rmse:0.14412887394428253, mae:0.08451095223426819, rse:0.5575287938117981
Intermediate time for FR and pred_len 96: 02h:30m:37.09s
=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0867000
	speed: 0.6475s/iter; left time: 2823.8720s
	iters: 200, epoch: 1 | loss: 0.0849291
	speed: 0.6227s/iter; left time: 2653.4057s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:02m:17.89s
Steps: 223 | Train Loss: 0.0904166 Vali Loss: 0.0845229 Test Loss: 0.0915175
Validation loss decreased (inf --> 0.084523).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0777372
	speed: 1.4813s/iter; left time: 6129.5509s
	iters: 200, epoch: 2 | loss: 0.0736265
	speed: 0.6101s/iter; left time: 2463.7057s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:02m:11.48s
Steps: 223 | Train Loss: 0.0748139 Vali Loss: 0.0822069 Test Loss: 0.0922264
Validation loss decreased (0.084523 --> 0.082207).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0739912
	speed: 1.4737s/iter; left time: 5769.7172s
	iters: 200, epoch: 3 | loss: 0.0730863
	speed: 0.5774s/iter; left time: 2202.8863s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:02m:12.62s
Steps: 223 | Train Loss: 0.0710811 Vali Loss: 0.0799598 Test Loss: 0.0917919
Validation loss decreased (0.082207 --> 0.079960).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0659431
	speed: 1.5048s/iter; left time: 5555.7135s
	iters: 200, epoch: 4 | loss: 0.0687835
	speed: 0.5868s/iter; left time: 2107.8252s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:02m:13.84s
Steps: 223 | Train Loss: 0.0696757 Vali Loss: 0.0810800 Test Loss: 0.0939965
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0655171
	speed: 1.4240s/iter; left time: 4939.8513s
	iters: 200, epoch: 5 | loss: 0.0676720
	speed: 0.4976s/iter; left time: 1676.4173s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:02m:00.43s
Steps: 223 | Train Loss: 0.0683676 Vali Loss: 0.0798259 Test Loss: 0.0908194
Validation loss decreased (0.079960 --> 0.079826).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0678277
	speed: 0.7807s/iter; left time: 2534.2336s
	iters: 200, epoch: 6 | loss: 0.0696121
	speed: 0.4335s/iter; left time: 1363.7241s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:36.40s
Steps: 223 | Train Loss: 0.0672429 Vali Loss: 0.0781168 Test Loss: 0.0895455
Validation loss decreased (0.079826 --> 0.078117).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0650179
	speed: 0.7829s/iter; left time: 2366.5762s
	iters: 200, epoch: 7 | loss: 0.0654449
	speed: 0.4416s/iter; left time: 1290.8832s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:37.74s
Steps: 223 | Train Loss: 0.0664011 Vali Loss: 0.0782690 Test Loss: 0.0893090
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0676894
	speed: 0.8509s/iter; left time: 2382.5555s
	iters: 200, epoch: 8 | loss: 0.0657608
	speed: 0.4734s/iter; left time: 1278.2979s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:42.61s
Steps: 223 | Train Loss: 0.0655086 Vali Loss: 0.0781846 Test Loss: 0.0896931
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0663979
	speed: 0.9353s/iter; left time: 2410.3270s
	iters: 200, epoch: 9 | loss: 0.0657006
	speed: 0.4746s/iter; left time: 1175.4862s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:44.85s
Steps: 223 | Train Loss: 0.0648807 Vali Loss: 0.0781926 Test Loss: 0.0897912
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0610069
	speed: 0.8909s/iter; left time: 2097.2007s
	iters: 200, epoch: 10 | loss: 0.0659231
	speed: 0.4698s/iter; left time: 1059.0289s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:44.27s
Steps: 223 | Train Loss: 0.0643844 Vali Loss: 0.0779091 Test Loss: 0.0896864
Validation loss decreased (0.078117 --> 0.077909).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0665663
	speed: 0.9191s/iter; left time: 1958.5775s
	iters: 200, epoch: 11 | loss: 0.0631135
	speed: 0.4788s/iter; left time: 972.4137s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:46.76s
Steps: 223 | Train Loss: 0.0638563 Vali Loss: 0.0770440 Test Loss: 0.0888103
Validation loss decreased (0.077909 --> 0.077044).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0635347
	speed: 1.0131s/iter; left time: 1933.0335s
	iters: 200, epoch: 12 | loss: 0.0634874
	speed: 0.4949s/iter; left time: 894.7738s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:50.43s
Steps: 223 | Train Loss: 0.0632973 Vali Loss: 0.0767854 Test Loss: 0.0885987
Validation loss decreased (0.077044 --> 0.076785).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0589653
	speed: 1.0216s/iter; left time: 1721.4364s
	iters: 200, epoch: 13 | loss: 0.0609322
	speed: 0.4758s/iter; left time: 754.1414s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:01m:47.83s
Steps: 223 | Train Loss: 0.0629737 Vali Loss: 0.0771005 Test Loss: 0.0885298
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0637525
	speed: 0.8848s/iter; left time: 1293.6477s
	iters: 200, epoch: 14 | loss: 0.0616659
	speed: 0.4583s/iter; left time: 624.1601s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:01m:42.25s
Steps: 223 | Train Loss: 0.0626814 Vali Loss: 0.0767547 Test Loss: 0.0888149
Validation loss decreased (0.076785 --> 0.076755).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0647706
	speed: 0.9357s/iter; left time: 1159.3105s
	iters: 200, epoch: 15 | loss: 0.0596826
	speed: 0.5933s/iter; left time: 675.7308s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:02m:02.99s
Steps: 223 | Train Loss: 0.0623742 Vali Loss: 0.0763948 Test Loss: 0.0891085
Validation loss decreased (0.076755 --> 0.076395).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0619631
	speed: 1.5012s/iter; left time: 1525.1864s
	iters: 200, epoch: 16 | loss: 0.0607503
	speed: 0.5914s/iter; left time: 541.7635s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:02m:12.96s
Steps: 223 | Train Loss: 0.0621300 Vali Loss: 0.0768007 Test Loss: 0.0880442
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0587612
	speed: 1.4500s/iter; left time: 1149.8826s
	iters: 200, epoch: 17 | loss: 0.0636014
	speed: 0.5888s/iter; left time: 408.0125s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:02m:11.14s
Steps: 223 | Train Loss: 0.0619072 Vali Loss: 0.0766954 Test Loss: 0.0889843
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0636578
	speed: 1.3493s/iter; left time: 769.1100s
	iters: 200, epoch: 18 | loss: 0.0622027
	speed: 0.5674s/iter; left time: 266.6980s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:02m:08.71s
Steps: 223 | Train Loss: 0.0616713 Vali Loss: 0.0768466 Test Loss: 0.0887624
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0608152
	speed: 1.4004s/iter; left time: 485.9256s
	iters: 200, epoch: 19 | loss: 0.0611868
	speed: 0.5839s/iter; left time: 144.2313s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:02m:11.83s
Steps: 223 | Train Loss: 0.0615174 Vali Loss: 0.0767223 Test Loss: 0.0883718
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0601080
	speed: 1.4025s/iter; left time: 173.9057s
	iters: 200, epoch: 20 | loss: 0.0609435
	speed: 0.5675s/iter; left time: 13.6195s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:02m:09.52s
Steps: 223 | Train Loss: 0.0613350 Vali Loss: 0.0759718 Test Loss: 0.0877511
Validation loss decreased (0.076395 --> 0.075972).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021631458774209023, rmse:0.14707636833190918, mae:0.08775109797716141, rse:0.5696406960487366
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0840698
	speed: 0.6019s/iter; left time: 2624.9503s
	iters: 200, epoch: 1 | loss: 0.0822951
	speed: 0.6106s/iter; left time: 2601.7698s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:02m:14.98s
Steps: 223 | Train Loss: 0.0915778 Vali Loss: 0.0844578 Test Loss: 0.0913634
Validation loss decreased (inf --> 0.084458).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0695060
	speed: 1.4796s/iter; left time: 6122.4339s
	iters: 200, epoch: 2 | loss: 0.0730833
	speed: 0.6059s/iter; left time: 2446.5409s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:02m:14.89s
Steps: 223 | Train Loss: 0.0750965 Vali Loss: 0.0823943 Test Loss: 0.0931646
Validation loss decreased (0.084458 --> 0.082394).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0700257
	speed: 1.5100s/iter; left time: 5911.4896s
	iters: 200, epoch: 3 | loss: 0.0717713
	speed: 0.5911s/iter; left time: 2254.9689s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:02m:12.71s
Steps: 223 | Train Loss: 0.0711580 Vali Loss: 0.0810038 Test Loss: 0.0909030
Validation loss decreased (0.082394 --> 0.081004).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0694449
	speed: 1.4820s/iter; left time: 5471.5585s
	iters: 200, epoch: 4 | loss: 0.0649483
	speed: 0.5939s/iter; left time: 2133.3546s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:02m:13.73s
Steps: 223 | Train Loss: 0.0698540 Vali Loss: 0.0806448 Test Loss: 0.0913519
Validation loss decreased (0.081004 --> 0.080645).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0671947
	speed: 1.4564s/iter; left time: 5052.2301s
	iters: 200, epoch: 5 | loss: 0.0662317
	speed: 0.6004s/iter; left time: 2022.8946s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:02m:15.68s
Steps: 223 | Train Loss: 0.0681904 Vali Loss: 0.0792744 Test Loss: 0.0897522
Validation loss decreased (0.080645 --> 0.079274).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0684180
	speed: 1.4755s/iter; left time: 4789.4560s
	iters: 200, epoch: 6 | loss: 0.0643720
	speed: 0.6034s/iter; left time: 1898.3741s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:02m:11.23s
Steps: 223 | Train Loss: 0.0670083 Vali Loss: 0.0784735 Test Loss: 0.0890415
Validation loss decreased (0.079274 --> 0.078473).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0629427
	speed: 1.4470s/iter; left time: 4374.1592s
	iters: 200, epoch: 7 | loss: 0.0645083
	speed: 0.5808s/iter; left time: 1697.5494s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:02m:07.37s
Steps: 223 | Train Loss: 0.0659721 Vali Loss: 0.0775233 Test Loss: 0.0896318
Validation loss decreased (0.078473 --> 0.077523).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0677689
	speed: 1.4354s/iter; left time: 4019.0650s
	iters: 200, epoch: 8 | loss: 0.0637954
	speed: 0.5872s/iter; left time: 1585.3998s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:02m:11.80s
Steps: 223 | Train Loss: 0.0652123 Vali Loss: 0.0772406 Test Loss: 0.0893679
Validation loss decreased (0.077523 --> 0.077241).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0639781
	speed: 1.3866s/iter; left time: 3573.1702s
	iters: 200, epoch: 9 | loss: 0.0685959
	speed: 0.5891s/iter; left time: 1459.1437s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:02m:10.41s
Steps: 223 | Train Loss: 0.0645369 Vali Loss: 0.0773234 Test Loss: 0.0892560
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0700873
	speed: 1.4540s/iter; left time: 3422.7314s
	iters: 200, epoch: 10 | loss: 0.0643341
	speed: 0.5946s/iter; left time: 1340.3099s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:02m:10.82s
Steps: 223 | Train Loss: 0.0639472 Vali Loss: 0.0773010 Test Loss: 0.0898855
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0639355
	speed: 0.8186s/iter; left time: 1744.3393s
	iters: 200, epoch: 11 | loss: 0.0656316
	speed: 0.4386s/iter; left time: 890.8894s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:38.15s
Steps: 223 | Train Loss: 0.0635714 Vali Loss: 0.0767319 Test Loss: 0.0887515
Validation loss decreased (0.077241 --> 0.076732).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0630731
	speed: 0.7994s/iter; left time: 1525.1902s
	iters: 200, epoch: 12 | loss: 0.0658784
	speed: 0.5715s/iter; left time: 1033.2789s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:58.03s
Steps: 223 | Train Loss: 0.0631513 Vali Loss: 0.0772614 Test Loss: 0.0896520
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0641970
	speed: 1.3674s/iter; left time: 2304.0744s
	iters: 200, epoch: 13 | loss: 0.0584646
	speed: 0.5927s/iter; left time: 939.4759s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:02m:10.08s
Steps: 223 | Train Loss: 0.0628479 Vali Loss: 0.0766106 Test Loss: 0.0888806
Validation loss decreased (0.076732 --> 0.076611).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0647223
	speed: 1.3593s/iter; left time: 1987.3182s
	iters: 200, epoch: 14 | loss: 0.0633280
	speed: 0.5839s/iter; left time: 795.3282s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:02m:09.58s
Steps: 223 | Train Loss: 0.0626540 Vali Loss: 0.0765092 Test Loss: 0.0883297
Validation loss decreased (0.076611 --> 0.076509).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0604687
	speed: 1.3745s/iter; left time: 1703.0010s
	iters: 200, epoch: 15 | loss: 0.0625275
	speed: 0.5645s/iter; left time: 642.9428s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:02m:07.88s
Steps: 223 | Train Loss: 0.0622654 Vali Loss: 0.0766759 Test Loss: 0.0887490
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0619440
	speed: 1.4341s/iter; left time: 1456.9975s
	iters: 200, epoch: 16 | loss: 0.0634927
	speed: 0.5813s/iter; left time: 532.4443s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:02m:10.94s
Steps: 223 | Train Loss: 0.0621019 Vali Loss: 0.0765484 Test Loss: 0.0887030
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0637661
	speed: 1.3718s/iter; left time: 1087.8066s
	iters: 200, epoch: 17 | loss: 0.0626089
	speed: 0.5698s/iter; left time: 394.8431s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:02m:07.41s
Steps: 223 | Train Loss: 0.0619384 Vali Loss: 0.0763880 Test Loss: 0.0879291
Validation loss decreased (0.076509 --> 0.076388).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0623862
	speed: 1.3931s/iter; left time: 794.0532s
	iters: 200, epoch: 18 | loss: 0.0634216
	speed: 0.5582s/iter; left time: 262.3544s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:02m:06.46s
Steps: 223 | Train Loss: 0.0617278 Vali Loss: 0.0765081 Test Loss: 0.0881700
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0628737
	speed: 1.3026s/iter; left time: 452.0008s
	iters: 200, epoch: 19 | loss: 0.0610717
	speed: 0.5839s/iter; left time: 144.2278s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:02m:10.49s
Steps: 223 | Train Loss: 0.0615791 Vali Loss: 0.0765176 Test Loss: 0.0875375
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0680039
	speed: 1.3903s/iter; left time: 172.3949s
	iters: 200, epoch: 20 | loss: 0.0643930
	speed: 0.5671s/iter; left time: 13.6104s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:02m:11.22s
Steps: 223 | Train Loss: 0.0613777 Vali Loss: 0.0768635 Test Loss: 0.0881084
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021627089008688927, rmse:0.1470615118741989, mae:0.08792905509471893, rse:0.5695831775665283
Intermediate time for FR and pred_len 168: 02h:02m:19.43s
Intermediate time for FR: 06h:04m:11.35s


=== Starting experiments for country: IT ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1089007
	speed: 0.4852s/iter; left time: 2125.7227s
	iters: 200, epoch: 1 | loss: 0.0980228
	speed: 0.4630s/iter; left time: 1981.9173s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:43.36s
Steps: 224 | Train Loss: 0.1127529 Vali Loss: 0.0767818 Test Loss: 0.0797490
Validation loss decreased (inf --> 0.076782).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0760208
	speed: 0.8634s/iter; left time: 3589.1627s
	iters: 200, epoch: 2 | loss: 0.0740019
	speed: 0.4605s/iter; left time: 1868.1791s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:43.40s
Steps: 224 | Train Loss: 0.0776670 Vali Loss: 0.0683928 Test Loss: 0.0723082
Validation loss decreased (0.076782 --> 0.068393).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0740907
	speed: 0.8316s/iter; left time: 3270.6600s
	iters: 200, epoch: 3 | loss: 0.0684398
	speed: 0.4576s/iter; left time: 1753.8716s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:42.81s
Steps: 224 | Train Loss: 0.0685748 Vali Loss: 0.0640700 Test Loss: 0.0680269
Validation loss decreased (0.068393 --> 0.064070).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0663518
	speed: 0.8468s/iter; left time: 3140.8894s
	iters: 200, epoch: 4 | loss: 0.0641612
	speed: 0.4606s/iter; left time: 1662.1693s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:43.55s
Steps: 224 | Train Loss: 0.0651295 Vali Loss: 0.0625157 Test Loss: 0.0659339
Validation loss decreased (0.064070 --> 0.062516).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0626922
	speed: 0.8146s/iter; left time: 2838.7507s
	iters: 200, epoch: 5 | loss: 0.0606117
	speed: 0.4556s/iter; left time: 1542.2026s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:42.59s
Steps: 224 | Train Loss: 0.0628193 Vali Loss: 0.0608065 Test Loss: 0.0635273
Validation loss decreased (0.062516 --> 0.060807).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0610914
	speed: 0.8074s/iter; left time: 2632.8013s
	iters: 200, epoch: 6 | loss: 0.0620082
	speed: 0.4568s/iter; left time: 1443.9040s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:42.83s
Steps: 224 | Train Loss: 0.0611555 Vali Loss: 0.0594674 Test Loss: 0.0625121
Validation loss decreased (0.060807 --> 0.059467).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0603725
	speed: 0.8502s/iter; left time: 2582.0973s
	iters: 200, epoch: 7 | loss: 0.0607818
	speed: 0.4557s/iter; left time: 1338.3229s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:44.93s
Steps: 224 | Train Loss: 0.0601794 Vali Loss: 0.0587262 Test Loss: 0.0611590
Validation loss decreased (0.059467 --> 0.058726).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0601033
	speed: 0.8553s/iter; left time: 2406.0105s
	iters: 200, epoch: 8 | loss: 0.0646101
	speed: 0.4557s/iter; left time: 1236.3714s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:42.75s
Steps: 224 | Train Loss: 0.0593412 Vali Loss: 0.0588192 Test Loss: 0.0612017
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0538533
	speed: 0.8662s/iter; left time: 2242.4851s
	iters: 200, epoch: 9 | loss: 0.0518064
	speed: 0.4561s/iter; left time: 1135.1890s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:42.99s
Steps: 224 | Train Loss: 0.0586605 Vali Loss: 0.0582566 Test Loss: 0.0607177
Validation loss decreased (0.058726 --> 0.058257).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0609718
	speed: 0.8338s/iter; left time: 1971.9867s
	iters: 200, epoch: 10 | loss: 0.0609422
	speed: 0.4622s/iter; left time: 1046.9211s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:43.71s
Steps: 224 | Train Loss: 0.0582241 Vali Loss: 0.0573494 Test Loss: 0.0602821
Validation loss decreased (0.058257 --> 0.057349).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0576551
	speed: 0.7536s/iter; left time: 1613.5013s
	iters: 200, epoch: 11 | loss: 0.0572050
	speed: 0.4236s/iter; left time: 864.5758s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:32.65s
Steps: 224 | Train Loss: 0.0579622 Vali Loss: 0.0579051 Test Loss: 0.0606680
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0600922
	speed: 0.7156s/iter; left time: 1371.8631s
	iters: 200, epoch: 12 | loss: 0.0607215
	speed: 0.4229s/iter; left time: 768.4934s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:35.06s
Steps: 224 | Train Loss: 0.0576568 Vali Loss: 0.0572061 Test Loss: 0.0602210
Validation loss decreased (0.057349 --> 0.057206).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0575828
	speed: 0.7181s/iter; left time: 1215.6611s
	iters: 200, epoch: 13 | loss: 0.0553531
	speed: 0.4219s/iter; left time: 672.0352s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:01m:34.80s
Steps: 224 | Train Loss: 0.0573104 Vali Loss: 0.0574751 Test Loss: 0.0603358
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0574727
	speed: 0.7202s/iter; left time: 1057.9495s
	iters: 200, epoch: 14 | loss: 0.0556787
	speed: 0.4219s/iter; left time: 577.5240s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:01m:34.40s
Steps: 224 | Train Loss: 0.0570091 Vali Loss: 0.0569083 Test Loss: 0.0599455
Validation loss decreased (0.057206 --> 0.056908).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0589539
	speed: 0.7302s/iter; left time: 909.1088s
	iters: 200, epoch: 15 | loss: 0.0611235
	speed: 0.4184s/iter; left time: 479.1039s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:34.36s
Steps: 224 | Train Loss: 0.0566488 Vali Loss: 0.0569133 Test Loss: 0.0598692
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0564666
	speed: 0.7479s/iter; left time: 763.6270s
	iters: 200, epoch: 16 | loss: 0.0522985
	speed: 0.3976s/iter; left time: 366.2244s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:31.13s
Steps: 224 | Train Loss: 0.0564878 Vali Loss: 0.0567967 Test Loss: 0.0597550
Validation loss decreased (0.056908 --> 0.056797).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0576557
	speed: 0.7505s/iter; left time: 598.1660s
	iters: 200, epoch: 17 | loss: 0.0544611
	speed: 0.4653s/iter; left time: 324.3408s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:43.92s
Steps: 224 | Train Loss: 0.0564619 Vali Loss: 0.0568412 Test Loss: 0.0596884
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0592199
	speed: 0.8255s/iter; left time: 473.0311s
	iters: 200, epoch: 18 | loss: 0.0510754
	speed: 0.4574s/iter; left time: 216.3643s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:43.33s
Steps: 224 | Train Loss: 0.0562088 Vali Loss: 0.0564386 Test Loss: 0.0593427
Validation loss decreased (0.056797 --> 0.056439).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0546577
	speed: 0.8505s/iter; left time: 296.8401s
	iters: 200, epoch: 19 | loss: 0.0578431
	speed: 0.4538s/iter; left time: 113.0045s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:44.12s
Steps: 224 | Train Loss: 0.0559685 Vali Loss: 0.0564734 Test Loss: 0.0592535
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0577107
	speed: 0.8349s/iter; left time: 104.3575s
	iters: 200, epoch: 20 | loss: 0.0566767
	speed: 0.4596s/iter; left time: 11.4904s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:44.03s
Steps: 224 | Train Loss: 0.0558883 Vali Loss: 0.0562921 Test Loss: 0.0593114
Validation loss decreased (0.056439 --> 0.056292).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010864796116948128, rmse:0.10423433035612106, mae:0.05931144580245018, rse:0.3938502371311188
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1110799
	speed: 0.4627s/iter; left time: 2027.2255s
	iters: 200, epoch: 1 | loss: 0.1066658
	speed: 0.4565s/iter; left time: 1954.3988s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:43.03s
Steps: 224 | Train Loss: 0.1144677 Vali Loss: 0.0773318 Test Loss: 0.0803915
Validation loss decreased (inf --> 0.077332).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0765108
	speed: 0.8200s/iter; left time: 3408.8828s
	iters: 200, epoch: 2 | loss: 0.0719159
	speed: 0.4616s/iter; left time: 1872.7052s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:42.51s
Steps: 224 | Train Loss: 0.0770432 Vali Loss: 0.0678409 Test Loss: 0.0709756
Validation loss decreased (0.077332 --> 0.067841).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0708268
	speed: 0.8300s/iter; left time: 3264.5255s
	iters: 200, epoch: 3 | loss: 0.0665266
	speed: 0.4516s/iter; left time: 1731.0775s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:42.57s
Steps: 224 | Train Loss: 0.0683062 Vali Loss: 0.0644958 Test Loss: 0.0684155
Validation loss decreased (0.067841 --> 0.064496).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0657243
	speed: 0.8217s/iter; left time: 3047.8651s
	iters: 200, epoch: 4 | loss: 0.0613497
	speed: 0.4558s/iter; left time: 1644.9523s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:42.89s
Steps: 224 | Train Loss: 0.0651706 Vali Loss: 0.0619956 Test Loss: 0.0653084
Validation loss decreased (0.064496 --> 0.061996).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0611074
	speed: 0.8317s/iter; left time: 2898.4818s
	iters: 200, epoch: 5 | loss: 0.0611349
	speed: 0.4567s/iter; left time: 1546.0704s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:42.31s
Steps: 224 | Train Loss: 0.0625799 Vali Loss: 0.0604816 Test Loss: 0.0627466
Validation loss decreased (0.061996 --> 0.060482).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0623885
	speed: 0.8298s/iter; left time: 2705.9907s
	iters: 200, epoch: 6 | loss: 0.0620136
	speed: 0.4563s/iter; left time: 1442.5123s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:43.14s
Steps: 224 | Train Loss: 0.0611724 Vali Loss: 0.0594297 Test Loss: 0.0620260
Validation loss decreased (0.060482 --> 0.059430).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0569379
	speed: 0.8322s/iter; left time: 2527.2911s
	iters: 200, epoch: 7 | loss: 0.0585256
	speed: 0.4666s/iter; left time: 1370.3494s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:43.38s
Steps: 224 | Train Loss: 0.0601078 Vali Loss: 0.0588015 Test Loss: 0.0617724
Validation loss decreased (0.059430 --> 0.058802).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0547198
	speed: 0.8402s/iter; left time: 2363.5268s
	iters: 200, epoch: 8 | loss: 0.0604376
	speed: 0.4544s/iter; left time: 1232.8996s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:42.53s
Steps: 224 | Train Loss: 0.0592549 Vali Loss: 0.0587707 Test Loss: 0.0614872
Validation loss decreased (0.058802 --> 0.058771).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0583340
	speed: 0.8258s/iter; left time: 2137.9925s
	iters: 200, epoch: 9 | loss: 0.0593997
	speed: 0.4490s/iter; left time: 1117.4637s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:42.27s
Steps: 224 | Train Loss: 0.0586028 Vali Loss: 0.0581733 Test Loss: 0.0609747
Validation loss decreased (0.058771 --> 0.058173).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0566278
	speed: 0.8306s/iter; left time: 1964.3210s
	iters: 200, epoch: 10 | loss: 0.0578770
	speed: 0.4479s/iter; left time: 1014.4036s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:42.37s
Steps: 224 | Train Loss: 0.0583596 Vali Loss: 0.0584001 Test Loss: 0.0612750
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0574821
	speed: 0.8191s/iter; left time: 1753.7276s
	iters: 200, epoch: 11 | loss: 0.0576085
	speed: 0.4577s/iter; left time: 934.2518s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:42.51s
Steps: 224 | Train Loss: 0.0578906 Vali Loss: 0.0579562 Test Loss: 0.0604790
Validation loss decreased (0.058173 --> 0.057956).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0550133
	speed: 0.8190s/iter; left time: 1570.0604s
	iters: 200, epoch: 12 | loss: 0.0576179
	speed: 0.4571s/iter; left time: 830.5114s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:42.39s
Steps: 224 | Train Loss: 0.0576006 Vali Loss: 0.0574332 Test Loss: 0.0599195
Validation loss decreased (0.057956 --> 0.057433).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0560311
	speed: 0.8317s/iter; left time: 1408.0522s
	iters: 200, epoch: 13 | loss: 0.0589346
	speed: 0.4515s/iter; left time: 719.2362s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:01m:42.46s
Steps: 224 | Train Loss: 0.0573686 Vali Loss: 0.0574277 Test Loss: 0.0602168
Validation loss decreased (0.057433 --> 0.057428).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0551835
	speed: 0.8366s/iter; left time: 1228.9795s
	iters: 200, epoch: 14 | loss: 0.0586774
	speed: 0.4528s/iter; left time: 619.9476s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:01m:42.08s
Steps: 224 | Train Loss: 0.0569763 Vali Loss: 0.0572006 Test Loss: 0.0600505
Validation loss decreased (0.057428 --> 0.057201).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0559443
	speed: 0.6714s/iter; left time: 835.8871s
	iters: 200, epoch: 15 | loss: 0.0550735
	speed: 0.4268s/iter; left time: 488.6914s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:33.76s
Steps: 224 | Train Loss: 0.0567171 Vali Loss: 0.0569260 Test Loss: 0.0595917
Validation loss decreased (0.057201 --> 0.056926).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0585403
	speed: 0.8514s/iter; left time: 869.2597s
	iters: 200, epoch: 16 | loss: 0.0536029
	speed: 0.4548s/iter; left time: 418.8511s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:42.78s
Steps: 224 | Train Loss: 0.0566159 Vali Loss: 0.0572111 Test Loss: 0.0599658
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0584737
	speed: 0.8477s/iter; left time: 675.6272s
	iters: 200, epoch: 17 | loss: 0.0580332
	speed: 0.4571s/iter; left time: 318.5844s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:43.07s
Steps: 224 | Train Loss: 0.0564026 Vali Loss: 0.0571715 Test Loss: 0.0598254
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0555174
	speed: 0.8263s/iter; left time: 473.4572s
	iters: 200, epoch: 18 | loss: 0.0536401
	speed: 0.4544s/iter; left time: 214.9323s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:42.30s
Steps: 224 | Train Loss: 0.0563822 Vali Loss: 0.0569368 Test Loss: 0.0593501
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0571260
	speed: 0.8298s/iter; left time: 289.6140s
	iters: 200, epoch: 19 | loss: 0.0544167
	speed: 0.4587s/iter; left time: 114.2217s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:43.43s
Steps: 224 | Train Loss: 0.0560629 Vali Loss: 0.0568543 Test Loss: 0.0595251
Validation loss decreased (0.056926 --> 0.056854).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0560335
	speed: 0.8365s/iter; left time: 104.5638s
	iters: 200, epoch: 20 | loss: 0.0556355
	speed: 0.4550s/iter; left time: 11.3759s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:43.21s
Steps: 224 | Train Loss: 0.0558997 Vali Loss: 0.0568563 Test Loss: 0.0594078
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010933787561953068, rmse:0.10456475615501404, mae:0.05952506512403488, rse:0.3950987458229065
Intermediate time for IT and pred_len 24: 01h:24m:54.91s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1201933
	speed: 0.5415s/iter; left time: 2372.1395s
	iters: 200, epoch: 1 | loss: 0.1156652
	speed: 0.4942s/iter; left time: 2115.8204s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:52.80s
Steps: 224 | Train Loss: 0.1247711 Vali Loss: 0.0917280 Test Loss: 0.0955555
Validation loss decreased (inf --> 0.091728).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0985203
	speed: 1.1163s/iter; left time: 4640.5947s
	iters: 200, epoch: 2 | loss: 0.0896498
	speed: 0.4999s/iter; left time: 2027.9584s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:53.63s
Steps: 224 | Train Loss: 0.0961784 Vali Loss: 0.0862115 Test Loss: 0.0917035
Validation loss decreased (0.091728 --> 0.086211).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0955550
	speed: 1.2030s/iter; left time: 4731.3122s
	iters: 200, epoch: 3 | loss: 0.0833571
	speed: 0.4825s/iter; left time: 1849.2781s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:50.53s
Steps: 224 | Train Loss: 0.0872066 Vali Loss: 0.0826519 Test Loss: 0.0883949
Validation loss decreased (0.086211 --> 0.082652).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0825046
	speed: 1.1051s/iter; left time: 4098.8199s
	iters: 200, epoch: 4 | loss: 0.0815934
	speed: 0.5057s/iter; left time: 1825.1926s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:52.91s
Steps: 224 | Train Loss: 0.0838014 Vali Loss: 0.0819744 Test Loss: 0.0865154
Validation loss decreased (0.082652 --> 0.081974).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0818803
	speed: 1.1029s/iter; left time: 3843.6816s
	iters: 200, epoch: 5 | loss: 0.0799532
	speed: 0.5060s/iter; left time: 1712.9776s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:52.77s
Steps: 224 | Train Loss: 0.0815941 Vali Loss: 0.0812572 Test Loss: 0.0847174
Validation loss decreased (0.081974 --> 0.081257).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0796003
	speed: 1.2089s/iter; left time: 3942.1377s
	iters: 200, epoch: 6 | loss: 0.0787572
	speed: 0.5032s/iter; left time: 1590.5948s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:02m:00.80s
Steps: 224 | Train Loss: 0.0804528 Vali Loss: 0.0795531 Test Loss: 0.0843862
Validation loss decreased (0.081257 --> 0.079553).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0796755
	speed: 1.1104s/iter; left time: 3372.2832s
	iters: 200, epoch: 7 | loss: 0.0790016
	speed: 0.4978s/iter; left time: 1462.1769s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:52.30s
Steps: 224 | Train Loss: 0.0796256 Vali Loss: 0.0792956 Test Loss: 0.0837953
Validation loss decreased (0.079553 --> 0.079296).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0808893
	speed: 1.0966s/iter; left time: 3084.7153s
	iters: 200, epoch: 8 | loss: 0.0796599
	speed: 0.5049s/iter; left time: 1369.8090s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:52.44s
Steps: 224 | Train Loss: 0.0788508 Vali Loss: 0.0787253 Test Loss: 0.0837868
Validation loss decreased (0.079296 --> 0.078725).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0784782
	speed: 1.0701s/iter; left time: 2770.4922s
	iters: 200, epoch: 9 | loss: 0.0751499
	speed: 0.4933s/iter; left time: 1227.8922s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:52.10s
Steps: 224 | Train Loss: 0.0783630 Vali Loss: 0.0791831 Test Loss: 0.0833833
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0791589
	speed: 1.0941s/iter; left time: 2587.4625s
	iters: 200, epoch: 10 | loss: 0.0771312
	speed: 0.5080s/iter; left time: 1150.6960s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:53.78s
Steps: 224 | Train Loss: 0.0778912 Vali Loss: 0.0782039 Test Loss: 0.0832480
Validation loss decreased (0.078725 --> 0.078204).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0765071
	speed: 1.0497s/iter; left time: 2247.5084s
	iters: 200, epoch: 11 | loss: 0.0752884
	speed: 0.4119s/iter; left time: 840.6853s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:40.97s
Steps: 224 | Train Loss: 0.0776382 Vali Loss: 0.0786340 Test Loss: 0.0827400
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0740087
	speed: 0.7717s/iter; left time: 1479.4101s
	iters: 200, epoch: 12 | loss: 0.0768717
	speed: 0.4404s/iter; left time: 800.1982s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:37.95s
Steps: 224 | Train Loss: 0.0772221 Vali Loss: 0.0784479 Test Loss: 0.0827584
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0783247
	speed: 0.8712s/iter; left time: 1474.9372s
	iters: 200, epoch: 13 | loss: 0.0751461
	speed: 0.4403s/iter; left time: 701.4361s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:01m:38.58s
Steps: 224 | Train Loss: 0.0769104 Vali Loss: 0.0783273 Test Loss: 0.0830810
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0790935
	speed: 0.8416s/iter; left time: 1236.2435s
	iters: 200, epoch: 14 | loss: 0.0784925
	speed: 0.4405s/iter; left time: 602.9779s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:01m:39.32s
Steps: 224 | Train Loss: 0.0766240 Vali Loss: 0.0785876 Test Loss: 0.0824248
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0783347
	speed: 0.8490s/iter; left time: 1057.0513s
	iters: 200, epoch: 15 | loss: 0.0770180
	speed: 0.4410s/iter; left time: 504.9913s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:39.07s
Steps: 224 | Train Loss: 0.0763442 Vali Loss: 0.0785304 Test Loss: 0.0820477
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01949421316385269, rmse:0.13962167501449585, mae:0.08324793726205826, rse:0.5279245972633362
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1214774
	speed: 0.4548s/iter; left time: 1992.4986s
	iters: 200, epoch: 1 | loss: 0.1190236
	speed: 0.4413s/iter; left time: 1889.4072s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:40.34s
Steps: 224 | Train Loss: 0.1261716 Vali Loss: 0.0922552 Test Loss: 0.0958007
Validation loss decreased (inf --> 0.092255).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0945773
	speed: 0.8190s/iter; left time: 3404.6517s
	iters: 200, epoch: 2 | loss: 0.0870521
	speed: 0.4132s/iter; left time: 1676.3529s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:34.08s
Steps: 224 | Train Loss: 0.0954396 Vali Loss: 0.0857594 Test Loss: 0.0924472
Validation loss decreased (0.092255 --> 0.085759).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0883281
	speed: 0.7294s/iter; left time: 2868.5753s
	iters: 200, epoch: 3 | loss: 0.0894310
	speed: 0.4745s/iter; left time: 1818.8430s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:40.72s
Steps: 224 | Train Loss: 0.0875599 Vali Loss: 0.0832450 Test Loss: 0.0893276
Validation loss decreased (0.085759 --> 0.083245).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0827126
	speed: 1.0404s/iter; left time: 3858.8377s
	iters: 200, epoch: 4 | loss: 0.0838863
	speed: 0.4937s/iter; left time: 1781.6774s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:49.97s
Steps: 224 | Train Loss: 0.0841590 Vali Loss: 0.0808008 Test Loss: 0.0854511
Validation loss decreased (0.083245 --> 0.080801).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0804225
	speed: 1.0565s/iter; left time: 3681.8248s
	iters: 200, epoch: 5 | loss: 0.0811801
	speed: 0.4906s/iter; left time: 1660.6900s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:50.42s
Steps: 224 | Train Loss: 0.0819292 Vali Loss: 0.0799896 Test Loss: 0.0853059
Validation loss decreased (0.080801 --> 0.079990).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0803427
	speed: 1.0346s/iter; left time: 3373.7071s
	iters: 200, epoch: 6 | loss: 0.0774547
	speed: 0.4791s/iter; left time: 1514.5141s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:48.97s
Steps: 224 | Train Loss: 0.0804667 Vali Loss: 0.0798403 Test Loss: 0.0844011
Validation loss decreased (0.079990 --> 0.079840).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0760164
	speed: 1.0522s/iter; left time: 3195.6426s
	iters: 200, epoch: 7 | loss: 0.0810596
	speed: 0.4812s/iter; left time: 1413.2782s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:48.10s
Steps: 224 | Train Loss: 0.0796770 Vali Loss: 0.0791953 Test Loss: 0.0837303
Validation loss decreased (0.079840 --> 0.079195).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0827377
	speed: 1.0127s/iter; left time: 2848.7082s
	iters: 200, epoch: 8 | loss: 0.0811596
	speed: 0.4832s/iter; left time: 1310.9314s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:48.10s
Steps: 224 | Train Loss: 0.0791621 Vali Loss: 0.0788732 Test Loss: 0.0836305
Validation loss decreased (0.079195 --> 0.078873).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0746862
	speed: 1.0417s/iter; left time: 2696.9595s
	iters: 200, epoch: 9 | loss: 0.0791557
	speed: 0.4824s/iter; left time: 1200.7032s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:49.32s
Steps: 224 | Train Loss: 0.0783284 Vali Loss: 0.0785619 Test Loss: 0.0829912
Validation loss decreased (0.078873 --> 0.078562).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0808397
	speed: 1.0323s/iter; left time: 2441.4395s
	iters: 200, epoch: 10 | loss: 0.0798717
	speed: 0.4898s/iter; left time: 1109.4699s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:50.02s
Steps: 224 | Train Loss: 0.0778047 Vali Loss: 0.0786087 Test Loss: 0.0827348
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0748998
	speed: 1.0406s/iter; left time: 2227.8463s
	iters: 200, epoch: 11 | loss: 0.0802956
	speed: 0.4955s/iter; left time: 1011.3607s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:50.44s
Steps: 224 | Train Loss: 0.0773919 Vali Loss: 0.0786148 Test Loss: 0.0819290
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0789505
	speed: 1.0295s/iter; left time: 1973.5865s
	iters: 200, epoch: 12 | loss: 0.0789429
	speed: 0.4856s/iter; left time: 882.4033s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:48.82s
Steps: 224 | Train Loss: 0.0769763 Vali Loss: 0.0787066 Test Loss: 0.0823384
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0733331
	speed: 1.0176s/iter; left time: 1722.8002s
	iters: 200, epoch: 13 | loss: 0.0772683
	speed: 0.4773s/iter; left time: 760.3721s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:01m:48.25s
Steps: 224 | Train Loss: 0.0767585 Vali Loss: 0.0782293 Test Loss: 0.0820993
Validation loss decreased (0.078562 --> 0.078229).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0733740
	speed: 1.0267s/iter; left time: 1508.1938s
	iters: 200, epoch: 14 | loss: 0.0804713
	speed: 0.4815s/iter; left time: 659.1449s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:01m:49.36s
Steps: 224 | Train Loss: 0.0765117 Vali Loss: 0.0782905 Test Loss: 0.0812889
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0740443
	speed: 1.0483s/iter; left time: 1305.1167s
	iters: 200, epoch: 15 | loss: 0.0821228
	speed: 0.4857s/iter; left time: 556.0960s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:49.91s
Steps: 224 | Train Loss: 0.0762149 Vali Loss: 0.0780020 Test Loss: 0.0817714
Validation loss decreased (0.078229 --> 0.078002).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0757860
	speed: 1.0414s/iter; left time: 1063.2525s
	iters: 200, epoch: 16 | loss: 0.0749646
	speed: 0.4884s/iter; left time: 449.7742s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:50.48s
Steps: 224 | Train Loss: 0.0760592 Vali Loss: 0.0780861 Test Loss: 0.0818319
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0743072
	speed: 1.0653s/iter; left time: 849.0782s
	iters: 200, epoch: 17 | loss: 0.0736847
	speed: 0.4862s/iter; left time: 338.8510s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:48.97s
Steps: 224 | Train Loss: 0.0757629 Vali Loss: 0.0784637 Test Loss: 0.0818149
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0779810
	speed: 0.9813s/iter; left time: 562.2661s
	iters: 200, epoch: 18 | loss: 0.0763040
	speed: 0.4100s/iter; left time: 193.9162s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:34.18s
Steps: 224 | Train Loss: 0.0756047 Vali Loss: 0.0784209 Test Loss: 0.0813692
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0774776
	speed: 0.7104s/iter; left time: 247.9438s
	iters: 200, epoch: 19 | loss: 0.0732033
	speed: 0.4113s/iter; left time: 102.4180s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:32.21s
Steps: 224 | Train Loss: 0.0754518 Vali Loss: 0.0783167 Test Loss: 0.0811191
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0804394
	speed: 0.9547s/iter; left time: 119.3353s
	iters: 200, epoch: 20 | loss: 0.0793876
	speed: 0.4899s/iter; left time: 12.2472s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:50.37s
Steps: 224 | Train Loss: 0.0753582 Vali Loss: 0.0781514 Test Loss: 0.0816716
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01896730810403824, rmse:0.13772185146808624, mae:0.0817713811993599, rse:0.5207411646842957
Intermediate time for IT and pred_len 96: 01h:26m:56.19s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1233522
	speed: 0.5247s/iter; left time: 2288.0640s
	iters: 200, epoch: 1 | loss: 0.1166279
	speed: 0.4918s/iter; left time: 2095.5417s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:49.77s
Steps: 223 | Train Loss: 0.1270789 Vali Loss: 0.0949532 Test Loss: 0.0981752
Validation loss decreased (inf --> 0.094953).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1011518
	speed: 1.0825s/iter; left time: 4479.4773s
	iters: 200, epoch: 2 | loss: 0.0953493
	speed: 0.4842s/iter; left time: 1955.3462s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:55.55s
Steps: 223 | Train Loss: 0.1000647 Vali Loss: 0.0903542 Test Loss: 0.0964049
Validation loss decreased (0.094953 --> 0.090354).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0912558
	speed: 1.0907s/iter; left time: 4270.0306s
	iters: 200, epoch: 3 | loss: 0.0916279
	speed: 0.4893s/iter; left time: 1866.7061s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:49.88s
Steps: 223 | Train Loss: 0.0917428 Vali Loss: 0.0856352 Test Loss: 0.0918320
Validation loss decreased (0.090354 --> 0.085635).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0858026
	speed: 1.1070s/iter; left time: 4086.9470s
	iters: 200, epoch: 4 | loss: 0.0853035
	speed: 0.5091s/iter; left time: 1828.5304s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:52.84s
Steps: 223 | Train Loss: 0.0882041 Vali Loss: 0.0854751 Test Loss: 0.0890900
Validation loss decreased (0.085635 --> 0.085475).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0840668
	speed: 1.1263s/iter; left time: 3907.2663s
	iters: 200, epoch: 5 | loss: 0.0870015
	speed: 0.4812s/iter; left time: 1621.3225s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:52.81s
Steps: 223 | Train Loss: 0.0858793 Vali Loss: 0.0848963 Test Loss: 0.0881092
Validation loss decreased (0.085475 --> 0.084896).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0854975
	speed: 1.0278s/iter; left time: 3336.3682s
	iters: 200, epoch: 6 | loss: 0.0936962
	speed: 0.5005s/iter; left time: 1574.5255s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:50.62s
Steps: 223 | Train Loss: 0.0848878 Vali Loss: 0.0835625 Test Loss: 0.0879032
Validation loss decreased (0.084896 --> 0.083562).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0851529
	speed: 1.0350s/iter; left time: 3128.6604s
	iters: 200, epoch: 7 | loss: 0.0827344
	speed: 0.4898s/iter; left time: 1431.5627s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:49.30s
Steps: 223 | Train Loss: 0.0838468 Vali Loss: 0.0842789 Test Loss: 0.0874141
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0815881
	speed: 1.0911s/iter; left time: 3055.1342s
	iters: 200, epoch: 8 | loss: 0.0842252
	speed: 0.4924s/iter; left time: 1329.3912s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:51.22s
Steps: 223 | Train Loss: 0.0831055 Vali Loss: 0.0836042 Test Loss: 0.0873912
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0809382
	speed: 1.0921s/iter; left time: 2814.3319s
	iters: 200, epoch: 9 | loss: 0.0861805
	speed: 0.4879s/iter; left time: 1208.4313s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:49.14s
Steps: 223 | Train Loss: 0.0827094 Vali Loss: 0.0836893 Test Loss: 0.0868237
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0819780
	speed: 1.1188s/iter; left time: 2633.5805s
	iters: 200, epoch: 10 | loss: 0.0835758
	speed: 0.4928s/iter; left time: 1110.8375s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:55.40s
Steps: 223 | Train Loss: 0.0826149 Vali Loss: 0.0837832 Test Loss: 0.0871721
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0846254
	speed: 1.0236s/iter; left time: 2181.1895s
	iters: 200, epoch: 11 | loss: 0.0845297
	speed: 0.4933s/iter; left time: 1001.9412s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:48.94s
Steps: 223 | Train Loss: 0.0820568 Vali Loss: 0.0835197 Test Loss: 0.0868895
Validation loss decreased (0.083562 --> 0.083520).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0805619
	speed: 1.0214s/iter; left time: 1948.8291s
	iters: 200, epoch: 12 | loss: 0.0790084
	speed: 0.4983s/iter; left time: 900.8882s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:50.49s
Steps: 223 | Train Loss: 0.0816184 Vali Loss: 0.0831597 Test Loss: 0.0866629
Validation loss decreased (0.083520 --> 0.083160).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0822184
	speed: 0.9202s/iter; left time: 1550.4650s
	iters: 200, epoch: 13 | loss: 0.0816152
	speed: 0.4221s/iter; left time: 669.0065s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:01m:32.93s
Steps: 223 | Train Loss: 0.0813097 Vali Loss: 0.0832065 Test Loss: 0.0865464
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0829501
	speed: 0.8095s/iter; left time: 1183.5244s
	iters: 200, epoch: 14 | loss: 0.0791548
	speed: 0.4323s/iter; left time: 588.7655s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:01m:37.43s
Steps: 223 | Train Loss: 0.0811410 Vali Loss: 0.0831853 Test Loss: 0.0868693
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0824144
	speed: 0.7820s/iter; left time: 968.8931s
	iters: 200, epoch: 15 | loss: 0.0793250
	speed: 0.4326s/iter; left time: 492.6859s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:36.56s
Steps: 223 | Train Loss: 0.0809919 Vali Loss: 0.0832911 Test Loss: 0.0865977
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0801148
	speed: 0.7885s/iter; left time: 801.1623s
	iters: 200, epoch: 16 | loss: 0.0815746
	speed: 0.4310s/iter; left time: 394.7981s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:37.13s
Steps: 223 | Train Loss: 0.0806603 Vali Loss: 0.0829422 Test Loss: 0.0865010
Validation loss decreased (0.083160 --> 0.082942).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0782319
	speed: 0.8011s/iter; left time: 635.2603s
	iters: 200, epoch: 17 | loss: 0.0818858
	speed: 0.4325s/iter; left time: 299.7443s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:37.33s
Steps: 223 | Train Loss: 0.0803594 Vali Loss: 0.0829783 Test Loss: 0.0866283
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0769675
	speed: 0.7907s/iter; left time: 450.6728s
	iters: 200, epoch: 18 | loss: 0.0762671
	speed: 0.4138s/iter; left time: 194.4737s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:34.53s
Steps: 223 | Train Loss: 0.0802100 Vali Loss: 0.0835149 Test Loss: 0.0866809
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0778130
	speed: 0.6839s/iter; left time: 237.3077s
	iters: 200, epoch: 19 | loss: 0.0770683
	speed: 0.4627s/iter; left time: 114.2825s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:38.44s
Steps: 223 | Train Loss: 0.0800716 Vali Loss: 0.0834451 Test Loss: 0.0864782
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0817134
	speed: 1.1470s/iter; left time: 142.2331s
	iters: 200, epoch: 20 | loss: 0.0818730
	speed: 0.5005s/iter; left time: 12.0115s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:59.48s
Steps: 223 | Train Loss: 0.0798677 Vali Loss: 0.0833479 Test Loss: 0.0868323
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020301908254623413, rmse:0.14248476922512054, mae:0.08650100976228714, rse:0.539250910282135
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1230876
	speed: 0.4929s/iter; left time: 2149.4941s
	iters: 200, epoch: 1 | loss: 0.1210657
	speed: 0.4994s/iter; left time: 2127.7668s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:50.42s
Steps: 223 | Train Loss: 0.1290500 Vali Loss: 0.0953654 Test Loss: 0.0983430
Validation loss decreased (inf --> 0.095365).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0983674
	speed: 1.0354s/iter; left time: 4284.6602s
	iters: 200, epoch: 2 | loss: 0.0908368
	speed: 0.4946s/iter; left time: 1997.3521s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:50.33s
Steps: 223 | Train Loss: 0.1001738 Vali Loss: 0.0910090 Test Loss: 0.0968875
Validation loss decreased (0.095365 --> 0.091009).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0895670
	speed: 1.0471s/iter; left time: 4099.3067s
	iters: 200, epoch: 3 | loss: 0.0887397
	speed: 0.4956s/iter; left time: 1890.7534s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:50.99s
Steps: 223 | Train Loss: 0.0916460 Vali Loss: 0.0861125 Test Loss: 0.0921629
Validation loss decreased (0.091009 --> 0.086112).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0900851
	speed: 1.0176s/iter; left time: 3757.1158s
	iters: 200, epoch: 4 | loss: 0.0854952
	speed: 0.5009s/iter; left time: 1799.1344s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:51.16s
Steps: 223 | Train Loss: 0.0883394 Vali Loss: 0.0845541 Test Loss: 0.0896404
Validation loss decreased (0.086112 --> 0.084554).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0890274
	speed: 1.0789s/iter; left time: 3742.7264s
	iters: 200, epoch: 5 | loss: 0.0815940
	speed: 0.4916s/iter; left time: 1656.1320s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:52.36s
Steps: 223 | Train Loss: 0.0861755 Vali Loss: 0.0838304 Test Loss: 0.0883915
Validation loss decreased (0.084554 --> 0.083830).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0837622
	speed: 1.0113s/iter; left time: 3282.6051s
	iters: 200, epoch: 6 | loss: 0.0817838
	speed: 0.4832s/iter; left time: 1520.0423s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:48.15s
Steps: 223 | Train Loss: 0.0845726 Vali Loss: 0.0854897 Test Loss: 0.0880082
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0830257
	speed: 1.0288s/iter; left time: 3110.1483s
	iters: 200, epoch: 7 | loss: 0.0811242
	speed: 0.4945s/iter; left time: 1445.5105s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:50.37s
Steps: 223 | Train Loss: 0.0841082 Vali Loss: 0.0842384 Test Loss: 0.0882311
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0839110
	speed: 1.0049s/iter; left time: 2813.8119s
	iters: 200, epoch: 8 | loss: 0.0818927
	speed: 0.4924s/iter; left time: 1329.4421s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:49.53s
Steps: 223 | Train Loss: 0.0831431 Vali Loss: 0.0832146 Test Loss: 0.0874253
Validation loss decreased (0.083830 --> 0.083215).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0849428
	speed: 0.9929s/iter; left time: 2558.6355s
	iters: 200, epoch: 9 | loss: 0.0825876
	speed: 0.4860s/iter; left time: 1203.8155s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:48.18s
Steps: 223 | Train Loss: 0.0824565 Vali Loss: 0.0833686 Test Loss: 0.0875392
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0849025
	speed: 1.0129s/iter; left time: 2384.3357s
	iters: 200, epoch: 10 | loss: 0.0793686
	speed: 0.4949s/iter; left time: 1115.4554s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:50.16s
Steps: 223 | Train Loss: 0.0821156 Vali Loss: 0.0833590 Test Loss: 0.0873887
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0853055
	speed: 1.0378s/iter; left time: 2211.6279s
	iters: 200, epoch: 11 | loss: 0.0856993
	speed: 0.4988s/iter; left time: 1013.0642s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:49.98s
Steps: 223 | Train Loss: 0.0819280 Vali Loss: 0.0832790 Test Loss: 0.0870216
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0813068
	speed: 0.9904s/iter; left time: 1889.7436s
	iters: 200, epoch: 12 | loss: 0.0798612
	speed: 0.4093s/iter; left time: 739.9991s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:35.43s
Steps: 223 | Train Loss: 0.0818996 Vali Loss: 0.0829543 Test Loss: 0.0869856
Validation loss decreased (0.083215 --> 0.082954).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0836838
	speed: 0.6890s/iter; left time: 1161.0173s
	iters: 200, epoch: 13 | loss: 0.0766673
	speed: 0.4377s/iter; left time: 693.8049s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:01m:36.29s
Steps: 223 | Train Loss: 0.0813094 Vali Loss: 0.0831955 Test Loss: 0.0869424
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0832489
	speed: 1.0881s/iter; left time: 1590.7633s
	iters: 200, epoch: 14 | loss: 0.0810103
	speed: 0.4907s/iter; left time: 668.3091s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:01m:50.52s
Steps: 223 | Train Loss: 0.0811205 Vali Loss: 0.0830273 Test Loss: 0.0870022
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0799915
	speed: 1.0370s/iter; left time: 1284.8865s
	iters: 200, epoch: 15 | loss: 0.0798251
	speed: 0.4829s/iter; left time: 549.9983s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:48.97s
Steps: 223 | Train Loss: 0.0808713 Vali Loss: 0.0834621 Test Loss: 0.0870126
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0795850
	speed: 1.0374s/iter; left time: 1053.9568s
	iters: 200, epoch: 16 | loss: 0.0796282
	speed: 0.4948s/iter; left time: 453.2384s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:51.11s
Steps: 223 | Train Loss: 0.0808802 Vali Loss: 0.0832195 Test Loss: 0.0868252
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0820876
	speed: 1.0127s/iter; left time: 803.0769s
	iters: 200, epoch: 17 | loss: 0.0825228
	speed: 0.5008s/iter; left time: 347.0322s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:51.24s
Steps: 223 | Train Loss: 0.0804752 Vali Loss: 0.0828835 Test Loss: 0.0864290
Validation loss decreased (0.082954 --> 0.082883).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0805107
	speed: 1.0224s/iter; left time: 582.7450s
	iters: 200, epoch: 18 | loss: 0.0807805
	speed: 0.4966s/iter; left time: 233.3866s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:50.59s
Steps: 223 | Train Loss: 0.0802542 Vali Loss: 0.0830027 Test Loss: 0.0867341
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0790329
	speed: 1.0884s/iter; left time: 377.6603s
	iters: 200, epoch: 19 | loss: 0.0823824
	speed: 0.4843s/iter; left time: 119.6172s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:51.02s
Steps: 223 | Train Loss: 0.0801799 Vali Loss: 0.0836668 Test Loss: 0.0870563
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0866969
	speed: 1.0366s/iter; left time: 128.5388s
	iters: 200, epoch: 20 | loss: 0.0817964
	speed: 0.4922s/iter; left time: 11.8128s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:50.14s
Steps: 223 | Train Loss: 0.0800096 Vali Loss: 0.0831445 Test Loss: 0.0869497
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020161056891083717, rmse:0.14198963344097137, mae:0.08642901480197906, rse:0.5373769998550415
Intermediate time for IT and pred_len 168: 01h:39m:20.69s
Intermediate time for IT: 04h:31m:11.80s
