
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1112533
	speed: 0.1231s/iter; left time: 2746.3413s
	iters: 200, epoch: 1 | loss: 0.0947237
	speed: 0.0979s/iter; left time: 2173.8425s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:22.40s
Steps: 224 | Train Loss: 0.1155480 Vali Loss: 0.1083674 Test Loss: 0.1112919
Validation loss decreased (inf --> 0.108367).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0854550
	speed: 0.1683s/iter; left time: 3716.6007s
	iters: 200, epoch: 2 | loss: 0.0782319
	speed: 0.0980s/iter; left time: 2154.0144s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:22.22s
Steps: 224 | Train Loss: 0.0869274 Vali Loss: 0.0998944 Test Loss: 0.1056200
Validation loss decreased (0.108367 --> 0.099894).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0739933
	speed: 0.1672s/iter; left time: 3654.3358s
	iters: 200, epoch: 3 | loss: 0.0765578
	speed: 0.0978s/iter; left time: 2128.4022s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:22.13s
Steps: 224 | Train Loss: 0.0778407 Vali Loss: 0.0991285 Test Loss: 0.1069202
Validation loss decreased (0.099894 --> 0.099128).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0697385
	speed: 0.1682s/iter; left time: 3639.0088s
	iters: 200, epoch: 4 | loss: 0.0638608
	speed: 0.0980s/iter; left time: 2109.3550s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:22.22s
Steps: 224 | Train Loss: 0.0693531 Vali Loss: 0.1024066 Test Loss: 0.1129898
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0582502
	speed: 0.1631s/iter; left time: 3491.8476s
	iters: 200, epoch: 5 | loss: 0.0585040
	speed: 0.0979s/iter; left time: 2084.8564s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:22.13s
Steps: 224 | Train Loss: 0.0609865 Vali Loss: 0.1040621 Test Loss: 0.1140443
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0572859
	speed: 0.1637s/iter; left time: 3467.9959s
	iters: 200, epoch: 6 | loss: 0.0524833
	speed: 0.0980s/iter; left time: 2065.9613s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:22.16s
Steps: 224 | Train Loss: 0.0544637 Vali Loss: 0.1054772 Test Loss: 0.1150894
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0504480
	speed: 0.1630s/iter; left time: 3416.3312s
	iters: 200, epoch: 7 | loss: 0.0498273
	speed: 0.0979s/iter; left time: 2042.6466s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:22.13s
Steps: 224 | Train Loss: 0.0495332 Vali Loss: 0.1044851 Test Loss: 0.1146997
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0444115
	speed: 0.1638s/iter; left time: 3396.4821s
	iters: 200, epoch: 8 | loss: 0.0440660
	speed: 0.0981s/iter; left time: 2025.0327s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:22.21s
Steps: 224 | Train Loss: 0.0461323 Vali Loss: 0.1038223 Test Loss: 0.1127458
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0430763
	speed: 0.1640s/iter; left time: 3363.6509s
	iters: 200, epoch: 9 | loss: 0.0425591
	speed: 0.0983s/iter; left time: 2006.6833s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:22.23s
Steps: 224 | Train Loss: 0.0430833 Vali Loss: 0.1051498 Test Loss: 0.1131369
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0384030
	speed: 0.1642s/iter; left time: 3330.5913s
	iters: 200, epoch: 10 | loss: 0.0380151
	speed: 0.0982s/iter; left time: 1982.2077s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:22.21s
Steps: 224 | Train Loss: 0.0405867 Vali Loss: 0.1042476 Test Loss: 0.1118535
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0366854
	speed: 0.1636s/iter; left time: 3281.5571s
	iters: 200, epoch: 11 | loss: 0.0389781
	speed: 0.0985s/iter; left time: 1966.9114s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:22.21s
Steps: 224 | Train Loss: 0.0386601 Vali Loss: 0.1039293 Test Loss: 0.1120706
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0360011
	speed: 0.1641s/iter; left time: 3256.1169s
	iters: 200, epoch: 12 | loss: 0.0358986
	speed: 0.0978s/iter; left time: 1930.8229s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:22.14s
Steps: 224 | Train Loss: 0.0366836 Vali Loss: 0.1034238 Test Loss: 0.1116644
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0363298
	speed: 0.1635s/iter; left time: 3207.4983s
	iters: 200, epoch: 13 | loss: 0.0352150
	speed: 0.0983s/iter; left time: 1918.8538s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:22.22s
Steps: 224 | Train Loss: 0.0354312 Vali Loss: 0.1032293 Test Loss: 0.1111846
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.027056831866502762, rmse:0.16448961198329926, mae:0.10692021995782852, rse:0.5805065631866455
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1104277
	speed: 0.1006s/iter; left time: 2242.6529s
	iters: 200, epoch: 1 | loss: 0.0958888
	speed: 0.0982s/iter; left time: 2179.2152s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:22.30s
Steps: 224 | Train Loss: 0.1144290 Vali Loss: 0.1079746 Test Loss: 0.1105221
Validation loss decreased (inf --> 0.107975).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0823085
	speed: 0.1691s/iter; left time: 3732.9607s
	iters: 200, epoch: 2 | loss: 0.0799549
	speed: 0.0987s/iter; left time: 2168.7480s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:22.26s
Steps: 224 | Train Loss: 0.0861994 Vali Loss: 0.1006127 Test Loss: 0.1039980
Validation loss decreased (0.107975 --> 0.100613).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0805682
	speed: 0.1707s/iter; left time: 3731.1330s
	iters: 200, epoch: 3 | loss: 0.0741031
	speed: 0.0986s/iter; left time: 2145.8836s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:22.38s
Steps: 224 | Train Loss: 0.0781434 Vali Loss: 0.1008413 Test Loss: 0.1066661
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0722199
	speed: 0.1649s/iter; left time: 3566.4820s
	iters: 200, epoch: 4 | loss: 0.0663662
	speed: 0.0986s/iter; left time: 2123.1766s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:22.35s
Steps: 224 | Train Loss: 0.0701794 Vali Loss: 0.1043894 Test Loss: 0.1115258
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0600862
	speed: 0.1654s/iter; left time: 3541.1986s
	iters: 200, epoch: 5 | loss: 0.0605440
	speed: 0.0992s/iter; left time: 2112.4141s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:22.45s
Steps: 224 | Train Loss: 0.0612372 Vali Loss: 0.1049034 Test Loss: 0.1115060
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0573480
	speed: 0.1641s/iter; left time: 3475.4696s
	iters: 200, epoch: 6 | loss: 0.0534590
	speed: 0.0984s/iter; left time: 2073.4958s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:22.20s
Steps: 224 | Train Loss: 0.0543473 Vali Loss: 0.1030101 Test Loss: 0.1130545
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0521577
	speed: 0.1650s/iter; left time: 3458.9430s
	iters: 200, epoch: 7 | loss: 0.0499089
	speed: 0.0994s/iter; left time: 2074.1525s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:22.40s
Steps: 224 | Train Loss: 0.0494745 Vali Loss: 0.1061422 Test Loss: 0.1134916
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0478449
	speed: 0.1653s/iter; left time: 3426.7520s
	iters: 200, epoch: 8 | loss: 0.0461110
	speed: 0.0986s/iter; left time: 2034.6492s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:22.33s
Steps: 224 | Train Loss: 0.0460226 Vali Loss: 0.1054480 Test Loss: 0.1134600
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0442130
	speed: 0.1655s/iter; left time: 3394.3082s
	iters: 200, epoch: 9 | loss: 0.0409993
	speed: 0.0995s/iter; left time: 2030.7084s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:22.46s
Steps: 224 | Train Loss: 0.0430741 Vali Loss: 0.1049370 Test Loss: 0.1139135
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0401310
	speed: 0.1664s/iter; left time: 3374.7413s
	iters: 200, epoch: 10 | loss: 0.0397451
	speed: 0.0986s/iter; left time: 1990.3158s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:22.40s
Steps: 224 | Train Loss: 0.0407757 Vali Loss: 0.1058690 Test Loss: 0.1138797
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0401663
	speed: 0.1662s/iter; left time: 3334.1508s
	iters: 200, epoch: 11 | loss: 0.0379177
	speed: 0.0999s/iter; left time: 1993.8713s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:22.53s
Steps: 224 | Train Loss: 0.0388926 Vali Loss: 0.1049644 Test Loss: 0.1126991
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0368711
	speed: 0.1670s/iter; left time: 3312.3730s
	iters: 200, epoch: 12 | loss: 0.0373080
	speed: 0.0985s/iter; left time: 1943.9276s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:22.34s
Steps: 224 | Train Loss: 0.0372816 Vali Loss: 0.1046643 Test Loss: 0.1133890
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.025797396898269653, rmse:0.1606156826019287, mae:0.10399806499481201, rse:0.5668349862098694
Intermediate time for DE and pred_len 24: 00h:11m:15.14s
=== Starting experiments for pred_len: 96 ===

--- Running model for DE, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1223163
	speed: 0.1264s/iter; left time: 2817.8532s
	iters: 200, epoch: 1 | loss: 0.1179984
	speed: 0.1009s/iter; left time: 2240.6734s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:23.04s
Steps: 224 | Train Loss: 0.1299141 Vali Loss: 0.1308546 Test Loss: 0.1396497
Validation loss decreased (inf --> 0.130855).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1022252
	speed: 0.1756s/iter; left time: 3876.1657s
	iters: 200, epoch: 2 | loss: 0.0907339
	speed: 0.1000s/iter; left time: 2198.6703s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:22.54s
Steps: 224 | Train Loss: 0.1030955 Vali Loss: 0.1370220 Test Loss: 0.1497822
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0787314
	speed: 0.1667s/iter; left time: 3642.4992s
	iters: 200, epoch: 3 | loss: 0.0721129
	speed: 0.1003s/iter; left time: 2182.8867s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:22.59s
Steps: 224 | Train Loss: 0.0795147 Vali Loss: 0.1362003 Test Loss: 0.1498653
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0672994
	speed: 0.1667s/iter; left time: 3606.0938s
	iters: 200, epoch: 4 | loss: 0.0617716
	speed: 0.0997s/iter; left time: 2146.7616s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:22.53s
Steps: 224 | Train Loss: 0.0662196 Vali Loss: 0.1312884 Test Loss: 0.1464415
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0554917
	speed: 0.1673s/iter; left time: 3580.1698s
	iters: 200, epoch: 5 | loss: 0.0537446
	speed: 0.1049s/iter; left time: 2235.1407s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:23.00s
Steps: 224 | Train Loss: 0.0566004 Vali Loss: 0.1303605 Test Loss: 0.1468938
Validation loss decreased (0.130855 --> 0.130360).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0494789
	speed: 0.1903s/iter; left time: 4030.1447s
	iters: 200, epoch: 6 | loss: 0.0491216
	speed: 0.0998s/iter; left time: 2104.8574s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:22.53s
Steps: 224 | Train Loss: 0.0503385 Vali Loss: 0.1282276 Test Loss: 0.1452809
Validation loss decreased (0.130360 --> 0.128228).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0476965
	speed: 0.1740s/iter; left time: 3646.4895s
	iters: 200, epoch: 7 | loss: 0.0456673
	speed: 0.1014s/iter; left time: 2114.5851s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:22.71s
Steps: 224 | Train Loss: 0.0460990 Vali Loss: 0.1284869 Test Loss: 0.1437094
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0409390
	speed: 0.1675s/iter; left time: 3472.7147s
	iters: 200, epoch: 8 | loss: 0.0420192
	speed: 0.1000s/iter; left time: 2063.3995s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:22.58s
Steps: 224 | Train Loss: 0.0428764 Vali Loss: 0.1284564 Test Loss: 0.1440781
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0444956
	speed: 0.1685s/iter; left time: 3455.6580s
	iters: 200, epoch: 9 | loss: 0.0387594
	speed: 0.1016s/iter; left time: 2074.2640s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:22.78s
Steps: 224 | Train Loss: 0.0407125 Vali Loss: 0.1305699 Test Loss: 0.1438922
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0374829
	speed: 0.1671s/iter; left time: 3390.4842s
	iters: 200, epoch: 10 | loss: 0.0365280
	speed: 0.0998s/iter; left time: 2015.1867s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:22.57s
Steps: 224 | Train Loss: 0.0390599 Vali Loss: 0.1287085 Test Loss: 0.1438078
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0362832
	speed: 0.1683s/iter; left time: 3375.8092s
	iters: 200, epoch: 11 | loss: 0.0386881
	speed: 0.1010s/iter; left time: 2016.5076s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:22.77s
Steps: 224 | Train Loss: 0.0373755 Vali Loss: 0.1280792 Test Loss: 0.1441514
Validation loss decreased (0.128228 --> 0.128079).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0369315
	speed: 0.1853s/iter; left time: 3675.4814s
	iters: 200, epoch: 12 | loss: 0.0343455
	speed: 0.0998s/iter; left time: 1970.3270s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:22.52s
Steps: 224 | Train Loss: 0.0356504 Vali Loss: 0.1269628 Test Loss: 0.1420918
Validation loss decreased (0.128079 --> 0.126963).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0335403
	speed: 0.1778s/iter; left time: 3487.3644s
	iters: 200, epoch: 13 | loss: 0.0352450
	speed: 0.1012s/iter; left time: 1974.4570s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:22.81s
Steps: 224 | Train Loss: 0.0349691 Vali Loss: 0.1272836 Test Loss: 0.1418213
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0318428
	speed: 0.1702s/iter; left time: 3300.6497s
	iters: 200, epoch: 14 | loss: 0.0324326
	speed: 0.0997s/iter; left time: 1923.8570s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:22.60s
Steps: 224 | Train Loss: 0.0338992 Vali Loss: 0.1269519 Test Loss: 0.1416352
Validation loss decreased (0.126963 --> 0.126952).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0320864
	speed: 0.1923s/iter; left time: 3684.7328s
	iters: 200, epoch: 15 | loss: 0.0322615
	speed: 0.0999s/iter; left time: 1904.6179s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:22.63s
Steps: 224 | Train Loss: 0.0333974 Vali Loss: 0.1274366 Test Loss: 0.1414319
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0321085
	speed: 0.1708s/iter; left time: 3234.3843s
	iters: 200, epoch: 16 | loss: 0.0311919
	speed: 0.1000s/iter; left time: 1884.7500s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:22.65s
Steps: 224 | Train Loss: 0.0323608 Vali Loss: 0.1268734 Test Loss: 0.1406729
Validation loss decreased (0.126952 --> 0.126873).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0328568
	speed: 0.1755s/iter; left time: 3285.6408s
	iters: 200, epoch: 17 | loss: 0.0315784
	speed: 0.1003s/iter; left time: 1867.4242s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:22.65s
Steps: 224 | Train Loss: 0.0319499 Vali Loss: 0.1269051 Test Loss: 0.1413284
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0313548
	speed: 0.1698s/iter; left time: 3140.1900s
	iters: 200, epoch: 18 | loss: 0.0328749
	speed: 0.0998s/iter; left time: 1835.0196s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:22.59s
Steps: 224 | Train Loss: 0.0316611 Vali Loss: 0.1266844 Test Loss: 0.1419162
Validation loss decreased (0.126873 --> 0.126684).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0298367
	speed: 0.2082s/iter; left time: 3804.1620s
	iters: 200, epoch: 19 | loss: 0.0298126
	speed: 0.0998s/iter; left time: 1812.4486s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:22.56s
Steps: 224 | Train Loss: 0.0311329 Vali Loss: 0.1270447 Test Loss: 0.1420292
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0311288
	speed: 0.1699s/iter; left time: 3065.0701s
	iters: 200, epoch: 20 | loss: 0.0301998
	speed: 0.1005s/iter; left time: 1803.9256s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:22.79s
Steps: 224 | Train Loss: 0.0312470 Vali Loss: 0.1267967 Test Loss: 0.1413040
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0298048
	speed: 0.1671s/iter; left time: 2978.3748s
	iters: 200, epoch: 21 | loss: 0.0307570
	speed: 0.0997s/iter; left time: 1767.2595s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:22.52s
Steps: 224 | Train Loss: 0.0303649 Vali Loss: 0.1261611 Test Loss: 0.1411284
Validation loss decreased (0.126684 --> 0.126161).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0304579
	speed: 0.1768s/iter; left time: 3110.2793s
	iters: 200, epoch: 22 | loss: 0.0297905
	speed: 0.1002s/iter; left time: 1753.5562s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:22.73s
Steps: 224 | Train Loss: 0.0304837 Vali Loss: 0.1264128 Test Loss: 0.1408116
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0307272
	speed: 0.1681s/iter; left time: 2919.5898s
	iters: 200, epoch: 23 | loss: 0.0295572
	speed: 0.1003s/iter; left time: 1733.1509s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:22.62s
Steps: 224 | Train Loss: 0.0297434 Vali Loss: 0.1263970 Test Loss: 0.1411095
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0314769
	speed: 0.1684s/iter; left time: 2888.2314s
	iters: 200, epoch: 24 | loss: 0.0295095
	speed: 0.1005s/iter; left time: 1713.6911s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:22.72s
Steps: 224 | Train Loss: 0.0295767 Vali Loss: 0.1259887 Test Loss: 0.1408765
Validation loss decreased (0.126161 --> 0.125989).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0312430
	speed: 0.1914s/iter; left time: 3239.6202s
	iters: 200, epoch: 25 | loss: 0.0308773
	speed: 0.0998s/iter; left time: 1679.3797s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:22.57s
Steps: 224 | Train Loss: 0.0291316 Vali Loss: 0.1260642 Test Loss: 0.1408389
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0319661
	speed: 0.1692s/iter; left time: 2826.4961s
	iters: 200, epoch: 26 | loss: 0.0286000
	speed: 0.1011s/iter; left time: 1678.8068s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:22.82s
Steps: 224 | Train Loss: 0.0289346 Vali Loss: 0.1262054 Test Loss: 0.1407005
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0285632
	speed: 0.1670s/iter; left time: 2750.8384s
	iters: 200, epoch: 27 | loss: 0.0289748
	speed: 0.0996s/iter; left time: 1630.7464s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:22.52s
Steps: 224 | Train Loss: 0.0287466 Vali Loss: 0.1262713 Test Loss: 0.1408920
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0290055
	speed: 0.1689s/iter; left time: 2744.3283s
	iters: 200, epoch: 28 | loss: 0.0277826
	speed: 0.1010s/iter; left time: 1632.0553s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:22.85s
Steps: 224 | Train Loss: 0.0286593 Vali Loss: 0.1261419 Test Loss: 0.1399771
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0292756
	speed: 0.1674s/iter; left time: 2683.1799s
	iters: 200, epoch: 29 | loss: 0.0283121
	speed: 0.1000s/iter; left time: 1593.4709s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:22.57s
Steps: 224 | Train Loss: 0.0285146 Vali Loss: 0.1261241 Test Loss: 0.1406155
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0271864
	speed: 0.1694s/iter; left time: 2677.2505s
	iters: 200, epoch: 30 | loss: 0.0279842
	speed: 0.1019s/iter; left time: 1600.9214s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:22.96s
Steps: 224 | Train Loss: 0.0283375 Vali Loss: 0.1260011 Test Loss: 0.1401229
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0279219
	speed: 0.1690s/iter; left time: 2632.6991s
	iters: 200, epoch: 31 | loss: 0.0284825
	speed: 0.0994s/iter; left time: 1539.3806s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:22.54s
Steps: 224 | Train Loss: 0.0281008 Vali Loss: 0.1260184 Test Loss: 0.1401648
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0274448
	speed: 0.1668s/iter; left time: 2561.8487s
	iters: 200, epoch: 32 | loss: 0.0278788
	speed: 0.0994s/iter; left time: 1517.1766s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:22.48s
Steps: 224 | Train Loss: 0.0280171 Vali Loss: 0.1261915 Test Loss: 0.1406342
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0274708
	speed: 0.1667s/iter; left time: 2522.5358s
	iters: 200, epoch: 33 | loss: 0.0282368
	speed: 0.0995s/iter; left time: 1495.5036s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:22.45s
Steps: 224 | Train Loss: 0.0280225 Vali Loss: 0.1261243 Test Loss: 0.1408214
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0286569
	speed: 0.1671s/iter; left time: 2490.5578s
	iters: 200, epoch: 34 | loss: 0.0280261
	speed: 0.0994s/iter; left time: 1471.3830s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:22.50s
Steps: 224 | Train Loss: 0.0278311 Vali Loss: 0.1261183 Test Loss: 0.1404821
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04204396903514862, rmse:0.20504626631736755, mae:0.14087654650211334, rse:0.7261102199554443
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1242477
	speed: 0.1012s/iter; left time: 2257.2450s
	iters: 200, epoch: 1 | loss: 0.1171697
	speed: 0.0997s/iter; left time: 2213.0749s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:22.57s
Steps: 224 | Train Loss: 0.1299392 Vali Loss: 0.1311586 Test Loss: 0.1394444
Validation loss decreased (inf --> 0.131159).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1039839
	speed: 0.1771s/iter; left time: 3910.7070s
	iters: 200, epoch: 2 | loss: 0.0935863
	speed: 0.0994s/iter; left time: 2183.8100s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:22.51s
Steps: 224 | Train Loss: 0.1030212 Vali Loss: 0.1342872 Test Loss: 0.1477258
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0777247
	speed: 0.1686s/iter; left time: 3684.1362s
	iters: 200, epoch: 3 | loss: 0.0737206
	speed: 0.0994s/iter; left time: 2161.4841s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:22.50s
Steps: 224 | Train Loss: 0.0787656 Vali Loss: 0.1355689 Test Loss: 0.1499120
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0638760
	speed: 0.1678s/iter; left time: 3628.4389s
	iters: 200, epoch: 4 | loss: 0.0635152
	speed: 0.0993s/iter; left time: 2138.2869s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:22.51s
Steps: 224 | Train Loss: 0.0655781 Vali Loss: 0.1333372 Test Loss: 0.1491168
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0555358
	speed: 0.1679s/iter; left time: 3593.6052s
	iters: 200, epoch: 5 | loss: 0.0573160
	speed: 0.0993s/iter; left time: 2115.3512s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:22.54s
Steps: 224 | Train Loss: 0.0570693 Vali Loss: 0.1329813 Test Loss: 0.1468537
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0531334
	speed: 0.1681s/iter; left time: 3561.4293s
	iters: 200, epoch: 6 | loss: 0.0529571
	speed: 0.0997s/iter; left time: 2101.5455s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:22.49s
Steps: 224 | Train Loss: 0.0510583 Vali Loss: 0.1324312 Test Loss: 0.1463843
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0469876
	speed: 0.1686s/iter; left time: 3532.4185s
	iters: 200, epoch: 7 | loss: 0.0458747
	speed: 0.0994s/iter; left time: 2072.2839s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:22.52s
Steps: 224 | Train Loss: 0.0464710 Vali Loss: 0.1307112 Test Loss: 0.1434968
Validation loss decreased (0.131159 --> 0.130711).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0451981
	speed: 0.1938s/iter; left time: 4018.4328s
	iters: 200, epoch: 8 | loss: 0.0411316
	speed: 0.0996s/iter; left time: 2055.2660s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:22.48s
Steps: 224 | Train Loss: 0.0429134 Vali Loss: 0.1289652 Test Loss: 0.1438801
Validation loss decreased (0.130711 --> 0.128965).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0396862
	speed: 0.1764s/iter; left time: 3617.1161s
	iters: 200, epoch: 9 | loss: 0.0396968
	speed: 0.0991s/iter; left time: 2023.5205s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:22.44s
Steps: 224 | Train Loss: 0.0406364 Vali Loss: 0.1287583 Test Loss: 0.1428453
Validation loss decreased (0.128965 --> 0.128758).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0372063
	speed: 0.1759s/iter; left time: 3567.7333s
	iters: 200, epoch: 10 | loss: 0.0396097
	speed: 0.0993s/iter; left time: 2004.9709s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:22.51s
Steps: 224 | Train Loss: 0.0382141 Vali Loss: 0.1289230 Test Loss: 0.1427508
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0397195
	speed: 0.1671s/iter; left time: 3352.7139s
	iters: 200, epoch: 11 | loss: 0.0351189
	speed: 0.0993s/iter; left time: 1982.4022s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:22.48s
Steps: 224 | Train Loss: 0.0368077 Vali Loss: 0.1288192 Test Loss: 0.1422276
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0337716
	speed: 0.1684s/iter; left time: 3340.3024s
	iters: 200, epoch: 12 | loss: 0.0348658
	speed: 0.0992s/iter; left time: 1958.1034s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:22.44s
Steps: 224 | Train Loss: 0.0356215 Vali Loss: 0.1283011 Test Loss: 0.1428052
Validation loss decreased (0.128758 --> 0.128301).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0344515
	speed: 0.1825s/iter; left time: 3578.4759s
	iters: 200, epoch: 13 | loss: 0.0332311
	speed: 0.0994s/iter; left time: 1939.3125s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:22.52s
Steps: 224 | Train Loss: 0.0347675 Vali Loss: 0.1277235 Test Loss: 0.1420104
Validation loss decreased (0.128301 --> 0.127723).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0325857
	speed: 0.1761s/iter; left time: 3414.2019s
	iters: 200, epoch: 14 | loss: 0.0326958
	speed: 0.0993s/iter; left time: 1916.0573s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:22.48s
Steps: 224 | Train Loss: 0.0337991 Vali Loss: 0.1276056 Test Loss: 0.1410959
Validation loss decreased (0.127723 --> 0.127606).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0332377
	speed: 0.1800s/iter; left time: 3448.8690s
	iters: 200, epoch: 15 | loss: 0.0326112
	speed: 0.0993s/iter; left time: 1893.7005s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:22.49s
Steps: 224 | Train Loss: 0.0331643 Vali Loss: 0.1276101 Test Loss: 0.1415685
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0317841
	speed: 0.1677s/iter; left time: 3177.3019s
	iters: 200, epoch: 16 | loss: 0.0336634
	speed: 0.1000s/iter; left time: 1883.3694s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:22.58s
Steps: 224 | Train Loss: 0.0319262 Vali Loss: 0.1273212 Test Loss: 0.1411992
Validation loss decreased (0.127606 --> 0.127321).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0315294
	speed: 0.1766s/iter; left time: 3306.3062s
	iters: 200, epoch: 17 | loss: 0.0402153
	speed: 0.0992s/iter; left time: 1847.0172s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:22.45s
Steps: 224 | Train Loss: 0.0316037 Vali Loss: 0.1274369 Test Loss: 0.1422841
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0310733
	speed: 0.1675s/iter; left time: 3096.9075s
	iters: 200, epoch: 18 | loss: 0.0316665
	speed: 0.0992s/iter; left time: 1825.3481s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:22.47s
Steps: 224 | Train Loss: 0.0310502 Vali Loss: 0.1270434 Test Loss: 0.1407711
Validation loss decreased (0.127321 --> 0.127043).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0287771
	speed: 0.1760s/iter; left time: 3216.1727s
	iters: 200, epoch: 19 | loss: 0.0305514
	speed: 0.0992s/iter; left time: 1802.7615s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:22.45s
Steps: 224 | Train Loss: 0.0303930 Vali Loss: 0.1270769 Test Loss: 0.1405970
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0289193
	speed: 0.1678s/iter; left time: 3027.4632s
	iters: 200, epoch: 20 | loss: 0.0286493
	speed: 0.0992s/iter; left time: 1779.5013s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:22.44s
Steps: 224 | Train Loss: 0.0299198 Vali Loss: 0.1268112 Test Loss: 0.1410203
Validation loss decreased (0.127043 --> 0.126811).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0310301
	speed: 0.1729s/iter; left time: 3080.7583s
	iters: 200, epoch: 21 | loss: 0.0276777
	speed: 0.0992s/iter; left time: 1758.5375s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:22.42s
Steps: 224 | Train Loss: 0.0296345 Vali Loss: 0.1268980 Test Loss: 0.1419411
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0292942
	speed: 0.1676s/iter; left time: 2949.2473s
	iters: 200, epoch: 22 | loss: 0.0303327
	speed: 0.0996s/iter; left time: 1742.0906s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:22.57s
Steps: 224 | Train Loss: 0.0295196 Vali Loss: 0.1270390 Test Loss: 0.1411565
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0279907
	speed: 0.1675s/iter; left time: 2909.5327s
	iters: 200, epoch: 23 | loss: 0.0285120
	speed: 0.0996s/iter; left time: 1719.5872s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:22.50s
Steps: 224 | Train Loss: 0.0291036 Vali Loss: 0.1268217 Test Loss: 0.1409847
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0285618
	speed: 0.1670s/iter; left time: 2864.0232s
	iters: 200, epoch: 24 | loss: 0.0295330
	speed: 0.0991s/iter; left time: 1690.1665s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:22.41s
Steps: 224 | Train Loss: 0.0287539 Vali Loss: 0.1268914 Test Loss: 0.1410079
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0284254
	speed: 0.1687s/iter; left time: 2854.9025s
	iters: 200, epoch: 25 | loss: 0.0317466
	speed: 0.0992s/iter; left time: 1669.4651s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:22.49s
Steps: 224 | Train Loss: 0.0286661 Vali Loss: 0.1269969 Test Loss: 0.1407455
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0279723
	speed: 0.1670s/iter; left time: 2789.8496s
	iters: 200, epoch: 26 | loss: 0.0280906
	speed: 0.0995s/iter; left time: 1651.2575s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:22.49s
Steps: 224 | Train Loss: 0.0282482 Vali Loss: 0.1268042 Test Loss: 0.1406889
Validation loss decreased (0.126811 --> 0.126804).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0271803
	speed: 0.1742s/iter; left time: 2871.0541s
	iters: 200, epoch: 27 | loss: 0.0277322
	speed: 0.0992s/iter; left time: 1624.5659s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:22.46s
Steps: 224 | Train Loss: 0.0281096 Vali Loss: 0.1267876 Test Loss: 0.1410657
Validation loss decreased (0.126804 --> 0.126788).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0290098
	speed: 0.1758s/iter; left time: 2856.5209s
	iters: 200, epoch: 28 | loss: 0.0280983
	speed: 0.1004s/iter; left time: 1621.4537s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:22.63s
Steps: 224 | Train Loss: 0.0280412 Vali Loss: 0.1270118 Test Loss: 0.1409286
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0277480
	speed: 0.1673s/iter; left time: 2681.9287s
	iters: 200, epoch: 29 | loss: 0.0283032
	speed: 0.0996s/iter; left time: 1586.6668s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:22.53s
Steps: 224 | Train Loss: 0.0277198 Vali Loss: 0.1267704 Test Loss: 0.1407932
Validation loss decreased (0.126788 --> 0.126770).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0269211
	speed: 0.1756s/iter; left time: 2775.2859s
	iters: 200, epoch: 30 | loss: 0.0287858
	speed: 0.0996s/iter; left time: 1563.9067s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:22.54s
Steps: 224 | Train Loss: 0.0275932 Vali Loss: 0.1266454 Test Loss: 0.1408675
Validation loss decreased (0.126770 --> 0.126645).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0289489
	speed: 0.1765s/iter; left time: 2750.1467s
	iters: 200, epoch: 31 | loss: 0.0269842
	speed: 0.0995s/iter; left time: 1540.1791s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:22.52s
Steps: 224 | Train Loss: 0.0275068 Vali Loss: 0.1267893 Test Loss: 0.1410453
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0268948
	speed: 0.1672s/iter; left time: 2568.2920s
	iters: 200, epoch: 32 | loss: 0.0275908
	speed: 0.0994s/iter; left time: 1517.0748s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:22.49s
Steps: 224 | Train Loss: 0.0272988 Vali Loss: 0.1267322 Test Loss: 0.1409021
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0268456
	speed: 0.1672s/iter; left time: 2529.4851s
	iters: 200, epoch: 33 | loss: 0.0273315
	speed: 0.0992s/iter; left time: 1491.6072s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:22.42s
Steps: 224 | Train Loss: 0.0273786 Vali Loss: 0.1266959 Test Loss: 0.1406758
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0265508
	speed: 0.1676s/iter; left time: 2498.8035s
	iters: 200, epoch: 34 | loss: 0.0265951
	speed: 0.0992s/iter; left time: 1469.4282s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:22.48s
Steps: 224 | Train Loss: 0.0271909 Vali Loss: 0.1265954 Test Loss: 0.1406779
Validation loss decreased (0.126645 --> 0.126595).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0265231
	speed: 0.1753s/iter; left time: 2574.9398s
	iters: 200, epoch: 35 | loss: 0.0273827
	speed: 0.0992s/iter; left time: 1446.9932s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:22.46s
Steps: 224 | Train Loss: 0.0273014 Vali Loss: 0.1266384 Test Loss: 0.1406149
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0272715
	speed: 0.1679s/iter; left time: 2427.9285s
	iters: 200, epoch: 36 | loss: 0.0263559
	speed: 0.0992s/iter; left time: 1425.0264s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:22.46s
Steps: 224 | Train Loss: 0.0269461 Vali Loss: 0.1266462 Test Loss: 0.1410074
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0273352
	speed: 0.1672s/iter; left time: 2380.9293s
	iters: 200, epoch: 37 | loss: 0.0265992
	speed: 0.0993s/iter; left time: 1403.3173s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:22.44s
Steps: 224 | Train Loss: 0.0268802 Vali Loss: 0.1267088 Test Loss: 0.1409060
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0262193
	speed: 0.1681s/iter; left time: 2356.0506s
	iters: 200, epoch: 38 | loss: 0.0269825
	speed: 0.0990s/iter; left time: 1376.9195s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:22.46s
Steps: 224 | Train Loss: 0.0269931 Vali Loss: 0.1266754 Test Loss: 0.1408476
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0283489
	speed: 0.1672s/iter; left time: 2305.8184s
	iters: 200, epoch: 39 | loss: 0.0262878
	speed: 0.0992s/iter; left time: 1358.1670s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:22.43s
Steps: 224 | Train Loss: 0.0268186 Vali Loss: 0.1266399 Test Loss: 0.1409293
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0266380
	speed: 0.1672s/iter; left time: 2268.1683s
	iters: 200, epoch: 40 | loss: 0.0259960
	speed: 0.0993s/iter; left time: 1336.4140s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:22.43s
Steps: 224 | Train Loss: 0.0267726 Vali Loss: 0.1267287 Test Loss: 0.1406187
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0269313
	speed: 0.1679s/iter; left time: 2240.0805s
	iters: 200, epoch: 41 | loss: 0.0265634
	speed: 0.0995s/iter; left time: 1317.8384s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:22.52s
Steps: 224 | Train Loss: 0.0268338 Vali Loss: 0.1266552 Test Loss: 0.1407018
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0262663
	speed: 0.1695s/iter; left time: 2222.7706s
	iters: 200, epoch: 42 | loss: 0.0278459
	speed: 0.0993s/iter; left time: 1291.9458s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:22.52s
Steps: 224 | Train Loss: 0.0267926 Vali Loss: 0.1266343 Test Loss: 0.1407602
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0261751
	speed: 0.1680s/iter; left time: 2166.1836s
	iters: 200, epoch: 43 | loss: 0.0273091
	speed: 0.0995s/iter; left time: 1273.2756s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:22.49s
Steps: 224 | Train Loss: 0.0268088 Vali Loss: 0.1266787 Test Loss: 0.1408890
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0276403
	speed: 0.1675s/iter; left time: 2121.9633s
	iters: 200, epoch: 44 | loss: 0.0258890
	speed: 0.0988s/iter; left time: 1242.3966s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:22.37s
Steps: 224 | Train Loss: 0.0266744 Vali Loss: 0.1265327 Test Loss: 0.1406834
Validation loss decreased (0.126595 --> 0.126533).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0271499
	speed: 0.1774s/iter; left time: 2207.2382s
	iters: 200, epoch: 45 | loss: 0.0256475
	speed: 0.0997s/iter; left time: 1230.6490s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:22.52s
Steps: 224 | Train Loss: 0.0265942 Vali Loss: 0.1266127 Test Loss: 0.1406820
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0264941
	speed: 0.1676s/iter; left time: 2047.6383s
	iters: 200, epoch: 46 | loss: 0.0259737
	speed: 0.0993s/iter; left time: 1203.2065s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:22.45s
Steps: 224 | Train Loss: 0.0265642 Vali Loss: 0.1265820 Test Loss: 0.1407245
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0254731
	speed: 0.1670s/iter; left time: 2003.3742s
	iters: 200, epoch: 47 | loss: 0.0265677
	speed: 0.0996s/iter; left time: 1184.6251s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:22.47s
Steps: 224 | Train Loss: 0.0265836 Vali Loss: 0.1266140 Test Loss: 0.1408633
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0276974
	speed: 0.1670s/iter; left time: 1966.5134s
	iters: 200, epoch: 48 | loss: 0.0270967
	speed: 0.0991s/iter; left time: 1157.2851s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:22.44s
Steps: 224 | Train Loss: 0.0265990 Vali Loss: 0.1265998 Test Loss: 0.1405815
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0262738
	speed: 0.1675s/iter; left time: 1934.4115s
	iters: 200, epoch: 49 | loss: 0.0273522
	speed: 0.0996s/iter; left time: 1139.8608s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:22.52s
Steps: 224 | Train Loss: 0.0265748 Vali Loss: 0.1264659 Test Loss: 0.1406672
Validation loss decreased (0.126533 --> 0.126466).  Saving model ...
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0260855
	speed: 0.1769s/iter; left time: 2003.1773s
	iters: 200, epoch: 50 | loss: 0.0267769
	speed: 0.0992s/iter; left time: 1113.9851s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:22.51s
Steps: 224 | Train Loss: 0.0264955 Vali Loss: 0.1264177 Test Loss: 0.1403963
Validation loss decreased (0.126466 --> 0.126418).  Saving model ...
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0259825
	speed: 0.1780s/iter; left time: 1975.9628s
	iters: 200, epoch: 51 | loss: 0.0265678
	speed: 0.0995s/iter; left time: 1094.8766s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:22.53s
Steps: 224 | Train Loss: 0.0265601 Vali Loss: 0.1264171 Test Loss: 0.1407261
Validation loss decreased (0.126418 --> 0.126417).  Saving model ...
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0255395
	speed: 0.1752s/iter; left time: 1905.7906s
	iters: 200, epoch: 52 | loss: 0.0261697
	speed: 0.0994s/iter; left time: 1071.0775s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:22.50s
Steps: 224 | Train Loss: 0.0265688 Vali Loss: 0.1265205 Test Loss: 0.1405940
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0261250
	speed: 0.1681s/iter; left time: 1791.1259s
	iters: 200, epoch: 53 | loss: 0.0263986
	speed: 0.0994s/iter; left time: 1049.0406s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:22.53s
Steps: 224 | Train Loss: 0.0264487 Vali Loss: 0.1265929 Test Loss: 0.1407698
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0263977
	speed: 0.1674s/iter; left time: 1746.1420s
	iters: 200, epoch: 54 | loss: 0.0268512
	speed: 0.0993s/iter; left time: 1026.0156s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:22.46s
Steps: 224 | Train Loss: 0.0264494 Vali Loss: 0.1265761 Test Loss: 0.1408572
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0282792
	speed: 0.1675s/iter; left time: 1709.2491s
	iters: 200, epoch: 55 | loss: 0.0252980
	speed: 0.0992s/iter; left time: 1002.7112s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:22.49s
Steps: 224 | Train Loss: 0.0264651 Vali Loss: 0.1266173 Test Loss: 0.1409407
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0268920
	speed: 0.1676s/iter; left time: 1672.7793s
	iters: 200, epoch: 56 | loss: 0.0262528
	speed: 0.0995s/iter; left time: 982.7350s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:22.49s
Steps: 224 | Train Loss: 0.0263788 Vali Loss: 0.1266261 Test Loss: 0.1407852
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0261843
	speed: 0.1681s/iter; left time: 1639.8427s
	iters: 200, epoch: 57 | loss: 0.0265339
	speed: 0.0994s/iter; left time: 959.7113s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:22.49s
Steps: 224 | Train Loss: 0.0264286 Vali Loss: 0.1265251 Test Loss: 0.1406273
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0257913
	speed: 0.1670s/iter; left time: 1591.8488s
	iters: 200, epoch: 58 | loss: 0.0256953
	speed: 0.0995s/iter; left time: 938.6728s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:22.50s
Steps: 224 | Train Loss: 0.0265050 Vali Loss: 0.1264443 Test Loss: 0.1406734
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0269404
	speed: 0.1679s/iter; left time: 1563.2571s
	iters: 200, epoch: 59 | loss: 0.0263439
	speed: 0.0993s/iter; left time: 914.6885s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:22.47s
Steps: 224 | Train Loss: 0.0264420 Vali Loss: 0.1266005 Test Loss: 0.1408871
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0265904
	speed: 0.1681s/iter; left time: 1527.2104s
	iters: 200, epoch: 60 | loss: 0.0249333
	speed: 0.0996s/iter; left time: 894.6528s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:22.54s
Steps: 224 | Train Loss: 0.0263893 Vali Loss: 0.1265873 Test Loss: 0.1406013
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0261007
	speed: 0.1683s/iter; left time: 1491.6577s
	iters: 200, epoch: 61 | loss: 0.0266510
	speed: 0.0993s/iter; left time: 869.7511s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:22.48s
Steps: 224 | Train Loss: 0.0264167 Vali Loss: 0.1265362 Test Loss: 0.1407479
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04155511409044266, rmse:0.20385071635246277, mae:0.14072604477405548, rse:0.7218766212463379
Intermediate time for DE and pred_len 96: 00h:43m:13.12s
=== Starting experiments for pred_len: 168 ===

--- Running model for DE, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1261648
	speed: 0.1298s/iter; left time: 2880.7539s
	iters: 200, epoch: 1 | loss: 0.1190995
	speed: 0.1011s/iter; left time: 2235.0617s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:23.04s
Steps: 223 | Train Loss: 0.1339292 Vali Loss: 0.1335317 Test Loss: 0.1439572
Validation loss decreased (inf --> 0.133532).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1051248
	speed: 0.1748s/iter; left time: 3840.6729s
	iters: 200, epoch: 2 | loss: 0.0949041
	speed: 0.1009s/iter; left time: 2207.4692s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:22.70s
Steps: 223 | Train Loss: 0.1056621 Vali Loss: 0.1374970 Test Loss: 0.1528661
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0788745
	speed: 0.1684s/iter; left time: 3663.2307s
	iters: 200, epoch: 3 | loss: 0.0743790
	speed: 0.1009s/iter; left time: 2185.6150s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:22.73s
Steps: 223 | Train Loss: 0.0800766 Vali Loss: 0.1391651 Test Loss: 0.1580985
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0654544
	speed: 0.1691s/iter; left time: 3641.0910s
	iters: 200, epoch: 4 | loss: 0.0631503
	speed: 0.1010s/iter; left time: 2165.0820s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:22.76s
Steps: 223 | Train Loss: 0.0666773 Vali Loss: 0.1346968 Test Loss: 0.1523327
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0569980
	speed: 0.1691s/iter; left time: 3603.2151s
	iters: 200, epoch: 5 | loss: 0.0533941
	speed: 0.1011s/iter; left time: 2143.7986s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:22.76s
Steps: 223 | Train Loss: 0.0580855 Vali Loss: 0.1348484 Test Loss: 0.1486578
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0516111
	speed: 0.1696s/iter; left time: 3576.4654s
	iters: 200, epoch: 6 | loss: 0.0490716
	speed: 0.1009s/iter; left time: 2118.1593s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:22.75s
Steps: 223 | Train Loss: 0.0514214 Vali Loss: 0.1381943 Test Loss: 0.1528778
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0464494
	speed: 0.1686s/iter; left time: 3516.9433s
	iters: 200, epoch: 7 | loss: 0.0477641
	speed: 0.1010s/iter; left time: 2096.9103s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:22.77s
Steps: 223 | Train Loss: 0.0472122 Vali Loss: 0.1324671 Test Loss: 0.1473247
Validation loss decreased (0.133532 --> 0.132467).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0425316
	speed: 0.1749s/iter; left time: 3609.7500s
	iters: 200, epoch: 8 | loss: 0.0432509
	speed: 0.1009s/iter; left time: 2073.1906s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:22.72s
Steps: 223 | Train Loss: 0.0445452 Vali Loss: 0.1312808 Test Loss: 0.1476530
Validation loss decreased (0.132467 --> 0.131281).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0425568
	speed: 0.1777s/iter; left time: 3627.8907s
	iters: 200, epoch: 9 | loss: 0.0417050
	speed: 0.1020s/iter; left time: 2072.5443s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:23.00s
Steps: 223 | Train Loss: 0.0420848 Vali Loss: 0.1306852 Test Loss: 0.1460166
Validation loss decreased (0.131281 --> 0.130685).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0378647
	speed: 0.1766s/iter; left time: 3567.0309s
	iters: 200, epoch: 10 | loss: 0.0402136
	speed: 0.1026s/iter; left time: 2062.6318s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:23.01s
Steps: 223 | Train Loss: 0.0400473 Vali Loss: 0.1308217 Test Loss: 0.1454586
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0374846
	speed: 0.1708s/iter; left time: 3410.6057s
	iters: 200, epoch: 11 | loss: 0.0383585
	speed: 0.1024s/iter; left time: 2035.1479s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:23.04s
Steps: 223 | Train Loss: 0.0382027 Vali Loss: 0.1303351 Test Loss: 0.1458236
Validation loss decreased (0.130685 --> 0.130335).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0374159
	speed: 0.1788s/iter; left time: 3531.5616s
	iters: 200, epoch: 12 | loss: 0.0373506
	speed: 0.1012s/iter; left time: 1988.8510s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:22.77s
Steps: 223 | Train Loss: 0.0376595 Vali Loss: 0.1295768 Test Loss: 0.1450953
Validation loss decreased (0.130335 --> 0.129577).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0358182
	speed: 0.1874s/iter; left time: 3659.5721s
	iters: 200, epoch: 13 | loss: 0.0358183
	speed: 0.1017s/iter; left time: 1975.6172s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:23.04s
Steps: 223 | Train Loss: 0.0360024 Vali Loss: 0.1304294 Test Loss: 0.1469097
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0353733
	speed: 0.1710s/iter; left time: 3301.2346s
	iters: 200, epoch: 14 | loss: 0.0349147
	speed: 0.1022s/iter; left time: 1961.7360s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:23.05s
Steps: 223 | Train Loss: 0.0355296 Vali Loss: 0.1294342 Test Loss: 0.1449126
Validation loss decreased (0.129577 --> 0.129434).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0354217
	speed: 0.1826s/iter; left time: 3483.0609s
	iters: 200, epoch: 15 | loss: 0.0349589
	speed: 0.1029s/iter; left time: 1953.2095s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:23.23s
Steps: 223 | Train Loss: 0.0346953 Vali Loss: 0.1293914 Test Loss: 0.1447888
Validation loss decreased (0.129434 --> 0.129391).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0353416
	speed: 0.1784s/iter; left time: 3364.5301s
	iters: 200, epoch: 16 | loss: 0.0330689
	speed: 0.1011s/iter; left time: 1896.9058s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:22.78s
Steps: 223 | Train Loss: 0.0347494 Vali Loss: 0.1293732 Test Loss: 0.1447825
Validation loss decreased (0.129391 --> 0.129373).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0339002
	speed: 0.1782s/iter; left time: 3320.3985s
	iters: 200, epoch: 17 | loss: 0.0314987
	speed: 0.1019s/iter; left time: 1888.3274s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:22.96s
Steps: 223 | Train Loss: 0.0332876 Vali Loss: 0.1293050 Test Loss: 0.1444554
Validation loss decreased (0.129373 --> 0.129305).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0325020
	speed: 0.1765s/iter; left time: 3249.8851s
	iters: 200, epoch: 18 | loss: 0.0317712
	speed: 0.1010s/iter; left time: 1850.2216s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:22.84s
Steps: 223 | Train Loss: 0.0327897 Vali Loss: 0.1290222 Test Loss: 0.1443444
Validation loss decreased (0.129305 --> 0.129022).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0323275
	speed: 0.1878s/iter; left time: 3415.4863s
	iters: 200, epoch: 19 | loss: 0.0306696
	speed: 0.1024s/iter; left time: 1851.4561s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:23.07s
Steps: 223 | Train Loss: 0.0321643 Vali Loss: 0.1289278 Test Loss: 0.1446663
Validation loss decreased (0.129022 --> 0.128928).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0317876
	speed: 0.1973s/iter; left time: 3544.8125s
	iters: 200, epoch: 20 | loss: 0.0313587
	speed: 0.1014s/iter; left time: 1811.5416s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:22.91s
Steps: 223 | Train Loss: 0.0316554 Vali Loss: 0.1286264 Test Loss: 0.1439690
Validation loss decreased (0.128928 --> 0.128626).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0304738
	speed: 0.1830s/iter; left time: 3246.3841s
	iters: 200, epoch: 21 | loss: 0.0327107
	speed: 0.1028s/iter; left time: 1813.0271s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:23.22s
Steps: 223 | Train Loss: 0.0315763 Vali Loss: 0.1285892 Test Loss: 0.1445394
Validation loss decreased (0.128626 --> 0.128589).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0316087
	speed: 0.1925s/iter; left time: 3371.8919s
	iters: 200, epoch: 22 | loss: 0.0318276
	speed: 0.1010s/iter; left time: 1759.2516s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:22.85s
Steps: 223 | Train Loss: 0.0310572 Vali Loss: 0.1286587 Test Loss: 0.1445479
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0302220
	speed: 0.1707s/iter; left time: 2951.9827s
	iters: 200, epoch: 23 | loss: 0.0304300
	speed: 0.1021s/iter; left time: 1755.7046s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:23.07s
Steps: 223 | Train Loss: 0.0307635 Vali Loss: 0.1284783 Test Loss: 0.1442952
Validation loss decreased (0.128589 --> 0.128478).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0304984
	speed: 0.1763s/iter; left time: 3009.3992s
	iters: 200, epoch: 24 | loss: 0.0302245
	speed: 0.1016s/iter; left time: 1724.5909s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:22.82s
Steps: 223 | Train Loss: 0.0307209 Vali Loss: 0.1284794 Test Loss: 0.1443956
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0304130
	speed: 0.1709s/iter; left time: 2880.2588s
	iters: 200, epoch: 25 | loss: 0.0304252
	speed: 0.1025s/iter; left time: 1716.9522s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:23.06s
Steps: 223 | Train Loss: 0.0305077 Vali Loss: 0.1283769 Test Loss: 0.1444592
Validation loss decreased (0.128478 --> 0.128377).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0312527
	speed: 0.1832s/iter; left time: 3046.0227s
	iters: 200, epoch: 26 | loss: 0.0312282
	speed: 0.1019s/iter; left time: 1684.0844s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:22.88s
Steps: 223 | Train Loss: 0.0302471 Vali Loss: 0.1284113 Test Loss: 0.1442370
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0307134
	speed: 0.1700s/iter; left time: 2788.0699s
	iters: 200, epoch: 27 | loss: 0.0288876
	speed: 0.1026s/iter; left time: 1673.4250s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:22.92s
Steps: 223 | Train Loss: 0.0298442 Vali Loss: 0.1283943 Test Loss: 0.1446010
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0302495
	speed: 0.1689s/iter; left time: 2733.5069s
	iters: 200, epoch: 28 | loss: 0.0294432
	speed: 0.1016s/iter; left time: 1633.3032s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:22.87s
Steps: 223 | Train Loss: 0.0296582 Vali Loss: 0.1284400 Test Loss: 0.1444808
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0289791
	speed: 0.1686s/iter; left time: 2689.7123s
	iters: 200, epoch: 29 | loss: 0.0302416
	speed: 0.1021s/iter; left time: 1618.8666s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:22.87s
Steps: 223 | Train Loss: 0.0295461 Vali Loss: 0.1284262 Test Loss: 0.1441522
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0299884
	speed: 0.1717s/iter; left time: 2702.0460s
	iters: 200, epoch: 30 | loss: 0.0282255
	speed: 0.1018s/iter; left time: 1591.3445s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:22.90s
Steps: 223 | Train Loss: 0.0294263 Vali Loss: 0.1284449 Test Loss: 0.1445789
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0307204
	speed: 0.1689s/iter; left time: 2619.1072s
	iters: 200, epoch: 31 | loss: 0.0296950
	speed: 0.1019s/iter; left time: 1570.7813s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:22.82s
Steps: 223 | Train Loss: 0.0292683 Vali Loss: 0.1281265 Test Loss: 0.1442216
Validation loss decreased (0.128377 --> 0.128127).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0292686
	speed: 0.1794s/iter; left time: 2741.9895s
	iters: 200, epoch: 32 | loss: 0.0289746
	speed: 0.1011s/iter; left time: 1536.2549s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:22.77s
Steps: 223 | Train Loss: 0.0290840 Vali Loss: 0.1284545 Test Loss: 0.1444478
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0279634
	speed: 0.1701s/iter; left time: 2563.0027s
	iters: 200, epoch: 33 | loss: 0.0291580
	speed: 0.1025s/iter; left time: 1533.6054s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:22.99s
Steps: 223 | Train Loss: 0.0290805 Vali Loss: 0.1283684 Test Loss: 0.1443674
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0277546
	speed: 0.1707s/iter; left time: 2533.4751s
	iters: 200, epoch: 34 | loss: 0.0292509
	speed: 0.1015s/iter; left time: 1496.9823s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:22.78s
Steps: 223 | Train Loss: 0.0289610 Vali Loss: 0.1284619 Test Loss: 0.1445035
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0279095
	speed: 0.1706s/iter; left time: 2493.7406s
	iters: 200, epoch: 35 | loss: 0.0283519
	speed: 0.1015s/iter; left time: 1473.0447s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:22.91s
Steps: 223 | Train Loss: 0.0288164 Vali Loss: 0.1283115 Test Loss: 0.1441863
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0276260
	speed: 0.1719s/iter; left time: 2473.9977s
	iters: 200, epoch: 36 | loss: 0.0282516
	speed: 0.1017s/iter; left time: 1454.0066s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:22.91s
Steps: 223 | Train Loss: 0.0287018 Vali Loss: 0.1282796 Test Loss: 0.1444267
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0282841
	speed: 0.1702s/iter; left time: 2412.9425s
	iters: 200, epoch: 37 | loss: 0.0275572
	speed: 0.1017s/iter; left time: 1431.6974s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:22.93s
Steps: 223 | Train Loss: 0.0287441 Vali Loss: 0.1285490 Test Loss: 0.1445745
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0285645
	speed: 0.1708s/iter; left time: 2382.3946s
	iters: 200, epoch: 38 | loss: 0.0292528
	speed: 0.1020s/iter; left time: 1413.0801s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:22.90s
Steps: 223 | Train Loss: 0.0286795 Vali Loss: 0.1284727 Test Loss: 0.1444877
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0287385
	speed: 0.1696s/iter; left time: 2327.4948s
	iters: 200, epoch: 39 | loss: 0.0279627
	speed: 0.1016s/iter; left time: 1384.4400s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:22.86s
Steps: 223 | Train Loss: 0.0284555 Vali Loss: 0.1285705 Test Loss: 0.1444850
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0289875
	speed: 0.1722s/iter; left time: 2325.6854s
	iters: 200, epoch: 40 | loss: 0.0288850
	speed: 0.1024s/iter; left time: 1372.6636s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:23.09s
Steps: 223 | Train Loss: 0.0284726 Vali Loss: 0.1283926 Test Loss: 0.1443235
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0283259
	speed: 0.1705s/iter; left time: 2263.9987s
	iters: 200, epoch: 41 | loss: 0.0278825
	speed: 0.1027s/iter; left time: 1353.1964s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:22.93s
Steps: 223 | Train Loss: 0.0285104 Vali Loss: 0.1286705 Test Loss: 0.1444085
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.043613020330667496, rmse:0.20883730053901672, mae:0.14422158896923065, rse:0.7397185564041138
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1338459
	speed: 0.1034s/iter; left time: 2294.7097s
	iters: 200, epoch: 1 | loss: 0.1213693
	speed: 0.1014s/iter; left time: 2241.6094s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:22.85s
Steps: 223 | Train Loss: 0.1337232 Vali Loss: 0.1337726 Test Loss: 0.1441684
Validation loss decreased (inf --> 0.133773).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1043951
	speed: 0.1813s/iter; left time: 3984.8829s
	iters: 200, epoch: 2 | loss: 0.0920857
	speed: 0.1024s/iter; left time: 2240.5577s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:22.96s
Steps: 223 | Train Loss: 0.1057510 Vali Loss: 0.1365143 Test Loss: 0.1516177
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0821584
	speed: 0.1726s/iter; left time: 3755.3538s
	iters: 200, epoch: 3 | loss: 0.0746673
	speed: 0.1011s/iter; left time: 2188.8454s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:22.89s
Steps: 223 | Train Loss: 0.0797383 Vali Loss: 0.1378467 Test Loss: 0.1510403
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0667732
	speed: 0.1697s/iter; left time: 3653.9238s
	iters: 200, epoch: 4 | loss: 0.0627262
	speed: 0.1010s/iter; left time: 2164.0259s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:22.78s
Steps: 223 | Train Loss: 0.0662417 Vali Loss: 0.1371741 Test Loss: 0.1498331
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0562829
	speed: 0.1699s/iter; left time: 3620.2836s
	iters: 200, epoch: 5 | loss: 0.0550903
	speed: 0.1010s/iter; left time: 2143.1067s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:22.78s
Steps: 223 | Train Loss: 0.0572172 Vali Loss: 0.1346277 Test Loss: 0.1484157
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0504830
	speed: 0.1704s/iter; left time: 3592.5173s
	iters: 200, epoch: 6 | loss: 0.0477005
	speed: 0.1012s/iter; left time: 2123.9372s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:22.82s
Steps: 223 | Train Loss: 0.0506504 Vali Loss: 0.1318472 Test Loss: 0.1444080
Validation loss decreased (0.133773 --> 0.131847).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0474096
	speed: 0.1955s/iter; left time: 4078.2914s
	iters: 200, epoch: 7 | loss: 0.0459429
	speed: 0.1011s/iter; left time: 2099.1143s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:22.80s
Steps: 223 | Train Loss: 0.0467058 Vali Loss: 0.1315055 Test Loss: 0.1430237
Validation loss decreased (0.131847 --> 0.131506).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0485883
	speed: 0.1798s/iter; left time: 3711.2370s
	iters: 200, epoch: 8 | loss: 0.0448056
	speed: 0.1011s/iter; left time: 2077.6157s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:22.86s
Steps: 223 | Train Loss: 0.0443797 Vali Loss: 0.1315295 Test Loss: 0.1430706
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0408929
	speed: 0.1705s/iter; left time: 3480.7831s
	iters: 200, epoch: 9 | loss: 0.0445887
	speed: 0.1010s/iter; left time: 2052.3311s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:22.81s
Steps: 223 | Train Loss: 0.0419238 Vali Loss: 0.1313425 Test Loss: 0.1432481
Validation loss decreased (0.131506 --> 0.131342).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0368652
	speed: 0.1805s/iter; left time: 3644.0987s
	iters: 200, epoch: 10 | loss: 0.0413611
	speed: 0.1011s/iter; left time: 2032.3422s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:22.83s
Steps: 223 | Train Loss: 0.0396389 Vali Loss: 0.1304631 Test Loss: 0.1420865
Validation loss decreased (0.131342 --> 0.130463).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0378972
	speed: 0.1792s/iter; left time: 3578.5187s
	iters: 200, epoch: 11 | loss: 0.0404556
	speed: 0.1011s/iter; left time: 2008.1571s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:22.76s
Steps: 223 | Train Loss: 0.0381702 Vali Loss: 0.1310368 Test Loss: 0.1427826
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0374863
	speed: 0.1685s/iter; left time: 3328.1501s
	iters: 200, epoch: 12 | loss: 0.0395534
	speed: 0.1010s/iter; left time: 1983.7960s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:22.71s
Steps: 223 | Train Loss: 0.0372254 Vali Loss: 0.1305252 Test Loss: 0.1424272
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0391716
	speed: 0.1692s/iter; left time: 3303.8621s
	iters: 200, epoch: 13 | loss: 0.0361170
	speed: 0.1010s/iter; left time: 1961.0588s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:22.79s
Steps: 223 | Train Loss: 0.0358281 Vali Loss: 0.1303129 Test Loss: 0.1430231
Validation loss decreased (0.130463 --> 0.130313).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0342916
	speed: 0.1812s/iter; left time: 3498.0966s
	iters: 200, epoch: 14 | loss: 0.0359754
	speed: 0.1012s/iter; left time: 1943.6959s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:22.84s
Steps: 223 | Train Loss: 0.0349007 Vali Loss: 0.1301288 Test Loss: 0.1417290
Validation loss decreased (0.130313 --> 0.130129).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0340790
	speed: 0.1858s/iter; left time: 3544.9399s
	iters: 200, epoch: 15 | loss: 0.0339541
	speed: 0.1009s/iter; left time: 1915.6930s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:22.73s
Steps: 223 | Train Loss: 0.0348570 Vali Loss: 0.1305743 Test Loss: 0.1419227
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0337586
	speed: 0.1697s/iter; left time: 3200.0545s
	iters: 200, epoch: 16 | loss: 0.0331303
	speed: 0.1010s/iter; left time: 1894.9020s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:22.81s
Steps: 223 | Train Loss: 0.0335450 Vali Loss: 0.1298782 Test Loss: 0.1412999
Validation loss decreased (0.130129 --> 0.129878).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0318183
	speed: 0.1851s/iter; left time: 3449.1933s
	iters: 200, epoch: 17 | loss: 0.0328143
	speed: 0.1009s/iter; left time: 1869.8226s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:22.72s
Steps: 223 | Train Loss: 0.0329707 Vali Loss: 0.1298787 Test Loss: 0.1423763
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0320255
	speed: 0.1696s/iter; left time: 3122.4738s
	iters: 200, epoch: 18 | loss: 0.0310955
	speed: 0.1009s/iter; left time: 1847.0464s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:22.73s
Steps: 223 | Train Loss: 0.0324296 Vali Loss: 0.1296944 Test Loss: 0.1420973
Validation loss decreased (0.129878 --> 0.129694).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0331034
	speed: 0.1784s/iter; left time: 3244.0197s
	iters: 200, epoch: 19 | loss: 0.0322973
	speed: 0.1009s/iter; left time: 1825.6029s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:22.75s
Steps: 223 | Train Loss: 0.0317739 Vali Loss: 0.1300072 Test Loss: 0.1421231
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0312252
	speed: 0.1686s/iter; left time: 3029.1912s
	iters: 200, epoch: 20 | loss: 0.0306236
	speed: 0.1011s/iter; left time: 1805.5387s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:22.75s
Steps: 223 | Train Loss: 0.0313309 Vali Loss: 0.1296711 Test Loss: 0.1417137
Validation loss decreased (0.129694 --> 0.129671).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0304254
	speed: 0.1912s/iter; left time: 3392.9331s
	iters: 200, epoch: 21 | loss: 0.0311199
	speed: 0.1009s/iter; left time: 1780.1910s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:22.84s
Steps: 223 | Train Loss: 0.0310391 Vali Loss: 0.1295275 Test Loss: 0.1416109
Validation loss decreased (0.129671 --> 0.129527).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0298874
	speed: 0.1842s/iter; left time: 3227.2307s
	iters: 200, epoch: 22 | loss: 0.0302612
	speed: 0.1010s/iter; left time: 1759.9667s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:22.81s
Steps: 223 | Train Loss: 0.0310310 Vali Loss: 0.1297438 Test Loss: 0.1420938
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0294712
	speed: 0.1701s/iter; left time: 2941.6373s
	iters: 200, epoch: 23 | loss: 0.0311504
	speed: 0.1010s/iter; left time: 1736.6523s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:22.74s
Steps: 223 | Train Loss: 0.0306204 Vali Loss: 0.1293175 Test Loss: 0.1416340
Validation loss decreased (0.129527 --> 0.129318).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0306717
	speed: 0.1754s/iter; left time: 2993.8695s
	iters: 200, epoch: 24 | loss: 0.0326125
	speed: 0.1013s/iter; left time: 1718.6990s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:22.77s
Steps: 223 | Train Loss: 0.0301517 Vali Loss: 0.1295908 Test Loss: 0.1415685
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0294771
	speed: 0.1693s/iter; left time: 2852.5034s
	iters: 200, epoch: 25 | loss: 0.0290208
	speed: 0.1009s/iter; left time: 1689.8492s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:22.75s
Steps: 223 | Train Loss: 0.0300518 Vali Loss: 0.1294771 Test Loss: 0.1413270
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0310628
	speed: 0.1686s/iter; left time: 2803.7500s
	iters: 200, epoch: 26 | loss: 0.0298298
	speed: 0.1009s/iter; left time: 1667.7063s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:22.73s
Steps: 223 | Train Loss: 0.0298269 Vali Loss: 0.1297811 Test Loss: 0.1419676
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0308892
	speed: 0.1693s/iter; left time: 2777.2208s
	iters: 200, epoch: 27 | loss: 0.0297598
	speed: 0.1009s/iter; left time: 1645.6515s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:22.81s
Steps: 223 | Train Loss: 0.0296573 Vali Loss: 0.1293213 Test Loss: 0.1413701
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0298229
	speed: 0.1707s/iter; left time: 2762.2213s
	iters: 200, epoch: 28 | loss: 0.0291561
	speed: 0.1009s/iter; left time: 1622.1897s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:22.77s
Steps: 223 | Train Loss: 0.0293908 Vali Loss: 0.1292067 Test Loss: 0.1414965
Validation loss decreased (0.129318 --> 0.129207).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0295447
	speed: 0.1762s/iter; left time: 2812.1745s
	iters: 200, epoch: 29 | loss: 0.0289325
	speed: 0.1018s/iter; left time: 1613.6423s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:22.80s
Steps: 223 | Train Loss: 0.0292231 Vali Loss: 0.1293714 Test Loss: 0.1416098
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0297523
	speed: 0.1696s/iter; left time: 2668.8141s
	iters: 200, epoch: 30 | loss: 0.0293122
	speed: 0.1010s/iter; left time: 1578.9754s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:22.81s
Steps: 223 | Train Loss: 0.0291896 Vali Loss: 0.1295614 Test Loss: 0.1418938
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0294015
	speed: 0.1690s/iter; left time: 2620.6202s
	iters: 200, epoch: 31 | loss: 0.0278125
	speed: 0.1011s/iter; left time: 1557.7221s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:22.78s
Steps: 223 | Train Loss: 0.0289900 Vali Loss: 0.1293283 Test Loss: 0.1413058
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0296534
	speed: 0.1684s/iter; left time: 2574.1649s
	iters: 200, epoch: 32 | loss: 0.0288739
	speed: 0.1010s/iter; left time: 1534.5276s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:22.76s
Steps: 223 | Train Loss: 0.0287816 Vali Loss: 0.1293303 Test Loss: 0.1414459
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0288480
	speed: 0.1698s/iter; left time: 2557.5053s
	iters: 200, epoch: 33 | loss: 0.0295896
	speed: 0.1011s/iter; left time: 1512.3335s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:22.71s
Steps: 223 | Train Loss: 0.0287548 Vali Loss: 0.1292268 Test Loss: 0.1410291
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0292089
	speed: 0.1695s/iter; left time: 2515.1648s
	iters: 200, epoch: 34 | loss: 0.0275612
	speed: 0.1013s/iter; left time: 1493.4047s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:22.83s
Steps: 223 | Train Loss: 0.0285835 Vali Loss: 0.1293273 Test Loss: 0.1415049
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0284292
	speed: 0.1692s/iter; left time: 2473.1380s
	iters: 200, epoch: 35 | loss: 0.0274603
	speed: 0.1011s/iter; left time: 1468.4696s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:22.73s
Steps: 223 | Train Loss: 0.0285293 Vali Loss: 0.1294487 Test Loss: 0.1417609
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0283691
	speed: 0.1711s/iter; left time: 2462.4770s
	iters: 200, epoch: 36 | loss: 0.0281101
	speed: 0.1013s/iter; left time: 1448.3387s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:22.87s
Steps: 223 | Train Loss: 0.0283747 Vali Loss: 0.1292968 Test Loss: 0.1414106
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0297436
	speed: 0.1698s/iter; left time: 2405.9788s
	iters: 200, epoch: 37 | loss: 0.0285179
	speed: 0.1012s/iter; left time: 1424.3143s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:22.79s
Steps: 223 | Train Loss: 0.0285509 Vali Loss: 0.1293069 Test Loss: 0.1414223
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0277756
	speed: 0.1697s/iter; left time: 2367.4064s
	iters: 200, epoch: 38 | loss: 0.0290327
	speed: 0.1012s/iter; left time: 1401.3622s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:22.79s
Steps: 223 | Train Loss: 0.0283419 Vali Loss: 0.1292873 Test Loss: 0.1415935
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04234959930181503, rmse:0.205790176987648, mae:0.14149640500545502, rse:0.7289254069328308
Intermediate time for DE and pred_len 168: 00h:36m:38.08sIntermediate time for DE: 01h:31m:06.35s
=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1000400
	speed: 0.1256s/iter; left time: 2800.9754s
	iters: 200, epoch: 1 | loss: 0.0889657
	speed: 0.0978s/iter; left time: 2172.2554s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:22.49s
Steps: 224 | Train Loss: 0.1082130 Vali Loss: 0.1031816 Test Loss: 0.1152446
Validation loss decreased (inf --> 0.103182).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0845666
	speed: 0.1743s/iter; left time: 3847.0460s
	iters: 200, epoch: 2 | loss: 0.0818039
	speed: 0.0982s/iter; left time: 2157.0536s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:22.16s
Steps: 224 | Train Loss: 0.0857477 Vali Loss: 0.0982765 Test Loss: 0.1124934
Validation loss decreased (0.103182 --> 0.098277).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0732861
	speed: 0.1698s/iter; left time: 3709.8877s
	iters: 200, epoch: 3 | loss: 0.0766309
	speed: 0.0978s/iter; left time: 2127.9760s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:22.11s
Steps: 224 | Train Loss: 0.0785921 Vali Loss: 0.1015784 Test Loss: 0.1143293
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0728939
	speed: 0.1620s/iter; left time: 3503.8179s
	iters: 200, epoch: 4 | loss: 0.0681023
	speed: 0.0990s/iter; left time: 2131.6658s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:22.18s
Steps: 224 | Train Loss: 0.0711089 Vali Loss: 0.1054293 Test Loss: 0.1163301
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0639224
	speed: 0.1627s/iter; left time: 3482.3726s
	iters: 200, epoch: 5 | loss: 0.0605066
	speed: 0.0981s/iter; left time: 2089.2166s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:22.12s
Steps: 224 | Train Loss: 0.0622334 Vali Loss: 0.1083525 Test Loss: 0.1197059
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0546447
	speed: 0.1631s/iter; left time: 3453.5807s
	iters: 200, epoch: 6 | loss: 0.0536140
	speed: 0.0979s/iter; left time: 2064.6727s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:22.12s
Steps: 224 | Train Loss: 0.0555567 Vali Loss: 0.1104376 Test Loss: 0.1198921
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0516678
	speed: 0.1625s/iter; left time: 3405.3044s
	iters: 200, epoch: 7 | loss: 0.0488077
	speed: 0.0980s/iter; left time: 2043.5167s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:22.10s
Steps: 224 | Train Loss: 0.0507787 Vali Loss: 0.1112424 Test Loss: 0.1215639
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0464973
	speed: 0.1635s/iter; left time: 3390.0308s
	iters: 200, epoch: 8 | loss: 0.0490609
	speed: 0.0980s/iter; left time: 2021.5279s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:22.19s
Steps: 224 | Train Loss: 0.0473406 Vali Loss: 0.1101312 Test Loss: 0.1211495
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0439890
	speed: 0.1631s/iter; left time: 3346.0291s
	iters: 200, epoch: 9 | loss: 0.0441779
	speed: 0.0982s/iter; left time: 2004.1173s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:22.15s
Steps: 224 | Train Loss: 0.0442485 Vali Loss: 0.1090659 Test Loss: 0.1218175
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0418965
	speed: 0.1634s/iter; left time: 3315.0499s
	iters: 200, epoch: 10 | loss: 0.0423168
	speed: 0.0981s/iter; left time: 1979.2976s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:22.13s
Steps: 224 | Train Loss: 0.0417639 Vali Loss: 0.1084580 Test Loss: 0.1203145
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0392470
	speed: 0.1630s/iter; left time: 3270.8621s
	iters: 200, epoch: 11 | loss: 0.0400443
	speed: 0.0989s/iter; left time: 1974.2845s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:22.22s
Steps: 224 | Train Loss: 0.0399939 Vali Loss: 0.1085082 Test Loss: 0.1204979
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0389502
	speed: 0.1628s/iter; left time: 3230.0995s
	iters: 200, epoch: 12 | loss: 0.0355284
	speed: 0.0979s/iter; left time: 1931.8656s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:22.09s
Steps: 224 | Train Loss: 0.0382218 Vali Loss: 0.1076079 Test Loss: 0.1214052
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.029199549928307533, rmse:0.17087875306606293, mae:0.11249343305826187, rse:0.5894832611083984
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1040811
	speed: 0.0996s/iter; left time: 2221.4734s
	iters: 200, epoch: 1 | loss: 0.0935913
	speed: 0.0979s/iter; left time: 2172.4907s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:22.15s
Steps: 224 | Train Loss: 0.1089075 Vali Loss: 0.1033798 Test Loss: 0.1159112
Validation loss decreased (inf --> 0.103380).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0797644
	speed: 0.1745s/iter; left time: 3851.9621s
	iters: 200, epoch: 2 | loss: 0.0804092
	speed: 0.0981s/iter; left time: 2155.7965s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:22.20s
Steps: 224 | Train Loss: 0.0856039 Vali Loss: 0.0979992 Test Loss: 0.1111437
Validation loss decreased (0.103380 --> 0.097999).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0766721
	speed: 0.1760s/iter; left time: 3845.5997s
	iters: 200, epoch: 3 | loss: 0.0783876
	speed: 0.0981s/iter; left time: 2133.2532s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:22.19s
Steps: 224 | Train Loss: 0.0784792 Vali Loss: 0.0983647 Test Loss: 0.1096302
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0729389
	speed: 0.1636s/iter; left time: 3538.1950s
	iters: 200, epoch: 4 | loss: 0.0714793
	speed: 0.0980s/iter; left time: 2109.0820s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:22.15s
Steps: 224 | Train Loss: 0.0713042 Vali Loss: 0.1074160 Test Loss: 0.1172837
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0637151
	speed: 0.1629s/iter; left time: 3487.4557s
	iters: 200, epoch: 5 | loss: 0.0599574
	speed: 0.0979s/iter; left time: 2086.3567s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:22.09s
Steps: 224 | Train Loss: 0.0628277 Vali Loss: 0.1088988 Test Loss: 0.1203743
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0548561
	speed: 0.1635s/iter; left time: 3463.8681s
	iters: 200, epoch: 6 | loss: 0.0529555
	speed: 0.0980s/iter; left time: 2065.6784s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:22.19s
Steps: 224 | Train Loss: 0.0561751 Vali Loss: 0.1093509 Test Loss: 0.1232503
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0568765
	speed: 0.1625s/iter; left time: 3405.3661s
	iters: 200, epoch: 7 | loss: 0.0484834
	speed: 0.0975s/iter; left time: 2032.6938s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:22.04s
Steps: 224 | Train Loss: 0.0508114 Vali Loss: 0.1082517 Test Loss: 0.1216338
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0478964
	speed: 0.1640s/iter; left time: 3401.0924s
	iters: 200, epoch: 8 | loss: 0.0458303
	speed: 0.0979s/iter; left time: 2020.6061s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:22.15s
Steps: 224 | Train Loss: 0.0471401 Vali Loss: 0.1078706 Test Loss: 0.1242654
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0449760
	speed: 0.1644s/iter; left time: 3370.9944s
	iters: 200, epoch: 9 | loss: 0.0443707
	speed: 0.0982s/iter; left time: 2003.2677s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:22.23s
Steps: 224 | Train Loss: 0.0438777 Vali Loss: 0.1064936 Test Loss: 0.1229029
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0417951
	speed: 0.1627s/iter; left time: 3301.1427s
	iters: 200, epoch: 10 | loss: 0.0405808
	speed: 0.0979s/iter; left time: 1976.2847s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:22.10s
Steps: 224 | Train Loss: 0.0417294 Vali Loss: 0.1068690 Test Loss: 0.1220882
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0396463
	speed: 0.1632s/iter; left time: 3273.3391s
	iters: 200, epoch: 11 | loss: 0.0384465
	speed: 0.0979s/iter; left time: 1954.4855s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:22.13s
Steps: 224 | Train Loss: 0.0397610 Vali Loss: 0.1065472 Test Loss: 0.1219878
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0375036
	speed: 0.1628s/iter; left time: 3229.6234s
	iters: 200, epoch: 12 | loss: 0.0383344
	speed: 0.0979s/iter; left time: 1932.0174s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:22.11s
Steps: 224 | Train Loss: 0.0381573 Vali Loss: 0.1053996 Test Loss: 0.1228065
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.028552530333399773, rmse:0.16897493600845337, mae:0.11114371567964554, rse:0.5829156041145325
Intermediate time for GB and pred_len 24: 00h:10m:46.68s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1210458
	speed: 0.1269s/iter; left time: 2830.2620s
	iters: 200, epoch: 1 | loss: 0.1112605
	speed: 0.0995s/iter; left time: 2209.8410s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:22.81s
Steps: 224 | Train Loss: 0.1222008 Vali Loss: 0.1245735 Test Loss: 0.1466682
Validation loss decreased (inf --> 0.124573).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1038702
	speed: 0.1772s/iter; left time: 3911.0823s
	iters: 200, epoch: 2 | loss: 0.0924622
	speed: 0.0996s/iter; left time: 2189.3046s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:22.59s
Steps: 224 | Train Loss: 0.1059021 Vali Loss: 0.1332862 Test Loss: 0.1500637
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0808003
	speed: 0.1660s/iter; left time: 3626.9603s
	iters: 200, epoch: 3 | loss: 0.0736129
	speed: 0.0995s/iter; left time: 2164.7561s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:22.45s
Steps: 224 | Train Loss: 0.0828622 Vali Loss: 0.1415045 Test Loss: 0.1570451
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0686038
	speed: 0.1689s/iter; left time: 3653.0037s
	iters: 200, epoch: 4 | loss: 0.0656218
	speed: 0.1005s/iter; left time: 2162.8818s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:22.69s
Steps: 224 | Train Loss: 0.0670727 Vali Loss: 0.1425244 Test Loss: 0.1607312
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0593092
	speed: 0.1673s/iter; left time: 3581.4297s
	iters: 200, epoch: 5 | loss: 0.0538448
	speed: 0.0994s/iter; left time: 2117.2311s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:22.48s
Steps: 224 | Train Loss: 0.0584418 Vali Loss: 0.1416681 Test Loss: 0.1574435
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0527765
	speed: 0.1669s/iter; left time: 3535.6931s
	iters: 200, epoch: 6 | loss: 0.0497815
	speed: 0.0998s/iter; left time: 2104.2426s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:22.48s
Steps: 224 | Train Loss: 0.0519867 Vali Loss: 0.1407373 Test Loss: 0.1585691
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0489115
	speed: 0.1663s/iter; left time: 3485.4344s
	iters: 200, epoch: 7 | loss: 0.0484653
	speed: 0.0994s/iter; left time: 2073.0544s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:22.47s
Steps: 224 | Train Loss: 0.0475200 Vali Loss: 0.1369800 Test Loss: 0.1548225
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0409547
	speed: 0.1668s/iter; left time: 3457.4731s
	iters: 200, epoch: 8 | loss: 0.0426313
	speed: 0.0996s/iter; left time: 2055.3569s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:22.51s
Steps: 224 | Train Loss: 0.0440538 Vali Loss: 0.1374608 Test Loss: 0.1542663
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0407711
	speed: 0.1667s/iter; left time: 3419.2583s
	iters: 200, epoch: 9 | loss: 0.0403957
	speed: 0.0995s/iter; left time: 2031.3795s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:22.48s
Steps: 224 | Train Loss: 0.0417281 Vali Loss: 0.1348568 Test Loss: 0.1534370
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0386112
	speed: 0.1665s/iter; left time: 3377.1250s
	iters: 200, epoch: 10 | loss: 0.0402503
	speed: 0.0995s/iter; left time: 2008.1555s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:22.50s
Steps: 224 | Train Loss: 0.0405633 Vali Loss: 0.1359578 Test Loss: 0.1525046
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0384958
	speed: 0.1657s/iter; left time: 3324.6472s
	iters: 200, epoch: 11 | loss: 0.0376746
	speed: 0.0994s/iter; left time: 1984.8380s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:22.44s
Steps: 224 | Train Loss: 0.0389795 Vali Loss: 0.1339630 Test Loss: 0.1529814
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04464218392968178, rmse:0.2112869769334793, mae:0.1466681808233261, rse:0.7306598424911499
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1185862
	speed: 0.1007s/iter; left time: 2246.7355s
	iters: 200, epoch: 1 | loss: 0.1120367
	speed: 0.0995s/iter; left time: 2208.1628s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:22.46s
Steps: 224 | Train Loss: 0.1219711 Vali Loss: 0.1247018 Test Loss: 0.1465372
Validation loss decreased (inf --> 0.124702).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1071755
	speed: 0.1783s/iter; left time: 3935.7838s
	iters: 200, epoch: 2 | loss: 0.0921484
	speed: 0.0996s/iter; left time: 2189.5896s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:22.57s
Steps: 224 | Train Loss: 0.1046357 Vali Loss: 0.1321889 Test Loss: 0.1508403
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0789659
	speed: 0.1683s/iter; left time: 3678.3543s
	iters: 200, epoch: 3 | loss: 0.0739356
	speed: 0.0994s/iter; left time: 2161.9754s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:22.53s
Steps: 224 | Train Loss: 0.0799068 Vali Loss: 0.1397098 Test Loss: 0.1557169
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0647016
	speed: 0.1667s/iter; left time: 3605.9977s
	iters: 200, epoch: 4 | loss: 0.0596794
	speed: 0.0995s/iter; left time: 2141.1073s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:22.47s
Steps: 224 | Train Loss: 0.0650651 Vali Loss: 0.1369236 Test Loss: 0.1548756
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0552947
	speed: 0.1667s/iter; left time: 3568.3970s
	iters: 200, epoch: 5 | loss: 0.0535644
	speed: 0.0994s/iter; left time: 2117.3180s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:22.48s
Steps: 224 | Train Loss: 0.0560993 Vali Loss: 0.1345373 Test Loss: 0.1530709
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0523013
	speed: 0.1669s/iter; left time: 3534.0539s
	iters: 200, epoch: 6 | loss: 0.0488983
	speed: 0.0994s/iter; left time: 2095.2129s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:22.47s
Steps: 224 | Train Loss: 0.0505612 Vali Loss: 0.1308149 Test Loss: 0.1535134
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0531405
	speed: 0.1667s/iter; left time: 3493.7993s
	iters: 200, epoch: 7 | loss: 0.0464522
	speed: 0.0994s/iter; left time: 2072.3212s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:22.45s
Steps: 224 | Train Loss: 0.0472376 Vali Loss: 0.1320213 Test Loss: 0.1530477
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0429615
	speed: 0.1662s/iter; left time: 3445.9405s
	iters: 200, epoch: 8 | loss: 0.0425697
	speed: 0.0994s/iter; left time: 2051.5342s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:22.44s
Steps: 224 | Train Loss: 0.0434822 Vali Loss: 0.1306199 Test Loss: 0.1524510
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0411477
	speed: 0.1665s/iter; left time: 3415.7583s
	iters: 200, epoch: 9 | loss: 0.0385973
	speed: 0.0994s/iter; left time: 2028.8752s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:22.47s
Steps: 224 | Train Loss: 0.0412297 Vali Loss: 0.1286369 Test Loss: 0.1519012
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0394646
	speed: 0.1683s/iter; left time: 3414.0083s
	iters: 200, epoch: 10 | loss: 0.0407799
	speed: 0.0995s/iter; left time: 2008.6993s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:22.53s
Steps: 224 | Train Loss: 0.0394865 Vali Loss: 0.1282582 Test Loss: 0.1509731
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0409676
	speed: 0.1672s/iter; left time: 3354.0731s
	iters: 200, epoch: 11 | loss: 0.0372345
	speed: 0.0995s/iter; left time: 1986.6432s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:22.51s
Steps: 224 | Train Loss: 0.0393302 Vali Loss: 0.1287157 Test Loss: 0.1511781
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.044634852558374405, rmse:0.21126961708068848, mae:0.14653731882572174, rse:0.7305997610092163
Intermediate time for GB and pred_len 96: 00h:10m:06.07s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1212218
	speed: 0.1264s/iter; left time: 2807.3061s
	iters: 200, epoch: 1 | loss: 0.1139713
	speed: 0.1011s/iter; left time: 2234.7353s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:23.00s
Steps: 223 | Train Loss: 0.1252046 Vali Loss: 0.1282504 Test Loss: 0.1520317
Validation loss decreased (inf --> 0.128250).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1078130
	speed: 0.1820s/iter; left time: 3999.9323s
	iters: 200, epoch: 2 | loss: 0.1011755
	speed: 0.1011s/iter; left time: 2211.3081s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:22.80s
Steps: 223 | Train Loss: 0.1077820 Vali Loss: 0.1364171 Test Loss: 0.1541169
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0831033
	speed: 0.1681s/iter; left time: 3657.9561s
	iters: 200, epoch: 3 | loss: 0.0750316
	speed: 0.1008s/iter; left time: 2182.1408s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:22.73s
Steps: 223 | Train Loss: 0.0813860 Vali Loss: 0.1430847 Test Loss: 0.1601447
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0659564
	speed: 0.1663s/iter; left time: 3581.3312s
	iters: 200, epoch: 4 | loss: 0.0617063
	speed: 0.1010s/iter; left time: 2163.9277s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:22.68s
Steps: 223 | Train Loss: 0.0664012 Vali Loss: 0.1409647 Test Loss: 0.1582429
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0551478
	speed: 0.1661s/iter; left time: 3538.7871s
	iters: 200, epoch: 5 | loss: 0.0538402
	speed: 0.1009s/iter; left time: 2139.9437s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:22.65s
Steps: 223 | Train Loss: 0.0568825 Vali Loss: 0.1416528 Test Loss: 0.1601245
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0496445
	speed: 0.1661s/iter; left time: 3502.8575s
	iters: 200, epoch: 6 | loss: 0.0504231
	speed: 0.1011s/iter; left time: 2121.0885s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:22.70s
Steps: 223 | Train Loss: 0.0519403 Vali Loss: 0.1357887 Test Loss: 0.1577356
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0514954
	speed: 0.1673s/iter; left time: 3490.1665s
	iters: 200, epoch: 7 | loss: 0.0473062
	speed: 0.1011s/iter; left time: 2098.3224s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:22.79s
Steps: 223 | Train Loss: 0.0473768 Vali Loss: 0.1372073 Test Loss: 0.1573528
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0422178
	speed: 0.1665s/iter; left time: 3437.4536s
	iters: 200, epoch: 8 | loss: 0.0432705
	speed: 0.1010s/iter; left time: 2075.1803s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:22.69s
Steps: 223 | Train Loss: 0.0447079 Vali Loss: 0.1335165 Test Loss: 0.1570952
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0454519
	speed: 0.1654s/iter; left time: 3376.6563s
	iters: 200, epoch: 9 | loss: 0.0439654
	speed: 0.1012s/iter; left time: 2055.4241s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:22.71s
Steps: 223 | Train Loss: 0.0434310 Vali Loss: 0.1341390 Test Loss: 0.1555370
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0399883
	speed: 0.1669s/iter; left time: 3370.8261s
	iters: 200, epoch: 10 | loss: 0.0389427
	speed: 0.1010s/iter; left time: 2029.3259s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:22.66s
Steps: 223 | Train Loss: 0.0405045 Vali Loss: 0.1328685 Test Loss: 0.1561904
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0404393
	speed: 0.1657s/iter; left time: 3309.0078s
	iters: 200, epoch: 11 | loss: 0.0401293
	speed: 0.1009s/iter; left time: 2004.3886s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:22.68s
Steps: 223 | Train Loss: 0.0393156 Vali Loss: 0.1367602 Test Loss: 0.1561167
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.047135237604379654, rmse:0.21710650622844696, mae:0.15203170478343964, rse:0.752739429473877
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1246958
	speed: 0.1027s/iter; left time: 2280.7693s
	iters: 200, epoch: 1 | loss: 0.1193848
	speed: 0.1010s/iter; left time: 2232.4054s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:22.76s
Steps: 223 | Train Loss: 0.1251033 Vali Loss: 0.1285281 Test Loss: 0.1520350
Validation loss decreased (inf --> 0.128528).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1079517
	speed: 0.1846s/iter; left time: 4056.5247s
	iters: 200, epoch: 2 | loss: 0.0979819
	speed: 0.1013s/iter; left time: 2215.9539s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:22.86s
Steps: 223 | Train Loss: 0.1067287 Vali Loss: 0.1381765 Test Loss: 0.1558307
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0806419
	speed: 0.1688s/iter; left time: 3672.0790s
	iters: 200, epoch: 3 | loss: 0.0722020
	speed: 0.1009s/iter; left time: 2185.1990s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:22.68s
Steps: 223 | Train Loss: 0.0795303 Vali Loss: 0.1408413 Test Loss: 0.1584047
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0665133
	speed: 0.1695s/iter; left time: 3649.7260s
	iters: 200, epoch: 4 | loss: 0.0628806
	speed: 0.1010s/iter; left time: 2164.3039s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:22.80s
Steps: 223 | Train Loss: 0.0655871 Vali Loss: 0.1403571 Test Loss: 0.1598811
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0583973
	speed: 0.1679s/iter; left time: 3577.5676s
	iters: 200, epoch: 5 | loss: 0.0529059
	speed: 0.1009s/iter; left time: 2139.0980s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:22.68s
Steps: 223 | Train Loss: 0.0570187 Vali Loss: 0.1381003 Test Loss: 0.1594655
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0521242
	speed: 0.1683s/iter; left time: 3547.9760s
	iters: 200, epoch: 6 | loss: 0.0498817
	speed: 0.1013s/iter; left time: 2126.6846s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:22.79s
Steps: 223 | Train Loss: 0.0517209 Vali Loss: 0.1397730 Test Loss: 0.1600732
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0468313
	speed: 0.1696s/iter; left time: 3539.3593s
	iters: 200, epoch: 7 | loss: 0.0480323
	speed: 0.1010s/iter; left time: 2096.3652s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:22.77s
Steps: 223 | Train Loss: 0.0474814 Vali Loss: 0.1360781 Test Loss: 0.1613502
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0461521
	speed: 0.1694s/iter; left time: 3495.6213s
	iters: 200, epoch: 8 | loss: 0.0448193
	speed: 0.1010s/iter; left time: 2074.4310s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:22.74s
Steps: 223 | Train Loss: 0.0448962 Vali Loss: 0.1352690 Test Loss: 0.1596699
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0418778
	speed: 0.1680s/iter; left time: 3430.8513s
	iters: 200, epoch: 9 | loss: 0.0405838
	speed: 0.1009s/iter; left time: 2050.0136s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:22.69s
Steps: 223 | Train Loss: 0.0422619 Vali Loss: 0.1348368 Test Loss: 0.1576244
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0396611
	speed: 0.1692s/iter; left time: 3415.9756s
	iters: 200, epoch: 10 | loss: 0.0392483
	speed: 0.1009s/iter; left time: 2027.8148s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:22.70s
Steps: 223 | Train Loss: 0.0415109 Vali Loss: 0.1355973 Test Loss: 0.1582328
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0386109
	speed: 0.1681s/iter; left time: 3357.6595s
	iters: 200, epoch: 11 | loss: 0.0408022
	speed: 0.1010s/iter; left time: 2006.6817s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:22.71s
Steps: 223 | Train Loss: 0.0391746 Vali Loss: 0.1352939 Test Loss: 0.1572801
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04724753275513649, rmse:0.21736498177051544, mae:0.1520349681377411, rse:0.7536356449127197
Intermediate time for GB and pred_len 168: 00h:10m:13.64sIntermediate time for GB: 00h:31m:06.39s
=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1083394
	speed: 0.0564s/iter; left time: 1257.0853s
	iters: 200, epoch: 1 | loss: 0.0949330
	speed: 0.0322s/iter; left time: 715.9595s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.74s
Steps: 224 | Train Loss: 0.1146521 Vali Loss: 0.0854233 Test Loss: 0.0978887
Validation loss decreased (inf --> 0.085423).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0694569
	speed: 0.0609s/iter; left time: 1344.2013s
	iters: 200, epoch: 2 | loss: 0.0682702
	speed: 0.0323s/iter; left time: 710.5164s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.42s
Steps: 224 | Train Loss: 0.0716935 Vali Loss: 0.0656114 Test Loss: 0.0731752
Validation loss decreased (0.085423 --> 0.065611).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0638887
	speed: 0.0623s/iter; left time: 1361.0037s
	iters: 200, epoch: 3 | loss: 0.0625745
	speed: 0.0321s/iter; left time: 698.1454s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.40s
Steps: 224 | Train Loss: 0.0642866 Vali Loss: 0.0630241 Test Loss: 0.0710565
Validation loss decreased (0.065611 --> 0.063024).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0611238
	speed: 0.0613s/iter; left time: 1325.6060s
	iters: 200, epoch: 4 | loss: 0.0643910
	speed: 0.0324s/iter; left time: 696.8565s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.47s
Steps: 224 | Train Loss: 0.0619596 Vali Loss: 0.0643963 Test Loss: 0.0716253
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0614629
	speed: 0.0601s/iter; left time: 1286.6637s
	iters: 200, epoch: 5 | loss: 0.0591143
	speed: 0.0323s/iter; left time: 687.9471s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.46s
Steps: 224 | Train Loss: 0.0598301 Vali Loss: 0.0612322 Test Loss: 0.0694189
Validation loss decreased (0.063024 --> 0.061232).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0568408
	speed: 0.0638s/iter; left time: 1350.7376s
	iters: 200, epoch: 6 | loss: 0.0567278
	speed: 0.0321s/iter; left time: 676.9044s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.41s
Steps: 224 | Train Loss: 0.0577446 Vali Loss: 0.0609693 Test Loss: 0.0682407
Validation loss decreased (0.061232 --> 0.060969).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0562621
	speed: 0.0607s/iter; left time: 1271.2555s
	iters: 200, epoch: 7 | loss: 0.0554868
	speed: 0.0322s/iter; left time: 672.5456s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.43s
Steps: 224 | Train Loss: 0.0561681 Vali Loss: 0.0597783 Test Loss: 0.0675127
Validation loss decreased (0.060969 --> 0.059778).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0569908
	speed: 0.0609s/iter; left time: 1262.2103s
	iters: 200, epoch: 8 | loss: 0.0577169
	speed: 0.0321s/iter; left time: 662.8541s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.39s
Steps: 224 | Train Loss: 0.0544420 Vali Loss: 0.0602443 Test Loss: 0.0683316
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0521781
	speed: 0.0592s/iter; left time: 1214.7410s
	iters: 200, epoch: 9 | loss: 0.0503141
	speed: 0.0326s/iter; left time: 666.2345s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.49s
Steps: 224 | Train Loss: 0.0526811 Vali Loss: 0.0609316 Test Loss: 0.0681847
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0519583
	speed: 0.0586s/iter; left time: 1188.8725s
	iters: 200, epoch: 10 | loss: 0.0487051
	speed: 0.0322s/iter; left time: 649.7129s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.40s
Steps: 224 | Train Loss: 0.0512578 Vali Loss: 0.0613501 Test Loss: 0.0695660
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0517822
	speed: 0.0595s/iter; left time: 1193.3900s
	iters: 200, epoch: 11 | loss: 0.0482223
	speed: 0.0322s/iter; left time: 643.0495s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.44s
Steps: 224 | Train Loss: 0.0498223 Vali Loss: 0.0620379 Test Loss: 0.0702392
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0494305
	speed: 0.0583s/iter; left time: 1156.3769s
	iters: 200, epoch: 12 | loss: 0.0481998
	speed: 0.0327s/iter; left time: 645.6910s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.48s
Steps: 224 | Train Loss: 0.0483653 Vali Loss: 0.0612045 Test Loss: 0.0701841
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0462038
	speed: 0.0580s/iter; left time: 1136.6627s
	iters: 200, epoch: 13 | loss: 0.0461890
	speed: 0.0321s/iter; left time: 626.1601s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.36s
Steps: 224 | Train Loss: 0.0470476 Vali Loss: 0.0618377 Test Loss: 0.0701277
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0474969
	speed: 0.0581s/iter; left time: 1125.8177s
	iters: 200, epoch: 14 | loss: 0.0462358
	speed: 0.0323s/iter; left time: 622.6866s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.41s
Steps: 224 | Train Loss: 0.0460021 Vali Loss: 0.0619138 Test Loss: 0.0706668
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0441642
	speed: 0.0589s/iter; left time: 1128.4667s
	iters: 200, epoch: 15 | loss: 0.0437523
	speed: 0.0321s/iter; left time: 611.9848s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.42s
Steps: 224 | Train Loss: 0.0449358 Vali Loss: 0.0615214 Test Loss: 0.0704811
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0440189
	speed: 0.0582s/iter; left time: 1101.4306s
	iters: 200, epoch: 16 | loss: 0.0432764
	speed: 0.0322s/iter; left time: 607.3002s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.38s
Steps: 224 | Train Loss: 0.0439870 Vali Loss: 0.0616211 Test Loss: 0.0707664
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0423084
	speed: 0.0582s/iter; left time: 1090.1792s
	iters: 200, epoch: 17 | loss: 0.0415025
	speed: 0.0323s/iter; left time: 601.3856s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.39s
Steps: 224 | Train Loss: 0.0431494 Vali Loss: 0.0620262 Test Loss: 0.0715410
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01133799646049738, rmse:0.10648002475500107, mae:0.06751272827386856, rse:0.3133578300476074
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1059176
	speed: 0.0344s/iter; left time: 766.7583s
	iters: 200, epoch: 1 | loss: 0.0954594
	speed: 0.0326s/iter; left time: 722.8007s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.51s
Steps: 224 | Train Loss: 0.1132807 Vali Loss: 0.0858611 Test Loss: 0.0978220
Validation loss decreased (inf --> 0.085861).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0672946
	speed: 0.0650s/iter; left time: 1435.0460s
	iters: 200, epoch: 2 | loss: 0.0662497
	speed: 0.0323s/iter; left time: 709.9186s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.45s
Steps: 224 | Train Loss: 0.0716624 Vali Loss: 0.0645302 Test Loss: 0.0728868
Validation loss decreased (0.085861 --> 0.064530).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0636461
	speed: 0.0631s/iter; left time: 1379.3753s
	iters: 200, epoch: 3 | loss: 0.0644167
	speed: 0.0320s/iter; left time: 697.1734s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.43s
Steps: 224 | Train Loss: 0.0639991 Vali Loss: 0.0630432 Test Loss: 0.0709006
Validation loss decreased (0.064530 --> 0.063043).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0621769
	speed: 0.0615s/iter; left time: 1330.3933s
	iters: 200, epoch: 4 | loss: 0.0600844
	speed: 0.0322s/iter; left time: 693.1268s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.41s
Steps: 224 | Train Loss: 0.0615069 Vali Loss: 0.0610647 Test Loss: 0.0695123
Validation loss decreased (0.063043 --> 0.061065).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0606961
	speed: 0.0618s/iter; left time: 1322.3372s
	iters: 200, epoch: 5 | loss: 0.0597096
	speed: 0.0320s/iter; left time: 682.2039s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.38s
Steps: 224 | Train Loss: 0.0594661 Vali Loss: 0.0604619 Test Loss: 0.0694347
Validation loss decreased (0.061065 --> 0.060462).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0590119
	speed: 0.0600s/iter; left time: 1271.2708s
	iters: 200, epoch: 6 | loss: 0.0569254
	speed: 0.0320s/iter; left time: 674.4279s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.36s
Steps: 224 | Train Loss: 0.0579130 Vali Loss: 0.0610369 Test Loss: 0.0684163
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0548901
	speed: 0.0585s/iter; left time: 1226.6705s
	iters: 200, epoch: 7 | loss: 0.0539524
	speed: 0.0321s/iter; left time: 668.6249s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.37s
Steps: 224 | Train Loss: 0.0559329 Vali Loss: 0.0594218 Test Loss: 0.0678336
Validation loss decreased (0.060462 --> 0.059422).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0538018
	speed: 0.0622s/iter; left time: 1288.9799s
	iters: 200, epoch: 8 | loss: 0.0530818
	speed: 0.0327s/iter; left time: 675.7049s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.48s
Steps: 224 | Train Loss: 0.0542583 Vali Loss: 0.0599612 Test Loss: 0.0689581
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0552536
	speed: 0.0589s/iter; left time: 1207.6644s
	iters: 200, epoch: 9 | loss: 0.0516640
	speed: 0.0324s/iter; left time: 662.2151s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.45s
Steps: 224 | Train Loss: 0.0527426 Vali Loss: 0.0591997 Test Loss: 0.0679362
Validation loss decreased (0.059422 --> 0.059200).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0536080
	speed: 0.0609s/iter; left time: 1235.1285s
	iters: 200, epoch: 10 | loss: 0.0499571
	speed: 0.0322s/iter; left time: 649.2337s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.42s
Steps: 224 | Train Loss: 0.0512842 Vali Loss: 0.0599653 Test Loss: 0.0687808
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0517187
	speed: 0.0595s/iter; left time: 1194.0080s
	iters: 200, epoch: 11 | loss: 0.0499973
	speed: 0.0321s/iter; left time: 640.5588s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.42s
Steps: 224 | Train Loss: 0.0497935 Vali Loss: 0.0604572 Test Loss: 0.0696274
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0468627
	speed: 0.0593s/iter; left time: 1176.0288s
	iters: 200, epoch: 12 | loss: 0.0489540
	speed: 0.0325s/iter; left time: 641.9414s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.42s
Steps: 224 | Train Loss: 0.0483913 Vali Loss: 0.0602030 Test Loss: 0.0697745
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0496078
	speed: 0.0592s/iter; left time: 1161.9942s
	iters: 200, epoch: 13 | loss: 0.0476634
	speed: 0.0324s/iter; left time: 632.8809s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.48s
Steps: 224 | Train Loss: 0.0473625 Vali Loss: 0.0604081 Test Loss: 0.0700828
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0464205
	speed: 0.0592s/iter; left time: 1147.5243s
	iters: 200, epoch: 14 | loss: 0.0435993
	speed: 0.0323s/iter; left time: 623.3370s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.44s
Steps: 224 | Train Loss: 0.0461338 Vali Loss: 0.0605141 Test Loss: 0.0701649
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0460268
	speed: 0.0616s/iter; left time: 1180.3255s
	iters: 200, epoch: 15 | loss: 0.0453027
	speed: 0.0329s/iter; left time: 627.0169s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.61s
Steps: 224 | Train Loss: 0.0451875 Vali Loss: 0.0609419 Test Loss: 0.0697475
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0459039
	speed: 0.0612s/iter; left time: 1159.3341s
	iters: 200, epoch: 16 | loss: 0.0434766
	speed: 0.0322s/iter; left time: 605.7834s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.48s
Steps: 224 | Train Loss: 0.0443061 Vali Loss: 0.0615374 Test Loss: 0.0706668
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0443573
	speed: 0.0596s/iter; left time: 1114.8255s
	iters: 200, epoch: 17 | loss: 0.0425250
	speed: 0.0321s/iter; left time: 598.1399s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.42s
Steps: 224 | Train Loss: 0.0435606 Vali Loss: 0.0604851 Test Loss: 0.0707585
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0413324
	speed: 0.0595s/iter; left time: 1100.8525s
	iters: 200, epoch: 18 | loss: 0.0445203
	speed: 0.0322s/iter; left time: 591.5167s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.42s
Steps: 224 | Train Loss: 0.0428060 Vali Loss: 0.0611732 Test Loss: 0.0707645
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0436631
	speed: 0.0591s/iter; left time: 1080.1691s
	iters: 200, epoch: 19 | loss: 0.0429139
	speed: 0.0322s/iter; left time: 584.5549s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.43s
Steps: 224 | Train Loss: 0.0421968 Vali Loss: 0.0612346 Test Loss: 0.0706914
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.011598608456552029, rmse:0.10769683867692947, mae:0.06793618202209473, rse:0.31693875789642334
Intermediate time for ES and pred_len 24: 00h:05m:44.59s
=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1167209
	speed: 0.0575s/iter; left time: 1282.5565s
	iters: 200, epoch: 1 | loss: 0.1056875
	speed: 0.0337s/iter; left time: 747.9371s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.1227398 Vali Loss: 0.0988195 Test Loss: 0.1124716
Validation loss decreased (inf --> 0.098819).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0888136
	speed: 0.0705s/iter; left time: 1555.6215s
	iters: 200, epoch: 2 | loss: 0.0841860
	speed: 0.0332s/iter; left time: 729.7375s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.65s
Steps: 224 | Train Loss: 0.0888445 Vali Loss: 0.0866662 Test Loss: 0.0969930
Validation loss decreased (0.098819 --> 0.086666).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0807913
	speed: 0.0705s/iter; left time: 1541.6938s
	iters: 200, epoch: 3 | loss: 0.0785247
	speed: 0.0334s/iter; left time: 726.6489s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.66s
Steps: 224 | Train Loss: 0.0809936 Vali Loss: 0.0850435 Test Loss: 0.0962780
Validation loss decreased (0.086666 --> 0.085044).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0752124
	speed: 0.0654s/iter; left time: 1415.3897s
	iters: 200, epoch: 4 | loss: 0.0712232
	speed: 0.0331s/iter; left time: 711.7803s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.65s
Steps: 224 | Train Loss: 0.0751077 Vali Loss: 0.0873182 Test Loss: 0.0995040
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0689497
	speed: 0.0620s/iter; left time: 1326.5338s
	iters: 200, epoch: 5 | loss: 0.0683093
	speed: 0.0338s/iter; left time: 719.9351s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.73s
Steps: 224 | Train Loss: 0.0684474 Vali Loss: 0.0864051 Test Loss: 0.1003118
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0626845
	speed: 0.0618s/iter; left time: 1309.1709s
	iters: 200, epoch: 6 | loss: 0.0603980
	speed: 0.0334s/iter; left time: 705.0497s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.70s
Steps: 224 | Train Loss: 0.0631113 Vali Loss: 0.0877236 Test Loss: 0.1011920
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0590933
	speed: 0.0625s/iter; left time: 1308.7874s
	iters: 200, epoch: 7 | loss: 0.0597084
	speed: 0.0343s/iter; left time: 715.6098s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0589081 Vali Loss: 0.0872310 Test Loss: 0.1004953
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0552450
	speed: 0.0615s/iter; left time: 1275.5372s
	iters: 200, epoch: 8 | loss: 0.0551953
	speed: 0.0330s/iter; left time: 681.7645s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.63s
Steps: 224 | Train Loss: 0.0555059 Vali Loss: 0.0881087 Test Loss: 0.1008888
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0524991
	speed: 0.0613s/iter; left time: 1258.2121s
	iters: 200, epoch: 9 | loss: 0.0530768
	speed: 0.0335s/iter; left time: 684.2427s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.68s
Steps: 224 | Train Loss: 0.0527471 Vali Loss: 0.0886423 Test Loss: 0.1020612
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0515361
	speed: 0.0615s/iter; left time: 1248.5369s
	iters: 200, epoch: 10 | loss: 0.0495522
	speed: 0.0333s/iter; left time: 672.2791s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.66s
Steps: 224 | Train Loss: 0.0506641 Vali Loss: 0.0878667 Test Loss: 0.1018857
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0495449
	speed: 0.0623s/iter; left time: 1250.3964s
	iters: 200, epoch: 11 | loss: 0.0484085
	speed: 0.0335s/iter; left time: 669.0940s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.74s
Steps: 224 | Train Loss: 0.0487303 Vali Loss: 0.0874963 Test Loss: 0.1018826
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0460823
	speed: 0.0617s/iter; left time: 1223.9532s
	iters: 200, epoch: 12 | loss: 0.0487627
	speed: 0.0336s/iter; left time: 663.8511s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0472277 Vali Loss: 0.0875905 Test Loss: 0.1023017
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0471489
	speed: 0.0633s/iter; left time: 1242.2478s
	iters: 200, epoch: 13 | loss: 0.0454935
	speed: 0.0338s/iter; left time: 658.8136s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0459133 Vali Loss: 0.0874007 Test Loss: 0.1019594
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.021271303296089172, rmse:0.14584684371948242, mae:0.09627804905176163, rse:0.4284541606903076
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1204117
	speed: 0.0358s/iter; left time: 798.9261s
	iters: 200, epoch: 1 | loss: 0.1046546
	speed: 0.0334s/iter; left time: 741.9978s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.1222082 Vali Loss: 0.0986339 Test Loss: 0.1127096
Validation loss decreased (inf --> 0.098634).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0892475
	speed: 0.0657s/iter; left time: 1450.8334s
	iters: 200, epoch: 2 | loss: 0.0875973
	speed: 0.0336s/iter; left time: 737.9248s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.76s
Steps: 224 | Train Loss: 0.0889160 Vali Loss: 0.0860521 Test Loss: 0.0965959
Validation loss decreased (0.098634 --> 0.086052).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0820314
	speed: 0.0665s/iter; left time: 1452.5428s
	iters: 200, epoch: 3 | loss: 0.0766245
	speed: 0.0333s/iter; left time: 724.2658s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.70s
Steps: 224 | Train Loss: 0.0810734 Vali Loss: 0.0846253 Test Loss: 0.0976963
Validation loss decreased (0.086052 --> 0.084625).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0731675
	speed: 0.0650s/iter; left time: 1405.0739s
	iters: 200, epoch: 4 | loss: 0.0741658
	speed: 0.0334s/iter; left time: 718.4563s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.70s
Steps: 224 | Train Loss: 0.0754243 Vali Loss: 0.0878123 Test Loss: 0.1005267
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0716164
	speed: 0.0627s/iter; left time: 1342.0038s
	iters: 200, epoch: 5 | loss: 0.0671426
	speed: 0.0338s/iter; left time: 719.5261s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0690027 Vali Loss: 0.0878285 Test Loss: 0.1006422
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0641997
	speed: 0.0646s/iter; left time: 1367.6287s
	iters: 200, epoch: 6 | loss: 0.0674796
	speed: 0.0337s/iter; left time: 710.7980s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0635019 Vali Loss: 0.0878592 Test Loss: 0.1024417
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0591606
	speed: 0.0641s/iter; left time: 1344.1498s
	iters: 200, epoch: 7 | loss: 0.0583029
	speed: 0.0334s/iter; left time: 697.2143s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0588996 Vali Loss: 0.0877868 Test Loss: 0.1020480
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0553827
	speed: 0.0635s/iter; left time: 1316.4154s
	iters: 200, epoch: 8 | loss: 0.0554482
	speed: 0.0342s/iter; left time: 705.7927s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0554791 Vali Loss: 0.0881074 Test Loss: 0.1035934
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0541625
	speed: 0.0631s/iter; left time: 1294.9886s
	iters: 200, epoch: 9 | loss: 0.0502246
	speed: 0.0337s/iter; left time: 687.3242s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0527017 Vali Loss: 0.0881722 Test Loss: 0.1024241
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0498284
	speed: 0.0627s/iter; left time: 1270.8746s
	iters: 200, epoch: 10 | loss: 0.0489367
	speed: 0.0336s/iter; left time: 678.9365s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.72s
Steps: 224 | Train Loss: 0.0506088 Vali Loss: 0.0888529 Test Loss: 0.1031139
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0476753
	speed: 0.0635s/iter; left time: 1273.9747s
	iters: 200, epoch: 11 | loss: 0.0481353
	speed: 0.0333s/iter; left time: 665.4317s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0486823 Vali Loss: 0.0881064 Test Loss: 0.1029631
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0461587
	speed: 0.0642s/iter; left time: 1272.9597s
	iters: 200, epoch: 12 | loss: 0.0474565
	speed: 0.0335s/iter; left time: 661.5125s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0471709 Vali Loss: 0.0887941 Test Loss: 0.1031620
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0465209
	speed: 0.0635s/iter; left time: 1245.9409s
	iters: 200, epoch: 13 | loss: 0.0457823
	speed: 0.0337s/iter; left time: 657.3896s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0457775 Vali Loss: 0.0880506 Test Loss: 0.1036356
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.021871840581297874, rmse:0.1478913128376007, mae:0.09769626706838608, rse:0.4344601631164551
Intermediate time for ES and pred_len 96: 00h:04m:25.68s
=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1163252
	speed: 0.0581s/iter; left time: 1290.1549s
	iters: 200, epoch: 1 | loss: 0.1111509
	speed: 0.0341s/iter; left time: 754.0277s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.1248032 Vali Loss: 0.1023557 Test Loss: 0.1157608
Validation loss decreased (inf --> 0.102356).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0920324
	speed: 0.0796s/iter; left time: 1748.3776s
	iters: 200, epoch: 2 | loss: 0.0905396
	speed: 0.0341s/iter; left time: 745.9246s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.82s
Steps: 223 | Train Loss: 0.0927347 Vali Loss: 0.0911596 Test Loss: 0.1026373
Validation loss decreased (0.102356 --> 0.091160).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0813993
	speed: 0.0668s/iter; left time: 1454.1653s
	iters: 200, epoch: 3 | loss: 0.0804934
	speed: 0.0344s/iter; left time: 745.4513s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0837477 Vali Loss: 0.0901361 Test Loss: 0.1034494
Validation loss decreased (0.091160 --> 0.090136).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0745005
	speed: 0.0733s/iter; left time: 1577.2343s
	iters: 200, epoch: 4 | loss: 0.0743757
	speed: 0.0343s/iter; left time: 735.7188s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0773343 Vali Loss: 0.0920163 Test Loss: 0.1045371
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0717543
	speed: 0.0647s/iter; left time: 1377.6613s
	iters: 200, epoch: 5 | loss: 0.0683926
	speed: 0.0343s/iter; left time: 728.5106s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0706961 Vali Loss: 0.0927095 Test Loss: 0.1056051
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0635267
	speed: 0.0641s/iter; left time: 1352.1299s
	iters: 200, epoch: 6 | loss: 0.0626201
	speed: 0.0338s/iter; left time: 710.1386s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.82s
Steps: 223 | Train Loss: 0.0648583 Vali Loss: 0.0928507 Test Loss: 0.1066073
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0594731
	speed: 0.0642s/iter; left time: 1339.7372s
	iters: 200, epoch: 7 | loss: 0.0574201
	speed: 0.0343s/iter; left time: 712.9300s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0604445 Vali Loss: 0.0937179 Test Loss: 0.1071184
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0578186
	speed: 0.0639s/iter; left time: 1319.0169s
	iters: 200, epoch: 8 | loss: 0.0562383
	speed: 0.0342s/iter; left time: 702.3669s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0571987 Vali Loss: 0.0920181 Test Loss: 0.1071269
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0552342
	speed: 0.0663s/iter; left time: 1352.9714s
	iters: 200, epoch: 9 | loss: 0.0548123
	speed: 0.0342s/iter; left time: 694.4682s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0545950 Vali Loss: 0.0930666 Test Loss: 0.1075234
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0529762
	speed: 0.0646s/iter; left time: 1303.6571s
	iters: 200, epoch: 10 | loss: 0.0518859
	speed: 0.0340s/iter; left time: 684.1808s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.88s
Steps: 223 | Train Loss: 0.0524777 Vali Loss: 0.0920488 Test Loss: 0.1072294
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0511605
	speed: 0.0643s/iter; left time: 1283.3830s
	iters: 200, epoch: 11 | loss: 0.0511627
	speed: 0.0342s/iter; left time: 678.9603s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.90s
Steps: 223 | Train Loss: 0.0506818 Vali Loss: 0.0927317 Test Loss: 0.1083499
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0496722
	speed: 0.0636s/iter; left time: 1256.5535s
	iters: 200, epoch: 12 | loss: 0.0484021
	speed: 0.0342s/iter; left time: 672.2832s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.85s
Steps: 223 | Train Loss: 0.0491604 Vali Loss: 0.0922555 Test Loss: 0.1075642
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0480842
	speed: 0.0637s/iter; left time: 1243.6095s
	iters: 200, epoch: 13 | loss: 0.0480131
	speed: 0.0340s/iter; left time: 659.7875s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.87s
Steps: 223 | Train Loss: 0.0478748 Vali Loss: 0.0920726 Test Loss: 0.1082650
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.0238569937646389, rmse:0.15445709228515625, mae:0.10344940423965454, rse:0.45378103852272034
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1175357
	speed: 0.0366s/iter; left time: 812.7469s
	iters: 200, epoch: 1 | loss: 0.1085309
	speed: 0.0348s/iter; left time: 768.2839s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.1244877 Vali Loss: 0.1024658 Test Loss: 0.1162681
Validation loss decreased (inf --> 0.102466).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0892978
	speed: 0.0710s/iter; left time: 1559.3727s
	iters: 200, epoch: 2 | loss: 0.0858404
	speed: 0.0338s/iter; left time: 739.1676s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0925368 Vali Loss: 0.0931649 Test Loss: 0.1041178
Validation loss decreased (0.102466 --> 0.093165).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0832203
	speed: 0.0715s/iter; left time: 1555.9789s
	iters: 200, epoch: 3 | loss: 0.0824200
	speed: 0.0342s/iter; left time: 740.3014s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0840002 Vali Loss: 0.0918773 Test Loss: 0.1027539
Validation loss decreased (0.093165 --> 0.091877).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0755718
	speed: 0.0702s/iter; left time: 1511.5730s
	iters: 200, epoch: 4 | loss: 0.0789680
	speed: 0.0343s/iter; left time: 734.4408s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0778846 Vali Loss: 0.0915824 Test Loss: 0.1033742
Validation loss decreased (0.091877 --> 0.091582).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0740893
	speed: 0.0685s/iter; left time: 1460.2654s
	iters: 200, epoch: 5 | loss: 0.0704942
	speed: 0.0340s/iter; left time: 721.2956s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.87s
Steps: 223 | Train Loss: 0.0719597 Vali Loss: 0.0934459 Test Loss: 0.1050283
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0674252
	speed: 0.0654s/iter; left time: 1378.6719s
	iters: 200, epoch: 6 | loss: 0.0634718
	speed: 0.0340s/iter; left time: 712.6072s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.87s
Steps: 223 | Train Loss: 0.0659032 Vali Loss: 0.0927102 Test Loss: 0.1051720
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0629653
	speed: 0.0657s/iter; left time: 1371.1388s
	iters: 200, epoch: 7 | loss: 0.0605651
	speed: 0.0342s/iter; left time: 709.1751s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.87s
Steps: 223 | Train Loss: 0.0613759 Vali Loss: 0.0924244 Test Loss: 0.1051302
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0563948
	speed: 0.0668s/iter; left time: 1379.2055s
	iters: 200, epoch: 8 | loss: 0.0562144
	speed: 0.0339s/iter; left time: 696.2432s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.90s
Steps: 223 | Train Loss: 0.0577199 Vali Loss: 0.0931844 Test Loss: 0.1064090
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0559244
	speed: 0.0656s/iter; left time: 1339.6380s
	iters: 200, epoch: 9 | loss: 0.0532067
	speed: 0.0341s/iter; left time: 691.9724s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0549016 Vali Loss: 0.0936035 Test Loss: 0.1066466
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0514232
	speed: 0.0648s/iter; left time: 1309.3887s
	iters: 200, epoch: 10 | loss: 0.0512180
	speed: 0.0341s/iter; left time: 686.1188s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.87s
Steps: 223 | Train Loss: 0.0526190 Vali Loss: 0.0929514 Test Loss: 0.1060959
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0514014
	speed: 0.0655s/iter; left time: 1307.3120s
	iters: 200, epoch: 11 | loss: 0.0494085
	speed: 0.0343s/iter; left time: 682.4289s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0508202 Vali Loss: 0.0938980 Test Loss: 0.1071277
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0495044
	speed: 0.0658s/iter; left time: 1299.7733s
	iters: 200, epoch: 12 | loss: 0.0483764
	speed: 0.0352s/iter; left time: 690.9582s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0491536 Vali Loss: 0.0933724 Test Loss: 0.1070942
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0487324
	speed: 0.0668s/iter; left time: 1304.0319s
	iters: 200, epoch: 13 | loss: 0.0466656
	speed: 0.0350s/iter; left time: 680.1999s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0478594 Vali Loss: 0.0935658 Test Loss: 0.1077204
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0470098
	speed: 0.0657s/iter; left time: 1267.9379s
	iters: 200, epoch: 14 | loss: 0.0454411
	speed: 0.0341s/iter; left time: 654.4878s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0467149 Vali Loss: 0.0932253 Test Loss: 0.1074122
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.023433756083250046, rmse:0.15308088064193726, mae:0.10337422043085098, rse:0.44973787665367126
Intermediate time for ES and pred_len 168: 00h:04m:45.14sIntermediate time for ES: 00h:14m:55.41s
=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0776064
	speed: 0.0587s/iter; left time: 1309.0773s
	iters: 200, epoch: 1 | loss: 0.0689711
	speed: 0.0323s/iter; left time: 716.3089s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.74s
Steps: 224 | Train Loss: 0.0842278 Vali Loss: 0.0746167 Test Loss: 0.0815443
Validation loss decreased (inf --> 0.074617).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0531533
	speed: 0.0614s/iter; left time: 1354.6684s
	iters: 200, epoch: 2 | loss: 0.0528795
	speed: 0.0324s/iter; left time: 711.4069s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.45s
Steps: 224 | Train Loss: 0.0527035 Vali Loss: 0.0587939 Test Loss: 0.0632445
Validation loss decreased (0.074617 --> 0.058794).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0471682
	speed: 0.0660s/iter; left time: 1441.7854s
	iters: 200, epoch: 3 | loss: 0.0457505
	speed: 0.0327s/iter; left time: 712.0027s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.53s
Steps: 224 | Train Loss: 0.0473227 Vali Loss: 0.0575117 Test Loss: 0.0627745
Validation loss decreased (0.058794 --> 0.057512).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0463470
	speed: 0.0664s/iter; left time: 1435.6515s
	iters: 200, epoch: 4 | loss: 0.0481664
	speed: 0.0332s/iter; left time: 714.0555s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.67s
Steps: 224 | Train Loss: 0.0455139 Vali Loss: 0.0574781 Test Loss: 0.0624749
Validation loss decreased (0.057512 --> 0.057478).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0467309
	speed: 0.0657s/iter; left time: 1406.4669s
	iters: 200, epoch: 5 | loss: 0.0446282
	speed: 0.0326s/iter; left time: 694.6811s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.55s
Steps: 224 | Train Loss: 0.0437584 Vali Loss: 0.0551695 Test Loss: 0.0619991
Validation loss decreased (0.057478 --> 0.055170).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0407794
	speed: 0.0623s/iter; left time: 1318.7658s
	iters: 200, epoch: 6 | loss: 0.0384185
	speed: 0.0331s/iter; left time: 697.3740s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.56s
Steps: 224 | Train Loss: 0.0419962 Vali Loss: 0.0557887 Test Loss: 0.0628854
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0402396
	speed: 0.0595s/iter; left time: 1247.8860s
	iters: 200, epoch: 7 | loss: 0.0402509
	speed: 0.0325s/iter; left time: 676.8948s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.49s
Steps: 224 | Train Loss: 0.0402307 Vali Loss: 0.0556562 Test Loss: 0.0631281
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0379331
	speed: 0.0613s/iter; left time: 1270.0383s
	iters: 200, epoch: 8 | loss: 0.0385543
	speed: 0.0325s/iter; left time: 671.1475s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.49s
Steps: 224 | Train Loss: 0.0386213 Vali Loss: 0.0560320 Test Loss: 0.0646798
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0364931
	speed: 0.0598s/iter; left time: 1226.0757s
	iters: 200, epoch: 9 | loss: 0.0386902
	speed: 0.0324s/iter; left time: 661.8623s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.48s
Steps: 224 | Train Loss: 0.0371513 Vali Loss: 0.0557153 Test Loss: 0.0647850
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0368047
	speed: 0.0609s/iter; left time: 1234.9129s
	iters: 200, epoch: 10 | loss: 0.0341395
	speed: 0.0327s/iter; left time: 661.0101s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.64s
Steps: 224 | Train Loss: 0.0357683 Vali Loss: 0.0568122 Test Loss: 0.0655629
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0343697
	speed: 0.0615s/iter; left time: 1233.2480s
	iters: 200, epoch: 11 | loss: 0.0357826
	speed: 0.0324s/iter; left time: 646.6093s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.51s
Steps: 224 | Train Loss: 0.0344320 Vali Loss: 0.0567076 Test Loss: 0.0657521
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0327125
	speed: 0.0596s/iter; left time: 1182.0525s
	iters: 200, epoch: 12 | loss: 0.0331983
	speed: 0.0325s/iter; left time: 640.6014s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.48s
Steps: 224 | Train Loss: 0.0332904 Vali Loss: 0.0569363 Test Loss: 0.0662714
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0341434
	speed: 0.0609s/iter; left time: 1193.9434s
	iters: 200, epoch: 13 | loss: 0.0316493
	speed: 0.0325s/iter; left time: 635.1418s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.49s
Steps: 224 | Train Loss: 0.0322657 Vali Loss: 0.0569743 Test Loss: 0.0673161
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0335650
	speed: 0.0616s/iter; left time: 1194.7385s
	iters: 200, epoch: 14 | loss: 0.0316226
	speed: 0.0325s/iter; left time: 626.4018s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.52s
Steps: 224 | Train Loss: 0.0313672 Vali Loss: 0.0569273 Test Loss: 0.0670634
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0285776
	speed: 0.0607s/iter; left time: 1162.9691s
	iters: 200, epoch: 15 | loss: 0.0301777
	speed: 0.0325s/iter; left time: 618.8797s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.51s
Steps: 224 | Train Loss: 0.0306123 Vali Loss: 0.0578428 Test Loss: 0.0671806
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.011569960042834282, rmse:0.10756374895572662, mae:0.06199907511472702, rse:0.4149779677391052
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0765755
	speed: 0.0347s/iter; left time: 773.8502s
	iters: 200, epoch: 1 | loss: 0.0715873
	speed: 0.0323s/iter; left time: 716.8266s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.55s
Steps: 224 | Train Loss: 0.0848132 Vali Loss: 0.0750400 Test Loss: 0.0822929
Validation loss decreased (inf --> 0.075040).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0532299
	speed: 0.0637s/iter; left time: 1405.6653s
	iters: 200, epoch: 2 | loss: 0.0497959
	speed: 0.0327s/iter; left time: 719.1982s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.54s
Steps: 224 | Train Loss: 0.0526962 Vali Loss: 0.0586718 Test Loss: 0.0637208
Validation loss decreased (0.075040 --> 0.058672).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0449452
	speed: 0.0619s/iter; left time: 1352.4978s
	iters: 200, epoch: 3 | loss: 0.0478727
	speed: 0.0326s/iter; left time: 708.7705s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.50s
Steps: 224 | Train Loss: 0.0474259 Vali Loss: 0.0574775 Test Loss: 0.0623785
Validation loss decreased (0.058672 --> 0.057478).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0479655
	speed: 0.0632s/iter; left time: 1366.7544s
	iters: 200, epoch: 4 | loss: 0.0423369
	speed: 0.0328s/iter; left time: 706.3410s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.55s
Steps: 224 | Train Loss: 0.0456964 Vali Loss: 0.0566878 Test Loss: 0.0617239
Validation loss decreased (0.057478 --> 0.056688).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0443972
	speed: 0.0628s/iter; left time: 1344.7824s
	iters: 200, epoch: 5 | loss: 0.0437183
	speed: 0.0326s/iter; left time: 694.1988s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.54s
Steps: 224 | Train Loss: 0.0440220 Vali Loss: 0.0561451 Test Loss: 0.0622689
Validation loss decreased (0.056688 --> 0.056145).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0417378
	speed: 0.0650s/iter; left time: 1376.4881s
	iters: 200, epoch: 6 | loss: 0.0425886
	speed: 0.0330s/iter; left time: 695.7715s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.66s
Steps: 224 | Train Loss: 0.0423362 Vali Loss: 0.0566242 Test Loss: 0.0636812
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0408028
	speed: 0.0630s/iter; left time: 1319.6563s
	iters: 200, epoch: 7 | loss: 0.0407621
	speed: 0.0327s/iter; left time: 682.4362s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.57s
Steps: 224 | Train Loss: 0.0406709 Vali Loss: 0.0558169 Test Loss: 0.0628909
Validation loss decreased (0.056145 --> 0.055817).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0415118
	speed: 0.0623s/iter; left time: 1291.6641s
	iters: 200, epoch: 8 | loss: 0.0397285
	speed: 0.0323s/iter; left time: 667.0318s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.50s
Steps: 224 | Train Loss: 0.0390934 Vali Loss: 0.0559703 Test Loss: 0.0631211
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0359722
	speed: 0.0603s/iter; left time: 1237.2548s
	iters: 200, epoch: 9 | loss: 0.0355636
	speed: 0.0324s/iter; left time: 661.9338s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.47s
Steps: 224 | Train Loss: 0.0375667 Vali Loss: 0.0563328 Test Loss: 0.0643593
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0364585
	speed: 0.0623s/iter; left time: 1262.7730s
	iters: 200, epoch: 10 | loss: 0.0347073
	speed: 0.0330s/iter; left time: 665.5518s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.55s
Steps: 224 | Train Loss: 0.0361043 Vali Loss: 0.0561320 Test Loss: 0.0643679
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0359929
	speed: 0.0612s/iter; left time: 1228.5221s
	iters: 200, epoch: 11 | loss: 0.0343686
	speed: 0.0323s/iter; left time: 644.4122s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.52s
Steps: 224 | Train Loss: 0.0348943 Vali Loss: 0.0568348 Test Loss: 0.0645087
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0346736
	speed: 0.0605s/iter; left time: 1200.1561s
	iters: 200, epoch: 12 | loss: 0.0335486
	speed: 0.0327s/iter; left time: 646.1497s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.50s
Steps: 224 | Train Loss: 0.0338053 Vali Loss: 0.0570722 Test Loss: 0.0656173
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0334411
	speed: 0.0618s/iter; left time: 1212.0180s
	iters: 200, epoch: 13 | loss: 0.0322468
	speed: 0.0328s/iter; left time: 639.6503s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.62s
Steps: 224 | Train Loss: 0.0328119 Vali Loss: 0.0568148 Test Loss: 0.0648483
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0326624
	speed: 0.0606s/iter; left time: 1175.6832s
	iters: 200, epoch: 14 | loss: 0.0324357
	speed: 0.0329s/iter; left time: 635.0813s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.53s
Steps: 224 | Train Loss: 0.0318300 Vali Loss: 0.0576550 Test Loss: 0.0659730
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0302384
	speed: 0.0606s/iter; left time: 1160.5533s
	iters: 200, epoch: 15 | loss: 0.0335285
	speed: 0.0324s/iter; left time: 618.0723s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.50s
Steps: 224 | Train Loss: 0.0310831 Vali Loss: 0.0576739 Test Loss: 0.0659032
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0316819
	speed: 0.0602s/iter; left time: 1140.3543s
	iters: 200, epoch: 16 | loss: 0.0300952
	speed: 0.0323s/iter; left time: 608.5927s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.46s
Steps: 224 | Train Loss: 0.0304891 Vali Loss: 0.0578517 Test Loss: 0.0663014
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0300540
	speed: 0.0626s/iter; left time: 1172.3508s
	iters: 200, epoch: 17 | loss: 0.0303118
	speed: 0.0323s/iter; left time: 601.8689s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.56s
Steps: 224 | Train Loss: 0.0299137 Vali Loss: 0.0575964 Test Loss: 0.0659298
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.012248861603438854, rmse:0.11067457497119904, mae:0.0628909021615982, rse:0.4269794225692749
Intermediate time for FR and pred_len 24: 00h:05m:14.86s
=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0862475
	speed: 0.0585s/iter; left time: 1305.5679s
	iters: 200, epoch: 1 | loss: 0.0789353
	speed: 0.0334s/iter; left time: 741.2368s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0918407 Vali Loss: 0.0848530 Test Loss: 0.0949307
Validation loss decreased (inf --> 0.084853).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0645173
	speed: 0.0730s/iter; left time: 1611.9318s
	iters: 200, epoch: 2 | loss: 0.0630785
	speed: 0.0332s/iter; left time: 729.5972s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.66s
Steps: 224 | Train Loss: 0.0665209 Vali Loss: 0.0769489 Test Loss: 0.0858871
Validation loss decreased (0.084853 --> 0.076949).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0585615
	speed: 0.0677s/iter; left time: 1480.2264s
	iters: 200, epoch: 3 | loss: 0.0544285
	speed: 0.0334s/iter; left time: 725.7563s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.75s
Steps: 224 | Train Loss: 0.0585479 Vali Loss: 0.0776967 Test Loss: 0.0911700
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0547643
	speed: 0.0635s/iter; left time: 1374.2713s
	iters: 200, epoch: 4 | loss: 0.0521349
	speed: 0.0333s/iter; left time: 717.6269s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.72s
Steps: 224 | Train Loss: 0.0523000 Vali Loss: 0.0776609 Test Loss: 0.0917702
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0467123
	speed: 0.0641s/iter; left time: 1372.1629s
	iters: 200, epoch: 5 | loss: 0.0436993
	speed: 0.0333s/iter; left time: 710.3264s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.73s
Steps: 224 | Train Loss: 0.0471033 Vali Loss: 0.0789060 Test Loss: 0.0933320
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0454650
	speed: 0.0631s/iter; left time: 1336.3567s
	iters: 200, epoch: 6 | loss: 0.0418738
	speed: 0.0342s/iter; left time: 721.3841s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0433095 Vali Loss: 0.0802796 Test Loss: 0.0966435
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0411551
	speed: 0.0650s/iter; left time: 1361.8377s
	iters: 200, epoch: 7 | loss: 0.0411320
	speed: 0.0340s/iter; left time: 709.9935s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0405892 Vali Loss: 0.0795505 Test Loss: 0.0968952
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0395948
	speed: 0.0634s/iter; left time: 1314.8204s
	iters: 200, epoch: 8 | loss: 0.0366879
	speed: 0.0334s/iter; left time: 688.6133s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.74s
Steps: 224 | Train Loss: 0.0383602 Vali Loss: 0.0795767 Test Loss: 0.0967200
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0365589
	speed: 0.0642s/iter; left time: 1316.7185s
	iters: 200, epoch: 9 | loss: 0.0354121
	speed: 0.0334s/iter; left time: 681.1768s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.75s
Steps: 224 | Train Loss: 0.0365612 Vali Loss: 0.0798155 Test Loss: 0.0960024
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0347551
	speed: 0.0645s/iter; left time: 1308.1237s
	iters: 200, epoch: 10 | loss: 0.0357937
	speed: 0.0334s/iter; left time: 675.0973s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0351166 Vali Loss: 0.0796748 Test Loss: 0.0970269
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0328615
	speed: 0.0638s/iter; left time: 1280.0189s
	iters: 200, epoch: 11 | loss: 0.0321747
	speed: 0.0334s/iter; left time: 666.0426s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.74s
Steps: 224 | Train Loss: 0.0338496 Vali Loss: 0.0797598 Test Loss: 0.0963629
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0320179
	speed: 0.0644s/iter; left time: 1277.9659s
	iters: 200, epoch: 12 | loss: 0.0319372
	speed: 0.0336s/iter; left time: 664.0642s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0327725 Vali Loss: 0.0793384 Test Loss: 0.0966827
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.020557139068841934, rmse:0.1433776170015335, mae:0.0858871340751648, rse:0.5546227097511292
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0868272
	speed: 0.0359s/iter; left time: 800.3377s
	iters: 200, epoch: 1 | loss: 0.0793261
	speed: 0.0333s/iter; left time: 740.1839s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0914667 Vali Loss: 0.0848870 Test Loss: 0.0946935
Validation loss decreased (inf --> 0.084887).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0672989
	speed: 0.0671s/iter; left time: 1480.3526s
	iters: 200, epoch: 2 | loss: 0.0643385
	speed: 0.0337s/iter; left time: 740.9082s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0665327 Vali Loss: 0.0759749 Test Loss: 0.0862460
Validation loss decreased (0.084887 --> 0.075975).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0572134
	speed: 0.0704s/iter; left time: 1537.4687s
	iters: 200, epoch: 3 | loss: 0.0561207
	speed: 0.0333s/iter; left time: 725.4459s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0591155 Vali Loss: 0.0771875 Test Loss: 0.0894880
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0540748
	speed: 0.0646s/iter; left time: 1398.0343s
	iters: 200, epoch: 4 | loss: 0.0516426
	speed: 0.0333s/iter; left time: 716.7366s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.74s
Steps: 224 | Train Loss: 0.0531906 Vali Loss: 0.0777607 Test Loss: 0.0927518
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0487083
	speed: 0.0646s/iter; left time: 1383.6796s
	iters: 200, epoch: 5 | loss: 0.0476975
	speed: 0.0334s/iter; left time: 711.2979s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0481023 Vali Loss: 0.0778513 Test Loss: 0.0919247
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0438590
	speed: 0.0664s/iter; left time: 1407.3779s
	iters: 200, epoch: 6 | loss: 0.0438163
	speed: 0.0340s/iter; left time: 716.8900s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0444282 Vali Loss: 0.0778370 Test Loss: 0.0944785
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0434413
	speed: 0.0637s/iter; left time: 1335.7837s
	iters: 200, epoch: 7 | loss: 0.0407474
	speed: 0.0333s/iter; left time: 693.8728s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.75s
Steps: 224 | Train Loss: 0.0413640 Vali Loss: 0.0781349 Test Loss: 0.0949088
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0380688
	speed: 0.0650s/iter; left time: 1347.8890s
	iters: 200, epoch: 8 | loss: 0.0378286
	speed: 0.0335s/iter; left time: 690.8053s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0390794 Vali Loss: 0.0777945 Test Loss: 0.0954822
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0375700
	speed: 0.0648s/iter; left time: 1329.4683s
	iters: 200, epoch: 9 | loss: 0.0364217
	speed: 0.0334s/iter; left time: 680.7501s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.76s
Steps: 224 | Train Loss: 0.0372009 Vali Loss: 0.0778999 Test Loss: 0.0945588
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0352148
	speed: 0.0638s/iter; left time: 1295.1439s
	iters: 200, epoch: 10 | loss: 0.0341083
	speed: 0.0335s/iter; left time: 677.2057s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.74s
Steps: 224 | Train Loss: 0.0356917 Vali Loss: 0.0790417 Test Loss: 0.0960830
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0338370
	speed: 0.0646s/iter; left time: 1295.8137s
	iters: 200, epoch: 11 | loss: 0.0333588
	speed: 0.0339s/iter; left time: 675.7504s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0343948 Vali Loss: 0.0780501 Test Loss: 0.0963719
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0330616
	speed: 0.0653s/iter; left time: 1295.9105s
	iters: 200, epoch: 12 | loss: 0.0332803
	speed: 0.0339s/iter; left time: 669.2013s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0333036 Vali Loss: 0.0783700 Test Loss: 0.0960959
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.021034399047493935, rmse:0.14503240585327148, mae:0.08624604344367981, rse:0.5610238909721375
Intermediate time for FR and pred_len 96: 00h:04m:10.55s
=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0884569
	speed: 0.0585s/iter; left time: 1299.3233s
	iters: 200, epoch: 1 | loss: 0.0808866
	speed: 0.0337s/iter; left time: 744.8229s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0938542 Vali Loss: 0.0877504 Test Loss: 0.0973185
Validation loss decreased (inf --> 0.087750).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0651276
	speed: 0.0940s/iter; left time: 2065.7458s
	iters: 200, epoch: 2 | loss: 0.0672713
	speed: 0.0339s/iter; left time: 742.5091s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.88s
Steps: 223 | Train Loss: 0.0701975 Vali Loss: 0.0814480 Test Loss: 0.0920999
Validation loss decreased (0.087750 --> 0.081448).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0625057
	speed: 0.1012s/iter; left time: 2201.0929s
	iters: 200, epoch: 3 | loss: 0.0557836
	speed: 0.0350s/iter; left time: 758.6544s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0607981 Vali Loss: 0.0819982 Test Loss: 0.0934285
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0535417
	speed: 0.0656s/iter; left time: 1412.4035s
	iters: 200, epoch: 4 | loss: 0.0509764
	speed: 0.0344s/iter; left time: 737.1936s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0534699 Vali Loss: 0.0824004 Test Loss: 0.0964533
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0492397
	speed: 0.0652s/iter; left time: 1389.0673s
	iters: 200, epoch: 5 | loss: 0.0452260
	speed: 0.0341s/iter; left time: 723.8155s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0479584 Vali Loss: 0.0834585 Test Loss: 0.0963291
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0442968
	speed: 0.0631s/iter; left time: 1330.9333s
	iters: 200, epoch: 6 | loss: 0.0427738
	speed: 0.0335s/iter; left time: 703.4274s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.71s
Steps: 223 | Train Loss: 0.0441876 Vali Loss: 0.0830720 Test Loss: 0.0960464
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0400089
	speed: 0.0633s/iter; left time: 1320.4161s
	iters: 200, epoch: 7 | loss: 0.0401345
	speed: 0.0334s/iter; left time: 694.4201s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.72s
Steps: 223 | Train Loss: 0.0413019 Vali Loss: 0.0828756 Test Loss: 0.0959889
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0403139
	speed: 0.0635s/iter; left time: 1309.8995s
	iters: 200, epoch: 8 | loss: 0.0387559
	speed: 0.0335s/iter; left time: 688.4592s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.74s
Steps: 223 | Train Loss: 0.0391119 Vali Loss: 0.0828041 Test Loss: 0.0960062
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0369264
	speed: 0.0639s/iter; left time: 1304.7621s
	iters: 200, epoch: 9 | loss: 0.0361813
	speed: 0.0338s/iter; left time: 686.2694s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.84s
Steps: 223 | Train Loss: 0.0373108 Vali Loss: 0.0828253 Test Loss: 0.0964746
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0361604
	speed: 0.0644s/iter; left time: 1301.1673s
	iters: 200, epoch: 10 | loss: 0.0344419
	speed: 0.0337s/iter; left time: 677.5301s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.77s
Steps: 223 | Train Loss: 0.0358161 Vali Loss: 0.0833129 Test Loss: 0.0963833
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0343810
	speed: 0.0637s/iter; left time: 1272.4359s
	iters: 200, epoch: 11 | loss: 0.0339394
	speed: 0.0335s/iter; left time: 666.3024s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.77s
Steps: 223 | Train Loss: 0.0345840 Vali Loss: 0.0826738 Test Loss: 0.0961679
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0336313
	speed: 0.0637s/iter; left time: 1258.9254s
	iters: 200, epoch: 12 | loss: 0.0324802
	speed: 0.0333s/iter; left time: 655.1195s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.71s
Steps: 223 | Train Loss: 0.0335197 Vali Loss: 0.0831679 Test Loss: 0.0963215
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02259443700313568, rmse:0.15031446516513824, mae:0.09209997206926346, rse:0.5821821093559265
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0894092
	speed: 0.0361s/iter; left time: 800.5101s
	iters: 200, epoch: 1 | loss: 0.0825871
	speed: 0.0336s/iter; left time: 742.0978s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.78s
Steps: 223 | Train Loss: 0.0932287 Vali Loss: 0.0877802 Test Loss: 0.0973582
Validation loss decreased (inf --> 0.087780).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0690800
	speed: 0.0697s/iter; left time: 1531.7156s
	iters: 200, epoch: 2 | loss: 0.0640077
	speed: 0.0335s/iter; left time: 733.1942s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.77s
Steps: 223 | Train Loss: 0.0702661 Vali Loss: 0.0803683 Test Loss: 0.0915588
Validation loss decreased (0.087780 --> 0.080368).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0638850
	speed: 0.0665s/iter; left time: 1446.7912s
	iters: 200, epoch: 3 | loss: 0.0567797
	speed: 0.0335s/iter; left time: 724.5556s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.75s
Steps: 223 | Train Loss: 0.0612572 Vali Loss: 0.0804416 Test Loss: 0.0938794
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0542146
	speed: 0.0632s/iter; left time: 1360.5697s
	iters: 200, epoch: 4 | loss: 0.0533359
	speed: 0.0336s/iter; left time: 720.3123s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.72s
Steps: 223 | Train Loss: 0.0544359 Vali Loss: 0.0820984 Test Loss: 0.0975414
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0482048
	speed: 0.0633s/iter; left time: 1349.6828s
	iters: 200, epoch: 5 | loss: 0.0485607
	speed: 0.0343s/iter; left time: 726.7891s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.86s
Steps: 223 | Train Loss: 0.0490092 Vali Loss: 0.0828655 Test Loss: 0.0976705
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0460692
	speed: 0.0646s/iter; left time: 1361.7513s
	iters: 200, epoch: 6 | loss: 0.0440988
	speed: 0.0335s/iter; left time: 703.2706s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.81s
Steps: 223 | Train Loss: 0.0451625 Vali Loss: 0.0829948 Test Loss: 0.0985005
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0410739
	speed: 0.0637s/iter; left time: 1329.6645s
	iters: 200, epoch: 7 | loss: 0.0414795
	speed: 0.0335s/iter; left time: 695.1018s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.73s
Steps: 223 | Train Loss: 0.0421384 Vali Loss: 0.0837119 Test Loss: 0.0984630
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0402316
	speed: 0.0634s/iter; left time: 1307.8705s
	iters: 200, epoch: 8 | loss: 0.0391680
	speed: 0.0336s/iter; left time: 689.6640s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.74s
Steps: 223 | Train Loss: 0.0398440 Vali Loss: 0.0833129 Test Loss: 0.0983980
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0374279
	speed: 0.0633s/iter; left time: 1292.6745s
	iters: 200, epoch: 9 | loss: 0.0369868
	speed: 0.0335s/iter; left time: 680.7286s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.79s
Steps: 223 | Train Loss: 0.0379773 Vali Loss: 0.0829931 Test Loss: 0.0977898
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0371010
	speed: 0.0647s/iter; left time: 1306.6680s
	iters: 200, epoch: 10 | loss: 0.0362111
	speed: 0.0339s/iter; left time: 681.0180s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.84s
Steps: 223 | Train Loss: 0.0364681 Vali Loss: 0.0829628 Test Loss: 0.0973047
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0354411
	speed: 0.0638s/iter; left time: 1274.4820s
	iters: 200, epoch: 11 | loss: 0.0354721
	speed: 0.0336s/iter; left time: 667.4551s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.73s
Steps: 223 | Train Loss: 0.0351750 Vali Loss: 0.0829564 Test Loss: 0.0978901
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0346587
	speed: 0.0632s/iter; left time: 1248.7402s
	iters: 200, epoch: 12 | loss: 0.0330839
	speed: 0.0335s/iter; left time: 658.2219s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.73s
Steps: 223 | Train Loss: 0.0340922 Vali Loss: 0.0831059 Test Loss: 0.0969260
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.023193681612610817, rmse:0.15229472517967224, mae:0.09155873954296112, rse:0.5898519158363342
Intermediate time for FR and pred_len 168: 00h:04m:15.03sIntermediate time for FR: 00h:13m:40.44s
=== Starting experiments for country: IT ===

=== Starting experiments for pred_len: 24 ===

--- Running model for IT, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1052240
	speed: 0.0593s/iter; left time: 1322.3394s
	iters: 200, epoch: 1 | loss: 0.0995200
	speed: 0.0324s/iter; left time: 718.6741s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.1188541 Vali Loss: 0.0861337 Test Loss: 0.0891670
Validation loss decreased (inf --> 0.086134).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0668029
	speed: 0.0639s/iter; left time: 1409.7165s
	iters: 200, epoch: 2 | loss: 0.0655162
	speed: 0.0322s/iter; left time: 708.1180s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.46s
Steps: 224 | Train Loss: 0.0720778 Vali Loss: 0.0639649 Test Loss: 0.0668498
Validation loss decreased (0.086134 --> 0.063965).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0670426
	speed: 0.0627s/iter; left time: 1369.7477s
	iters: 200, epoch: 3 | loss: 0.0649540
	speed: 0.0323s/iter; left time: 703.5960s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.55s
Steps: 224 | Train Loss: 0.0645235 Vali Loss: 0.0623632 Test Loss: 0.0646318
Validation loss decreased (0.063965 --> 0.062363).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0615188
	speed: 0.0631s/iter; left time: 1364.2213s
	iters: 200, epoch: 4 | loss: 0.0651470
	speed: 0.0322s/iter; left time: 693.4935s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.50s
Steps: 224 | Train Loss: 0.0623022 Vali Loss: 0.0613726 Test Loss: 0.0651140
Validation loss decreased (0.062363 --> 0.061373).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0610557
	speed: 0.0632s/iter; left time: 1352.2947s
	iters: 200, epoch: 5 | loss: 0.0604981
	speed: 0.0324s/iter; left time: 689.4667s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.53s
Steps: 224 | Train Loss: 0.0607665 Vali Loss: 0.0618560 Test Loss: 0.0650788
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0569930
	speed: 0.0619s/iter; left time: 1310.1207s
	iters: 200, epoch: 6 | loss: 0.0620100
	speed: 0.0326s/iter; left time: 686.9783s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.55s
Steps: 224 | Train Loss: 0.0583740 Vali Loss: 0.0603924 Test Loss: 0.0641359
Validation loss decreased (0.061373 --> 0.060392).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0534668
	speed: 0.0649s/iter; left time: 1359.5353s
	iters: 200, epoch: 7 | loss: 0.0552543
	speed: 0.0325s/iter; left time: 677.0287s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.58s
Steps: 224 | Train Loss: 0.0567980 Vali Loss: 0.0595051 Test Loss: 0.0627162
Validation loss decreased (0.060392 --> 0.059505).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0539588
	speed: 0.0638s/iter; left time: 1323.3991s
	iters: 200, epoch: 8 | loss: 0.0549810
	speed: 0.0322s/iter; left time: 663.5912s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.49s
Steps: 224 | Train Loss: 0.0549697 Vali Loss: 0.0608740 Test Loss: 0.0637390
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0538474
	speed: 0.0603s/iter; left time: 1236.8981s
	iters: 200, epoch: 9 | loss: 0.0502654
	speed: 0.0323s/iter; left time: 660.0293s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.51s
Steps: 224 | Train Loss: 0.0530986 Vali Loss: 0.0604585 Test Loss: 0.0635977
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0519460
	speed: 0.0612s/iter; left time: 1241.8916s
	iters: 200, epoch: 10 | loss: 0.0463895
	speed: 0.0330s/iter; left time: 665.4006s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.57s
Steps: 224 | Train Loss: 0.0514600 Vali Loss: 0.0600744 Test Loss: 0.0641934
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0518249
	speed: 0.0612s/iter; left time: 1227.1669s
	iters: 200, epoch: 11 | loss: 0.0491804
	speed: 0.0323s/iter; left time: 644.5589s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.47s
Steps: 224 | Train Loss: 0.0500287 Vali Loss: 0.0611684 Test Loss: 0.0645865
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0503090
	speed: 0.0597s/iter; left time: 1184.4776s
	iters: 200, epoch: 12 | loss: 0.0513023
	speed: 0.0321s/iter; left time: 633.3577s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.43s
Steps: 224 | Train Loss: 0.0486316 Vali Loss: 0.0609906 Test Loss: 0.0643800
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0467671
	speed: 0.0608s/iter; left time: 1193.2976s
	iters: 200, epoch: 13 | loss: 0.0463996
	speed: 0.0325s/iter; left time: 633.5640s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.49s
Steps: 224 | Train Loss: 0.0472041 Vali Loss: 0.0615323 Test Loss: 0.0650614
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0485981
	speed: 0.0612s/iter; left time: 1186.2148s
	iters: 200, epoch: 14 | loss: 0.0465529
	speed: 0.0323s/iter; left time: 622.9980s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.49s
Steps: 224 | Train Loss: 0.0459658 Vali Loss: 0.0623372 Test Loss: 0.0648194
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0431688
	speed: 0.0611s/iter; left time: 1171.0140s
	iters: 200, epoch: 15 | loss: 0.0447366
	speed: 0.0328s/iter; left time: 626.2306s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.61s
Steps: 224 | Train Loss: 0.0449380 Vali Loss: 0.0626743 Test Loss: 0.0651143
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0431246
	speed: 0.0615s/iter; left time: 1165.6164s
	iters: 200, epoch: 16 | loss: 0.0459317
	speed: 0.0321s/iter; left time: 604.6334s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.45s
Steps: 224 | Train Loss: 0.0439346 Vali Loss: 0.0624681 Test Loss: 0.0658006
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0437078
	speed: 0.0598s/iter; left time: 1118.7880s
	iters: 200, epoch: 17 | loss: 0.0450082
	speed: 0.0325s/iter; left time: 604.3312s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.46s
Steps: 224 | Train Loss: 0.0430947 Vali Loss: 0.0630289 Test Loss: 0.0656900
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.011220804415643215, rmse:0.10592830181121826, mae:0.06271616369485855, rse:0.4002508819103241
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1160403
	speed: 0.0343s/iter; left time: 765.5966s
	iters: 200, epoch: 1 | loss: 0.0940983
	speed: 0.0322s/iter; left time: 714.2124s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.47s
Steps: 224 | Train Loss: 0.1176875 Vali Loss: 0.0858559 Test Loss: 0.0892095
Validation loss decreased (inf --> 0.085856).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0703001
	speed: 0.0618s/iter; left time: 1364.3592s
	iters: 200, epoch: 2 | loss: 0.0682917
	speed: 0.0327s/iter; left time: 718.0935s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.52s
Steps: 224 | Train Loss: 0.0718768 Vali Loss: 0.0640197 Test Loss: 0.0671154
Validation loss decreased (0.085856 --> 0.064020).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0675953
	speed: 0.0645s/iter; left time: 1410.0610s
	iters: 200, epoch: 3 | loss: 0.0618320
	speed: 0.0321s/iter; left time: 699.1615s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.54s
Steps: 224 | Train Loss: 0.0647467 Vali Loss: 0.0626417 Test Loss: 0.0650419
Validation loss decreased (0.064020 --> 0.062642).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0653759
	speed: 0.0627s/iter; left time: 1356.2144s
	iters: 200, epoch: 4 | loss: 0.0638989
	speed: 0.0322s/iter; left time: 692.4842s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.45s
Steps: 224 | Train Loss: 0.0623659 Vali Loss: 0.0610645 Test Loss: 0.0640131
Validation loss decreased (0.062642 --> 0.061065).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0575085
	speed: 0.0623s/iter; left time: 1334.1177s
	iters: 200, epoch: 5 | loss: 0.0587094
	speed: 0.0321s/iter; left time: 684.3064s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.42s
Steps: 224 | Train Loss: 0.0601151 Vali Loss: 0.0610883 Test Loss: 0.0636876
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0577437
	speed: 0.0599s/iter; left time: 1268.1228s
	iters: 200, epoch: 6 | loss: 0.0556418
	speed: 0.0322s/iter; left time: 678.2235s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.45s
Steps: 224 | Train Loss: 0.0580983 Vali Loss: 0.0604166 Test Loss: 0.0639995
Validation loss decreased (0.061065 --> 0.060417).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0561289
	speed: 0.0621s/iter; left time: 1302.1858s
	iters: 200, epoch: 7 | loss: 0.0562709
	speed: 0.0325s/iter; left time: 677.8742s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.56s
Steps: 224 | Train Loss: 0.0565202 Vali Loss: 0.0604680 Test Loss: 0.0635442
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0581985
	speed: 0.0603s/iter; left time: 1250.4228s
	iters: 200, epoch: 8 | loss: 0.0544954
	speed: 0.0321s/iter; left time: 662.6251s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.43s
Steps: 224 | Train Loss: 0.0545067 Vali Loss: 0.0608139 Test Loss: 0.0642482
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0527575
	speed: 0.0617s/iter; left time: 1265.7564s
	iters: 200, epoch: 9 | loss: 0.0503566
	speed: 0.0324s/iter; left time: 660.7891s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.52s
Steps: 224 | Train Loss: 0.0529972 Vali Loss: 0.0604772 Test Loss: 0.0637462
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0521386
	speed: 0.0621s/iter; left time: 1260.5590s
	iters: 200, epoch: 10 | loss: 0.0501020
	speed: 0.0323s/iter; left time: 652.5405s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.53s
Steps: 224 | Train Loss: 0.0513403 Vali Loss: 0.0607974 Test Loss: 0.0645847
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0499747
	speed: 0.0611s/iter; left time: 1225.9885s
	iters: 200, epoch: 11 | loss: 0.0474736
	speed: 0.0321s/iter; left time: 640.3754s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.46s
Steps: 224 | Train Loss: 0.0495997 Vali Loss: 0.0612057 Test Loss: 0.0651089
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0470874
	speed: 0.0611s/iter; left time: 1212.8747s
	iters: 200, epoch: 12 | loss: 0.0499756
	speed: 0.0321s/iter; left time: 633.1437s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.49s
Steps: 224 | Train Loss: 0.0482302 Vali Loss: 0.0611211 Test Loss: 0.0649221
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0500659
	speed: 0.0601s/iter; left time: 1178.1560s
	iters: 200, epoch: 13 | loss: 0.0463377
	speed: 0.0322s/iter; left time: 627.9842s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.43s
Steps: 224 | Train Loss: 0.0468275 Vali Loss: 0.0616577 Test Loss: 0.0657040
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0437683
	speed: 0.0599s/iter; left time: 1161.6980s
	iters: 200, epoch: 14 | loss: 0.0452077
	speed: 0.0321s/iter; left time: 619.3575s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.42s
Steps: 224 | Train Loss: 0.0456268 Vali Loss: 0.0622756 Test Loss: 0.0657823
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0445578
	speed: 0.0620s/iter; left time: 1188.7984s
	iters: 200, epoch: 15 | loss: 0.0429793
	speed: 0.0324s/iter; left time: 617.0542s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.54s
Steps: 224 | Train Loss: 0.0444806 Vali Loss: 0.0620232 Test Loss: 0.0653317
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0447943
	speed: 0.0622s/iter; left time: 1179.0772s
	iters: 200, epoch: 16 | loss: 0.0439081
	speed: 0.0331s/iter; left time: 624.2697s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.64s
Steps: 224 | Train Loss: 0.0435288 Vali Loss: 0.0623529 Test Loss: 0.0663972
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01142948679625988, rmse:0.10690877586603165, mae:0.06399953365325928, rse:0.4039556086063385
Intermediate time for IT and pred_len 24: 00h:05m:23.04s
=== Starting experiments for pred_len: 96 ===

--- Running model for IT, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1181966
	speed: 0.0595s/iter; left time: 1326.4071s
	iters: 200, epoch: 1 | loss: 0.1096394
	speed: 0.0328s/iter; left time: 728.7151s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.1280400 Vali Loss: 0.0973109 Test Loss: 0.1012016
Validation loss decreased (inf --> 0.097311).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0877090
	speed: 0.0656s/iter; left time: 1449.2473s
	iters: 200, epoch: 2 | loss: 0.0852547
	speed: 0.0327s/iter; left time: 719.0761s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.55s
Steps: 224 | Train Loss: 0.0902369 Vali Loss: 0.0833138 Test Loss: 0.0876840
Validation loss decreased (0.097311 --> 0.083314).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0796998
	speed: 0.0637s/iter; left time: 1392.6980s
	iters: 200, epoch: 3 | loss: 0.0754760
	speed: 0.0330s/iter; left time: 718.8331s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.64s
Steps: 224 | Train Loss: 0.0821896 Vali Loss: 0.0847121 Test Loss: 0.0885704
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0757821
	speed: 0.0636s/iter; left time: 1375.0338s
	iters: 200, epoch: 4 | loss: 0.0727580
	speed: 0.0330s/iter; left time: 710.4566s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.66s
Steps: 224 | Train Loss: 0.0758136 Vali Loss: 0.0868573 Test Loss: 0.0913092
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0687613
	speed: 0.0616s/iter; left time: 1319.5185s
	iters: 200, epoch: 5 | loss: 0.0685968
	speed: 0.0328s/iter; left time: 697.9676s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.56s
Steps: 224 | Train Loss: 0.0689663 Vali Loss: 0.0893411 Test Loss: 0.0935924
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0651921
	speed: 0.0615s/iter; left time: 1301.9021s
	iters: 200, epoch: 6 | loss: 0.0632846
	speed: 0.0329s/iter; left time: 692.8142s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.59s
Steps: 224 | Train Loss: 0.0631031 Vali Loss: 0.0897252 Test Loss: 0.0937936
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0562681
	speed: 0.0623s/iter; left time: 1306.4249s
	iters: 200, epoch: 7 | loss: 0.0584004
	speed: 0.0328s/iter; left time: 683.2747s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.63s
Steps: 224 | Train Loss: 0.0586738 Vali Loss: 0.0891313 Test Loss: 0.0927569
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0594843
	speed: 0.0632s/iter; left time: 1310.5403s
	iters: 200, epoch: 8 | loss: 0.0533358
	speed: 0.0333s/iter; left time: 686.7450s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.74s
Steps: 224 | Train Loss: 0.0551203 Vali Loss: 0.0891207 Test Loss: 0.0943138
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0506663
	speed: 0.0621s/iter; left time: 1274.4806s
	iters: 200, epoch: 9 | loss: 0.0516839
	speed: 0.0329s/iter; left time: 671.4967s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.61s
Steps: 224 | Train Loss: 0.0524840 Vali Loss: 0.0899251 Test Loss: 0.0945375
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0502532
	speed: 0.0617s/iter; left time: 1252.1771s
	iters: 200, epoch: 10 | loss: 0.0516907
	speed: 0.0329s/iter; left time: 663.6041s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.61s
Steps: 224 | Train Loss: 0.0503486 Vali Loss: 0.0897381 Test Loss: 0.0947718
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0476377
	speed: 0.0618s/iter; left time: 1240.4583s
	iters: 200, epoch: 11 | loss: 0.0482675
	speed: 0.0328s/iter; left time: 655.2572s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.59s
Steps: 224 | Train Loss: 0.0485826 Vali Loss: 0.0897575 Test Loss: 0.0946977
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0458898
	speed: 0.0616s/iter; left time: 1222.0938s
	iters: 200, epoch: 12 | loss: 0.0471257
	speed: 0.0333s/iter; left time: 657.2549s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.67s
Steps: 224 | Train Loss: 0.0471242 Vali Loss: 0.0901863 Test Loss: 0.0944600
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.02016986720263958, rmse:0.14202065765857697, mae:0.08768393099308014, rse:0.5369954109191895
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1255154
	speed: 0.0352s/iter; left time: 784.3829s
	iters: 200, epoch: 1 | loss: 0.1049256
	speed: 0.0328s/iter; left time: 727.6880s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.63s
Steps: 224 | Train Loss: 0.1278330 Vali Loss: 0.0975431 Test Loss: 0.1014083
Validation loss decreased (inf --> 0.097543).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0899003
	speed: 0.0656s/iter; left time: 1448.8317s
	iters: 200, epoch: 2 | loss: 0.0846541
	speed: 0.0330s/iter; left time: 726.2181s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.66s
Steps: 224 | Train Loss: 0.0901421 Vali Loss: 0.0825803 Test Loss: 0.0863189
Validation loss decreased (0.097543 --> 0.082580).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0845014
	speed: 0.0644s/iter; left time: 1408.1594s
	iters: 200, epoch: 3 | loss: 0.0811608
	speed: 0.0330s/iter; left time: 717.4297s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.63s
Steps: 224 | Train Loss: 0.0826669 Vali Loss: 0.0844429 Test Loss: 0.0884733
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0779427
	speed: 0.0631s/iter; left time: 1364.3807s
	iters: 200, epoch: 4 | loss: 0.0703318
	speed: 0.0333s/iter; left time: 716.9152s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.70s
Steps: 224 | Train Loss: 0.0767097 Vali Loss: 0.0885497 Test Loss: 0.0904577
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0702917
	speed: 0.0637s/iter; left time: 1364.4786s
	iters: 200, epoch: 5 | loss: 0.0693786
	speed: 0.0327s/iter; left time: 696.3235s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.63s
Steps: 224 | Train Loss: 0.0701658 Vali Loss: 0.0881929 Test Loss: 0.0910864
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0627403
	speed: 0.0625s/iter; left time: 1323.8462s
	iters: 200, epoch: 6 | loss: 0.0628337
	speed: 0.0328s/iter; left time: 692.2602s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.60s
Steps: 224 | Train Loss: 0.0642376 Vali Loss: 0.0915709 Test Loss: 0.0943422
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0589409
	speed: 0.0625s/iter; left time: 1310.2335s
	iters: 200, epoch: 7 | loss: 0.0613292
	speed: 0.0327s/iter; left time: 681.9104s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.63s
Steps: 224 | Train Loss: 0.0597377 Vali Loss: 0.0914882 Test Loss: 0.0947146
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0582752
	speed: 0.0619s/iter; left time: 1282.9689s
	iters: 200, epoch: 8 | loss: 0.0556407
	speed: 0.0327s/iter; left time: 673.7276s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.54s
Steps: 224 | Train Loss: 0.0564200 Vali Loss: 0.0915248 Test Loss: 0.0945174
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0531261
	speed: 0.0613s/iter; left time: 1257.0216s
	iters: 200, epoch: 9 | loss: 0.0556055
	speed: 0.0328s/iter; left time: 669.8923s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.61s
Steps: 224 | Train Loss: 0.0534906 Vali Loss: 0.0919397 Test Loss: 0.0957770
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0536001
	speed: 0.0626s/iter; left time: 1268.8658s
	iters: 200, epoch: 10 | loss: 0.0489793
	speed: 0.0330s/iter; left time: 665.8482s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.63s
Steps: 224 | Train Loss: 0.0513367 Vali Loss: 0.0924511 Test Loss: 0.0954170
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0486944
	speed: 0.0618s/iter; left time: 1240.4935s
	iters: 200, epoch: 11 | loss: 0.0491078
	speed: 0.0328s/iter; left time: 654.9085s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.61s
Steps: 224 | Train Loss: 0.0493445 Vali Loss: 0.0925241 Test Loss: 0.0958952
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0473603
	speed: 0.0622s/iter; left time: 1233.9804s
	iters: 200, epoch: 12 | loss: 0.0451833
	speed: 0.0331s/iter; left time: 653.1351s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.63s
Steps: 224 | Train Loss: 0.0478553 Vali Loss: 0.0918346 Test Loss: 0.0957100
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01941889151930809, rmse:0.13935168087482452, mae:0.08631888031959534, rse:0.5269036889076233
Intermediate time for IT and pred_len 96: 00h:04m:02.66s
=== Starting experiments for pred_len: 168 ===

--- Running model for IT, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1198918
	speed: 0.0602s/iter; left time: 1335.4515s
	iters: 200, epoch: 1 | loss: 0.1119531
	speed: 0.0335s/iter; left time: 739.9478s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.1296531 Vali Loss: 0.0998805 Test Loss: 0.1030402
Validation loss decreased (inf --> 0.099880).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0907918
	speed: 0.0724s/iter; left time: 1591.1121s
	iters: 200, epoch: 2 | loss: 0.0905884
	speed: 0.0334s/iter; left time: 731.2592s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.69s
Steps: 223 | Train Loss: 0.0942718 Vali Loss: 0.0888983 Test Loss: 0.0913404
Validation loss decreased (0.099880 --> 0.088898).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0858455
	speed: 0.0693s/iter; left time: 1506.8082s
	iters: 200, epoch: 3 | loss: 0.0790434
	speed: 0.0334s/iter; left time: 724.3479s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.74s
Steps: 223 | Train Loss: 0.0845714 Vali Loss: 0.0910256 Test Loss: 0.0931149
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0759794
	speed: 0.0621s/iter; left time: 1336.2590s
	iters: 200, epoch: 4 | loss: 0.0741858
	speed: 0.0336s/iter; left time: 720.3422s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.70s
Steps: 223 | Train Loss: 0.0770820 Vali Loss: 0.0927773 Test Loss: 0.0950808
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0691015
	speed: 0.0650s/iter; left time: 1386.1147s
	iters: 200, epoch: 5 | loss: 0.0647586
	speed: 0.0348s/iter; left time: 737.1494s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0700328 Vali Loss: 0.0943000 Test Loss: 0.0950744
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0640472
	speed: 0.0640s/iter; left time: 1350.1069s
	iters: 200, epoch: 6 | loss: 0.0612911
	speed: 0.0336s/iter; left time: 704.9533s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.79s
Steps: 223 | Train Loss: 0.0645894 Vali Loss: 0.0963655 Test Loss: 0.0991898
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0610605
	speed: 0.0640s/iter; left time: 1335.5354s
	iters: 200, epoch: 7 | loss: 0.0579671
	speed: 0.0335s/iter; left time: 696.4761s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.73s
Steps: 223 | Train Loss: 0.0603602 Vali Loss: 0.0950874 Test Loss: 0.0973007
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0567950
	speed: 0.0644s/iter; left time: 1330.2366s
	iters: 200, epoch: 8 | loss: 0.0570818
	speed: 0.0336s/iter; left time: 689.7922s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.76s
Steps: 223 | Train Loss: 0.0570988 Vali Loss: 0.0949548 Test Loss: 0.0956630
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0546112
	speed: 0.0634s/iter; left time: 1294.7920s
	iters: 200, epoch: 9 | loss: 0.0524339
	speed: 0.0335s/iter; left time: 680.3682s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.77s
Steps: 223 | Train Loss: 0.0544873 Vali Loss: 0.0957294 Test Loss: 0.0976520
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0508264
	speed: 0.0644s/iter; left time: 1300.9257s
	iters: 200, epoch: 10 | loss: 0.0543244
	speed: 0.0338s/iter; left time: 678.4145s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.86s
Steps: 223 | Train Loss: 0.0524037 Vali Loss: 0.0946522 Test Loss: 0.0974682
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0509232
	speed: 0.0635s/iter; left time: 1268.2480s
	iters: 200, epoch: 11 | loss: 0.0519942
	speed: 0.0335s/iter; left time: 666.4533s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.75s
Steps: 223 | Train Loss: 0.0505157 Vali Loss: 0.0947079 Test Loss: 0.0967350
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0484439
	speed: 0.0637s/iter; left time: 1258.3883s
	iters: 200, epoch: 12 | loss: 0.0475559
	speed: 0.0336s/iter; left time: 659.4518s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.69s
Steps: 223 | Train Loss: 0.0490816 Vali Loss: 0.0940101 Test Loss: 0.0961627
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021067097783088684, rmse:0.14514508843421936, mae:0.09134043753147125, rse:0.5493192076683044
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1244710
	speed: 0.0360s/iter; left time: 799.8840s
	iters: 200, epoch: 1 | loss: 0.1170316
	speed: 0.0336s/iter; left time: 743.6137s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.80s
Steps: 223 | Train Loss: 0.1287358 Vali Loss: 0.0999947 Test Loss: 0.1031152
Validation loss decreased (inf --> 0.099995).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0887262
	speed: 0.0713s/iter; left time: 1566.0629s
	iters: 200, epoch: 2 | loss: 0.0913494
	speed: 0.0341s/iter; left time: 746.6869s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.86s
Steps: 223 | Train Loss: 0.0940741 Vali Loss: 0.0886703 Test Loss: 0.0908009
Validation loss decreased (0.099995 --> 0.088670).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0876927
	speed: 0.0767s/iter; left time: 1668.1872s
	iters: 200, epoch: 3 | loss: 0.0828235
	speed: 0.0335s/iter; left time: 726.3285s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.78s
Steps: 223 | Train Loss: 0.0851875 Vali Loss: 0.0917103 Test Loss: 0.0935745
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0786623
	speed: 0.0643s/iter; left time: 1384.5670s
	iters: 200, epoch: 4 | loss: 0.0741892
	speed: 0.0336s/iter; left time: 719.5788s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.73s
Steps: 223 | Train Loss: 0.0777442 Vali Loss: 0.0918386 Test Loss: 0.0967076
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0694645
	speed: 0.0639s/iter; left time: 1361.7622s
	iters: 200, epoch: 5 | loss: 0.0682284
	speed: 0.0335s/iter; left time: 710.9822s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.75s
Steps: 223 | Train Loss: 0.0704027 Vali Loss: 0.0935241 Test Loss: 0.0960906
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0646602
	speed: 0.0650s/iter; left time: 1371.0488s
	iters: 200, epoch: 6 | loss: 0.0633540
	speed: 0.0336s/iter; left time: 704.9254s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.87s
Steps: 223 | Train Loss: 0.0650664 Vali Loss: 0.0929157 Test Loss: 0.0990988
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0606141
	speed: 0.0643s/iter; left time: 1341.6915s
	iters: 200, epoch: 7 | loss: 0.0587380
	speed: 0.0336s/iter; left time: 697.6975s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.79s
Steps: 223 | Train Loss: 0.0609457 Vali Loss: 0.0932918 Test Loss: 0.0978042
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0581316
	speed: 0.0635s/iter; left time: 1311.4885s
	iters: 200, epoch: 8 | loss: 0.0562303
	speed: 0.0335s/iter; left time: 688.7392s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.73s
Steps: 223 | Train Loss: 0.0575464 Vali Loss: 0.0935499 Test Loss: 0.0977738
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0535778
	speed: 0.0644s/iter; left time: 1314.3718s
	iters: 200, epoch: 9 | loss: 0.0549186
	speed: 0.0337s/iter; left time: 685.4217s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.81s
Steps: 223 | Train Loss: 0.0548766 Vali Loss: 0.0944758 Test Loss: 0.0985249
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0527458
	speed: 0.0639s/iter; left time: 1289.7448s
	iters: 200, epoch: 10 | loss: 0.0528382
	speed: 0.0343s/iter; left time: 689.3945s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.89s
Steps: 223 | Train Loss: 0.0526781 Vali Loss: 0.0944073 Test Loss: 0.0979464
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0520308
	speed: 0.0647s/iter; left time: 1292.4631s
	iters: 200, epoch: 11 | loss: 0.0492344
	speed: 0.0336s/iter; left time: 667.7984s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.77s
Steps: 223 | Train Loss: 0.0509229 Vali Loss: 0.0946541 Test Loss: 0.0983658
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0504324
	speed: 0.0635s/iter; left time: 1254.1454s
	iters: 200, epoch: 12 | loss: 0.0474441
	speed: 0.0335s/iter; left time: 657.8061s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.74s
Steps: 223 | Train Loss: 0.0494031 Vali Loss: 0.0943606 Test Loss: 0.0970964
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020650984719395638, rmse:0.14370450377464294, mae:0.0908009260892868, rse:0.5438671112060547
Intermediate time for IT and pred_len 168: 00h:04m:11.04sIntermediate time for IT: 00h:13m:36.74sTotal time: 02h:44m:25.33s